var hu=Object.defineProperty;var Ml=j=>{throw TypeError(j)};var mu=(j,$,_e)=>$ in j?hu(j,$,{enumerable:!0,configurable:!0,writable:!0,value:_e}):j[$]=_e;var Wt=(j,$,_e)=>mu(j,typeof $!="symbol"?$+"":$,_e),qo=(j,$,_e)=>$.has(j)||Ml("Cannot "+_e);var bt=(j,$,_e)=>(qo(j,$,"read from private field"),_e?_e.call(j):$.get(j)),zt=(j,$,_e)=>$.has(j)?Ml("Cannot add the same private member more than once"):$ instanceof WeakSet?$.add(j):$.set(j,_e),Dt=(j,$,_e,et)=>(qo(j,$,"write to private field"),et?et.call(j,_e):$.set(j,_e),_e),hn=(j,$,_e)=>(qo(j,$,"access private method"),_e);var Mo=(j,$,_e,et)=>({set _(tt){Dt(j,$,tt,_e)},get _(){return bt(j,$,et)}});function _mergeNamespaces(j,$){for(var _e=0;_e<$.length;_e++){const et=$[_e];if(typeof et!="string"&&!Array.isArray(et)){for(const tt in et)if(tt!=="default"&&!(tt in j)){const nt=Object.getOwnPropertyDescriptor(et,tt);nt&&Object.defineProperty(j,tt,nt.get?nt:{enumerable:!0,get:()=>et[tt]})}}}return Object.freeze(Object.defineProperty(j,Symbol.toStringTag,{value:"Module"}))}(function(){const $=document.createElement("link").relList;if($&&$.supports&&$.supports("modulepreload"))return;for(const tt of document.querySelectorAll('link[rel="modulepreload"]'))et(tt);new MutationObserver(tt=>{for(const nt of tt)if(nt.type==="childList")for(const rt of nt.addedNodes)rt.tagName==="LINK"&&rt.rel==="modulepreload"&&et(rt)}).observe(document,{childList:!0,subtree:!0});function _e(tt){const nt={};return tt.integrity&&(nt.integrity=tt.integrity),tt.referrerPolicy&&(nt.referrerPolicy=tt.referrerPolicy),tt.crossOrigin==="use-credentials"?nt.credentials="include":tt.crossOrigin==="anonymous"?nt.credentials="omit":nt.credentials="same-origin",nt}function et(tt){if(tt.ep)return;tt.ep=!0;const nt=_e(tt);fetch(tt.href,nt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$4=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$2(j){return j===null||typeof j!="object"?null:(j=z$1&&j[z$1]||j["@@iterator"],typeof j=="function"?j:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(j,$,_e){this.props=j,this.context=$,this.refs=D$2,this.updater=_e||B$1}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(j,$){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,$,"setState")};E$2.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function F(){}F.prototype=E$2.prototype;function G$1(j,$,_e){this.props=j,this.context=$,this.refs=D$2,this.updater=_e||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$2(H$1,E$2.prototype);H$1.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$1={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(j,$,_e){var et,tt={},nt=null,rt=null;if($!=null)for(et in $.ref!==void 0&&(rt=$.ref),$.key!==void 0&&(nt=""+$.key),$)J$1.call($,et)&&!L$2.hasOwnProperty(et)&&(tt[et]=$[et]);var it=arguments.length-2;if(it===1)tt.children=_e;else if(1<it){for(var st=Array(it),at=0;at<it;at++)st[at]=arguments[at+2];tt.children=st}if(j&&j.defaultProps)for(et in it=j.defaultProps,it)tt[et]===void 0&&(tt[et]=it[et]);return{$$typeof:l$2,type:j,key:nt,ref:rt,props:tt,_owner:K$1.current}}function N$2(j,$){return{$$typeof:l$2,type:j.type,key:$,ref:j.ref,props:j.props,_owner:j._owner}}function O$3(j){return typeof j=="object"&&j!==null&&j.$$typeof===l$2}function escape(j){var $={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(_e){return $[_e]})}var P$3=/\/+/g;function Q$1(j,$){return typeof j=="object"&&j!==null&&j.key!=null?escape(""+j.key):$.toString(36)}function R$2(j,$,_e,et,tt){var nt=typeof j;(nt==="undefined"||nt==="boolean")&&(j=null);var rt=!1;if(j===null)rt=!0;else switch(nt){case"string":case"number":rt=!0;break;case"object":switch(j.$$typeof){case l$2:case n$2:rt=!0}}if(rt)return rt=j,tt=tt(rt),j=et===""?"."+Q$1(rt,0):et,I$2(tt)?(_e="",j!=null&&(_e=j.replace(P$3,"$&/")+"/"),R$2(tt,$,_e,"",function(at){return at})):tt!=null&&(O$3(tt)&&(tt=N$2(tt,_e+(!tt.key||rt&&rt.key===tt.key?"":(""+tt.key).replace(P$3,"$&/")+"/")+j)),$.push(tt)),1;if(rt=0,et=et===""?".":et+":",I$2(j))for(var it=0;it<j.length;it++){nt=j[it];var st=et+Q$1(nt,it);rt+=R$2(nt,$,_e,st,tt)}else if(st=A$2(j),typeof st=="function")for(j=st.call(j),it=0;!(nt=j.next()).done;)nt=nt.value,st=et+Q$1(nt,it++),rt+=R$2(nt,$,_e,st,tt);else if(nt==="object")throw $=String(j),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return rt}function S$2(j,$,_e){if(j==null)return j;var et=[],tt=0;return R$2(j,et,"","",function(nt){return $.call(_e,nt,tt++)}),et}function T$2(j){if(j._status===-1){var $=j._result;$=$(),$.then(function(_e){(j._status===0||j._status===-1)&&(j._status=1,j._result=_e)},function(_e){(j._status===0||j._status===-1)&&(j._status=2,j._result=_e)}),j._status===-1&&(j._status=0,j._result=$)}if(j._status===1)return j._result.default;throw j._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(j,$,_e){S$2(j,function(){$.apply(this,arguments)},_e)},count:function(j){var $=0;return S$2(j,function(){$++}),$},toArray:function(j){return S$2(j,function($){return $})||[]},only:function(j){if(!O$3(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r$4;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(j,$,_e){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var et=C$2({},j.props),tt=j.key,nt=j.ref,rt=j._owner;if($!=null){if($.ref!==void 0&&(nt=$.ref,rt=K$1.current),$.key!==void 0&&(tt=""+$.key),j.type&&j.type.defaultProps)var it=j.type.defaultProps;for(st in $)J$1.call($,st)&&!L$2.hasOwnProperty(st)&&(et[st]=$[st]===void 0&&it!==void 0?it[st]:$[st])}var st=arguments.length-2;if(st===1)et.children=_e;else if(1<st){it=Array(st);for(var at=0;at<st;at++)it[at]=arguments[at+2];et.children=it}return{$$typeof:l$2,type:j.type,key:tt,ref:nt,props:et,_owner:rt}};react_production_min.createContext=function(j){return j={$$typeof:u$1,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:t$1,_context:j},j.Consumer=j};react_production_min.createElement=M$2;react_production_min.createFactory=function(j){var $=M$2.bind(null,j);return $.type=j,$};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(j){return{$$typeof:v$2,render:j}};react_production_min.isValidElement=O$3;react_production_min.lazy=function(j){return{$$typeof:y$2,_payload:{_status:-1,_result:j},_init:T$2}};react_production_min.memo=function(j,$){return{$$typeof:x$2,type:j,compare:$===void 0?null:$}};react_production_min.startTransition=function(j){var $=V$1.transition;V$1.transition={};try{j()}finally{V$1.transition=$}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(j,$){return U$1.current.useCallback(j,$)};react_production_min.useContext=function(j){return U$1.current.useContext(j)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(j){return U$1.current.useDeferredValue(j)};react_production_min.useEffect=function(j,$){return U$1.current.useEffect(j,$)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(j,$,_e){return U$1.current.useImperativeHandle(j,$,_e)};react_production_min.useInsertionEffect=function(j,$){return U$1.current.useInsertionEffect(j,$)};react_production_min.useLayoutEffect=function(j,$){return U$1.current.useLayoutEffect(j,$)};react_production_min.useMemo=function(j,$){return U$1.current.useMemo(j,$)};react_production_min.useReducer=function(j,$,_e){return U$1.current.useReducer(j,$,_e)};react_production_min.useRef=function(j){return U$1.current.useRef(j)};react_production_min.useState=function(j){return U$1.current.useState(j)};react_production_min.useSyncExternalStore=function(j,$,_e){return U$1.current.useSyncExternalStore(j,$,_e)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React$4=getDefaultExportFromCjs$1(reactExports),React$5=_mergeNamespaces({__proto__:null,default:React$4},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q(j,$,_e){var et,tt={},nt=null,rt=null;_e!==void 0&&(nt=""+_e),$.key!==void 0&&(nt=""+$.key),$.ref!==void 0&&(rt=$.ref);for(et in $)m$2.call($,et)&&!p$2.hasOwnProperty(et)&&(tt[et]=$[et]);if(j&&j.defaultProps)for(et in $=j.defaultProps,$)tt[et]===void 0&&(tt[et]=$[et]);return{$$typeof:k$2,type:j,key:nt,ref:rt,props:tt,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(j){function $(Nt,Bt){var kt=Nt.length;Nt.push(Bt);e:for(;0<kt;){var rn=kt-1>>>1,Gt=Nt[rn];if(0<tt(Gt,Bt))Nt[rn]=Bt,Nt[kt]=Gt,kt=rn;else break e}}function _e(Nt){return Nt.length===0?null:Nt[0]}function et(Nt){if(Nt.length===0)return null;var Bt=Nt[0],kt=Nt.pop();if(kt!==Bt){Nt[0]=kt;e:for(var rn=0,Gt=Nt.length,_t=Gt>>>1;rn<_t;){var sn=2*(rn+1)-1,tn=Nt[sn],on=sn+1,It=Nt[on];if(0>tt(tn,kt))on<Gt&&0>tt(It,tn)?(Nt[rn]=It,Nt[on]=kt,rn=on):(Nt[rn]=tn,Nt[sn]=kt,rn=sn);else if(on<Gt&&0>tt(It,kt))Nt[rn]=It,Nt[on]=kt,rn=on;else break e}}return Bt}function tt(Nt,Bt){var kt=Nt.sortIndex-Bt.sortIndex;return kt!==0?kt:Nt.id-Bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var nt=performance;j.unstable_now=function(){return nt.now()}}else{var rt=Date,it=rt.now();j.unstable_now=function(){return rt.now()-it}}var st=[],at=[],ot=1,ct=null,lt=3,ut=!1,pt=!1,dt=!1,ht=typeof setTimeout=="function"?setTimeout:null,ft=typeof clearTimeout=="function"?clearTimeout:null,mt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function gt(Nt){for(var Bt=_e(at);Bt!==null;){if(Bt.callback===null)et(at);else if(Bt.startTime<=Nt)et(at),Bt.sortIndex=Bt.expirationTime,$(st,Bt);else break;Bt=_e(at)}}function yt(Nt){if(dt=!1,gt(Nt),!pt)if(_e(st)!==null)pt=!0,Kt(vt);else{var Bt=_e(at);Bt!==null&&Lt(yt,Bt.startTime-Nt)}}function vt(Nt,Bt){pt=!1,dt&&(dt=!1,ft(Et),Et=-1),ut=!0;var kt=lt;try{for(gt(Bt),ct=_e(st);ct!==null&&(!(ct.expirationTime>Bt)||Nt&&!Ct());){var rn=ct.callback;if(typeof rn=="function"){ct.callback=null,lt=ct.priorityLevel;var Gt=rn(ct.expirationTime<=Bt);Bt=j.unstable_now(),typeof Gt=="function"?ct.callback=Gt:ct===_e(st)&&et(st),gt(Bt)}else et(st);ct=_e(st)}if(ct!==null)var _t=!0;else{var sn=_e(at);sn!==null&&Lt(yt,sn.startTime-Bt),_t=!1}return _t}finally{ct=null,lt=kt,ut=!1}}var xt=!1,St=null,Et=-1,wt=5,Tt=-1;function Ct(){return!(j.unstable_now()-Tt<wt)}function Rt(){if(St!==null){var Nt=j.unstable_now();Tt=Nt;var Bt=!0;try{Bt=St(!0,Nt)}finally{Bt?jt():(xt=!1,St=null)}}else xt=!1}var jt;if(typeof mt=="function")jt=function(){mt(Rt)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,$t=Ot.port2;Ot.port1.onmessage=Rt,jt=function(){$t.postMessage(null)}}else jt=function(){ht(Rt,0)};function Kt(Nt){St=Nt,xt||(xt=!0,jt())}function Lt(Nt,Bt){Et=ht(function(){Nt(j.unstable_now())},Bt)}j.unstable_IdlePriority=5,j.unstable_ImmediatePriority=1,j.unstable_LowPriority=4,j.unstable_NormalPriority=3,j.unstable_Profiling=null,j.unstable_UserBlockingPriority=2,j.unstable_cancelCallback=function(Nt){Nt.callback=null},j.unstable_continueExecution=function(){pt||ut||(pt=!0,Kt(vt))},j.unstable_forceFrameRate=function(Nt){0>Nt||125<Nt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):wt=0<Nt?Math.floor(1e3/Nt):5},j.unstable_getCurrentPriorityLevel=function(){return lt},j.unstable_getFirstCallbackNode=function(){return _e(st)},j.unstable_next=function(Nt){switch(lt){case 1:case 2:case 3:var Bt=3;break;default:Bt=lt}var kt=lt;lt=Bt;try{return Nt()}finally{lt=kt}},j.unstable_pauseExecution=function(){},j.unstable_requestPaint=function(){},j.unstable_runWithPriority=function(Nt,Bt){switch(Nt){case 1:case 2:case 3:case 4:case 5:break;default:Nt=3}var kt=lt;lt=Nt;try{return Bt()}finally{lt=kt}},j.unstable_scheduleCallback=function(Nt,Bt,kt){var rn=j.unstable_now();switch(typeof kt=="object"&&kt!==null?(kt=kt.delay,kt=typeof kt=="number"&&0<kt?rn+kt:rn):kt=rn,Nt){case 1:var Gt=-1;break;case 2:Gt=250;break;case 5:Gt=1073741823;break;case 4:Gt=1e4;break;default:Gt=5e3}return Gt=kt+Gt,Nt={id:ot++,callback:Bt,priorityLevel:Nt,startTime:kt,expirationTime:Gt,sortIndex:-1},kt>rn?(Nt.sortIndex=kt,$(at,Nt),_e(st)===null&&Nt===_e(at)&&(dt?(ft(Et),Et=-1):dt=!0,Lt(yt,kt-rn))):(Nt.sortIndex=Gt,$(st,Nt),pt||ut||(pt=!0,Kt(vt))),Nt},j.unstable_shouldYield=Ct,j.unstable_wrapCallback=function(Nt){var Bt=lt;return function(){var kt=lt;lt=Bt;try{return Nt.apply(this,arguments)}finally{lt=kt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(j){for(var $="https://reactjs.org/docs/error-decoder.html?invariant="+j,_e=1;_e<arguments.length;_e++)$+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified React error #"+j+"; visit "+$+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(j,$){ha(j,$),ha(j+"Capture",$)}function ha(j,$){for(ea[j]=$,j=0;j<$.length;j++)da.add($[j])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(j){return ja.call(ma,j)?!0:ja.call(la,j)?!1:ka$1.test(j)?ma[j]=!0:(la[j]=!0,!1)}function pa(j,$,_e,et){if(_e!==null&&_e.type===0)return!1;switch(typeof $){case"function":case"symbol":return!0;case"boolean":return et?!1:_e!==null?!_e.acceptsBooleans:(j=j.toLowerCase().slice(0,5),j!=="data-"&&j!=="aria-");default:return!1}}function qa(j,$,_e,et){if($===null||typeof $>"u"||pa(j,$,_e,et))return!0;if(et)return!1;if(_e!==null)switch(_e.type){case 3:return!$;case 4:return $===!1;case 5:return isNaN($);case 6:return isNaN($)||1>$}return!1}function v$1(j,$,_e,et,tt,nt,rt){this.acceptsBooleans=$===2||$===3||$===4,this.attributeName=et,this.attributeNamespace=tt,this.mustUseProperty=_e,this.propertyName=j,this.type=$,this.sanitizeURL=nt,this.removeEmptyString=rt}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(j){z[j]=new v$1(j,0,!1,j,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(j){var $=j[0];z[$]=new v$1($,1,!1,j[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(j){z[j]=new v$1(j,2,!1,j.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(j){z[j]=new v$1(j,2,!1,j,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(j){z[j]=new v$1(j,3,!1,j.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(j){z[j]=new v$1(j,3,!0,j,null,!1,!1)});["capture","download"].forEach(function(j){z[j]=new v$1(j,4,!1,j,null,!1,!1)});["cols","rows","size","span"].forEach(function(j){z[j]=new v$1(j,6,!1,j,null,!1,!1)});["rowSpan","start"].forEach(function(j){z[j]=new v$1(j,5,!1,j.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(j){return j[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(j){var $=j.replace(ra,sa);z[$]=new v$1($,1,!1,j,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(j){var $=j.replace(ra,sa);z[$]=new v$1($,1,!1,j,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(j){var $=j.replace(ra,sa);z[$]=new v$1($,1,!1,j,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(j){z[j]=new v$1(j,1,!1,j.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(j){z[j]=new v$1(j,1,!1,j.toLowerCase(),null,!0,!0)});function ta(j,$,_e,et){var tt=z.hasOwnProperty($)?z[$]:null;(tt!==null?tt.type!==0:et||!(2<$.length)||$[0]!=="o"&&$[0]!=="O"||$[1]!=="n"&&$[1]!=="N")&&(qa($,_e,tt,et)&&(_e=null),et||tt===null?oa($)&&(_e===null?j.removeAttribute($):j.setAttribute($,""+_e)):tt.mustUseProperty?j[tt.propertyName]=_e===null?tt.type===3?!1:"":_e:($=tt.attributeName,et=tt.attributeNamespace,_e===null?j.removeAttribute($):(tt=tt.type,_e=tt===3||tt===4&&_e===!0?"":""+_e,et?j.setAttributeNS(et,$,_e):j.setAttribute($,_e))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(j){return j===null||typeof j!="object"?null:(j=Ja&&j[Ja]||j["@@iterator"],typeof j=="function"?j:null)}var A$1=Object.assign,La;function Ma(j){if(La===void 0)try{throw Error()}catch(_e){var $=_e.stack.trim().match(/\n( *(at )?)/);La=$&&$[1]||""}return`
`+La+j}var Na=!1;function Oa(j,$){if(!j||Na)return"";Na=!0;var _e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if($)if($=function(){throw Error()},Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(at){var et=at}Reflect.construct(j,[],$)}else{try{$.call()}catch(at){et=at}j.call($.prototype)}else{try{throw Error()}catch(at){et=at}j()}}catch(at){if(at&&et&&typeof at.stack=="string"){for(var tt=at.stack.split(`
`),nt=et.stack.split(`
`),rt=tt.length-1,it=nt.length-1;1<=rt&&0<=it&&tt[rt]!==nt[it];)it--;for(;1<=rt&&0<=it;rt--,it--)if(tt[rt]!==nt[it]){if(rt!==1||it!==1)do if(rt--,it--,0>it||tt[rt]!==nt[it]){var st=`
`+tt[rt].replace(" at new "," at ");return j.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",j.displayName)),st}while(1<=rt&&0<=it);break}}}finally{Na=!1,Error.prepareStackTrace=_e}return(j=j?j.displayName||j.name:"")?Ma(j):""}function Pa(j){switch(j.tag){case 5:return Ma(j.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return j=Oa(j.type,!1),j;case 11:return j=Oa(j.type.render,!1),j;case 1:return j=Oa(j.type,!0),j;default:return""}}function Qa(j){if(j==null)return null;if(typeof j=="function")return j.displayName||j.name||null;if(typeof j=="string")return j;switch(j){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof j=="object")switch(j.$$typeof){case Ca:return(j.displayName||"Context")+".Consumer";case Ba:return(j._context.displayName||"Context")+".Provider";case Da:var $=j.render;return j=j.displayName,j||(j=$.displayName||$.name||"",j=j!==""?"ForwardRef("+j+")":"ForwardRef"),j;case Ga:return $=j.displayName||null,$!==null?$:Qa(j.type)||"Memo";case Ha:$=j._payload,j=j._init;try{return Qa(j($))}catch{}}return null}function Ra(j){var $=j.type;switch(j.tag){case 24:return"Cache";case 9:return($.displayName||"Context")+".Consumer";case 10:return($._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return j=$.render,j=j.displayName||j.name||"",$.displayName||(j!==""?"ForwardRef("+j+")":"ForwardRef");case 7:return"Fragment";case 5:return $;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa($);case 8:return $===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof $=="function")return $.displayName||$.name||null;if(typeof $=="string")return $}return null}function Sa(j){switch(typeof j){case"boolean":case"number":case"string":case"undefined":return j;case"object":return j;default:return""}}function Ta(j){var $=j.type;return(j=j.nodeName)&&j.toLowerCase()==="input"&&($==="checkbox"||$==="radio")}function Ua(j){var $=Ta(j)?"checked":"value",_e=Object.getOwnPropertyDescriptor(j.constructor.prototype,$),et=""+j[$];if(!j.hasOwnProperty($)&&typeof _e<"u"&&typeof _e.get=="function"&&typeof _e.set=="function"){var tt=_e.get,nt=_e.set;return Object.defineProperty(j,$,{configurable:!0,get:function(){return tt.call(this)},set:function(rt){et=""+rt,nt.call(this,rt)}}),Object.defineProperty(j,$,{enumerable:_e.enumerable}),{getValue:function(){return et},setValue:function(rt){et=""+rt},stopTracking:function(){j._valueTracker=null,delete j[$]}}}}function Va(j){j._valueTracker||(j._valueTracker=Ua(j))}function Wa(j){if(!j)return!1;var $=j._valueTracker;if(!$)return!0;var _e=$.getValue(),et="";return j&&(et=Ta(j)?j.checked?"true":"false":j.value),j=et,j!==_e?($.setValue(j),!0):!1}function Xa(j){if(j=j||(typeof document<"u"?document:void 0),typeof j>"u")return null;try{return j.activeElement||j.body}catch{return j.body}}function Ya(j,$){var _e=$.checked;return A$1({},$,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_e??j._wrapperState.initialChecked})}function Za(j,$){var _e=$.defaultValue==null?"":$.defaultValue,et=$.checked!=null?$.checked:$.defaultChecked;_e=Sa($.value!=null?$.value:_e),j._wrapperState={initialChecked:et,initialValue:_e,controlled:$.type==="checkbox"||$.type==="radio"?$.checked!=null:$.value!=null}}function ab(j,$){$=$.checked,$!=null&&ta(j,"checked",$,!1)}function bb(j,$){ab(j,$);var _e=Sa($.value),et=$.type;if(_e!=null)et==="number"?(_e===0&&j.value===""||j.value!=_e)&&(j.value=""+_e):j.value!==""+_e&&(j.value=""+_e);else if(et==="submit"||et==="reset"){j.removeAttribute("value");return}$.hasOwnProperty("value")?cb(j,$.type,_e):$.hasOwnProperty("defaultValue")&&cb(j,$.type,Sa($.defaultValue)),$.checked==null&&$.defaultChecked!=null&&(j.defaultChecked=!!$.defaultChecked)}function db(j,$,_e){if($.hasOwnProperty("value")||$.hasOwnProperty("defaultValue")){var et=$.type;if(!(et!=="submit"&&et!=="reset"||$.value!==void 0&&$.value!==null))return;$=""+j._wrapperState.initialValue,_e||$===j.value||(j.value=$),j.defaultValue=$}_e=j.name,_e!==""&&(j.name=""),j.defaultChecked=!!j._wrapperState.initialChecked,_e!==""&&(j.name=_e)}function cb(j,$,_e){($!=="number"||Xa(j.ownerDocument)!==j)&&(_e==null?j.defaultValue=""+j._wrapperState.initialValue:j.defaultValue!==""+_e&&(j.defaultValue=""+_e))}var eb=Array.isArray;function fb(j,$,_e,et){if(j=j.options,$){$={};for(var tt=0;tt<_e.length;tt++)$["$"+_e[tt]]=!0;for(_e=0;_e<j.length;_e++)tt=$.hasOwnProperty("$"+j[_e].value),j[_e].selected!==tt&&(j[_e].selected=tt),tt&&et&&(j[_e].defaultSelected=!0)}else{for(_e=""+Sa(_e),$=null,tt=0;tt<j.length;tt++){if(j[tt].value===_e){j[tt].selected=!0,et&&(j[tt].defaultSelected=!0);return}$!==null||j[tt].disabled||($=j[tt])}$!==null&&($.selected=!0)}}function gb(j,$){if($.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},$,{value:void 0,defaultValue:void 0,children:""+j._wrapperState.initialValue})}function hb(j,$){var _e=$.value;if(_e==null){if(_e=$.children,$=$.defaultValue,_e!=null){if($!=null)throw Error(p$1(92));if(eb(_e)){if(1<_e.length)throw Error(p$1(93));_e=_e[0]}$=_e}$==null&&($=""),_e=$}j._wrapperState={initialValue:Sa(_e)}}function ib(j,$){var _e=Sa($.value),et=Sa($.defaultValue);_e!=null&&(_e=""+_e,_e!==j.value&&(j.value=_e),$.defaultValue==null&&j.defaultValue!==_e&&(j.defaultValue=_e)),et!=null&&(j.defaultValue=""+et)}function jb(j){var $=j.textContent;$===j._wrapperState.initialValue&&$!==""&&$!==null&&(j.value=$)}function kb(j){switch(j){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(j,$){return j==null||j==="http://www.w3.org/1999/xhtml"?kb($):j==="http://www.w3.org/2000/svg"&&$==="foreignObject"?"http://www.w3.org/1999/xhtml":j}var mb,nb=function(j){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function($,_e,et,tt){MSApp.execUnsafeLocalFunction(function(){return j($,_e,et,tt)})}:j}(function(j,$){if(j.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in j)j.innerHTML=$;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+$.valueOf().toString()+"</svg>",$=mb.firstChild;j.firstChild;)j.removeChild(j.firstChild);for(;$.firstChild;)j.appendChild($.firstChild)}});function ob(j,$){if($){var _e=j.firstChild;if(_e&&_e===j.lastChild&&_e.nodeType===3){_e.nodeValue=$;return}}j.textContent=$}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(j){qb.forEach(function($){$=$+j.charAt(0).toUpperCase()+j.substring(1),pb[$]=pb[j]})});function rb(j,$,_e){return $==null||typeof $=="boolean"||$===""?"":_e||typeof $!="number"||$===0||pb.hasOwnProperty(j)&&pb[j]?(""+$).trim():$+"px"}function sb(j,$){j=j.style;for(var _e in $)if($.hasOwnProperty(_e)){var et=_e.indexOf("--")===0,tt=rb(_e,$[_e],et);_e==="float"&&(_e="cssFloat"),et?j.setProperty(_e,tt):j[_e]=tt}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(j,$){if($){if(tb[j]&&($.children!=null||$.dangerouslySetInnerHTML!=null))throw Error(p$1(137,j));if($.dangerouslySetInnerHTML!=null){if($.children!=null)throw Error(p$1(60));if(typeof $.dangerouslySetInnerHTML!="object"||!("__html"in $.dangerouslySetInnerHTML))throw Error(p$1(61))}if($.style!=null&&typeof $.style!="object")throw Error(p$1(62))}}function vb(j,$){if(j.indexOf("-")===-1)return typeof $.is=="string";switch(j){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(j){return j=j.target||j.srcElement||window,j.correspondingUseElement&&(j=j.correspondingUseElement),j.nodeType===3?j.parentNode:j}var yb=null,zb=null,Ab=null;function Bb(j){if(j=Cb(j)){if(typeof yb!="function")throw Error(p$1(280));var $=j.stateNode;$&&($=Db($),yb(j.stateNode,j.type,$))}}function Eb(j){zb?Ab?Ab.push(j):Ab=[j]:zb=j}function Fb(){if(zb){var j=zb,$=Ab;if(Ab=zb=null,Bb(j),$)for(j=0;j<$.length;j++)Bb($[j])}}function Gb(j,$){return j($)}function Hb(){}var Ib=!1;function Jb(j,$,_e){if(Ib)return j($,_e);Ib=!0;try{return Gb(j,$,_e)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(j,$){var _e=j.stateNode;if(_e===null)return null;var et=Db(_e);if(et===null)return null;_e=et[$];e:switch($){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(et=!et.disabled)||(j=j.type,et=!(j==="button"||j==="input"||j==="select"||j==="textarea")),j=!et;break e;default:j=!1}if(j)return null;if(_e&&typeof _e!="function")throw Error(p$1(231,$,typeof _e));return _e}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(j,$,_e,et,tt,nt,rt,it,st){var at=Array.prototype.slice.call(arguments,3);try{$.apply(_e,at)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(j){Ob=!0,Pb=j}};function Tb(j,$,_e,et,tt,nt,rt,it,st){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(j,$,_e,et,tt,nt,rt,it,st){if(Tb.apply(this,arguments),Ob){if(Ob){var at=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=at)}}function Vb(j){var $=j,_e=j;if(j.alternate)for(;$.return;)$=$.return;else{j=$;do $=j,$.flags&4098&&(_e=$.return),j=$.return;while(j)}return $.tag===3?_e:null}function Wb(j){if(j.tag===13){var $=j.memoizedState;if($===null&&(j=j.alternate,j!==null&&($=j.memoizedState)),$!==null)return $.dehydrated}return null}function Xb(j){if(Vb(j)!==j)throw Error(p$1(188))}function Yb(j){var $=j.alternate;if(!$){if($=Vb(j),$===null)throw Error(p$1(188));return $!==j?null:j}for(var _e=j,et=$;;){var tt=_e.return;if(tt===null)break;var nt=tt.alternate;if(nt===null){if(et=tt.return,et!==null){_e=et;continue}break}if(tt.child===nt.child){for(nt=tt.child;nt;){if(nt===_e)return Xb(tt),j;if(nt===et)return Xb(tt),$;nt=nt.sibling}throw Error(p$1(188))}if(_e.return!==et.return)_e=tt,et=nt;else{for(var rt=!1,it=tt.child;it;){if(it===_e){rt=!0,_e=tt,et=nt;break}if(it===et){rt=!0,et=tt,_e=nt;break}it=it.sibling}if(!rt){for(it=nt.child;it;){if(it===_e){rt=!0,_e=nt,et=tt;break}if(it===et){rt=!0,et=nt,_e=tt;break}it=it.sibling}if(!rt)throw Error(p$1(189))}}if(_e.alternate!==et)throw Error(p$1(190))}if(_e.tag!==3)throw Error(p$1(188));return _e.stateNode.current===_e?j:$}function Zb(j){return j=Yb(j),j!==null?$b(j):null}function $b(j){if(j.tag===5||j.tag===6)return j;for(j=j.child;j!==null;){var $=$b(j);if($!==null)return $;j=j.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(j){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,j,void 0,(j.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(j){return j>>>=0,j===0?32:31-(pc(j)/qc|0)|0}var rc=64,sc=4194304;function tc(j){switch(j&-j){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return j&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return j&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return j}}function uc(j,$){var _e=j.pendingLanes;if(_e===0)return 0;var et=0,tt=j.suspendedLanes,nt=j.pingedLanes,rt=_e&268435455;if(rt!==0){var it=rt&~tt;it!==0?et=tc(it):(nt&=rt,nt!==0&&(et=tc(nt)))}else rt=_e&~tt,rt!==0?et=tc(rt):nt!==0&&(et=tc(nt));if(et===0)return 0;if($!==0&&$!==et&&!($&tt)&&(tt=et&-et,nt=$&-$,tt>=nt||tt===16&&(nt&4194240)!==0))return $;if(et&4&&(et|=_e&16),$=j.entangledLanes,$!==0)for(j=j.entanglements,$&=et;0<$;)_e=31-oc($),tt=1<<_e,et|=j[_e],$&=~tt;return et}function vc(j,$){switch(j){case 1:case 2:case 4:return $+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return $+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(j,$){for(var _e=j.suspendedLanes,et=j.pingedLanes,tt=j.expirationTimes,nt=j.pendingLanes;0<nt;){var rt=31-oc(nt),it=1<<rt,st=tt[rt];st===-1?(!(it&_e)||it&et)&&(tt[rt]=vc(it,$)):st<=$&&(j.expiredLanes|=it),nt&=~it}}function xc(j){return j=j.pendingLanes&-1073741825,j!==0?j:j&1073741824?1073741824:0}function yc(){var j=rc;return rc<<=1,!(rc&4194240)&&(rc=64),j}function zc(j){for(var $=[],_e=0;31>_e;_e++)$.push(j);return $}function Ac(j,$,_e){j.pendingLanes|=$,$!==536870912&&(j.suspendedLanes=0,j.pingedLanes=0),j=j.eventTimes,$=31-oc($),j[$]=_e}function Bc(j,$){var _e=j.pendingLanes&~$;j.pendingLanes=$,j.suspendedLanes=0,j.pingedLanes=0,j.expiredLanes&=$,j.mutableReadLanes&=$,j.entangledLanes&=$,$=j.entanglements;var et=j.eventTimes;for(j=j.expirationTimes;0<_e;){var tt=31-oc(_e),nt=1<<tt;$[tt]=0,et[tt]=-1,j[tt]=-1,_e&=~nt}}function Cc(j,$){var _e=j.entangledLanes|=$;for(j=j.entanglements;_e;){var et=31-oc(_e),tt=1<<et;tt&$|j[et]&$&&(j[et]|=$),_e&=~tt}}var C$1=0;function Dc(j){return j&=-j,1<j?4<j?j&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(j,$){switch(j){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete($.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete($.pointerId)}}function Tc(j,$,_e,et,tt,nt){return j===null||j.nativeEvent!==nt?(j={blockedOn:$,domEventName:_e,eventSystemFlags:et,nativeEvent:nt,targetContainers:[tt]},$!==null&&($=Cb($),$!==null&&Fc($)),j):(j.eventSystemFlags|=et,$=j.targetContainers,tt!==null&&$.indexOf(tt)===-1&&$.push(tt),j)}function Uc(j,$,_e,et,tt){switch($){case"focusin":return Lc=Tc(Lc,j,$,_e,et,tt),!0;case"dragenter":return Mc=Tc(Mc,j,$,_e,et,tt),!0;case"mouseover":return Nc=Tc(Nc,j,$,_e,et,tt),!0;case"pointerover":var nt=tt.pointerId;return Oc.set(nt,Tc(Oc.get(nt)||null,j,$,_e,et,tt)),!0;case"gotpointercapture":return nt=tt.pointerId,Pc.set(nt,Tc(Pc.get(nt)||null,j,$,_e,et,tt)),!0}return!1}function Vc(j){var $=Wc(j.target);if($!==null){var _e=Vb($);if(_e!==null){if($=_e.tag,$===13){if($=Wb(_e),$!==null){j.blockedOn=$,Ic(j.priority,function(){Gc(_e)});return}}else if($===3&&_e.stateNode.current.memoizedState.isDehydrated){j.blockedOn=_e.tag===3?_e.stateNode.containerInfo:null;return}}}j.blockedOn=null}function Xc(j){if(j.blockedOn!==null)return!1;for(var $=j.targetContainers;0<$.length;){var _e=Yc(j.domEventName,j.eventSystemFlags,$[0],j.nativeEvent);if(_e===null){_e=j.nativeEvent;var et=new _e.constructor(_e.type,_e);wb=et,_e.target.dispatchEvent(et),wb=null}else return $=Cb(_e),$!==null&&Fc($),j.blockedOn=_e,!1;$.shift()}return!0}function Zc(j,$,_e){Xc(j)&&_e.delete($)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(j,$){j.blockedOn===$&&(j.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(j){function $(tt){return ad(tt,j)}if(0<Kc.length){ad(Kc[0],j);for(var _e=1;_e<Kc.length;_e++){var et=Kc[_e];et.blockedOn===j&&(et.blockedOn=null)}}for(Lc!==null&&ad(Lc,j),Mc!==null&&ad(Mc,j),Nc!==null&&ad(Nc,j),Oc.forEach($),Pc.forEach($),_e=0;_e<Qc.length;_e++)et=Qc[_e],et.blockedOn===j&&(et.blockedOn=null);for(;0<Qc.length&&(_e=Qc[0],_e.blockedOn===null);)Vc(_e),_e.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(j,$,_e,et){var tt=C$1,nt=cd.transition;cd.transition=null;try{C$1=1,fd(j,$,_e,et)}finally{C$1=tt,cd.transition=nt}}function gd(j,$,_e,et){var tt=C$1,nt=cd.transition;cd.transition=null;try{C$1=4,fd(j,$,_e,et)}finally{C$1=tt,cd.transition=nt}}function fd(j,$,_e,et){if(dd){var tt=Yc(j,$,_e,et);if(tt===null)hd(j,$,et,id$2,_e),Sc(j,et);else if(Uc(tt,j,$,_e,et))et.stopPropagation();else if(Sc(j,et),$&4&&-1<Rc.indexOf(j)){for(;tt!==null;){var nt=Cb(tt);if(nt!==null&&Ec(nt),nt=Yc(j,$,_e,et),nt===null&&hd(j,$,et,id$2,_e),nt===tt)break;tt=nt}tt!==null&&et.stopPropagation()}else hd(j,$,et,null,_e)}}var id$2=null;function Yc(j,$,_e,et){if(id$2=null,j=xb(et),j=Wc(j),j!==null)if($=Vb(j),$===null)j=null;else if(_e=$.tag,_e===13){if(j=Wb($),j!==null)return j;j=null}else if(_e===3){if($.stateNode.current.memoizedState.isDehydrated)return $.tag===3?$.stateNode.containerInfo:null;j=null}else $!==j&&(j=null);return id$2=j,null}function jd(j){switch(j){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var j,$=ld,_e=$.length,et,tt="value"in kd?kd.value:kd.textContent,nt=tt.length;for(j=0;j<_e&&$[j]===tt[j];j++);var rt=_e-j;for(et=1;et<=rt&&$[_e-et]===tt[nt-et];et++);return md=tt.slice(j,1<et?1-et:void 0)}function od(j){var $=j.keyCode;return"charCode"in j?(j=j.charCode,j===0&&$===13&&(j=13)):j=$,j===10&&(j=13),32<=j||j===13?j:0}function pd(){return!0}function qd(){return!1}function rd(j){function $(_e,et,tt,nt,rt){this._reactName=_e,this._targetInst=tt,this.type=et,this.nativeEvent=nt,this.target=rt,this.currentTarget=null;for(var it in j)j.hasOwnProperty(it)&&(_e=j[it],this[it]=_e?_e(nt):nt[it]);return this.isDefaultPrevented=(nt.defaultPrevented!=null?nt.defaultPrevented:nt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1($.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _e=this.nativeEvent;_e&&(_e.preventDefault?_e.preventDefault():typeof _e.returnValue!="unknown"&&(_e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _e=this.nativeEvent;_e&&(_e.stopPropagation?_e.stopPropagation():typeof _e.cancelBubble!="unknown"&&(_e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),$}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(j){return j.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(j){return j.relatedTarget===void 0?j.fromElement===j.srcElement?j.toElement:j.fromElement:j.relatedTarget},movementX:function(j){return"movementX"in j?j.movementX:(j!==yd&&(yd&&j.type==="mousemove"?(wd=j.screenX-yd.screenX,xd=j.screenY-yd.screenY):xd=wd=0,yd=j),wd)},movementY:function(j){return"movementY"in j?j.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(j){return"clipboardData"in j?j.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(j){var $=this.nativeEvent;return $.getModifierState?$.getModifierState(j):(j=Od[j])?!!$[j]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(j){if(j.key){var $=Md[j.key]||j.key;if($!=="Unidentified")return $}return j.type==="keypress"?(j=od(j),j===13?"Enter":String.fromCharCode(j)):j.type==="keydown"||j.type==="keyup"?Nd[j.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(j){return j.type==="keypress"?od(j):0},keyCode:function(j){return j.type==="keydown"||j.type==="keyup"?j.keyCode:0},which:function(j){return j.type==="keypress"?od(j):j.type==="keydown"||j.type==="keyup"?j.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(j){return"deltaX"in j?j.deltaX:"wheelDeltaX"in j?-j.wheelDeltaX:0},deltaY:function(j){return"deltaY"in j?j.deltaY:"wheelDeltaY"in j?-j.wheelDeltaY:"wheelDelta"in j?-j.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(j,$){switch(j){case"keyup":return $d.indexOf($.keyCode)!==-1;case"keydown":return $.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(j){return j=j.detail,typeof j=="object"&&"data"in j?j.data:null}var ie=!1;function je(j,$){switch(j){case"compositionend":return he($);case"keypress":return $.which!==32?null:(fe=!0,ee);case"textInput":return j=$.data,j===ee&&fe?null:j;default:return null}}function ke(j,$){if(ie)return j==="compositionend"||!ae&&ge(j,$)?(j=nd(),md=ld=kd=null,ie=!1,j):null;switch(j){case"paste":return null;case"keypress":if(!($.ctrlKey||$.altKey||$.metaKey)||$.ctrlKey&&$.altKey){if($.char&&1<$.char.length)return $.char;if($.which)return String.fromCharCode($.which)}return null;case"compositionend":return de&&$.locale!=="ko"?null:$.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(j){var $=j&&j.nodeName&&j.nodeName.toLowerCase();return $==="input"?!!le[j.type]:$==="textarea"}function ne(j,$,_e,et){Eb(et),$=oe($,"onChange"),0<$.length&&(_e=new td("onChange","change",null,_e,et),j.push({event:_e,listeners:$}))}var pe=null,qe=null;function re$2(j){se(j,0)}function te(j){var $=ue(j);if(Wa($))return j}function ve(j,$){if(j==="change")return $}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(j){if(j.propertyName==="value"&&te(qe)){var $=[];ne($,qe,j,xb(j)),Jb(re$2,$)}}function Ce(j,$,_e){j==="focusin"?(Ae(),pe=$,qe=_e,pe.attachEvent("onpropertychange",Be)):j==="focusout"&&Ae()}function De(j){if(j==="selectionchange"||j==="keyup"||j==="keydown")return te(qe)}function Ee(j,$){if(j==="click")return te($)}function Fe(j,$){if(j==="input"||j==="change")return te($)}function Ge(j,$){return j===$&&(j!==0||1/j===1/$)||j!==j&&$!==$}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(j,$){if(He(j,$))return!0;if(typeof j!="object"||j===null||typeof $!="object"||$===null)return!1;var _e=Object.keys(j),et=Object.keys($);if(_e.length!==et.length)return!1;for(et=0;et<_e.length;et++){var tt=_e[et];if(!ja.call($,tt)||!He(j[tt],$[tt]))return!1}return!0}function Je(j){for(;j&&j.firstChild;)j=j.firstChild;return j}function Ke(j,$){var _e=Je(j);j=0;for(var et;_e;){if(_e.nodeType===3){if(et=j+_e.textContent.length,j<=$&&et>=$)return{node:_e,offset:$-j};j=et}e:{for(;_e;){if(_e.nextSibling){_e=_e.nextSibling;break e}_e=_e.parentNode}_e=void 0}_e=Je(_e)}}function Le(j,$){return j&&$?j===$?!0:j&&j.nodeType===3?!1:$&&$.nodeType===3?Le(j,$.parentNode):"contains"in j?j.contains($):j.compareDocumentPosition?!!(j.compareDocumentPosition($)&16):!1:!1}function Me(){for(var j=window,$=Xa();$ instanceof j.HTMLIFrameElement;){try{var _e=typeof $.contentWindow.location.href=="string"}catch{_e=!1}if(_e)j=$.contentWindow;else break;$=Xa(j.document)}return $}function Ne(j){var $=j&&j.nodeName&&j.nodeName.toLowerCase();return $&&($==="input"&&(j.type==="text"||j.type==="search"||j.type==="tel"||j.type==="url"||j.type==="password")||$==="textarea"||j.contentEditable==="true")}function Oe(j){var $=Me(),_e=j.focusedElem,et=j.selectionRange;if($!==_e&&_e&&_e.ownerDocument&&Le(_e.ownerDocument.documentElement,_e)){if(et!==null&&Ne(_e)){if($=et.start,j=et.end,j===void 0&&(j=$),"selectionStart"in _e)_e.selectionStart=$,_e.selectionEnd=Math.min(j,_e.value.length);else if(j=($=_e.ownerDocument||document)&&$.defaultView||window,j.getSelection){j=j.getSelection();var tt=_e.textContent.length,nt=Math.min(et.start,tt);et=et.end===void 0?nt:Math.min(et.end,tt),!j.extend&&nt>et&&(tt=et,et=nt,nt=tt),tt=Ke(_e,nt);var rt=Ke(_e,et);tt&&rt&&(j.rangeCount!==1||j.anchorNode!==tt.node||j.anchorOffset!==tt.offset||j.focusNode!==rt.node||j.focusOffset!==rt.offset)&&($=$.createRange(),$.setStart(tt.node,tt.offset),j.removeAllRanges(),nt>et?(j.addRange($),j.extend(rt.node,rt.offset)):($.setEnd(rt.node,rt.offset),j.addRange($)))}}for($=[],j=_e;j=j.parentNode;)j.nodeType===1&&$.push({element:j,left:j.scrollLeft,top:j.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<$.length;_e++)j=$[_e],j.element.scrollLeft=j.left,j.element.scrollTop=j.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(j,$,_e){var et=_e.window===_e?_e.document:_e.nodeType===9?_e:_e.ownerDocument;Te||Qe==null||Qe!==Xa(et)||(et=Qe,"selectionStart"in et&&Ne(et)?et={start:et.selectionStart,end:et.selectionEnd}:(et=(et.ownerDocument&&et.ownerDocument.defaultView||window).getSelection(),et={anchorNode:et.anchorNode,anchorOffset:et.anchorOffset,focusNode:et.focusNode,focusOffset:et.focusOffset}),Se&&Ie(Se,et)||(Se=et,et=oe(Re,"onSelect"),0<et.length&&($=new td("onSelect","select",null,$,_e),j.push({event:$,listeners:et}),$.target=Qe)))}function Ve(j,$){var _e={};return _e[j.toLowerCase()]=$.toLowerCase(),_e["Webkit"+j]="webkit"+$,_e["Moz"+j]="moz"+$,_e}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(j){if(Xe[j])return Xe[j];if(!We[j])return j;var $=We[j],_e;for(_e in $)if($.hasOwnProperty(_e)&&_e in Ye)return Xe[j]=$[_e];return j}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(j,$){df.set(j,$),fa($,[j])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(j,$,_e){var et=j.type||"unknown-event";j.currentTarget=_e,Ub(et,$,void 0,j),j.currentTarget=null}function se(j,$){$=($&4)!==0;for(var _e=0;_e<j.length;_e++){var et=j[_e],tt=et.event;et=et.listeners;e:{var nt=void 0;if($)for(var rt=et.length-1;0<=rt;rt--){var it=et[rt],st=it.instance,at=it.currentTarget;if(it=it.listener,st!==nt&&tt.isPropagationStopped())break e;nf(tt,it,at),nt=st}else for(rt=0;rt<et.length;rt++){if(it=et[rt],st=it.instance,at=it.currentTarget,it=it.listener,st!==nt&&tt.isPropagationStopped())break e;nf(tt,it,at),nt=st}}}if(Qb)throw j=Rb,Qb=!1,Rb=null,j}function D$1(j,$){var _e=$[of];_e===void 0&&(_e=$[of]=new Set);var et=j+"__bubble";_e.has(et)||(pf($,j,2,!1),_e.add(et))}function qf(j,$,_e){var et=0;$&&(et|=4),pf(_e,j,et,$)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(j){if(!j[rf]){j[rf]=!0,da.forEach(function(_e){_e!=="selectionchange"&&(mf.has(_e)||qf(_e,!1,j),qf(_e,!0,j))});var $=j.nodeType===9?j:j.ownerDocument;$===null||$[rf]||($[rf]=!0,qf("selectionchange",!1,$))}}function pf(j,$,_e,et){switch(jd($)){case 1:var tt=ed;break;case 4:tt=gd;break;default:tt=fd}_e=tt.bind(null,$,_e,j),tt=void 0,!Lb||$!=="touchstart"&&$!=="touchmove"&&$!=="wheel"||(tt=!0),et?tt!==void 0?j.addEventListener($,_e,{capture:!0,passive:tt}):j.addEventListener($,_e,!0):tt!==void 0?j.addEventListener($,_e,{passive:tt}):j.addEventListener($,_e,!1)}function hd(j,$,_e,et,tt){var nt=et;if(!($&1)&&!($&2)&&et!==null)e:for(;;){if(et===null)return;var rt=et.tag;if(rt===3||rt===4){var it=et.stateNode.containerInfo;if(it===tt||it.nodeType===8&&it.parentNode===tt)break;if(rt===4)for(rt=et.return;rt!==null;){var st=rt.tag;if((st===3||st===4)&&(st=rt.stateNode.containerInfo,st===tt||st.nodeType===8&&st.parentNode===tt))return;rt=rt.return}for(;it!==null;){if(rt=Wc(it),rt===null)return;if(st=rt.tag,st===5||st===6){et=nt=rt;continue e}it=it.parentNode}}et=et.return}Jb(function(){var at=nt,ot=xb(_e),ct=[];e:{var lt=df.get(j);if(lt!==void 0){var ut=td,pt=j;switch(j){case"keypress":if(od(_e)===0)break e;case"keydown":case"keyup":ut=Rd;break;case"focusin":pt="focus",ut=Fd;break;case"focusout":pt="blur",ut=Fd;break;case"beforeblur":case"afterblur":ut=Fd;break;case"click":if(_e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=Vd;break;case $e:case af:case bf:ut=Hd;break;case cf:ut=Xd;break;case"scroll":ut=vd;break;case"wheel":ut=Zd;break;case"copy":case"cut":case"paste":ut=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=Td}var dt=($&4)!==0,ht=!dt&&j==="scroll",ft=dt?lt!==null?lt+"Capture":null:lt;dt=[];for(var mt=at,gt;mt!==null;){gt=mt;var yt=gt.stateNode;if(gt.tag===5&&yt!==null&&(gt=yt,ft!==null&&(yt=Kb(mt,ft),yt!=null&&dt.push(tf(mt,yt,gt)))),ht)break;mt=mt.return}0<dt.length&&(lt=new ut(lt,pt,null,_e,ot),ct.push({event:lt,listeners:dt}))}}if(!($&7)){e:{if(lt=j==="mouseover"||j==="pointerover",ut=j==="mouseout"||j==="pointerout",lt&&_e!==wb&&(pt=_e.relatedTarget||_e.fromElement)&&(Wc(pt)||pt[uf]))break e;if((ut||lt)&&(lt=ot.window===ot?ot:(lt=ot.ownerDocument)?lt.defaultView||lt.parentWindow:window,ut?(pt=_e.relatedTarget||_e.toElement,ut=at,pt=pt?Wc(pt):null,pt!==null&&(ht=Vb(pt),pt!==ht||pt.tag!==5&&pt.tag!==6)&&(pt=null)):(ut=null,pt=at),ut!==pt)){if(dt=Bd,yt="onMouseLeave",ft="onMouseEnter",mt="mouse",(j==="pointerout"||j==="pointerover")&&(dt=Td,yt="onPointerLeave",ft="onPointerEnter",mt="pointer"),ht=ut==null?lt:ue(ut),gt=pt==null?lt:ue(pt),lt=new dt(yt,mt+"leave",ut,_e,ot),lt.target=ht,lt.relatedTarget=gt,yt=null,Wc(ot)===at&&(dt=new dt(ft,mt+"enter",pt,_e,ot),dt.target=gt,dt.relatedTarget=ht,yt=dt),ht=yt,ut&&pt)t:{for(dt=ut,ft=pt,mt=0,gt=dt;gt;gt=vf(gt))mt++;for(gt=0,yt=ft;yt;yt=vf(yt))gt++;for(;0<mt-gt;)dt=vf(dt),mt--;for(;0<gt-mt;)ft=vf(ft),gt--;for(;mt--;){if(dt===ft||ft!==null&&dt===ft.alternate)break t;dt=vf(dt),ft=vf(ft)}dt=null}else dt=null;ut!==null&&wf(ct,lt,ut,dt,!1),pt!==null&&ht!==null&&wf(ct,ht,pt,dt,!0)}}e:{if(lt=at?ue(at):window,ut=lt.nodeName&&lt.nodeName.toLowerCase(),ut==="select"||ut==="input"&&lt.type==="file")var vt=ve;else if(me(lt))if(we)vt=Fe;else{vt=De;var xt=Ce}else(ut=lt.nodeName)&&ut.toLowerCase()==="input"&&(lt.type==="checkbox"||lt.type==="radio")&&(vt=Ee);if(vt&&(vt=vt(j,at))){ne(ct,vt,_e,ot);break e}xt&&xt(j,lt,at),j==="focusout"&&(xt=lt._wrapperState)&&xt.controlled&&lt.type==="number"&&cb(lt,"number",lt.value)}switch(xt=at?ue(at):window,j){case"focusin":(me(xt)||xt.contentEditable==="true")&&(Qe=xt,Re=at,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ct,_e,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ct,_e,ot)}var St;if(ae)e:{switch(j){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else ie?ge(j,_e)&&(Et="onCompositionEnd"):j==="keydown"&&_e.keyCode===229&&(Et="onCompositionStart");Et&&(de&&_e.locale!=="ko"&&(ie||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&ie&&(St=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),xt=oe(at,Et),0<xt.length&&(Et=new Ld(Et,j,null,_e,ot),ct.push({event:Et,listeners:xt}),St?Et.data=St:(St=he(_e),St!==null&&(Et.data=St)))),(St=ce?je(j,_e):ke(j,_e))&&(at=oe(at,"onBeforeInput"),0<at.length&&(ot=new Ld("onBeforeInput","beforeinput",null,_e,ot),ct.push({event:ot,listeners:at}),ot.data=St))}se(ct,$)})}function tf(j,$,_e){return{instance:j,listener:$,currentTarget:_e}}function oe(j,$){for(var _e=$+"Capture",et=[];j!==null;){var tt=j,nt=tt.stateNode;tt.tag===5&&nt!==null&&(tt=nt,nt=Kb(j,_e),nt!=null&&et.unshift(tf(j,nt,tt)),nt=Kb(j,$),nt!=null&&et.push(tf(j,nt,tt))),j=j.return}return et}function vf(j){if(j===null)return null;do j=j.return;while(j&&j.tag!==5);return j||null}function wf(j,$,_e,et,tt){for(var nt=$._reactName,rt=[];_e!==null&&_e!==et;){var it=_e,st=it.alternate,at=it.stateNode;if(st!==null&&st===et)break;it.tag===5&&at!==null&&(it=at,tt?(st=Kb(_e,nt),st!=null&&rt.unshift(tf(_e,st,it))):tt||(st=Kb(_e,nt),st!=null&&rt.push(tf(_e,st,it)))),_e=_e.return}rt.length!==0&&j.push({event:$,listeners:rt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(j){return(typeof j=="string"?j:""+j).replace(xf,`
`).replace(yf,"")}function Af(j,$,_e){if($=zf($),zf(j)!==$&&_e)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(j,$){return j==="textarea"||j==="noscript"||typeof $.children=="string"||typeof $.children=="number"||typeof $.dangerouslySetInnerHTML=="object"&&$.dangerouslySetInnerHTML!==null&&$.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(j){return Hf.resolve(null).then(j).catch(If)}:Ff;function If(j){setTimeout(function(){throw j})}function Kf(j,$){var _e=$,et=0;do{var tt=_e.nextSibling;if(j.removeChild(_e),tt&&tt.nodeType===8)if(_e=tt.data,_e==="/$"){if(et===0){j.removeChild(tt),bd($);return}et--}else _e!=="$"&&_e!=="$?"&&_e!=="$!"||et++;_e=tt}while(_e);bd($)}function Lf(j){for(;j!=null;j=j.nextSibling){var $=j.nodeType;if($===1||$===3)break;if($===8){if($=j.data,$==="$"||$==="$!"||$==="$?")break;if($==="/$")return null}}return j}function Mf(j){j=j.previousSibling;for(var $=0;j;){if(j.nodeType===8){var _e=j.data;if(_e==="$"||_e==="$!"||_e==="$?"){if($===0)return j;$--}else _e==="/$"&&$++}j=j.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(j){var $=j[Of];if($)return $;for(var _e=j.parentNode;_e;){if($=_e[uf]||_e[Of]){if(_e=$.alternate,$.child!==null||_e!==null&&_e.child!==null)for(j=Mf(j);j!==null;){if(_e=j[Of])return _e;j=Mf(j)}return $}j=_e,_e=j.parentNode}return null}function Cb(j){return j=j[Of]||j[uf],!j||j.tag!==5&&j.tag!==6&&j.tag!==13&&j.tag!==3?null:j}function ue(j){if(j.tag===5||j.tag===6)return j.stateNode;throw Error(p$1(33))}function Db(j){return j[Pf]||null}var Sf=[],Tf=-1;function Uf(j){return{current:j}}function E$1(j){0>Tf||(j.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(j,$){Tf++,Sf[Tf]=j.current,j.current=$}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(j,$){var _e=j.type.contextTypes;if(!_e)return Vf;var et=j.stateNode;if(et&&et.__reactInternalMemoizedUnmaskedChildContext===$)return et.__reactInternalMemoizedMaskedChildContext;var tt={},nt;for(nt in _e)tt[nt]=$[nt];return et&&(j=j.stateNode,j.__reactInternalMemoizedUnmaskedChildContext=$,j.__reactInternalMemoizedMaskedChildContext=tt),tt}function Zf(j){return j=j.childContextTypes,j!=null}function $f(){E$1(Wf),E$1(H)}function ag(j,$,_e){if(H.current!==Vf)throw Error(p$1(168));G(H,$),G(Wf,_e)}function bg(j,$,_e){var et=j.stateNode;if($=$.childContextTypes,typeof et.getChildContext!="function")return _e;et=et.getChildContext();for(var tt in et)if(!(tt in $))throw Error(p$1(108,Ra(j)||"Unknown",tt));return A$1({},_e,et)}function cg(j){return j=(j=j.stateNode)&&j.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,j),G(Wf,Wf.current),!0}function dg(j,$,_e){var et=j.stateNode;if(!et)throw Error(p$1(169));_e?(j=bg(j,$,Xf),et.__reactInternalMemoizedMergedChildContext=j,E$1(Wf),E$1(H),G(H,j)):E$1(Wf),G(Wf,_e)}var eg=null,fg=!1,gg=!1;function hg(j){eg===null?eg=[j]:eg.push(j)}function ig(j){fg=!0,hg(j)}function jg(){if(!gg&&eg!==null){gg=!0;var j=0,$=C$1;try{var _e=eg;for(C$1=1;j<_e.length;j++){var et=_e[j];do et=et(!0);while(et!==null)}eg=null,fg=!1}catch(tt){throw eg!==null&&(eg=eg.slice(j+1)),ac(fc,jg),tt}finally{C$1=$,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(j,$){kg[lg++]=ng,kg[lg++]=mg,mg=j,ng=$}function ug(j,$,_e){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=j;var et=rg;j=sg;var tt=32-oc(et)-1;et&=~(1<<tt),_e+=1;var nt=32-oc($)+tt;if(30<nt){var rt=tt-tt%5;nt=(et&(1<<rt)-1).toString(32),et>>=rt,tt-=rt,rg=1<<32-oc($)+tt|_e<<tt|et,sg=nt+j}else rg=1<<nt|_e<<tt|et,sg=j}function vg(j){j.return!==null&&(tg(j,1),ug(j,1,0))}function wg(j){for(;j===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;j===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(j,$){var _e=Bg(5,null,null,0);_e.elementType="DELETED",_e.stateNode=$,_e.return=j,$=j.deletions,$===null?(j.deletions=[_e],j.flags|=16):$.push(_e)}function Cg(j,$){switch(j.tag){case 5:var _e=j.type;return $=$.nodeType!==1||_e.toLowerCase()!==$.nodeName.toLowerCase()?null:$,$!==null?(j.stateNode=$,xg=j,yg=Lf($.firstChild),!0):!1;case 6:return $=j.pendingProps===""||$.nodeType!==3?null:$,$!==null?(j.stateNode=$,xg=j,yg=null,!0):!1;case 13:return $=$.nodeType!==8?null:$,$!==null?(_e=qg!==null?{id:rg,overflow:sg}:null,j.memoizedState={dehydrated:$,treeContext:_e,retryLane:1073741824},_e=Bg(18,null,null,0),_e.stateNode=$,_e.return=j,j.child=_e,xg=j,yg=null,!0):!1;default:return!1}}function Dg(j){return(j.mode&1)!==0&&(j.flags&128)===0}function Eg(j){if(I$1){var $=yg;if($){var _e=$;if(!Cg(j,$)){if(Dg(j))throw Error(p$1(418));$=Lf(_e.nextSibling);var et=xg;$&&Cg(j,$)?Ag(et,_e):(j.flags=j.flags&-4097|2,I$1=!1,xg=j)}}else{if(Dg(j))throw Error(p$1(418));j.flags=j.flags&-4097|2,I$1=!1,xg=j}}}function Fg(j){for(j=j.return;j!==null&&j.tag!==5&&j.tag!==3&&j.tag!==13;)j=j.return;xg=j}function Gg(j){if(j!==xg)return!1;if(!I$1)return Fg(j),I$1=!0,!1;var $;if(($=j.tag!==3)&&!($=j.tag!==5)&&($=j.type,$=$!=="head"&&$!=="body"&&!Ef(j.type,j.memoizedProps)),$&&($=yg)){if(Dg(j))throw Hg(),Error(p$1(418));for(;$;)Ag(j,$),$=Lf($.nextSibling)}if(Fg(j),j.tag===13){if(j=j.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(p$1(317));e:{for(j=j.nextSibling,$=0;j;){if(j.nodeType===8){var _e=j.data;if(_e==="/$"){if($===0){yg=Lf(j.nextSibling);break e}$--}else _e!=="$"&&_e!=="$!"&&_e!=="$?"||$++}j=j.nextSibling}yg=null}}else yg=xg?Lf(j.stateNode.nextSibling):null;return!0}function Hg(){for(var j=yg;j;)j=Lf(j.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(j){zg===null?zg=[j]:zg.push(j)}var Kg=ua.ReactCurrentBatchConfig;function Lg(j,$,_e){if(j=_e.ref,j!==null&&typeof j!="function"&&typeof j!="object"){if(_e._owner){if(_e=_e._owner,_e){if(_e.tag!==1)throw Error(p$1(309));var et=_e.stateNode}if(!et)throw Error(p$1(147,j));var tt=et,nt=""+j;return $!==null&&$.ref!==null&&typeof $.ref=="function"&&$.ref._stringRef===nt?$.ref:($=function(rt){var it=tt.refs;rt===null?delete it[nt]:it[nt]=rt},$._stringRef=nt,$)}if(typeof j!="string")throw Error(p$1(284));if(!_e._owner)throw Error(p$1(290,j))}return j}function Mg(j,$){throw j=Object.prototype.toString.call($),Error(p$1(31,j==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":j))}function Ng(j){var $=j._init;return $(j._payload)}function Og(j){function $(ft,mt){if(j){var gt=ft.deletions;gt===null?(ft.deletions=[mt],ft.flags|=16):gt.push(mt)}}function _e(ft,mt){if(!j)return null;for(;mt!==null;)$(ft,mt),mt=mt.sibling;return null}function et(ft,mt){for(ft=new Map;mt!==null;)mt.key!==null?ft.set(mt.key,mt):ft.set(mt.index,mt),mt=mt.sibling;return ft}function tt(ft,mt){return ft=Pg(ft,mt),ft.index=0,ft.sibling=null,ft}function nt(ft,mt,gt){return ft.index=gt,j?(gt=ft.alternate,gt!==null?(gt=gt.index,gt<mt?(ft.flags|=2,mt):gt):(ft.flags|=2,mt)):(ft.flags|=1048576,mt)}function rt(ft){return j&&ft.alternate===null&&(ft.flags|=2),ft}function it(ft,mt,gt,yt){return mt===null||mt.tag!==6?(mt=Qg(gt,ft.mode,yt),mt.return=ft,mt):(mt=tt(mt,gt),mt.return=ft,mt)}function st(ft,mt,gt,yt){var vt=gt.type;return vt===ya?ot(ft,mt,gt.props.children,yt,gt.key):mt!==null&&(mt.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ha&&Ng(vt)===mt.type)?(yt=tt(mt,gt.props),yt.ref=Lg(ft,mt,gt),yt.return=ft,yt):(yt=Rg(gt.type,gt.key,gt.props,null,ft.mode,yt),yt.ref=Lg(ft,mt,gt),yt.return=ft,yt)}function at(ft,mt,gt,yt){return mt===null||mt.tag!==4||mt.stateNode.containerInfo!==gt.containerInfo||mt.stateNode.implementation!==gt.implementation?(mt=Sg(gt,ft.mode,yt),mt.return=ft,mt):(mt=tt(mt,gt.children||[]),mt.return=ft,mt)}function ot(ft,mt,gt,yt,vt){return mt===null||mt.tag!==7?(mt=Tg(gt,ft.mode,yt,vt),mt.return=ft,mt):(mt=tt(mt,gt),mt.return=ft,mt)}function ct(ft,mt,gt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return mt=Qg(""+mt,ft.mode,gt),mt.return=ft,mt;if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return gt=Rg(mt.type,mt.key,mt.props,null,ft.mode,gt),gt.ref=Lg(ft,null,mt),gt.return=ft,gt;case wa:return mt=Sg(mt,ft.mode,gt),mt.return=ft,mt;case Ha:var yt=mt._init;return ct(ft,yt(mt._payload),gt)}if(eb(mt)||Ka(mt))return mt=Tg(mt,ft.mode,gt,null),mt.return=ft,mt;Mg(ft,mt)}return null}function lt(ft,mt,gt,yt){var vt=mt!==null?mt.key:null;if(typeof gt=="string"&&gt!==""||typeof gt=="number")return vt!==null?null:it(ft,mt,""+gt,yt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case va:return gt.key===vt?st(ft,mt,gt,yt):null;case wa:return gt.key===vt?at(ft,mt,gt,yt):null;case Ha:return vt=gt._init,lt(ft,mt,vt(gt._payload),yt)}if(eb(gt)||Ka(gt))return vt!==null?null:ot(ft,mt,gt,yt,null);Mg(ft,gt)}return null}function ut(ft,mt,gt,yt,vt){if(typeof yt=="string"&&yt!==""||typeof yt=="number")return ft=ft.get(gt)||null,it(mt,ft,""+yt,vt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:return ft=ft.get(yt.key===null?gt:yt.key)||null,st(mt,ft,yt,vt);case wa:return ft=ft.get(yt.key===null?gt:yt.key)||null,at(mt,ft,yt,vt);case Ha:var xt=yt._init;return ut(ft,mt,gt,xt(yt._payload),vt)}if(eb(yt)||Ka(yt))return ft=ft.get(gt)||null,ot(mt,ft,yt,vt,null);Mg(mt,yt)}return null}function pt(ft,mt,gt,yt){for(var vt=null,xt=null,St=mt,Et=mt=0,wt=null;St!==null&&Et<gt.length;Et++){St.index>Et?(wt=St,St=null):wt=St.sibling;var Tt=lt(ft,St,gt[Et],yt);if(Tt===null){St===null&&(St=wt);break}j&&St&&Tt.alternate===null&&$(ft,St),mt=nt(Tt,mt,Et),xt===null?vt=Tt:xt.sibling=Tt,xt=Tt,St=wt}if(Et===gt.length)return _e(ft,St),I$1&&tg(ft,Et),vt;if(St===null){for(;Et<gt.length;Et++)St=ct(ft,gt[Et],yt),St!==null&&(mt=nt(St,mt,Et),xt===null?vt=St:xt.sibling=St,xt=St);return I$1&&tg(ft,Et),vt}for(St=et(ft,St);Et<gt.length;Et++)wt=ut(St,ft,Et,gt[Et],yt),wt!==null&&(j&&wt.alternate!==null&&St.delete(wt.key===null?Et:wt.key),mt=nt(wt,mt,Et),xt===null?vt=wt:xt.sibling=wt,xt=wt);return j&&St.forEach(function(Ct){return $(ft,Ct)}),I$1&&tg(ft,Et),vt}function dt(ft,mt,gt,yt){var vt=Ka(gt);if(typeof vt!="function")throw Error(p$1(150));if(gt=vt.call(gt),gt==null)throw Error(p$1(151));for(var xt=vt=null,St=mt,Et=mt=0,wt=null,Tt=gt.next();St!==null&&!Tt.done;Et++,Tt=gt.next()){St.index>Et?(wt=St,St=null):wt=St.sibling;var Ct=lt(ft,St,Tt.value,yt);if(Ct===null){St===null&&(St=wt);break}j&&St&&Ct.alternate===null&&$(ft,St),mt=nt(Ct,mt,Et),xt===null?vt=Ct:xt.sibling=Ct,xt=Ct,St=wt}if(Tt.done)return _e(ft,St),I$1&&tg(ft,Et),vt;if(St===null){for(;!Tt.done;Et++,Tt=gt.next())Tt=ct(ft,Tt.value,yt),Tt!==null&&(mt=nt(Tt,mt,Et),xt===null?vt=Tt:xt.sibling=Tt,xt=Tt);return I$1&&tg(ft,Et),vt}for(St=et(ft,St);!Tt.done;Et++,Tt=gt.next())Tt=ut(St,ft,Et,Tt.value,yt),Tt!==null&&(j&&Tt.alternate!==null&&St.delete(Tt.key===null?Et:Tt.key),mt=nt(Tt,mt,Et),xt===null?vt=Tt:xt.sibling=Tt,xt=Tt);return j&&St.forEach(function(Rt){return $(ft,Rt)}),I$1&&tg(ft,Et),vt}function ht(ft,mt,gt,yt){if(typeof gt=="object"&&gt!==null&&gt.type===ya&&gt.key===null&&(gt=gt.props.children),typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case va:e:{for(var vt=gt.key,xt=mt;xt!==null;){if(xt.key===vt){if(vt=gt.type,vt===ya){if(xt.tag===7){_e(ft,xt.sibling),mt=tt(xt,gt.props.children),mt.return=ft,ft=mt;break e}}else if(xt.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ha&&Ng(vt)===xt.type){_e(ft,xt.sibling),mt=tt(xt,gt.props),mt.ref=Lg(ft,xt,gt),mt.return=ft,ft=mt;break e}_e(ft,xt);break}else $(ft,xt);xt=xt.sibling}gt.type===ya?(mt=Tg(gt.props.children,ft.mode,yt,gt.key),mt.return=ft,ft=mt):(yt=Rg(gt.type,gt.key,gt.props,null,ft.mode,yt),yt.ref=Lg(ft,mt,gt),yt.return=ft,ft=yt)}return rt(ft);case wa:e:{for(xt=gt.key;mt!==null;){if(mt.key===xt)if(mt.tag===4&&mt.stateNode.containerInfo===gt.containerInfo&&mt.stateNode.implementation===gt.implementation){_e(ft,mt.sibling),mt=tt(mt,gt.children||[]),mt.return=ft,ft=mt;break e}else{_e(ft,mt);break}else $(ft,mt);mt=mt.sibling}mt=Sg(gt,ft.mode,yt),mt.return=ft,ft=mt}return rt(ft);case Ha:return xt=gt._init,ht(ft,mt,xt(gt._payload),yt)}if(eb(gt))return pt(ft,mt,gt,yt);if(Ka(gt))return dt(ft,mt,gt,yt);Mg(ft,gt)}return typeof gt=="string"&&gt!==""||typeof gt=="number"?(gt=""+gt,mt!==null&&mt.tag===6?(_e(ft,mt.sibling),mt=tt(mt,gt),mt.return=ft,ft=mt):(_e(ft,mt),mt=Qg(gt,ft.mode,yt),mt.return=ft,ft=mt),rt(ft)):_e(ft,mt)}return ht}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(j){var $=Wg.current;E$1(Wg),j._currentValue=$}function bh(j,$,_e){for(;j!==null;){var et=j.alternate;if((j.childLanes&$)!==$?(j.childLanes|=$,et!==null&&(et.childLanes|=$)):et!==null&&(et.childLanes&$)!==$&&(et.childLanes|=$),j===_e)break;j=j.return}}function ch(j,$){Xg=j,Zg=Yg=null,j=j.dependencies,j!==null&&j.firstContext!==null&&(j.lanes&$&&(dh=!0),j.firstContext=null)}function eh(j){var $=j._currentValue;if(Zg!==j)if(j={context:j,memoizedValue:$,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=j,Xg.dependencies={lanes:0,firstContext:j}}else Yg=Yg.next=j;return $}var fh=null;function gh(j){fh===null?fh=[j]:fh.push(j)}function hh(j,$,_e,et){var tt=$.interleaved;return tt===null?(_e.next=_e,gh($)):(_e.next=tt.next,tt.next=_e),$.interleaved=_e,ih(j,et)}function ih(j,$){j.lanes|=$;var _e=j.alternate;for(_e!==null&&(_e.lanes|=$),_e=j,j=j.return;j!==null;)j.childLanes|=$,_e=j.alternate,_e!==null&&(_e.childLanes|=$),_e=j,j=j.return;return _e.tag===3?_e.stateNode:null}var jh=!1;function kh(j){j.updateQueue={baseState:j.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(j,$){j=j.updateQueue,$.updateQueue===j&&($.updateQueue={baseState:j.baseState,firstBaseUpdate:j.firstBaseUpdate,lastBaseUpdate:j.lastBaseUpdate,shared:j.shared,effects:j.effects})}function mh(j,$){return{eventTime:j,lane:$,tag:0,payload:null,callback:null,next:null}}function nh(j,$,_e){var et=j.updateQueue;if(et===null)return null;if(et=et.shared,K&2){var tt=et.pending;return tt===null?$.next=$:($.next=tt.next,tt.next=$),et.pending=$,ih(j,_e)}return tt=et.interleaved,tt===null?($.next=$,gh(et)):($.next=tt.next,tt.next=$),et.interleaved=$,ih(j,_e)}function oh(j,$,_e){if($=$.updateQueue,$!==null&&($=$.shared,(_e&4194240)!==0)){var et=$.lanes;et&=j.pendingLanes,_e|=et,$.lanes=_e,Cc(j,_e)}}function ph(j,$){var _e=j.updateQueue,et=j.alternate;if(et!==null&&(et=et.updateQueue,_e===et)){var tt=null,nt=null;if(_e=_e.firstBaseUpdate,_e!==null){do{var rt={eventTime:_e.eventTime,lane:_e.lane,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null};nt===null?tt=nt=rt:nt=nt.next=rt,_e=_e.next}while(_e!==null);nt===null?tt=nt=$:nt=nt.next=$}else tt=nt=$;_e={baseState:et.baseState,firstBaseUpdate:tt,lastBaseUpdate:nt,shared:et.shared,effects:et.effects},j.updateQueue=_e;return}j=_e.lastBaseUpdate,j===null?_e.firstBaseUpdate=$:j.next=$,_e.lastBaseUpdate=$}function qh(j,$,_e,et){var tt=j.updateQueue;jh=!1;var nt=tt.firstBaseUpdate,rt=tt.lastBaseUpdate,it=tt.shared.pending;if(it!==null){tt.shared.pending=null;var st=it,at=st.next;st.next=null,rt===null?nt=at:rt.next=at,rt=st;var ot=j.alternate;ot!==null&&(ot=ot.updateQueue,it=ot.lastBaseUpdate,it!==rt&&(it===null?ot.firstBaseUpdate=at:it.next=at,ot.lastBaseUpdate=st))}if(nt!==null){var ct=tt.baseState;rt=0,ot=at=st=null,it=nt;do{var lt=it.lane,ut=it.eventTime;if((et&lt)===lt){ot!==null&&(ot=ot.next={eventTime:ut,lane:0,tag:it.tag,payload:it.payload,callback:it.callback,next:null});e:{var pt=j,dt=it;switch(lt=$,ut=_e,dt.tag){case 1:if(pt=dt.payload,typeof pt=="function"){ct=pt.call(ut,ct,lt);break e}ct=pt;break e;case 3:pt.flags=pt.flags&-65537|128;case 0:if(pt=dt.payload,lt=typeof pt=="function"?pt.call(ut,ct,lt):pt,lt==null)break e;ct=A$1({},ct,lt);break e;case 2:jh=!0}}it.callback!==null&&it.lane!==0&&(j.flags|=64,lt=tt.effects,lt===null?tt.effects=[it]:lt.push(it))}else ut={eventTime:ut,lane:lt,tag:it.tag,payload:it.payload,callback:it.callback,next:null},ot===null?(at=ot=ut,st=ct):ot=ot.next=ut,rt|=lt;if(it=it.next,it===null){if(it=tt.shared.pending,it===null)break;lt=it,it=lt.next,lt.next=null,tt.lastBaseUpdate=lt,tt.shared.pending=null}}while(!0);if(ot===null&&(st=ct),tt.baseState=st,tt.firstBaseUpdate=at,tt.lastBaseUpdate=ot,$=tt.shared.interleaved,$!==null){tt=$;do rt|=tt.lane,tt=tt.next;while(tt!==$)}else nt===null&&(tt.shared.lanes=0);rh|=rt,j.lanes=rt,j.memoizedState=ct}}function sh(j,$,_e){if(j=$.effects,$.effects=null,j!==null)for($=0;$<j.length;$++){var et=j[$],tt=et.callback;if(tt!==null){if(et.callback=null,et=_e,typeof tt!="function")throw Error(p$1(191,tt));tt.call(et)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(j){if(j===th)throw Error(p$1(174));return j}function yh(j,$){switch(G(wh,$),G(vh$1,j),G(uh,th),j=$.nodeType,j){case 9:case 11:$=($=$.documentElement)?$.namespaceURI:lb(null,"");break;default:j=j===8?$.parentNode:$,$=j.namespaceURI||null,j=j.tagName,$=lb($,j)}E$1(uh),G(uh,$)}function zh(){E$1(uh),E$1(vh$1),E$1(wh)}function Ah(j){xh(wh.current);var $=xh(uh.current),_e=lb($,j.type);$!==_e&&(G(vh$1,j),G(uh,_e))}function Bh(j){vh$1.current===j&&(E$1(uh),E$1(vh$1))}var L$1=Uf(0);function Ch(j){for(var $=j;$!==null;){if($.tag===13){var _e=$.memoizedState;if(_e!==null&&(_e=_e.dehydrated,_e===null||_e.data==="$?"||_e.data==="$!"))return $}else if($.tag===19&&$.memoizedProps.revealOrder!==void 0){if($.flags&128)return $}else if($.child!==null){$.child.return=$,$=$.child;continue}if($===j)break;for(;$.sibling===null;){if($.return===null||$.return===j)return null;$=$.return}$.sibling.return=$.return,$=$.sibling}return null}var Dh=[];function Eh(){for(var j=0;j<Dh.length;j++)Dh[j]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$1=null,N$1=null,O$2=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$2(){throw Error(p$1(321))}function Mh(j,$){if($===null)return!1;for(var _e=0;_e<$.length&&_e<j.length;_e++)if(!He(j[_e],$[_e]))return!1;return!0}function Nh(j,$,_e,et,tt,nt){if(Hh=nt,M$1=$,$.memoizedState=null,$.updateQueue=null,$.lanes=0,Fh.current=j===null||j.memoizedState===null?Oh:Ph,j=_e(et,tt),Jh){nt=0;do{if(Jh=!1,Kh=0,25<=nt)throw Error(p$1(301));nt+=1,O$2=N$1=null,$.updateQueue=null,Fh.current=Qh,j=_e(et,tt)}while(Jh)}if(Fh.current=Rh,$=N$1!==null&&N$1.next!==null,Hh=0,O$2=N$1=M$1=null,Ih=!1,$)throw Error(p$1(300));return j}function Sh(){var j=Kh!==0;return Kh=0,j}function Th(){var j={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$2===null?M$1.memoizedState=O$2=j:O$2=O$2.next=j,O$2}function Uh(){if(N$1===null){var j=M$1.alternate;j=j!==null?j.memoizedState:null}else j=N$1.next;var $=O$2===null?M$1.memoizedState:O$2.next;if($!==null)O$2=$,N$1=j;else{if(j===null)throw Error(p$1(310));N$1=j,j={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$2===null?M$1.memoizedState=O$2=j:O$2=O$2.next=j}return O$2}function Vh(j,$){return typeof $=="function"?$(j):$}function Wh(j){var $=Uh(),_e=$.queue;if(_e===null)throw Error(p$1(311));_e.lastRenderedReducer=j;var et=N$1,tt=et.baseQueue,nt=_e.pending;if(nt!==null){if(tt!==null){var rt=tt.next;tt.next=nt.next,nt.next=rt}et.baseQueue=tt=nt,_e.pending=null}if(tt!==null){nt=tt.next,et=et.baseState;var it=rt=null,st=null,at=nt;do{var ot=at.lane;if((Hh&ot)===ot)st!==null&&(st=st.next={lane:0,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),et=at.hasEagerState?at.eagerState:j(et,at.action);else{var ct={lane:ot,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null};st===null?(it=st=ct,rt=et):st=st.next=ct,M$1.lanes|=ot,rh|=ot}at=at.next}while(at!==null&&at!==nt);st===null?rt=et:st.next=it,He(et,$.memoizedState)||(dh=!0),$.memoizedState=et,$.baseState=rt,$.baseQueue=st,_e.lastRenderedState=et}if(j=_e.interleaved,j!==null){tt=j;do nt=tt.lane,M$1.lanes|=nt,rh|=nt,tt=tt.next;while(tt!==j)}else tt===null&&(_e.lanes=0);return[$.memoizedState,_e.dispatch]}function Xh(j){var $=Uh(),_e=$.queue;if(_e===null)throw Error(p$1(311));_e.lastRenderedReducer=j;var et=_e.dispatch,tt=_e.pending,nt=$.memoizedState;if(tt!==null){_e.pending=null;var rt=tt=tt.next;do nt=j(nt,rt.action),rt=rt.next;while(rt!==tt);He(nt,$.memoizedState)||(dh=!0),$.memoizedState=nt,$.baseQueue===null&&($.baseState=nt),_e.lastRenderedState=nt}return[nt,et]}function Yh(){}function Zh(j,$){var _e=M$1,et=Uh(),tt=$(),nt=!He(et.memoizedState,tt);if(nt&&(et.memoizedState=tt,dh=!0),et=et.queue,$h(ai.bind(null,_e,et,j),[j]),et.getSnapshot!==$||nt||O$2!==null&&O$2.memoizedState.tag&1){if(_e.flags|=2048,bi(9,ci.bind(null,_e,et,tt,$),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(_e,$,tt)}return tt}function di(j,$,_e){j.flags|=16384,j={getSnapshot:$,value:_e},$=M$1.updateQueue,$===null?($={lastEffect:null,stores:null},M$1.updateQueue=$,$.stores=[j]):(_e=$.stores,_e===null?$.stores=[j]:_e.push(j))}function ci(j,$,_e,et){$.value=_e,$.getSnapshot=et,ei($)&&fi(j)}function ai(j,$,_e){return _e(function(){ei($)&&fi(j)})}function ei(j){var $=j.getSnapshot;j=j.value;try{var _e=$();return!He(j,_e)}catch{return!0}}function fi(j){var $=ih(j,1);$!==null&&gi($,j,1,-1)}function hi(j){var $=Th();return typeof j=="function"&&(j=j()),$.memoizedState=$.baseState=j,j={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:j},$.queue=j,j=j.dispatch=ii.bind(null,M$1,j),[$.memoizedState,j]}function bi(j,$,_e,et){return j={tag:j,create:$,destroy:_e,deps:et,next:null},$=M$1.updateQueue,$===null?($={lastEffect:null,stores:null},M$1.updateQueue=$,$.lastEffect=j.next=j):(_e=$.lastEffect,_e===null?$.lastEffect=j.next=j:(et=_e.next,_e.next=j,j.next=et,$.lastEffect=j)),j}function ji(){return Uh().memoizedState}function ki(j,$,_e,et){var tt=Th();M$1.flags|=j,tt.memoizedState=bi(1|$,_e,void 0,et===void 0?null:et)}function li(j,$,_e,et){var tt=Uh();et=et===void 0?null:et;var nt=void 0;if(N$1!==null){var rt=N$1.memoizedState;if(nt=rt.destroy,et!==null&&Mh(et,rt.deps)){tt.memoizedState=bi($,_e,nt,et);return}}M$1.flags|=j,tt.memoizedState=bi(1|$,_e,nt,et)}function mi(j,$){return ki(8390656,8,j,$)}function $h(j,$){return li(2048,8,j,$)}function ni(j,$){return li(4,2,j,$)}function oi(j,$){return li(4,4,j,$)}function pi$2(j,$){if(typeof $=="function")return j=j(),$(j),function(){$(null)};if($!=null)return j=j(),$.current=j,function(){$.current=null}}function qi(j,$,_e){return _e=_e!=null?_e.concat([j]):null,li(4,4,pi$2.bind(null,$,j),_e)}function ri(){}function si(j,$){var _e=Uh();$=$===void 0?null:$;var et=_e.memoizedState;return et!==null&&$!==null&&Mh($,et[1])?et[0]:(_e.memoizedState=[j,$],j)}function ti(j,$){var _e=Uh();$=$===void 0?null:$;var et=_e.memoizedState;return et!==null&&$!==null&&Mh($,et[1])?et[0]:(j=j(),_e.memoizedState=[j,$],j)}function ui(j,$,_e){return Hh&21?(He(_e,$)||(_e=yc(),M$1.lanes|=_e,rh|=_e,j.baseState=!0),$):(j.baseState&&(j.baseState=!1,dh=!0),j.memoizedState=_e)}function vi(j,$){var _e=C$1;C$1=_e!==0&&4>_e?_e:4,j(!0);var et=Gh.transition;Gh.transition={};try{j(!1),$()}finally{C$1=_e,Gh.transition=et}}function wi(){return Uh().memoizedState}function xi(j,$,_e){var et=yi(j);if(_e={lane:et,action:_e,hasEagerState:!1,eagerState:null,next:null},zi(j))Ai($,_e);else if(_e=hh(j,$,_e,et),_e!==null){var tt=R$1();gi(_e,j,et,tt),Bi(_e,$,et)}}function ii(j,$,_e){var et=yi(j),tt={lane:et,action:_e,hasEagerState:!1,eagerState:null,next:null};if(zi(j))Ai($,tt);else{var nt=j.alternate;if(j.lanes===0&&(nt===null||nt.lanes===0)&&(nt=$.lastRenderedReducer,nt!==null))try{var rt=$.lastRenderedState,it=nt(rt,_e);if(tt.hasEagerState=!0,tt.eagerState=it,He(it,rt)){var st=$.interleaved;st===null?(tt.next=tt,gh($)):(tt.next=st.next,st.next=tt),$.interleaved=tt;return}}catch{}finally{}_e=hh(j,$,tt,et),_e!==null&&(tt=R$1(),gi(_e,j,et,tt),Bi(_e,$,et))}}function zi(j){var $=j.alternate;return j===M$1||$!==null&&$===M$1}function Ai(j,$){Jh=Ih=!0;var _e=j.pending;_e===null?$.next=$:($.next=_e.next,_e.next=$),j.pending=$}function Bi(j,$,_e){if(_e&4194240){var et=$.lanes;et&=j.pendingLanes,_e|=et,$.lanes=_e,Cc(j,_e)}}var Rh={readContext:eh,useCallback:P$2,useContext:P$2,useEffect:P$2,useImperativeHandle:P$2,useInsertionEffect:P$2,useLayoutEffect:P$2,useMemo:P$2,useReducer:P$2,useRef:P$2,useState:P$2,useDebugValue:P$2,useDeferredValue:P$2,useTransition:P$2,useMutableSource:P$2,useSyncExternalStore:P$2,useId:P$2,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(j,$){return Th().memoizedState=[j,$===void 0?null:$],j},useContext:eh,useEffect:mi,useImperativeHandle:function(j,$,_e){return _e=_e!=null?_e.concat([j]):null,ki(4194308,4,pi$2.bind(null,$,j),_e)},useLayoutEffect:function(j,$){return ki(4194308,4,j,$)},useInsertionEffect:function(j,$){return ki(4,2,j,$)},useMemo:function(j,$){var _e=Th();return $=$===void 0?null:$,j=j(),_e.memoizedState=[j,$],j},useReducer:function(j,$,_e){var et=Th();return $=_e!==void 0?_e($):$,et.memoizedState=et.baseState=$,j={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:j,lastRenderedState:$},et.queue=j,j=j.dispatch=xi.bind(null,M$1,j),[et.memoizedState,j]},useRef:function(j){var $=Th();return j={current:j},$.memoizedState=j},useState:hi,useDebugValue:ri,useDeferredValue:function(j){return Th().memoizedState=j},useTransition:function(){var j=hi(!1),$=j[0];return j=vi.bind(null,j[1]),Th().memoizedState=j,[$,j]},useMutableSource:function(){},useSyncExternalStore:function(j,$,_e){var et=M$1,tt=Th();if(I$1){if(_e===void 0)throw Error(p$1(407));_e=_e()}else{if(_e=$(),Q===null)throw Error(p$1(349));Hh&30||di(et,$,_e)}tt.memoizedState=_e;var nt={value:_e,getSnapshot:$};return tt.queue=nt,mi(ai.bind(null,et,nt,j),[j]),et.flags|=2048,bi(9,ci.bind(null,et,nt,_e,$),void 0,null),_e},useId:function(){var j=Th(),$=Q.identifierPrefix;if(I$1){var _e=sg,et=rg;_e=(et&~(1<<32-oc(et)-1)).toString(32)+_e,$=":"+$+"R"+_e,_e=Kh++,0<_e&&($+="H"+_e.toString(32)),$+=":"}else _e=Lh++,$=":"+$+"r"+_e.toString(32)+":";return j.memoizedState=$},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(j){var $=Uh();return ui($,N$1.memoizedState,j)},useTransition:function(){var j=Wh(Vh)[0],$=Uh().memoizedState;return[j,$]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(j){var $=Uh();return N$1===null?$.memoizedState=j:ui($,N$1.memoizedState,j)},useTransition:function(){var j=Xh(Vh)[0],$=Uh().memoizedState;return[j,$]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(j,$){if(j&&j.defaultProps){$=A$1({},$),j=j.defaultProps;for(var _e in j)$[_e]===void 0&&($[_e]=j[_e]);return $}return $}function Di(j,$,_e,et){$=j.memoizedState,_e=_e(et,$),_e=_e==null?$:A$1({},$,_e),j.memoizedState=_e,j.lanes===0&&(j.updateQueue.baseState=_e)}var Ei={isMounted:function(j){return(j=j._reactInternals)?Vb(j)===j:!1},enqueueSetState:function(j,$,_e){j=j._reactInternals;var et=R$1(),tt=yi(j),nt=mh(et,tt);nt.payload=$,_e!=null&&(nt.callback=_e),$=nh(j,nt,tt),$!==null&&(gi($,j,tt,et),oh($,j,tt))},enqueueReplaceState:function(j,$,_e){j=j._reactInternals;var et=R$1(),tt=yi(j),nt=mh(et,tt);nt.tag=1,nt.payload=$,_e!=null&&(nt.callback=_e),$=nh(j,nt,tt),$!==null&&(gi($,j,tt,et),oh($,j,tt))},enqueueForceUpdate:function(j,$){j=j._reactInternals;var _e=R$1(),et=yi(j),tt=mh(_e,et);tt.tag=2,$!=null&&(tt.callback=$),$=nh(j,tt,et),$!==null&&(gi($,j,et,_e),oh($,j,et))}};function Fi(j,$,_e,et,tt,nt,rt){return j=j.stateNode,typeof j.shouldComponentUpdate=="function"?j.shouldComponentUpdate(et,nt,rt):$.prototype&&$.prototype.isPureReactComponent?!Ie(_e,et)||!Ie(tt,nt):!0}function Gi(j,$,_e){var et=!1,tt=Vf,nt=$.contextType;return typeof nt=="object"&&nt!==null?nt=eh(nt):(tt=Zf($)?Xf:H.current,et=$.contextTypes,nt=(et=et!=null)?Yf(j,tt):Vf),$=new $(_e,nt),j.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=Ei,j.stateNode=$,$._reactInternals=j,et&&(j=j.stateNode,j.__reactInternalMemoizedUnmaskedChildContext=tt,j.__reactInternalMemoizedMaskedChildContext=nt),$}function Hi(j,$,_e,et){j=$.state,typeof $.componentWillReceiveProps=="function"&&$.componentWillReceiveProps(_e,et),typeof $.UNSAFE_componentWillReceiveProps=="function"&&$.UNSAFE_componentWillReceiveProps(_e,et),$.state!==j&&Ei.enqueueReplaceState($,$.state,null)}function Ii(j,$,_e,et){var tt=j.stateNode;tt.props=_e,tt.state=j.memoizedState,tt.refs={},kh(j);var nt=$.contextType;typeof nt=="object"&&nt!==null?tt.context=eh(nt):(nt=Zf($)?Xf:H.current,tt.context=Yf(j,nt)),tt.state=j.memoizedState,nt=$.getDerivedStateFromProps,typeof nt=="function"&&(Di(j,$,nt,_e),tt.state=j.memoizedState),typeof $.getDerivedStateFromProps=="function"||typeof tt.getSnapshotBeforeUpdate=="function"||typeof tt.UNSAFE_componentWillMount!="function"&&typeof tt.componentWillMount!="function"||($=tt.state,typeof tt.componentWillMount=="function"&&tt.componentWillMount(),typeof tt.UNSAFE_componentWillMount=="function"&&tt.UNSAFE_componentWillMount(),$!==tt.state&&Ei.enqueueReplaceState(tt,tt.state,null),qh(j,_e,tt,et),tt.state=j.memoizedState),typeof tt.componentDidMount=="function"&&(j.flags|=4194308)}function Ji(j,$){try{var _e="",et=$;do _e+=Pa(et),et=et.return;while(et);var tt=_e}catch(nt){tt=`
Error generating stack: `+nt.message+`
`+nt.stack}return{value:j,source:$,stack:tt,digest:null}}function Ki(j,$,_e){return{value:j,source:null,stack:_e??null,digest:$??null}}function Li(j,$){try{console.error($.value)}catch(_e){setTimeout(function(){throw _e})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(j,$,_e){_e=mh(-1,_e),_e.tag=3,_e.payload={element:null};var et=$.value;return _e.callback=function(){Oi||(Oi=!0,Pi=et),Li(j,$)},_e}function Qi(j,$,_e){_e=mh(-1,_e),_e.tag=3;var et=j.type.getDerivedStateFromError;if(typeof et=="function"){var tt=$.value;_e.payload=function(){return et(tt)},_e.callback=function(){Li(j,$)}}var nt=j.stateNode;return nt!==null&&typeof nt.componentDidCatch=="function"&&(_e.callback=function(){Li(j,$),typeof et!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var rt=$.stack;this.componentDidCatch($.value,{componentStack:rt!==null?rt:""})}),_e}function Si(j,$,_e){var et=j.pingCache;if(et===null){et=j.pingCache=new Mi;var tt=new Set;et.set($,tt)}else tt=et.get($),tt===void 0&&(tt=new Set,et.set($,tt));tt.has(_e)||(tt.add(_e),j=Ti.bind(null,j,$,_e),$.then(j,j))}function Ui(j){do{var $;if(($=j.tag===13)&&($=j.memoizedState,$=$!==null?$.dehydrated!==null:!0),$)return j;j=j.return}while(j!==null);return null}function Vi(j,$,_e,et,tt){return j.mode&1?(j.flags|=65536,j.lanes=tt,j):(j===$?j.flags|=65536:(j.flags|=128,_e.flags|=131072,_e.flags&=-52805,_e.tag===1&&(_e.alternate===null?_e.tag=17:($=mh(-1,1),$.tag=2,nh(_e,$,1))),_e.lanes|=1),j)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(j,$,_e,et){$.child=j===null?Vg($,null,_e,et):Ug($,j.child,_e,et)}function Yi(j,$,_e,et,tt){_e=_e.render;var nt=$.ref;return ch($,tt),et=Nh(j,$,_e,et,nt,tt),_e=Sh(),j!==null&&!dh?($.updateQueue=j.updateQueue,$.flags&=-2053,j.lanes&=~tt,Zi(j,$,tt)):(I$1&&_e&&vg($),$.flags|=1,Xi(j,$,et,tt),$.child)}function $i(j,$,_e,et,tt){if(j===null){var nt=_e.type;return typeof nt=="function"&&!aj(nt)&&nt.defaultProps===void 0&&_e.compare===null&&_e.defaultProps===void 0?($.tag=15,$.type=nt,bj(j,$,nt,et,tt)):(j=Rg(_e.type,null,et,$,$.mode,tt),j.ref=$.ref,j.return=$,$.child=j)}if(nt=j.child,!(j.lanes&tt)){var rt=nt.memoizedProps;if(_e=_e.compare,_e=_e!==null?_e:Ie,_e(rt,et)&&j.ref===$.ref)return Zi(j,$,tt)}return $.flags|=1,j=Pg(nt,et),j.ref=$.ref,j.return=$,$.child=j}function bj(j,$,_e,et,tt){if(j!==null){var nt=j.memoizedProps;if(Ie(nt,et)&&j.ref===$.ref)if(dh=!1,$.pendingProps=et=nt,(j.lanes&tt)!==0)j.flags&131072&&(dh=!0);else return $.lanes=j.lanes,Zi(j,$,tt)}return cj(j,$,_e,et,tt)}function dj(j,$,_e){var et=$.pendingProps,tt=et.children,nt=j!==null?j.memoizedState:null;if(et.mode==="hidden")if(!($.mode&1))$.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=_e;else{if(!(_e&1073741824))return j=nt!==null?nt.baseLanes|_e:_e,$.lanes=$.childLanes=1073741824,$.memoizedState={baseLanes:j,cachePool:null,transitions:null},$.updateQueue=null,G(ej,fj),fj|=j,null;$.memoizedState={baseLanes:0,cachePool:null,transitions:null},et=nt!==null?nt.baseLanes:_e,G(ej,fj),fj|=et}else nt!==null?(et=nt.baseLanes|_e,$.memoizedState=null):et=_e,G(ej,fj),fj|=et;return Xi(j,$,tt,_e),$.child}function gj(j,$){var _e=$.ref;(j===null&&_e!==null||j!==null&&j.ref!==_e)&&($.flags|=512,$.flags|=2097152)}function cj(j,$,_e,et,tt){var nt=Zf(_e)?Xf:H.current;return nt=Yf($,nt),ch($,tt),_e=Nh(j,$,_e,et,nt,tt),et=Sh(),j!==null&&!dh?($.updateQueue=j.updateQueue,$.flags&=-2053,j.lanes&=~tt,Zi(j,$,tt)):(I$1&&et&&vg($),$.flags|=1,Xi(j,$,_e,tt),$.child)}function hj(j,$,_e,et,tt){if(Zf(_e)){var nt=!0;cg($)}else nt=!1;if(ch($,tt),$.stateNode===null)ij(j,$),Gi($,_e,et),Ii($,_e,et,tt),et=!0;else if(j===null){var rt=$.stateNode,it=$.memoizedProps;rt.props=it;var st=rt.context,at=_e.contextType;typeof at=="object"&&at!==null?at=eh(at):(at=Zf(_e)?Xf:H.current,at=Yf($,at));var ot=_e.getDerivedStateFromProps,ct=typeof ot=="function"||typeof rt.getSnapshotBeforeUpdate=="function";ct||typeof rt.UNSAFE_componentWillReceiveProps!="function"&&typeof rt.componentWillReceiveProps!="function"||(it!==et||st!==at)&&Hi($,rt,et,at),jh=!1;var lt=$.memoizedState;rt.state=lt,qh($,et,rt,tt),st=$.memoizedState,it!==et||lt!==st||Wf.current||jh?(typeof ot=="function"&&(Di($,_e,ot,et),st=$.memoizedState),(it=jh||Fi($,_e,it,et,lt,st,at))?(ct||typeof rt.UNSAFE_componentWillMount!="function"&&typeof rt.componentWillMount!="function"||(typeof rt.componentWillMount=="function"&&rt.componentWillMount(),typeof rt.UNSAFE_componentWillMount=="function"&&rt.UNSAFE_componentWillMount()),typeof rt.componentDidMount=="function"&&($.flags|=4194308)):(typeof rt.componentDidMount=="function"&&($.flags|=4194308),$.memoizedProps=et,$.memoizedState=st),rt.props=et,rt.state=st,rt.context=at,et=it):(typeof rt.componentDidMount=="function"&&($.flags|=4194308),et=!1)}else{rt=$.stateNode,lh(j,$),it=$.memoizedProps,at=$.type===$.elementType?it:Ci($.type,it),rt.props=at,ct=$.pendingProps,lt=rt.context,st=_e.contextType,typeof st=="object"&&st!==null?st=eh(st):(st=Zf(_e)?Xf:H.current,st=Yf($,st));var ut=_e.getDerivedStateFromProps;(ot=typeof ut=="function"||typeof rt.getSnapshotBeforeUpdate=="function")||typeof rt.UNSAFE_componentWillReceiveProps!="function"&&typeof rt.componentWillReceiveProps!="function"||(it!==ct||lt!==st)&&Hi($,rt,et,st),jh=!1,lt=$.memoizedState,rt.state=lt,qh($,et,rt,tt);var pt=$.memoizedState;it!==ct||lt!==pt||Wf.current||jh?(typeof ut=="function"&&(Di($,_e,ut,et),pt=$.memoizedState),(at=jh||Fi($,_e,at,et,lt,pt,st)||!1)?(ot||typeof rt.UNSAFE_componentWillUpdate!="function"&&typeof rt.componentWillUpdate!="function"||(typeof rt.componentWillUpdate=="function"&&rt.componentWillUpdate(et,pt,st),typeof rt.UNSAFE_componentWillUpdate=="function"&&rt.UNSAFE_componentWillUpdate(et,pt,st)),typeof rt.componentDidUpdate=="function"&&($.flags|=4),typeof rt.getSnapshotBeforeUpdate=="function"&&($.flags|=1024)):(typeof rt.componentDidUpdate!="function"||it===j.memoizedProps&&lt===j.memoizedState||($.flags|=4),typeof rt.getSnapshotBeforeUpdate!="function"||it===j.memoizedProps&&lt===j.memoizedState||($.flags|=1024),$.memoizedProps=et,$.memoizedState=pt),rt.props=et,rt.state=pt,rt.context=st,et=at):(typeof rt.componentDidUpdate!="function"||it===j.memoizedProps&&lt===j.memoizedState||($.flags|=4),typeof rt.getSnapshotBeforeUpdate!="function"||it===j.memoizedProps&&lt===j.memoizedState||($.flags|=1024),et=!1)}return jj(j,$,_e,et,nt,tt)}function jj(j,$,_e,et,tt,nt){gj(j,$);var rt=($.flags&128)!==0;if(!et&&!rt)return tt&&dg($,_e,!1),Zi(j,$,nt);et=$.stateNode,Wi.current=$;var it=rt&&typeof _e.getDerivedStateFromError!="function"?null:et.render();return $.flags|=1,j!==null&&rt?($.child=Ug($,j.child,null,nt),$.child=Ug($,null,it,nt)):Xi(j,$,it,nt),$.memoizedState=et.state,tt&&dg($,_e,!0),$.child}function kj(j){var $=j.stateNode;$.pendingContext?ag(j,$.pendingContext,$.pendingContext!==$.context):$.context&&ag(j,$.context,!1),yh(j,$.containerInfo)}function lj(j,$,_e,et,tt){return Ig(),Jg(tt),$.flags|=256,Xi(j,$,_e,et),$.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(j){return{baseLanes:j,cachePool:null,transitions:null}}function oj(j,$,_e){var et=$.pendingProps,tt=L$1.current,nt=!1,rt=($.flags&128)!==0,it;if((it=rt)||(it=j!==null&&j.memoizedState===null?!1:(tt&2)!==0),it?(nt=!0,$.flags&=-129):(j===null||j.memoizedState!==null)&&(tt|=1),G(L$1,tt&1),j===null)return Eg($),j=$.memoizedState,j!==null&&(j=j.dehydrated,j!==null)?($.mode&1?j.data==="$!"?$.lanes=8:$.lanes=1073741824:$.lanes=1,null):(rt=et.children,j=et.fallback,nt?(et=$.mode,nt=$.child,rt={mode:"hidden",children:rt},!(et&1)&&nt!==null?(nt.childLanes=0,nt.pendingProps=rt):nt=pj(rt,et,0,null),j=Tg(j,et,_e,null),nt.return=$,j.return=$,nt.sibling=j,$.child=nt,$.child.memoizedState=nj(_e),$.memoizedState=mj,j):qj($,rt));if(tt=j.memoizedState,tt!==null&&(it=tt.dehydrated,it!==null))return rj(j,$,rt,et,it,tt,_e);if(nt){nt=et.fallback,rt=$.mode,tt=j.child,it=tt.sibling;var st={mode:"hidden",children:et.children};return!(rt&1)&&$.child!==tt?(et=$.child,et.childLanes=0,et.pendingProps=st,$.deletions=null):(et=Pg(tt,st),et.subtreeFlags=tt.subtreeFlags&14680064),it!==null?nt=Pg(it,nt):(nt=Tg(nt,rt,_e,null),nt.flags|=2),nt.return=$,et.return=$,et.sibling=nt,$.child=et,et=nt,nt=$.child,rt=j.child.memoizedState,rt=rt===null?nj(_e):{baseLanes:rt.baseLanes|_e,cachePool:null,transitions:rt.transitions},nt.memoizedState=rt,nt.childLanes=j.childLanes&~_e,$.memoizedState=mj,et}return nt=j.child,j=nt.sibling,et=Pg(nt,{mode:"visible",children:et.children}),!($.mode&1)&&(et.lanes=_e),et.return=$,et.sibling=null,j!==null&&(_e=$.deletions,_e===null?($.deletions=[j],$.flags|=16):_e.push(j)),$.child=et,$.memoizedState=null,et}function qj(j,$){return $=pj({mode:"visible",children:$},j.mode,0,null),$.return=j,j.child=$}function sj(j,$,_e,et){return et!==null&&Jg(et),Ug($,j.child,null,_e),j=qj($,$.pendingProps.children),j.flags|=2,$.memoizedState=null,j}function rj(j,$,_e,et,tt,nt,rt){if(_e)return $.flags&256?($.flags&=-257,et=Ki(Error(p$1(422))),sj(j,$,rt,et)):$.memoizedState!==null?($.child=j.child,$.flags|=128,null):(nt=et.fallback,tt=$.mode,et=pj({mode:"visible",children:et.children},tt,0,null),nt=Tg(nt,tt,rt,null),nt.flags|=2,et.return=$,nt.return=$,et.sibling=nt,$.child=et,$.mode&1&&Ug($,j.child,null,rt),$.child.memoizedState=nj(rt),$.memoizedState=mj,nt);if(!($.mode&1))return sj(j,$,rt,null);if(tt.data==="$!"){if(et=tt.nextSibling&&tt.nextSibling.dataset,et)var it=et.dgst;return et=it,nt=Error(p$1(419)),et=Ki(nt,et,void 0),sj(j,$,rt,et)}if(it=(rt&j.childLanes)!==0,dh||it){if(et=Q,et!==null){switch(rt&-rt){case 4:tt=2;break;case 16:tt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:tt=32;break;case 536870912:tt=268435456;break;default:tt=0}tt=tt&(et.suspendedLanes|rt)?0:tt,tt!==0&&tt!==nt.retryLane&&(nt.retryLane=tt,ih(j,tt),gi(et,j,tt,-1))}return tj(),et=Ki(Error(p$1(421))),sj(j,$,rt,et)}return tt.data==="$?"?($.flags|=128,$.child=j.child,$=uj.bind(null,j),tt._reactRetry=$,null):(j=nt.treeContext,yg=Lf(tt.nextSibling),xg=$,I$1=!0,zg=null,j!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=j.id,sg=j.overflow,qg=$),$=qj($,et.children),$.flags|=4096,$)}function vj(j,$,_e){j.lanes|=$;var et=j.alternate;et!==null&&(et.lanes|=$),bh(j.return,$,_e)}function wj(j,$,_e,et,tt){var nt=j.memoizedState;nt===null?j.memoizedState={isBackwards:$,rendering:null,renderingStartTime:0,last:et,tail:_e,tailMode:tt}:(nt.isBackwards=$,nt.rendering=null,nt.renderingStartTime=0,nt.last=et,nt.tail=_e,nt.tailMode=tt)}function xj(j,$,_e){var et=$.pendingProps,tt=et.revealOrder,nt=et.tail;if(Xi(j,$,et.children,_e),et=L$1.current,et&2)et=et&1|2,$.flags|=128;else{if(j!==null&&j.flags&128)e:for(j=$.child;j!==null;){if(j.tag===13)j.memoizedState!==null&&vj(j,_e,$);else if(j.tag===19)vj(j,_e,$);else if(j.child!==null){j.child.return=j,j=j.child;continue}if(j===$)break e;for(;j.sibling===null;){if(j.return===null||j.return===$)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}et&=1}if(G(L$1,et),!($.mode&1))$.memoizedState=null;else switch(tt){case"forwards":for(_e=$.child,tt=null;_e!==null;)j=_e.alternate,j!==null&&Ch(j)===null&&(tt=_e),_e=_e.sibling;_e=tt,_e===null?(tt=$.child,$.child=null):(tt=_e.sibling,_e.sibling=null),wj($,!1,tt,_e,nt);break;case"backwards":for(_e=null,tt=$.child,$.child=null;tt!==null;){if(j=tt.alternate,j!==null&&Ch(j)===null){$.child=tt;break}j=tt.sibling,tt.sibling=_e,_e=tt,tt=j}wj($,!0,_e,null,nt);break;case"together":wj($,!1,null,null,void 0);break;default:$.memoizedState=null}return $.child}function ij(j,$){!($.mode&1)&&j!==null&&(j.alternate=null,$.alternate=null,$.flags|=2)}function Zi(j,$,_e){if(j!==null&&($.dependencies=j.dependencies),rh|=$.lanes,!(_e&$.childLanes))return null;if(j!==null&&$.child!==j.child)throw Error(p$1(153));if($.child!==null){for(j=$.child,_e=Pg(j,j.pendingProps),$.child=_e,_e.return=$;j.sibling!==null;)j=j.sibling,_e=_e.sibling=Pg(j,j.pendingProps),_e.return=$;_e.sibling=null}return $.child}function yj(j,$,_e){switch($.tag){case 3:kj($),Ig();break;case 5:Ah($);break;case 1:Zf($.type)&&cg($);break;case 4:yh($,$.stateNode.containerInfo);break;case 10:var et=$.type._context,tt=$.memoizedProps.value;G(Wg,et._currentValue),et._currentValue=tt;break;case 13:if(et=$.memoizedState,et!==null)return et.dehydrated!==null?(G(L$1,L$1.current&1),$.flags|=128,null):_e&$.child.childLanes?oj(j,$,_e):(G(L$1,L$1.current&1),j=Zi(j,$,_e),j!==null?j.sibling:null);G(L$1,L$1.current&1);break;case 19:if(et=(_e&$.childLanes)!==0,j.flags&128){if(et)return xj(j,$,_e);$.flags|=128}if(tt=$.memoizedState,tt!==null&&(tt.rendering=null,tt.tail=null,tt.lastEffect=null),G(L$1,L$1.current),et)break;return null;case 22:case 23:return $.lanes=0,dj(j,$,_e)}return Zi(j,$,_e)}var zj,Aj,Bj,Cj;zj=function(j,$){for(var _e=$.child;_e!==null;){if(_e.tag===5||_e.tag===6)j.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===$)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===$)return;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}};Aj=function(){};Bj=function(j,$,_e,et){var tt=j.memoizedProps;if(tt!==et){j=$.stateNode,xh(uh.current);var nt=null;switch(_e){case"input":tt=Ya(j,tt),et=Ya(j,et),nt=[];break;case"select":tt=A$1({},tt,{value:void 0}),et=A$1({},et,{value:void 0}),nt=[];break;case"textarea":tt=gb(j,tt),et=gb(j,et),nt=[];break;default:typeof tt.onClick!="function"&&typeof et.onClick=="function"&&(j.onclick=Bf)}ub(_e,et);var rt;_e=null;for(at in tt)if(!et.hasOwnProperty(at)&&tt.hasOwnProperty(at)&&tt[at]!=null)if(at==="style"){var it=tt[at];for(rt in it)it.hasOwnProperty(rt)&&(_e||(_e={}),_e[rt]="")}else at!=="dangerouslySetInnerHTML"&&at!=="children"&&at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&at!=="autoFocus"&&(ea.hasOwnProperty(at)?nt||(nt=[]):(nt=nt||[]).push(at,null));for(at in et){var st=et[at];if(it=tt!=null?tt[at]:void 0,et.hasOwnProperty(at)&&st!==it&&(st!=null||it!=null))if(at==="style")if(it){for(rt in it)!it.hasOwnProperty(rt)||st&&st.hasOwnProperty(rt)||(_e||(_e={}),_e[rt]="");for(rt in st)st.hasOwnProperty(rt)&&it[rt]!==st[rt]&&(_e||(_e={}),_e[rt]=st[rt])}else _e||(nt||(nt=[]),nt.push(at,_e)),_e=st;else at==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,it=it?it.__html:void 0,st!=null&&it!==st&&(nt=nt||[]).push(at,st)):at==="children"?typeof st!="string"&&typeof st!="number"||(nt=nt||[]).push(at,""+st):at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&(ea.hasOwnProperty(at)?(st!=null&&at==="onScroll"&&D$1("scroll",j),nt||it===st||(nt=[])):(nt=nt||[]).push(at,st))}_e&&(nt=nt||[]).push("style",_e);var at=nt;($.updateQueue=at)&&($.flags|=4)}};Cj=function(j,$,_e,et){_e!==et&&($.flags|=4)};function Dj(j,$){if(!I$1)switch(j.tailMode){case"hidden":$=j.tail;for(var _e=null;$!==null;)$.alternate!==null&&(_e=$),$=$.sibling;_e===null?j.tail=null:_e.sibling=null;break;case"collapsed":_e=j.tail;for(var et=null;_e!==null;)_e.alternate!==null&&(et=_e),_e=_e.sibling;et===null?$||j.tail===null?j.tail=null:j.tail.sibling=null:et.sibling=null}}function S$1(j){var $=j.alternate!==null&&j.alternate.child===j.child,_e=0,et=0;if($)for(var tt=j.child;tt!==null;)_e|=tt.lanes|tt.childLanes,et|=tt.subtreeFlags&14680064,et|=tt.flags&14680064,tt.return=j,tt=tt.sibling;else for(tt=j.child;tt!==null;)_e|=tt.lanes|tt.childLanes,et|=tt.subtreeFlags,et|=tt.flags,tt.return=j,tt=tt.sibling;return j.subtreeFlags|=et,j.childLanes=_e,$}function Ej(j,$,_e){var et=$.pendingProps;switch(wg($),$.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1($),null;case 1:return Zf($.type)&&$f(),S$1($),null;case 3:return et=$.stateNode,zh(),E$1(Wf),E$1(H),Eh(),et.pendingContext&&(et.context=et.pendingContext,et.pendingContext=null),(j===null||j.child===null)&&(Gg($)?$.flags|=4:j===null||j.memoizedState.isDehydrated&&!($.flags&256)||($.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(j,$),S$1($),null;case 5:Bh($);var tt=xh(wh.current);if(_e=$.type,j!==null&&$.stateNode!=null)Bj(j,$,_e,et,tt),j.ref!==$.ref&&($.flags|=512,$.flags|=2097152);else{if(!et){if($.stateNode===null)throw Error(p$1(166));return S$1($),null}if(j=xh(uh.current),Gg($)){et=$.stateNode,_e=$.type;var nt=$.memoizedProps;switch(et[Of]=$,et[Pf]=nt,j=($.mode&1)!==0,_e){case"dialog":D$1("cancel",et),D$1("close",et);break;case"iframe":case"object":case"embed":D$1("load",et);break;case"video":case"audio":for(tt=0;tt<lf.length;tt++)D$1(lf[tt],et);break;case"source":D$1("error",et);break;case"img":case"image":case"link":D$1("error",et),D$1("load",et);break;case"details":D$1("toggle",et);break;case"input":Za(et,nt),D$1("invalid",et);break;case"select":et._wrapperState={wasMultiple:!!nt.multiple},D$1("invalid",et);break;case"textarea":hb(et,nt),D$1("invalid",et)}ub(_e,nt),tt=null;for(var rt in nt)if(nt.hasOwnProperty(rt)){var it=nt[rt];rt==="children"?typeof it=="string"?et.textContent!==it&&(nt.suppressHydrationWarning!==!0&&Af(et.textContent,it,j),tt=["children",it]):typeof it=="number"&&et.textContent!==""+it&&(nt.suppressHydrationWarning!==!0&&Af(et.textContent,it,j),tt=["children",""+it]):ea.hasOwnProperty(rt)&&it!=null&&rt==="onScroll"&&D$1("scroll",et)}switch(_e){case"input":Va(et),db(et,nt,!0);break;case"textarea":Va(et),jb(et);break;case"select":case"option":break;default:typeof nt.onClick=="function"&&(et.onclick=Bf)}et=tt,$.updateQueue=et,et!==null&&($.flags|=4)}else{rt=tt.nodeType===9?tt:tt.ownerDocument,j==="http://www.w3.org/1999/xhtml"&&(j=kb(_e)),j==="http://www.w3.org/1999/xhtml"?_e==="script"?(j=rt.createElement("div"),j.innerHTML="<script><\/script>",j=j.removeChild(j.firstChild)):typeof et.is=="string"?j=rt.createElement(_e,{is:et.is}):(j=rt.createElement(_e),_e==="select"&&(rt=j,et.multiple?rt.multiple=!0:et.size&&(rt.size=et.size))):j=rt.createElementNS(j,_e),j[Of]=$,j[Pf]=et,zj(j,$,!1,!1),$.stateNode=j;e:{switch(rt=vb(_e,et),_e){case"dialog":D$1("cancel",j),D$1("close",j),tt=et;break;case"iframe":case"object":case"embed":D$1("load",j),tt=et;break;case"video":case"audio":for(tt=0;tt<lf.length;tt++)D$1(lf[tt],j);tt=et;break;case"source":D$1("error",j),tt=et;break;case"img":case"image":case"link":D$1("error",j),D$1("load",j),tt=et;break;case"details":D$1("toggle",j),tt=et;break;case"input":Za(j,et),tt=Ya(j,et),D$1("invalid",j);break;case"option":tt=et;break;case"select":j._wrapperState={wasMultiple:!!et.multiple},tt=A$1({},et,{value:void 0}),D$1("invalid",j);break;case"textarea":hb(j,et),tt=gb(j,et),D$1("invalid",j);break;default:tt=et}ub(_e,tt),it=tt;for(nt in it)if(it.hasOwnProperty(nt)){var st=it[nt];nt==="style"?sb(j,st):nt==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,st!=null&&nb(j,st)):nt==="children"?typeof st=="string"?(_e!=="textarea"||st!=="")&&ob(j,st):typeof st=="number"&&ob(j,""+st):nt!=="suppressContentEditableWarning"&&nt!=="suppressHydrationWarning"&&nt!=="autoFocus"&&(ea.hasOwnProperty(nt)?st!=null&&nt==="onScroll"&&D$1("scroll",j):st!=null&&ta(j,nt,st,rt))}switch(_e){case"input":Va(j),db(j,et,!1);break;case"textarea":Va(j),jb(j);break;case"option":et.value!=null&&j.setAttribute("value",""+Sa(et.value));break;case"select":j.multiple=!!et.multiple,nt=et.value,nt!=null?fb(j,!!et.multiple,nt,!1):et.defaultValue!=null&&fb(j,!!et.multiple,et.defaultValue,!0);break;default:typeof tt.onClick=="function"&&(j.onclick=Bf)}switch(_e){case"button":case"input":case"select":case"textarea":et=!!et.autoFocus;break e;case"img":et=!0;break e;default:et=!1}}et&&($.flags|=4)}$.ref!==null&&($.flags|=512,$.flags|=2097152)}return S$1($),null;case 6:if(j&&$.stateNode!=null)Cj(j,$,j.memoizedProps,et);else{if(typeof et!="string"&&$.stateNode===null)throw Error(p$1(166));if(_e=xh(wh.current),xh(uh.current),Gg($)){if(et=$.stateNode,_e=$.memoizedProps,et[Of]=$,(nt=et.nodeValue!==_e)&&(j=xg,j!==null))switch(j.tag){case 3:Af(et.nodeValue,_e,(j.mode&1)!==0);break;case 5:j.memoizedProps.suppressHydrationWarning!==!0&&Af(et.nodeValue,_e,(j.mode&1)!==0)}nt&&($.flags|=4)}else et=(_e.nodeType===9?_e:_e.ownerDocument).createTextNode(et),et[Of]=$,$.stateNode=et}return S$1($),null;case 13:if(E$1(L$1),et=$.memoizedState,j===null||j.memoizedState!==null&&j.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&$.mode&1&&!($.flags&128))Hg(),Ig(),$.flags|=98560,nt=!1;else if(nt=Gg($),et!==null&&et.dehydrated!==null){if(j===null){if(!nt)throw Error(p$1(318));if(nt=$.memoizedState,nt=nt!==null?nt.dehydrated:null,!nt)throw Error(p$1(317));nt[Of]=$}else Ig(),!($.flags&128)&&($.memoizedState=null),$.flags|=4;S$1($),nt=!1}else zg!==null&&(Fj(zg),zg=null),nt=!0;if(!nt)return $.flags&65536?$:null}return $.flags&128?($.lanes=_e,$):(et=et!==null,et!==(j!==null&&j.memoizedState!==null)&&et&&($.child.flags|=8192,$.mode&1&&(j===null||L$1.current&1?T$1===0&&(T$1=3):tj())),$.updateQueue!==null&&($.flags|=4),S$1($),null);case 4:return zh(),Aj(j,$),j===null&&sf($.stateNode.containerInfo),S$1($),null;case 10:return ah($.type._context),S$1($),null;case 17:return Zf($.type)&&$f(),S$1($),null;case 19:if(E$1(L$1),nt=$.memoizedState,nt===null)return S$1($),null;if(et=($.flags&128)!==0,rt=nt.rendering,rt===null)if(et)Dj(nt,!1);else{if(T$1!==0||j!==null&&j.flags&128)for(j=$.child;j!==null;){if(rt=Ch(j),rt!==null){for($.flags|=128,Dj(nt,!1),et=rt.updateQueue,et!==null&&($.updateQueue=et,$.flags|=4),$.subtreeFlags=0,et=_e,_e=$.child;_e!==null;)nt=_e,j=et,nt.flags&=14680066,rt=nt.alternate,rt===null?(nt.childLanes=0,nt.lanes=j,nt.child=null,nt.subtreeFlags=0,nt.memoizedProps=null,nt.memoizedState=null,nt.updateQueue=null,nt.dependencies=null,nt.stateNode=null):(nt.childLanes=rt.childLanes,nt.lanes=rt.lanes,nt.child=rt.child,nt.subtreeFlags=0,nt.deletions=null,nt.memoizedProps=rt.memoizedProps,nt.memoizedState=rt.memoizedState,nt.updateQueue=rt.updateQueue,nt.type=rt.type,j=rt.dependencies,nt.dependencies=j===null?null:{lanes:j.lanes,firstContext:j.firstContext}),_e=_e.sibling;return G(L$1,L$1.current&1|2),$.child}j=j.sibling}nt.tail!==null&&B()>Gj&&($.flags|=128,et=!0,Dj(nt,!1),$.lanes=4194304)}else{if(!et)if(j=Ch(rt),j!==null){if($.flags|=128,et=!0,_e=j.updateQueue,_e!==null&&($.updateQueue=_e,$.flags|=4),Dj(nt,!0),nt.tail===null&&nt.tailMode==="hidden"&&!rt.alternate&&!I$1)return S$1($),null}else 2*B()-nt.renderingStartTime>Gj&&_e!==1073741824&&($.flags|=128,et=!0,Dj(nt,!1),$.lanes=4194304);nt.isBackwards?(rt.sibling=$.child,$.child=rt):(_e=nt.last,_e!==null?_e.sibling=rt:$.child=rt,nt.last=rt)}return nt.tail!==null?($=nt.tail,nt.rendering=$,nt.tail=$.sibling,nt.renderingStartTime=B(),$.sibling=null,_e=L$1.current,G(L$1,et?_e&1|2:_e&1),$):(S$1($),null);case 22:case 23:return Hj(),et=$.memoizedState!==null,j!==null&&j.memoizedState!==null!==et&&($.flags|=8192),et&&$.mode&1?fj&1073741824&&(S$1($),$.subtreeFlags&6&&($.flags|=8192)):S$1($),null;case 24:return null;case 25:return null}throw Error(p$1(156,$.tag))}function Ij(j,$){switch(wg($),$.tag){case 1:return Zf($.type)&&$f(),j=$.flags,j&65536?($.flags=j&-65537|128,$):null;case 3:return zh(),E$1(Wf),E$1(H),Eh(),j=$.flags,j&65536&&!(j&128)?($.flags=j&-65537|128,$):null;case 5:return Bh($),null;case 13:if(E$1(L$1),j=$.memoizedState,j!==null&&j.dehydrated!==null){if($.alternate===null)throw Error(p$1(340));Ig()}return j=$.flags,j&65536?($.flags=j&-65537|128,$):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah($.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(j,$){var _e=j.ref;if(_e!==null)if(typeof _e=="function")try{_e(null)}catch(et){W(j,$,et)}else _e.current=null}function Mj(j,$,_e){try{_e()}catch(et){W(j,$,et)}}var Nj=!1;function Oj(j,$){if(Cf=dd,j=Me(),Ne(j)){if("selectionStart"in j)var _e={start:j.selectionStart,end:j.selectionEnd};else e:{_e=(_e=j.ownerDocument)&&_e.defaultView||window;var et=_e.getSelection&&_e.getSelection();if(et&&et.rangeCount!==0){_e=et.anchorNode;var tt=et.anchorOffset,nt=et.focusNode;et=et.focusOffset;try{_e.nodeType,nt.nodeType}catch{_e=null;break e}var rt=0,it=-1,st=-1,at=0,ot=0,ct=j,lt=null;t:for(;;){for(var ut;ct!==_e||tt!==0&&ct.nodeType!==3||(it=rt+tt),ct!==nt||et!==0&&ct.nodeType!==3||(st=rt+et),ct.nodeType===3&&(rt+=ct.nodeValue.length),(ut=ct.firstChild)!==null;)lt=ct,ct=ut;for(;;){if(ct===j)break t;if(lt===_e&&++at===tt&&(it=rt),lt===nt&&++ot===et&&(st=rt),(ut=ct.nextSibling)!==null)break;ct=lt,lt=ct.parentNode}ct=ut}_e=it===-1||st===-1?null:{start:it,end:st}}else _e=null}_e=_e||{start:0,end:0}}else _e=null;for(Df={focusedElem:j,selectionRange:_e},dd=!1,V=$;V!==null;)if($=V,j=$.child,($.subtreeFlags&1028)!==0&&j!==null)j.return=$,V=j;else for(;V!==null;){$=V;try{var pt=$.alternate;if($.flags&1024)switch($.tag){case 0:case 11:case 15:break;case 1:if(pt!==null){var dt=pt.memoizedProps,ht=pt.memoizedState,ft=$.stateNode,mt=ft.getSnapshotBeforeUpdate($.elementType===$.type?dt:Ci($.type,dt),ht);ft.__reactInternalSnapshotBeforeUpdate=mt}break;case 3:var gt=$.stateNode.containerInfo;gt.nodeType===1?gt.textContent="":gt.nodeType===9&&gt.documentElement&&gt.removeChild(gt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(yt){W($,$.return,yt)}if(j=$.sibling,j!==null){j.return=$.return,V=j;break}V=$.return}return pt=Nj,Nj=!1,pt}function Pj(j,$,_e){var et=$.updateQueue;if(et=et!==null?et.lastEffect:null,et!==null){var tt=et=et.next;do{if((tt.tag&j)===j){var nt=tt.destroy;tt.destroy=void 0,nt!==void 0&&Mj($,_e,nt)}tt=tt.next}while(tt!==et)}}function Qj(j,$){if($=$.updateQueue,$=$!==null?$.lastEffect:null,$!==null){var _e=$=$.next;do{if((_e.tag&j)===j){var et=_e.create;_e.destroy=et()}_e=_e.next}while(_e!==$)}}function Rj(j){var $=j.ref;if($!==null){var _e=j.stateNode;switch(j.tag){case 5:j=_e;break;default:j=_e}typeof $=="function"?$(j):$.current=j}}function Sj(j){var $=j.alternate;$!==null&&(j.alternate=null,Sj($)),j.child=null,j.deletions=null,j.sibling=null,j.tag===5&&($=j.stateNode,$!==null&&(delete $[Of],delete $[Pf],delete $[of],delete $[Qf],delete $[Rf])),j.stateNode=null,j.return=null,j.dependencies=null,j.memoizedProps=null,j.memoizedState=null,j.pendingProps=null,j.stateNode=null,j.updateQueue=null}function Tj(j){return j.tag===5||j.tag===3||j.tag===4}function Uj(j){e:for(;;){for(;j.sibling===null;){if(j.return===null||Tj(j.return))return null;j=j.return}for(j.sibling.return=j.return,j=j.sibling;j.tag!==5&&j.tag!==6&&j.tag!==18;){if(j.flags&2||j.child===null||j.tag===4)continue e;j.child.return=j,j=j.child}if(!(j.flags&2))return j.stateNode}}function Vj(j,$,_e){var et=j.tag;if(et===5||et===6)j=j.stateNode,$?_e.nodeType===8?_e.parentNode.insertBefore(j,$):_e.insertBefore(j,$):(_e.nodeType===8?($=_e.parentNode,$.insertBefore(j,_e)):($=_e,$.appendChild(j)),_e=_e._reactRootContainer,_e!=null||$.onclick!==null||($.onclick=Bf));else if(et!==4&&(j=j.child,j!==null))for(Vj(j,$,_e),j=j.sibling;j!==null;)Vj(j,$,_e),j=j.sibling}function Wj(j,$,_e){var et=j.tag;if(et===5||et===6)j=j.stateNode,$?_e.insertBefore(j,$):_e.appendChild(j);else if(et!==4&&(j=j.child,j!==null))for(Wj(j,$,_e),j=j.sibling;j!==null;)Wj(j,$,_e),j=j.sibling}var X=null,Xj=!1;function Yj(j,$,_e){for(_e=_e.child;_e!==null;)Zj(j,$,_e),_e=_e.sibling}function Zj(j,$,_e){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_e)}catch{}switch(_e.tag){case 5:U||Lj(_e,$);case 6:var et=X,tt=Xj;X=null,Yj(j,$,_e),X=et,Xj=tt,X!==null&&(Xj?(j=X,_e=_e.stateNode,j.nodeType===8?j.parentNode.removeChild(_e):j.removeChild(_e)):X.removeChild(_e.stateNode));break;case 18:X!==null&&(Xj?(j=X,_e=_e.stateNode,j.nodeType===8?Kf(j.parentNode,_e):j.nodeType===1&&Kf(j,_e),bd(j)):Kf(X,_e.stateNode));break;case 4:et=X,tt=Xj,X=_e.stateNode.containerInfo,Xj=!0,Yj(j,$,_e),X=et,Xj=tt;break;case 0:case 11:case 14:case 15:if(!U&&(et=_e.updateQueue,et!==null&&(et=et.lastEffect,et!==null))){tt=et=et.next;do{var nt=tt,rt=nt.destroy;nt=nt.tag,rt!==void 0&&(nt&2||nt&4)&&Mj(_e,$,rt),tt=tt.next}while(tt!==et)}Yj(j,$,_e);break;case 1:if(!U&&(Lj(_e,$),et=_e.stateNode,typeof et.componentWillUnmount=="function"))try{et.props=_e.memoizedProps,et.state=_e.memoizedState,et.componentWillUnmount()}catch(it){W(_e,$,it)}Yj(j,$,_e);break;case 21:Yj(j,$,_e);break;case 22:_e.mode&1?(U=(et=U)||_e.memoizedState!==null,Yj(j,$,_e),U=et):Yj(j,$,_e);break;default:Yj(j,$,_e)}}function ak(j){var $=j.updateQueue;if($!==null){j.updateQueue=null;var _e=j.stateNode;_e===null&&(_e=j.stateNode=new Kj),$.forEach(function(et){var tt=bk.bind(null,j,et);_e.has(et)||(_e.add(et),et.then(tt,tt))})}}function ck(j,$){var _e=$.deletions;if(_e!==null)for(var et=0;et<_e.length;et++){var tt=_e[et];try{var nt=j,rt=$,it=rt;e:for(;it!==null;){switch(it.tag){case 5:X=it.stateNode,Xj=!1;break e;case 3:X=it.stateNode.containerInfo,Xj=!0;break e;case 4:X=it.stateNode.containerInfo,Xj=!0;break e}it=it.return}if(X===null)throw Error(p$1(160));Zj(nt,rt,tt),X=null,Xj=!1;var st=tt.alternate;st!==null&&(st.return=null),tt.return=null}catch(at){W(tt,$,at)}}if($.subtreeFlags&12854)for($=$.child;$!==null;)dk($,j),$=$.sibling}function dk(j,$){var _e=j.alternate,et=j.flags;switch(j.tag){case 0:case 11:case 14:case 15:if(ck($,j),ek(j),et&4){try{Pj(3,j,j.return),Qj(3,j)}catch(dt){W(j,j.return,dt)}try{Pj(5,j,j.return)}catch(dt){W(j,j.return,dt)}}break;case 1:ck($,j),ek(j),et&512&&_e!==null&&Lj(_e,_e.return);break;case 5:if(ck($,j),ek(j),et&512&&_e!==null&&Lj(_e,_e.return),j.flags&32){var tt=j.stateNode;try{ob(tt,"")}catch(dt){W(j,j.return,dt)}}if(et&4&&(tt=j.stateNode,tt!=null)){var nt=j.memoizedProps,rt=_e!==null?_e.memoizedProps:nt,it=j.type,st=j.updateQueue;if(j.updateQueue=null,st!==null)try{it==="input"&&nt.type==="radio"&&nt.name!=null&&ab(tt,nt),vb(it,rt);var at=vb(it,nt);for(rt=0;rt<st.length;rt+=2){var ot=st[rt],ct=st[rt+1];ot==="style"?sb(tt,ct):ot==="dangerouslySetInnerHTML"?nb(tt,ct):ot==="children"?ob(tt,ct):ta(tt,ot,ct,at)}switch(it){case"input":bb(tt,nt);break;case"textarea":ib(tt,nt);break;case"select":var lt=tt._wrapperState.wasMultiple;tt._wrapperState.wasMultiple=!!nt.multiple;var ut=nt.value;ut!=null?fb(tt,!!nt.multiple,ut,!1):lt!==!!nt.multiple&&(nt.defaultValue!=null?fb(tt,!!nt.multiple,nt.defaultValue,!0):fb(tt,!!nt.multiple,nt.multiple?[]:"",!1))}tt[Pf]=nt}catch(dt){W(j,j.return,dt)}}break;case 6:if(ck($,j),ek(j),et&4){if(j.stateNode===null)throw Error(p$1(162));tt=j.stateNode,nt=j.memoizedProps;try{tt.nodeValue=nt}catch(dt){W(j,j.return,dt)}}break;case 3:if(ck($,j),ek(j),et&4&&_e!==null&&_e.memoizedState.isDehydrated)try{bd($.containerInfo)}catch(dt){W(j,j.return,dt)}break;case 4:ck($,j),ek(j);break;case 13:ck($,j),ek(j),tt=j.child,tt.flags&8192&&(nt=tt.memoizedState!==null,tt.stateNode.isHidden=nt,!nt||tt.alternate!==null&&tt.alternate.memoizedState!==null||(fk=B())),et&4&&ak(j);break;case 22:if(ot=_e!==null&&_e.memoizedState!==null,j.mode&1?(U=(at=U)||ot,ck($,j),U=at):ck($,j),ek(j),et&8192){if(at=j.memoizedState!==null,(j.stateNode.isHidden=at)&&!ot&&j.mode&1)for(V=j,ot=j.child;ot!==null;){for(ct=V=ot;V!==null;){switch(lt=V,ut=lt.child,lt.tag){case 0:case 11:case 14:case 15:Pj(4,lt,lt.return);break;case 1:Lj(lt,lt.return);var pt=lt.stateNode;if(typeof pt.componentWillUnmount=="function"){et=lt,_e=lt.return;try{$=et,pt.props=$.memoizedProps,pt.state=$.memoizedState,pt.componentWillUnmount()}catch(dt){W(et,_e,dt)}}break;case 5:Lj(lt,lt.return);break;case 22:if(lt.memoizedState!==null){gk(ct);continue}}ut!==null?(ut.return=lt,V=ut):gk(ct)}ot=ot.sibling}e:for(ot=null,ct=j;;){if(ct.tag===5){if(ot===null){ot=ct;try{tt=ct.stateNode,at?(nt=tt.style,typeof nt.setProperty=="function"?nt.setProperty("display","none","important"):nt.display="none"):(it=ct.stateNode,st=ct.memoizedProps.style,rt=st!=null&&st.hasOwnProperty("display")?st.display:null,it.style.display=rb("display",rt))}catch(dt){W(j,j.return,dt)}}}else if(ct.tag===6){if(ot===null)try{ct.stateNode.nodeValue=at?"":ct.memoizedProps}catch(dt){W(j,j.return,dt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===j)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===j)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===j)break e;ot===ct&&(ot=null),ct=ct.return}ot===ct&&(ot=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:ck($,j),ek(j),et&4&&ak(j);break;case 21:break;default:ck($,j),ek(j)}}function ek(j){var $=j.flags;if($&2){try{e:{for(var _e=j.return;_e!==null;){if(Tj(_e)){var et=_e;break e}_e=_e.return}throw Error(p$1(160))}switch(et.tag){case 5:var tt=et.stateNode;et.flags&32&&(ob(tt,""),et.flags&=-33);var nt=Uj(j);Wj(j,nt,tt);break;case 3:case 4:var rt=et.stateNode.containerInfo,it=Uj(j);Vj(j,it,rt);break;default:throw Error(p$1(161))}}catch(st){W(j,j.return,st)}j.flags&=-3}$&4096&&(j.flags&=-4097)}function hk(j,$,_e){V=j,ik(j)}function ik(j,$,_e){for(var et=(j.mode&1)!==0;V!==null;){var tt=V,nt=tt.child;if(tt.tag===22&&et){var rt=tt.memoizedState!==null||Jj;if(!rt){var it=tt.alternate,st=it!==null&&it.memoizedState!==null||U;it=Jj;var at=U;if(Jj=rt,(U=st)&&!at)for(V=tt;V!==null;)rt=V,st=rt.child,rt.tag===22&&rt.memoizedState!==null?jk(tt):st!==null?(st.return=rt,V=st):jk(tt);for(;nt!==null;)V=nt,ik(nt),nt=nt.sibling;V=tt,Jj=it,U=at}kk(j)}else tt.subtreeFlags&8772&&nt!==null?(nt.return=tt,V=nt):kk(j)}}function kk(j){for(;V!==null;){var $=V;if($.flags&8772){var _e=$.alternate;try{if($.flags&8772)switch($.tag){case 0:case 11:case 15:U||Qj(5,$);break;case 1:var et=$.stateNode;if($.flags&4&&!U)if(_e===null)et.componentDidMount();else{var tt=$.elementType===$.type?_e.memoizedProps:Ci($.type,_e.memoizedProps);et.componentDidUpdate(tt,_e.memoizedState,et.__reactInternalSnapshotBeforeUpdate)}var nt=$.updateQueue;nt!==null&&sh($,nt,et);break;case 3:var rt=$.updateQueue;if(rt!==null){if(_e=null,$.child!==null)switch($.child.tag){case 5:_e=$.child.stateNode;break;case 1:_e=$.child.stateNode}sh($,rt,_e)}break;case 5:var it=$.stateNode;if(_e===null&&$.flags&4){_e=it;var st=$.memoizedProps;switch($.type){case"button":case"input":case"select":case"textarea":st.autoFocus&&_e.focus();break;case"img":st.src&&(_e.src=st.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if($.memoizedState===null){var at=$.alternate;if(at!==null){var ot=at.memoizedState;if(ot!==null){var ct=ot.dehydrated;ct!==null&&bd(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||$.flags&512&&Rj($)}catch(lt){W($,$.return,lt)}}if($===j){V=null;break}if(_e=$.sibling,_e!==null){_e.return=$.return,V=_e;break}V=$.return}}function gk(j){for(;V!==null;){var $=V;if($===j){V=null;break}var _e=$.sibling;if(_e!==null){_e.return=$.return,V=_e;break}V=$.return}}function jk(j){for(;V!==null;){var $=V;try{switch($.tag){case 0:case 11:case 15:var _e=$.return;try{Qj(4,$)}catch(st){W($,_e,st)}break;case 1:var et=$.stateNode;if(typeof et.componentDidMount=="function"){var tt=$.return;try{et.componentDidMount()}catch(st){W($,tt,st)}}var nt=$.return;try{Rj($)}catch(st){W($,nt,st)}break;case 5:var rt=$.return;try{Rj($)}catch(st){W($,rt,st)}}}catch(st){W($,$.return,st)}if($===j){V=null;break}var it=$.sibling;if(it!==null){it.return=$.return,V=it;break}V=$.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok$2=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(j){return j.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(j=C$1,j!==0||(j=window.event,j=j===void 0?16:jd(j.type)),j):1}function gi(j,$,_e,et){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(j,_e,et),(!(K&2)||j!==Q)&&(j===Q&&(!(K&2)&&(qk|=_e),T$1===4&&Ck(j,Z)),Dk(j,et),_e===1&&K===0&&!($.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(j,$){var _e=j.callbackNode;wc(j,$);var et=uc(j,j===Q?Z:0);if(et===0)_e!==null&&bc(_e),j.callbackNode=null,j.callbackPriority=0;else if($=et&-et,j.callbackPriority!==$){if(_e!=null&&bc(_e),$===1)j.tag===0?ig(Ek.bind(null,j)):hg(Ek.bind(null,j)),Jf(function(){!(K&6)&&jg()}),_e=null;else{switch(Dc(et)){case 1:_e=fc;break;case 4:_e=gc;break;case 16:_e=hc;break;case 536870912:_e=jc;break;default:_e=hc}_e=Fk(_e,Gk.bind(null,j))}j.callbackPriority=$,j.callbackNode=_e}}function Gk(j,$){if(Ak=-1,Bk=0,K&6)throw Error(p$1(327));var _e=j.callbackNode;if(Hk()&&j.callbackNode!==_e)return null;var et=uc(j,j===Q?Z:0);if(et===0)return null;if(et&30||et&j.expiredLanes||$)$=Ik(j,et);else{$=et;var tt=K;K|=2;var nt=Jk();(Q!==j||Z!==$)&&(uk=null,Gj=B()+500,Kk(j,$));do try{Lk();break}catch(it){Mk(j,it)}while(!0);$g(),mk.current=nt,K=tt,Y!==null?$=0:(Q=null,Z=0,$=T$1)}if($!==0){if($===2&&(tt=xc(j),tt!==0&&(et=tt,$=Nk(j,tt))),$===1)throw _e=pk,Kk(j,0),Ck(j,et),Dk(j,B()),_e;if($===6)Ck(j,et);else{if(tt=j.current.alternate,!(et&30)&&!Ok(tt)&&($=Ik(j,et),$===2&&(nt=xc(j),nt!==0&&(et=nt,$=Nk(j,nt))),$===1))throw _e=pk,Kk(j,0),Ck(j,et),Dk(j,B()),_e;switch(j.finishedWork=tt,j.finishedLanes=et,$){case 0:case 1:throw Error(p$1(345));case 2:Pk(j,tk,uk);break;case 3:if(Ck(j,et),(et&130023424)===et&&($=fk+500-B(),10<$)){if(uc(j,0)!==0)break;if(tt=j.suspendedLanes,(tt&et)!==et){R$1(),j.pingedLanes|=j.suspendedLanes&tt;break}j.timeoutHandle=Ff(Pk.bind(null,j,tk,uk),$);break}Pk(j,tk,uk);break;case 4:if(Ck(j,et),(et&4194240)===et)break;for($=j.eventTimes,tt=-1;0<et;){var rt=31-oc(et);nt=1<<rt,rt=$[rt],rt>tt&&(tt=rt),et&=~nt}if(et=tt,et=B()-et,et=(120>et?120:480>et?480:1080>et?1080:1920>et?1920:3e3>et?3e3:4320>et?4320:1960*lk(et/1960))-et,10<et){j.timeoutHandle=Ff(Pk.bind(null,j,tk,uk),et);break}Pk(j,tk,uk);break;case 5:Pk(j,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(j,B()),j.callbackNode===_e?Gk.bind(null,j):null}function Nk(j,$){var _e=sk;return j.current.memoizedState.isDehydrated&&(Kk(j,$).flags|=256),j=Ik(j,$),j!==2&&($=tk,tk=_e,$!==null&&Fj($)),j}function Fj(j){tk===null?tk=j:tk.push.apply(tk,j)}function Ok(j){for(var $=j;;){if($.flags&16384){var _e=$.updateQueue;if(_e!==null&&(_e=_e.stores,_e!==null))for(var et=0;et<_e.length;et++){var tt=_e[et],nt=tt.getSnapshot;tt=tt.value;try{if(!He(nt(),tt))return!1}catch{return!1}}}if(_e=$.child,$.subtreeFlags&16384&&_e!==null)_e.return=$,$=_e;else{if($===j)break;for(;$.sibling===null;){if($.return===null||$.return===j)return!0;$=$.return}$.sibling.return=$.return,$=$.sibling}}return!0}function Ck(j,$){for($&=~rk,$&=~qk,j.suspendedLanes|=$,j.pingedLanes&=~$,j=j.expirationTimes;0<$;){var _e=31-oc($),et=1<<_e;j[_e]=-1,$&=~et}}function Ek(j){if(K&6)throw Error(p$1(327));Hk();var $=uc(j,0);if(!($&1))return Dk(j,B()),null;var _e=Ik(j,$);if(j.tag!==0&&_e===2){var et=xc(j);et!==0&&($=et,_e=Nk(j,et))}if(_e===1)throw _e=pk,Kk(j,0),Ck(j,$),Dk(j,B()),_e;if(_e===6)throw Error(p$1(345));return j.finishedWork=j.current.alternate,j.finishedLanes=$,Pk(j,tk,uk),Dk(j,B()),null}function Qk(j,$){var _e=K;K|=1;try{return j($)}finally{K=_e,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(j){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var $=K;K|=1;var _e=ok$2.transition,et=C$1;try{if(ok$2.transition=null,C$1=1,j)return j()}finally{C$1=et,ok$2.transition=_e,K=$,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(j,$){j.finishedWork=null,j.finishedLanes=0;var _e=j.timeoutHandle;if(_e!==-1&&(j.timeoutHandle=-1,Gf(_e)),Y!==null)for(_e=Y.return;_e!==null;){var et=_e;switch(wg(et),et.tag){case 1:et=et.type.childContextTypes,et!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H),Eh();break;case 5:Bh(et);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(et.type._context);break;case 22:case 23:Hj()}_e=_e.return}if(Q=j,Y=j=Pg(j.current,null),Z=fj=$,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for($=0;$<fh.length;$++)if(_e=fh[$],et=_e.interleaved,et!==null){_e.interleaved=null;var tt=et.next,nt=_e.pending;if(nt!==null){var rt=nt.next;nt.next=tt,et.next=rt}_e.pending=et}fh=null}return j}function Mk(j,$){do{var _e=Y;try{if($g(),Fh.current=Rh,Ih){for(var et=M$1.memoizedState;et!==null;){var tt=et.queue;tt!==null&&(tt.pending=null),et=et.next}Ih=!1}if(Hh=0,O$2=N$1=M$1=null,Jh=!1,Kh=0,nk.current=null,_e===null||_e.return===null){T$1=1,pk=$,Y=null;break}e:{var nt=j,rt=_e.return,it=_e,st=$;if($=Z,it.flags|=32768,st!==null&&typeof st=="object"&&typeof st.then=="function"){var at=st,ot=it,ct=ot.tag;if(!(ot.mode&1)&&(ct===0||ct===11||ct===15)){var lt=ot.alternate;lt?(ot.updateQueue=lt.updateQueue,ot.memoizedState=lt.memoizedState,ot.lanes=lt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var ut=Ui(rt);if(ut!==null){ut.flags&=-257,Vi(ut,rt,it,nt,$),ut.mode&1&&Si(nt,at,$),$=ut,st=at;var pt=$.updateQueue;if(pt===null){var dt=new Set;dt.add(st),$.updateQueue=dt}else pt.add(st);break e}else{if(!($&1)){Si(nt,at,$),tj();break e}st=Error(p$1(426))}}else if(I$1&&it.mode&1){var ht=Ui(rt);if(ht!==null){!(ht.flags&65536)&&(ht.flags|=256),Vi(ht,rt,it,nt,$),Jg(Ji(st,it));break e}}nt=st=Ji(st,it),T$1!==4&&(T$1=2),sk===null?sk=[nt]:sk.push(nt),nt=rt;do{switch(nt.tag){case 3:nt.flags|=65536,$&=-$,nt.lanes|=$;var ft=Ni(nt,st,$);ph(nt,ft);break e;case 1:it=st;var mt=nt.type,gt=nt.stateNode;if(!(nt.flags&128)&&(typeof mt.getDerivedStateFromError=="function"||gt!==null&&typeof gt.componentDidCatch=="function"&&(Ri===null||!Ri.has(gt)))){nt.flags|=65536,$&=-$,nt.lanes|=$;var yt=Qi(nt,it,$);ph(nt,yt);break e}}nt=nt.return}while(nt!==null)}Sk(_e)}catch(vt){$=vt,Y===_e&&_e!==null&&(Y=_e=_e.return);continue}break}while(!0)}function Jk(){var j=mk.current;return mk.current=Rh,j===null?Rh:j}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(j,$){var _e=K;K|=2;var et=Jk();(Q!==j||Z!==$)&&(uk=null,Kk(j,$));do try{Tk();break}catch(tt){Mk(j,tt)}while(!0);if($g(),K=_e,mk.current=et,Y!==null)throw Error(p$1(261));return Q=null,Z=0,T$1}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(j){var $=Vk(j.alternate,j,fj);j.memoizedProps=j.pendingProps,$===null?Sk(j):Y=$,nk.current=null}function Sk(j){var $=j;do{var _e=$.alternate;if(j=$.return,$.flags&32768){if(_e=Ij(_e,$),_e!==null){_e.flags&=32767,Y=_e;return}if(j!==null)j.flags|=32768,j.subtreeFlags=0,j.deletions=null;else{T$1=6,Y=null;return}}else if(_e=Ej(_e,$,fj),_e!==null){Y=_e;return}if($=$.sibling,$!==null){Y=$;return}Y=$=j}while($!==null);T$1===0&&(T$1=5)}function Pk(j,$,_e){var et=C$1,tt=ok$2.transition;try{ok$2.transition=null,C$1=1,Wk(j,$,_e,et)}finally{ok$2.transition=tt,C$1=et}return null}function Wk(j,$,_e,et){do Hk();while(wk!==null);if(K&6)throw Error(p$1(327));_e=j.finishedWork;var tt=j.finishedLanes;if(_e===null)return null;if(j.finishedWork=null,j.finishedLanes=0,_e===j.current)throw Error(p$1(177));j.callbackNode=null,j.callbackPriority=0;var nt=_e.lanes|_e.childLanes;if(Bc(j,nt),j===Q&&(Y=Q=null,Z=0),!(_e.subtreeFlags&2064)&&!(_e.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),nt=(_e.flags&15990)!==0,_e.subtreeFlags&15990||nt){nt=ok$2.transition,ok$2.transition=null;var rt=C$1;C$1=1;var it=K;K|=4,nk.current=null,Oj(j,_e),dk(_e,j),Oe(Df),dd=!!Cf,Df=Cf=null,j.current=_e,hk(_e),dc(),K=it,C$1=rt,ok$2.transition=nt}else j.current=_e;if(vk&&(vk=!1,wk=j,xk=tt),nt=j.pendingLanes,nt===0&&(Ri=null),mc(_e.stateNode),Dk(j,B()),$!==null)for(et=j.onRecoverableError,_e=0;_e<$.length;_e++)tt=$[_e],et(tt.value,{componentStack:tt.stack,digest:tt.digest});if(Oi)throw Oi=!1,j=Pi,Pi=null,j;return xk&1&&j.tag!==0&&Hk(),nt=j.pendingLanes,nt&1?j===zk?yk++:(yk=0,zk=j):yk=0,jg(),null}function Hk(){if(wk!==null){var j=Dc(xk),$=ok$2.transition,_e=C$1;try{if(ok$2.transition=null,C$1=16>j?16:j,wk===null)var et=!1;else{if(j=wk,wk=null,xk=0,K&6)throw Error(p$1(331));var tt=K;for(K|=4,V=j.current;V!==null;){var nt=V,rt=nt.child;if(V.flags&16){var it=nt.deletions;if(it!==null){for(var st=0;st<it.length;st++){var at=it[st];for(V=at;V!==null;){var ot=V;switch(ot.tag){case 0:case 11:case 15:Pj(8,ot,nt)}var ct=ot.child;if(ct!==null)ct.return=ot,V=ct;else for(;V!==null;){ot=V;var lt=ot.sibling,ut=ot.return;if(Sj(ot),ot===at){V=null;break}if(lt!==null){lt.return=ut,V=lt;break}V=ut}}}var pt=nt.alternate;if(pt!==null){var dt=pt.child;if(dt!==null){pt.child=null;do{var ht=dt.sibling;dt.sibling=null,dt=ht}while(dt!==null)}}V=nt}}if(nt.subtreeFlags&2064&&rt!==null)rt.return=nt,V=rt;else e:for(;V!==null;){if(nt=V,nt.flags&2048)switch(nt.tag){case 0:case 11:case 15:Pj(9,nt,nt.return)}var ft=nt.sibling;if(ft!==null){ft.return=nt.return,V=ft;break e}V=nt.return}}var mt=j.current;for(V=mt;V!==null;){rt=V;var gt=rt.child;if(rt.subtreeFlags&2064&&gt!==null)gt.return=rt,V=gt;else e:for(rt=mt;V!==null;){if(it=V,it.flags&2048)try{switch(it.tag){case 0:case 11:case 15:Qj(9,it)}}catch(vt){W(it,it.return,vt)}if(it===rt){V=null;break e}var yt=it.sibling;if(yt!==null){yt.return=it.return,V=yt;break e}V=it.return}}if(K=tt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,j)}catch{}et=!0}return et}finally{C$1=_e,ok$2.transition=$}}return!1}function Xk(j,$,_e){$=Ji(_e,$),$=Ni(j,$,1),j=nh(j,$,1),$=R$1(),j!==null&&(Ac(j,1,$),Dk(j,$))}function W(j,$,_e){if(j.tag===3)Xk(j,j,_e);else for(;$!==null;){if($.tag===3){Xk($,j,_e);break}else if($.tag===1){var et=$.stateNode;if(typeof $.type.getDerivedStateFromError=="function"||typeof et.componentDidCatch=="function"&&(Ri===null||!Ri.has(et))){j=Ji(_e,j),j=Qi($,j,1),$=nh($,j,1),j=R$1(),$!==null&&(Ac($,1,j),Dk($,j));break}}$=$.return}}function Ti(j,$,_e){var et=j.pingCache;et!==null&&et.delete($),$=R$1(),j.pingedLanes|=j.suspendedLanes&_e,Q===j&&(Z&_e)===_e&&(T$1===4||T$1===3&&(Z&130023424)===Z&&500>B()-fk?Kk(j,0):rk|=_e),Dk(j,$)}function Yk(j,$){$===0&&(j.mode&1?($=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):$=1);var _e=R$1();j=ih(j,$),j!==null&&(Ac(j,$,_e),Dk(j,_e))}function uj(j){var $=j.memoizedState,_e=0;$!==null&&(_e=$.retryLane),Yk(j,_e)}function bk(j,$){var _e=0;switch(j.tag){case 13:var et=j.stateNode,tt=j.memoizedState;tt!==null&&(_e=tt.retryLane);break;case 19:et=j.stateNode;break;default:throw Error(p$1(314))}et!==null&&et.delete($),Yk(j,_e)}var Vk;Vk=function(j,$,_e){if(j!==null)if(j.memoizedProps!==$.pendingProps||Wf.current)dh=!0;else{if(!(j.lanes&_e)&&!($.flags&128))return dh=!1,yj(j,$,_e);dh=!!(j.flags&131072)}else dh=!1,I$1&&$.flags&1048576&&ug($,ng,$.index);switch($.lanes=0,$.tag){case 2:var et=$.type;ij(j,$),j=$.pendingProps;var tt=Yf($,H.current);ch($,_e),tt=Nh(null,$,et,j,tt,_e);var nt=Sh();return $.flags|=1,typeof tt=="object"&&tt!==null&&typeof tt.render=="function"&&tt.$$typeof===void 0?($.tag=1,$.memoizedState=null,$.updateQueue=null,Zf(et)?(nt=!0,cg($)):nt=!1,$.memoizedState=tt.state!==null&&tt.state!==void 0?tt.state:null,kh($),tt.updater=Ei,$.stateNode=tt,tt._reactInternals=$,Ii($,et,j,_e),$=jj(null,$,et,!0,nt,_e)):($.tag=0,I$1&&nt&&vg($),Xi(null,$,tt,_e),$=$.child),$;case 16:et=$.elementType;e:{switch(ij(j,$),j=$.pendingProps,tt=et._init,et=tt(et._payload),$.type=et,tt=$.tag=Zk(et),j=Ci(et,j),tt){case 0:$=cj(null,$,et,j,_e);break e;case 1:$=hj(null,$,et,j,_e);break e;case 11:$=Yi(null,$,et,j,_e);break e;case 14:$=$i(null,$,et,Ci(et.type,j),_e);break e}throw Error(p$1(306,et,""))}return $;case 0:return et=$.type,tt=$.pendingProps,tt=$.elementType===et?tt:Ci(et,tt),cj(j,$,et,tt,_e);case 1:return et=$.type,tt=$.pendingProps,tt=$.elementType===et?tt:Ci(et,tt),hj(j,$,et,tt,_e);case 3:e:{if(kj($),j===null)throw Error(p$1(387));et=$.pendingProps,nt=$.memoizedState,tt=nt.element,lh(j,$),qh($,et,null,_e);var rt=$.memoizedState;if(et=rt.element,nt.isDehydrated)if(nt={element:et,isDehydrated:!1,cache:rt.cache,pendingSuspenseBoundaries:rt.pendingSuspenseBoundaries,transitions:rt.transitions},$.updateQueue.baseState=nt,$.memoizedState=nt,$.flags&256){tt=Ji(Error(p$1(423)),$),$=lj(j,$,et,_e,tt);break e}else if(et!==tt){tt=Ji(Error(p$1(424)),$),$=lj(j,$,et,_e,tt);break e}else for(yg=Lf($.stateNode.containerInfo.firstChild),xg=$,I$1=!0,zg=null,_e=Vg($,null,et,_e),$.child=_e;_e;)_e.flags=_e.flags&-3|4096,_e=_e.sibling;else{if(Ig(),et===tt){$=Zi(j,$,_e);break e}Xi(j,$,et,_e)}$=$.child}return $;case 5:return Ah($),j===null&&Eg($),et=$.type,tt=$.pendingProps,nt=j!==null?j.memoizedProps:null,rt=tt.children,Ef(et,tt)?rt=null:nt!==null&&Ef(et,nt)&&($.flags|=32),gj(j,$),Xi(j,$,rt,_e),$.child;case 6:return j===null&&Eg($),null;case 13:return oj(j,$,_e);case 4:return yh($,$.stateNode.containerInfo),et=$.pendingProps,j===null?$.child=Ug($,null,et,_e):Xi(j,$,et,_e),$.child;case 11:return et=$.type,tt=$.pendingProps,tt=$.elementType===et?tt:Ci(et,tt),Yi(j,$,et,tt,_e);case 7:return Xi(j,$,$.pendingProps,_e),$.child;case 8:return Xi(j,$,$.pendingProps.children,_e),$.child;case 12:return Xi(j,$,$.pendingProps.children,_e),$.child;case 10:e:{if(et=$.type._context,tt=$.pendingProps,nt=$.memoizedProps,rt=tt.value,G(Wg,et._currentValue),et._currentValue=rt,nt!==null)if(He(nt.value,rt)){if(nt.children===tt.children&&!Wf.current){$=Zi(j,$,_e);break e}}else for(nt=$.child,nt!==null&&(nt.return=$);nt!==null;){var it=nt.dependencies;if(it!==null){rt=nt.child;for(var st=it.firstContext;st!==null;){if(st.context===et){if(nt.tag===1){st=mh(-1,_e&-_e),st.tag=2;var at=nt.updateQueue;if(at!==null){at=at.shared;var ot=at.pending;ot===null?st.next=st:(st.next=ot.next,ot.next=st),at.pending=st}}nt.lanes|=_e,st=nt.alternate,st!==null&&(st.lanes|=_e),bh(nt.return,_e,$),it.lanes|=_e;break}st=st.next}}else if(nt.tag===10)rt=nt.type===$.type?null:nt.child;else if(nt.tag===18){if(rt=nt.return,rt===null)throw Error(p$1(341));rt.lanes|=_e,it=rt.alternate,it!==null&&(it.lanes|=_e),bh(rt,_e,$),rt=nt.sibling}else rt=nt.child;if(rt!==null)rt.return=nt;else for(rt=nt;rt!==null;){if(rt===$){rt=null;break}if(nt=rt.sibling,nt!==null){nt.return=rt.return,rt=nt;break}rt=rt.return}nt=rt}Xi(j,$,tt.children,_e),$=$.child}return $;case 9:return tt=$.type,et=$.pendingProps.children,ch($,_e),tt=eh(tt),et=et(tt),$.flags|=1,Xi(j,$,et,_e),$.child;case 14:return et=$.type,tt=Ci(et,$.pendingProps),tt=Ci(et.type,tt),$i(j,$,et,tt,_e);case 15:return bj(j,$,$.type,$.pendingProps,_e);case 17:return et=$.type,tt=$.pendingProps,tt=$.elementType===et?tt:Ci(et,tt),ij(j,$),$.tag=1,Zf(et)?(j=!0,cg($)):j=!1,ch($,_e),Gi($,et,tt),Ii($,et,tt,_e),jj(null,$,et,!0,j,_e);case 19:return xj(j,$,_e);case 22:return dj(j,$,_e)}throw Error(p$1(156,$.tag))};function Fk(j,$){return ac(j,$)}function $k(j,$,_e,et){this.tag=j,this.key=_e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=$,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=et,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(j,$,_e,et){return new $k(j,$,_e,et)}function aj(j){return j=j.prototype,!(!j||!j.isReactComponent)}function Zk(j){if(typeof j=="function")return aj(j)?1:0;if(j!=null){if(j=j.$$typeof,j===Da)return 11;if(j===Ga)return 14}return 2}function Pg(j,$){var _e=j.alternate;return _e===null?(_e=Bg(j.tag,$,j.key,j.mode),_e.elementType=j.elementType,_e.type=j.type,_e.stateNode=j.stateNode,_e.alternate=j,j.alternate=_e):(_e.pendingProps=$,_e.type=j.type,_e.flags=0,_e.subtreeFlags=0,_e.deletions=null),_e.flags=j.flags&14680064,_e.childLanes=j.childLanes,_e.lanes=j.lanes,_e.child=j.child,_e.memoizedProps=j.memoizedProps,_e.memoizedState=j.memoizedState,_e.updateQueue=j.updateQueue,$=j.dependencies,_e.dependencies=$===null?null:{lanes:$.lanes,firstContext:$.firstContext},_e.sibling=j.sibling,_e.index=j.index,_e.ref=j.ref,_e}function Rg(j,$,_e,et,tt,nt){var rt=2;if(et=j,typeof j=="function")aj(j)&&(rt=1);else if(typeof j=="string")rt=5;else e:switch(j){case ya:return Tg(_e.children,tt,nt,$);case za:rt=8,tt|=8;break;case Aa:return j=Bg(12,_e,$,tt|2),j.elementType=Aa,j.lanes=nt,j;case Ea:return j=Bg(13,_e,$,tt),j.elementType=Ea,j.lanes=nt,j;case Fa:return j=Bg(19,_e,$,tt),j.elementType=Fa,j.lanes=nt,j;case Ia:return pj(_e,tt,nt,$);default:if(typeof j=="object"&&j!==null)switch(j.$$typeof){case Ba:rt=10;break e;case Ca:rt=9;break e;case Da:rt=11;break e;case Ga:rt=14;break e;case Ha:rt=16,et=null;break e}throw Error(p$1(130,j==null?j:typeof j,""))}return $=Bg(rt,_e,$,tt),$.elementType=j,$.type=et,$.lanes=nt,$}function Tg(j,$,_e,et){return j=Bg(7,j,et,$),j.lanes=_e,j}function pj(j,$,_e,et){return j=Bg(22,j,et,$),j.elementType=Ia,j.lanes=_e,j.stateNode={isHidden:!1},j}function Qg(j,$,_e){return j=Bg(6,j,null,$),j.lanes=_e,j}function Sg(j,$,_e){return $=Bg(4,j.children!==null?j.children:[],j.key,$),$.lanes=_e,$.stateNode={containerInfo:j.containerInfo,pendingChildren:null,implementation:j.implementation},$}function al(j,$,_e,et,tt){this.tag=$,this.containerInfo=j,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=et,this.onRecoverableError=tt,this.mutableSourceEagerHydrationData=null}function bl(j,$,_e,et,tt,nt,rt,it,st){return j=new al(j,$,_e,it,st),$===1?($=1,nt===!0&&($|=8)):$=0,nt=Bg(3,null,null,$),j.current=nt,nt.stateNode=j,nt.memoizedState={element:et,isDehydrated:_e,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(nt),j}function cl(j,$,_e){var et=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:et==null?null:""+et,children:j,containerInfo:$,implementation:_e}}function dl(j){if(!j)return Vf;j=j._reactInternals;e:{if(Vb(j)!==j||j.tag!==1)throw Error(p$1(170));var $=j;do{switch($.tag){case 3:$=$.stateNode.context;break e;case 1:if(Zf($.type)){$=$.stateNode.__reactInternalMemoizedMergedChildContext;break e}}$=$.return}while($!==null);throw Error(p$1(171))}if(j.tag===1){var _e=j.type;if(Zf(_e))return bg(j,_e,$)}return $}function el(j,$,_e,et,tt,nt,rt,it,st){return j=bl(_e,et,!0,j,tt,nt,rt,it,st),j.context=dl(null),_e=j.current,et=R$1(),tt=yi(_e),nt=mh(et,tt),nt.callback=$??null,nh(_e,nt,tt),j.current.lanes=tt,Ac(j,tt,et),Dk(j,et),j}function fl(j,$,_e,et){var tt=$.current,nt=R$1(),rt=yi(tt);return _e=dl(_e),$.context===null?$.context=_e:$.pendingContext=_e,$=mh(nt,rt),$.payload={element:j},et=et===void 0?null:et,et!==null&&($.callback=et),j=nh(tt,$,rt),j!==null&&(gi(j,tt,rt,nt),oh(j,tt,rt)),rt}function gl(j){if(j=j.current,!j.child)return null;switch(j.child.tag){case 5:return j.child.stateNode;default:return j.child.stateNode}}function hl(j,$){if(j=j.memoizedState,j!==null&&j.dehydrated!==null){var _e=j.retryLane;j.retryLane=_e!==0&&_e<$?_e:$}}function il(j,$){hl(j,$),(j=j.alternate)&&hl(j,$)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(j){console.error(j)};function ll(j){this._internalRoot=j}ml.prototype.render=ll.prototype.render=function(j){var $=this._internalRoot;if($===null)throw Error(p$1(409));fl(j,$,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var j=this._internalRoot;if(j!==null){this._internalRoot=null;var $=j.containerInfo;Rk(function(){fl(null,j,null,null)}),$[uf]=null}};function ml(j){this._internalRoot=j}ml.prototype.unstable_scheduleHydration=function(j){if(j){var $=Hc();j={blockedOn:null,target:j,priority:$};for(var _e=0;_e<Qc.length&&$!==0&&$<Qc[_e].priority;_e++);Qc.splice(_e,0,j),_e===0&&Vc(j)}};function nl(j){return!(!j||j.nodeType!==1&&j.nodeType!==9&&j.nodeType!==11)}function ol(j){return!(!j||j.nodeType!==1&&j.nodeType!==9&&j.nodeType!==11&&(j.nodeType!==8||j.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(j,$,_e,et,tt){if(tt){if(typeof et=="function"){var nt=et;et=function(){var at=gl(rt);nt.call(at)}}var rt=el($,et,j,0,null,!1,!1,"",pl);return j._reactRootContainer=rt,j[uf]=rt.current,sf(j.nodeType===8?j.parentNode:j),Rk(),rt}for(;tt=j.lastChild;)j.removeChild(tt);if(typeof et=="function"){var it=et;et=function(){var at=gl(st);it.call(at)}}var st=bl(j,0,!1,null,null,!1,!1,"",pl);return j._reactRootContainer=st,j[uf]=st.current,sf(j.nodeType===8?j.parentNode:j),Rk(function(){fl($,st,_e,et)}),st}function rl(j,$,_e,et,tt){var nt=_e._reactRootContainer;if(nt){var rt=nt;if(typeof tt=="function"){var it=tt;tt=function(){var st=gl(rt);it.call(st)}}fl($,rt,j,tt)}else rt=ql(_e,$,j,tt,et);return gl(rt)}Ec=function(j){switch(j.tag){case 3:var $=j.stateNode;if($.current.memoizedState.isDehydrated){var _e=tc($.pendingLanes);_e!==0&&(Cc($,_e|1),Dk($,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var et=ih(j,1);if(et!==null){var tt=R$1();gi(et,j,1,tt)}}),il(j,1)}};Fc=function(j){if(j.tag===13){var $=ih(j,134217728);if($!==null){var _e=R$1();gi($,j,134217728,_e)}il(j,134217728)}};Gc=function(j){if(j.tag===13){var $=yi(j),_e=ih(j,$);if(_e!==null){var et=R$1();gi(_e,j,$,et)}il(j,$)}};Hc=function(){return C$1};Ic=function(j,$){var _e=C$1;try{return C$1=j,$()}finally{C$1=_e}};yb=function(j,$,_e){switch($){case"input":if(bb(j,_e),$=_e.name,_e.type==="radio"&&$!=null){for(_e=j;_e.parentNode;)_e=_e.parentNode;for(_e=_e.querySelectorAll("input[name="+JSON.stringify(""+$)+'][type="radio"]'),$=0;$<_e.length;$++){var et=_e[$];if(et!==j&&et.form===j.form){var tt=Db(et);if(!tt)throw Error(p$1(90));Wa(et),bb(et,tt)}}}break;case"textarea":ib(j,_e);break;case"select":$=_e.value,$!=null&&fb(j,!!_e.multiple,$,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(j){return j=Zb(j),j===null?null:j.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(j,$){var _e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl($))throw Error(p$1(200));return cl(j,$,null,_e)};reactDom_production_min.createRoot=function(j,$){if(!nl(j))throw Error(p$1(299));var _e=!1,et="",tt=kl;return $!=null&&($.unstable_strictMode===!0&&(_e=!0),$.identifierPrefix!==void 0&&(et=$.identifierPrefix),$.onRecoverableError!==void 0&&(tt=$.onRecoverableError)),$=bl(j,1,!1,null,null,_e,!1,et,tt),j[uf]=$.current,sf(j.nodeType===8?j.parentNode:j),new ll($)};reactDom_production_min.findDOMNode=function(j){if(j==null)return null;if(j.nodeType===1)return j;var $=j._reactInternals;if($===void 0)throw typeof j.render=="function"?Error(p$1(188)):(j=Object.keys(j).join(","),Error(p$1(268,j)));return j=Zb($),j=j===null?null:j.stateNode,j};reactDom_production_min.flushSync=function(j){return Rk(j)};reactDom_production_min.hydrate=function(j,$,_e){if(!ol($))throw Error(p$1(200));return rl(null,j,$,!0,_e)};reactDom_production_min.hydrateRoot=function(j,$,_e){if(!nl(j))throw Error(p$1(405));var et=_e!=null&&_e.hydratedSources||null,tt=!1,nt="",rt=kl;if(_e!=null&&(_e.unstable_strictMode===!0&&(tt=!0),_e.identifierPrefix!==void 0&&(nt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(rt=_e.onRecoverableError)),$=el($,null,j,1,_e??null,tt,!1,nt,rt),j[uf]=$.current,sf(j),et)for(j=0;j<et.length;j++)_e=et[j],tt=_e._getVersion,tt=tt(_e._source),$.mutableSourceEagerHydrationData==null?$.mutableSourceEagerHydrationData=[_e,tt]:$.mutableSourceEagerHydrationData.push(_e,tt);return new ml($)};reactDom_production_min.render=function(j,$,_e){if(!ol($))throw Error(p$1(200));return rl(null,j,$,!1,_e)};reactDom_production_min.unmountComponentAtNode=function(j){if(!ol(j))throw Error(p$1(40));return j._reactRootContainer?(Rk(function(){rl(null,null,j,!1,function(){j._reactRootContainer=null,j[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(j,$,_e,et){if(!ol(_e))throw Error(p$1(200));if(j==null||j._reactInternals===void 0)throw Error(p$1(38));return rl(j,$,_e,!1,et)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(j){console.error(j)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs$1(reactDomExports);var m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(j){return this.listeners.add(j),this.onSubscribe(),()=>{this.listeners.delete(j),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},defaultTimeoutProvider={setTimeout:(j,$)=>setTimeout(j,$),clearTimeout:j=>clearTimeout(j),setInterval:(j,$)=>setInterval(j,$),clearInterval:j=>clearInterval(j)},Lr,Cl,Ll,TimeoutManager=(Ll=class{constructor(){zt(this,Lr,defaultTimeoutProvider);zt(this,Cl,!1)}setTimeoutProvider(j){Dt(this,Lr,j)}setTimeout(j,$){return bt(this,Lr).setTimeout(j,$)}clearTimeout(j){bt(this,Lr).clearTimeout(j)}setInterval(j,$){return bt(this,Lr).setInterval(j,$)}clearInterval(j){bt(this,Lr).clearInterval(j)}},Lr=new WeakMap,Cl=new WeakMap,Ll),timeoutManager=new TimeoutManager;function systemSetTimeoutZero(j){setTimeout(j,0)}var isServer=typeof window>"u"||"Deno"in globalThis;function noop$7(){}function functionalUpdate(j,$){return typeof j=="function"?j($):j}function isValidTimeout(j){return typeof j=="number"&&j>=0&&j!==1/0}function timeUntilStale(j,$){return Math.max(j+($||0)-Date.now(),0)}function resolveStaleTime(j,$){return typeof j=="function"?j($):j}function resolveEnabled(j,$){return typeof j=="function"?j($):j}function matchQuery(j,$){const{type:_e="all",exact:et,fetchStatus:tt,predicate:nt,queryKey:rt,stale:it}=j;if(rt){if(et){if($.queryHash!==hashQueryKeyByOptions(rt,$.options))return!1}else if(!partialMatchKey($.queryKey,rt))return!1}if(_e!=="all"){const st=$.isActive();if(_e==="active"&&!st||_e==="inactive"&&st)return!1}return!(typeof it=="boolean"&&$.isStale()!==it||tt&&tt!==$.state.fetchStatus||nt&&!nt($))}function matchMutation(j,$){const{exact:_e,status:et,predicate:tt,mutationKey:nt}=j;if(nt){if(!$.options.mutationKey)return!1;if(_e){if(hashKey($.options.mutationKey)!==hashKey(nt))return!1}else if(!partialMatchKey($.options.mutationKey,nt))return!1}return!(et&&$.state.status!==et||tt&&!tt($))}function hashQueryKeyByOptions(j,$){return(($==null?void 0:$.queryKeyHashFn)||hashKey)(j)}function hashKey(j){return JSON.stringify(j,($,_e)=>isPlainObject$8(_e)?Object.keys(_e).sort().reduce((et,tt)=>(et[tt]=_e[tt],et),{}):_e)}function partialMatchKey(j,$){return j===$?!0:typeof j!=typeof $?!1:j&&$&&typeof j=="object"&&typeof $=="object"?Object.keys($).every(_e=>partialMatchKey(j[_e],$[_e])):!1}var hasOwn$1=Object.prototype.hasOwnProperty;function replaceEqualDeep(j,$){if(j===$)return j;const _e=isPlainArray(j)&&isPlainArray($);if(!_e&&!(isPlainObject$8(j)&&isPlainObject$8($)))return $;const tt=(_e?j:Object.keys(j)).length,nt=_e?$:Object.keys($),rt=nt.length,it=_e?new Array(rt):{};let st=0;for(let at=0;at<rt;at++){const ot=_e?at:nt[at],ct=j[ot],lt=$[ot];if(ct===lt){it[ot]=ct,(_e?at<tt:hasOwn$1.call(j,ot))&&st++;continue}if(ct===null||lt===null||typeof ct!="object"||typeof lt!="object"){it[ot]=lt;continue}const ut=replaceEqualDeep(ct,lt);it[ot]=ut,ut===ct&&st++}return tt===rt&&st===tt?j:it}function shallowEqualObjects(j,$){if(!$||Object.keys(j).length!==Object.keys($).length)return!1;for(const _e in j)if(j[_e]!==$[_e])return!1;return!0}function isPlainArray(j){return Array.isArray(j)&&j.length===Object.keys(j).length}function isPlainObject$8(j){if(!hasObjectPrototype(j))return!1;const $=j.constructor;if($===void 0)return!0;const _e=$.prototype;return!(!hasObjectPrototype(_e)||!_e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(j)!==Object.prototype)}function hasObjectPrototype(j){return Object.prototype.toString.call(j)==="[object Object]"}function sleep$2(j){return new Promise($=>{timeoutManager.setTimeout($,j)})}function replaceData(j,$,_e){return typeof _e.structuralSharing=="function"?_e.structuralSharing(j,$):_e.structuralSharing!==!1?replaceEqualDeep(j,$):$}function addToEnd(j,$,_e=0){const et=[...j,$];return _e&&et.length>_e?et.slice(1):et}function addToStart(j,$,_e=0){const et=[$,...j];return _e&&et.length>_e?et.slice(0,-1):et}var skipToken=Symbol();function ensureQueryFn(j,$){return!j.queryFn&&($!=null&&$.initialPromise)?()=>$.initialPromise:!j.queryFn||j.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${j.queryHash}'`)):j.queryFn}function shouldThrowError(j,$){return typeof j=="function"?j(...$):!!j}var Qr,Fr,Ts,Fl,FocusManager=(Fl=class extends Subscribable{constructor(){super();zt(this,Qr);zt(this,Fr);zt(this,Ts);Dt(this,Ts,$=>{if(!isServer&&window.addEventListener){const _e=()=>$();return window.addEventListener("visibilitychange",_e,!1),()=>{window.removeEventListener("visibilitychange",_e)}}})}onSubscribe(){bt(this,Fr)||this.setEventListener(bt(this,Ts))}onUnsubscribe(){var $;this.hasListeners()||(($=bt(this,Fr))==null||$.call(this),Dt(this,Fr,void 0))}setEventListener($){var _e;Dt(this,Ts,$),(_e=bt(this,Fr))==null||_e.call(this),Dt(this,Fr,$(et=>{typeof et=="boolean"?this.setFocused(et):this.onFocus()}))}setFocused($){bt(this,Qr)!==$&&(Dt(this,Qr,$),this.onFocus())}onFocus(){const $=this.isFocused();this.listeners.forEach(_e=>{_e($)})}isFocused(){var $;return typeof bt(this,Qr)=="boolean"?bt(this,Qr):(($=globalThis.document)==null?void 0:$.visibilityState)!=="hidden"}},Qr=new WeakMap,Fr=new WeakMap,Ts=new WeakMap,Fl),focusManager=new FocusManager;function pendingThenable(){let j,$;const _e=new Promise((tt,nt)=>{j=tt,$=nt});_e.status="pending",_e.catch(()=>{});function et(tt){Object.assign(_e,tt),delete _e.resolve,delete _e.reject}return _e.resolve=tt=>{et({status:"fulfilled",value:tt}),j(tt)},_e.reject=tt=>{et({status:"rejected",reason:tt}),$(tt)},_e}var defaultScheduler=systemSetTimeoutZero;function createNotifyManager(){let j=[],$=0,_e=it=>{it()},et=it=>{it()},tt=defaultScheduler;const nt=it=>{$?j.push(it):tt(()=>{_e(it)})},rt=()=>{const it=j;j=[],it.length&&tt(()=>{et(()=>{it.forEach(st=>{_e(st)})})})};return{batch:it=>{let st;$++;try{st=it()}finally{$--,$||rt()}return st},batchCalls:it=>(...st)=>{nt(()=>{it(...st)})},schedule:nt,setNotifyFunction:it=>{_e=it},setBatchNotifyFunction:it=>{et=it},setScheduler:it=>{tt=it}}}var notifyManager=createNotifyManager(),ws,Br,Cs,Bl,OnlineManager=(Bl=class extends Subscribable{constructor(){super();zt(this,ws,!0);zt(this,Br);zt(this,Cs);Dt(this,Cs,$=>{if(!isServer&&window.addEventListener){const _e=()=>$(!0),et=()=>$(!1);return window.addEventListener("online",_e,!1),window.addEventListener("offline",et,!1),()=>{window.removeEventListener("online",_e),window.removeEventListener("offline",et)}}})}onSubscribe(){bt(this,Br)||this.setEventListener(bt(this,Cs))}onUnsubscribe(){var $;this.hasListeners()||(($=bt(this,Br))==null||$.call(this),Dt(this,Br,void 0))}setEventListener($){var _e;Dt(this,Cs,$),(_e=bt(this,Br))==null||_e.call(this),Dt(this,Br,$(this.setOnline.bind(this)))}setOnline($){bt(this,ws)!==$&&(Dt(this,ws,$),this.listeners.forEach(et=>{et($)}))}isOnline(){return bt(this,ws)}},ws=new WeakMap,Br=new WeakMap,Cs=new WeakMap,Bl),onlineManager=new OnlineManager;function defaultRetryDelay(j){return Math.min(1e3*2**j,3e4)}function canFetch(j){return(j??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(j){super("CancelledError"),this.revert=j==null?void 0:j.revert,this.silent=j==null?void 0:j.silent}};function createRetryer(j){let $=!1,_e=0,et;const tt=pendingThenable(),nt=()=>tt.status!=="pending",rt=dt=>{var ht;if(!nt()){const ft=new CancelledError(dt);lt(ft),(ht=j.onCancel)==null||ht.call(j,ft)}},it=()=>{$=!0},st=()=>{$=!1},at=()=>focusManager.isFocused()&&(j.networkMode==="always"||onlineManager.isOnline())&&j.canRun(),ot=()=>canFetch(j.networkMode)&&j.canRun(),ct=dt=>{nt()||(et==null||et(),tt.resolve(dt))},lt=dt=>{nt()||(et==null||et(),tt.reject(dt))},ut=()=>new Promise(dt=>{var ht;et=ft=>{(nt()||at())&&dt(ft)},(ht=j.onPause)==null||ht.call(j)}).then(()=>{var dt;et=void 0,nt()||(dt=j.onContinue)==null||dt.call(j)}),pt=()=>{if(nt())return;let dt;const ht=_e===0?j.initialPromise:void 0;try{dt=ht??j.fn()}catch(ft){dt=Promise.reject(ft)}Promise.resolve(dt).then(ct).catch(ft=>{var xt;if(nt())return;const mt=j.retry??(isServer?0:3),gt=j.retryDelay??defaultRetryDelay,yt=typeof gt=="function"?gt(_e,ft):gt,vt=mt===!0||typeof mt=="number"&&_e<mt||typeof mt=="function"&&mt(_e,ft);if($||!vt){lt(ft);return}_e++,(xt=j.onFail)==null||xt.call(j,_e,ft),sleep$2(yt).then(()=>at()?void 0:ut()).then(()=>{$?lt(ft):pt()})})};return{promise:tt,status:()=>tt.status,cancel:rt,continue:()=>(et==null||et(),tt),cancelRetry:it,continueRetry:st,canStart:ot,start:()=>(ot()?pt():ut().then(pt),tt)}}var Jr,Ul,Removable=(Ul=class{constructor(){zt(this,Jr)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&Dt(this,Jr,timeoutManager.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(j){this.gcTime=Math.max(this.gcTime||0,j??(isServer?1/0:5*60*1e3))}clearGcTimeout(){bt(this,Jr)&&(timeoutManager.clearTimeout(bt(this,Jr)),Dt(this,Jr,void 0))}},Jr=new WeakMap,Ul),_i,ks,mr,es,Qn,Js,ts,yr,_r,Vl,Query=(Vl=class extends Removable{constructor($){super();zt(this,yr);zt(this,_i);zt(this,ks);zt(this,mr);zt(this,es);zt(this,Qn);zt(this,Js);zt(this,ts);Dt(this,ts,!1),Dt(this,Js,$.defaultOptions),this.setOptions($.options),this.observers=[],Dt(this,es,$.client),Dt(this,mr,bt(this,es).getQueryCache()),this.queryKey=$.queryKey,this.queryHash=$.queryHash,Dt(this,_i,getDefaultState$1(this.options)),this.state=$.state??bt(this,_i),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var $;return($=bt(this,Qn))==null?void 0:$.promise}setOptions($){if(this.options={...bt(this,Js),...$},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const _e=getDefaultState$1(this.options);_e.data!==void 0&&(this.setState(successState(_e.data,_e.dataUpdatedAt)),Dt(this,_i,_e))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&bt(this,mr).remove(this)}setData($,_e){const et=replaceData(this.state.data,$,this.options);return hn(this,yr,_r).call(this,{data:et,type:"success",dataUpdatedAt:_e==null?void 0:_e.updatedAt,manual:_e==null?void 0:_e.manual}),et}setState($,_e){hn(this,yr,_r).call(this,{type:"setState",state:$,setStateOptions:_e})}cancel($){var et,tt;const _e=(et=bt(this,Qn))==null?void 0:et.promise;return(tt=bt(this,Qn))==null||tt.cancel($),_e?_e.then(noop$7).catch(noop$7):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(bt(this,_i))}isActive(){return this.observers.some($=>resolveEnabled($.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some($=>resolveStaleTime($.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some($=>$.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime($=0){return this.state.data===void 0?!0:$==="static"?!1:this.state.isInvalidated?!0:!timeUntilStale(this.state.dataUpdatedAt,$)}onFocus(){var _e;const $=this.observers.find(et=>et.shouldFetchOnWindowFocus());$==null||$.refetch({cancelRefetch:!1}),(_e=bt(this,Qn))==null||_e.continue()}onOnline(){var _e;const $=this.observers.find(et=>et.shouldFetchOnReconnect());$==null||$.refetch({cancelRefetch:!1}),(_e=bt(this,Qn))==null||_e.continue()}addObserver($){this.observers.includes($)||(this.observers.push($),this.clearGcTimeout(),bt(this,mr).notify({type:"observerAdded",query:this,observer:$}))}removeObserver($){this.observers.includes($)&&(this.observers=this.observers.filter(_e=>_e!==$),this.observers.length||(bt(this,Qn)&&(bt(this,ts)?bt(this,Qn).cancel({revert:!0}):bt(this,Qn).cancelRetry()),this.scheduleGc()),bt(this,mr).notify({type:"observerRemoved",query:this,observer:$}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||hn(this,yr,_r).call(this,{type:"invalidate"})}async fetch($,_e){var st,at,ot,ct,lt,ut,pt,dt,ht,ft,mt,gt;if(this.state.fetchStatus!=="idle"&&((st=bt(this,Qn))==null?void 0:st.status())!=="rejected"){if(this.state.data!==void 0&&(_e!=null&&_e.cancelRefetch))this.cancel({silent:!0});else if(bt(this,Qn))return bt(this,Qn).continueRetry(),bt(this,Qn).promise}if($&&this.setOptions($),!this.options.queryFn){const yt=this.observers.find(vt=>vt.options.queryFn);yt&&this.setOptions(yt.options)}const et=new AbortController,tt=yt=>{Object.defineProperty(yt,"signal",{enumerable:!0,get:()=>(Dt(this,ts,!0),et.signal)})},nt=()=>{const yt=ensureQueryFn(this.options,_e),xt=(()=>{const St={client:bt(this,es),queryKey:this.queryKey,meta:this.meta};return tt(St),St})();return Dt(this,ts,!1),this.options.persister?this.options.persister(yt,xt,this):yt(xt)},it=(()=>{const yt={fetchOptions:_e,options:this.options,queryKey:this.queryKey,client:bt(this,es),state:this.state,fetchFn:nt};return tt(yt),yt})();(at=this.options.behavior)==null||at.onFetch(it,this),Dt(this,ks,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((ot=it.fetchOptions)==null?void 0:ot.meta))&&hn(this,yr,_r).call(this,{type:"fetch",meta:(ct=it.fetchOptions)==null?void 0:ct.meta}),Dt(this,Qn,createRetryer({initialPromise:_e==null?void 0:_e.initialPromise,fn:it.fetchFn,onCancel:yt=>{yt instanceof CancelledError&&yt.revert&&this.setState({...bt(this,ks),fetchStatus:"idle"}),et.abort()},onFail:(yt,vt)=>{hn(this,yr,_r).call(this,{type:"failed",failureCount:yt,error:vt})},onPause:()=>{hn(this,yr,_r).call(this,{type:"pause"})},onContinue:()=>{hn(this,yr,_r).call(this,{type:"continue"})},retry:it.options.retry,retryDelay:it.options.retryDelay,networkMode:it.options.networkMode,canRun:()=>!0}));try{const yt=await bt(this,Qn).start();if(yt===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(yt),(ut=(lt=bt(this,mr).config).onSuccess)==null||ut.call(lt,yt,this),(dt=(pt=bt(this,mr).config).onSettled)==null||dt.call(pt,yt,this.state.error,this),yt}catch(yt){if(yt instanceof CancelledError){if(yt.silent)return bt(this,Qn).promise;if(yt.revert){if(this.state.data===void 0)throw yt;return this.state.data}}throw hn(this,yr,_r).call(this,{type:"error",error:yt}),(ft=(ht=bt(this,mr).config).onError)==null||ft.call(ht,yt,this),(gt=(mt=bt(this,mr).config).onSettled)==null||gt.call(mt,this.state.data,yt,this),yt}finally{this.scheduleGc()}}},_i=new WeakMap,ks=new WeakMap,mr=new WeakMap,es=new WeakMap,Qn=new WeakMap,Js=new WeakMap,ts=new WeakMap,yr=new WeakSet,_r=function($){const _e=et=>{switch($.type){case"failed":return{...et,fetchFailureCount:$.failureCount,fetchFailureReason:$.error};case"pause":return{...et,fetchStatus:"paused"};case"continue":return{...et,fetchStatus:"fetching"};case"fetch":return{...et,...fetchState(et.data,this.options),fetchMeta:$.meta??null};case"success":const tt={...et,...successState($.data,$.dataUpdatedAt),dataUpdateCount:et.dataUpdateCount+1,...!$.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Dt(this,ks,$.manual?tt:void 0),tt;case"error":const nt=$.error;return{...et,error:nt,errorUpdateCount:et.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:et.fetchFailureCount+1,fetchFailureReason:nt,fetchStatus:"idle",status:"error"};case"invalidate":return{...et,isInvalidated:!0};case"setState":return{...et,...$.state}}};this.state=_e(this.state),notifyManager.batch(()=>{this.observers.forEach(et=>{et.onQueryUpdate()}),bt(this,mr).notify({query:this,type:"updated",action:$})})},Vl);function fetchState(j,$){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch($.networkMode)?"fetching":"paused",...j===void 0&&{error:null,status:"pending"}}}function successState(j,$){return{data:j,dataUpdatedAt:$??Date.now(),error:null,isInvalidated:!1,status:"success"}}function getDefaultState$1(j){const $=typeof j.initialData=="function"?j.initialData():j.initialData,_e=$!==void 0,et=_e?typeof j.initialDataUpdatedAt=="function"?j.initialDataUpdatedAt():j.initialDataUpdatedAt:0;return{data:$,dataUpdateCount:0,dataUpdatedAt:_e?et??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:_e?"success":"pending",fetchStatus:"idle"}}var or,Nn,na,ir,ns,Rs,Pr,Ur,ga,_s,Ps,rs,ss,Vr,As,Ln,Xs,Ho,Go,Zo,Yo,Xo,Qo,Jo,Jl,zl,QueryObserver=(zl=class extends Subscribable{constructor($,_e){super();zt(this,Ln);zt(this,or);zt(this,Nn);zt(this,na);zt(this,ir);zt(this,ns);zt(this,Rs);zt(this,Pr);zt(this,Ur);zt(this,ga);zt(this,_s);zt(this,Ps);zt(this,rs);zt(this,ss);zt(this,Vr);zt(this,As,new Set);this.options=_e,Dt(this,or,$),Dt(this,Ur,null),Dt(this,Pr,pendingThenable()),this.bindMethods(),this.setOptions(_e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(bt(this,Nn).addObserver(this),shouldFetchOnMount(bt(this,Nn),this.options)?hn(this,Ln,Xs).call(this):this.updateResult(),hn(this,Ln,Yo).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return shouldFetchOn(bt(this,Nn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return shouldFetchOn(bt(this,Nn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,hn(this,Ln,Xo).call(this),hn(this,Ln,Qo).call(this),bt(this,Nn).removeObserver(this)}setOptions($){const _e=this.options,et=bt(this,Nn);if(this.options=bt(this,or).defaultQueryOptions($),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof resolveEnabled(this.options.enabled,bt(this,Nn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");hn(this,Ln,Jo).call(this),bt(this,Nn).setOptions(this.options),_e._defaulted&&!shallowEqualObjects(this.options,_e)&&bt(this,or).getQueryCache().notify({type:"observerOptionsUpdated",query:bt(this,Nn),observer:this});const tt=this.hasListeners();tt&&shouldFetchOptionally(bt(this,Nn),et,this.options,_e)&&hn(this,Ln,Xs).call(this),this.updateResult(),tt&&(bt(this,Nn)!==et||resolveEnabled(this.options.enabled,bt(this,Nn))!==resolveEnabled(_e.enabled,bt(this,Nn))||resolveStaleTime(this.options.staleTime,bt(this,Nn))!==resolveStaleTime(_e.staleTime,bt(this,Nn)))&&hn(this,Ln,Ho).call(this);const nt=hn(this,Ln,Go).call(this);tt&&(bt(this,Nn)!==et||resolveEnabled(this.options.enabled,bt(this,Nn))!==resolveEnabled(_e.enabled,bt(this,Nn))||nt!==bt(this,Vr))&&hn(this,Ln,Zo).call(this,nt)}getOptimisticResult($){const _e=bt(this,or).getQueryCache().build(bt(this,or),$),et=this.createResult(_e,$);return shouldAssignObserverCurrentProperties(this,et)&&(Dt(this,ir,et),Dt(this,Rs,this.options),Dt(this,ns,bt(this,Nn).state)),et}getCurrentResult(){return bt(this,ir)}trackResult($,_e){return new Proxy($,{get:(et,tt)=>(this.trackProp(tt),_e==null||_e(tt),tt==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&bt(this,Pr).status==="pending"&&bt(this,Pr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(et,tt))})}trackProp($){bt(this,As).add($)}getCurrentQuery(){return bt(this,Nn)}refetch({...$}={}){return this.fetch({...$})}fetchOptimistic($){const _e=bt(this,or).defaultQueryOptions($),et=bt(this,or).getQueryCache().build(bt(this,or),_e);return et.fetch().then(()=>this.createResult(et,_e))}fetch($){return hn(this,Ln,Xs).call(this,{...$,cancelRefetch:$.cancelRefetch??!0}).then(()=>(this.updateResult(),bt(this,ir)))}createResult($,_e){var wt;const et=bt(this,Nn),tt=this.options,nt=bt(this,ir),rt=bt(this,ns),it=bt(this,Rs),at=$!==et?$.state:bt(this,na),{state:ot}=$;let ct={...ot},lt=!1,ut;if(_e._optimisticResults){const Tt=this.hasListeners(),Ct=!Tt&&shouldFetchOnMount($,_e),Rt=Tt&&shouldFetchOptionally($,et,_e,tt);(Ct||Rt)&&(ct={...ct,...fetchState(ot.data,$.options)}),_e._optimisticResults==="isRestoring"&&(ct.fetchStatus="idle")}let{error:pt,errorUpdatedAt:dt,status:ht}=ct;ut=ct.data;let ft=!1;if(_e.placeholderData!==void 0&&ut===void 0&&ht==="pending"){let Tt;nt!=null&&nt.isPlaceholderData&&_e.placeholderData===(it==null?void 0:it.placeholderData)?(Tt=nt.data,ft=!0):Tt=typeof _e.placeholderData=="function"?_e.placeholderData((wt=bt(this,Ps))==null?void 0:wt.state.data,bt(this,Ps)):_e.placeholderData,Tt!==void 0&&(ht="success",ut=replaceData(nt==null?void 0:nt.data,Tt,_e),lt=!0)}if(_e.select&&ut!==void 0&&!ft)if(nt&&ut===(rt==null?void 0:rt.data)&&_e.select===bt(this,ga))ut=bt(this,_s);else try{Dt(this,ga,_e.select),ut=_e.select(ut),ut=replaceData(nt==null?void 0:nt.data,ut,_e),Dt(this,_s,ut),Dt(this,Ur,null)}catch(Tt){Dt(this,Ur,Tt)}bt(this,Ur)&&(pt=bt(this,Ur),ut=bt(this,_s),dt=Date.now(),ht="error");const mt=ct.fetchStatus==="fetching",gt=ht==="pending",yt=ht==="error",vt=gt&&mt,xt=ut!==void 0,Et={status:ht,fetchStatus:ct.fetchStatus,isPending:gt,isSuccess:ht==="success",isError:yt,isInitialLoading:vt,isLoading:vt,data:ut,dataUpdatedAt:ct.dataUpdatedAt,error:pt,errorUpdatedAt:dt,failureCount:ct.fetchFailureCount,failureReason:ct.fetchFailureReason,errorUpdateCount:ct.errorUpdateCount,isFetched:ct.dataUpdateCount>0||ct.errorUpdateCount>0,isFetchedAfterMount:ct.dataUpdateCount>at.dataUpdateCount||ct.errorUpdateCount>at.errorUpdateCount,isFetching:mt,isRefetching:mt&&!gt,isLoadingError:yt&&!xt,isPaused:ct.fetchStatus==="paused",isPlaceholderData:lt,isRefetchError:yt&&xt,isStale:isStale($,_e),refetch:this.refetch,promise:bt(this,Pr),isEnabled:resolveEnabled(_e.enabled,$)!==!1};if(this.options.experimental_prefetchInRender){const Tt=jt=>{Et.status==="error"?jt.reject(Et.error):Et.data!==void 0&&jt.resolve(Et.data)},Ct=()=>{const jt=Dt(this,Pr,Et.promise=pendingThenable());Tt(jt)},Rt=bt(this,Pr);switch(Rt.status){case"pending":$.queryHash===et.queryHash&&Tt(Rt);break;case"fulfilled":(Et.status==="error"||Et.data!==Rt.value)&&Ct();break;case"rejected":(Et.status!=="error"||Et.error!==Rt.reason)&&Ct();break}}return Et}updateResult(){const $=bt(this,ir),_e=this.createResult(bt(this,Nn),this.options);if(Dt(this,ns,bt(this,Nn).state),Dt(this,Rs,this.options),bt(this,ns).data!==void 0&&Dt(this,Ps,bt(this,Nn)),shallowEqualObjects(_e,$))return;Dt(this,ir,_e);const et=()=>{if(!$)return!0;const{notifyOnChangeProps:tt}=this.options,nt=typeof tt=="function"?tt():tt;if(nt==="all"||!nt&&!bt(this,As).size)return!0;const rt=new Set(nt??bt(this,As));return this.options.throwOnError&&rt.add("error"),Object.keys(bt(this,ir)).some(it=>{const st=it;return bt(this,ir)[st]!==$[st]&&rt.has(st)})};hn(this,Ln,Jl).call(this,{listeners:et()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&hn(this,Ln,Yo).call(this)}},or=new WeakMap,Nn=new WeakMap,na=new WeakMap,ir=new WeakMap,ns=new WeakMap,Rs=new WeakMap,Pr=new WeakMap,Ur=new WeakMap,ga=new WeakMap,_s=new WeakMap,Ps=new WeakMap,rs=new WeakMap,ss=new WeakMap,Vr=new WeakMap,As=new WeakMap,Ln=new WeakSet,Xs=function($){hn(this,Ln,Jo).call(this);let _e=bt(this,Nn).fetch(this.options,$);return $!=null&&$.throwOnError||(_e=_e.catch(noop$7)),_e},Ho=function(){hn(this,Ln,Xo).call(this);const $=resolveStaleTime(this.options.staleTime,bt(this,Nn));if(isServer||bt(this,ir).isStale||!isValidTimeout($))return;const et=timeUntilStale(bt(this,ir).dataUpdatedAt,$)+1;Dt(this,rs,timeoutManager.setTimeout(()=>{bt(this,ir).isStale||this.updateResult()},et))},Go=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(bt(this,Nn)):this.options.refetchInterval)??!1},Zo=function($){hn(this,Ln,Qo).call(this),Dt(this,Vr,$),!(isServer||resolveEnabled(this.options.enabled,bt(this,Nn))===!1||!isValidTimeout(bt(this,Vr))||bt(this,Vr)===0)&&Dt(this,ss,timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||focusManager.isFocused())&&hn(this,Ln,Xs).call(this)},bt(this,Vr)))},Yo=function(){hn(this,Ln,Ho).call(this),hn(this,Ln,Zo).call(this,hn(this,Ln,Go).call(this))},Xo=function(){bt(this,rs)&&(timeoutManager.clearTimeout(bt(this,rs)),Dt(this,rs,void 0))},Qo=function(){bt(this,ss)&&(timeoutManager.clearInterval(bt(this,ss)),Dt(this,ss,void 0))},Jo=function(){const $=bt(this,or).getQueryCache().build(bt(this,or),this.options);if($===bt(this,Nn))return;const _e=bt(this,Nn);Dt(this,Nn,$),Dt(this,na,$.state),this.hasListeners()&&(_e==null||_e.removeObserver(this),$.addObserver(this))},Jl=function($){notifyManager.batch(()=>{$.listeners&&this.listeners.forEach(_e=>{_e(bt(this,ir))}),bt(this,or).getQueryCache().notify({query:bt(this,Nn),type:"observerResultsUpdated"})})},zl);function shouldLoadOnMount(j,$){return resolveEnabled($.enabled,j)!==!1&&j.state.data===void 0&&!(j.state.status==="error"&&$.retryOnMount===!1)}function shouldFetchOnMount(j,$){return shouldLoadOnMount(j,$)||j.state.data!==void 0&&shouldFetchOn(j,$,$.refetchOnMount)}function shouldFetchOn(j,$,_e){if(resolveEnabled($.enabled,j)!==!1&&resolveStaleTime($.staleTime,j)!=="static"){const et=typeof _e=="function"?_e(j):_e;return et==="always"||et!==!1&&isStale(j,$)}return!1}function shouldFetchOptionally(j,$,_e,et){return(j!==$||resolveEnabled(et.enabled,j)===!1)&&(!_e.suspense||j.state.status!=="error")&&isStale(j,_e)}function isStale(j,$){return resolveEnabled($.enabled,j)!==!1&&j.isStaleByTime(resolveStaleTime($.staleTime,j))}function shouldAssignObserverCurrentProperties(j,$){return!shallowEqualObjects(j.getCurrentResult(),$)}function infiniteQueryBehavior(j){return{onFetch:($,_e)=>{var ot,ct,lt,ut,pt;const et=$.options,tt=(lt=(ct=(ot=$.fetchOptions)==null?void 0:ot.meta)==null?void 0:ct.fetchMore)==null?void 0:lt.direction,nt=((ut=$.state.data)==null?void 0:ut.pages)||[],rt=((pt=$.state.data)==null?void 0:pt.pageParams)||[];let it={pages:[],pageParams:[]},st=0;const at=async()=>{let dt=!1;const ht=gt=>{Object.defineProperty(gt,"signal",{enumerable:!0,get:()=>($.signal.aborted?dt=!0:$.signal.addEventListener("abort",()=>{dt=!0}),$.signal)})},ft=ensureQueryFn($.options,$.fetchOptions),mt=async(gt,yt,vt)=>{if(dt)return Promise.reject();if(yt==null&&gt.pages.length)return Promise.resolve(gt);const St=(()=>{const Ct={client:$.client,queryKey:$.queryKey,pageParam:yt,direction:vt?"backward":"forward",meta:$.options.meta};return ht(Ct),Ct})(),Et=await ft(St),{maxPages:wt}=$.options,Tt=vt?addToStart:addToEnd;return{pages:Tt(gt.pages,Et,wt),pageParams:Tt(gt.pageParams,yt,wt)}};if(tt&&nt.length){const gt=tt==="backward",yt=gt?getPreviousPageParam:getNextPageParam,vt={pages:nt,pageParams:rt},xt=yt(et,vt);it=await mt(vt,xt,gt)}else{const gt=j??nt.length;do{const yt=st===0?rt[0]??et.initialPageParam:getNextPageParam(et,it);if(st>0&&yt==null)break;it=await mt(it,yt),st++}while(st<gt)}return it};$.options.persister?$.fetchFn=()=>{var dt,ht;return(ht=(dt=$.options).persister)==null?void 0:ht.call(dt,at,{client:$.client,queryKey:$.queryKey,meta:$.options.meta,signal:$.signal},_e)}:$.fetchFn=at}}}function getNextPageParam(j,{pages:$,pageParams:_e}){const et=$.length-1;return $.length>0?j.getNextPageParam($[et],$,_e[et],_e):void 0}function getPreviousPageParam(j,{pages:$,pageParams:_e}){var et;return $.length>0?(et=j.getPreviousPageParam)==null?void 0:et.call(j,$[0],$,_e[0],_e):void 0}var xa,Tr,sr,as,wr,Mr,Wl,Mutation=(Wl=class extends Removable{constructor($){super();zt(this,wr);zt(this,xa);zt(this,Tr);zt(this,sr);zt(this,as);Dt(this,xa,$.client),this.mutationId=$.mutationId,Dt(this,sr,$.mutationCache),Dt(this,Tr,[]),this.state=$.state||getDefaultState(),this.setOptions($.options),this.scheduleGc()}setOptions($){this.options=$,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver($){bt(this,Tr).includes($)||(bt(this,Tr).push($),this.clearGcTimeout(),bt(this,sr).notify({type:"observerAdded",mutation:this,observer:$}))}removeObserver($){Dt(this,Tr,bt(this,Tr).filter(_e=>_e!==$)),this.scheduleGc(),bt(this,sr).notify({type:"observerRemoved",mutation:this,observer:$})}optionalRemove(){bt(this,Tr).length||(this.state.status==="pending"?this.scheduleGc():bt(this,sr).remove(this))}continue(){var $;return(($=bt(this,as))==null?void 0:$.continue())??this.execute(this.state.variables)}async execute($){var rt,it,st,at,ot,ct,lt,ut,pt,dt,ht,ft,mt,gt,yt,vt,xt,St,Et,wt;const _e=()=>{hn(this,wr,Mr).call(this,{type:"continue"})},et={client:bt(this,xa),meta:this.options.meta,mutationKey:this.options.mutationKey};Dt(this,as,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn($,et):Promise.reject(new Error("No mutationFn found")),onFail:(Tt,Ct)=>{hn(this,wr,Mr).call(this,{type:"failed",failureCount:Tt,error:Ct})},onPause:()=>{hn(this,wr,Mr).call(this,{type:"pause"})},onContinue:_e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>bt(this,sr).canRun(this)}));const tt=this.state.status==="pending",nt=!bt(this,as).canStart();try{if(tt)_e();else{hn(this,wr,Mr).call(this,{type:"pending",variables:$,isPaused:nt}),await((it=(rt=bt(this,sr).config).onMutate)==null?void 0:it.call(rt,$,this,et));const Ct=await((at=(st=this.options).onMutate)==null?void 0:at.call(st,$,et));Ct!==this.state.context&&hn(this,wr,Mr).call(this,{type:"pending",context:Ct,variables:$,isPaused:nt})}const Tt=await bt(this,as).start();return await((ct=(ot=bt(this,sr).config).onSuccess)==null?void 0:ct.call(ot,Tt,$,this.state.context,this,et)),await((ut=(lt=this.options).onSuccess)==null?void 0:ut.call(lt,Tt,$,this.state.context,et)),await((dt=(pt=bt(this,sr).config).onSettled)==null?void 0:dt.call(pt,Tt,null,this.state.variables,this.state.context,this,et)),await((ft=(ht=this.options).onSettled)==null?void 0:ft.call(ht,Tt,null,$,this.state.context,et)),hn(this,wr,Mr).call(this,{type:"success",data:Tt}),Tt}catch(Tt){try{throw await((gt=(mt=bt(this,sr).config).onError)==null?void 0:gt.call(mt,Tt,$,this.state.context,this,et)),await((vt=(yt=this.options).onError)==null?void 0:vt.call(yt,Tt,$,this.state.context,et)),await((St=(xt=bt(this,sr).config).onSettled)==null?void 0:St.call(xt,void 0,Tt,this.state.variables,this.state.context,this,et)),await((wt=(Et=this.options).onSettled)==null?void 0:wt.call(Et,void 0,Tt,$,this.state.context,et)),Tt}finally{hn(this,wr,Mr).call(this,{type:"error",error:Tt})}}finally{bt(this,sr).runNext(this)}}},xa=new WeakMap,Tr=new WeakMap,sr=new WeakMap,as=new WeakMap,wr=new WeakSet,Mr=function($){const _e=et=>{switch($.type){case"failed":return{...et,failureCount:$.failureCount,failureReason:$.error};case"pause":return{...et,isPaused:!0};case"continue":return{...et,isPaused:!1};case"pending":return{...et,context:$.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:$.isPaused,status:"pending",variables:$.variables,submittedAt:Date.now()};case"success":return{...et,data:$.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...et,data:void 0,error:$.error,failureCount:et.failureCount+1,failureReason:$.error,isPaused:!1,status:"error"}}};this.state=_e(this.state),notifyManager.batch(()=>{bt(this,Tr).forEach(et=>{et.onMutationUpdate($)}),bt(this,sr).notify({mutation:this,type:"updated",action:$})})},Wl);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ar,vr,ba,Kl,MutationCache=(Kl=class extends Subscribable{constructor($={}){super();zt(this,Ar);zt(this,vr);zt(this,ba);this.config=$,Dt(this,Ar,new Set),Dt(this,vr,new Map),Dt(this,ba,0)}build($,_e,et){const tt=new Mutation({client:$,mutationCache:this,mutationId:++Mo(this,ba)._,options:$.defaultMutationOptions(_e),state:et});return this.add(tt),tt}add($){bt(this,Ar).add($);const _e=scopeFor($);if(typeof _e=="string"){const et=bt(this,vr).get(_e);et?et.push($):bt(this,vr).set(_e,[$])}this.notify({type:"added",mutation:$})}remove($){if(bt(this,Ar).delete($)){const _e=scopeFor($);if(typeof _e=="string"){const et=bt(this,vr).get(_e);if(et)if(et.length>1){const tt=et.indexOf($);tt!==-1&&et.splice(tt,1)}else et[0]===$&&bt(this,vr).delete(_e)}}this.notify({type:"removed",mutation:$})}canRun($){const _e=scopeFor($);if(typeof _e=="string"){const et=bt(this,vr).get(_e),tt=et==null?void 0:et.find(nt=>nt.state.status==="pending");return!tt||tt===$}else return!0}runNext($){var et;const _e=scopeFor($);if(typeof _e=="string"){const tt=(et=bt(this,vr).get(_e))==null?void 0:et.find(nt=>nt!==$&&nt.state.isPaused);return(tt==null?void 0:tt.continue())??Promise.resolve()}else return Promise.resolve()}clear(){notifyManager.batch(()=>{bt(this,Ar).forEach($=>{this.notify({type:"removed",mutation:$})}),bt(this,Ar).clear(),bt(this,vr).clear()})}getAll(){return Array.from(bt(this,Ar))}find($){const _e={exact:!0,...$};return this.getAll().find(et=>matchMutation(_e,et))}findAll($={}){return this.getAll().filter(_e=>matchMutation($,_e))}notify($){notifyManager.batch(()=>{this.listeners.forEach(_e=>{_e($)})})}resumePausedMutations(){const $=this.getAll().filter(_e=>_e.state.isPaused);return notifyManager.batch(()=>Promise.all($.map(_e=>_e.continue().catch(noop$7))))}},Ar=new WeakMap,vr=new WeakMap,ba=new WeakMap,Kl);function scopeFor(j){var $;return($=j.options.scope)==null?void 0:$.id}var Cr,Hl,QueryCache=(Hl=class extends Subscribable{constructor($={}){super();zt(this,Cr);this.config=$,Dt(this,Cr,new Map)}build($,_e,et){const tt=_e.queryKey,nt=_e.queryHash??hashQueryKeyByOptions(tt,_e);let rt=this.get(nt);return rt||(rt=new Query({client:$,queryKey:tt,queryHash:nt,options:$.defaultQueryOptions(_e),state:et,defaultOptions:$.getQueryDefaults(tt)}),this.add(rt)),rt}add($){bt(this,Cr).has($.queryHash)||(bt(this,Cr).set($.queryHash,$),this.notify({type:"added",query:$}))}remove($){const _e=bt(this,Cr).get($.queryHash);_e&&($.destroy(),_e===$&&bt(this,Cr).delete($.queryHash),this.notify({type:"removed",query:$}))}clear(){notifyManager.batch(()=>{this.getAll().forEach($=>{this.remove($)})})}get($){return bt(this,Cr).get($)}getAll(){return[...bt(this,Cr).values()]}find($){const _e={exact:!0,...$};return this.getAll().find(et=>matchQuery(_e,et))}findAll($={}){const _e=this.getAll();return Object.keys($).length>0?_e.filter(et=>matchQuery($,et)):_e}notify($){notifyManager.batch(()=>{this.listeners.forEach(_e=>{_e($)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach($=>{$.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach($=>{$.onOnline()})})}},Cr=new WeakMap,Hl),Kn,zr,Wr,js,Is,Kr,Ns,Os,Gl,QueryClient=(Gl=class{constructor(j={}){zt(this,Kn);zt(this,zr);zt(this,Wr);zt(this,js);zt(this,Is);zt(this,Kr);zt(this,Ns);zt(this,Os);Dt(this,Kn,j.queryCache||new QueryCache),Dt(this,zr,j.mutationCache||new MutationCache),Dt(this,Wr,j.defaultOptions||{}),Dt(this,js,new Map),Dt(this,Is,new Map),Dt(this,Kr,0)}mount(){Mo(this,Kr)._++,bt(this,Kr)===1&&(Dt(this,Ns,focusManager.subscribe(async j=>{j&&(await this.resumePausedMutations(),bt(this,Kn).onFocus())})),Dt(this,Os,onlineManager.subscribe(async j=>{j&&(await this.resumePausedMutations(),bt(this,Kn).onOnline())})))}unmount(){var j,$;Mo(this,Kr)._--,bt(this,Kr)===0&&((j=bt(this,Ns))==null||j.call(this),Dt(this,Ns,void 0),($=bt(this,Os))==null||$.call(this),Dt(this,Os,void 0))}isFetching(j){return bt(this,Kn).findAll({...j,fetchStatus:"fetching"}).length}isMutating(j){return bt(this,zr).findAll({...j,status:"pending"}).length}getQueryData(j){var _e;const $=this.defaultQueryOptions({queryKey:j});return(_e=bt(this,Kn).get($.queryHash))==null?void 0:_e.state.data}ensureQueryData(j){const $=this.defaultQueryOptions(j),_e=bt(this,Kn).build(this,$),et=_e.state.data;return et===void 0?this.fetchQuery(j):(j.revalidateIfStale&&_e.isStaleByTime(resolveStaleTime($.staleTime,_e))&&this.prefetchQuery($),Promise.resolve(et))}getQueriesData(j){return bt(this,Kn).findAll(j).map(({queryKey:$,state:_e})=>{const et=_e.data;return[$,et]})}setQueryData(j,$,_e){const et=this.defaultQueryOptions({queryKey:j}),tt=bt(this,Kn).get(et.queryHash),nt=tt==null?void 0:tt.state.data,rt=functionalUpdate($,nt);if(rt!==void 0)return bt(this,Kn).build(this,et).setData(rt,{..._e,manual:!0})}setQueriesData(j,$,_e){return notifyManager.batch(()=>bt(this,Kn).findAll(j).map(({queryKey:et})=>[et,this.setQueryData(et,$,_e)]))}getQueryState(j){var _e;const $=this.defaultQueryOptions({queryKey:j});return(_e=bt(this,Kn).get($.queryHash))==null?void 0:_e.state}removeQueries(j){const $=bt(this,Kn);notifyManager.batch(()=>{$.findAll(j).forEach(_e=>{$.remove(_e)})})}resetQueries(j,$){const _e=bt(this,Kn);return notifyManager.batch(()=>(_e.findAll(j).forEach(et=>{et.reset()}),this.refetchQueries({type:"active",...j},$)))}cancelQueries(j,$={}){const _e={revert:!0,...$},et=notifyManager.batch(()=>bt(this,Kn).findAll(j).map(tt=>tt.cancel(_e)));return Promise.all(et).then(noop$7).catch(noop$7)}invalidateQueries(j,$={}){return notifyManager.batch(()=>(bt(this,Kn).findAll(j).forEach(_e=>{_e.invalidate()}),(j==null?void 0:j.refetchType)==="none"?Promise.resolve():this.refetchQueries({...j,type:(j==null?void 0:j.refetchType)??(j==null?void 0:j.type)??"active"},$)))}refetchQueries(j,$={}){const _e={...$,cancelRefetch:$.cancelRefetch??!0},et=notifyManager.batch(()=>bt(this,Kn).findAll(j).filter(tt=>!tt.isDisabled()&&!tt.isStatic()).map(tt=>{let nt=tt.fetch(void 0,_e);return _e.throwOnError||(nt=nt.catch(noop$7)),tt.state.fetchStatus==="paused"?Promise.resolve():nt}));return Promise.all(et).then(noop$7)}fetchQuery(j){const $=this.defaultQueryOptions(j);$.retry===void 0&&($.retry=!1);const _e=bt(this,Kn).build(this,$);return _e.isStaleByTime(resolveStaleTime($.staleTime,_e))?_e.fetch($):Promise.resolve(_e.state.data)}prefetchQuery(j){return this.fetchQuery(j).then(noop$7).catch(noop$7)}fetchInfiniteQuery(j){return j.behavior=infiniteQueryBehavior(j.pages),this.fetchQuery(j)}prefetchInfiniteQuery(j){return this.fetchInfiniteQuery(j).then(noop$7).catch(noop$7)}ensureInfiniteQueryData(j){return j.behavior=infiniteQueryBehavior(j.pages),this.ensureQueryData(j)}resumePausedMutations(){return onlineManager.isOnline()?bt(this,zr).resumePausedMutations():Promise.resolve()}getQueryCache(){return bt(this,Kn)}getMutationCache(){return bt(this,zr)}getDefaultOptions(){return bt(this,Wr)}setDefaultOptions(j){Dt(this,Wr,j)}setQueryDefaults(j,$){bt(this,js).set(hashKey(j),{queryKey:j,defaultOptions:$})}getQueryDefaults(j){const $=[...bt(this,js).values()],_e={};return $.forEach(et=>{partialMatchKey(j,et.queryKey)&&Object.assign(_e,et.defaultOptions)}),_e}setMutationDefaults(j,$){bt(this,Is).set(hashKey(j),{mutationKey:j,defaultOptions:$})}getMutationDefaults(j){const $=[...bt(this,Is).values()],_e={};return $.forEach(et=>{partialMatchKey(j,et.mutationKey)&&Object.assign(_e,et.defaultOptions)}),_e}defaultQueryOptions(j){if(j._defaulted)return j;const $={...bt(this,Wr).queries,...this.getQueryDefaults(j.queryKey),...j,_defaulted:!0};return $.queryHash||($.queryHash=hashQueryKeyByOptions($.queryKey,$)),$.refetchOnReconnect===void 0&&($.refetchOnReconnect=$.networkMode!=="always"),$.throwOnError===void 0&&($.throwOnError=!!$.suspense),!$.networkMode&&$.persister&&($.networkMode="offlineFirst"),$.queryFn===skipToken&&($.enabled=!1),$}defaultMutationOptions(j){return j!=null&&j._defaulted?j:{...bt(this,Wr).mutations,...(j==null?void 0:j.mutationKey)&&this.getMutationDefaults(j.mutationKey),...j,_defaulted:!0}}clear(){bt(this,Kn).clear(),bt(this,zr).clear()}},Kn=new WeakMap,zr=new WeakMap,Wr=new WeakMap,js=new WeakMap,Is=new WeakMap,Kr=new WeakMap,Ns=new WeakMap,Os=new WeakMap,Gl),QueryClientContext=reactExports.createContext(void 0),useQueryClient=j=>{const $=reactExports.useContext(QueryClientContext);if(!$)throw new Error("No QueryClient set, use QueryClientProvider to set one");return $},QueryClientProvider=({client:j,children:$})=>(reactExports.useEffect(()=>(j.mount(),()=>{j.unmount()}),[j]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:j,children:$})),IsRestoringContext=reactExports.createContext(!1),useIsRestoring=()=>reactExports.useContext(IsRestoringContext);IsRestoringContext.Provider;function createValue(){let j=!1;return{clearReset:()=>{j=!1},reset:()=>{j=!0},isReset:()=>j}}var QueryErrorResetBoundaryContext=reactExports.createContext(createValue()),useQueryErrorResetBoundary=()=>reactExports.useContext(QueryErrorResetBoundaryContext),ensurePreventErrorBoundaryRetry=(j,$)=>{(j.suspense||j.throwOnError||j.experimental_prefetchInRender)&&($.isReset()||(j.retryOnMount=!1))},useClearResetErrorBoundary=j=>{reactExports.useEffect(()=>{j.clearReset()},[j])},getHasError=({result:j,errorResetBoundary:$,throwOnError:_e,query:et,suspense:tt})=>j.isError&&!$.isReset()&&!j.isFetching&&et&&(tt&&j.data===void 0||shouldThrowError(_e,[j.error,et])),ensureSuspenseTimers=j=>{if(j.suspense){const _e=tt=>tt==="static"?tt:Math.max(tt??1e3,1e3),et=j.staleTime;j.staleTime=typeof et=="function"?(...tt)=>_e(et(...tt)):_e(et),typeof j.gcTime=="number"&&(j.gcTime=Math.max(j.gcTime,1e3))}},willFetch=(j,$)=>j.isLoading&&j.isFetching&&!$,shouldSuspend=(j,$)=>(j==null?void 0:j.suspense)&&$.isPending,fetchOptimistic=(j,$,_e)=>$.fetchOptimistic(j).catch(()=>{_e.clearReset()});function useBaseQuery(j,$,_e){var ct,lt,ut,pt,dt;const et=useIsRestoring(),tt=useQueryErrorResetBoundary(),nt=useQueryClient(),rt=nt.defaultQueryOptions(j);(lt=(ct=nt.getDefaultOptions().queries)==null?void 0:ct._experimental_beforeQuery)==null||lt.call(ct,rt),rt._optimisticResults=et?"isRestoring":"optimistic",ensureSuspenseTimers(rt),ensurePreventErrorBoundaryRetry(rt,tt),useClearResetErrorBoundary(tt);const it=!nt.getQueryCache().get(rt.queryHash),[st]=reactExports.useState(()=>new $(nt,rt)),at=st.getOptimisticResult(rt),ot=!et&&j.subscribed!==!1;if(reactExports.useSyncExternalStore(reactExports.useCallback(ht=>{const ft=ot?st.subscribe(notifyManager.batchCalls(ht)):noop$7;return st.updateResult(),ft},[st,ot]),()=>st.getCurrentResult(),()=>st.getCurrentResult()),reactExports.useEffect(()=>{st.setOptions(rt)},[rt,st]),shouldSuspend(rt,at))throw fetchOptimistic(rt,st,tt);if(getHasError({result:at,errorResetBoundary:tt,throwOnError:rt.throwOnError,query:nt.getQueryCache().get(rt.queryHash),suspense:rt.suspense}))throw at.error;if((pt=(ut=nt.getDefaultOptions().queries)==null?void 0:ut._experimental_afterQuery)==null||pt.call(ut,rt,at),rt.experimental_prefetchInRender&&!isServer&&willFetch(at,et)){const ht=it?fetchOptimistic(rt,st,tt):(dt=nt.getQueryCache().get(rt.queryHash))==null?void 0:dt.promise;ht==null||ht.catch(noop$7).finally(()=>{st.updateResult()})}return rt.notifyOnChangeProps?at:st.trackResult(at)}function useQuery(j,$){return useBaseQuery(j,QueryObserver)}/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$r(){return _extends$r=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$r.apply(this,arguments)}var Action;(function(j){j.Pop="POP",j.Push="PUSH",j.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(j){j===void 0&&(j={});function $(et,tt){let{pathname:nt,search:rt,hash:it}=et.location;return createLocation("",{pathname:nt,search:rt,hash:it},tt.state&&tt.state.usr||null,tt.state&&tt.state.key||"default")}function _e(et,tt){return typeof tt=="string"?tt:createPath(tt)}return getUrlBasedHistory($,_e,null,j)}function invariant$1(j,$){if(j===!1||j===null||typeof j>"u")throw new Error($)}function warning(j,$){if(!j){typeof console<"u"&&console.warn($);try{throw new Error($)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(j,$){return{usr:j.state,key:j.key,idx:$}}function createLocation(j,$,_e,et){return _e===void 0&&(_e=null),_extends$r({pathname:typeof j=="string"?j:j.pathname,search:"",hash:""},typeof $=="string"?parsePath($):$,{state:_e,key:$&&$.key||et||createKey()})}function createPath(j){let{pathname:$="/",search:_e="",hash:et=""}=j;return _e&&_e!=="?"&&($+=_e.charAt(0)==="?"?_e:"?"+_e),et&&et!=="#"&&($+=et.charAt(0)==="#"?et:"#"+et),$}function parsePath(j){let $={};if(j){let _e=j.indexOf("#");_e>=0&&($.hash=j.substr(_e),j=j.substr(0,_e));let et=j.indexOf("?");et>=0&&($.search=j.substr(et),j=j.substr(0,et)),j&&($.pathname=j)}return $}function getUrlBasedHistory(j,$,_e,et){et===void 0&&(et={});let{window:tt=document.defaultView,v5Compat:nt=!1}=et,rt=tt.history,it=Action.Pop,st=null,at=ot();at==null&&(at=0,rt.replaceState(_extends$r({},rt.state,{idx:at}),""));function ot(){return(rt.state||{idx:null}).idx}function ct(){it=Action.Pop;let ht=ot(),ft=ht==null?null:ht-at;at=ht,st&&st({action:it,location:dt.location,delta:ft})}function lt(ht,ft){it=Action.Push;let mt=createLocation(dt.location,ht,ft);at=ot()+1;let gt=getHistoryState(mt,at),yt=dt.createHref(mt);try{rt.pushState(gt,"",yt)}catch(vt){if(vt instanceof DOMException&&vt.name==="DataCloneError")throw vt;tt.location.assign(yt)}nt&&st&&st({action:it,location:dt.location,delta:1})}function ut(ht,ft){it=Action.Replace;let mt=createLocation(dt.location,ht,ft);at=ot();let gt=getHistoryState(mt,at),yt=dt.createHref(mt);rt.replaceState(gt,"",yt),nt&&st&&st({action:it,location:dt.location,delta:0})}function pt(ht){let ft=tt.location.origin!=="null"?tt.location.origin:tt.location.href,mt=typeof ht=="string"?ht:createPath(ht);return mt=mt.replace(/ $/,"%20"),invariant$1(ft,"No window.location.(origin|href) available to create URL for href: "+mt),new URL(mt,ft)}let dt={get action(){return it},get location(){return j(tt,rt)},listen(ht){if(st)throw new Error("A history only accepts one active listener");return tt.addEventListener(PopStateEventType,ct),st=ht,()=>{tt.removeEventListener(PopStateEventType,ct),st=null}},createHref(ht){return $(tt,ht)},createURL:pt,encodeLocation(ht){let ft=pt(ht);return{pathname:ft.pathname,search:ft.search,hash:ft.hash}},push:lt,replace:ut,go(ht){return rt.go(ht)}};return dt}var ResultType;(function(j){j.data="data",j.deferred="deferred",j.redirect="redirect",j.error="error"})(ResultType||(ResultType={}));function matchRoutes(j,$,_e){return _e===void 0&&(_e="/"),matchRoutesImpl(j,$,_e)}function matchRoutesImpl(j,$,_e,et){let tt=typeof $=="string"?parsePath($):$,nt=stripBasename(tt.pathname||"/",_e);if(nt==null)return null;let rt=flattenRoutes(j);rankRouteBranches(rt);let it=null;for(let st=0;it==null&&st<rt.length;++st){let at=decodePath(nt);it=matchRouteBranch(rt[st],at)}return it}function flattenRoutes(j,$,_e,et){$===void 0&&($=[]),_e===void 0&&(_e=[]),et===void 0&&(et="");let tt=(nt,rt,it)=>{let st={relativePath:it===void 0?nt.path||"":it,caseSensitive:nt.caseSensitive===!0,childrenIndex:rt,route:nt};st.relativePath.startsWith("/")&&(invariant$1(st.relativePath.startsWith(et),'Absolute route path "'+st.relativePath+'" nested under path '+('"'+et+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),st.relativePath=st.relativePath.slice(et.length));let at=joinPaths([et,st.relativePath]),ot=_e.concat(st);nt.children&&nt.children.length>0&&(invariant$1(nt.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+at+'".')),flattenRoutes(nt.children,$,ot,at)),!(nt.path==null&&!nt.index)&&$.push({path:at,score:computeScore(at,nt.index),routesMeta:ot})};return j.forEach((nt,rt)=>{var it;if(nt.path===""||!((it=nt.path)!=null&&it.includes("?")))tt(nt,rt);else for(let st of explodeOptionalSegments(nt.path))tt(nt,rt,st)}),$}function explodeOptionalSegments(j){let $=j.split("/");if($.length===0)return[];let[_e,...et]=$,tt=_e.endsWith("?"),nt=_e.replace(/\?$/,"");if(et.length===0)return tt?[nt,""]:[nt];let rt=explodeOptionalSegments(et.join("/")),it=[];return it.push(...rt.map(st=>st===""?nt:[nt,st].join("/"))),tt&&it.push(...rt),it.map(st=>j.startsWith("/")&&st===""?"/":st)}function rankRouteBranches(j){j.sort(($,_e)=>$.score!==_e.score?_e.score-$.score:compareIndexes($.routesMeta.map(et=>et.childrenIndex),_e.routesMeta.map(et=>et.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=j=>j==="*";function computeScore(j,$){let _e=j.split("/"),et=_e.length;return _e.some(isSplat)&&(et+=splatPenalty),$&&(et+=indexRouteValue),_e.filter(tt=>!isSplat(tt)).reduce((tt,nt)=>tt+(paramRe.test(nt)?dynamicSegmentValue:nt===""?emptySegmentValue:staticSegmentValue),et)}function compareIndexes(j,$){return j.length===$.length&&j.slice(0,-1).every((et,tt)=>et===$[tt])?j[j.length-1]-$[$.length-1]:0}function matchRouteBranch(j,$,_e){let{routesMeta:et}=j,tt={},nt="/",rt=[];for(let it=0;it<et.length;++it){let st=et[it],at=it===et.length-1,ot=nt==="/"?$:$.slice(nt.length)||"/",ct=matchPath({path:st.relativePath,caseSensitive:st.caseSensitive,end:at},ot),lt=st.route;if(!ct)return null;Object.assign(tt,ct.params),rt.push({params:tt,pathname:joinPaths([nt,ct.pathname]),pathnameBase:normalizePathname(joinPaths([nt,ct.pathnameBase])),route:lt}),ct.pathnameBase!=="/"&&(nt=joinPaths([nt,ct.pathnameBase]))}return rt}function matchPath(j,$){typeof j=="string"&&(j={path:j,caseSensitive:!1,end:!0});let[_e,et]=compilePath(j.path,j.caseSensitive,j.end),tt=$.match(_e);if(!tt)return null;let nt=tt[0],rt=nt.replace(/(.)\/+$/,"$1"),it=tt.slice(1);return{params:et.reduce((at,ot,ct)=>{let{paramName:lt,isOptional:ut}=ot;if(lt==="*"){let dt=it[ct]||"";rt=nt.slice(0,nt.length-dt.length).replace(/(.)\/+$/,"$1")}const pt=it[ct];return ut&&!pt?at[lt]=void 0:at[lt]=(pt||"").replace(/%2F/g,"/"),at},{}),pathname:nt,pathnameBase:rt,pattern:j}}function compilePath(j,$,_e){$===void 0&&($=!1),_e===void 0&&(_e=!0),warning(j==="*"||!j.endsWith("*")||j.endsWith("/*"),'Route path "'+j+'" will be treated as if it were '+('"'+j.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+j.replace(/\*$/,"/*")+'".'));let et=[],tt="^"+j.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(rt,it,st)=>(et.push({paramName:it,isOptional:st!=null}),st?"/?([^\\/]+)?":"/([^\\/]+)"));return j.endsWith("*")?(et.push({paramName:"*"}),tt+=j==="*"||j==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):_e?tt+="\\/*$":j!==""&&j!=="/"&&(tt+="(?:(?=\\/|$))"),[new RegExp(tt,$?void 0:"i"),et]}function decodePath(j){try{return j.split("/").map($=>decodeURIComponent($).replace(/\//g,"%2F")).join("/")}catch($){return warning(!1,'The URL path "'+j+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+$+").")),j}}function stripBasename(j,$){if($==="/")return j;if(!j.toLowerCase().startsWith($.toLowerCase()))return null;let _e=$.endsWith("/")?$.length-1:$.length,et=j.charAt(_e);return et&&et!=="/"?null:j.slice(_e)||"/"}const ABSOLUTE_URL_REGEX$1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,isAbsoluteUrl=j=>ABSOLUTE_URL_REGEX$1.test(j);function resolvePath(j,$){$===void 0&&($="/");let{pathname:_e,search:et="",hash:tt=""}=typeof j=="string"?parsePath(j):j,nt;if(_e)if(isAbsoluteUrl(_e))nt=_e;else{if(_e.includes("//")){let rt=_e;_e=_e.replace(/\/\/+/g,"/"),warning(!1,"Pathnames cannot have embedded double slashes - normalizing "+(rt+" -> "+_e))}_e.startsWith("/")?nt=resolvePathname(_e.substring(1),"/"):nt=resolvePathname(_e,$)}else nt=$;return{pathname:nt,search:normalizeSearch(et),hash:normalizeHash(tt)}}function resolvePathname(j,$){let _e=$.replace(/\/+$/,"").split("/");return j.split("/").forEach(tt=>{tt===".."?_e.length>1&&_e.pop():tt!=="."&&_e.push(tt)}),_e.length>1?_e.join("/"):"/"}function getInvalidPathError(j,$,_e,et){return"Cannot include a '"+j+"' character in a manually specified "+("`to."+$+"` field ["+JSON.stringify(et)+"].  Please separate it out to the ")+("`to."+_e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(j){return j.filter(($,_e)=>_e===0||$.route.path&&$.route.path.length>0)}function getResolveToMatches(j,$){let _e=getPathContributingMatches(j);return $?_e.map((et,tt)=>tt===_e.length-1?et.pathname:et.pathnameBase):_e.map(et=>et.pathnameBase)}function resolveTo(j,$,_e,et){et===void 0&&(et=!1);let tt;typeof j=="string"?tt=parsePath(j):(tt=_extends$r({},j),invariant$1(!tt.pathname||!tt.pathname.includes("?"),getInvalidPathError("?","pathname","search",tt)),invariant$1(!tt.pathname||!tt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",tt)),invariant$1(!tt.search||!tt.search.includes("#"),getInvalidPathError("#","search","hash",tt)));let nt=j===""||tt.pathname==="",rt=nt?"/":tt.pathname,it;if(rt==null)it=_e;else{let ct=$.length-1;if(!et&&rt.startsWith("..")){let lt=rt.split("/");for(;lt[0]==="..";)lt.shift(),ct-=1;tt.pathname=lt.join("/")}it=ct>=0?$[ct]:"/"}let st=resolvePath(tt,it),at=rt&&rt!=="/"&&rt.endsWith("/"),ot=(nt||rt===".")&&_e.endsWith("/");return!st.pathname.endsWith("/")&&(at||ot)&&(st.pathname+="/"),st}const joinPaths=j=>j.join("/").replace(/\/\/+/g,"/"),normalizePathname=j=>j.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=j=>!j||j==="?"?"":j.startsWith("?")?j:"?"+j,normalizeHash=j=>!j||j==="#"?"":j.startsWith("#")?j:"#"+j;function isRouteErrorResponse(j){return j!=null&&typeof j.status=="number"&&typeof j.statusText=="string"&&typeof j.internal=="boolean"&&"data"in j}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$q(){return _extends$q=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$q.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(j,$){let{relative:_e}=$===void 0?{}:$;useInRouterContext()||invariant$1(!1);let{basename:et,navigator:tt}=reactExports.useContext(NavigationContext),{hash:nt,pathname:rt,search:it}=useResolvedPath(j,{relative:_e}),st=rt;return et!=="/"&&(st=rt==="/"?et:joinPaths([et,rt])),tt.createHref({pathname:st,search:it,hash:nt})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$4(j){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(j)}function useNavigate(){let{isDataRoute:j}=reactExports.useContext(RouteContext);return j?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$1(!1);let j=reactExports.useContext(DataRouterContext),{basename:$,future:_e,navigator:et}=reactExports.useContext(NavigationContext),{matches:tt}=reactExports.useContext(RouteContext),{pathname:nt}=useLocation(),rt=JSON.stringify(getResolveToMatches(tt,_e.v7_relativeSplatPath)),it=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{it.current=!0}),reactExports.useCallback(function(at,ot){if(ot===void 0&&(ot={}),!it.current)return;if(typeof at=="number"){et.go(at);return}let ct=resolveTo(at,JSON.parse(rt),nt,ot.relative==="path");j==null&&$!=="/"&&(ct.pathname=ct.pathname==="/"?$:joinPaths([$,ct.pathname])),(ot.replace?et.replace:et.push)(ct,ot.state,ot)},[$,et,rt,nt,j])}function useResolvedPath(j,$){let{relative:_e}=$===void 0?{}:$,{future:et}=reactExports.useContext(NavigationContext),{matches:tt}=reactExports.useContext(RouteContext),{pathname:nt}=useLocation(),rt=JSON.stringify(getResolveToMatches(tt,et.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(j,JSON.parse(rt),nt,_e==="path"),[j,rt,nt,_e])}function useRoutes(j,$){return useRoutesImpl(j,$)}function useRoutesImpl(j,$,_e,et){useInRouterContext()||invariant$1(!1);let{navigator:tt}=reactExports.useContext(NavigationContext),{matches:nt}=reactExports.useContext(RouteContext),rt=nt[nt.length-1],it=rt?rt.params:{};rt&&rt.pathname;let st=rt?rt.pathnameBase:"/";rt&&rt.route;let at=useLocation(),ot;if($){var ct;let ht=typeof $=="string"?parsePath($):$;st==="/"||(ct=ht.pathname)!=null&&ct.startsWith(st)||invariant$1(!1),ot=ht}else ot=at;let lt=ot.pathname||"/",ut=lt;if(st!=="/"){let ht=st.replace(/^\//,"").split("/");ut="/"+lt.replace(/^\//,"").split("/").slice(ht.length).join("/")}let pt=matchRoutes(j,{pathname:ut}),dt=_renderMatches(pt&&pt.map(ht=>Object.assign({},ht,{params:Object.assign({},it,ht.params),pathname:joinPaths([st,tt.encodeLocation?tt.encodeLocation(ht.pathname).pathname:ht.pathname]),pathnameBase:ht.pathnameBase==="/"?st:joinPaths([st,tt.encodeLocation?tt.encodeLocation(ht.pathnameBase).pathname:ht.pathnameBase])})),nt,_e,et);return $&&dt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$q({pathname:"/",search:"",hash:"",state:null,key:"default"},ot),navigationType:Action.Pop}},dt):dt}function DefaultErrorComponent(){let j=useRouteError(),$=isRouteErrorResponse(j)?j.status+" "+j.statusText:j instanceof Error?j.message:JSON.stringify(j),_e=j instanceof Error?j.stack:null,tt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},$),_e?reactExports.createElement("pre",{style:tt},_e):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor($){super($),this.state={location:$.location,revalidation:$.revalidation,error:$.error}}static getDerivedStateFromError($){return{error:$}}static getDerivedStateFromProps($,_e){return _e.location!==$.location||_e.revalidation!=="idle"&&$.revalidation==="idle"?{error:$.error,location:$.location,revalidation:$.revalidation}:{error:$.error!==void 0?$.error:_e.error,location:_e.location,revalidation:$.revalidation||_e.revalidation}}componentDidCatch($,_e){console.error("React Router caught the following error during render",$,_e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(j){let{routeContext:$,match:_e,children:et}=j,tt=reactExports.useContext(DataRouterContext);return tt&&tt.static&&tt.staticContext&&(_e.route.errorElement||_e.route.ErrorBoundary)&&(tt.staticContext._deepestRenderedBoundaryId=_e.route.id),reactExports.createElement(RouteContext.Provider,{value:$},et)}function _renderMatches(j,$,_e,et){var tt;if($===void 0&&($=[]),_e===void 0&&(_e=null),et===void 0&&(et=null),j==null){var nt;if(!_e)return null;if(_e.errors)j=_e.matches;else if((nt=et)!=null&&nt.v7_partialHydration&&$.length===0&&!_e.initialized&&_e.matches.length>0)j=_e.matches;else return null}let rt=j,it=(tt=_e)==null?void 0:tt.errors;if(it!=null){let ot=rt.findIndex(ct=>ct.route.id&&(it==null?void 0:it[ct.route.id])!==void 0);ot>=0||invariant$1(!1),rt=rt.slice(0,Math.min(rt.length,ot+1))}let st=!1,at=-1;if(_e&&et&&et.v7_partialHydration)for(let ot=0;ot<rt.length;ot++){let ct=rt[ot];if((ct.route.HydrateFallback||ct.route.hydrateFallbackElement)&&(at=ot),ct.route.id){let{loaderData:lt,errors:ut}=_e,pt=ct.route.loader&&lt[ct.route.id]===void 0&&(!ut||ut[ct.route.id]===void 0);if(ct.route.lazy||pt){st=!0,at>=0?rt=rt.slice(0,at+1):rt=[rt[0]];break}}}return rt.reduceRight((ot,ct,lt)=>{let ut,pt=!1,dt=null,ht=null;_e&&(ut=it&&ct.route.id?it[ct.route.id]:void 0,dt=ct.route.errorElement||defaultErrorElement,st&&(at<0&&lt===0?(warningOnce("route-fallback"),pt=!0,ht=null):at===lt&&(pt=!0,ht=ct.route.hydrateFallbackElement||null)));let ft=$.concat(rt.slice(0,lt+1)),mt=()=>{let gt;return ut?gt=dt:pt?gt=ht:ct.route.Component?gt=reactExports.createElement(ct.route.Component,null):ct.route.element?gt=ct.route.element:gt=ot,reactExports.createElement(RenderedRoute,{match:ct,routeContext:{outlet:ot,matches:ft,isDataRoute:_e!=null},children:gt})};return _e&&(ct.route.ErrorBoundary||ct.route.errorElement||lt===0)?reactExports.createElement(RenderErrorBoundary,{location:_e.location,revalidation:_e.revalidation,component:dt,error:ut,children:mt(),routeContext:{outlet:null,matches:ft,isDataRoute:!0}}):mt()},null)}var DataRouterHook$1=function(j){return j.UseBlocker="useBlocker",j.UseRevalidator="useRevalidator",j.UseNavigateStable="useNavigate",j}(DataRouterHook$1||{}),DataRouterStateHook$1=function(j){return j.UseBlocker="useBlocker",j.UseLoaderData="useLoaderData",j.UseActionData="useActionData",j.UseRouteError="useRouteError",j.UseNavigation="useNavigation",j.UseRouteLoaderData="useRouteLoaderData",j.UseMatches="useMatches",j.UseRevalidator="useRevalidator",j.UseNavigateStable="useNavigate",j.UseRouteId="useRouteId",j}(DataRouterStateHook$1||{});function useDataRouterContext(j){let $=reactExports.useContext(DataRouterContext);return $||invariant$1(!1),$}function useDataRouterState(j){let $=reactExports.useContext(DataRouterStateContext);return $||invariant$1(!1),$}function useRouteContext(j){let $=reactExports.useContext(RouteContext);return $||invariant$1(!1),$}function useCurrentRouteId(j){let $=useRouteContext(),_e=$.matches[$.matches.length-1];return _e.route.id||invariant$1(!1),_e.route.id}function useRouteError(){var j;let $=reactExports.useContext(RouteErrorContext),_e=useDataRouterState(),et=useCurrentRouteId();return $!==void 0?$:(j=_e.errors)==null?void 0:j[et]}function useNavigateStable(){let{router:j}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),$=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),_e=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{_e.current=!0}),reactExports.useCallback(function(tt,nt){nt===void 0&&(nt={}),_e.current&&(typeof tt=="number"?j.navigate(tt):j.navigate(tt,_extends$q({fromRouteId:$},nt)))},[j,$])}const alreadyWarned$1={};function warningOnce(j,$,_e){alreadyWarned$1[j]||(alreadyWarned$1[j]=!0)}function logV6DeprecationWarnings(j,$){j==null||j.v7_startTransition,j==null||j.v7_relativeSplatPath}function Navigate(j){let{to:$,replace:_e,state:et,relative:tt}=j;useInRouterContext()||invariant$1(!1);let{future:nt,static:rt}=reactExports.useContext(NavigationContext),{matches:it}=reactExports.useContext(RouteContext),{pathname:st}=useLocation(),at=useNavigate(),ot=resolveTo($,getResolveToMatches(it,nt.v7_relativeSplatPath),st,tt==="path"),ct=JSON.stringify(ot);return reactExports.useEffect(()=>at(JSON.parse(ct),{replace:_e,state:et,relative:tt}),[at,ct,tt,_e,et]),null}function Route(j){invariant$1(!1)}function Router(j){let{basename:$="/",children:_e=null,location:et,navigationType:tt=Action.Pop,navigator:nt,static:rt=!1,future:it}=j;useInRouterContext()&&invariant$1(!1);let st=$.replace(/^\/*/,"/"),at=reactExports.useMemo(()=>({basename:st,navigator:nt,static:rt,future:_extends$q({v7_relativeSplatPath:!1},it)}),[st,it,nt,rt]);typeof et=="string"&&(et=parsePath(et));let{pathname:ot="/",search:ct="",hash:lt="",state:ut=null,key:pt="default"}=et,dt=reactExports.useMemo(()=>{let ht=stripBasename(ot,st);return ht==null?null:{location:{pathname:ht,search:ct,hash:lt,state:ut,key:pt},navigationType:tt}},[st,ot,ct,lt,ut,pt,tt]);return dt==null?null:reactExports.createElement(NavigationContext.Provider,{value:at},reactExports.createElement(LocationContext.Provider,{children:_e,value:dt}))}function Routes(j){let{children:$,location:_e}=j;return useRoutes(createRoutesFromChildren($),_e)}new Promise(()=>{});function createRoutesFromChildren(j,$){$===void 0&&($=[]);let _e=[];return reactExports.Children.forEach(j,(et,tt)=>{if(!reactExports.isValidElement(et))return;let nt=[...$,tt];if(et.type===reactExports.Fragment){_e.push.apply(_e,createRoutesFromChildren(et.props.children,nt));return}et.type!==Route&&invariant$1(!1),!et.props.index||!et.props.children||invariant$1(!1);let rt={id:et.props.id||nt.join("-"),caseSensitive:et.props.caseSensitive,element:et.props.element,Component:et.props.Component,index:et.props.index,path:et.props.path,loader:et.props.loader,action:et.props.action,errorElement:et.props.errorElement,ErrorBoundary:et.props.ErrorBoundary,hasErrorBoundary:et.props.ErrorBoundary!=null||et.props.errorElement!=null,shouldRevalidate:et.props.shouldRevalidate,handle:et.props.handle,lazy:et.props.lazy};et.props.children&&(rt.children=createRoutesFromChildren(et.props.children,nt)),_e.push(rt)}),_e}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$p(){return _extends$p=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$p.apply(this,arguments)}function _objectWithoutPropertiesLoose$l(j,$){if(j==null)return{};var _e={},et=Object.keys(j),tt,nt;for(nt=0;nt<et.length;nt++)tt=et[nt],!($.indexOf(tt)>=0)&&(_e[tt]=j[tt]);return _e}function isModifiedEvent(j){return!!(j.metaKey||j.altKey||j.ctrlKey||j.shiftKey)}function shouldProcessLinkClick(j,$){return j.button===0&&(!$||$==="_self")&&!isModifiedEvent(j)}function createSearchParams(j){return j===void 0&&(j=""),new URLSearchParams(typeof j=="string"||Array.isArray(j)||j instanceof URLSearchParams?j:Object.keys(j).reduce(($,_e)=>{let et=j[_e];return $.concat(Array.isArray(et)?et.map(tt=>[_e,tt]):[[_e,et]])},[]))}function getSearchParamsForLocation(j,$){let _e=createSearchParams(j);return $&&$.forEach((et,tt)=>{_e.has(tt)||$.getAll(tt).forEach(nt=>{_e.append(tt,nt)})}),_e}const _excluded$l=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$5[START_TRANSITION];function BrowserRouter(j){let{basename:$,children:_e,future:et,window:tt}=j,nt=reactExports.useRef();nt.current==null&&(nt.current=createBrowserHistory({window:tt,v5Compat:!0}));let rt=nt.current,[it,st]=reactExports.useState({action:rt.action,location:rt.location}),{v7_startTransition:at}=et||{},ot=reactExports.useCallback(ct=>{at&&startTransitionImpl?startTransitionImpl(()=>st(ct)):st(ct)},[st,at]);return reactExports.useLayoutEffect(()=>rt.listen(ot),[rt,ot]),reactExports.useEffect(()=>logV6DeprecationWarnings(et),[et]),reactExports.createElement(Router,{basename:$,children:_e,location:it.location,navigationType:it.action,navigator:rt,future:et})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function($,_e){let{onClick:et,relative:tt,reloadDocument:nt,replace:rt,state:it,target:st,to:at,preventScrollReset:ot,viewTransition:ct}=$,lt=_objectWithoutPropertiesLoose$l($,_excluded$l),{basename:ut}=reactExports.useContext(NavigationContext),pt,dt=!1;if(typeof at=="string"&&ABSOLUTE_URL_REGEX.test(at)&&(pt=at,isBrowser$1))try{let gt=new URL(window.location.href),yt=at.startsWith("//")?new URL(gt.protocol+at):new URL(at),vt=stripBasename(yt.pathname,ut);yt.origin===gt.origin&&vt!=null?at=vt+yt.search+yt.hash:dt=!0}catch{}let ht=useHref(at,{relative:tt}),ft=useLinkClickHandler(at,{replace:rt,state:it,target:st,preventScrollReset:ot,relative:tt,viewTransition:ct});function mt(gt){et&&et(gt),gt.defaultPrevented||ft(gt)}return reactExports.createElement("a",_extends$p({},lt,{href:pt||ht,onClick:dt||nt?et:mt,ref:_e,target:st}))});var DataRouterHook;(function(j){j.UseScrollRestoration="useScrollRestoration",j.UseSubmit="useSubmit",j.UseSubmitFetcher="useSubmitFetcher",j.UseFetcher="useFetcher",j.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(j){j.UseFetcher="useFetcher",j.UseFetchers="useFetchers",j.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(j,$){let{target:_e,replace:et,state:tt,preventScrollReset:nt,relative:rt,viewTransition:it}=$===void 0?{}:$,st=useNavigate(),at=useLocation(),ot=useResolvedPath(j,{relative:rt});return reactExports.useCallback(ct=>{if(shouldProcessLinkClick(ct,_e)){ct.preventDefault();let lt=et!==void 0?et:createPath(at)===createPath(ot);st(j,{replace:lt,state:tt,preventScrollReset:nt,relative:rt,viewTransition:it})}},[at,st,ot,et,tt,_e,j,nt,rt,it])}function useSearchParams(j){let $=reactExports.useRef(createSearchParams(j)),_e=reactExports.useRef(!1),et=useLocation(),tt=reactExports.useMemo(()=>getSearchParamsForLocation(et.search,_e.current?null:$.current),[et.search]),nt=useNavigate(),rt=reactExports.useCallback((it,st)=>{const at=createSearchParams(typeof it=="function"?it(tt):it);_e.current=!0,nt("?"+at,st)},[nt,tt]);return[tt,rt]}var define_process_env_default={};function _mergeNamespaces$1(j,$){return $.forEach(function(_e){_e&&typeof _e!="string"&&!Array.isArray(_e)&&Object.keys(_e).forEach(function(et){if(et!=="default"&&!(et in j)){var tt=Object.getOwnPropertyDescriptor(_e,et);Object.defineProperty(j,et,tt.get?tt:{enumerable:!0,get:function(){return _e[et]}})}})}),Object.freeze(j)}var e$1=Object.defineProperty,h$1=(j,$,_e)=>$ in j?e$1(j,$,{enumerable:!0,configurable:!0,writable:!0,value:_e}):j[$]=_e,o$1=(j,$,_e)=>h$1(j,typeof $!="symbol"?$+"":$,_e);let _$1=class{constructor(){o$1(this,"_locking"),o$1(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let $;const _e=new Promise(tt=>$=()=>{this._locks-=1,tt()}),et=this._locking.then(()=>$);return this._locking=this._locking.then(()=>_e),et}};function assert(j,$){if(!j)throw new Error($)}const FLOAT32_MAX=34028234663852886e22,FLOAT32_MIN=-34028234663852886e22,UINT32_MAX=4294967295,INT32_MAX=2147483647,INT32_MIN=-2147483648;function assertInt32(j){if(typeof j!="number")throw new Error("invalid int 32: "+typeof j);if(!Number.isInteger(j)||j>INT32_MAX||j<INT32_MIN)throw new Error("invalid int 32: "+j)}function assertUInt32(j){if(typeof j!="number")throw new Error("invalid uint 32: "+typeof j);if(!Number.isInteger(j)||j>UINT32_MAX||j<0)throw new Error("invalid uint 32: "+j)}function assertFloat32(j){if(typeof j!="number")throw new Error("invalid float 32: "+typeof j);if(Number.isFinite(j)&&(j>FLOAT32_MAX||j<FLOAT32_MIN))throw new Error("invalid float 32: "+j)}const enumTypeSymbol=Symbol("@bufbuild/protobuf/enum-type");function getEnumType(j){const $=j[enumTypeSymbol];return assert($,"missing enum type on enum object"),$}function setEnumType(j,$,_e,et){j[enumTypeSymbol]=makeEnumType($,_e.map(tt=>({no:tt.no,name:tt.name,localName:j[tt.no]})))}function makeEnumType(j,$,_e){const et=Object.create(null),tt=Object.create(null),nt=[];for(const rt of $){const it=normalizeEnumValue(rt);nt.push(it),et[rt.name]=it,tt[rt.no]=it}return{typeName:j,values:nt,findName(rt){return et[rt]},findNumber(rt){return tt[rt]}}}function makeEnum(j,$,_e){const et={};for(const tt of $){const nt=normalizeEnumValue(tt);et[nt.localName]=nt.no,et[nt.no]=nt.localName}return setEnumType(et,j,$),et}function normalizeEnumValue(j){return"localName"in j?j:Object.assign(Object.assign({},j),{localName:j.name})}let Message$1=class{equals($){return this.getType().runtime.util.equals(this.getType(),this,$)}clone(){return this.getType().runtime.util.clone(this)}fromBinary($,_e){const et=this.getType(),tt=et.runtime.bin,nt=tt.makeReadOptions(_e);return tt.readMessage(this,nt.readerFactory($),$.byteLength,nt),this}fromJson($,_e){const et=this.getType(),tt=et.runtime.json,nt=tt.makeReadOptions(_e);return tt.readMessage(et,$,nt,this),this}fromJsonString($,_e){let et;try{et=JSON.parse($)}catch(tt){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(tt instanceof Error?tt.message:String(tt)))}return this.fromJson(et,_e)}toBinary($){const _e=this.getType(),et=_e.runtime.bin,tt=et.makeWriteOptions($),nt=tt.writerFactory();return et.writeMessage(this,nt,tt),nt.finish()}toJson($){const _e=this.getType(),et=_e.runtime.json,tt=et.makeWriteOptions($);return et.writeMessage(this,tt)}toJsonString($){var _e;const et=this.toJson($);return JSON.stringify(et,null,(_e=$==null?void 0:$.prettySpaces)!==null&&_e!==void 0?_e:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function makeMessageType(j,$,_e,et){var tt;const nt=(tt=et==null?void 0:et.localName)!==null&&tt!==void 0?tt:$.substring($.lastIndexOf(".")+1),rt={[nt]:function(it){j.util.initFields(this),j.util.initPartial(it,this)}}[nt];return Object.setPrototypeOf(rt.prototype,new Message$1),Object.assign(rt,{runtime:j,typeName:$,fields:j.util.newFieldList(_e),fromBinary(it,st){return new rt().fromBinary(it,st)},fromJson(it,st){return new rt().fromJson(it,st)},fromJsonString(it,st){return new rt().fromJsonString(it,st)},equals(it,st){return j.util.equals(rt,it,st)}}),rt}function varint64read(){let j=0,$=0;for(let et=0;et<28;et+=7){let tt=this.buf[this.pos++];if(j|=(tt&127)<<et,!(tt&128))return this.assertBounds(),[j,$]}let _e=this.buf[this.pos++];if(j|=(_e&15)<<28,$=(_e&112)>>4,!(_e&128))return this.assertBounds(),[j,$];for(let et=3;et<=31;et+=7){let tt=this.buf[this.pos++];if($|=(tt&127)<<et,!(tt&128))return this.assertBounds(),[j,$]}throw new Error("invalid varint")}function varint64write(j,$,_e){for(let nt=0;nt<28;nt=nt+7){const rt=j>>>nt,it=!(!(rt>>>7)&&$==0),st=(it?rt|128:rt)&255;if(_e.push(st),!it)return}const et=j>>>28&15|($&7)<<4,tt=!!($>>3);if(_e.push((tt?et|128:et)&255),!!tt){for(let nt=3;nt<31;nt=nt+7){const rt=$>>>nt,it=!!(rt>>>7),st=(it?rt|128:rt)&255;if(_e.push(st),!it)return}_e.push($>>>31&1)}}const TWO_PWR_32_DBL=4294967296;function int64FromString(j){const $=j[0]==="-";$&&(j=j.slice(1));const _e=1e6;let et=0,tt=0;function nt(rt,it){const st=Number(j.slice(rt,it));tt*=_e,et=et*_e+st,et>=TWO_PWR_32_DBL&&(tt=tt+(et/TWO_PWR_32_DBL|0),et=et%TWO_PWR_32_DBL)}return nt(-24,-18),nt(-18,-12),nt(-12,-6),nt(-6),$?negate(et,tt):newBits(et,tt)}function int64ToString(j,$){let _e=newBits(j,$);const et=_e.hi&2147483648;et&&(_e=negate(_e.lo,_e.hi));const tt=uInt64ToString(_e.lo,_e.hi);return et?"-"+tt:tt}function uInt64ToString(j,$){if({lo:j,hi:$}=toUnsigned(j,$),$<=2097151)return String(TWO_PWR_32_DBL*$+j);const _e=j&16777215,et=(j>>>24|$<<8)&16777215,tt=$>>16&65535;let nt=_e+et*6777216+tt*6710656,rt=et+tt*8147497,it=tt*2;const st=1e7;return nt>=st&&(rt+=Math.floor(nt/st),nt%=st),rt>=st&&(it+=Math.floor(rt/st),rt%=st),it.toString()+decimalFrom1e7WithLeadingZeros(rt)+decimalFrom1e7WithLeadingZeros(nt)}function toUnsigned(j,$){return{lo:j>>>0,hi:$>>>0}}function newBits(j,$){return{lo:j|0,hi:$|0}}function negate(j,$){return $=~$,j?j=~j+1:$+=1,newBits(j,$)}const decimalFrom1e7WithLeadingZeros=j=>{const $=String(j);return"0000000".slice($.length)+$};function varint32write(j,$){if(j>=0){for(;j>127;)$.push(j&127|128),j=j>>>7;$.push(j)}else{for(let _e=0;_e<9;_e++)$.push(j&127|128),j=j>>7;$.push(1)}}function varint32read(){let j=this.buf[this.pos++],$=j&127;if(!(j&128))return this.assertBounds(),$;if(j=this.buf[this.pos++],$|=(j&127)<<7,!(j&128))return this.assertBounds(),$;if(j=this.buf[this.pos++],$|=(j&127)<<14,!(j&128))return this.assertBounds(),$;if(j=this.buf[this.pos++],$|=(j&127)<<21,!(j&128))return this.assertBounds(),$;j=this.buf[this.pos++],$|=(j&15)<<28;for(let _e=5;j&128&&_e<10;_e++)j=this.buf[this.pos++];if(j&128)throw new Error("invalid varint");return this.assertBounds(),$>>>0}function makeInt64Support(){const j=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof j.getBigInt64=="function"&&typeof j.getBigUint64=="function"&&typeof j.setBigInt64=="function"&&typeof j.setBigUint64=="function"&&(typeof process!="object"||typeof define_process_env_default!="object"||define_process_env_default.BUF_BIGINT_DISABLE!=="1")){const tt=BigInt("-9223372036854775808"),nt=BigInt("9223372036854775807"),rt=BigInt("0"),it=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(st){const at=typeof st=="bigint"?st:BigInt(st);if(at>nt||at<tt)throw new Error("int64 invalid: ".concat(st));return at},uParse(st){const at=typeof st=="bigint"?st:BigInt(st);if(at>it||at<rt)throw new Error("uint64 invalid: ".concat(st));return at},enc(st){return j.setBigInt64(0,this.parse(st),!0),{lo:j.getInt32(0,!0),hi:j.getInt32(4,!0)}},uEnc(st){return j.setBigInt64(0,this.uParse(st),!0),{lo:j.getInt32(0,!0),hi:j.getInt32(4,!0)}},dec(st,at){return j.setInt32(0,st,!0),j.setInt32(4,at,!0),j.getBigInt64(0,!0)},uDec(st,at){return j.setInt32(0,st,!0),j.setInt32(4,at,!0),j.getBigUint64(0,!0)}}}const _e=tt=>assert(/^-?[0-9]+$/.test(tt),"int64 invalid: ".concat(tt)),et=tt=>assert(/^[0-9]+$/.test(tt),"uint64 invalid: ".concat(tt));return{zero:"0",supported:!1,parse(tt){return typeof tt!="string"&&(tt=tt.toString()),_e(tt),tt},uParse(tt){return typeof tt!="string"&&(tt=tt.toString()),et(tt),tt},enc(tt){return typeof tt!="string"&&(tt=tt.toString()),_e(tt),int64FromString(tt)},uEnc(tt){return typeof tt!="string"&&(tt=tt.toString()),et(tt),int64FromString(tt)},dec(tt,nt){return int64ToString(tt,nt)},uDec(tt,nt){return uInt64ToString(tt,nt)}}}const protoInt64=makeInt64Support();var ScalarType;(function(j){j[j.DOUBLE=1]="DOUBLE",j[j.FLOAT=2]="FLOAT",j[j.INT64=3]="INT64",j[j.UINT64=4]="UINT64",j[j.INT32=5]="INT32",j[j.FIXED64=6]="FIXED64",j[j.FIXED32=7]="FIXED32",j[j.BOOL=8]="BOOL",j[j.STRING=9]="STRING",j[j.BYTES=12]="BYTES",j[j.UINT32=13]="UINT32",j[j.SFIXED32=15]="SFIXED32",j[j.SFIXED64=16]="SFIXED64",j[j.SINT32=17]="SINT32",j[j.SINT64=18]="SINT64"})(ScalarType||(ScalarType={}));var LongType;(function(j){j[j.BIGINT=0]="BIGINT",j[j.STRING=1]="STRING"})(LongType||(LongType={}));function scalarEquals(j,$,_e){if($===_e)return!0;if(j==ScalarType.BYTES){if(!($ instanceof Uint8Array)||!(_e instanceof Uint8Array)||$.length!==_e.length)return!1;for(let et=0;et<$.length;et++)if($[et]!==_e[et])return!1;return!0}switch(j){case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return $==_e}return!1}function scalarZeroValue(j,$){switch(j){case ScalarType.BOOL:return!1;case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return $==0?protoInt64.zero:"0";case ScalarType.DOUBLE:case ScalarType.FLOAT:return 0;case ScalarType.BYTES:return new Uint8Array(0);case ScalarType.STRING:return"";default:return 0}}function isScalarZeroValue(j,$){switch(j){case ScalarType.BOOL:return $===!1;case ScalarType.STRING:return $==="";case ScalarType.BYTES:return $ instanceof Uint8Array&&!$.byteLength;default:return $==0}}var WireType;(function(j){j[j.Varint=0]="Varint",j[j.Bit64=1]="Bit64",j[j.LengthDelimited=2]="LengthDelimited",j[j.StartGroup=3]="StartGroup",j[j.EndGroup=4]="EndGroup",j[j.Bit32=5]="Bit32"})(WireType||(WireType={}));class BinaryWriter{constructor($){this.stack=[],this.textEncoder=$??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let $=0;for(let tt=0;tt<this.chunks.length;tt++)$+=this.chunks[tt].length;let _e=new Uint8Array($),et=0;for(let tt=0;tt<this.chunks.length;tt++)_e.set(this.chunks[tt],et),et+=this.chunks[tt].length;return this.chunks=[],_e}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let $=this.finish(),_e=this.stack.pop();if(!_e)throw new Error("invalid state, fork stack empty");return this.chunks=_e.chunks,this.buf=_e.buf,this.uint32($.byteLength),this.raw($)}tag($,_e){return this.uint32(($<<3|_e)>>>0)}raw($){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push($),this}uint32($){for(assertUInt32($);$>127;)this.buf.push($&127|128),$=$>>>7;return this.buf.push($),this}int32($){return assertInt32($),varint32write($,this.buf),this}bool($){return this.buf.push($?1:0),this}bytes($){return this.uint32($.byteLength),this.raw($)}string($){let _e=this.textEncoder.encode($);return this.uint32(_e.byteLength),this.raw(_e)}float($){assertFloat32($);let _e=new Uint8Array(4);return new DataView(_e.buffer).setFloat32(0,$,!0),this.raw(_e)}double($){let _e=new Uint8Array(8);return new DataView(_e.buffer).setFloat64(0,$,!0),this.raw(_e)}fixed32($){assertUInt32($);let _e=new Uint8Array(4);return new DataView(_e.buffer).setUint32(0,$,!0),this.raw(_e)}sfixed32($){assertInt32($);let _e=new Uint8Array(4);return new DataView(_e.buffer).setInt32(0,$,!0),this.raw(_e)}sint32($){return assertInt32($),$=($<<1^$>>31)>>>0,varint32write($,this.buf),this}sfixed64($){let _e=new Uint8Array(8),et=new DataView(_e.buffer),tt=protoInt64.enc($);return et.setInt32(0,tt.lo,!0),et.setInt32(4,tt.hi,!0),this.raw(_e)}fixed64($){let _e=new Uint8Array(8),et=new DataView(_e.buffer),tt=protoInt64.uEnc($);return et.setInt32(0,tt.lo,!0),et.setInt32(4,tt.hi,!0),this.raw(_e)}int64($){let _e=protoInt64.enc($);return varint64write(_e.lo,_e.hi,this.buf),this}sint64($){let _e=protoInt64.enc($),et=_e.hi>>31,tt=_e.lo<<1^et,nt=(_e.hi<<1|_e.lo>>>31)^et;return varint64write(tt,nt,this.buf),this}uint64($){let _e=protoInt64.uEnc($);return varint64write(_e.lo,_e.hi,this.buf),this}}class BinaryReader{constructor($,_e){this.varint64=varint64read,this.uint32=varint32read,this.buf=$,this.len=$.length,this.pos=0,this.view=new DataView($.buffer,$.byteOffset,$.byteLength),this.textDecoder=_e??new TextDecoder}tag(){let $=this.uint32(),_e=$>>>3,et=$&7;if(_e<=0||et<0||et>5)throw new Error("illegal tag: field no "+_e+" wire type "+et);return[_e,et]}skip($,_e){let et=this.pos;switch($){case WireType.Varint:for(;this.buf[this.pos++]&128;);break;case WireType.Bit64:this.pos+=4;case WireType.Bit32:this.pos+=4;break;case WireType.LengthDelimited:let tt=this.uint32();this.pos+=tt;break;case WireType.StartGroup:for(;;){const[nt,rt]=this.tag();if(rt===WireType.EndGroup){if(_e!==void 0&&nt!==_e)throw new Error("invalid end group tag");break}this.skip(rt,nt)}break;default:throw new Error("cant skip wire type "+$)}return this.assertBounds(),this.buf.subarray(et,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let $=this.uint32();return $>>>1^-($&1)}int64(){return protoInt64.dec(...this.varint64())}uint64(){return protoInt64.uDec(...this.varint64())}sint64(){let[$,_e]=this.varint64(),et=-($&1);return $=($>>>1|(_e&1)<<31)^et,_e=_e>>>1^et,protoInt64.dec($,_e)}bool(){let[$,_e]=this.varint64();return $!==0||_e!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return protoInt64.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return protoInt64.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let $=this.uint32(),_e=this.pos;return this.pos+=$,this.assertBounds(),this.buf.subarray(_e,_e+$)}string(){return this.textDecoder.decode(this.bytes())}}function makeExtension(j,$,_e,et){let tt;return{typeName:$,extendee:_e,get field(){if(!tt){const nt=typeof et=="function"?et():et;nt.name=$.split(".").pop(),nt.jsonName="[".concat($,"]"),tt=j.util.newFieldList([nt]).list()[0]}return tt},runtime:j}}function createExtensionContainer(j){const $=j.field.localName,_e=Object.create(null);return _e[$]=initExtensionField(j),[_e,()=>_e[$]]}function initExtensionField(j){const $=j.field;if($.repeated)return[];if($.default!==void 0)return $.default;switch($.kind){case"enum":return $.T.values[0].no;case"scalar":return scalarZeroValue($.T,$.L);case"message":const _e=$.T,et=new _e;return _e.fieldWrapper?_e.fieldWrapper.unwrapField(et):et;case"map":throw"map fields are not allowed to be extensions"}}function filterUnknownFields(j,$){if(!$.repeated&&($.kind=="enum"||$.kind=="scalar")){for(let _e=j.length-1;_e>=0;--_e)if(j[_e].no==$.no)return[j[_e]];return[]}return j.filter(_e=>_e.no===$.no)}let encTable="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),decTable=[];for(let j=0;j<encTable.length;j++)decTable[encTable[j].charCodeAt(0)]=j;decTable[45]=encTable.indexOf("+");decTable[95]=encTable.indexOf("/");const protoBase64={dec(j){let $=j.length*3/4;j[j.length-2]=="="?$-=2:j[j.length-1]=="="&&($-=1);let _e=new Uint8Array($),et=0,tt=0,nt,rt=0;for(let it=0;it<j.length;it++){if(nt=decTable[j.charCodeAt(it)],nt===void 0)switch(j[it]){case"=":tt=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(tt){case 0:rt=nt,tt=1;break;case 1:_e[et++]=rt<<2|(nt&48)>>4,rt=nt,tt=2;break;case 2:_e[et++]=(rt&15)<<4|(nt&60)>>2,rt=nt,tt=3;break;case 3:_e[et++]=(rt&3)<<6|nt,tt=0;break}}if(tt==1)throw Error("invalid base64 string.");return _e.subarray(0,et)},enc(j){let $="",_e=0,et,tt=0;for(let nt=0;nt<j.length;nt++)switch(et=j[nt],_e){case 0:$+=encTable[et>>2],tt=(et&3)<<4,_e=1;break;case 1:$+=encTable[tt|et>>4],tt=(et&15)<<2,_e=2;break;case 2:$+=encTable[tt|et>>6],$+=encTable[et&63],_e=0;break}return _e&&($+=encTable[tt],$+="=",_e==1&&($+="=")),$}};function getExtension(j,$,_e){assertExtendee($,j);const et=$.runtime.bin.makeReadOptions(_e),tt=filterUnknownFields(j.getType().runtime.bin.listUnknownFields(j),$.field),[nt,rt]=createExtensionContainer($);for(const it of tt)$.runtime.bin.readField(nt,et.readerFactory(it.data),$.field,it.wireType,et);return rt()}function setExtension(j,$,_e,et){assertExtendee($,j);const tt=$.runtime.bin.makeReadOptions(et),nt=$.runtime.bin.makeWriteOptions(et);if(hasExtension(j,$)){const at=j.getType().runtime.bin.listUnknownFields(j).filter(ot=>ot.no!=$.field.no);j.getType().runtime.bin.discardUnknownFields(j);for(const ot of at)j.getType().runtime.bin.onUnknownField(j,ot.no,ot.wireType,ot.data)}const rt=nt.writerFactory();let it=$.field;!it.opt&&!it.repeated&&(it.kind=="enum"||it.kind=="scalar")&&(it=Object.assign(Object.assign({},$.field),{opt:!0})),$.runtime.bin.writeField(it,_e,rt,nt);const st=tt.readerFactory(rt.finish());for(;st.pos<st.len;){const[at,ot]=st.tag(),ct=st.skip(ot,at);j.getType().runtime.bin.onUnknownField(j,at,ot,ct)}}function hasExtension(j,$){const _e=j.getType();return $.extendee.typeName===_e.typeName&&!!_e.runtime.bin.listUnknownFields(j).find(et=>et.no==$.field.no)}function assertExtendee(j,$){assert(j.extendee.typeName==$.getType().typeName,"extension ".concat(j.typeName," can only be applied to message ").concat(j.extendee.typeName))}function isFieldSet(j,$){const _e=j.localName;if(j.repeated)return $[_e].length>0;if(j.oneof)return $[j.oneof.localName].case===_e;switch(j.kind){case"enum":case"scalar":return j.opt||j.req?$[_e]!==void 0:j.kind=="enum"?$[_e]!==j.T.values[0].no:!isScalarZeroValue(j.T,$[_e]);case"message":return $[_e]!==void 0;case"map":return Object.keys($[_e]).length>0}}function clearField(j,$){const _e=j.localName,et=!j.opt&&!j.req;if(j.repeated)$[_e]=[];else if(j.oneof)$[j.oneof.localName]={case:void 0};else switch(j.kind){case"map":$[_e]={};break;case"enum":$[_e]=et?j.T.values[0].no:void 0;break;case"scalar":$[_e]=et?scalarZeroValue(j.T,j.L):void 0;break;case"message":$[_e]=void 0;break}}function isMessage(j,$){if(j===null||typeof j!="object"||!Object.getOwnPropertyNames(Message$1.prototype).every(et=>et in j&&typeof j[et]=="function"))return!1;const _e=j.getType();return _e===null||typeof _e!="function"||!("typeName"in _e)||typeof _e.typeName!="string"?!1:$===void 0?!0:_e.typeName==$.typeName}function wrapField(j,$){return isMessage($)||!j.fieldWrapper?$:j.fieldWrapper.wrapField($)}ScalarType.DOUBLE,ScalarType.FLOAT,ScalarType.INT64,ScalarType.UINT64,ScalarType.INT32,ScalarType.UINT32,ScalarType.BOOL,ScalarType.STRING,ScalarType.BYTES;const jsonReadDefaults={ignoreUnknownFields:!1},jsonWriteDefaults={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function makeReadOptions$1(j){return j?Object.assign(Object.assign({},jsonReadDefaults),j):jsonReadDefaults}function makeWriteOptions$1(j){return j?Object.assign(Object.assign({},jsonWriteDefaults),j):jsonWriteDefaults}const tokenNull=Symbol(),tokenIgnoredUnknownEnum=Symbol();function makeJsonFormat(){return{makeReadOptions:makeReadOptions$1,makeWriteOptions:makeWriteOptions$1,readMessage(j,$,_e,et){if($==null||Array.isArray($)||typeof $!="object")throw new Error("cannot decode message ".concat(j.typeName," from JSON: ").concat(debugJsonValue($)));et=et??new j;const tt=new Map,nt=_e.typeRegistry;for(const[rt,it]of Object.entries($)){const st=j.fields.findJsonName(rt);if(st){if(st.oneof){if(it===null&&st.kind=="scalar")continue;const at=tt.get(st.oneof);if(at!==void 0)throw new Error("cannot decode message ".concat(j.typeName,' from JSON: multiple keys for oneof "').concat(st.oneof.name,'" present: "').concat(at,'", "').concat(rt,'"'));tt.set(st.oneof,rt)}readField$1(et,it,st,_e,j)}else{let at=!1;if(nt!=null&&nt.findExtension&&rt.startsWith("[")&&rt.endsWith("]")){const ot=nt.findExtension(rt.substring(1,rt.length-1));if(ot&&ot.extendee.typeName==j.typeName){at=!0;const[ct,lt]=createExtensionContainer(ot);readField$1(ct,it,ot.field,_e,ot),setExtension(et,ot,lt(),_e)}}if(!at&&!_e.ignoreUnknownFields)throw new Error("cannot decode message ".concat(j.typeName,' from JSON: key "').concat(rt,'" is unknown'))}}return et},writeMessage(j,$){const _e=j.getType(),et={};let tt;try{for(tt of _e.fields.byNumber()){if(!isFieldSet(tt,j)){if(tt.req)throw"required field not set";if(!$.emitDefaultValues||!canEmitFieldDefaultValue(tt))continue}const rt=tt.oneof?j[tt.oneof.localName].value:j[tt.localName],it=writeField$1(tt,rt,$);it!==void 0&&(et[$.useProtoFieldName?tt.name:tt.jsonName]=it)}const nt=$.typeRegistry;if(nt!=null&&nt.findExtensionFor)for(const rt of _e.runtime.bin.listUnknownFields(j)){const it=nt.findExtensionFor(_e.typeName,rt.no);if(it&&hasExtension(j,it)){const st=getExtension(j,it,$),at=writeField$1(it.field,st,$);at!==void 0&&(et[it.field.jsonName]=at)}}}catch(nt){const rt=tt?"cannot encode field ".concat(_e.typeName,".").concat(tt.name," to JSON"):"cannot encode message ".concat(_e.typeName," to JSON"),it=nt instanceof Error?nt.message:String(nt);throw new Error(rt+(it.length>0?": ".concat(it):""))}return et},readScalar(j,$,_e){return readScalar$1(j,$,_e??LongType.BIGINT,!0)},writeScalar(j,$,_e){if($!==void 0&&(_e||isScalarZeroValue(j,$)))return writeScalar$1(j,$)},debug:debugJsonValue}}function debugJsonValue(j){if(j===null)return"null";switch(typeof j){case"object":return Array.isArray(j)?"array":"object";case"string":return j.length>100?"string":'"'.concat(j.split('"').join('\\"'),'"');default:return String(j)}}function readField$1(j,$,_e,et,tt){let nt=_e.localName;if(_e.repeated){if(assert(_e.kind!="map"),$===null)return;if(!Array.isArray($))throw new Error("cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue($)));const rt=j[nt];for(const it of $){if(it===null)throw new Error("cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue(it)));switch(_e.kind){case"message":rt.push(_e.T.fromJson(it,et));break;case"enum":const st=readEnum(_e.T,it,et.ignoreUnknownFields,!0);st!==tokenIgnoredUnknownEnum&&rt.push(st);break;case"scalar":try{rt.push(readScalar$1(_e.T,it,_e.L,!0))}catch(at){let ot="cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue(it));throw at instanceof Error&&at.message.length>0&&(ot+=": ".concat(at.message)),new Error(ot)}break}}}else if(_e.kind=="map"){if($===null)return;if(typeof $!="object"||Array.isArray($))throw new Error("cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue($)));const rt=j[nt];for(const[it,st]of Object.entries($)){if(st===null)throw new Error("cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: map value null"));let at;try{at=readMapKey(_e.K,it)}catch(ot){let ct="cannot decode map key for field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue($));throw ot instanceof Error&&ot.message.length>0&&(ct+=": ".concat(ot.message)),new Error(ct)}switch(_e.V.kind){case"message":rt[at]=_e.V.T.fromJson(st,et);break;case"enum":const ot=readEnum(_e.V.T,st,et.ignoreUnknownFields,!0);ot!==tokenIgnoredUnknownEnum&&(rt[at]=ot);break;case"scalar":try{rt[at]=readScalar$1(_e.V.T,st,LongType.BIGINT,!0)}catch(ct){let lt="cannot decode map value for field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue($));throw ct instanceof Error&&ct.message.length>0&&(lt+=": ".concat(ct.message)),new Error(lt)}break}}}else switch(_e.oneof&&(j=j[_e.oneof.localName]={case:nt},nt="value"),_e.kind){case"message":const rt=_e.T;if($===null&&rt.typeName!="google.protobuf.Value")return;let it=j[nt];isMessage(it)?it.fromJson($,et):(j[nt]=it=rt.fromJson($,et),rt.fieldWrapper&&!_e.oneof&&(j[nt]=rt.fieldWrapper.unwrapField(it)));break;case"enum":const st=readEnum(_e.T,$,et.ignoreUnknownFields,!1);switch(st){case tokenNull:clearField(_e,j);break;case tokenIgnoredUnknownEnum:break;default:j[nt]=st;break}break;case"scalar":try{const at=readScalar$1(_e.T,$,_e.L,!1);switch(at){case tokenNull:clearField(_e,j);break;default:j[nt]=at;break}}catch(at){let ot="cannot decode field ".concat(tt.typeName,".").concat(_e.name," from JSON: ").concat(debugJsonValue($));throw at instanceof Error&&at.message.length>0&&(ot+=": ".concat(at.message)),new Error(ot)}break}}function readMapKey(j,$){if(j===ScalarType.BOOL)switch($){case"true":$=!0;break;case"false":$=!1;break}return readScalar$1(j,$,LongType.BIGINT,!0).toString()}function readScalar$1(j,$,_e,et){if($===null)return et?scalarZeroValue(j,_e):tokenNull;switch(j){case ScalarType.DOUBLE:case ScalarType.FLOAT:if($==="NaN")return Number.NaN;if($==="Infinity")return Number.POSITIVE_INFINITY;if($==="-Infinity")return Number.NEGATIVE_INFINITY;if($===""||typeof $=="string"&&$.trim().length!==$.length||typeof $!="string"&&typeof $!="number")break;const tt=Number($);if(Number.isNaN(tt)||!Number.isFinite(tt))break;return j==ScalarType.FLOAT&&assertFloat32(tt),tt;case ScalarType.INT32:case ScalarType.FIXED32:case ScalarType.SFIXED32:case ScalarType.SINT32:case ScalarType.UINT32:let nt;if(typeof $=="number"?nt=$:typeof $=="string"&&$.length>0&&$.trim().length===$.length&&(nt=Number($)),nt===void 0)break;return j==ScalarType.UINT32||j==ScalarType.FIXED32?assertUInt32(nt):assertInt32(nt),nt;case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:if(typeof $!="number"&&typeof $!="string")break;const rt=protoInt64.parse($);return _e?rt.toString():rt;case ScalarType.FIXED64:case ScalarType.UINT64:if(typeof $!="number"&&typeof $!="string")break;const it=protoInt64.uParse($);return _e?it.toString():it;case ScalarType.BOOL:if(typeof $!="boolean")break;return $;case ScalarType.STRING:if(typeof $!="string")break;try{encodeURIComponent($)}catch{throw new Error("invalid UTF8")}return $;case ScalarType.BYTES:if($==="")return new Uint8Array(0);if(typeof $!="string")break;return protoBase64.dec($)}throw new Error}function readEnum(j,$,_e,et){if($===null)return j.typeName=="google.protobuf.NullValue"?0:et?j.values[0].no:tokenNull;switch(typeof $){case"number":if(Number.isInteger($))return $;break;case"string":const tt=j.findName($);if(tt!==void 0)return tt.no;if(_e)return tokenIgnoredUnknownEnum;break}throw new Error("cannot decode enum ".concat(j.typeName," from JSON: ").concat(debugJsonValue($)))}function canEmitFieldDefaultValue(j){return j.repeated||j.kind=="map"?!0:!(j.oneof||j.kind=="message"||j.opt||j.req)}function writeField$1(j,$,_e){if(j.kind=="map"){assert(typeof $=="object"&&$!=null);const et={},tt=Object.entries($);switch(j.V.kind){case"scalar":for(const[rt,it]of tt)et[rt.toString()]=writeScalar$1(j.V.T,it);break;case"message":for(const[rt,it]of tt)et[rt.toString()]=it.toJson(_e);break;case"enum":const nt=j.V.T;for(const[rt,it]of tt)et[rt.toString()]=writeEnum(nt,it,_e.enumAsInteger);break}return _e.emitDefaultValues||tt.length>0?et:void 0}if(j.repeated){assert(Array.isArray($));const et=[];switch(j.kind){case"scalar":for(let tt=0;tt<$.length;tt++)et.push(writeScalar$1(j.T,$[tt]));break;case"enum":for(let tt=0;tt<$.length;tt++)et.push(writeEnum(j.T,$[tt],_e.enumAsInteger));break;case"message":for(let tt=0;tt<$.length;tt++)et.push($[tt].toJson(_e));break}return _e.emitDefaultValues||et.length>0?et:void 0}switch(j.kind){case"scalar":return writeScalar$1(j.T,$);case"enum":return writeEnum(j.T,$,_e.enumAsInteger);case"message":return wrapField(j.T,$).toJson(_e)}}function writeEnum(j,$,_e){var et;if(assert(typeof $=="number"),j.typeName=="google.protobuf.NullValue")return null;if(_e)return $;const tt=j.findNumber($);return(et=tt==null?void 0:tt.name)!==null&&et!==void 0?et:$}function writeScalar$1(j,$){switch(j){case ScalarType.INT32:case ScalarType.SFIXED32:case ScalarType.SINT32:case ScalarType.FIXED32:case ScalarType.UINT32:return assert(typeof $=="number"),$;case ScalarType.FLOAT:case ScalarType.DOUBLE:return assert(typeof $=="number"),Number.isNaN($)?"NaN":$===Number.POSITIVE_INFINITY?"Infinity":$===Number.NEGATIVE_INFINITY?"-Infinity":$;case ScalarType.STRING:return assert(typeof $=="string"),$;case ScalarType.BOOL:return assert(typeof $=="boolean"),$;case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return assert(typeof $=="bigint"||typeof $=="string"||typeof $=="number"),$.toString();case ScalarType.BYTES:return assert($ instanceof Uint8Array),protoBase64.enc($)}}const unknownFieldsSymbol=Symbol("@bufbuild/protobuf/unknown-fields"),readDefaults={readUnknownFields:!0,readerFactory:j=>new BinaryReader(j)},writeDefaults={writeUnknownFields:!0,writerFactory:()=>new BinaryWriter};function makeReadOptions(j){return j?Object.assign(Object.assign({},readDefaults),j):readDefaults}function makeWriteOptions(j){return j?Object.assign(Object.assign({},writeDefaults),j):writeDefaults}function makeBinaryFormat(){return{makeReadOptions,makeWriteOptions,listUnknownFields(j){var $;return($=j[unknownFieldsSymbol])!==null&&$!==void 0?$:[]},discardUnknownFields(j){delete j[unknownFieldsSymbol]},writeUnknownFields(j,$){const et=j[unknownFieldsSymbol];if(et)for(const tt of et)$.tag(tt.no,tt.wireType).raw(tt.data)},onUnknownField(j,$,_e,et){const tt=j;Array.isArray(tt[unknownFieldsSymbol])||(tt[unknownFieldsSymbol]=[]),tt[unknownFieldsSymbol].push({no:$,wireType:_e,data:et})},readMessage(j,$,_e,et,tt){const nt=j.getType(),rt=tt?$.len:$.pos+_e;let it,st;for(;$.pos<rt&&([it,st]=$.tag(),!(tt===!0&&st==WireType.EndGroup));){const at=nt.fields.find(it);if(!at){const ot=$.skip(st,it);et.readUnknownFields&&this.onUnknownField(j,it,st,ot);continue}readField(j,$,at,st,et)}if(tt&&(st!=WireType.EndGroup||it!==_e))throw new Error("invalid end group tag")},readField,writeMessage(j,$,_e){const et=j.getType();for(const tt of et.fields.byNumber()){if(!isFieldSet(tt,j)){if(tt.req)throw new Error("cannot encode field ".concat(et.typeName,".").concat(tt.name," to binary: required field not set"));continue}const nt=tt.oneof?j[tt.oneof.localName].value:j[tt.localName];writeField(tt,nt,$,_e)}return _e.writeUnknownFields&&this.writeUnknownFields(j,$),$},writeField(j,$,_e,et){$!==void 0&&writeField(j,$,_e,et)}}}function readField(j,$,_e,et,tt){let{repeated:nt,localName:rt}=_e;switch(_e.oneof&&(j=j[_e.oneof.localName],j.case!=rt&&delete j.value,j.case=rt,rt="value"),_e.kind){case"scalar":case"enum":const it=_e.kind=="enum"?ScalarType.INT32:_e.T;let st=readScalar;if(_e.kind=="scalar"&&_e.L>0&&(st=readScalarLTString),nt){let lt=j[rt];if(et==WireType.LengthDelimited&&it!=ScalarType.STRING&&it!=ScalarType.BYTES){let pt=$.uint32()+$.pos;for(;$.pos<pt;)lt.push(st($,it))}else lt.push(st($,it))}else j[rt]=st($,it);break;case"message":const at=_e.T;nt?j[rt].push(readMessageField($,new at,tt,_e)):isMessage(j[rt])?readMessageField($,j[rt],tt,_e):(j[rt]=readMessageField($,new at,tt,_e),at.fieldWrapper&&!_e.oneof&&!_e.repeated&&(j[rt]=at.fieldWrapper.unwrapField(j[rt])));break;case"map":let[ot,ct]=readMapEntry(_e,$,tt);j[rt][ot]=ct;break}}function readMessageField(j,$,_e,et){const tt=$.getType().runtime.bin,nt=et==null?void 0:et.delimited;return tt.readMessage($,j,nt?et.no:j.uint32(),_e,nt),$}function readMapEntry(j,$,_e){const et=$.uint32(),tt=$.pos+et;let nt,rt;for(;$.pos<tt;){const[it]=$.tag();switch(it){case 1:nt=readScalar($,j.K);break;case 2:switch(j.V.kind){case"scalar":rt=readScalar($,j.V.T);break;case"enum":rt=$.int32();break;case"message":rt=readMessageField($,new j.V.T,_e,void 0);break}break}}if(nt===void 0&&(nt=scalarZeroValue(j.K,LongType.BIGINT)),typeof nt!="string"&&typeof nt!="number"&&(nt=nt.toString()),rt===void 0)switch(j.V.kind){case"scalar":rt=scalarZeroValue(j.V.T,LongType.BIGINT);break;case"enum":rt=j.V.T.values[0].no;break;case"message":rt=new j.V.T;break}return[nt,rt]}function readScalarLTString(j,$){const _e=readScalar(j,$);return typeof _e=="bigint"?_e.toString():_e}function readScalar(j,$){switch($){case ScalarType.STRING:return j.string();case ScalarType.BOOL:return j.bool();case ScalarType.DOUBLE:return j.double();case ScalarType.FLOAT:return j.float();case ScalarType.INT32:return j.int32();case ScalarType.INT64:return j.int64();case ScalarType.UINT64:return j.uint64();case ScalarType.FIXED64:return j.fixed64();case ScalarType.BYTES:return j.bytes();case ScalarType.FIXED32:return j.fixed32();case ScalarType.SFIXED32:return j.sfixed32();case ScalarType.SFIXED64:return j.sfixed64();case ScalarType.SINT64:return j.sint64();case ScalarType.UINT32:return j.uint32();case ScalarType.SINT32:return j.sint32()}}function writeField(j,$,_e,et){assert($!==void 0);const tt=j.repeated;switch(j.kind){case"scalar":case"enum":let nt=j.kind=="enum"?ScalarType.INT32:j.T;if(tt)if(assert(Array.isArray($)),j.packed)writePacked(_e,nt,j.no,$);else for(const rt of $)writeScalar(_e,nt,j.no,rt);else writeScalar(_e,nt,j.no,$);break;case"message":if(tt){assert(Array.isArray($));for(const rt of $)writeMessageField(_e,et,j,rt)}else writeMessageField(_e,et,j,$);break;case"map":assert(typeof $=="object"&&$!=null);for(const[rt,it]of Object.entries($))writeMapEntry(_e,et,j,rt,it);break}}function writeMapEntry(j,$,_e,et,tt){j.tag(_e.no,WireType.LengthDelimited),j.fork();let nt=et;switch(_e.K){case ScalarType.INT32:case ScalarType.FIXED32:case ScalarType.UINT32:case ScalarType.SFIXED32:case ScalarType.SINT32:nt=Number.parseInt(et);break;case ScalarType.BOOL:assert(et=="true"||et=="false"),nt=et=="true";break}switch(writeScalar(j,_e.K,1,nt),_e.V.kind){case"scalar":writeScalar(j,_e.V.T,2,tt);break;case"enum":writeScalar(j,ScalarType.INT32,2,tt);break;case"message":assert(tt!==void 0),j.tag(2,WireType.LengthDelimited).bytes(tt.toBinary($));break}j.join()}function writeMessageField(j,$,_e,et){const tt=wrapField(_e.T,et);_e.delimited?j.tag(_e.no,WireType.StartGroup).raw(tt.toBinary($)).tag(_e.no,WireType.EndGroup):j.tag(_e.no,WireType.LengthDelimited).bytes(tt.toBinary($))}function writeScalar(j,$,_e,et){assert(et!==void 0);let[tt,nt]=scalarTypeInfo($);j.tag(_e,tt)[nt](et)}function writePacked(j,$,_e,et){if(!et.length)return;j.tag(_e,WireType.LengthDelimited).fork();let[,tt]=scalarTypeInfo($);for(let nt=0;nt<et.length;nt++)j[tt](et[nt]);j.join()}function scalarTypeInfo(j){let $=WireType.Varint;switch(j){case ScalarType.BYTES:case ScalarType.STRING:$=WireType.LengthDelimited;break;case ScalarType.DOUBLE:case ScalarType.FIXED64:case ScalarType.SFIXED64:$=WireType.Bit64;break;case ScalarType.FIXED32:case ScalarType.SFIXED32:case ScalarType.FLOAT:$=WireType.Bit32;break}const _e=ScalarType[j].toLowerCase();return[$,_e]}function makeUtilCommon(){return{setEnumType,initPartial(j,$){if(j===void 0)return;const _e=$.getType();for(const et of _e.fields.byMember()){const tt=et.localName,nt=$,rt=j;if(rt[tt]!=null)switch(et.kind){case"oneof":const it=rt[tt].case;if(it===void 0)continue;const st=et.findField(it);let at=rt[tt].value;st&&st.kind=="message"&&!isMessage(at,st.T)?at=new st.T(at):st&&st.kind==="scalar"&&st.T===ScalarType.BYTES&&(at=toU8Arr(at)),nt[tt]={case:it,value:at};break;case"scalar":case"enum":let ot=rt[tt];et.T===ScalarType.BYTES&&(ot=et.repeated?ot.map(toU8Arr):toU8Arr(ot)),nt[tt]=ot;break;case"map":switch(et.V.kind){case"scalar":case"enum":if(et.V.T===ScalarType.BYTES)for(const[ut,pt]of Object.entries(rt[tt]))nt[tt][ut]=toU8Arr(pt);else Object.assign(nt[tt],rt[tt]);break;case"message":const lt=et.V.T;for(const ut of Object.keys(rt[tt])){let pt=rt[tt][ut];lt.fieldWrapper||(pt=new lt(pt)),nt[tt][ut]=pt}break}break;case"message":const ct=et.T;if(et.repeated)nt[tt]=rt[tt].map(lt=>isMessage(lt,ct)?lt:new ct(lt));else{const lt=rt[tt];ct.fieldWrapper?ct.typeName==="google.protobuf.BytesValue"?nt[tt]=toU8Arr(lt):nt[tt]=lt:nt[tt]=isMessage(lt,ct)?lt:new ct(lt)}break}}},equals(j,$,_e){return $===_e?!0:!$||!_e?!1:j.fields.byMember().every(et=>{const tt=$[et.localName],nt=_e[et.localName];if(et.repeated){if(tt.length!==nt.length)return!1;switch(et.kind){case"message":return tt.every((rt,it)=>et.T.equals(rt,nt[it]));case"scalar":return tt.every((rt,it)=>scalarEquals(et.T,rt,nt[it]));case"enum":return tt.every((rt,it)=>scalarEquals(ScalarType.INT32,rt,nt[it]))}throw new Error("repeated cannot contain ".concat(et.kind))}switch(et.kind){case"message":return et.T.equals(tt,nt);case"enum":return scalarEquals(ScalarType.INT32,tt,nt);case"scalar":return scalarEquals(et.T,tt,nt);case"oneof":if(tt.case!==nt.case)return!1;const rt=et.findField(tt.case);if(rt===void 0)return!0;switch(rt.kind){case"message":return rt.T.equals(tt.value,nt.value);case"enum":return scalarEquals(ScalarType.INT32,tt.value,nt.value);case"scalar":return scalarEquals(rt.T,tt.value,nt.value)}throw new Error("oneof cannot contain ".concat(rt.kind));case"map":const it=Object.keys(tt).concat(Object.keys(nt));switch(et.V.kind){case"message":const st=et.V.T;return it.every(ot=>st.equals(tt[ot],nt[ot]));case"enum":return it.every(ot=>scalarEquals(ScalarType.INT32,tt[ot],nt[ot]));case"scalar":const at=et.V.T;return it.every(ot=>scalarEquals(at,tt[ot],nt[ot]))}break}})},clone(j){const $=j.getType(),_e=new $,et=_e;for(const tt of $.fields.byMember()){const nt=j[tt.localName];let rt;if(tt.repeated)rt=nt.map(cloneSingularField);else if(tt.kind=="map"){rt=et[tt.localName];for(const[it,st]of Object.entries(nt))rt[it]=cloneSingularField(st)}else tt.kind=="oneof"?rt=tt.findField(nt.case)?{case:nt.case,value:cloneSingularField(nt.value)}:{case:void 0}:rt=cloneSingularField(nt);et[tt.localName]=rt}for(const tt of $.runtime.bin.listUnknownFields(j))$.runtime.bin.onUnknownField(et,tt.no,tt.wireType,tt.data);return _e}}}function cloneSingularField(j){if(j===void 0)return j;if(isMessage(j))return j.clone();if(j instanceof Uint8Array){const $=new Uint8Array(j.byteLength);return $.set(j),$}return j}function toU8Arr(j){return j instanceof Uint8Array?j:new Uint8Array(j)}function makeProtoRuntime(j,$,_e){return{syntax:j,json:makeJsonFormat(),bin:makeBinaryFormat(),util:Object.assign(Object.assign({},makeUtilCommon()),{newFieldList:$,initFields:_e}),makeMessageType(et,tt,nt){return makeMessageType(this,et,tt,nt)},makeEnum,makeEnumType,getEnumType,makeExtension(et,tt,nt){return makeExtension(this,et,tt,nt)}}}class InternalFieldList{constructor($,_e){this._fields=$,this._normalizer=_e}findJsonName($){if(!this.jsonNames){const _e={};for(const et of this.list())_e[et.jsonName]=_e[et.name]=et;this.jsonNames=_e}return this.jsonNames[$]}find($){if(!this.numbers){const _e={};for(const et of this.list())_e[et.no]=et;this.numbers=_e}return this.numbers[$]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(($,_e)=>$.no-_e.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const $=this.members;let _e;for(const et of this.list())et.oneof?et.oneof!==_e&&(_e=et.oneof,$.push(_e)):$.push(et)}return this.members}}function localFieldName(j,$){const _e=protoCamelCase(j);return $?_e:safeObjectProperty(safeMessageProperty(_e))}function localOneofName(j){return localFieldName(j,!1)}const fieldJsonName=protoCamelCase;function protoCamelCase(j){let $=!1;const _e=[];for(let et=0;et<j.length;et++){let tt=j.charAt(et);switch(tt){case"_":$=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":_e.push(tt),$=!1;break;default:$&&($=!1,tt=tt.toUpperCase()),_e.push(tt);break}}return _e.join("")}const reservedObjectProperties=new Set(["constructor","toString","toJSON","valueOf"]),reservedMessageProperties=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),fallback=j=>"".concat(j,"$"),safeMessageProperty=j=>reservedMessageProperties.has(j)?fallback(j):j,safeObjectProperty=j=>reservedObjectProperties.has(j)?fallback(j):j;class InternalOneofInfo{constructor($){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=$,this.localName=localOneofName($)}addField($){assert($.oneof===this,"field ".concat($.name," not one of ").concat(this.name)),this.fields.push($)}findField($){if(!this._lookup){this._lookup=Object.create(null);for(let _e=0;_e<this.fields.length;_e++)this._lookup[this.fields[_e].localName]=this.fields[_e]}return this._lookup[$]}}function normalizeFieldInfos(j,$){var _e,et,tt,nt,rt,it;const st=[];let at;for(const ot of typeof j=="function"?j():j){const ct=ot;if(ct.localName=localFieldName(ot.name,ot.oneof!==void 0),ct.jsonName=(_e=ot.jsonName)!==null&&_e!==void 0?_e:fieldJsonName(ot.name),ct.repeated=(et=ot.repeated)!==null&&et!==void 0?et:!1,ot.kind=="scalar"&&(ct.L=(tt=ot.L)!==null&&tt!==void 0?tt:LongType.BIGINT),ct.delimited=(nt=ot.delimited)!==null&&nt!==void 0?nt:!1,ct.req=(rt=ot.req)!==null&&rt!==void 0?rt:!1,ct.opt=(it=ot.opt)!==null&&it!==void 0?it:!1,ot.packed===void 0&&(ct.packed=ot.kind=="enum"||ot.kind=="scalar"&&ot.T!=ScalarType.BYTES&&ot.T!=ScalarType.STRING),ot.oneof!==void 0){const lt=typeof ot.oneof=="string"?ot.oneof:ot.oneof.name;(!at||at.name!=lt)&&(at=new InternalOneofInfo(lt)),ct.oneof=at,at.addField(ct)}st.push(ct)}return st}const proto3=makeProtoRuntime("proto3",j=>new InternalFieldList(j,$=>normalizeFieldInfos($)),j=>{for(const $ of j.getType().fields.byMember()){if($.opt)continue;const _e=$.localName,et=j;if($.repeated){et[_e]=[];continue}switch($.kind){case"oneof":et[_e]={case:void 0};break;case"enum":et[_e]=0;break;case"map":et[_e]={};break;case"scalar":et[_e]=scalarZeroValue($.T,$.L);break}}});class Timestamp extends Message$1{constructor($){super(),this.seconds=protoInt64.zero,this.nanos=0,proto3.util.initPartial($,this)}fromJson($,_e){if(typeof $!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(proto3.json.debug($)));const et=$.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!et)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const tt=Date.parse(et[1]+"-"+et[2]+"-"+et[3]+"T"+et[4]+":"+et[5]+":"+et[6]+(et[8]?et[8]:"Z"));if(Number.isNaN(tt))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(tt<Date.parse("0001-01-01T00:00:00Z")||tt>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=protoInt64.parse(tt/1e3),this.nanos=0,et[7]&&(this.nanos=parseInt("1"+et[7]+"0".repeat(9-et[7].length))-1e9),this}toJson($){const _e=Number(this.seconds)*1e3;if(_e<Date.parse("0001-01-01T00:00:00Z")||_e>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let et="Z";if(this.nanos>0){const tt=(this.nanos+1e9).toString().substring(1);tt.substring(3)==="000000"?et="."+tt.substring(0,3)+"Z":tt.substring(6)==="000"?et="."+tt.substring(0,6)+"Z":et="."+tt+"Z"}return new Date(_e).toISOString().replace(".000Z",et)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Timestamp.fromDate(new Date)}static fromDate($){const _e=$.getTime();return new Timestamp({seconds:protoInt64.parse(Math.floor(_e/1e3)),nanos:_e%1e3*1e6})}static fromBinary($,_e){return new Timestamp().fromBinary($,_e)}static fromJson($,_e){return new Timestamp().fromJson($,_e)}static fromJsonString($,_e){return new Timestamp().fromJsonString($,_e)}static equals($,_e){return proto3.util.equals(Timestamp,$,_e)}}Timestamp.runtime=proto3;Timestamp.typeName="google.protobuf.Timestamp";Timestamp.fields=proto3.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const MetricsBatch=proto3.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Timestamp},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:TimeSeriesMetric,repeated:!0},{no:5,name:"events",kind:"message",T:EventMetric,repeated:!0}]),TimeSeriesMetric=proto3.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:MetricSample,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),MetricSample=proto3.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Timestamp},{no:3,name:"value",kind:"scalar",T:2}]),EventMetric=proto3.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Timestamp},{no:7,name:"normalized_end_timestamp",kind:"message",T:Timestamp,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),BackupCodecPolicy$1=proto3.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),TrackType=proto3.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),TrackSource=proto3.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),VideoQuality$1=proto3.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),ConnectionQuality$1=proto3.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),ClientConfigSetting=proto3.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),DisconnectReason=proto3.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),ReconnectReason=proto3.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),SubscriptionError=proto3.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),AudioTrackFeature=proto3.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),Room$1=proto3.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Codec,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:TimedVersion}]),Codec=proto3.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),ParticipantPermission=proto3.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:proto3.getEnumType(TrackSource),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),ParticipantInfo=proto3.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:proto3.getEnumType(ParticipantInfo_State)},{no:4,name:"tracks",kind:"message",T:TrackInfo,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ParticipantPermission},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:proto3.getEnumType(ParticipantInfo_Kind)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:proto3.getEnumType(DisconnectReason)},{no:18,name:"kind_details",kind:"enum",T:proto3.getEnumType(ParticipantInfo_KindDetail),repeated:!0}]),ParticipantInfo_State=proto3.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),ParticipantInfo_Kind=proto3.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),ParticipantInfo_KindDetail=proto3.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Encryption_Type=proto3.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),SimulcastCodecInfo=proto3.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:VideoLayer,repeated:!0}]),TrackInfo=proto3.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:proto3.getEnumType(TrackType)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:proto3.getEnumType(TrackSource)},{no:10,name:"layers",kind:"message",T:VideoLayer,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:SimulcastCodecInfo,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:TimedVersion},{no:19,name:"audio_features",kind:"enum",T:proto3.getEnumType(AudioTrackFeature),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:proto3.getEnumType(BackupCodecPolicy$1)}]),VideoLayer=proto3.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),DataPacket=proto3.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:proto3.getEnumType(DataPacket_Kind)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:UserPacket,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ActiveSpeakerUpdate,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:SipDTMF,oneof:"value"},{no:7,name:"transcription",kind:"message",T:Transcription,oneof:"value"},{no:8,name:"metrics",kind:"message",T:MetricsBatch,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:ChatMessage,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:RpcRequest,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:RpcAck,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:RpcResponse,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:DataStream_Header,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:DataStream_Chunk,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:DataStream_Trailer,oneof:"value"}]),DataPacket_Kind=proto3.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),ActiveSpeakerUpdate=proto3.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:SpeakerInfo,repeated:!0}]),SpeakerInfo=proto3.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),UserPacket=proto3.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),SipDTMF=proto3.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),Transcription=proto3.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:TranscriptionSegment,repeated:!0}]),TranscriptionSegment=proto3.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),ChatMessage=proto3.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),RpcRequest=proto3.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),RpcAck=proto3.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),RpcResponse=proto3.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:RpcError$1,oneof:"value"}]),RpcError$1=proto3.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),ParticipantTracks=proto3.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),ServerInfo=proto3.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:proto3.getEnumType(ServerInfo_Edition)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),ServerInfo_Edition=proto3.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),ClientInfo=proto3.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:proto3.getEnumType(ClientInfo_SDK)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),ClientInfo_SDK=proto3.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),ClientConfiguration=proto3.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:VideoConfiguration},{no:2,name:"screen",kind:"message",T:VideoConfiguration},{no:3,name:"resume_connection",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)},{no:4,name:"disabled_codecs",kind:"message",T:DisabledCodecs},{no:5,name:"force_relay",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)}]),VideoConfiguration=proto3.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)}]),DisabledCodecs=proto3.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Codec,repeated:!0},{no:2,name:"publish",kind:"message",T:Codec,repeated:!0}]),TimedVersion=proto3.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),DataStream_OperationType=proto3.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),DataStream_TextHeader=proto3.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:proto3.getEnumType(DataStream_OperationType)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),DataStream_ByteHeader=proto3.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),DataStream_Header=proto3.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:DataStream_TextHeader,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:DataStream_ByteHeader,oneof:"content_header"}],{localName:"DataStream_Header"}),DataStream_Chunk=proto3.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),DataStream_Trailer=proto3.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),SignalTarget=proto3.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),StreamState=proto3.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),CandidateProtocol=proto3.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),SignalRequest=proto3.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:SessionDescription,oneof:"message"},{no:2,name:"answer",kind:"message",T:SessionDescription,oneof:"message"},{no:3,name:"trickle",kind:"message",T:TrickleRequest,oneof:"message"},{no:4,name:"add_track",kind:"message",T:AddTrackRequest,oneof:"message"},{no:5,name:"mute",kind:"message",T:MuteTrackRequest,oneof:"message"},{no:6,name:"subscription",kind:"message",T:UpdateSubscription,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:UpdateTrackSettings,oneof:"message"},{no:8,name:"leave",kind:"message",T:LeaveRequest,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:UpdateVideoLayers,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:SubscriptionPermission,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:SyncState,oneof:"message"},{no:13,name:"simulate",kind:"message",T:SimulateScenario,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:UpdateParticipantMetadata,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Ping,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:UpdateLocalAudioTrack,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:UpdateLocalVideoTrack,oneof:"message"}]),SignalResponse=proto3.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:JoinResponse,oneof:"message"},{no:2,name:"answer",kind:"message",T:SessionDescription,oneof:"message"},{no:3,name:"offer",kind:"message",T:SessionDescription,oneof:"message"},{no:4,name:"trickle",kind:"message",T:TrickleRequest,oneof:"message"},{no:5,name:"update",kind:"message",T:ParticipantUpdate,oneof:"message"},{no:6,name:"track_published",kind:"message",T:TrackPublishedResponse,oneof:"message"},{no:8,name:"leave",kind:"message",T:LeaveRequest,oneof:"message"},{no:9,name:"mute",kind:"message",T:MuteTrackRequest,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:SpeakersChanged,oneof:"message"},{no:11,name:"room_update",kind:"message",T:RoomUpdate,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:ConnectionQualityUpdate,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:StreamStateUpdate,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:SubscribedQualityUpdate,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:SubscriptionPermissionUpdate,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:TrackUnpublishedResponse,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ReconnectResponse,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Pong,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:SubscriptionResponse,oneof:"message"},{no:22,name:"request_response",kind:"message",T:RequestResponse,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:TrackSubscribed,oneof:"message"}]),SimulcastCodec=proto3.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),AddTrackRequest=proto3.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:proto3.getEnumType(TrackType)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:proto3.getEnumType(TrackSource)},{no:9,name:"layers",kind:"message",T:VideoLayer,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:SimulcastCodec,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:proto3.getEnumType(BackupCodecPolicy$1)}]),TrickleRequest=proto3.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:proto3.getEnumType(SignalTarget)},{no:3,name:"final",kind:"scalar",T:8}]),MuteTrackRequest=proto3.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),JoinResponse=proto3.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Room$1},{no:2,name:"participant",kind:"message",T:ParticipantInfo},{no:3,name:"other_participants",kind:"message",T:ParticipantInfo,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ICEServer,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:ClientConfiguration},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:ServerInfo},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Codec,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),ReconnectResponse=proto3.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:ICEServer,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:ClientConfiguration}]),TrackPublishedResponse=proto3.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:TrackInfo}]),TrackUnpublishedResponse=proto3.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),SessionDescription=proto3.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),ParticipantUpdate=proto3.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:ParticipantInfo,repeated:!0}]),UpdateSubscription=proto3.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ParticipantTracks,repeated:!0}]),UpdateTrackSettings=proto3.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),UpdateLocalAudioTrack=proto3.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:proto3.getEnumType(AudioTrackFeature),repeated:!0}]),UpdateLocalVideoTrack=proto3.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),LeaveRequest=proto3.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:proto3.getEnumType(DisconnectReason)},{no:3,name:"action",kind:"enum",T:proto3.getEnumType(LeaveRequest_Action)},{no:4,name:"regions",kind:"message",T:RegionSettings}]),LeaveRequest_Action=proto3.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),UpdateVideoLayers=proto3.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:VideoLayer,repeated:!0}]),UpdateParticipantMetadata=proto3.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),ICEServer=proto3.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),SpeakersChanged=proto3.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:SpeakerInfo,repeated:!0}]),RoomUpdate=proto3.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Room$1}]),ConnectionQualityInfo=proto3.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:proto3.getEnumType(ConnectionQuality$1)},{no:3,name:"score",kind:"scalar",T:2}]),ConnectionQualityUpdate=proto3.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:ConnectionQualityInfo,repeated:!0}]),StreamStateInfo=proto3.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:proto3.getEnumType(StreamState)}]),StreamStateUpdate=proto3.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:StreamStateInfo,repeated:!0}]),SubscribedQuality=proto3.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:2,name:"enabled",kind:"scalar",T:8}]),SubscribedCodec=proto3.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:SubscribedQuality,repeated:!0}]),SubscribedQualityUpdate=proto3.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:SubscribedQuality,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:SubscribedCodec,repeated:!0}]),TrackPermission=proto3.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),SubscriptionPermission=proto3.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:TrackPermission,repeated:!0}]),SubscriptionPermissionUpdate=proto3.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),SyncState=proto3.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:SessionDescription},{no:2,name:"subscription",kind:"message",T:UpdateSubscription},{no:3,name:"publish_tracks",kind:"message",T:TrackPublishedResponse,repeated:!0},{no:4,name:"data_channels",kind:"message",T:DataChannelInfo,repeated:!0},{no:5,name:"offer",kind:"message",T:SessionDescription},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),DataChannelInfo=proto3.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:proto3.getEnumType(SignalTarget)}]),SimulateScenario=proto3.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:proto3.getEnumType(CandidateProtocol),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Ping=proto3.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Pong=proto3.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),RegionSettings=proto3.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:RegionInfo,repeated:!0}]),RegionInfo=proto3.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),SubscriptionResponse=proto3.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:proto3.getEnumType(SubscriptionError)}]),RequestResponse=proto3.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:proto3.getEnumType(RequestResponse_Reason)},{no:3,name:"message",kind:"scalar",T:9}]),RequestResponse_Reason=proto3.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),TrackSubscribed=proto3.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function getDefaultExportFromCjs(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}var loglevel$1={exports:{}},loglevel=loglevel$1.exports,hasRequiredLoglevel;function requireLoglevel(){return hasRequiredLoglevel||(hasRequiredLoglevel=1,function(j){(function($,_e){j.exports?j.exports=_e():$.log=_e()})(loglevel,function(){var $=function(){},_e="undefined",et=typeof window!==_e&&typeof window.navigator!==_e&&/Trident\/|MSIE /.test(window.navigator.userAgent),tt=["trace","debug","info","warn","error"],nt={},rt=null;function it(dt,ht){var ft=dt[ht];if(typeof ft.bind=="function")return ft.bind(dt);try{return Function.prototype.bind.call(ft,dt)}catch{return function(){return Function.prototype.apply.apply(ft,[dt,arguments])}}}function st(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function at(dt){return dt==="debug"&&(dt="log"),typeof console===_e?!1:dt==="trace"&&et?st:console[dt]!==void 0?it(console,dt):console.log!==void 0?it(console,"log"):$}function ot(){for(var dt=this.getLevel(),ht=0;ht<tt.length;ht++){var ft=tt[ht];this[ft]=ht<dt?$:this.methodFactory(ft,dt,this.name)}if(this.log=this.debug,typeof console===_e&&dt<this.levels.SILENT)return"No console available for logging"}function ct(dt){return function(){typeof console!==_e&&(ot.call(this),this[dt].apply(this,arguments))}}function lt(dt,ht,ft){return at(dt)||ct.apply(this,arguments)}function ut(dt,ht){var ft=this,mt,gt,yt,vt="loglevel";typeof dt=="string"?vt+=":"+dt:typeof dt=="symbol"&&(vt=void 0);function xt(Ct){var Rt=(tt[Ct]||"silent").toUpperCase();if(!(typeof window===_e||!vt)){try{window.localStorage[vt]=Rt;return}catch{}try{window.document.cookie=encodeURIComponent(vt)+"="+Rt+";"}catch{}}}function St(){var Ct;if(!(typeof window===_e||!vt)){try{Ct=window.localStorage[vt]}catch{}if(typeof Ct===_e)try{var Rt=window.document.cookie,jt=encodeURIComponent(vt),Ot=Rt.indexOf(jt+"=");Ot!==-1&&(Ct=/^([^;]+)/.exec(Rt.slice(Ot+jt.length+1))[1])}catch{}return ft.levels[Ct]===void 0&&(Ct=void 0),Ct}}function Et(){if(!(typeof window===_e||!vt)){try{window.localStorage.removeItem(vt)}catch{}try{window.document.cookie=encodeURIComponent(vt)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function wt(Ct){var Rt=Ct;if(typeof Rt=="string"&&ft.levels[Rt.toUpperCase()]!==void 0&&(Rt=ft.levels[Rt.toUpperCase()]),typeof Rt=="number"&&Rt>=0&&Rt<=ft.levels.SILENT)return Rt;throw new TypeError("log.setLevel() called with invalid level: "+Ct)}ft.name=dt,ft.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},ft.methodFactory=ht||lt,ft.getLevel=function(){return yt??gt??mt},ft.setLevel=function(Ct,Rt){return yt=wt(Ct),Rt!==!1&&xt(yt),ot.call(ft)},ft.setDefaultLevel=function(Ct){gt=wt(Ct),St()||ft.setLevel(Ct,!1)},ft.resetLevel=function(){yt=null,Et(),ot.call(ft)},ft.enableAll=function(Ct){ft.setLevel(ft.levels.TRACE,Ct)},ft.disableAll=function(Ct){ft.setLevel(ft.levels.SILENT,Ct)},ft.rebuild=function(){if(rt!==ft&&(mt=wt(rt.getLevel())),ot.call(ft),rt===ft)for(var Ct in nt)nt[Ct].rebuild()},mt=wt(rt?rt.getLevel():"WARN");var Tt=St();Tt!=null&&(yt=wt(Tt)),ot.call(ft)}rt=new ut,rt.getLogger=function(ht){if(typeof ht!="symbol"&&typeof ht!="string"||ht==="")throw new TypeError("You must supply a name when creating a logger.");var ft=nt[ht];return ft||(ft=nt[ht]=new ut(ht,rt.methodFactory)),ft};var pt=typeof window!==_e?window.log:void 0;return rt.noConflict=function(){return typeof window!==_e&&window.log===rt&&(window.log=pt),rt},rt.getLoggers=function(){return nt},rt.default=rt,rt})}(loglevel$1)),loglevel$1.exports}var loglevelExports=requireLoglevel(),LogLevel;(function(j){j[j.trace=0]="trace",j[j.debug=1]="debug",j[j.info=2]="info",j[j.warn=3]="warn",j[j.error=4]="error",j[j.silent=5]="silent"})(LogLevel||(LogLevel={}));var LoggerNames;(function(j){j.Default="livekit",j.Room="livekit-room",j.Participant="livekit-participant",j.Track="livekit-track",j.Publication="livekit-track-publication",j.Engine="livekit-engine",j.Signal="livekit-signal",j.PCManager="livekit-pc-manager",j.PCTransport="livekit-pc-transport",j.E2EE="lk-e2ee"})(LoggerNames||(LoggerNames={}));let livekitLogger=loglevelExports.getLogger("livekit");Object.values(LoggerNames).map(j=>loglevelExports.getLogger(j));livekitLogger.setDefaultLevel(LogLevel.info);function getLogger$1(j){const $=loglevelExports.getLogger(j);return $.setDefaultLevel(livekitLogger.getLevel()),$}const workerLogger=loglevelExports.getLogger("lk-e2ee"),maxRetryDelay=7e3,DEFAULT_RETRY_DELAYS_IN_MS=[0,300,2*2*300,3*3*300,4*4*300,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay];class DefaultReconnectPolicy{constructor($){this._retryDelays=$!==void 0?[...$]:DEFAULT_RETRY_DELAYS_IN_MS}nextRetryDelayInMs($){if($.retryCount>=this._retryDelays.length)return null;const _e=this._retryDelays[$.retryCount];return $.retryCount<=1?_e:_e+Math.random()*1e3}}function __rest$1(j,$){var _e={};for(var et in j)Object.prototype.hasOwnProperty.call(j,et)&&$.indexOf(et)<0&&(_e[et]=j[et]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function")for(var tt=0,et=Object.getOwnPropertySymbols(j);tt<et.length;tt++)$.indexOf(et[tt])<0&&Object.prototype.propertyIsEnumerable.call(j,et[tt])&&(_e[et[tt]]=j[et[tt]]);return _e}function __awaiter$1(j,$,_e,et){function tt(nt){return nt instanceof _e?nt:new _e(function(rt){rt(nt)})}return new(_e||(_e=Promise))(function(nt,rt){function it(ot){try{at(et.next(ot))}catch(ct){rt(ct)}}function st(ot){try{at(et.throw(ot))}catch(ct){rt(ct)}}function at(ot){ot.done?nt(ot.value):tt(ot.value).then(it,st)}at((et=et.apply(j,$||[])).next())})}function __values(j){var $=typeof Symbol=="function"&&Symbol.iterator,_e=$&&j[$],et=0;if(_e)return _e.call(j);if(j&&typeof j.length=="number")return{next:function(){return j&&et>=j.length&&(j=void 0),{value:j&&j[et++],done:!j}}};throw new TypeError($?"Object is not iterable.":"Symbol.iterator is not defined.")}function __asyncValues(j){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=j[Symbol.asyncIterator],_e;return $?$.call(j):(j=typeof __values=="function"?__values(j):j[Symbol.iterator](),_e={},et("next"),et("throw"),et("return"),_e[Symbol.asyncIterator]=function(){return this},_e);function et(nt){_e[nt]=j[nt]&&function(rt){return new Promise(function(it,st){rt=j[nt](rt),tt(it,st,rt.done,rt.value)})}}function tt(nt,rt,it,st){Promise.resolve(st).then(function(at){nt({value:at,done:it})},rt)}}typeof SuppressedError=="function"&&SuppressedError;var events$1={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events$1.exports;hasRequiredEvents=1;var j=typeof Reflect=="object"?Reflect:null,$=j&&typeof j.apply=="function"?j.apply:function(vt,xt,St){return Function.prototype.apply.call(vt,xt,St)},_e;j&&typeof j.ownKeys=="function"?_e=j.ownKeys:Object.getOwnPropertySymbols?_e=function(vt){return Object.getOwnPropertyNames(vt).concat(Object.getOwnPropertySymbols(vt))}:_e=function(vt){return Object.getOwnPropertyNames(vt)};function et(yt){console&&console.warn&&console.warn(yt)}var tt=Number.isNaN||function(vt){return vt!==vt};function nt(){nt.init.call(this)}events$1.exports=nt,events$1.exports.once=ft,nt.EventEmitter=nt,nt.prototype._events=void 0,nt.prototype._eventsCount=0,nt.prototype._maxListeners=void 0;var rt=10;function it(yt){if(typeof yt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof yt)}Object.defineProperty(nt,"defaultMaxListeners",{enumerable:!0,get:function(){return rt},set:function(yt){if(typeof yt!="number"||yt<0||tt(yt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+yt+".");rt=yt}}),nt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},nt.prototype.setMaxListeners=function(vt){if(typeof vt!="number"||vt<0||tt(vt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+vt+".");return this._maxListeners=vt,this};function st(yt){return yt._maxListeners===void 0?nt.defaultMaxListeners:yt._maxListeners}nt.prototype.getMaxListeners=function(){return st(this)},nt.prototype.emit=function(vt){for(var xt=[],St=1;St<arguments.length;St++)xt.push(arguments[St]);var Et=vt==="error",wt=this._events;if(wt!==void 0)Et=Et&&wt.error===void 0;else if(!Et)return!1;if(Et){var Tt;if(xt.length>0&&(Tt=xt[0]),Tt instanceof Error)throw Tt;var Ct=new Error("Unhandled error."+(Tt?" ("+Tt.message+")":""));throw Ct.context=Tt,Ct}var Rt=wt[vt];if(Rt===void 0)return!1;if(typeof Rt=="function")$(Rt,this,xt);else for(var jt=Rt.length,Ot=pt(Rt,jt),St=0;St<jt;++St)$(Ot[St],this,xt);return!0};function at(yt,vt,xt,St){var Et,wt,Tt;if(it(xt),wt=yt._events,wt===void 0?(wt=yt._events=Object.create(null),yt._eventsCount=0):(wt.newListener!==void 0&&(yt.emit("newListener",vt,xt.listener?xt.listener:xt),wt=yt._events),Tt=wt[vt]),Tt===void 0)Tt=wt[vt]=xt,++yt._eventsCount;else if(typeof Tt=="function"?Tt=wt[vt]=St?[xt,Tt]:[Tt,xt]:St?Tt.unshift(xt):Tt.push(xt),Et=st(yt),Et>0&&Tt.length>Et&&!Tt.warned){Tt.warned=!0;var Ct=new Error("Possible EventEmitter memory leak detected. "+Tt.length+" "+String(vt)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ct.name="MaxListenersExceededWarning",Ct.emitter=yt,Ct.type=vt,Ct.count=Tt.length,et(Ct)}return yt}nt.prototype.addListener=function(vt,xt){return at(this,vt,xt,!1)},nt.prototype.on=nt.prototype.addListener,nt.prototype.prependListener=function(vt,xt){return at(this,vt,xt,!0)};function ot(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ct(yt,vt,xt){var St={fired:!1,wrapFn:void 0,target:yt,type:vt,listener:xt},Et=ot.bind(St);return Et.listener=xt,St.wrapFn=Et,Et}nt.prototype.once=function(vt,xt){return it(xt),this.on(vt,ct(this,vt,xt)),this},nt.prototype.prependOnceListener=function(vt,xt){return it(xt),this.prependListener(vt,ct(this,vt,xt)),this},nt.prototype.removeListener=function(vt,xt){var St,Et,wt,Tt,Ct;if(it(xt),Et=this._events,Et===void 0)return this;if(St=Et[vt],St===void 0)return this;if(St===xt||St.listener===xt)--this._eventsCount===0?this._events=Object.create(null):(delete Et[vt],Et.removeListener&&this.emit("removeListener",vt,St.listener||xt));else if(typeof St!="function"){for(wt=-1,Tt=St.length-1;Tt>=0;Tt--)if(St[Tt]===xt||St[Tt].listener===xt){Ct=St[Tt].listener,wt=Tt;break}if(wt<0)return this;wt===0?St.shift():dt(St,wt),St.length===1&&(Et[vt]=St[0]),Et.removeListener!==void 0&&this.emit("removeListener",vt,Ct||xt)}return this},nt.prototype.off=nt.prototype.removeListener,nt.prototype.removeAllListeners=function(vt){var xt,St,Et;if(St=this._events,St===void 0)return this;if(St.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):St[vt]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete St[vt]),this;if(arguments.length===0){var wt=Object.keys(St),Tt;for(Et=0;Et<wt.length;++Et)Tt=wt[Et],Tt!=="removeListener"&&this.removeAllListeners(Tt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(xt=St[vt],typeof xt=="function")this.removeListener(vt,xt);else if(xt!==void 0)for(Et=xt.length-1;Et>=0;Et--)this.removeListener(vt,xt[Et]);return this};function lt(yt,vt,xt){var St=yt._events;if(St===void 0)return[];var Et=St[vt];return Et===void 0?[]:typeof Et=="function"?xt?[Et.listener||Et]:[Et]:xt?ht(Et):pt(Et,Et.length)}nt.prototype.listeners=function(vt){return lt(this,vt,!0)},nt.prototype.rawListeners=function(vt){return lt(this,vt,!1)},nt.listenerCount=function(yt,vt){return typeof yt.listenerCount=="function"?yt.listenerCount(vt):ut.call(yt,vt)},nt.prototype.listenerCount=ut;function ut(yt){var vt=this._events;if(vt!==void 0){var xt=vt[yt];if(typeof xt=="function")return 1;if(xt!==void 0)return xt.length}return 0}nt.prototype.eventNames=function(){return this._eventsCount>0?_e(this._events):[]};function pt(yt,vt){for(var xt=new Array(vt),St=0;St<vt;++St)xt[St]=yt[St];return xt}function dt(yt,vt){for(;vt+1<yt.length;vt++)yt[vt]=yt[vt+1];yt.pop()}function ht(yt){for(var vt=new Array(yt.length),xt=0;xt<vt.length;++xt)vt[xt]=yt[xt].listener||yt[xt];return vt}function ft(yt,vt){return new Promise(function(xt,St){function Et(Tt){yt.removeListener(vt,wt),St(Tt)}function wt(){typeof yt.removeListener=="function"&&yt.removeListener("error",Et),xt([].slice.call(arguments))}gt(yt,vt,wt,{once:!0}),vt!=="error"&&mt(yt,Et,{once:!0})})}function mt(yt,vt,xt){typeof yt.on=="function"&&gt(yt,"error",vt,xt)}function gt(yt,vt,xt,St){if(typeof yt.on=="function")St.once?yt.once(vt,xt):yt.on(vt,xt);else if(typeof yt.addEventListener=="function")yt.addEventListener(vt,function Et(wt){St.once&&yt.removeEventListener(vt,Et),xt(wt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof yt)}return events$1.exports}var eventsExports=requireEvents();let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(j,$,_e){const et=j.match($);return et&&et.length>=_e&&parseInt(et[_e],10)}function wrapPeerConnectionEvent(j,$,_e){if(!j.RTCPeerConnection)return;const et=j.RTCPeerConnection.prototype,tt=et.addEventListener;et.addEventListener=function(rt,it){if(rt!==$)return tt.apply(this,arguments);const st=at=>{const ot=_e(at);ot&&(it.handleEvent?it.handleEvent(ot):it(ot))};return this._eventMap=this._eventMap||{},this._eventMap[$]||(this._eventMap[$]=new Map),this._eventMap[$].set(it,st),tt.apply(this,[rt,st])};const nt=et.removeEventListener;et.removeEventListener=function(rt,it){if(rt!==$||!this._eventMap||!this._eventMap[$])return nt.apply(this,arguments);if(!this._eventMap[$].has(it))return nt.apply(this,arguments);const st=this._eventMap[$].get(it);return this._eventMap[$].delete(it),this._eventMap[$].size===0&&delete this._eventMap[$],Object.keys(this._eventMap).length===0&&delete this._eventMap,nt.apply(this,[rt,st])},Object.defineProperty(et,"on"+$,{get(){return this["_on"+$]},set(rt){this["_on"+$]&&(this.removeEventListener($,this["_on"+$]),delete this["_on"+$]),rt&&this.addEventListener($,this["_on"+$]=rt)},enumerable:!0,configurable:!0})}function disableLog(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(logDisabled_=j,j?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(deprecationWarnings_=!j,"adapter.js deprecation warnings "+(j?"disabled":"enabled"))}function log$1(){if(typeof window=="object"){if(logDisabled_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function deprecated(j,$){deprecationWarnings_&&console.warn(j+" is deprecated, please use "+$+" instead.")}function detectBrowser(j){const $={browser:null,version:null};if(typeof j>"u"||!j.navigator||!j.navigator.userAgent)return $.browser="Not a browser.",$;const{navigator:_e}=j;if(_e.userAgentData&&_e.userAgentData.brands){const et=_e.userAgentData.brands.find(tt=>tt.brand==="Chromium");if(et)return{browser:"chrome",version:parseInt(et.version,10)}}if(_e.mozGetUserMedia)$.browser="firefox",$.version=extractVersion(_e.userAgent,/Firefox\/(\d+)\./,1);else if(_e.webkitGetUserMedia||j.isSecureContext===!1&&j.webkitRTCPeerConnection)$.browser="chrome",$.version=extractVersion(_e.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(j.RTCPeerConnection&&_e.userAgent.match(/AppleWebKit\/(\d+)\./))$.browser="safari",$.version=extractVersion(_e.userAgent,/AppleWebKit\/(\d+)\./,1),$.supportsUnifiedPlan=j.RTCRtpTransceiver&&"currentDirection"in j.RTCRtpTransceiver.prototype;else return $.browser="Not a supported browser.",$;return $}function isObject$2(j){return Object.prototype.toString.call(j)==="[object Object]"}function compactObject(j){return isObject$2(j)?Object.keys(j).reduce(function($,_e){const et=isObject$2(j[_e]),tt=et?compactObject(j[_e]):j[_e],nt=et&&!Object.keys(tt).length;return tt===void 0||nt?$:Object.assign($,{[_e]:tt})},{}):j}function walkStats(j,$,_e){!$||_e.has($.id)||(_e.set($.id,$),Object.keys($).forEach(et=>{et.endsWith("Id")?walkStats(j,j.get($[et]),_e):et.endsWith("Ids")&&$[et].forEach(tt=>{walkStats(j,j.get(tt),_e)})}))}function filterStats(j,$,_e){const et=_e?"outbound-rtp":"inbound-rtp",tt=new Map;if($===null)return tt;const nt=[];return j.forEach(rt=>{rt.type==="track"&&rt.trackIdentifier===$.id&&nt.push(rt)}),nt.forEach(rt=>{j.forEach(it=>{it.type===et&&it.trackId===rt.id&&walkStats(j,it,tt)})}),tt}const logging$1=log$1;function shimGetUserMedia$2(j,$){const _e=j&&j.navigator;if(!_e.mediaDevices)return;const et=function(it){if(typeof it!="object"||it.mandatory||it.optional)return it;const st={};return Object.keys(it).forEach(at=>{if(at==="require"||at==="advanced"||at==="mediaSource")return;const ot=typeof it[at]=="object"?it[at]:{ideal:it[at]};ot.exact!==void 0&&typeof ot.exact=="number"&&(ot.min=ot.max=ot.exact);const ct=function(lt,ut){return lt?lt+ut.charAt(0).toUpperCase()+ut.slice(1):ut==="deviceId"?"sourceId":ut};if(ot.ideal!==void 0){st.optional=st.optional||[];let lt={};typeof ot.ideal=="number"?(lt[ct("min",at)]=ot.ideal,st.optional.push(lt),lt={},lt[ct("max",at)]=ot.ideal,st.optional.push(lt)):(lt[ct("",at)]=ot.ideal,st.optional.push(lt))}ot.exact!==void 0&&typeof ot.exact!="number"?(st.mandatory=st.mandatory||{},st.mandatory[ct("",at)]=ot.exact):["min","max"].forEach(lt=>{ot[lt]!==void 0&&(st.mandatory=st.mandatory||{},st.mandatory[ct(lt,at)]=ot[lt])})}),it.advanced&&(st.optional=(st.optional||[]).concat(it.advanced)),st},tt=function(it,st){if($.version>=61)return st(it);if(it=JSON.parse(JSON.stringify(it)),it&&typeof it.audio=="object"){const at=function(ot,ct,lt){ct in ot&&!(lt in ot)&&(ot[lt]=ot[ct],delete ot[ct])};it=JSON.parse(JSON.stringify(it)),at(it.audio,"autoGainControl","googAutoGainControl"),at(it.audio,"noiseSuppression","googNoiseSuppression"),it.audio=et(it.audio)}if(it&&typeof it.video=="object"){let at=it.video.facingMode;at=at&&(typeof at=="object"?at:{ideal:at});const ot=$.version<66;if(at&&(at.exact==="user"||at.exact==="environment"||at.ideal==="user"||at.ideal==="environment")&&!(_e.mediaDevices.getSupportedConstraints&&_e.mediaDevices.getSupportedConstraints().facingMode&&!ot)){delete it.video.facingMode;let ct;if(at.exact==="environment"||at.ideal==="environment"?ct=["back","rear"]:(at.exact==="user"||at.ideal==="user")&&(ct=["front"]),ct)return _e.mediaDevices.enumerateDevices().then(lt=>{lt=lt.filter(pt=>pt.kind==="videoinput");let ut=lt.find(pt=>ct.some(dt=>pt.label.toLowerCase().includes(dt)));return!ut&&lt.length&&ct.includes("back")&&(ut=lt[lt.length-1]),ut&&(it.video.deviceId=at.exact?{exact:ut.deviceId}:{ideal:ut.deviceId}),it.video=et(it.video),logging$1("chrome: "+JSON.stringify(it)),st(it)})}it.video=et(it.video)}return logging$1("chrome: "+JSON.stringify(it)),st(it)},nt=function(it){return $.version>=64?it:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[it.name]||it.name,message:it.message,constraint:it.constraint||it.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},rt=function(it,st,at){tt(it,ot=>{_e.webkitGetUserMedia(ot,st,ct=>{at&&at(nt(ct))})})};if(_e.getUserMedia=rt.bind(_e),_e.mediaDevices.getUserMedia){const it=_e.mediaDevices.getUserMedia.bind(_e.mediaDevices);_e.mediaDevices.getUserMedia=function(st){return tt(st,at=>it(at).then(ot=>{if(at.audio&&!ot.getAudioTracks().length||at.video&&!ot.getVideoTracks().length)throw ot.getTracks().forEach(ct=>{ct.stop()}),new DOMException("","NotFoundError");return ot},ot=>Promise.reject(nt(ot))))}}}function shimMediaStream(j){j.MediaStream=j.MediaStream||j.webkitMediaStream}function shimOnTrack$1(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("ontrack"in j.RTCPeerConnection.prototype)){Object.defineProperty(j.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(_e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=_e)},enumerable:!0,configurable:!0});const $=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=et=>{et.stream.addEventListener("addtrack",tt=>{let nt;j.RTCPeerConnection.prototype.getReceivers?nt=this.getReceivers().find(it=>it.track&&it.track.id===tt.track.id):nt={track:tt.track};const rt=new Event("track");rt.track=tt.track,rt.receiver=nt,rt.transceiver={receiver:nt},rt.streams=[et.stream],this.dispatchEvent(rt)}),et.stream.getTracks().forEach(tt=>{let nt;j.RTCPeerConnection.prototype.getReceivers?nt=this.getReceivers().find(it=>it.track&&it.track.id===tt.id):nt={track:tt};const rt=new Event("track");rt.track=tt,rt.receiver=nt,rt.transceiver={receiver:nt},rt.streams=[et.stream],this.dispatchEvent(rt)})},this.addEventListener("addstream",this._ontrackpoly)),$.apply(this,arguments)}}else wrapPeerConnectionEvent(j,"track",$=>($.transceiver||Object.defineProperty($,"transceiver",{value:{receiver:$.receiver}}),$))}function shimGetSendersWithDtmf(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("getSenders"in j.RTCPeerConnection.prototype)&&"createDTMFSender"in j.RTCPeerConnection.prototype){const $=function(tt,nt){return{track:nt,get dtmf(){return this._dtmf===void 0&&(nt.kind==="audio"?this._dtmf=tt.createDTMFSender(nt):this._dtmf=null),this._dtmf},_pc:tt}};if(!j.RTCPeerConnection.prototype.getSenders){j.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const tt=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(it,st){let at=tt.apply(this,arguments);return at||(at=$(this,it),this._senders.push(at)),at};const nt=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(it){nt.apply(this,arguments);const st=this._senders.indexOf(it);st!==-1&&this._senders.splice(st,1)}}const _e=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(nt){this._senders=this._senders||[],_e.apply(this,[nt]),nt.getTracks().forEach(rt=>{this._senders.push($(this,rt))})};const et=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(nt){this._senders=this._senders||[],et.apply(this,[nt]),nt.getTracks().forEach(rt=>{const it=this._senders.find(st=>st.track===rt);it&&this._senders.splice(this._senders.indexOf(it),1)})}}else if(typeof j=="object"&&j.RTCPeerConnection&&"getSenders"in j.RTCPeerConnection.prototype&&"createDTMFSender"in j.RTCPeerConnection.prototype&&j.RTCRtpSender&&!("dtmf"in j.RTCRtpSender.prototype)){const $=j.RTCPeerConnection.prototype.getSenders;j.RTCPeerConnection.prototype.getSenders=function(){const et=$.apply(this,[]);return et.forEach(tt=>tt._pc=this),et},Object.defineProperty(j.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimSenderReceiverGetStats(j){if(!(typeof j=="object"&&j.RTCPeerConnection&&j.RTCRtpSender&&j.RTCRtpReceiver))return;if(!("getStats"in j.RTCRtpSender.prototype)){const _e=j.RTCPeerConnection.prototype.getSenders;_e&&(j.RTCPeerConnection.prototype.getSenders=function(){const nt=_e.apply(this,[]);return nt.forEach(rt=>rt._pc=this),nt});const et=j.RTCPeerConnection.prototype.addTrack;et&&(j.RTCPeerConnection.prototype.addTrack=function(){const nt=et.apply(this,arguments);return nt._pc=this,nt}),j.RTCRtpSender.prototype.getStats=function(){const nt=this;return this._pc.getStats().then(rt=>filterStats(rt,nt.track,!0))}}if(!("getStats"in j.RTCRtpReceiver.prototype)){const _e=j.RTCPeerConnection.prototype.getReceivers;_e&&(j.RTCPeerConnection.prototype.getReceivers=function(){const tt=_e.apply(this,[]);return tt.forEach(nt=>nt._pc=this),tt}),wrapPeerConnectionEvent(j,"track",et=>(et.receiver._pc=et.srcElement,et)),j.RTCRtpReceiver.prototype.getStats=function(){const tt=this;return this._pc.getStats().then(nt=>filterStats(nt,tt.track,!1))}}if(!("getStats"in j.RTCRtpSender.prototype&&"getStats"in j.RTCRtpReceiver.prototype))return;const $=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof j.MediaStreamTrack){const et=arguments[0];let tt,nt,rt;return this.getSenders().forEach(it=>{it.track===et&&(tt?rt=!0:tt=it)}),this.getReceivers().forEach(it=>(it.track===et&&(nt?rt=!0:nt=it),it.track===et)),rt||tt&&nt?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):tt?tt.getStats():nt?nt.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return $.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(j){j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(rt=>this._shimmedLocalStreams[rt][0])};const $=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(rt,it){if(!it)return $.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const st=$.apply(this,arguments);return this._shimmedLocalStreams[it.id]?this._shimmedLocalStreams[it.id].indexOf(st)===-1&&this._shimmedLocalStreams[it.id].push(st):this._shimmedLocalStreams[it.id]=[it,st],st};const _e=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(rt){this._shimmedLocalStreams=this._shimmedLocalStreams||{},rt.getTracks().forEach(at=>{if(this.getSenders().find(ct=>ct.track===at))throw new DOMException("Track already exists.","InvalidAccessError")});const it=this.getSenders();_e.apply(this,arguments);const st=this.getSenders().filter(at=>it.indexOf(at)===-1);this._shimmedLocalStreams[rt.id]=[rt].concat(st)};const et=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(rt){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[rt.id],et.apply(this,arguments)};const tt=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(rt){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},rt&&Object.keys(this._shimmedLocalStreams).forEach(it=>{const st=this._shimmedLocalStreams[it].indexOf(rt);st!==-1&&this._shimmedLocalStreams[it].splice(st,1),this._shimmedLocalStreams[it].length===1&&delete this._shimmedLocalStreams[it]}),tt.apply(this,arguments)}}function shimAddTrackRemoveTrack(j,$){if(!j.RTCPeerConnection)return;if(j.RTCPeerConnection.prototype.addTrack&&$.version>=65)return shimAddTrackRemoveTrackWithNative(j);const _e=j.RTCPeerConnection.prototype.getLocalStreams;j.RTCPeerConnection.prototype.getLocalStreams=function(){const ot=_e.apply(this);return this._reverseStreams=this._reverseStreams||{},ot.map(ct=>this._reverseStreams[ct.id])};const et=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(ot){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},ot.getTracks().forEach(ct=>{if(this.getSenders().find(ut=>ut.track===ct))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[ot.id]){const ct=new j.MediaStream(ot.getTracks());this._streams[ot.id]=ct,this._reverseStreams[ct.id]=ot,ot=ct}et.apply(this,[ot])};const tt=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(ot){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},tt.apply(this,[this._streams[ot.id]||ot]),delete this._reverseStreams[this._streams[ot.id]?this._streams[ot.id].id:ot.id],delete this._streams[ot.id]},j.RTCPeerConnection.prototype.addTrack=function(ot,ct){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const lt=[].slice.call(arguments,1);if(lt.length!==1||!lt[0].getTracks().find(dt=>dt===ot))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(dt=>dt.track===ot))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const pt=this._streams[ct.id];if(pt)pt.addTrack(ot),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const dt=new j.MediaStream([ot]);this._streams[ct.id]=dt,this._reverseStreams[dt.id]=ct,this.addStream(dt)}return this.getSenders().find(dt=>dt.track===ot)};function nt(at,ot){let ct=ot.sdp;return Object.keys(at._reverseStreams||[]).forEach(lt=>{const ut=at._reverseStreams[lt],pt=at._streams[ut.id];ct=ct.replace(new RegExp(pt.id,"g"),ut.id)}),new RTCSessionDescription({type:ot.type,sdp:ct})}function rt(at,ot){let ct=ot.sdp;return Object.keys(at._reverseStreams||[]).forEach(lt=>{const ut=at._reverseStreams[lt],pt=at._streams[ut.id];ct=ct.replace(new RegExp(ut.id,"g"),pt.id)}),new RTCSessionDescription({type:ot.type,sdp:ct})}["createOffer","createAnswer"].forEach(function(at){const ot=j.RTCPeerConnection.prototype[at],ct={[at](){const lt=arguments;return arguments.length&&typeof arguments[0]=="function"?ot.apply(this,[pt=>{const dt=nt(this,pt);lt[0].apply(null,[dt])},pt=>{lt[1]&&lt[1].apply(null,pt)},arguments[2]]):ot.apply(this,arguments).then(pt=>nt(this,pt))}};j.RTCPeerConnection.prototype[at]=ct[at]});const it=j.RTCPeerConnection.prototype.setLocalDescription;j.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?it.apply(this,arguments):(arguments[0]=rt(this,arguments[0]),it.apply(this,arguments))};const st=Object.getOwnPropertyDescriptor(j.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(j.RTCPeerConnection.prototype,"localDescription",{get(){const at=st.get.apply(this);return at.type===""?at:nt(this,at)}}),j.RTCPeerConnection.prototype.removeTrack=function(ot){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!ot._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(ot._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let lt;Object.keys(this._streams).forEach(ut=>{this._streams[ut].getTracks().find(dt=>ot.track===dt)&&(lt=this._streams[ut])}),lt&&(lt.getTracks().length===1?this.removeStream(this._reverseStreams[lt.id]):lt.removeTrack(ot.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(j,$){!j.RTCPeerConnection&&j.webkitRTCPeerConnection&&(j.RTCPeerConnection=j.webkitRTCPeerConnection),j.RTCPeerConnection&&$.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(_e){const et=j.RTCPeerConnection.prototype[_e],tt={[_e](){return arguments[0]=new(_e==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),et.apply(this,arguments)}};j.RTCPeerConnection.prototype[_e]=tt[_e]})}function fixNegotiationNeeded(j,$){wrapPeerConnectionEvent(j,"negotiationneeded",_e=>{const et=_e.target;if(!(($.version<72||et.getConfiguration&&et.getConfiguration().sdpSemantics==="plan-b")&&et.signalingState!=="stable"))return _e})}var chromeShim=Object.freeze({__proto__:null,fixNegotiationNeeded,shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative,shimGetSendersWithDtmf,shimGetUserMedia:shimGetUserMedia$2,shimMediaStream,shimOnTrack:shimOnTrack$1,shimPeerConnection:shimPeerConnection$1,shimSenderReceiverGetStats});function shimGetUserMedia$1(j,$){const _e=j&&j.navigator,et=j&&j.MediaStreamTrack;if(_e.getUserMedia=function(tt,nt,rt){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),_e.mediaDevices.getUserMedia(tt).then(nt,rt)},!($.version>55&&"autoGainControl"in _e.mediaDevices.getSupportedConstraints())){const tt=function(rt,it,st){it in rt&&!(st in rt)&&(rt[st]=rt[it],delete rt[it])},nt=_e.mediaDevices.getUserMedia.bind(_e.mediaDevices);if(_e.mediaDevices.getUserMedia=function(rt){return typeof rt=="object"&&typeof rt.audio=="object"&&(rt=JSON.parse(JSON.stringify(rt)),tt(rt.audio,"autoGainControl","mozAutoGainControl"),tt(rt.audio,"noiseSuppression","mozNoiseSuppression")),nt(rt)},et&&et.prototype.getSettings){const rt=et.prototype.getSettings;et.prototype.getSettings=function(){const it=rt.apply(this,arguments);return tt(it,"mozAutoGainControl","autoGainControl"),tt(it,"mozNoiseSuppression","noiseSuppression"),it}}if(et&&et.prototype.applyConstraints){const rt=et.prototype.applyConstraints;et.prototype.applyConstraints=function(it){return this.kind==="audio"&&typeof it=="object"&&(it=JSON.parse(JSON.stringify(it)),tt(it,"autoGainControl","mozAutoGainControl"),tt(it,"noiseSuppression","mozNoiseSuppression")),rt.apply(this,[it])}}}}function shimGetDisplayMedia(j,$){j.navigator.mediaDevices&&"getDisplayMedia"in j.navigator.mediaDevices||j.navigator.mediaDevices&&(j.navigator.mediaDevices.getDisplayMedia=function(et){if(!(et&&et.video)){const tt=new DOMException("getDisplayMedia without video constraints is undefined");return tt.name="NotFoundError",tt.code=8,Promise.reject(tt)}return et.video===!0?et.video={mediaSource:$}:et.video.mediaSource=$,j.navigator.mediaDevices.getUserMedia(et)})}function shimOnTrack(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(j,$){if(typeof j!="object"||!(j.RTCPeerConnection||j.mozRTCPeerConnection))return;!j.RTCPeerConnection&&j.mozRTCPeerConnection&&(j.RTCPeerConnection=j.mozRTCPeerConnection),$.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(tt){const nt=j.RTCPeerConnection.prototype[tt],rt={[tt](){return arguments[0]=new(tt==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),nt.apply(this,arguments)}};j.RTCPeerConnection.prototype[tt]=rt[tt]});const _e={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},et=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){const[nt,rt,it]=arguments;return et.apply(this,[nt||null]).then(st=>{if($.version<53&&!rt)try{st.forEach(at=>{at.type=_e[at.type]||at.type})}catch(at){if(at.name!=="TypeError")throw at;st.forEach((ot,ct)=>{st.set(ct,Object.assign({},ot,{type:_e[ot.type]||ot.type}))})}return st}).then(rt,it)}}function shimSenderGetStats(j){if(!(typeof j=="object"&&j.RTCPeerConnection&&j.RTCRtpSender)||j.RTCRtpSender&&"getStats"in j.RTCRtpSender.prototype)return;const $=j.RTCPeerConnection.prototype.getSenders;$&&(j.RTCPeerConnection.prototype.getSenders=function(){const tt=$.apply(this,[]);return tt.forEach(nt=>nt._pc=this),tt});const _e=j.RTCPeerConnection.prototype.addTrack;_e&&(j.RTCPeerConnection.prototype.addTrack=function(){const tt=_e.apply(this,arguments);return tt._pc=this,tt}),j.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(j){if(!(typeof j=="object"&&j.RTCPeerConnection&&j.RTCRtpSender)||j.RTCRtpSender&&"getStats"in j.RTCRtpReceiver.prototype)return;const $=j.RTCPeerConnection.prototype.getReceivers;$&&(j.RTCPeerConnection.prototype.getReceivers=function(){const et=$.apply(this,[]);return et.forEach(tt=>tt._pc=this),et}),wrapPeerConnectionEvent(j,"track",_e=>(_e.receiver._pc=_e.srcElement,_e)),j.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function shimRemoveStream(j){!j.RTCPeerConnection||"removeStream"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.removeStream=function(_e){deprecated("removeStream","removeTrack"),this.getSenders().forEach(et=>{et.track&&_e.getTracks().includes(et.track)&&this.removeTrack(et)})})}function shimRTCDataChannel(j){j.DataChannel&&!j.RTCDataChannel&&(j.RTCDataChannel=j.DataChannel)}function shimAddTransceiver(j){if(!(typeof j=="object"&&j.RTCPeerConnection))return;const $=j.RTCPeerConnection.prototype.addTransceiver;$&&(j.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let et=arguments[1]&&arguments[1].sendEncodings;et===void 0&&(et=[]),et=[...et];const tt=et.length>0;tt&&et.forEach(rt=>{if("rid"in rt&&!/^[a-z0-9]{0,16}$/i.test(rt.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in rt&&!(parseFloat(rt.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in rt&&!(parseFloat(rt.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const nt=$.apply(this,arguments);if(tt){const{sender:rt}=nt,it=rt.getParameters();(!("encodings"in it)||it.encodings.length===1&&Object.keys(it.encodings[0]).length===0)&&(it.encodings=et,rt.sendEncodings=et,this.setParametersPromises.push(rt.setParameters(it).then(()=>{delete rt.sendEncodings}).catch(()=>{delete rt.sendEncodings})))}return nt})}function shimGetParameters(j){if(!(typeof j=="object"&&j.RTCRtpSender))return;const $=j.RTCRtpSender.prototype.getParameters;$&&(j.RTCRtpSender.prototype.getParameters=function(){const et=$.apply(this,arguments);return"encodings"in et||(et.encodings=[].concat(this.sendEncodings||[{}])),et})}function shimCreateOffer(j){if(!(typeof j=="object"&&j.RTCPeerConnection))return;const $=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>$.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):$.apply(this,arguments)}}function shimCreateAnswer(j){if(!(typeof j=="object"&&j.RTCPeerConnection))return;const $=j.RTCPeerConnection.prototype.createAnswer;j.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>$.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):$.apply(this,arguments)}}var firefoxShim=Object.freeze({__proto__:null,shimAddTransceiver,shimCreateAnswer,shimCreateOffer,shimGetDisplayMedia,shimGetParameters,shimGetUserMedia:shimGetUserMedia$1,shimOnTrack,shimPeerConnection,shimRTCDataChannel,shimReceiverGetStats,shimRemoveStream,shimSenderGetStats});function shimLocalStreamsAPI(j){if(!(typeof j!="object"||!j.RTCPeerConnection)){if("getLocalStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in j.RTCPeerConnection.prototype)){const $=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addStream=function(et){this._localStreams||(this._localStreams=[]),this._localStreams.includes(et)||this._localStreams.push(et),et.getAudioTracks().forEach(tt=>$.call(this,tt,et)),et.getVideoTracks().forEach(tt=>$.call(this,tt,et))},j.RTCPeerConnection.prototype.addTrack=function(et){for(var tt=arguments.length,nt=new Array(tt>1?tt-1:0),rt=1;rt<tt;rt++)nt[rt-1]=arguments[rt];return nt&&nt.forEach(it=>{this._localStreams?this._localStreams.includes(it)||this._localStreams.push(it):this._localStreams=[it]}),$.apply(this,arguments)}}"removeStream"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.removeStream=function(_e){this._localStreams||(this._localStreams=[]);const et=this._localStreams.indexOf(_e);if(et===-1)return;this._localStreams.splice(et,1);const tt=_e.getTracks();this.getSenders().forEach(nt=>{tt.includes(nt.track)&&this.removeTrack(nt)})})}}function shimRemoteStreamsAPI(j){if(!(typeof j!="object"||!j.RTCPeerConnection)&&("getRemoteStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in j.RTCPeerConnection.prototype))){Object.defineProperty(j.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(_e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=_e),this.addEventListener("track",this._onaddstreampoly=et=>{et.streams.forEach(tt=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(tt))return;this._remoteStreams.push(tt);const nt=new Event("addstream");nt.stream=tt,this.dispatchEvent(nt)})})}});const $=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){const et=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(tt){tt.streams.forEach(nt=>{if(et._remoteStreams||(et._remoteStreams=[]),et._remoteStreams.indexOf(nt)>=0)return;et._remoteStreams.push(nt);const rt=new Event("addstream");rt.stream=nt,et.dispatchEvent(rt)})}),$.apply(et,arguments)}}}function shimCallbacksAPI(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const $=j.RTCPeerConnection.prototype,_e=$.createOffer,et=$.createAnswer,tt=$.setLocalDescription,nt=$.setRemoteDescription,rt=$.addIceCandidate;$.createOffer=function(at,ot){const ct=arguments.length>=2?arguments[2]:arguments[0],lt=_e.apply(this,[ct]);return ot?(lt.then(at,ot),Promise.resolve()):lt},$.createAnswer=function(at,ot){const ct=arguments.length>=2?arguments[2]:arguments[0],lt=et.apply(this,[ct]);return ot?(lt.then(at,ot),Promise.resolve()):lt};let it=function(st,at,ot){const ct=tt.apply(this,[st]);return ot?(ct.then(at,ot),Promise.resolve()):ct};$.setLocalDescription=it,it=function(st,at,ot){const ct=nt.apply(this,[st]);return ot?(ct.then(at,ot),Promise.resolve()):ct},$.setRemoteDescription=it,it=function(st,at,ot){const ct=rt.apply(this,[st]);return ot?(ct.then(at,ot),Promise.resolve()):ct},$.addIceCandidate=it}function shimGetUserMedia(j){const $=j&&j.navigator;if($.mediaDevices&&$.mediaDevices.getUserMedia){const _e=$.mediaDevices,et=_e.getUserMedia.bind(_e);$.mediaDevices.getUserMedia=tt=>et(shimConstraints(tt))}!$.getUserMedia&&$.mediaDevices&&$.mediaDevices.getUserMedia&&($.getUserMedia=(function(et,tt,nt){$.mediaDevices.getUserMedia(et).then(tt,nt)}).bind($))}function shimConstraints(j){return j&&j.video!==void 0?Object.assign({},j,{video:compactObject(j.video)}):j}function shimRTCIceServerUrls(j){if(!j.RTCPeerConnection)return;const $=j.RTCPeerConnection;j.RTCPeerConnection=function(et,tt){if(et&&et.iceServers){const nt=[];for(let rt=0;rt<et.iceServers.length;rt++){let it=et.iceServers[rt];it.urls===void 0&&it.url?(deprecated("RTCIceServer.url","RTCIceServer.urls"),it=JSON.parse(JSON.stringify(it)),it.urls=it.url,delete it.url,nt.push(it)):nt.push(et.iceServers[rt])}et.iceServers=nt}return new $(et,tt)},j.RTCPeerConnection.prototype=$.prototype,"generateCertificate"in $&&Object.defineProperty(j.RTCPeerConnection,"generateCertificate",{get(){return $.generateCertificate}})}function shimTrackEventTransceiver(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(j){const $=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(et){if(et){typeof et.offerToReceiveAudio<"u"&&(et.offerToReceiveAudio=!!et.offerToReceiveAudio);const tt=this.getTransceivers().find(rt=>rt.receiver.track.kind==="audio");et.offerToReceiveAudio===!1&&tt?tt.direction==="sendrecv"?tt.setDirection?tt.setDirection("sendonly"):tt.direction="sendonly":tt.direction==="recvonly"&&(tt.setDirection?tt.setDirection("inactive"):tt.direction="inactive"):et.offerToReceiveAudio===!0&&!tt&&this.addTransceiver("audio",{direction:"recvonly"}),typeof et.offerToReceiveVideo<"u"&&(et.offerToReceiveVideo=!!et.offerToReceiveVideo);const nt=this.getTransceivers().find(rt=>rt.receiver.track.kind==="video");et.offerToReceiveVideo===!1&&nt?nt.direction==="sendrecv"?nt.setDirection?nt.setDirection("sendonly"):nt.direction="sendonly":nt.direction==="recvonly"&&(nt.setDirection?nt.setDirection("inactive"):nt.direction="inactive"):et.offerToReceiveVideo===!0&&!nt&&this.addTransceiver("video",{direction:"recvonly"})}return $.apply(this,arguments)}}function shimAudioContext(j){typeof j!="object"||j.AudioContext||(j.AudioContext=j.webkitAudioContext)}var safariShim=Object.freeze({__proto__:null,shimAudioContext,shimCallbacksAPI,shimConstraints,shimCreateOfferLegacy,shimGetUserMedia,shimLocalStreamsAPI,shimRTCIceServerUrls,shimRemoteStreamsAPI,shimTrackEventTransceiver}),sdp$1={exports:{}},hasRequiredSdp;function requireSdp(){return hasRequiredSdp||(hasRequiredSdp=1,function(j){const $={};$.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},$.localCName=$.generateIdentifier(),$.splitLines=function(_e){return _e.trim().split(`
`).map(et=>et.trim())},$.splitSections=function(_e){return _e.split(`
m=`).map((tt,nt)=>(nt>0?"m="+tt:tt).trim()+`\r
`)},$.getDescription=function(_e){const et=$.splitSections(_e);return et&&et[0]},$.getMediaSections=function(_e){const et=$.splitSections(_e);return et.shift(),et},$.matchPrefix=function(_e,et){return $.splitLines(_e).filter(tt=>tt.indexOf(et)===0)},$.parseCandidate=function(_e){let et;_e.indexOf("a=candidate:")===0?et=_e.substring(12).split(" "):et=_e.substring(10).split(" ");const tt={foundation:et[0],component:{1:"rtp",2:"rtcp"}[et[1]]||et[1],protocol:et[2].toLowerCase(),priority:parseInt(et[3],10),ip:et[4],address:et[4],port:parseInt(et[5],10),type:et[7]};for(let nt=8;nt<et.length;nt+=2)switch(et[nt]){case"raddr":tt.relatedAddress=et[nt+1];break;case"rport":tt.relatedPort=parseInt(et[nt+1],10);break;case"tcptype":tt.tcpType=et[nt+1];break;case"ufrag":tt.ufrag=et[nt+1],tt.usernameFragment=et[nt+1];break;default:tt[et[nt]]===void 0&&(tt[et[nt]]=et[nt+1]);break}return tt},$.writeCandidate=function(_e){const et=[];et.push(_e.foundation);const tt=_e.component;tt==="rtp"?et.push(1):tt==="rtcp"?et.push(2):et.push(tt),et.push(_e.protocol.toUpperCase()),et.push(_e.priority),et.push(_e.address||_e.ip),et.push(_e.port);const nt=_e.type;return et.push("typ"),et.push(nt),nt!=="host"&&_e.relatedAddress&&_e.relatedPort&&(et.push("raddr"),et.push(_e.relatedAddress),et.push("rport"),et.push(_e.relatedPort)),_e.tcpType&&_e.protocol.toLowerCase()==="tcp"&&(et.push("tcptype"),et.push(_e.tcpType)),(_e.usernameFragment||_e.ufrag)&&(et.push("ufrag"),et.push(_e.usernameFragment||_e.ufrag)),"candidate:"+et.join(" ")},$.parseIceOptions=function(_e){return _e.substring(14).split(" ")},$.parseRtpMap=function(_e){let et=_e.substring(9).split(" ");const tt={payloadType:parseInt(et.shift(),10)};return et=et[0].split("/"),tt.name=et[0],tt.clockRate=parseInt(et[1],10),tt.channels=et.length===3?parseInt(et[2],10):1,tt.numChannels=tt.channels,tt},$.writeRtpMap=function(_e){let et=_e.payloadType;_e.preferredPayloadType!==void 0&&(et=_e.preferredPayloadType);const tt=_e.channels||_e.numChannels||1;return"a=rtpmap:"+et+" "+_e.name+"/"+_e.clockRate+(tt!==1?"/"+tt:"")+`\r
`},$.parseExtmap=function(_e){const et=_e.substring(9).split(" ");return{id:parseInt(et[0],10),direction:et[0].indexOf("/")>0?et[0].split("/")[1]:"sendrecv",uri:et[1],attributes:et.slice(2).join(" ")}},$.writeExtmap=function(_e){return"a=extmap:"+(_e.id||_e.preferredId)+(_e.direction&&_e.direction!=="sendrecv"?"/"+_e.direction:"")+" "+_e.uri+(_e.attributes?" "+_e.attributes:"")+`\r
`},$.parseFmtp=function(_e){const et={};let tt;const nt=_e.substring(_e.indexOf(" ")+1).split(";");for(let rt=0;rt<nt.length;rt++)tt=nt[rt].trim().split("="),et[tt[0].trim()]=tt[1];return et},$.writeFmtp=function(_e){let et="",tt=_e.payloadType;if(_e.preferredPayloadType!==void 0&&(tt=_e.preferredPayloadType),_e.parameters&&Object.keys(_e.parameters).length){const nt=[];Object.keys(_e.parameters).forEach(rt=>{_e.parameters[rt]!==void 0?nt.push(rt+"="+_e.parameters[rt]):nt.push(rt)}),et+="a=fmtp:"+tt+" "+nt.join(";")+`\r
`}return et},$.parseRtcpFb=function(_e){const et=_e.substring(_e.indexOf(" ")+1).split(" ");return{type:et.shift(),parameter:et.join(" ")}},$.writeRtcpFb=function(_e){let et="",tt=_e.payloadType;return _e.preferredPayloadType!==void 0&&(tt=_e.preferredPayloadType),_e.rtcpFeedback&&_e.rtcpFeedback.length&&_e.rtcpFeedback.forEach(nt=>{et+="a=rtcp-fb:"+tt+" "+nt.type+(nt.parameter&&nt.parameter.length?" "+nt.parameter:"")+`\r
`}),et},$.parseSsrcMedia=function(_e){const et=_e.indexOf(" "),tt={ssrc:parseInt(_e.substring(7,et),10)},nt=_e.indexOf(":",et);return nt>-1?(tt.attribute=_e.substring(et+1,nt),tt.value=_e.substring(nt+1)):tt.attribute=_e.substring(et+1),tt},$.parseSsrcGroup=function(_e){const et=_e.substring(13).split(" ");return{semantics:et.shift(),ssrcs:et.map(tt=>parseInt(tt,10))}},$.getMid=function(_e){const et=$.matchPrefix(_e,"a=mid:")[0];if(et)return et.substring(6)},$.parseFingerprint=function(_e){const et=_e.substring(14).split(" ");return{algorithm:et[0].toLowerCase(),value:et[1].toUpperCase()}},$.getDtlsParameters=function(_e,et){return{role:"auto",fingerprints:$.matchPrefix(_e+et,"a=fingerprint:").map($.parseFingerprint)}},$.writeDtlsParameters=function(_e,et){let tt="a=setup:"+et+`\r
`;return _e.fingerprints.forEach(nt=>{tt+="a=fingerprint:"+nt.algorithm+" "+nt.value+`\r
`}),tt},$.parseCryptoLine=function(_e){const et=_e.substring(9).split(" ");return{tag:parseInt(et[0],10),cryptoSuite:et[1],keyParams:et[2],sessionParams:et.slice(3)}},$.writeCryptoLine=function(_e){return"a=crypto:"+_e.tag+" "+_e.cryptoSuite+" "+(typeof _e.keyParams=="object"?$.writeCryptoKeyParams(_e.keyParams):_e.keyParams)+(_e.sessionParams?" "+_e.sessionParams.join(" "):"")+`\r
`},$.parseCryptoKeyParams=function(_e){if(_e.indexOf("inline:")!==0)return null;const et=_e.substring(7).split("|");return{keyMethod:"inline",keySalt:et[0],lifeTime:et[1],mkiValue:et[2]?et[2].split(":")[0]:void 0,mkiLength:et[2]?et[2].split(":")[1]:void 0}},$.writeCryptoKeyParams=function(_e){return _e.keyMethod+":"+_e.keySalt+(_e.lifeTime?"|"+_e.lifeTime:"")+(_e.mkiValue&&_e.mkiLength?"|"+_e.mkiValue+":"+_e.mkiLength:"")},$.getCryptoParameters=function(_e,et){return $.matchPrefix(_e+et,"a=crypto:").map($.parseCryptoLine)},$.getIceParameters=function(_e,et){const tt=$.matchPrefix(_e+et,"a=ice-ufrag:")[0],nt=$.matchPrefix(_e+et,"a=ice-pwd:")[0];return tt&&nt?{usernameFragment:tt.substring(12),password:nt.substring(10)}:null},$.writeIceParameters=function(_e){let et="a=ice-ufrag:"+_e.usernameFragment+`\r
a=ice-pwd:`+_e.password+`\r
`;return _e.iceLite&&(et+=`a=ice-lite\r
`),et},$.parseRtpParameters=function(_e){const et={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},nt=$.splitLines(_e)[0].split(" ");et.profile=nt[2];for(let it=3;it<nt.length;it++){const st=nt[it],at=$.matchPrefix(_e,"a=rtpmap:"+st+" ")[0];if(at){const ot=$.parseRtpMap(at),ct=$.matchPrefix(_e,"a=fmtp:"+st+" ");switch(ot.parameters=ct.length?$.parseFmtp(ct[0]):{},ot.rtcpFeedback=$.matchPrefix(_e,"a=rtcp-fb:"+st+" ").map($.parseRtcpFb),et.codecs.push(ot),ot.name.toUpperCase()){case"RED":case"ULPFEC":et.fecMechanisms.push(ot.name.toUpperCase());break}}}$.matchPrefix(_e,"a=extmap:").forEach(it=>{et.headerExtensions.push($.parseExtmap(it))});const rt=$.matchPrefix(_e,"a=rtcp-fb:* ").map($.parseRtcpFb);return et.codecs.forEach(it=>{rt.forEach(st=>{it.rtcpFeedback.find(ot=>ot.type===st.type&&ot.parameter===st.parameter)||it.rtcpFeedback.push(st)})}),et},$.writeRtpDescription=function(_e,et){let tt="";tt+="m="+_e+" ",tt+=et.codecs.length>0?"9":"0",tt+=" "+(et.profile||"UDP/TLS/RTP/SAVPF")+" ",tt+=et.codecs.map(rt=>rt.preferredPayloadType!==void 0?rt.preferredPayloadType:rt.payloadType).join(" ")+`\r
`,tt+=`c=IN IP4 0.0.0.0\r
`,tt+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,et.codecs.forEach(rt=>{tt+=$.writeRtpMap(rt),tt+=$.writeFmtp(rt),tt+=$.writeRtcpFb(rt)});let nt=0;return et.codecs.forEach(rt=>{rt.maxptime>nt&&(nt=rt.maxptime)}),nt>0&&(tt+="a=maxptime:"+nt+`\r
`),et.headerExtensions&&et.headerExtensions.forEach(rt=>{tt+=$.writeExtmap(rt)}),tt},$.parseRtpEncodingParameters=function(_e){const et=[],tt=$.parseRtpParameters(_e),nt=tt.fecMechanisms.indexOf("RED")!==-1,rt=tt.fecMechanisms.indexOf("ULPFEC")!==-1,it=$.matchPrefix(_e,"a=ssrc:").map(lt=>$.parseSsrcMedia(lt)).filter(lt=>lt.attribute==="cname"),st=it.length>0&&it[0].ssrc;let at;const ot=$.matchPrefix(_e,"a=ssrc-group:FID").map(lt=>lt.substring(17).split(" ").map(pt=>parseInt(pt,10)));ot.length>0&&ot[0].length>1&&ot[0][0]===st&&(at=ot[0][1]),tt.codecs.forEach(lt=>{if(lt.name.toUpperCase()==="RTX"&&lt.parameters.apt){let ut={ssrc:st,codecPayloadType:parseInt(lt.parameters.apt,10)};st&&at&&(ut.rtx={ssrc:at}),et.push(ut),nt&&(ut=JSON.parse(JSON.stringify(ut)),ut.fec={ssrc:st,mechanism:rt?"red+ulpfec":"red"},et.push(ut))}}),et.length===0&&st&&et.push({ssrc:st});let ct=$.matchPrefix(_e,"b=");return ct.length&&(ct[0].indexOf("b=TIAS:")===0?ct=parseInt(ct[0].substring(7),10):ct[0].indexOf("b=AS:")===0?ct=parseInt(ct[0].substring(5),10)*1e3*.95-50*40*8:ct=void 0,et.forEach(lt=>{lt.maxBitrate=ct})),et},$.parseRtcpParameters=function(_e){const et={},tt=$.matchPrefix(_e,"a=ssrc:").map(it=>$.parseSsrcMedia(it)).filter(it=>it.attribute==="cname")[0];tt&&(et.cname=tt.value,et.ssrc=tt.ssrc);const nt=$.matchPrefix(_e,"a=rtcp-rsize");et.reducedSize=nt.length>0,et.compound=nt.length===0;const rt=$.matchPrefix(_e,"a=rtcp-mux");return et.mux=rt.length>0,et},$.writeRtcpParameters=function(_e){let et="";return _e.reducedSize&&(et+=`a=rtcp-rsize\r
`),_e.mux&&(et+=`a=rtcp-mux\r
`),_e.ssrc!==void 0&&_e.cname&&(et+="a=ssrc:"+_e.ssrc+" cname:"+_e.cname+`\r
`),et},$.parseMsid=function(_e){let et;const tt=$.matchPrefix(_e,"a=msid:");if(tt.length===1)return et=tt[0].substring(7).split(" "),{stream:et[0],track:et[1]};const nt=$.matchPrefix(_e,"a=ssrc:").map(rt=>$.parseSsrcMedia(rt)).filter(rt=>rt.attribute==="msid");if(nt.length>0)return et=nt[0].value.split(" "),{stream:et[0],track:et[1]}},$.parseSctpDescription=function(_e){const et=$.parseMLine(_e),tt=$.matchPrefix(_e,"a=max-message-size:");let nt;tt.length>0&&(nt=parseInt(tt[0].substring(19),10)),isNaN(nt)&&(nt=65536);const rt=$.matchPrefix(_e,"a=sctp-port:");if(rt.length>0)return{port:parseInt(rt[0].substring(12),10),protocol:et.fmt,maxMessageSize:nt};const it=$.matchPrefix(_e,"a=sctpmap:");if(it.length>0){const st=it[0].substring(10).split(" ");return{port:parseInt(st[0],10),protocol:st[1],maxMessageSize:nt}}},$.writeSctpDescription=function(_e,et){let tt=[];return _e.protocol!=="DTLS/SCTP"?tt=["m="+_e.kind+" 9 "+_e.protocol+" "+et.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+et.port+`\r
`]:tt=["m="+_e.kind+" 9 "+_e.protocol+" "+et.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+et.port+" "+et.protocol+` 65535\r
`],et.maxMessageSize!==void 0&&tt.push("a=max-message-size:"+et.maxMessageSize+`\r
`),tt.join("")},$.generateSessionId=function(){return Math.random().toString().substr(2,22)},$.writeSessionBoilerplate=function(_e,et,tt){let nt;const rt=et!==void 0?et:2;return _e?nt=_e:nt=$.generateSessionId(),`v=0\r
o=`+(tt||"thisisadapterortc")+" "+nt+" "+rt+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},$.getDirection=function(_e,et){const tt=$.splitLines(_e);for(let nt=0;nt<tt.length;nt++)switch(tt[nt]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return tt[nt].substring(2)}return et?$.getDirection(et):"sendrecv"},$.getKind=function(_e){return $.splitLines(_e)[0].split(" ")[0].substring(2)},$.isRejected=function(_e){return _e.split(" ",2)[1]==="0"},$.parseMLine=function(_e){const tt=$.splitLines(_e)[0].substring(2).split(" ");return{kind:tt[0],port:parseInt(tt[1],10),protocol:tt[2],fmt:tt.slice(3).join(" ")}},$.parseOLine=function(_e){const tt=$.matchPrefix(_e,"o=")[0].substring(2).split(" ");return{username:tt[0],sessionId:tt[1],sessionVersion:parseInt(tt[2],10),netType:tt[3],addressType:tt[4],address:tt[5]}},$.isValidSDP=function(_e){if(typeof _e!="string"||_e.length===0)return!1;const et=$.splitLines(_e);for(let tt=0;tt<et.length;tt++)if(et[tt].length<2||et[tt].charAt(1)!=="=")return!1;return!0},j.exports=$}(sdp$1)),sdp$1.exports}var sdpExports=requireSdp(),SDPUtils=getDefaultExportFromCjs(sdpExports),sdp=_mergeNamespaces$1({__proto__:null,default:SDPUtils},[sdpExports]);function shimRTCIceCandidate(j){if(!j.RTCIceCandidate||j.RTCIceCandidate&&"foundation"in j.RTCIceCandidate.prototype)return;const $=j.RTCIceCandidate;j.RTCIceCandidate=function(et){if(typeof et=="object"&&et.candidate&&et.candidate.indexOf("a=")===0&&(et=JSON.parse(JSON.stringify(et)),et.candidate=et.candidate.substring(2)),et.candidate&&et.candidate.length){const tt=new $(et),nt=SDPUtils.parseCandidate(et.candidate);for(const rt in nt)rt in tt||Object.defineProperty(tt,rt,{value:nt[rt]});return tt.toJSON=function(){return{candidate:tt.candidate,sdpMid:tt.sdpMid,sdpMLineIndex:tt.sdpMLineIndex,usernameFragment:tt.usernameFragment}},tt}return new $(et)},j.RTCIceCandidate.prototype=$.prototype,wrapPeerConnectionEvent(j,"icecandidate",_e=>(_e.candidate&&Object.defineProperty(_e,"candidate",{value:new j.RTCIceCandidate(_e.candidate),writable:"false"}),_e))}function shimRTCIceCandidateRelayProtocol(j){!j.RTCIceCandidate||j.RTCIceCandidate&&"relayProtocol"in j.RTCIceCandidate.prototype||wrapPeerConnectionEvent(j,"icecandidate",$=>{if($.candidate){const _e=SDPUtils.parseCandidate($.candidate.candidate);_e.type==="relay"&&($.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[_e.priority>>24])}return $})}function shimMaxMessageSize(j,$){if(!j.RTCPeerConnection)return;"sctp"in j.RTCPeerConnection.prototype||Object.defineProperty(j.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const _e=function(it){if(!it||!it.sdp)return!1;const st=SDPUtils.splitSections(it.sdp);return st.shift(),st.some(at=>{const ot=SDPUtils.parseMLine(at);return ot&&ot.kind==="application"&&ot.protocol.indexOf("SCTP")!==-1})},et=function(it){const st=it.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(st===null||st.length<2)return-1;const at=parseInt(st[1],10);return at!==at?-1:at},tt=function(it){let st=65536;return $.browser==="firefox"&&($.version<57?it===-1?st=16384:st=2147483637:$.version<60?st=$.version===57?65535:65536:st=2147483637),st},nt=function(it,st){let at=65536;$.browser==="firefox"&&$.version===57&&(at=65535);const ot=SDPUtils.matchPrefix(it.sdp,"a=max-message-size:");return ot.length>0?at=parseInt(ot[0].substring(19),10):$.browser==="firefox"&&st!==-1&&(at=2147483637),at},rt=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,$.browser==="chrome"&&$.version>=76){const{sdpSemantics:st}=this.getConfiguration();st==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(_e(arguments[0])){const st=et(arguments[0]),at=tt(st),ot=nt(arguments[0],st);let ct;at===0&&ot===0?ct=Number.POSITIVE_INFINITY:at===0||ot===0?ct=Math.max(at,ot):ct=Math.min(at,ot);const lt={};Object.defineProperty(lt,"maxMessageSize",{get(){return ct}}),this._sctp=lt}return rt.apply(this,arguments)}}function shimSendThrowTypeError(j){if(!(j.RTCPeerConnection&&"createDataChannel"in j.RTCPeerConnection.prototype))return;function $(et,tt){const nt=et.send;et.send=function(){const it=arguments[0],st=it.length||it.size||it.byteLength;if(et.readyState==="open"&&tt.sctp&&st>tt.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+tt.sctp.maxMessageSize+" bytes)");return nt.apply(et,arguments)}}const _e=j.RTCPeerConnection.prototype.createDataChannel;j.RTCPeerConnection.prototype.createDataChannel=function(){const tt=_e.apply(this,arguments);return $(tt,this),tt},wrapPeerConnectionEvent(j,"datachannel",et=>($(et.channel,et.target),et))}function shimConnectionState(j){if(!j.RTCPeerConnection||"connectionState"in j.RTCPeerConnection.prototype)return;const $=j.RTCPeerConnection.prototype;Object.defineProperty($,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty($,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(_e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),_e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=_e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(_e=>{const et=$[_e];$[_e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=tt=>{const nt=tt.target;if(nt._lastConnectionState!==nt.connectionState){nt._lastConnectionState=nt.connectionState;const rt=new Event("connectionstatechange",tt);nt.dispatchEvent(rt)}return tt},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),et.apply(this,arguments)}})}function removeExtmapAllowMixed(j,$){if(!j.RTCPeerConnection||$.browser==="chrome"&&$.version>=71||$.browser==="safari"&&$.version>=605)return;const _e=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(tt){if(tt&&tt.sdp&&tt.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const nt=tt.sdp.split(`
`).filter(rt=>rt.trim()!=="a=extmap-allow-mixed").join(`
`);j.RTCSessionDescription&&tt instanceof j.RTCSessionDescription?arguments[0]=new j.RTCSessionDescription({type:tt.type,sdp:nt}):tt.sdp=nt}return _e.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(j,$){if(!(j.RTCPeerConnection&&j.RTCPeerConnection.prototype))return;const _e=j.RTCPeerConnection.prototype.addIceCandidate;!_e||_e.length===0||(j.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?($.browser==="chrome"&&$.version<78||$.browser==="firefox"&&$.version<68||$.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():_e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(j,$){if(!(j.RTCPeerConnection&&j.RTCPeerConnection.prototype))return;const _e=j.RTCPeerConnection.prototype.setLocalDescription;!_e||_e.length===0||(j.RTCPeerConnection.prototype.setLocalDescription=function(){let tt=arguments[0]||{};if(typeof tt!="object"||tt.type&&tt.sdp)return _e.apply(this,arguments);if(tt={type:tt.type,sdp:tt.sdp},!tt.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":tt.type="offer";break;default:tt.type="answer";break}return tt.sdp||tt.type!=="offer"&&tt.type!=="answer"?_e.apply(this,[tt]):(tt.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(rt=>_e.apply(this,[rt]))})}var commonShim=Object.freeze({__proto__:null,removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty,shimConnectionState,shimMaxMessageSize,shimParameterlessSetLocalDescription,shimRTCIceCandidate,shimRTCIceCandidateRelayProtocol,shimSendThrowTypeError});function adapterFactory(){let{window:j}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const _e=log$1,et=detectBrowser(j),tt={browserDetails:et,commonShim,extractVersion,disableLog,disableWarnings,sdp};switch(et.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!$.shimChrome)return _e("Chrome shim is not included in this adapter release."),tt;if(et.version===null)return _e("Chrome shim can not determine version, not shimming."),tt;_e("adapter.js shimming chrome."),tt.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(j,et),shimParameterlessSetLocalDescription(j),shimGetUserMedia$2(j,et),shimMediaStream(j),shimPeerConnection$1(j,et),shimOnTrack$1(j),shimAddTrackRemoveTrack(j,et),shimGetSendersWithDtmf(j),shimSenderReceiverGetStats(j),fixNegotiationNeeded(j,et),shimRTCIceCandidate(j),shimRTCIceCandidateRelayProtocol(j),shimConnectionState(j),shimMaxMessageSize(j,et),shimSendThrowTypeError(j),removeExtmapAllowMixed(j,et);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!$.shimFirefox)return _e("Firefox shim is not included in this adapter release."),tt;_e("adapter.js shimming firefox."),tt.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(j,et),shimParameterlessSetLocalDescription(j),shimGetUserMedia$1(j,et),shimPeerConnection(j,et),shimOnTrack(j),shimRemoveStream(j),shimSenderGetStats(j),shimReceiverGetStats(j),shimRTCDataChannel(j),shimAddTransceiver(j),shimGetParameters(j),shimCreateOffer(j),shimCreateAnswer(j),shimRTCIceCandidate(j),shimConnectionState(j),shimMaxMessageSize(j,et),shimSendThrowTypeError(j);break;case"safari":if(!safariShim||!$.shimSafari)return _e("Safari shim is not included in this adapter release."),tt;_e("adapter.js shimming safari."),tt.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(j,et),shimParameterlessSetLocalDescription(j),shimRTCIceServerUrls(j),shimCreateOfferLegacy(j),shimCallbacksAPI(j),shimLocalStreamsAPI(j),shimRemoteStreamsAPI(j),shimTrackEventTransceiver(j),shimGetUserMedia(j),shimAudioContext(j),shimRTCIceCandidate(j),shimRTCIceCandidateRelayProtocol(j),shimMaxMessageSize(j,et),shimSendThrowTypeError(j),removeExtmapAllowMixed(j,et);break;default:_e("Unsupported browser!");break}return tt}adapterFactory({window:typeof window>"u"?void 0:window});const DECRYPTION_FAILURE_TOLERANCE=10,E2EE_FLAG="lk_e2ee",SALT="LKFrameEncryptionKey",KEY_PROVIDER_DEFAULTS={sharedKey:!1,ratchetSalt:SALT,ratchetWindowSize:8,failureTolerance:DECRYPTION_FAILURE_TOLERANCE,keyringSize:16,allowKeyExtraction:!1};var KeyProviderEvent;(function(j){j.SetKey="setKey",j.RatchetRequest="ratchetRequest",j.KeyRatcheted="keyRatcheted"})(KeyProviderEvent||(KeyProviderEvent={}));var KeyHandlerEvent;(function(j){j.KeyRatcheted="keyRatcheted"})(KeyHandlerEvent||(KeyHandlerEvent={}));var EncryptionEvent;(function(j){j.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",j.EncryptionError="encryptionError"})(EncryptionEvent||(EncryptionEvent={}));var CryptorEvent;(function(j){j.Error="cryptorError"})(CryptorEvent||(CryptorEvent={}));function isE2EESupported(){return isInsertableStreamSupported()||isScriptTransformSupported()}function isScriptTransformSupported(){return typeof window.RTCRtpScriptTransform<"u"}function isInsertableStreamSupported(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class BaseKeyProvider extends eventsExports.EventEmitter{constructor(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(_e,et)=>{livekitLogger.debug("key ratcheted event received",{material:_e,keyIndex:et})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},KEY_PROVIDER_DEFAULTS),$),this.on(KeyProviderEvent.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey($,_e,et){const tt={key:$,participantIdentity:_e,keyIndex:et};if(!this.options.sharedKey&&!_e)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(_e??"shared","-").concat(et??0),tt),this.emit(KeyProviderEvent.SetKey,tt)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey($,_e){this.emit(KeyProviderEvent.RatchetRequest,$,_e)}}class LivekitError extends Error{constructor($,_e){super(_e||"an error has occured"),this.name="LiveKitError",this.code=$}}var ConnectionErrorReason;(function(j){j[j.NotAllowed=0]="NotAllowed",j[j.ServerUnreachable=1]="ServerUnreachable",j[j.InternalError=2]="InternalError",j[j.Cancelled=3]="Cancelled",j[j.LeaveRequest=4]="LeaveRequest"})(ConnectionErrorReason||(ConnectionErrorReason={}));class ConnectionError extends LivekitError{constructor($,_e,et,tt){super(1,$),this.name="ConnectionError",this.status=et,this.reason=_e,this.context=tt,this.reasonName=ConnectionErrorReason[_e]}}class DeviceUnsupportedError extends LivekitError{constructor($){super(21,$??"device is unsupported"),this.name="DeviceUnsupportedError"}}class TrackInvalidError extends LivekitError{constructor($){super(20,$??"track is invalid"),this.name="TrackInvalidError"}}class UnsupportedServer extends LivekitError{constructor($){super(10,$??"unsupported server"),this.name="UnsupportedServer"}}class UnexpectedConnectionState extends LivekitError{constructor($){super(12,$??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class NegotiationError extends LivekitError{constructor($){super(13,$??"unable to negotiate"),this.name="NegotiationError"}}class PublishTrackError extends LivekitError{constructor($,_e){super(15,$),this.name="PublishTrackError",this.status=_e}}class SignalRequestError extends LivekitError{constructor($,_e){super(15,$),this.reason=_e,this.reasonName=typeof _e=="string"?_e:RequestResponse_Reason[_e]}}var MediaDeviceFailure;(function(j){j.PermissionDenied="PermissionDenied",j.NotFound="NotFound",j.DeviceInUse="DeviceInUse",j.Other="Other"})(MediaDeviceFailure||(MediaDeviceFailure={}));(function(j){function $(_e){if(_e&&"name"in _e)return _e.name==="NotFoundError"||_e.name==="DevicesNotFoundError"?j.NotFound:_e.name==="NotAllowedError"||_e.name==="PermissionDeniedError"?j.PermissionDenied:_e.name==="NotReadableError"||_e.name==="TrackStartError"?j.DeviceInUse:j.Other}j.getFailure=$})(MediaDeviceFailure||(MediaDeviceFailure={}));var CryptorErrorReason;(function(j){j[j.InvalidKey=0]="InvalidKey",j[j.MissingKey=1]="MissingKey",j[j.InternalError=2]="InternalError"})(CryptorErrorReason||(CryptorErrorReason={}));var RoomEvent;(function(j){j.Connected="connected",j.Reconnecting="reconnecting",j.SignalReconnecting="signalReconnecting",j.Reconnected="reconnected",j.Disconnected="disconnected",j.ConnectionStateChanged="connectionStateChanged",j.MediaDevicesChanged="mediaDevicesChanged",j.ParticipantConnected="participantConnected",j.ParticipantDisconnected="participantDisconnected",j.TrackPublished="trackPublished",j.TrackSubscribed="trackSubscribed",j.TrackSubscriptionFailed="trackSubscriptionFailed",j.TrackUnpublished="trackUnpublished",j.TrackUnsubscribed="trackUnsubscribed",j.TrackMuted="trackMuted",j.TrackUnmuted="trackUnmuted",j.LocalTrackPublished="localTrackPublished",j.LocalTrackUnpublished="localTrackUnpublished",j.LocalAudioSilenceDetected="localAudioSilenceDetected",j.ActiveSpeakersChanged="activeSpeakersChanged",j.ParticipantMetadataChanged="participantMetadataChanged",j.ParticipantNameChanged="participantNameChanged",j.ParticipantAttributesChanged="participantAttributesChanged",j.RoomMetadataChanged="roomMetadataChanged",j.DataReceived="dataReceived",j.SipDTMFReceived="sipDTMFReceived",j.TranscriptionReceived="transcriptionReceived",j.ConnectionQualityChanged="connectionQualityChanged",j.TrackStreamStateChanged="trackStreamStateChanged",j.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",j.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",j.AudioPlaybackStatusChanged="audioPlaybackChanged",j.VideoPlaybackStatusChanged="videoPlaybackChanged",j.MediaDevicesError="mediaDevicesError",j.ParticipantPermissionsChanged="participantPermissionsChanged",j.SignalConnected="signalConnected",j.RecordingStatusChanged="recordingStatusChanged",j.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",j.EncryptionError="encryptionError",j.DCBufferStatusChanged="dcBufferStatusChanged",j.ActiveDeviceChanged="activeDeviceChanged",j.ChatMessage="chatMessage",j.LocalTrackSubscribed="localTrackSubscribed",j.MetricsReceived="metricsReceived"})(RoomEvent||(RoomEvent={}));var ParticipantEvent;(function(j){j.TrackPublished="trackPublished",j.TrackSubscribed="trackSubscribed",j.TrackSubscriptionFailed="trackSubscriptionFailed",j.TrackUnpublished="trackUnpublished",j.TrackUnsubscribed="trackUnsubscribed",j.TrackMuted="trackMuted",j.TrackUnmuted="trackUnmuted",j.LocalTrackPublished="localTrackPublished",j.LocalTrackUnpublished="localTrackUnpublished",j.ParticipantMetadataChanged="participantMetadataChanged",j.ParticipantNameChanged="participantNameChanged",j.DataReceived="dataReceived",j.SipDTMFReceived="sipDTMFReceived",j.TranscriptionReceived="transcriptionReceived",j.IsSpeakingChanged="isSpeakingChanged",j.ConnectionQualityChanged="connectionQualityChanged",j.TrackStreamStateChanged="trackStreamStateChanged",j.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",j.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",j.MediaDevicesError="mediaDevicesError",j.AudioStreamAcquired="audioStreamAcquired",j.ParticipantPermissionsChanged="participantPermissionsChanged",j.PCTrackAdded="pcTrackAdded",j.AttributesChanged="attributesChanged",j.LocalTrackSubscribed="localTrackSubscribed",j.ChatMessage="chatMessage"})(ParticipantEvent||(ParticipantEvent={}));var EngineEvent;(function(j){j.TransportsCreated="transportsCreated",j.Connected="connected",j.Disconnected="disconnected",j.Resuming="resuming",j.Resumed="resumed",j.Restarting="restarting",j.Restarted="restarted",j.SignalResumed="signalResumed",j.SignalRestarted="signalRestarted",j.Closing="closing",j.MediaTrackAdded="mediaTrackAdded",j.ActiveSpeakersUpdate="activeSpeakersUpdate",j.DataPacketReceived="dataPacketReceived",j.RTPVideoMapUpdate="rtpVideoMapUpdate",j.DCBufferStatusChanged="dcBufferStatusChanged",j.ParticipantUpdate="participantUpdate",j.RoomUpdate="roomUpdate",j.SpeakersChanged="speakersChanged",j.StreamStateChanged="streamStateChanged",j.ConnectionQualityUpdate="connectionQualityUpdate",j.SubscriptionError="subscriptionError",j.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",j.RemoteMute="remoteMute",j.SubscribedQualityUpdate="subscribedQualityUpdate",j.LocalTrackUnpublished="localTrackUnpublished",j.LocalTrackSubscribed="localTrackSubscribed",j.Offline="offline",j.SignalRequestResponse="signalRequestResponse",j.SignalConnected="signalConnected"})(EngineEvent||(EngineEvent={}));var TrackEvent;(function(j){j.Message="message",j.Muted="muted",j.Unmuted="unmuted",j.Restarted="restarted",j.Ended="ended",j.Subscribed="subscribed",j.Unsubscribed="unsubscribed",j.UpdateSettings="updateSettings",j.UpdateSubscription="updateSubscription",j.AudioPlaybackStarted="audioPlaybackStarted",j.AudioPlaybackFailed="audioPlaybackFailed",j.AudioSilenceDetected="audioSilenceDetected",j.VisibilityChanged="visibilityChanged",j.VideoDimensionsChanged="videoDimensionsChanged",j.VideoPlaybackStarted="videoPlaybackStarted",j.VideoPlaybackFailed="videoPlaybackFailed",j.ElementAttached="elementAttached",j.ElementDetached="elementDetached",j.UpstreamPaused="upstreamPaused",j.UpstreamResumed="upstreamResumed",j.SubscriptionPermissionChanged="subscriptionPermissionChanged",j.SubscriptionStatusChanged="subscriptionStatusChanged",j.SubscriptionFailed="subscriptionFailed",j.TrackProcessorUpdate="trackProcessorUpdate",j.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",j.TranscriptionReceived="transcriptionReceived",j.TimeSyncUpdate="timeSyncUpdate"})(TrackEvent||(TrackEvent={}));function cloneDeep$2(j){return typeof j>"u"?j:typeof structuredClone=="function"?structuredClone(j):JSON.parse(JSON.stringify(j))}const commonVersionIdentifier=/version\/(\d+(\.?_?\d+)+)/i;let browserDetails;function getBrowser(j){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const _e=navigator.userAgent.toLowerCase();if(browserDetails===void 0||$){const et=browsersList.find(tt=>{let{test:nt}=tt;return nt.test(_e)});browserDetails=et==null?void 0:et.describe(_e)}return browserDetails}const browsersList=[{test:/firefox|iceweasel|fxios/i,describe(j){return{name:"Firefox",version:getMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,j),os:j.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:getOSVersion(j)}}},{test:/chrom|crios|crmo/i,describe(j){return{name:"Chrome",version:getMatch(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,j),os:j.toLowerCase().includes("crios")?"iOS":void 0,osVersion:getOSVersion(j)}}},{test:/safari|applewebkit/i,describe(j){return{name:"Safari",version:getMatch(commonVersionIdentifier,j),os:j.includes("mobile/")?"iOS":"macOS",osVersion:getOSVersion(j)}}}];function getMatch(j,$){let _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const et=$.match(j);return et&&et.length>=_e&&et[_e]||""}function getOSVersion(j){return j.includes("mac os")?getMatch(/\(.+?(\d+_\d+(:?_\d+)?)/,j,1).replace(/_/g,"."):void 0}var version$1="2.11.3";const version=version$1,protocolVersion=15;class CriticalTimers{}CriticalTimers.setTimeout=function(){return setTimeout(...arguments)};CriticalTimers.setInterval=function(){return setInterval(...arguments)};CriticalTimers.clearTimeout=function(){return clearTimeout(...arguments)};CriticalTimers.clearInterval=function(){return clearInterval(...arguments)};const BACKGROUND_REACTION_DELAY=5e3,recycledElements=[];var VideoQuality;(function(j){j[j.LOW=0]="LOW",j[j.MEDIUM=1]="MEDIUM",j[j.HIGH=2]="HIGH"})(VideoQuality||(VideoQuality={}));class Track extends eventsExports.EventEmitter{constructor($,_e){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var tt;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Track.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=livekitLogger,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BACKGROUND_REACTION_DELAY):this.handleAppVisibilityChanged()},this.log=getLogger$1((tt=et.loggerName)!==null&&tt!==void 0?tt:LoggerNames.Track),this.loggerContextCb=et.loggerContextCb,this.setMaxListeners(100),this.kind=_e,this._mediaStreamTrack=$,this._mediaStreamID=$.id,this.source=Track.Source.Unknown}get logContext(){var $;return Object.assign(Object.assign({},($=this.loggerContextCb)===null||$===void 0?void 0:$.call(this)),getLogContextFromTrack(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach($){let _e="audio";this.kind===Track.Kind.Video&&(_e="video"),this.attachedElements.length===0&&this.kind===Track.Kind.Video&&this.addAppVisibilityListener(),$||(_e==="audio"&&(recycledElements.forEach(nt=>{nt.parentElement===null&&!$&&($=nt)}),$&&recycledElements.splice(recycledElements.indexOf($),1)),$||($=document.createElement(_e))),this.attachedElements.includes($)||this.attachedElements.push($),attachToElement(this.mediaStreamTrack,$);const et=$.srcObject.getTracks(),tt=et.some(nt=>nt.kind==="audio");return $.play().then(()=>{this.emit(tt?TrackEvent.AudioPlaybackStarted:TrackEvent.VideoPlaybackStarted)}).catch(nt=>{nt.name==="NotAllowedError"?this.emit(tt?TrackEvent.AudioPlaybackFailed:TrackEvent.VideoPlaybackFailed,nt):nt.name==="AbortError"?livekitLogger.debug("".concat(tt?"audio":"video"," playback aborted, likely due to new play request")):livekitLogger.warn("could not playback ".concat(tt?"audio":"video"),nt),tt&&$&&et.some(rt=>rt.kind==="video")&&nt.name==="NotAllowedError"&&($.muted=!0,$.play().catch(()=>{}))}),this.emit(TrackEvent.ElementAttached,$),$}detach($){try{if($){detachTrack(this.mediaStreamTrack,$);const et=this.attachedElements.indexOf($);return et>=0&&(this.attachedElements.splice(et,1),this.recycleElement($),this.emit(TrackEvent.ElementDetached,$)),$}const _e=[];return this.attachedElements.forEach(et=>{detachTrack(this.mediaStreamTrack,et),_e.push(et),this.recycleElement(et),this.emit(TrackEvent.ElementDetached,et)}),this.attachedElements=[],_e}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions($){$.loggerName&&(this.log=getLogger$1($.loggerName)),$.loggerContextCb&&(this.loggerContextCb=$.loggerContextCb)}recycleElement($){if($ instanceof HTMLAudioElement){let _e=!0;$.pause(),recycledElements.forEach(et=>{et.parentElement||(_e=!1)}),_e&&recycledElements.push($)}}handleAppVisibilityChanged(){return __awaiter$1(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Track.Kind.Video&&setTimeout(()=>this.attachedElements.forEach($=>$.play().catch(()=>{})),0)})}addAppVisibilityListener(){isWeb()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){isWeb()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function attachToElement(j,$){let _e;$.srcObject instanceof MediaStream?_e=$.srcObject:_e=new MediaStream;let et;j.kind==="audio"?et=_e.getAudioTracks():et=_e.getVideoTracks(),et.includes(j)||(et.forEach(tt=>{_e.removeTrack(tt)}),_e.addTrack(j)),(!isSafari()||!($ instanceof HTMLVideoElement))&&($.autoplay=!0),$.muted=_e.getAudioTracks().length===0,$ instanceof HTMLVideoElement&&($.playsInline=!0),$.srcObject!==_e&&($.srcObject=_e,(isSafari()||isFireFox())&&$ instanceof HTMLVideoElement&&setTimeout(()=>{$.srcObject=_e,$.play().catch(()=>{})},0))}function detachTrack(j,$){if($.srcObject instanceof MediaStream){const _e=$.srcObject;_e.removeTrack(j),_e.getTracks().length>0?$.srcObject=_e:$.srcObject=null}}(function(j){let $;(function(at){at.Audio="audio",at.Video="video",at.Unknown="unknown"})($=j.Kind||(j.Kind={}));let _e;(function(at){at.Camera="camera",at.Microphone="microphone",at.ScreenShare="screen_share",at.ScreenShareAudio="screen_share_audio",at.Unknown="unknown"})(_e=j.Source||(j.Source={}));let et;(function(at){at.Active="active",at.Paused="paused",at.Unknown="unknown"})(et=j.StreamState||(j.StreamState={}));function tt(at){switch(at){case $.Audio:return TrackType.AUDIO;case $.Video:return TrackType.VIDEO;default:return TrackType.DATA}}j.kindToProto=tt;function nt(at){switch(at){case TrackType.AUDIO:return $.Audio;case TrackType.VIDEO:return $.Video;default:return $.Unknown}}j.kindFromProto=nt;function rt(at){switch(at){case _e.Camera:return TrackSource.CAMERA;case _e.Microphone:return TrackSource.MICROPHONE;case _e.ScreenShare:return TrackSource.SCREEN_SHARE;case _e.ScreenShareAudio:return TrackSource.SCREEN_SHARE_AUDIO;default:return TrackSource.UNKNOWN}}j.sourceToProto=rt;function it(at){switch(at){case TrackSource.CAMERA:return _e.Camera;case TrackSource.MICROPHONE:return _e.Microphone;case TrackSource.SCREEN_SHARE:return _e.ScreenShare;case TrackSource.SCREEN_SHARE_AUDIO:return _e.ScreenShareAudio;default:return _e.Unknown}}j.sourceFromProto=it;function st(at){switch(at){case StreamState.ACTIVE:return et.Active;case StreamState.PAUSED:return et.Paused;default:return et.Unknown}}j.streamStateFromProto=st})(Track||(Track={}));class VideoPreset{constructor($,_e,et,tt,nt){if(typeof $=="object")this.width=$.width,this.height=$.height,this.aspectRatio=$.aspectRatio,this.encoding={maxBitrate:$.maxBitrate,maxFramerate:$.maxFramerate,priority:$.priority};else if(_e!==void 0&&et!==void 0)this.width=$,this.height=_e,this.aspectRatio=$/_e,this.encoding={maxBitrate:et,maxFramerate:tt,priority:nt};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const backupCodecs=["vp8","h264"],videoCodecs=["vp8","h264","vp9","av1"];function isBackupCodec(j){return!!backupCodecs.find($=>$===j)}var BackupCodecPolicy;(function(j){j[j.PREFER_REGRESSION=0]="PREFER_REGRESSION",j[j.SIMULCAST=1]="SIMULCAST",j[j.REGRESSION=2]="REGRESSION"})(BackupCodecPolicy||(BackupCodecPolicy={}));var AudioPresets;(function(j){j.telephone={maxBitrate:12e3},j.speech={maxBitrate:24e3},j.music={maxBitrate:48e3},j.musicStereo={maxBitrate:64e3},j.musicHighQuality={maxBitrate:96e3},j.musicHighQualityStereo={maxBitrate:128e3}})(AudioPresets||(AudioPresets={}));const VideoPresets={h90:new VideoPreset(160,90,9e4,20),h180:new VideoPreset(320,180,16e4,20),h216:new VideoPreset(384,216,18e4,20),h360:new VideoPreset(640,360,45e4,20),h540:new VideoPreset(960,540,8e5,25),h720:new VideoPreset(1280,720,17e5,30),h1080:new VideoPreset(1920,1080,3e6,30),h1440:new VideoPreset(2560,1440,5e6,30),h2160:new VideoPreset(3840,2160,8e6,30)},VideoPresets43={h120:new VideoPreset(160,120,7e4,20),h180:new VideoPreset(240,180,125e3,20),h240:new VideoPreset(320,240,14e4,20),h360:new VideoPreset(480,360,33e4,20),h480:new VideoPreset(640,480,5e5,20),h540:new VideoPreset(720,540,6e5,25),h720:new VideoPreset(960,720,13e5,30),h1080:new VideoPreset(1440,1080,23e5,30),h1440:new VideoPreset(1920,1440,38e5,30)},ScreenSharePresets={h360fps3:new VideoPreset(640,360,2e5,3,"medium"),h360fps15:new VideoPreset(640,360,4e5,15,"medium"),h720fps5:new VideoPreset(1280,720,8e5,5,"medium"),h720fps15:new VideoPreset(1280,720,15e5,15,"medium"),h720fps30:new VideoPreset(1280,720,2e6,30,"medium"),h1080fps15:new VideoPreset(1920,1080,25e5,15,"medium"),h1080fps30:new VideoPreset(1920,1080,5e6,30,"medium"),original:new VideoPreset(0,0,7e6,30,"medium")},separator="|",ddExtensionURI="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function unpackStreamId(j){const $=j.split(separator);return $.length>1?[$[0],j.substr($[0].length+1)]:[j,""]}function sleep$1(j){return __awaiter$1(this,void 0,void 0,function*(){return new Promise($=>CriticalTimers.setTimeout($,j))})}function supportsTransceiver(){return"addTransceiver"in RTCPeerConnection.prototype}function supportsAddTrack(){return"addTrack"in RTCPeerConnection.prototype}function supportsAV1(){if(!("getCapabilities"in RTCRtpSender)||isSafari())return!1;const j=RTCRtpSender.getCapabilities("video");let $=!1;if(j){for(const _e of j.codecs)if(_e.mimeType==="video/AV1"){$=!0;break}}return $}function supportsVP9(){if(!("getCapabilities"in RTCRtpSender)||isFireFox())return!1;if(isSafari()){const _e=getBrowser();if(_e!=null&&_e.version&&compareVersions(_e.version,"16")<0)return!1}const j=RTCRtpSender.getCapabilities("video");let $=!1;if(j){for(const _e of j.codecs)if(_e.mimeType==="video/VP9"){$=!0;break}}return $}function isSVCCodec(j){return j==="av1"||j==="vp9"}function supportsSetSinkId(j){return document?(j||(j=document.createElement("audio")),"setSinkId"in j):!1}function isBrowserSupported(){return typeof RTCPeerConnection>"u"?!1:supportsTransceiver()||supportsAddTrack()}function isFireFox(){var j;return((j=getBrowser())===null||j===void 0?void 0:j.name)==="Firefox"}function isSafari(){var j;return((j=getBrowser())===null||j===void 0?void 0:j.name)==="Safari"}function isSafari17(){const j=getBrowser();return(j==null?void 0:j.name)==="Safari"&&j.version.startsWith("17.")}function isMobile(){var j,$;return isWeb()?($=(j=navigator.userAgentData)===null||j===void 0?void 0:j.mobile)!==null&&$!==void 0?$:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function isE2EESimulcastSupported(){const j=getBrowser(),$="17.2";if(j)return j.name!=="Safari"&&j.os!=="iOS"||j.os==="iOS"&&j.osVersion&&compareVersions($,j.osVersion)>=0?!0:j.name==="Safari"&&compareVersions($,j.version)>=0}function isWeb(){return typeof document<"u"}function isReactNative$1(){return navigator.product=="ReactNative"}function isCloud(j){return j.hostname.endsWith(".livekit.cloud")||j.hostname.endsWith(".livekit.run")}function getLKReactNativeInfo(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function getReactNativeOs(){if(!isReactNative$1())return;let j=getLKReactNativeInfo();if(j)return j.platform}function getDevicePixelRatio(){if(isWeb())return window.devicePixelRatio;if(isReactNative$1()){let j=getLKReactNativeInfo();if(j)return j.devicePixelRatio}return 1}function compareVersions(j,$){const _e=j.split("."),et=$.split("."),tt=Math.min(_e.length,et.length);for(let nt=0;nt<tt;++nt){const rt=parseInt(_e[nt],10),it=parseInt(et[nt],10);if(rt>it)return 1;if(rt<it)return-1;if(nt===tt-1&&rt===it)return 0}return j===""&&$!==""?-1:$===""?1:_e.length==et.length?0:_e.length<et.length?-1:1}function roDispatchCallback(j){for(const $ of j)$.target.handleResize($)}function ioDispatchCallback(j){for(const $ of j)$.target.handleVisibilityChanged($)}let resizeObserver=null;const getResizeObserver=()=>(resizeObserver||(resizeObserver=new ResizeObserver(roDispatchCallback)),resizeObserver);let intersectionObserver=null;const getIntersectionObserver=()=>(intersectionObserver||(intersectionObserver=new IntersectionObserver(ioDispatchCallback,{root:null,rootMargin:"0px"})),intersectionObserver);function getClientInfo(){var j;const $=new ClientInfo({sdk:ClientInfo_SDK.JS,protocol:protocolVersion,version});return isReactNative$1()&&($.os=(j=getReactNativeOs())!==null&&j!==void 0?j:""),$}function createDummyVideoStreamTrack(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,_e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,et=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const tt=document.createElement("canvas");tt.width=j,tt.height=$;const nt=tt.getContext("2d");nt==null||nt.fillRect(0,0,tt.width,tt.height),et&&nt&&(nt.beginPath(),nt.arc(j/2,$/2,50,0,Math.PI*2,!0),nt.closePath(),nt.fillStyle="grey",nt.fill());const rt=tt.captureStream(),[it]=rt.getTracks();if(!it)throw Error("Could not get empty media stream video track");return it.enabled=_e,it}let emptyAudioStreamTrack;function getEmptyAudioStreamTrack(){if(!emptyAudioStreamTrack){const j=new AudioContext,$=j.createOscillator(),_e=j.createGain();_e.gain.setValueAtTime(0,0);const et=j.createMediaStreamDestination();if($.connect(_e),_e.connect(et),$.start(),[emptyAudioStreamTrack]=et.stream.getAudioTracks(),!emptyAudioStreamTrack)throw Error("Could not get empty media stream audio track");emptyAudioStreamTrack.enabled=!1}return emptyAudioStreamTrack.clone()}class Future{constructor($,_e){this.onFinally=_e,this.promise=new Promise((et,tt)=>__awaiter$1(this,void 0,void 0,function*(){this.resolve=et,this.reject=tt,$&&(yield $(et,tt))})).finally(()=>{var et;return(et=this.onFinally)===null||et===void 0?void 0:et.call(this)})}}function isVideoCodec(j){return videoCodecs.includes(j)}function unwrapConstraint(j){if(typeof j=="string"||typeof j=="number")return j;if(Array.isArray(j))return j[0];if(j.exact)return Array.isArray(j.exact)?j.exact[0]:j.exact;if(j.ideal)return Array.isArray(j.ideal)?j.ideal[0]:j.ideal;throw Error("could not unwrap constraint")}function toWebsocketUrl(j){return j.startsWith("http")?j.replace(/^(http)/,"ws"):j}function toHttpUrl(j){return j.startsWith("ws")?j.replace(/^(ws)/,"http"):j}function extractTranscriptionSegments(j,$){return j.segments.map(_e=>{let{id:et,text:tt,language:nt,startTime:rt,endTime:it,final:st}=_e;var at;const ot=(at=$.get(et))!==null&&at!==void 0?at:Date.now(),ct=Date.now();return st?$.delete(et):$.set(et,ot),{id:et,text:tt,startTime:Number.parseInt(rt.toString()),endTime:Number.parseInt(it.toString()),final:st,language:nt,firstReceivedTime:ot,lastReceivedTime:ct}})}function extractChatMessage(j){const{id:$,timestamp:_e,message:et,editTimestamp:tt}=j;return{id:$,timestamp:Number.parseInt(_e.toString()),editTimestamp:tt?Number.parseInt(tt.toString()):void 0,message:et}}function getDisconnectReasonFromConnectionError(j){switch(j.reason){case ConnectionErrorReason.LeaveRequest:return j.context;case ConnectionErrorReason.Cancelled:return DisconnectReason.CLIENT_INITIATED;case ConnectionErrorReason.NotAllowed:return DisconnectReason.USER_REJECTED;case ConnectionErrorReason.ServerUnreachable:return DisconnectReason.JOIN_FAILURE;default:return DisconnectReason.UNKNOWN_REASON}}function bigIntToNumber(j){return j!==void 0?Number(j):void 0}function numberToBigInt(j){return j!==void 0?BigInt(j):void 0}function isLocalTrack(j){return!!j&&!(j instanceof MediaStreamTrack)&&j.isLocal}function isAudioTrack(j){return!!j&&j.kind==Track.Kind.Audio}function isVideoTrack(j){return!!j&&j.kind==Track.Kind.Video}function isLocalVideoTrack(j){return isLocalTrack(j)&&isVideoTrack(j)}function isLocalAudioTrack(j){return isLocalTrack(j)&&isAudioTrack(j)}function isRemoteTrack(j){return!!j&&!j.isLocal}function isRemotePub(j){return!!j&&!j.isLocal}function isRemoteVideoTrack(j){return isRemoteTrack(j)&&isVideoTrack(j)}function isLocalParticipant(j){return j.isLocal}function splitUtf8(j,$){const _e=[];let et=new TextEncoder().encode(j);for(;et.length>$;){let tt=$;for(;tt>0;){const nt=et[tt];if(nt!==void 0&&(nt&192)!==128)break;tt--}_e.push(et.slice(0,tt)),et=et.slice(tt)}return et.length>0&&_e.push(et),_e}function mergeDefaultOptions(j,$,_e){var et,tt,nt,rt;const{optionsWithoutProcessor:it,audioProcessor:st,videoProcessor:at}=extractProcessorsFromOptions(j??{}),ot=$==null?void 0:$.processor,ct=_e==null?void 0:_e.processor,lt=it??{};return lt.audio===!0&&(lt.audio={}),lt.video===!0&&(lt.video={}),lt.audio&&(mergeObjectWithoutOverwriting(lt.audio,$),(et=(nt=lt.audio).deviceId)!==null&&et!==void 0||(nt.deviceId={ideal:"default"}),(st||ot)&&(lt.audio.processor=st??ot)),lt.video&&(mergeObjectWithoutOverwriting(lt.video,_e),(tt=(rt=lt.video).deviceId)!==null&&tt!==void 0||(rt.deviceId={ideal:"default"}),(at||ct)&&(lt.video.processor=at??ct)),lt}function mergeObjectWithoutOverwriting(j,$){return Object.keys($).forEach(_e=>{j[_e]===void 0&&(j[_e]=$[_e])}),j}function constraintsForOptions(j){var $,_e,et,tt;const nt={};if(j.video)if(typeof j.video=="object"){const rt={},it=rt,st=j.video;Object.keys(st).forEach(at=>{switch(at){case"resolution":mergeObjectWithoutOverwriting(it,st.resolution);break;default:it[at]=st[at]}}),nt.video=rt,($=(et=nt.video).deviceId)!==null&&$!==void 0||(et.deviceId={ideal:"default"})}else nt.video=j.video?{deviceId:{ideal:"default"}}:!1;else nt.video=!1;return j.audio?typeof j.audio=="object"?(nt.audio=j.audio,(_e=(tt=nt.audio).deviceId)!==null&&_e!==void 0||(tt.deviceId={ideal:"default"})):nt.audio={deviceId:{ideal:"default"}}:nt.audio=!1,nt}function detectSilence(j){return __awaiter$1(this,arguments,void 0,function($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const et=getNewAudioContext();if(et){const tt=et.createAnalyser();tt.fftSize=2048;const nt=tt.frequencyBinCount,rt=new Uint8Array(nt);et.createMediaStreamSource(new MediaStream([$.mediaStreamTrack])).connect(tt),yield sleep$1(_e),tt.getByteTimeDomainData(rt);const st=rt.some(at=>at!==128&&at!==0);return et.close(),!st}return!1}()})}function getNewAudioContext(){var j;const $=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if($){const _e=new $({latencyHint:"interactive"});if(_e.state==="suspended"&&typeof window<"u"&&(!((j=window.document)===null||j===void 0)&&j.body)){const et=()=>__awaiter$1(this,void 0,void 0,function*(){var tt;try{_e.state==="suspended"&&(yield _e.resume())}catch(nt){console.warn("Error trying to auto-resume audio context",nt)}(tt=window.document.body)===null||tt===void 0||tt.removeEventListener("click",et)});window.document.body.addEventListener("click",et)}return _e}}function sourceToKind(j){return j===Track.Source.Microphone?"audioinput":j===Track.Source.Camera?"videoinput":void 0}function screenCaptureToDisplayMediaStreamOptions(j){var $,_e;let et=($=j.video)!==null&&$!==void 0?$:!0;return j.resolution&&j.resolution.width>0&&j.resolution.height>0&&(et=typeof et=="boolean"?{}:et,isSafari()?et=Object.assign(Object.assign({},et),{width:{max:j.resolution.width},height:{max:j.resolution.height},frameRate:j.resolution.frameRate}):et=Object.assign(Object.assign({},et),{width:{ideal:j.resolution.width},height:{ideal:j.resolution.height},frameRate:j.resolution.frameRate})),{audio:(_e=j.audio)!==null&&_e!==void 0?_e:!1,video:et,controller:j.controller,selfBrowserSurface:j.selfBrowserSurface,surfaceSwitching:j.surfaceSwitching,systemAudio:j.systemAudio,preferCurrentTab:j.preferCurrentTab}}function mimeTypeToVideoCodecString(j){return j.split("/")[1].toLowerCase()}function getTrackPublicationInfo(j){const $=[];return j.forEach(_e=>{_e.track!==void 0&&$.push(new TrackPublishedResponse({cid:_e.track.mediaStreamID,track:_e.trackInfo}))}),$}function getLogContextFromTrack(j){return"mediaStreamTrack"in j?{trackID:j.sid,source:j.source,muted:j.isMuted,enabled:j.mediaStreamTrack.enabled,kind:j.kind,streamID:j.mediaStreamID,streamTrackID:j.mediaStreamTrack.id}:{trackID:j.trackSid,enabled:j.isEnabled,muted:j.isMuted,trackInfo:Object.assign({mimeType:j.mimeType,name:j.trackName,encrypted:j.isEncrypted,kind:j.kind,source:j.source},j.track?getLogContextFromTrack(j.track):{})}}function supportsSynchronizationSources(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function diffAttributes(j,$){var _e;j===void 0&&(j={}),$===void 0&&($={});const et=[...Object.keys($),...Object.keys(j)],tt={};for(const nt of et)j[nt]!==$[nt]&&(tt[nt]=(_e=$[nt])!==null&&_e!==void 0?_e:"");return tt}function extractProcessorsFromOptions(j){const $=Object.assign({},j);let _e,et;return typeof $.audio=="object"&&$.audio.processor&&(_e=$.audio.processor,$.audio=Object.assign(Object.assign({},$.audio),{processor:void 0})),typeof $.video=="object"&&$.video.processor&&(et=$.video.processor,$.video=Object.assign(Object.assign({},$.video),{processor:void 0})),{audioProcessor:_e,videoProcessor:et,optionsWithoutProcessor:cloneDeep$2($)}}function getTrackSourceFromProto(j){switch(j){case TrackSource.CAMERA:return Track.Source.Camera;case TrackSource.MICROPHONE:return Track.Source.Microphone;case TrackSource.SCREEN_SHARE:return Track.Source.ScreenShare;case TrackSource.SCREEN_SHARE_AUDIO:return Track.Source.ScreenShareAudio;default:return Track.Source.Unknown}}class E2EEManager extends eventsExports.EventEmitter{constructor($){super(),this.onWorkerMessage=_e=>{var et,tt;const{kind:nt,data:rt}=_e.data;switch(nt){case"error":livekitLogger.error(rt.error.message),this.emit(EncryptionEvent.EncryptionError,rt.error);break;case"initAck":rt.enabled&&this.keyProvider.getKeys().forEach(it=>{this.postKey(it)});break;case"enable":if(rt.enabled&&this.keyProvider.getKeys().forEach(it=>{this.postKey(it)}),this.encryptionEnabled!==rt.enabled&&rt.participantIdentity===((et=this.room)===null||et===void 0?void 0:et.localParticipant.identity))this.emit(EncryptionEvent.ParticipantEncryptionStatusChanged,rt.enabled,this.room.localParticipant),this.encryptionEnabled=rt.enabled;else if(rt.participantIdentity){const it=(tt=this.room)===null||tt===void 0?void 0:tt.getParticipantByIdentity(rt.participantIdentity);if(!it)throw TypeError("couldn't set encryption status, participant not found".concat(rt.participantIdentity));this.emit(EncryptionEvent.ParticipantEncryptionStatusChanged,rt.enabled,it)}break;case"ratchetKey":this.keyProvider.emit(KeyProviderEvent.KeyRatcheted,rt.material,rt.keyIndex);break}},this.onWorkerError=_e=>{livekitLogger.error("e2ee worker encountered an error:",{error:_e.error}),this.emit(EncryptionEvent.EncryptionError,_e.error)},this.keyProvider=$.keyProvider,this.worker=$.worker,this.encryptionEnabled=!1}setup($){if(!isE2EESupported())throw new DeviceUnsupportedError("tried to setup end-to-end encryption on an unsupported browser");if(livekitLogger.info("setting up e2ee"),$!==this.room){this.room=$,this.setupEventListeners($,this.keyProvider);const _e={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:workerLogger.getLevel()}};this.worker&&(livekitLogger.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(_e))}}setParticipantCryptorEnabled($,_e){livekitLogger.debug("set e2ee to ".concat($," for participant ").concat(_e)),this.postEnable($,_e)}setSifTrailer($){!$||$.length===0?livekitLogger.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer($)}setupEngine($){$.on(EngineEvent.RTPVideoMapUpdate,_e=>{this.postRTPMap(_e)})}setupEventListeners($,_e){$.on(RoomEvent.TrackPublished,(et,tt)=>this.setParticipantCryptorEnabled(et.trackInfo.encryption!==Encryption_Type.NONE,tt.identity)),$.on(RoomEvent.ConnectionStateChanged,et=>{et===ConnectionState.Connected&&$.remoteParticipants.forEach(tt=>{tt.trackPublications.forEach(nt=>{this.setParticipantCryptorEnabled(nt.trackInfo.encryption!==Encryption_Type.NONE,tt.identity)})})}).on(RoomEvent.TrackUnsubscribed,(et,tt,nt)=>{var rt;const it={kind:"removeTransform",data:{participantIdentity:nt.identity,trackId:et.mediaStreamID}};(rt=this.worker)===null||rt===void 0||rt.postMessage(it)}).on(RoomEvent.TrackSubscribed,(et,tt,nt)=>{this.setupE2EEReceiver(et,nt.identity,tt.trackInfo)}).on(RoomEvent.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");_e.getKeys().forEach(et=>{this.postKey(et)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),$.localParticipant.on(ParticipantEvent.LocalTrackPublished,et=>__awaiter$1(this,void 0,void 0,function*(){this.setupE2EESender(et.track,et.track.sender)})),_e.on(KeyProviderEvent.SetKey,et=>this.postKey(et)).on(KeyProviderEvent.RatchetRequest,(et,tt)=>this.postRatchetRequest(et,tt,_e.getOptions().allowKeyExtraction))}postRatchetRequest($,_e,et){if(!this.worker)throw Error("could not ratchet key, worker is missing");const tt={kind:"ratchetRequest",data:{participantIdentity:$,keyIndex:_e,extractable:et}};this.worker.postMessage(tt)}postKey($){let{key:_e,participantIdentity:et,keyIndex:tt}=$;var nt;if(!this.worker)throw Error("could not set key, worker is missing");const rt={kind:"setKey",data:{participantIdentity:et,isPublisher:et===((nt=this.room)===null||nt===void 0?void 0:nt.localParticipant.identity),key:_e,keyIndex:tt}};this.worker.postMessage(rt)}postEnable($,_e){if(this.worker){const et={kind:"enable",data:{enabled:$,participantIdentity:_e}};this.worker.postMessage(et)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap($){var _e;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((_e=this.room)===null||_e===void 0)&&_e.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const et={kind:"setRTPMap",data:{map:$,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(et)}postSifTrailer($){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const _e={kind:"setSifTrailer",data:{trailer:$}};this.worker.postMessage(_e)}setupE2EEReceiver($,_e,et){if($.receiver){if(!(et!=null&&et.mimeType)||et.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver($.receiver,$.mediaStreamID,_e,$.kind==="video"?mimeTypeToVideoCodecString(et.mimeType):void 0)}}setupE2EESender($,_e){if(!isLocalTrack($)||!_e){_e||livekitLogger.warn("early return because sender is not ready");return}this.handleSender(_e,$.mediaStreamID,void 0)}handleReceiver($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){if(this.worker){if(isScriptTransformSupported()){const nt={kind:"decode",participantIdentity:et,trackId:_e,codec:tt};$.transform=new RTCRtpScriptTransform(this.worker,nt)}else{if(E2EE_FLAG in $&&tt){const st={kind:"updateCodec",data:{trackId:_e,codec:tt,participantIdentity:et}};this.worker.postMessage(st);return}let nt=$.writableStream,rt=$.readableStream;if(!nt||!rt){const st=$.createEncodedStreams();$.writableStream=st.writable,nt=st.writable,$.readableStream=st.readable,rt=st.readable}const it={kind:"decode",data:{readableStream:rt,writableStream:nt,trackId:_e,codec:tt,participantIdentity:et}};this.worker.postMessage(it,[rt,nt])}$[E2EE_FLAG]=!0}})}handleSender($,_e,et){var tt;if(!(E2EE_FLAG in $||!this.worker)){if(!(!((tt=this.room)===null||tt===void 0)&&tt.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(isScriptTransformSupported()){livekitLogger.info("initialize script transform");const nt={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:_e,codec:et};$.transform=new RTCRtpScriptTransform(this.worker,nt)}else{livekitLogger.info("initialize encoded streams");const nt=$.createEncodedStreams(),rt={kind:"encode",data:{readableStream:nt.readable,writableStream:nt.writable,codec:et,trackId:_e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(rt,[nt.readable,nt.writable])}$[E2EE_FLAG]=!0}}}const defaultId="default";class DeviceManager{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new DeviceManager),this.instance}get previousDevices(){return this._previousDevices}getDevices($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var nt;if(((nt=DeviceManager.userMediaPromiseMap)===null||nt===void 0?void 0:nt.size)>0){livekitLogger.debug("awaiting getUserMedia promise");try{_e?yield DeviceManager.userMediaPromiseMap.get(_e):yield Promise.all(DeviceManager.userMediaPromiseMap.values())}catch{livekitLogger.warn("error waiting for media permissons")}}let rt=yield navigator.mediaDevices.enumerateDevices();if(tt&&!(isSafari()&&et.hasDeviceInUse(_e))&&(rt.filter(st=>st.kind===_e).length===0||rt.some(st=>{const at=st.label==="",ot=_e?st.kind===_e:!0;return at&&ot}))){const st={video:_e!=="audioinput"&&_e!=="audiooutput",audio:_e!=="videoinput"&&{deviceId:{ideal:"default"}}},at=yield navigator.mediaDevices.getUserMedia(st);rt=yield navigator.mediaDevices.enumerateDevices(),at.getTracks().forEach(ot=>{ot.stop()})}return et._previousDevices=rt,_e&&(rt=rt.filter(it=>it.kind===_e)),rt}()})}normalizeDeviceId($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){if(_e!==defaultId)return _e;const tt=yield this.getDevices($),nt=tt.find(it=>it.deviceId===defaultId);if(!nt){livekitLogger.warn("could not reliably determine default device");return}const rt=tt.find(it=>it.deviceId!==defaultId&&it.groupId===(et??nt.groupId));if(!rt){livekitLogger.warn("could not reliably determine default device");return}return rt==null?void 0:rt.deviceId})}hasDeviceInUse($){return $?DeviceManager.userMediaPromiseMap.has($):DeviceManager.userMediaPromiseMap.size>0}}DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];DeviceManager.userMediaPromiseMap=new Map;var QueueTaskStatus;(function(j){j[j.WAITING=0]="WAITING",j[j.RUNNING=1]="RUNNING",j[j.COMPLETED=2]="COMPLETED"})(QueueTaskStatus||(QueueTaskStatus={}));class AsyncQueue{constructor(){this.pendingTasks=new Map,this.taskMutex=new _$1,this.nextTaskIndex=0}run($){return __awaiter$1(this,void 0,void 0,function*(){const _e={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:QueueTaskStatus.WAITING};this.pendingTasks.set(_e.id,_e);const et=yield this.taskMutex.lock();try{return _e.executedAt=Date.now(),_e.status=QueueTaskStatus.RUNNING,yield $()}finally{_e.status=QueueTaskStatus.COMPLETED,this.pendingTasks.delete(_e.id),et()}})}flush(){return __awaiter$1(this,void 0,void 0,function*(){return this.run(()=>__awaiter$1(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function createRtcUrl(j,$){const _e=new URL(toWebsocketUrl(j));return $.forEach((et,tt)=>{_e.searchParams.set(tt,et)}),appendUrlPath(_e,"rtc")}function createValidateUrl(j){const $=new URL(toHttpUrl(j));return appendUrlPath($,"validate")}function ensureTrailingSlash(j){return j.endsWith("/")?j:"".concat(j,"/")}function appendUrlPath(j,$){return j.pathname="".concat(ensureTrailingSlash(j.pathname)).concat($),j.toString()}const passThroughQueueSignals=["syncState","trickle","offer","answer","simulate","leave"];function canPassThroughQueue(j){const $=passThroughQueueSignals.indexOf(j.case)>=0;return livekitLogger.trace("request allowed to bypass queue:",{canPass:$,req:j}),$}var SignalConnectionState;(function(j){j[j.CONNECTING=0]="CONNECTING",j[j.CONNECTED=1]="CONNECTED",j[j.RECONNECTING=2]="RECONNECTING",j[j.DISCONNECTING=3]="DISCONNECTING",j[j.DISCONNECTED=4]="DISCONNECTED"})(SignalConnectionState||(SignalConnectionState={}));class SignalClient{get currentState(){return this.state}get isDisconnected(){return this.state===SignalConnectionState.DISCONNECTING||this.state===SignalConnectionState.DISCONNECTED}get isEstablishingConnection(){return this.state===SignalConnectionState.CONNECTING||this.state===SignalConnectionState.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var et;this.rtt=0,this.state=SignalConnectionState.DISCONNECTED,this.log=livekitLogger,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=getLogger$1((et=_e.loggerName)!==null&&et!==void 0?et:LoggerNames.Signal),this.loggerContextCb=_e.loggerContextCb,this.useJSON=$,this.requestQueue=new AsyncQueue,this.queuedRequests=[],this.closingLock=new _$1,this.connectionLock=new _$1,this.state=SignalConnectionState.DISCONNECTED}get logContext(){var $,_e;return(_e=($=this.loggerContextCb)===null||$===void 0?void 0:$.call(this))!==null&&_e!==void 0?_e:{}}join($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){return this.state=SignalConnectionState.CONNECTING,this.options=et,yield this.connect($,_e,et,tt)})}reconnect($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=SignalConnectionState.RECONNECTING,this.clearPingInterval(),yield this.connect($,_e,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:et,reconnectReason:tt}))})}connect($,_e,et,tt){this.connectOptions=et;const nt=getClientInfo(),rt=createConnectionParams(_e,nt,et),it=createRtcUrl($,rt),st=createValidateUrl(it);return new Promise((at,ot)=>__awaiter$1(this,void 0,void 0,function*(){const ct=yield this.connectionLock.lock();try{const lt=()=>__awaiter$1(this,void 0,void 0,function*(){this.close(),clearTimeout(ut),ot(new ConnectionError("room connection has been cancelled (signal)",ConnectionErrorReason.Cancelled))}),ut=setTimeout(()=>{this.close(),ot(new ConnectionError("room connection has timed out (signal)",ConnectionErrorReason.ServerUnreachable))},et.websocketTimeout);tt!=null&&tt.aborted&&lt(),tt==null||tt.addEventListener("abort",lt);const pt=new URL(it);pt.searchParams.has("access_token")&&pt.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(pt),Object.assign({reconnect:et.reconnect,reconnectReason:et.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(it),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(ut)},this.ws.onerror=dt=>__awaiter$1(this,void 0,void 0,function*(){if(this.state!==SignalConnectionState.CONNECTED){this.state=SignalConnectionState.DISCONNECTED,clearTimeout(ut);try{const ht=yield fetch(st);if(ht.status.toFixed(0).startsWith("4")){const ft=yield ht.text();ot(new ConnectionError(ft,ConnectionErrorReason.NotAllowed,ht.status))}else ot(new ConnectionError("Encountered unknown websocket error during connection: ".concat(dt.toString()),ConnectionErrorReason.InternalError,ht.status))}catch(ht){ot(new ConnectionError(ht instanceof Error?ht.message:"server was not reachable",ConnectionErrorReason.ServerUnreachable))}return}this.handleWSError(dt)}),this.ws.onmessage=dt=>__awaiter$1(this,void 0,void 0,function*(){var ht,ft,mt;let gt;if(typeof dt.data=="string"){const yt=JSON.parse(dt.data);gt=SignalResponse.fromJson(yt,{ignoreUnknownFields:!0})}else if(dt.data instanceof ArrayBuffer)gt=SignalResponse.fromBinary(new Uint8Array(dt.data));else{this.log.error("could not decode websocket message: ".concat(typeof dt.data),this.logContext);return}if(this.state!==SignalConnectionState.CONNECTED){let yt=!1;if(((ht=gt.message)===null||ht===void 0?void 0:ht.case)==="join"?(this.state=SignalConnectionState.CONNECTED,tt==null||tt.removeEventListener("abort",lt),this.pingTimeoutDuration=gt.message.value.pingTimeout,this.pingIntervalDuration=gt.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),at(gt.message.value)):this.state===SignalConnectionState.RECONNECTING&&gt.message.case!=="leave"?(this.state=SignalConnectionState.CONNECTED,tt==null||tt.removeEventListener("abort",lt),this.startPingInterval(),((ft=gt.message)===null||ft===void 0?void 0:ft.case)==="reconnect"?at(gt.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),at(void 0),yt=!0)):this.isEstablishingConnection&&gt.message.case==="leave"?ot(new ConnectionError("Received leave request while trying to (re)connect",ConnectionErrorReason.LeaveRequest,void 0,gt.message.value.reason)):et.reconnect||ot(new ConnectionError("did not receive join response, got ".concat((mt=gt.message)===null||mt===void 0?void 0:mt.case," instead"),ConnectionErrorReason.InternalError)),!yt)return}this.signalLatency&&(yield sleep$1(this.signalLatency)),this.handleSignalResponse(gt)}),this.ws.onclose=dt=>{this.isEstablishingConnection&&ot(new ConnectionError("Websocket got closed during a (re)connection attempt",ConnectionErrorReason.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:dt.reason,code:dt.code,wasClean:dt.wasClean,state:this.state})),this.handleOnClose(dt.reason)}}finally{ct()}}))}close(){return __awaiter$1(this,arguments,void 0,function(){var $=this;let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const et=yield $.closingLock.lock();try{if($.clearPingInterval(),_e&&($.state=SignalConnectionState.DISCONNECTING),$.ws){$.ws.onmessage=null,$.ws.onopen=null,$.ws.onclose=null;const tt=new Promise(nt=>{$.ws?$.ws.onclose=()=>{nt()}:nt()});$.ws.readyState<$.ws.CLOSING&&($.ws.close(),yield Promise.race([tt,sleep$1(250)])),$.ws=void 0}}finally{_e&&($.state=SignalConnectionState.DISCONNECTED),et()}}()})}sendOffer($){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:$.sdp})),this.sendRequest({case:"offer",value:toProtoSessionDescription($)})}sendAnswer($){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:$.sdp})),this.sendRequest({case:"answer",value:toProtoSessionDescription($)})}sendIceCandidate($,_e){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:$})),this.sendRequest({case:"trickle",value:new TrickleRequest({candidateInit:JSON.stringify($),target:_e})})}sendMuteTrack($,_e){return this.sendRequest({case:"mute",value:new MuteTrackRequest({sid:$,muted:_e})})}sendAddTrack($){return this.sendRequest({case:"addTrack",value:$})}sendUpdateLocalMetadata($,_e){return __awaiter$1(this,arguments,void 0,function(et,tt){var nt=this;let rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const it=nt.getNextRequestId();return yield nt.sendRequest({case:"updateMetadata",value:new UpdateParticipantMetadata({requestId:it,metadata:et,name:tt,attributes:rt})}),it}()})}sendUpdateTrackSettings($){this.sendRequest({case:"trackSetting",value:$})}sendUpdateSubscription($){return this.sendRequest({case:"subscription",value:$})}sendSyncState($){return this.sendRequest({case:"syncState",value:$})}sendUpdateVideoLayers($,_e){return this.sendRequest({case:"updateLayers",value:new UpdateVideoLayers({trackSid:$,layers:_e})})}sendUpdateSubscriptionPermissions($,_e){return this.sendRequest({case:"subscriptionPermission",value:new SubscriptionPermission({allParticipants:$,trackPermissions:_e})})}sendSimulateScenario($){return this.sendRequest({case:"simulate",value:$})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:protoInt64.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Ping({timestamp:protoInt64.parse(Date.now()),rtt:protoInt64.parse(this.rtt)})})])}sendUpdateLocalAudioTrack($,_e){return this.sendRequest({case:"updateAudioTrack",value:new UpdateLocalAudioTrack({trackSid:$,features:_e})})}sendLeave(){return this.sendRequest({case:"leave",value:new LeaveRequest({reason:DisconnectReason.CLIENT_INITIATED,action:LeaveRequest_Action.DISCONNECT})})}sendRequest($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!tt&&!canPassThroughQueue(_e)&&et.state===SignalConnectionState.RECONNECTING){et.queuedRequests.push(()=>__awaiter$1(et,void 0,void 0,function*(){yield this.sendRequest(_e,!0)}));return}if(tt||(yield et.requestQueue.flush()),et.signalLatency&&(yield sleep$1(et.signalLatency)),!et.ws||et.ws.readyState!==et.ws.OPEN){et.log.error("cannot send signal request before connected, type: ".concat(_e==null?void 0:_e.case),et.logContext);return}const rt=new SignalRequest({message:_e});try{et.useJSON?et.ws.send(rt.toJsonString()):et.ws.send(rt.toBinary())}catch(it){et.log.error("error sending signal message",Object.assign(Object.assign({},et.logContext),{error:it}))}}()})}handleSignalResponse($){var _e,et;const tt=$.message;if(tt==null){this.log.debug("received unsupported message",this.logContext);return}let nt=!1;if(tt.case==="answer"){const rt=fromProtoSessionDescription(tt.value);this.onAnswer&&this.onAnswer(rt)}else if(tt.case==="offer"){const rt=fromProtoSessionDescription(tt.value);this.onOffer&&this.onOffer(rt)}else if(tt.case==="trickle"){const rt=JSON.parse(tt.value.candidateInit);this.onTrickle&&this.onTrickle(rt,tt.value.target)}else tt.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((_e=tt.value.participants)!==null&&_e!==void 0?_e:[]):tt.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(tt.value):tt.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((et=tt.value.speakers)!==null&&et!==void 0?et:[]):tt.case==="leave"?this.onLeave&&this.onLeave(tt.value):tt.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(tt.value.sid,tt.value.muted):tt.case==="roomUpdate"?this.onRoomUpdate&&tt.value.room&&this.onRoomUpdate(tt.value.room):tt.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(tt.value):tt.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(tt.value):tt.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(tt.value):tt.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(tt.value):tt.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(tt.value):tt.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(tt.value):tt.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(tt.value):tt.case==="pong"||(tt.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(tt.value.lastPingTimestamp.toString()),this.resetPingTimeout(),nt=!0):tt.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(tt.value):tt.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(tt.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:tt.case})));nt||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const $=this.queuedRequests.shift();$&&this.requestQueue.run($)}}handleOnClose($){return __awaiter$1(this,void 0,void 0,function*(){if(this.state===SignalConnectionState.DISCONNECTED)return;const _e=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat($),Object.assign(Object.assign({},this.logContext),{reason:$})),_e&&_e($)})}handleWSError($){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:$}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=CriticalTimers.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&CriticalTimers.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=CriticalTimers.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&CriticalTimers.clearInterval(this.pingInterval)}}function fromProtoSessionDescription(j){const $={type:"offer",sdp:j.sdp};switch(j.type){case"answer":case"offer":case"pranswer":case"rollback":$.type=j.type;break}return $}function toProtoSessionDescription(j){return new SessionDescription({sdp:j.sdp,type:j.type})}function createConnectionParams(j,$,_e){var et;const tt=new URLSearchParams;return tt.set("access_token",j),_e.reconnect&&(tt.set("reconnect","1"),_e.sid&&tt.set("sid",_e.sid)),tt.set("auto_subscribe",_e.autoSubscribe?"1":"0"),tt.set("sdk",isReactNative$1()?"reactnative":"js"),tt.set("version",$.version),tt.set("protocol",$.protocol.toString()),$.deviceModel&&tt.set("device_model",$.deviceModel),$.os&&tt.set("os",$.os),$.osVersion&&tt.set("os_version",$.osVersion),$.browser&&tt.set("browser",$.browser),$.browserVersion&&tt.set("browser_version",$.browserVersion),_e.adaptiveStream&&tt.set("adaptive_stream","1"),_e.reconnectReason&&tt.set("reconnect_reason",_e.reconnectReason.toString()),!((et=navigator.connection)===null||et===void 0)&&et.type&&tt.set("network",navigator.connection.type),tt}var lib={},parser={},grammar={exports:{}},hasRequiredGrammar;function requireGrammar(){if(hasRequiredGrammar)return grammar.exports;hasRequiredGrammar=1;var j=grammar.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function($){return $.encoding?"rtpmap:%d %s/%s/%s":$.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function($){return $.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function($){return $.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function($){return"extmap:%d"+($.direction?"/%s":"%v")+($["encrypt-uri"]?" %s":"%v")+" %s"+($.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function($){return $.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function($){var _e="candidate:%s %d %s %d %s %d typ %s";return _e+=$.raddr!=null?" raddr %s rport %d":"%v%v",_e+=$.tcptype!=null?" tcptype %s":"%v",$.generation!=null&&(_e+=" generation %d"),_e+=$["network-id"]!=null?" network-id %d":"%v",_e+=$["network-cost"]!=null?" network-cost %d":"%v",_e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function($){var _e="ssrc:%d";return $.attribute!=null&&(_e+=" %s",$.value!=null&&(_e+=":%s")),_e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function($){return $.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function($){return $.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function($){return"imageattr:%s %s %s"+($.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function($){return"simulcast:%s %s"+($.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function($){return"ts-refclk:%s"+($.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function($){var _e="mediaclk:";return _e+=$.id!=null?"id=%s %s":"%v%s",_e+=$.mediaClockValue!=null?"=%s":"",_e+=$.rateNumerator!=null?" rate=%s":"",_e+=$.rateDenominator!=null?"/%s":"",_e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(j).forEach(function($){var _e=j[$];_e.forEach(function(et){et.reg||(et.reg=/(.*)/),et.format||(et.format="%s")})}),grammar.exports}var hasRequiredParser;function requireParser(){return hasRequiredParser||(hasRequiredParser=1,function(j){var $=function(it){return String(Number(it))===it?Number(it):it},_e=function(it,st,at,ot){if(ot&&!at)st[ot]=$(it[1]);else for(var ct=0;ct<at.length;ct+=1)it[ct+1]!=null&&(st[at[ct]]=$(it[ct+1]))},et=function(it,st,at){var ot=it.name&&it.names;it.push&&!st[it.push]?st[it.push]=[]:ot&&!st[it.name]&&(st[it.name]={});var ct=it.push?{}:ot?st[it.name]:st;_e(at.match(it.reg),ct,it.names,it.name),it.push&&st[it.push].push(ct)},tt=requireGrammar(),nt=RegExp.prototype.test.bind(/^([a-z])=(.*)/);j.parse=function(it){var st={},at=[],ot=st;return it.split(/(\r\n|\r|\n)/).filter(nt).forEach(function(ct){var lt=ct[0],ut=ct.slice(2);lt==="m"&&(at.push({rtp:[],fmtp:[]}),ot=at[at.length-1]);for(var pt=0;pt<(tt[lt]||[]).length;pt+=1){var dt=tt[lt][pt];if(dt.reg.test(ut))return et(dt,ot,ut)}}),st.media=at,st};var rt=function(it,st){var at=st.split(/=(.+)/,2);return at.length===2?it[at[0]]=$(at[1]):at.length===1&&st.length>1&&(it[at[0]]=void 0),it};j.parseParams=function(it){return it.split(/;\s?/).reduce(rt,{})},j.parseFmtpConfig=j.parseParams,j.parsePayloads=function(it){return it.toString().split(" ").map(Number)},j.parseRemoteCandidates=function(it){for(var st=[],at=it.split(" ").map($),ot=0;ot<at.length;ot+=3)st.push({component:at[ot],ip:at[ot+1],port:at[ot+2]});return st},j.parseImageAttributes=function(it){return it.split(" ").map(function(st){return st.substring(1,st.length-1).split(",").reduce(rt,{})})},j.parseSimulcastStreamList=function(it){return it.split(";").map(function(st){return st.split(",").map(function(at){var ot,ct=!1;return at[0]!=="~"?ot=$(at):(ot=$(at.substring(1,at.length)),ct=!0),{scid:ot,paused:ct}})})}}(parser)),parser}var writer$1,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer$1;hasRequiredWriter=1;var j=requireGrammar(),$=/%[sdv%]/g,_e=function(rt){var it=1,st=arguments,at=st.length;return rt.replace($,function(ot){if(it>=at)return ot;var ct=st[it];switch(it+=1,ot){case"%%":return"%";case"%s":return String(ct);case"%d":return Number(ct);case"%v":return""}})},et=function(rt,it,st){var at=it.format instanceof Function?it.format(it.push?st:st[it.name]):it.format,ot=[rt+"="+at];if(it.names)for(var ct=0;ct<it.names.length;ct+=1){var lt=it.names[ct];it.name?ot.push(st[it.name][lt]):ot.push(st[it.names[ct]])}else ot.push(st[it.name]);return _e.apply(null,ot)},tt=["v","o","s","i","u","e","p","c","b","t","r","z","a"],nt=["i","c","b","a"];return writer$1=function(rt,it){it=it||{},rt.version==null&&(rt.version=0),rt.name==null&&(rt.name=" "),rt.media.forEach(function(ct){ct.payloads==null&&(ct.payloads="")});var st=it.outerOrder||tt,at=it.innerOrder||nt,ot=[];return st.forEach(function(ct){j[ct].forEach(function(lt){lt.name in rt&&rt[lt.name]!=null?ot.push(et(ct,lt,rt)):lt.push in rt&&rt[lt.push]!=null&&rt[lt.push].forEach(function(ut){ot.push(et(ct,lt,ut))})})}),rt.media.forEach(function(ct){ot.push(et("m",j.m[0],ct)),at.forEach(function(lt){j[lt].forEach(function(ut){ut.name in ct&&ct[ut.name]!=null?ot.push(et(lt,ut,ct)):ut.push in ct&&ct[ut.push]!=null&&ct[ut.push].forEach(function(pt){ot.push(et(lt,ut,pt))})})})}),ot.join(`\r
`)+`\r
`},writer$1}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1;var j=requireParser(),$=requireWriter(),_e=requireGrammar();return lib.grammar=_e,lib.write=$,lib.parse=j.parse,lib.parseParams=j.parseParams,lib.parseFmtpConfig=j.parseFmtpConfig,lib.parsePayloads=j.parsePayloads,lib.parseRemoteCandidates=j.parseRemoteCandidates,lib.parseImageAttributes=j.parseImageAttributes,lib.parseSimulcastStreamList=j.parseSimulcastStreamList,lib}var libExports=requireLib();function r$3(j,$,_e){var et,tt,nt;$===void 0&&($=50),_e===void 0&&(_e={});var rt=(et=_e.isImmediate)!=null&&et,it=(tt=_e.callback)!=null&&tt,st=_e.maxWait,at=Date.now(),ot=[];function ct(){if(st!==void 0){var ut=Date.now()-at;if(ut+$>=st)return st-ut}return $}var lt=function(){var ut=[].slice.call(arguments),pt=this;return new Promise(function(dt,ht){var ft=rt&&nt===void 0;if(nt!==void 0&&clearTimeout(nt),nt=setTimeout(function(){if(nt=void 0,at=Date.now(),!rt){var gt=j.apply(pt,ut);it&&it(gt),ot.forEach(function(yt){return(0,yt.resolve)(gt)}),ot=[]}},ct()),ft){var mt=j.apply(pt,ut);return it&&it(mt),dt(mt)}ot.push({resolve:dt,reject:ht})})};return lt.cancel=function(ut){nt!==void 0&&clearTimeout(nt),ot.forEach(function(pt){return(0,pt.reject)(ut)}),ot=[]},lt}const startBitrateForSVC=.7,debounceInterval=20,PCEvents={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class PCTransport extends eventsExports.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var et;super(),this.log=livekitLogger,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=r$3(tt=>__awaiter$1(this,void 0,void 0,function*(){this.emit(PCEvents.NegotiationStarted);try{yield this.createAndSendOffer()}catch(nt){if(tt)tt(nt);else throw nt}}),debounceInterval),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=getLogger$1((et=_e.loggerName)!==null&&et!==void 0?et:LoggerNames.PCTransport),this.loggerOptions=_e,this.config=$,this._pc=this.createPC()}createPC(){const $=new RTCPeerConnection(this.config);return $.onicecandidate=_e=>{var et;_e.candidate&&((et=this.onIceCandidate)===null||et===void 0||et.call(this,_e.candidate))},$.onicecandidateerror=_e=>{var et;(et=this.onIceCandidateError)===null||et===void 0||et.call(this,_e)},$.oniceconnectionstatechange=()=>{var _e;(_e=this.onIceConnectionStateChange)===null||_e===void 0||_e.call(this,$.iceConnectionState)},$.onsignalingstatechange=()=>{var _e;(_e=this.onSignalingStatechange)===null||_e===void 0||_e.call(this,$.signalingState)},$.onconnectionstatechange=()=>{var _e;(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,$.connectionState)},$.ondatachannel=_e=>{var et;(et=this.onDataChannel)===null||et===void 0||et.call(this,_e)},$.ontrack=_e=>{var et;(et=this.onTrack)===null||et===void 0||et.call(this,_e)},$}get logContext(){var $,_e;return Object.assign({},(_e=($=this.loggerOptions).loggerContextCb)===null||_e===void 0?void 0:_e.call($))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate($){return __awaiter$1(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate($);this.pendingCandidates.push($)})}setRemoteDescription($){return __awaiter$1(this,void 0,void 0,function*(){var _e;let et;if($.type==="offer"){let{stereoMids:tt,nackMids:nt}=extractStereoAndNackAudioFromOffer($);this.remoteStereoMids=tt,this.remoteNackMids=nt}else if($.type==="answer"){const tt=libExports.parse((_e=$.sdp)!==null&&_e!==void 0?_e:"");tt.media.forEach(nt=>{nt.type==="audio"&&this.trackBitrates.some(rt=>{if(!rt.transceiver||nt.mid!=rt.transceiver.mid)return!1;let it=0;if(nt.rtp.some(at=>at.codec.toUpperCase()===rt.codec.toUpperCase()?(it=at.payload,!0):!1),it===0)return!0;let st=!1;for(const at of nt.fmtp)if(at.payload===it){at.config=at.config.split(";").filter(ot=>!ot.includes("maxaveragebitrate")).join(";"),rt.maxbr>0&&(at.config+=";maxaveragebitrate=".concat(rt.maxbr*1e3)),st=!0;break}return st||rt.maxbr>0&&nt.fmtp.push({payload:it,config:"maxaveragebitrate=".concat(rt.maxbr*1e3)}),!0})}),et=libExports.write(tt)}yield this.setMungedSDP($,et,!0),this.pendingCandidates.forEach(tt=>{this.pc.addIceCandidate(tt)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):$.type==="answer"&&(this.emit(PCEvents.NegotiationComplete),$.sdp&&libExports.parse($.sdp).media.forEach(nt=>{nt.type==="video"&&this.emit(PCEvents.RTPVideoPayloadTypes,nt.rtp)}))})}createAndSendOffer($){return __awaiter$1(this,void 0,void 0,function*(){var _e;if(this.onOffer===void 0)return;if($!=null&&$.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const nt=this._pc.remoteDescription;if($!=null&&$.iceRestart&&nt)yield this._pc.setRemoteDescription(nt);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const et=yield this.pc.createOffer($);this.log.debug("original offer",Object.assign({sdp:et.sdp},this.logContext));const tt=libExports.parse((_e=et.sdp)!==null&&_e!==void 0?_e:"");tt.media.forEach(nt=>{ensureIPAddrMatchVersion(nt),nt.type==="audio"?ensureAudioNackAndStereo(nt,[],[]):nt.type==="video"&&this.trackBitrates.some(rt=>{if(!nt.msid||!rt.cid||!nt.msid.includes(rt.cid))return!1;let it=0;if(nt.rtp.some(at=>at.codec.toUpperCase()===rt.codec.toUpperCase()?(it=at.payload,!0):!1),it===0||(isSVCCodec(rt.codec)&&this.ensureVideoDDExtensionForSVC(nt,tt),rt.codec!=="av1"))return!0;const st=Math.round(rt.maxbr*startBitrateForSVC);for(const at of nt.fmtp)if(at.payload===it){at.config.includes("x-google-start-bitrate")||(at.config+=";x-google-start-bitrate=".concat(st));break}return!0})}),yield this.setMungedSDP(et,libExports.write(tt)),this.onOffer(et)})}createAndSetAnswer(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.pc.createAnswer(),et=libExports.parse(($=_e.sdp)!==null&&$!==void 0?$:"");return et.media.forEach(tt=>{ensureIPAddrMatchVersion(tt),tt.type==="audio"&&ensureAudioNackAndStereo(tt,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(_e,libExports.write(et)),_e})}createDataChannel($,_e){return this.pc.createDataChannel($,_e)}addTransceiver($,_e){return this.pc.addTransceiver($,_e)}addTrack($){if(!this._pc)throw new UnexpectedConnectionState("PC closed, cannot add track");return this._pc.addTrack($)}setTrackCodecBitrate($){this.trackBitrates.push($)}setConfiguration($){var _e;if(!this._pc)throw new UnexpectedConnectionState("PC closed, cannot configure");return(_e=this._pc)===null||_e===void 0?void 0:_e.setConfiguration($)}canRemoveTrack(){var $;return!!(!(($=this._pc)===null||$===void 0)&&$.removeTrack)}removeTrack($){var _e;return(_e=this._pc)===null||_e===void 0?void 0:_e.removeTrack($)}getConnectionState(){var $,_e;return(_e=($=this._pc)===null||$===void 0?void 0:$.connectionState)!==null&&_e!==void 0?_e:"closed"}getICEConnectionState(){var $,_e;return(_e=($=this._pc)===null||$===void 0?void 0:$.iceConnectionState)!==null&&_e!==void 0?_e:"closed"}getSignallingState(){var $,_e;return(_e=($=this._pc)===null||$===void 0?void 0:$.signalingState)!==null&&_e!==void 0?_e:"closed"}getTransceivers(){var $,_e;return(_e=($=this._pc)===null||$===void 0?void 0:$.getTransceivers())!==null&&_e!==void 0?_e:[]}getSenders(){var $,_e;return(_e=($=this._pc)===null||$===void 0?void 0:$.getSenders())!==null&&_e!==void 0?_e:[]}getLocalDescription(){var $;return($=this._pc)===null||$===void 0?void 0:$.localDescription}getRemoteDescription(){var $;return($=this.pc)===null||$===void 0?void 0:$.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return __awaiter$1(this,void 0,void 0,function*(){var $;if(!this._pc)return;let _e="";const et=new Map,tt=new Map;if((yield this._pc.getStats()).forEach(it=>{switch(it.type){case"transport":_e=it.selectedCandidatePairId;break;case"candidate-pair":_e===""&&it.selected&&(_e=it.id),et.set(it.id,it);break;case"remote-candidate":tt.set(it.id,"".concat(it.address,":").concat(it.port));break}}),_e==="")return;const rt=($=et.get(_e))===null||$===void 0?void 0:$.remoteCandidateId;if(rt!==void 0)return tt.get(rt)})}setMungedSDP($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){if(_e){const tt=$.sdp;$.sdp=_e;try{this.log.debug("setting munged ".concat(et?"remote":"local"," description"),this.logContext),et?yield this.pc.setRemoteDescription($):yield this.pc.setLocalDescription($);return}catch(nt){this.log.warn("not able to set ".concat($.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:nt,sdp:_e})),$.sdp=tt}}try{et?yield this.pc.setRemoteDescription($):yield this.pc.setLocalDescription($)}catch(tt){let nt="unknown error";tt instanceof Error?nt=tt.message:typeof tt=="string"&&(nt=tt);const rt={error:nt,sdp:$.sdp};throw!et&&this.pc.remoteDescription&&(rt.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat($.type),Object.assign(Object.assign({},this.logContext),{fields:rt})),new NegotiationError(nt)}})}ensureVideoDDExtensionForSVC($,_e){var et,tt;if(!((et=$.ext)===null||et===void 0?void 0:et.some(rt=>rt.uri===ddExtensionURI))){if(this.ddExtID===0){let rt=0;_e.media.forEach(it=>{var st;it.type==="video"&&((st=it.ext)===null||st===void 0||st.forEach(at=>{at.value>rt&&(rt=at.value)}))}),this.ddExtID=rt+1}(tt=$.ext)===null||tt===void 0||tt.push({value:this.ddExtID,uri:ddExtensionURI})}}}function ensureAudioNackAndStereo(j,$,_e){let et=0;j.rtp.some(tt=>tt.codec==="opus"?(et=tt.payload,!0):!1),et>0&&(j.rtcpFb||(j.rtcpFb=[]),_e.includes(j.mid)&&!j.rtcpFb.some(tt=>tt.payload===et&&tt.type==="nack")&&j.rtcpFb.push({payload:et,type:"nack"}),$.includes(j.mid)&&j.fmtp.some(tt=>tt.payload===et?(tt.config.includes("stereo=1")||(tt.config+=";stereo=1"),!0):!1))}function extractStereoAndNackAudioFromOffer(j){var $;const _e=[],et=[],tt=libExports.parse(($=j.sdp)!==null&&$!==void 0?$:"");let nt=0;return tt.media.forEach(rt=>{var it;rt.type==="audio"&&(rt.rtp.some(st=>st.codec==="opus"?(nt=st.payload,!0):!1),!((it=rt.rtcpFb)===null||it===void 0)&&it.some(st=>st.payload===nt&&st.type==="nack")&&et.push(rt.mid),rt.fmtp.some(st=>st.payload===nt?(st.config.includes("sprop-stereo=1")&&_e.push(rt.mid),!0):!1))}),{stereoMids:_e,nackMids:et}}function ensureIPAddrMatchVersion(j){if(j.connection){const $=j.connection.ip.indexOf(":")>=0;(j.connection.version===4&&$||j.connection.version===6&&!$)&&(j.connection.ip="0.0.0.0",j.connection.version=4)}}const defaultVideoCodec="vp8",publishDefaults={audioPreset:AudioPresets.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ScreenSharePresets.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:defaultVideoCodec,backupCodec:!0},audioDefaults={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},videoDefaults={deviceId:{ideal:"default"},resolution:VideoPresets.h720.resolution},roomOptionDefaults={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new DefaultReconnectPolicy,disconnectOnPageLeave:!0,webAudioMix:!1},roomConnectOptionDefaults={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var PCTransportState;(function(j){j[j.NEW=0]="NEW",j[j.CONNECTING=1]="CONNECTING",j[j.CONNECTED=2]="CONNECTED",j[j.FAILED=3]="FAILED",j[j.CLOSING=4]="CLOSING",j[j.CLOSED=5]="CLOSED"})(PCTransportState||(PCTransportState={}));class PCTransportManager{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor($,_e,et){var tt;this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.log=livekitLogger,this.updateState=()=>{var nt;const rt=this.state,it=this.requiredTransports.map(st=>st.getConnectionState());it.every(st=>st==="connected")?this.state=PCTransportState.CONNECTED:it.some(st=>st==="failed")?this.state=PCTransportState.FAILED:it.some(st=>st==="connecting")?this.state=PCTransportState.CONNECTING:it.every(st=>st==="closed")?this.state=PCTransportState.CLOSED:it.some(st=>st==="closed")?this.state=PCTransportState.CLOSING:it.every(st=>st==="new")&&(this.state=PCTransportState.NEW),rt!==this.state&&(this.log.debug("pc state change: from ".concat(PCTransportState[rt]," to ").concat(PCTransportState[this.state]),this.logContext),(nt=this.onStateChange)===null||nt===void 0||nt.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=getLogger$1((tt=et.loggerName)!==null&&tt!==void 0?tt:LoggerNames.PCManager),this.loggerOptions=et,this.isPublisherConnectionRequired=!_e,this.isSubscriberConnectionRequired=_e,this.publisher=new PCTransport($,et),this.subscriber=new PCTransport($,et),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=nt=>{var rt;(rt=this.onIceCandidate)===null||rt===void 0||rt.call(this,nt,SignalTarget.PUBLISHER)},this.subscriber.onIceCandidate=nt=>{var rt;(rt=this.onIceCandidate)===null||rt===void 0||rt.call(this,nt,SignalTarget.SUBSCRIBER)},this.subscriber.onDataChannel=nt=>{var rt;(rt=this.onDataChannel)===null||rt===void 0||rt.call(this,nt)},this.subscriber.onTrack=nt=>{var rt;(rt=this.onTrack)===null||rt===void 0||rt.call(this,nt)},this.publisher.onOffer=nt=>{var rt;(rt=this.onPublisherOffer)===null||rt===void 0||rt.call(this,nt)},this.state=PCTransportState.NEW,this.connectionLock=new _$1,this.remoteOfferLock=new _$1}get logContext(){var $,_e;return Object.assign({},(_e=($=this.loggerOptions).loggerContextCb)===null||_e===void 0?void 0:_e.call($))}requirePublisher(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=$,this.updateState()}requireSubscriber(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=$,this.updateState()}createAndSendPublisherOffer($){return this.publisher.createAndSendOffer($)}setPublisherAnswer($){return this.publisher.setRemoteDescription($)}removeTrack($){return this.publisher.removeTrack($)}close(){return __awaiter$1(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const $=this.publisher;for(const _e of $.getSenders())try{$.canRemoveTrack()&&$.removeTrack(_e)}catch(et){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:et}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return __awaiter$1(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate($,_e){return __awaiter$1(this,void 0,void 0,function*(){_e===SignalTarget.PUBLISHER?yield this.publisher.addIceCandidate($):yield this.subscriber.addIceCandidate($)})}createSubscriberAnswerFromOffer($){return __awaiter$1(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:$.type,sdp:$.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const _e=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription($),yield this.subscriber.createAndSetAnswer()}finally{_e()}})}updateConfiguration($,_e){this.publisher.setConfiguration($),this.subscriber.setConfiguration($),_e&&this.triggerIceRestart()}ensurePCTransportConnection($,_e){return __awaiter$1(this,void 0,void 0,function*(){var et;const tt=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((et=this.requiredTransports)===null||et===void 0?void 0:et.map(nt=>this.ensureTransportConnected(nt,$,_e)))}finally{tt()}})}negotiate($){return __awaiter$1(this,void 0,void 0,function*(){return new Promise((_e,et)=>__awaiter$1(this,void 0,void 0,function*(){const tt=setTimeout(()=>{et("negotiation timed out")},this.peerConnectionTimeout),nt=()=>{clearTimeout(tt),et("negotiation aborted")};$.signal.addEventListener("abort",nt),this.publisher.once(PCEvents.NegotiationStarted,()=>{$.signal.aborted||this.publisher.once(PCEvents.NegotiationComplete,()=>{clearTimeout(tt),_e()})}),yield this.publisher.negotiate(rt=>{clearTimeout(tt),et(rt)})}))})}addPublisherTransceiver($,_e){return this.publisher.addTransceiver($,_e)}addPublisherTrack($){return this.publisher.addTrack($)}createPublisherDataChannel($,_e){return this.publisher.createDataChannel($,_e)}getConnectedAddress($){return $===SignalTarget.PUBLISHER?this.publisher.getConnectedAddress():$===SignalTarget.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const $=[];return this.isPublisherConnectionRequired&&$.push(this.publisher),this.isSubscriberConnectionRequired&&$.push(this.subscriber),$}ensureTransportConnected($,_e){return __awaiter$1(this,arguments,void 0,function(et,tt){var nt=this;let rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(et.getConnectionState()!=="connected")return new Promise((st,at)=>__awaiter$1(nt,void 0,void 0,function*(){const ot=()=>{this.log.warn("abort transport connection",this.logContext),CriticalTimers.clearTimeout(ct),at(new ConnectionError("room connection has been cancelled",ConnectionErrorReason.Cancelled))};tt!=null&&tt.signal.aborted&&ot(),tt==null||tt.signal.addEventListener("abort",ot);const ct=CriticalTimers.setTimeout(()=>{tt==null||tt.signal.removeEventListener("abort",ot),at(new ConnectionError("could not establish pc connection",ConnectionErrorReason.InternalError))},rt);for(;this.state!==PCTransportState.CONNECTED;)if(yield sleep$1(50),tt!=null&&tt.signal.aborted){at(new ConnectionError("room connection has been cancelled",ConnectionErrorReason.Cancelled));return}CriticalTimers.clearTimeout(ct),tt==null||tt.signal.removeEventListener("abort",ot),st()}))}()})}}class RpcError extends Error{constructor($,_e,et){super(_e),this.code=$,this.message=truncateBytes(_e,RpcError.MAX_MESSAGE_BYTES),this.data=et?truncateBytes(et,RpcError.MAX_DATA_BYTES):void 0}static fromProto($){return new RpcError($.code,$.message,$.data)}toProto(){return new RpcError$1({code:this.code,message:this.message,data:this.data})}static builtIn($,_e){return new RpcError(RpcError.ErrorCode[$],RpcError.ErrorMessage[$],_e)}}RpcError.MAX_MESSAGE_BYTES=256;RpcError.MAX_DATA_BYTES=15360;RpcError.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};RpcError.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const MAX_PAYLOAD_BYTES=15360;function byteLength(j){return new TextEncoder().encode(j).length}function truncateBytes(j,$){if(byteLength(j)<=$)return j;let _e=0,et=j.length;const tt=new TextEncoder;for(;_e<et;){const nt=Math.floor((_e+et+1)/2);tt.encode(j.slice(0,nt)).length<=$?_e=nt:et=nt-1}return j.slice(0,_e)}const monitorFrequency=2e3;function computeBitrate(j,$){if(!$)return 0;let _e,et;return"bytesReceived"in j?(_e=j.bytesReceived,et=$.bytesReceived):"bytesSent"in j&&(_e=j.bytesSent,et=$.bytesSent),_e===void 0||et===void 0||j.timestamp===void 0||$.timestamp===void 0?0:(_e-et)*8*1e3/(j.timestamp-$.timestamp)}const defaultDimensionsTimeout=1e3;class LocalTrack extends Track{get sender(){return this._sender}set sender($){this._sender=$}get constraints(){return this._constraints}constructor($,_e,et){let tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,nt=arguments.length>4?arguments[4]:void 0;super($,_e,nt),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=r$3(()=>__awaiter$1(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>__awaiter$1(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(TrackEvent.Ended,this)},this.reacquireTrack=!1,this.providedByUser=tt,this.muteLock=new _$1,this.pauseUpstreamLock=new _$1,this.processorLock=new _$1,this.restartLock=new _$1,this.setMediaStreamTrack($,!0),this._constraints=$.getConstraints(),et&&(this._constraints=et)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Track.Kind.Video)return;const{width:$,height:_e}=this._mediaStreamTrack.getSettings();if($&&_e)return{width:$,height:_e}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var $,_e;return(_e=($=this.processor)===null||$===void 0?void 0:$.processedTrack)!==null&&_e!==void 0?_e:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack($,_e){return __awaiter$1(this,void 0,void 0,function*(){var et;if($===this._mediaStreamTrack&&!_e)return;this._mediaStreamTrack&&(this.attachedElements.forEach(nt=>{detachTrack(this._mediaStreamTrack,nt)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([$]),$&&($.addEventListener("ended",this.handleEnded),$.addEventListener("mute",this.handleTrackMuteEvent),$.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=$.getConstraints());let tt;if(this.processor&&$){const nt=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(attachToElement($,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:$,kind:this.kind,element:this.processorElement}),tt=this.processor.processedTrack}finally{nt()}}this.sender&&((et=this.sender.transport)===null||et===void 0?void 0:et.state)!=="closed"&&(yield this.sender.replaceTrack(tt??$)),!this.providedByUser&&this._mediaStreamTrack!==$&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=$,$&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(nt=>{attachToElement(tt??$,nt)}))})}waitForDimensions(){return __awaiter$1(this,arguments,void 0,function(){var $=this;let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultDimensionsTimeout;return function*(){var et;if($.kind===Track.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((et=getBrowser())===null||et===void 0?void 0:et.os)==="iOS"&&(yield sleep$1(10));const tt=Date.now();for(;Date.now()-tt<_e;){const nt=$.dimensions;if(nt)return nt;yield sleep$1(50)}throw new TrackInvalidError("unable to get track dimensions after timeout")}()})}setDeviceId($){return __awaiter$1(this,void 0,void 0,function*(){return this._constraints.deviceId===$&&this._mediaStreamTrack.getSettings().deviceId===unwrapConstraint($)||(this._constraints.deviceId=$,this.isMuted)?!0:(yield this.restartTrack(),unwrapConstraint($)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return __awaiter$1(this,arguments,void 0,function(){var $=this;let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if($.source===Track.Source.ScreenShare)return;const{deviceId:et,groupId:tt}=$._mediaStreamTrack.getSettings(),nt=$.kind===Track.Kind.Audio?"audioinput":"videoinput";return _e?DeviceManager.getInstance().normalizeDeviceId(nt,et,tt):et}()})}mute(){return __awaiter$1(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return __awaiter$1(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack($,_e){return __awaiter$1(this,void 0,void 0,function*(){if(!this.sender)throw new TrackInvalidError("unable to replace an unpublished track");let et,tt;return typeof _e=="boolean"?et=_e:_e!==void 0&&(et=_e.userProvidedTrack,tt=_e.stopProcessor),this.providedByUser=et??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack($),tt&&this.processor&&(yield this.stopProcessor()),this})}restart($){return __awaiter$1(this,void 0,void 0,function*(){this.manuallyStopped=!1;const _e=yield this.restartLock.lock();try{$||($=this._constraints);const{deviceId:et,facingMode:tt}=$,nt=__rest$1($,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:$}));const rt={audio:!1,video:!1};this.kind===Track.Kind.Video?rt.video=et||tt?{deviceId:et,facingMode:tt}:!0:rt.audio=et?{deviceId:et}:!0,this.attachedElements.forEach(at=>{detachTrack(this.mediaStreamTrack,at)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const st=(yield navigator.mediaDevices.getUserMedia(rt)).getTracks()[0];return yield st.applyConstraints(nt),st.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(st),this._constraints=$,this.emit(TrackEvent.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{_e()}})}setTrackMuted($){this.log.debug("setting ".concat(this.kind," track ").concat($?"muted":"unmuted"),this.logContext),!(this.isMuted===$&&this._mediaStreamTrack.enabled!==$)&&(this.isMuted=$,this._mediaStreamTrack.enabled=!$,this.emit($?TrackEvent.Muted:TrackEvent.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const $=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield $.handleAppVisibilityChanged.call(this),isMobile()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var $;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),($=this.processor)===null||$===void 0||$.destroy(),this.processor=void 0}pauseUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(TrackEvent.UpstreamPaused,this);const et=getBrowser();if((et==null?void 0:et.name)==="Safari"&&compareVersions(et.version,"12.0")<0)throw new DeviceUnsupportedError("pauseUpstream is not supported on Safari < 12.");(($=this.sender.transport)===null||$===void 0?void 0:$.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{_e()}})}resumeUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(TrackEvent.UpstreamResumed,this),(($=this.sender.transport)===null||$===void 0?void 0:$.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{_e()}})}getRTCStatsReport(){return __awaiter$1(this,void 0,void 0,function*(){var $;return!(($=this.sender)===null||$===void 0)&&$.getStats?yield this.sender.getStats():void 0})}setProcessor($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var nt;const rt=yield et.processorLock.lock();try{et.log.debug("setting up processor",et.logContext);const it=document.createElement(et.kind),st={kind:et.kind,track:et._mediaStreamTrack,element:it,audioContext:et.audioContext};if(yield _e.init(st),et.log.debug("processor initialized",et.logContext),et.processor&&(yield et.stopProcessor()),et.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(attachToElement(et._mediaStreamTrack,it),it.muted=!0,it.play().catch(at=>et.log.error("failed to play processor element",Object.assign(Object.assign({},et.logContext),{error:at}))),et.processor=_e,et.processorElement=it,et.processor.processedTrack){for(const at of et.attachedElements)at!==et.processorElement&&tt&&(detachTrack(et._mediaStreamTrack,at),attachToElement(et.processor.processedTrack,at));yield(nt=et.sender)===null||nt===void 0?void 0:nt.replaceTrack(et.processor.processedTrack)}et.emit(TrackEvent.TrackProcessorUpdate,et.processor)}finally{rt()}}()})}getProcessor(){return this.processor}stopProcessor(){return __awaiter$1(this,arguments,void 0,function(){var $=this;let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var et,tt;$.processor&&($.log.debug("stopping processor",$.logContext),(et=$.processor.processedTrack)===null||et===void 0||et.stop(),yield $.processor.destroy(),$.processor=void 0,_e||((tt=$.processorElement)===null||tt===void 0||tt.remove(),$.processorElement=void 0),yield $._mediaStreamTrack.applyConstraints($._constraints),yield $.setMediaStreamTrack($._mediaStreamTrack,!0),$.emit(TrackEvent.TrackProcessorUpdate))}()})}}class LocalAudioTrack extends LocalTrack{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor($,_e){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,tt=arguments.length>3?arguments[3]:void 0,nt=arguments.length>4?arguments[4]:void 0;super($,Track.Kind.Audio,_e,et,nt),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let rt;try{rt=yield this.getSenderStats()}catch(it){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:it}));return}rt&&this.prevStats&&(this._currentBitrate=computeBitrate(rt,this.prevStats)),this.prevStats=rt}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(TrackEvent.AudioTrackFeatureUpdate,this,AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(TrackEvent.AudioTrackFeatureUpdate,this,AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=tt,this.checkForSilence()}mute(){const $=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$1(this,void 0,void 0,function*(){const _e=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Track.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield $.mute.call(this),this)}finally{_e()}})}unmute(){const $=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$1(this,void 0,void 0,function*(){const _e=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const et=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==unwrapConstraint(this._constraints.deviceId);return this.source===Track.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||et)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield $.unmute.call(this),this}finally{_e()}})}restartTrack($){return __awaiter$1(this,void 0,void 0,function*(){let _e;if($){const et=constraintsForOptions({audio:$});typeof et.audio!="boolean"&&(_e=et.audio)}yield this.restart(_e)})}restart($){const _e=Object.create(null,{restart:{get:()=>super.restart}});return __awaiter$1(this,void 0,void 0,function*(){const et=yield _e.restart.call(this,$);return this.checkForSilence(),et})}startMonitor(){isWeb()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency)))}setProcessor($){return __awaiter$1(this,void 0,void 0,function*(){var _e;const et=yield this.processorLock.lock();try{if(!isReactNative$1()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const tt={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat($.name),this.logContext),yield $.init(tt),this.processor=$,this.processor.processedTrack&&(yield(_e=this.sender)===null||_e===void 0?void 0:_e.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(TrackEvent.TrackProcessorUpdate,this.processor)}finally{et()}})}setAudioContext($){this.audioContext=$}getSenderStats(){return __awaiter$1(this,void 0,void 0,function*(){var $;if(!(!(($=this.sender)===null||$===void 0)&&$.getStats))return;const _e=yield this.sender.getStats();let et;return _e.forEach(tt=>{tt.type==="outbound-rtp"&&(et={type:"audio",streamId:tt.id,packetsSent:tt.packetsSent,packetsLost:tt.packetsLost,bytesSent:tt.bytesSent,timestamp:tt.timestamp,roundTripTime:tt.roundTripTime,jitter:tt.jitter})}),et})}checkForSilence(){return __awaiter$1(this,void 0,void 0,function*(){const $=yield detectSilence(this);return $&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(TrackEvent.AudioSilenceDetected)),$})}}function mediaTrackToLocalTrack(j,$,_e){switch(j.kind){case"audio":return new LocalAudioTrack(j,$,!1,void 0,_e);case"video":return new LocalVideoTrack(j,$,!1,_e);default:throw new TrackInvalidError("unsupported track type: ".concat(j.kind))}}const presets169=Object.values(VideoPresets),presets43=Object.values(VideoPresets43),presetsScreenShare=Object.values(ScreenSharePresets),defaultSimulcastPresets169=[VideoPresets.h180,VideoPresets.h360],defaultSimulcastPresets43=[VideoPresets43.h180,VideoPresets43.h360],computeDefaultScreenShareSimulcastPresets=j=>[{scaleResolutionDownBy:2,fps:j.encoding.maxFramerate}].map(_e=>{var et,tt;return new VideoPreset(Math.floor(j.width/_e.scaleResolutionDownBy),Math.floor(j.height/_e.scaleResolutionDownBy),Math.max(15e4,Math.floor(j.encoding.maxBitrate/(Math.pow(_e.scaleResolutionDownBy,2)*(((et=j.encoding.maxFramerate)!==null&&et!==void 0?et:30)/((tt=_e.fps)!==null&&tt!==void 0?tt:30))))),_e.fps,j.encoding.priority)}),videoRids=["q","h","f"];function computeVideoEncodings(j,$,_e,et){var tt,nt;let rt=et==null?void 0:et.videoEncoding;j&&(rt=et==null?void 0:et.screenShareEncoding);const it=et==null?void 0:et.simulcast,st=et==null?void 0:et.scalabilityMode,at=et==null?void 0:et.videoCodec;if(!rt&&!it&&!st||!$||!_e)return[{}];rt||(rt=determineAppropriateEncoding(j,$,_e,at),livekitLogger.debug("using video encoding",rt));const ot=rt.maxFramerate,ct=new VideoPreset($,_e,rt.maxBitrate,rt.maxFramerate,rt.priority);if(st&&isSVCCodec(at)){const pt=new ScalabilityMode(st),dt=[];if(pt.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(st));const ht=getBrowser();if(isSafari()||isReactNative$1()||(ht==null?void 0:ht.name)==="Chrome"&&compareVersions(ht==null?void 0:ht.version,"113")<0){const ft=pt.suffix=="h"?2:3;for(let mt=0;mt<pt.spatial;mt+=1)dt.push({rid:videoRids[2-mt],maxBitrate:rt.maxBitrate/Math.pow(ft,mt),maxFramerate:ct.encoding.maxFramerate});dt[0].scalabilityMode=st}else dt.push({maxBitrate:rt.maxBitrate,maxFramerate:ct.encoding.maxFramerate,scalabilityMode:st});return ct.encoding.priority&&(dt[0].priority=ct.encoding.priority,dt[0].networkPriority=ct.encoding.priority),livekitLogger.debug("using svc encoding",{encodings:dt}),dt}if(!it)return[rt];let lt=[];j?lt=(tt=sortPresets(et==null?void 0:et.screenShareSimulcastLayers))!==null&&tt!==void 0?tt:defaultSimulcastLayers(j,ct):lt=(nt=sortPresets(et==null?void 0:et.videoSimulcastLayers))!==null&&nt!==void 0?nt:defaultSimulcastLayers(j,ct);let ut;if(lt.length>0){const pt=lt[0];lt.length>1&&([,ut]=lt);const dt=Math.max($,_e);if(dt>=960&&ut)return encodingsFromPresets($,_e,[pt,ut,ct],ot);if(dt>=480)return encodingsFromPresets($,_e,[pt,ct],ot)}return encodingsFromPresets($,_e,[ct])}function computeTrackBackupEncodings(j,$,_e){var et,tt,nt,rt;if(!_e.backupCodec||_e.backupCodec===!0||_e.backupCodec.codec===_e.videoCodec)return;$!==_e.backupCodec.codec&&livekitLogger.warn("requested a different codec than specified as backup",{serverRequested:$,backup:_e.backupCodec.codec}),_e.videoCodec=$,_e.videoEncoding=_e.backupCodec.encoding;const it=j.mediaStreamTrack.getSettings(),st=(et=it.width)!==null&&et!==void 0?et:(tt=j.dimensions)===null||tt===void 0?void 0:tt.width,at=(nt=it.height)!==null&&nt!==void 0?nt:(rt=j.dimensions)===null||rt===void 0?void 0:rt.height;return j.source===Track.Source.ScreenShare&&_e.simulcast&&(_e.simulcast=!1),computeVideoEncodings(j.source===Track.Source.ScreenShare,st,at,_e)}function determineAppropriateEncoding(j,$,_e,et){const tt=presetsForResolution(j,$,_e);let{encoding:nt}=tt[0];const rt=Math.max($,_e);for(let it=0;it<tt.length;it+=1){const st=tt[it];if(nt=st.encoding,st.width>=rt)break}if(et)switch(et){case"av1":nt=Object.assign({},nt),nt.maxBitrate=nt.maxBitrate*.7;break;case"vp9":nt=Object.assign({},nt),nt.maxBitrate=nt.maxBitrate*.85;break}return nt}function presetsForResolution(j,$,_e){if(j)return presetsScreenShare;const et=$>_e?$/_e:_e/$;return Math.abs(et-16/9)<Math.abs(et-4/3)?presets169:presets43}function defaultSimulcastLayers(j,$){if(j)return computeDefaultScreenShareSimulcastPresets($);const{width:_e,height:et}=$,tt=_e>et?_e/et:et/_e;return Math.abs(tt-16/9)<Math.abs(tt-4/3)?defaultSimulcastPresets169:defaultSimulcastPresets43}function encodingsFromPresets(j,$,_e,et){const tt=[];if(_e.forEach((nt,rt)=>{if(rt>=videoRids.length)return;const it=Math.min(j,$),at={rid:videoRids[rt],scaleResolutionDownBy:Math.max(1,it/Math.min(nt.width,nt.height)),maxBitrate:nt.encoding.maxBitrate},ot=et&&nt.encoding.maxFramerate?Math.min(et,nt.encoding.maxFramerate):nt.encoding.maxFramerate;ot&&(at.maxFramerate=ot);const ct=isFireFox()||rt===0;nt.encoding.priority&&ct&&(at.priority=nt.encoding.priority,at.networkPriority=nt.encoding.priority),tt.push(at)}),isReactNative$1()&&getReactNativeOs()==="ios"){let nt;tt.forEach(it=>{nt?it.maxFramerate&&it.maxFramerate>nt&&(nt=it.maxFramerate):nt=it.maxFramerate});let rt=!0;tt.forEach(it=>{var st;it.maxFramerate!=nt&&(rt&&(rt=!1,livekitLogger.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),livekitLogger.info('Setting framerate of encoding "'.concat((st=it.rid)!==null&&st!==void 0?st:"",'" to ').concat(nt)),it.maxFramerate=nt)})}return tt}function sortPresets(j){if(j)return j.sort(($,_e)=>{const{encoding:et}=$,{encoding:tt}=_e;return et.maxBitrate>tt.maxBitrate?1:et.maxBitrate<tt.maxBitrate?-1:et.maxBitrate===tt.maxBitrate&&et.maxFramerate&&tt.maxFramerate?et.maxFramerate>tt.maxFramerate?1:-1:0})}class ScalabilityMode{constructor($){const _e=$.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!_e)throw new Error("invalid scalability mode");if(this.spatial=parseInt(_e[1]),this.temporal=parseInt(_e[2]),_e.length>3)switch(_e[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=_e[3]}}toString(){var $;return"L".concat(this.spatial,"T").concat(this.temporal).concat(($=this.suffix)!==null&&$!==void 0?$:"")}}function getDefaultDegradationPreference(j){return j.source===Track.Source.ScreenShare||j.constraints.height&&unwrapConstraint(j.constraints.height)>=1080?"maintain-resolution":"balanced"}const refreshSubscribedCodecAfterNewCodec=5e3;class LocalVideoTrack extends LocalTrack{get sender(){return this._sender}set sender($){this._sender=$,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor($,_e){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,tt=arguments.length>3?arguments[3]:void 0;super($,Track.Kind.Video,_e,et,tt),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let nt;try{nt=yield this.getSenderStats()}catch(it){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:it}));return}const rt=new Map(nt.map(it=>[it.rid,it]));if(this.prevStats){let it=0;rt.forEach((st,at)=>{var ot;const ct=(ot=this.prevStats)===null||ot===void 0?void 0:ot.get(at);it+=computeBitrate(st,ct)}),this._currentBitrate=it}this.prevStats=rt}),this.senderLock=new _$1}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor($){var _e;if(this.signalClient=$,!isWeb())return;const et=(_e=this.sender)===null||_e===void 0?void 0:_e.getParameters();et&&(this.encodings=et.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach($=>{$.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const $=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt,nt,rt;yield $.pauseUpstream.call(this);try{for(var it=!0,st=__asyncValues(this.simulcastCodecs.values()),at;at=yield st.next(),_e=at.done,!_e;it=!0)nt=at.value,it=!1,yield(rt=nt.sender)===null||rt===void 0?void 0:rt.replaceTrack(null)}catch(ot){et={error:ot}}finally{try{!it&&!_e&&(tt=st.return)&&(yield tt.call(st))}finally{if(et)throw et.error}}})}resumeUpstream(){const $=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt,nt,rt;yield $.resumeUpstream.call(this);try{for(var it=!0,st=__asyncValues(this.simulcastCodecs.values()),at;at=yield st.next(),_e=at.done,!_e;it=!0){nt=at.value,it=!1;const ot=nt;yield(rt=ot.sender)===null||rt===void 0?void 0:rt.replaceTrack(ot.mediaStreamTrack)}}catch(ot){et={error:ot}}finally{try{!it&&!_e&&(tt=st.return)&&(yield tt.call(st))}finally{if(et)throw et.error}}})}mute(){const $=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$1(this,void 0,void 0,function*(){const _e=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Track.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield $.mute.call(this),this)}finally{_e()}})}unmute(){const $=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$1(this,void 0,void 0,function*(){const _e=yield this.muteLock.lock();try{return this.isMuted?(this.source===Track.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield $.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{_e()}})}setTrackMuted($){super.setTrackMuted($);for(const _e of this.simulcastCodecs.values())_e.mediaStreamTrack.enabled=!$}getSenderStats(){return __awaiter$1(this,void 0,void 0,function*(){var $;if(!(!(($=this.sender)===null||$===void 0)&&$.getStats))return[];const _e=[],et=yield this.sender.getStats();return et.forEach(tt=>{var nt;if(tt.type==="outbound-rtp"){const rt={type:"video",streamId:tt.id,frameHeight:tt.frameHeight,frameWidth:tt.frameWidth,framesPerSecond:tt.framesPerSecond,framesSent:tt.framesSent,firCount:tt.firCount,pliCount:tt.pliCount,nackCount:tt.nackCount,packetsSent:tt.packetsSent,bytesSent:tt.bytesSent,qualityLimitationReason:tt.qualityLimitationReason,qualityLimitationDurations:tt.qualityLimitationDurations,qualityLimitationResolutionChanges:tt.qualityLimitationResolutionChanges,rid:(nt=tt.rid)!==null&&nt!==void 0?nt:tt.id,retransmittedPacketsSent:tt.retransmittedPacketsSent,targetBitrate:tt.targetBitrate,timestamp:tt.timestamp},it=et.get(tt.remoteId);it&&(rt.jitter=it.jitter,rt.packetsLost=it.packetsLost,rt.roundTripTime=it.roundTripTime),_e.push(rt)}}),_e.sort((tt,nt)=>{var rt,it;return((rt=nt.frameWidth)!==null&&rt!==void 0?rt:0)-((it=tt.frameWidth)!==null&&it!==void 0?it:0)}),_e})}setPublishingQuality($){const _e=[];for(let et=VideoQuality.LOW;et<=VideoQuality.HIGH;et+=1)_e.push(new SubscribedQuality({quality:et,enabled:et<=$}));this.log.debug("setting publishing quality. max quality ".concat($),this.logContext),this.setPublishingLayers(_e)}restartTrack($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt,nt,rt;let it;if($){const ct=constraintsForOptions({video:$});typeof ct.video!="boolean"&&(it=ct.video)}yield this.restart(it);try{for(var st=!0,at=__asyncValues(this.simulcastCodecs.values()),ot;ot=yield at.next(),_e=ot.done,!_e;st=!0){nt=ot.value,st=!1;const ct=nt;ct.sender&&((rt=ct.sender.transport)===null||rt===void 0?void 0:rt.state)!=="closed"&&(ct.mediaStreamTrack=this.mediaStreamTrack.clone(),yield ct.sender.replaceTrack(ct.mediaStreamTrack))}}catch(ct){et={error:ct}}finally{try{!st&&!_e&&(tt=at.return)&&(yield tt.call(at))}finally{if(et)throw et.error}}})}setProcessor($){const _e=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return __awaiter$1(this,arguments,void 0,function(et){var tt=this;let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var rt,it,st,at,ot,ct;if(yield _e.setProcessor.call(tt,et,nt),!((ot=tt.processor)===null||ot===void 0)&&ot.processedTrack)try{for(var lt=!0,ut=__asyncValues(tt.simulcastCodecs.values()),pt;pt=yield ut.next(),rt=pt.done,!rt;lt=!0)at=pt.value,lt=!1,yield(ct=at.sender)===null||ct===void 0?void 0:ct.replaceTrack(tt.processor.processedTrack)}catch(dt){it={error:dt}}finally{try{!lt&&!rt&&(st=ut.return)&&(yield st.call(ut))}finally{if(it)throw it.error}}}()})}setDegradationPreference($){return __awaiter$1(this,void 0,void 0,function*(){if(this.degradationPreference=$,this.sender)try{this.log.debug("setting degradationPreference to ".concat($),this.logContext);const _e=this.sender.getParameters();_e.degradationPreference=$,this.sender.setParameters(_e)}catch(_e){this.log.warn("failed to set degradationPreference",Object.assign({error:_e},this.logContext))}})}addSimulcastTrack($,_e){if(this.simulcastCodecs.has($)){this.log.error("".concat($," already added, skipping adding simulcast codec"),this.logContext);return}const et={codec:$,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:_e};return this.simulcastCodecs.set($,et),et}setSimulcastTrackSender($,_e){const et=this.simulcastCodecs.get($);et&&(et.sender=_e,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},refreshSubscribedCodecAfterNewCodec))}setPublishingCodecs($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt,nt,rt,it,st;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:$,currentCodec:this.codec})),!this.codec&&$.length>0)return yield this.setPublishingLayers($[0].qualities),[];this.subscribedCodecs=$;const at=[];try{for(_e=!0,et=__asyncValues($);tt=yield et.next(),nt=tt.done,!nt;_e=!0){st=tt.value,_e=!1;const ot=st;if(!this.codec||this.codec===ot.codec)yield this.setPublishingLayers(ot.qualities);else{const ct=this.simulcastCodecs.get(ot.codec);if(this.log.debug("try setPublishingCodec for ".concat(ot.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:ct})),!ct||!ct.sender){for(const lt of ot.qualities)if(lt.enabled){at.push(ot.codec);break}}else ct.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(ot.codec),this.logContext),yield setPublishingLayersForSender(ct.sender,ct.encodings,ot.qualities,this.senderLock,this.log,this.logContext))}}}catch(ot){rt={error:ot}}finally{try{!_e&&!nt&&(it=et.return)&&(yield it.call(et))}finally{if(rt)throw rt.error}}return at})}setPublishingLayers($){return __awaiter$1(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:$})),!(!this.sender||!this.encodings)&&(yield setPublishingLayersForSender(this.sender,this.encodings,$,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const $=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield $.handleAppVisibilityChanged.call(this),isMobile()&&this.isInBackground&&this.source===Track.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function setPublishingLayersForSender(j,$,_e,et,tt,nt){return __awaiter$1(this,void 0,void 0,function*(){const rt=yield et.lock();tt.debug("setPublishingLayersForSender",Object.assign(Object.assign({},nt),{sender:j,qualities:_e,senderEncodings:$}));try{const it=j.getParameters(),{encodings:st}=it;if(!st)return;if(st.length!==$.length){tt.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},nt),{encodings:st,senderEncodings:$}));return}let at=!1;const ot=getBrowser();if((ot==null?void 0:ot.name)==="Chrome"&&compareVersions(ot==null?void 0:ot.version,"133")>0&&st[0].scalabilityMode){const lt=st[0],ut=new ScalabilityMode(lt.scalabilityMode);let pt=VideoQuality$1.OFF;if(_e.forEach(dt=>{dt.enabled&&(pt===VideoQuality$1.OFF||dt.quality>pt)&&(pt=dt.quality)}),pt===VideoQuality$1.OFF)lt.active&&(lt.active=!1,at=!0);else if(!lt.active||ut.spatial!==pt+1){at=!0,lt.active=!0;const dt=new ScalabilityMode($[0].scalabilityMode);ut.spatial=pt+1,ut.suffix=dt.suffix,ut.spatial===1&&(ut.suffix=void 0),lt.scalabilityMode=ut.toString(),lt.scaleResolutionDownBy=Math.pow(2,2-pt),$[0].maxBitrate&&(lt.maxBitrate=$[0].maxBitrate/(lt.scaleResolutionDownBy*lt.scaleResolutionDownBy))}}else st.forEach((lt,ut)=>{var pt;let dt=(pt=lt.rid)!==null&&pt!==void 0?pt:"";dt===""&&(dt="q");const ht=videoQualityForRid(dt),ft=_e.find(mt=>mt.quality===ht);ft&&lt.active!==ft.enabled&&(at=!0,lt.active=ft.enabled,tt.debug("setting layer ".concat(ft.quality," to ").concat(lt.active?"enabled":"disabled"),nt),isFireFox()&&(ft.enabled?(lt.scaleResolutionDownBy=$[ut].scaleResolutionDownBy,lt.maxBitrate=$[ut].maxBitrate,lt.maxFrameRate=$[ut].maxFrameRate):(lt.scaleResolutionDownBy=4,lt.maxBitrate=10,lt.maxFrameRate=2)))});at&&(it.encodings=st,tt.debug("setting encodings",Object.assign(Object.assign({},nt),{encodings:it.encodings})),yield j.setParameters(it))}finally{rt()}})}function videoQualityForRid(j){switch(j){case"f":return VideoQuality.HIGH;case"h":return VideoQuality.MEDIUM;case"q":return VideoQuality.LOW;default:return VideoQuality.HIGH}}function videoLayersFromEncodings(j,$,_e,et){if(!_e)return[new VideoLayer({quality:VideoQuality.HIGH,width:j,height:$,bitrate:0,ssrc:0})];if(et){const tt=_e[0].scalabilityMode,nt=new ScalabilityMode(tt),rt=[],it=nt.suffix=="h"?1.5:2,st=nt.suffix=="h"?2:3;for(let at=0;at<nt.spatial;at+=1)rt.push(new VideoLayer({quality:Math.min(VideoQuality.HIGH,nt.spatial-1)-at,width:Math.ceil(j/Math.pow(it,at)),height:Math.ceil($/Math.pow(it,at)),bitrate:_e[0].maxBitrate?Math.ceil(_e[0].maxBitrate/Math.pow(st,at)):0,ssrc:0}));return rt}return _e.map(tt=>{var nt,rt,it;const st=(nt=tt.scaleResolutionDownBy)!==null&&nt!==void 0?nt:1;let at=videoQualityForRid((rt=tt.rid)!==null&&rt!==void 0?rt:"");return new VideoLayer({quality:at,width:Math.ceil(j/st),height:Math.ceil($/st),bitrate:(it=tt.maxBitrate)!==null&&it!==void 0?it:0,ssrc:0})})}const lossyDataChannel="_lossy",reliableDataChannel="_reliable",minReconnectWait=2*1e3,leaveReconnect="leave-reconnect";var PCState;(function(j){j[j.New=0]="New",j[j.Connected=1]="Connected",j[j.Disconnected=2]="Disconnected",j[j.Reconnecting=3]="Reconnecting",j[j.Closed=4]="Closed"})(PCState||(PCState={}));class RTCEngine extends eventsExports.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor($){var _e;super(),this.options=$,this.rtcConfig={},this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=PCState.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=livekitLogger,this.handleDataChannel=et=>__awaiter$1(this,[et],void 0,function(tt){var nt=this;let{channel:rt}=tt;return function*(){if(rt){if(rt.label===reliableDataChannel)nt.reliableDCSub=rt;else if(rt.label===lossyDataChannel)nt.lossyDCSub=rt;else return;nt.log.debug("on data channel ".concat(rt.id,", ").concat(rt.label),nt.logContext),rt.onmessage=nt.handleDataMessage}}()}),this.handleDataMessage=et=>__awaiter$1(this,void 0,void 0,function*(){var tt,nt;const rt=yield this.dataProcessLock.lock();try{let it;if(et.data instanceof ArrayBuffer)it=et.data;else if(et.data instanceof Blob)it=yield et.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:et.data}));return}const st=DataPacket.fromBinary(new Uint8Array(it));((tt=st.value)===null||tt===void 0?void 0:tt.case)==="speaker"?this.emit(EngineEvent.ActiveSpeakersUpdate,st.value.value.speakers):(((nt=st.value)===null||nt===void 0?void 0:nt.case)==="user"&&applyUserDataCompat(st,st.value.value),this.emit(EngineEvent.DataPacketReceived,st))}finally{rt()}}),this.handleDataError=et=>{const nt=et.currentTarget.maxRetransmits===0?"lossy":"reliable";if(et instanceof ErrorEvent&&et.error){const{error:rt}=et.error;this.log.error("DataChannel error on ".concat(nt,": ").concat(et.message),Object.assign(Object.assign({},this.logContext),{error:rt}))}else this.log.error("Unknown DataChannel error on ".concat(nt),Object.assign(Object.assign({},this.logContext),{event:et}))},this.handleBufferedAmountLow=et=>{const nt=et.currentTarget.maxRetransmits===0?DataPacket_Kind.LOSSY:DataPacket_Kind.RELIABLE;this.updateAndEmitDCBufferStatus(nt)},this.handleDisconnect=(et,tt)=>{if(this._isClosed)return;this.log.warn("".concat(et," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const nt=st=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(st,"ms. giving up"),this.logContext),this.emit(EngineEvent.Disconnected),this.close()},rt=Date.now()-this.reconnectStart;let it=this.getNextRetryDelay({elapsedMs:rt,retryCount:this.reconnectAttempts});if(it===null){nt(rt);return}et===leaveReconnect&&(it=0),this.log.debug("reconnecting in ".concat(it,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=CriticalTimers.setTimeout(()=>this.attemptReconnect(tt).finally(()=>this.reconnectTimeout=void 0),it)},this.waitForRestarted=()=>new Promise((et,tt)=>{this.pcState===PCState.Connected&&et();const nt=()=>{this.off(EngineEvent.Disconnected,rt),et()},rt=()=>{this.off(EngineEvent.Restarted,nt),tt()};this.once(EngineEvent.Restarted,nt),this.once(EngineEvent.Disconnected,rt)}),this.updateAndEmitDCBufferStatus=et=>{const tt=this.isBufferStatusLow(et);typeof tt<"u"&&tt!==this.dcBufferStatus.get(et)&&(this.dcBufferStatus.set(et,tt),this.emit(EngineEvent.DCBufferStatusChanged,tt,et))},this.isBufferStatusLow=et=>{const tt=this.dataChannelForKind(et);if(tt)return tt.bufferedAmount<=tt.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===SignalConnectionState.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(ReconnectReason.RR_SIGNAL_DISCONNECTED))},this.log=getLogger$1((_e=$.loggerName)!==null&&_e!==void 0?_e:LoggerNames.Engine),this.loggerOptions={loggerName:$.loggerName,loggerContextCb:()=>this.logContext},this.client=new SignalClient(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new _$1,this.dataProcessLock=new _$1,this.dcBufferStatus=new Map([[DataPacket_Kind.LOSSY,!0],[DataPacket_Kind.RELIABLE,!0]]),this.client.onParticipantUpdate=et=>this.emit(EngineEvent.ParticipantUpdate,et),this.client.onConnectionQuality=et=>this.emit(EngineEvent.ConnectionQualityUpdate,et),this.client.onRoomUpdate=et=>this.emit(EngineEvent.RoomUpdate,et),this.client.onSubscriptionError=et=>this.emit(EngineEvent.SubscriptionError,et),this.client.onSubscriptionPermissionUpdate=et=>this.emit(EngineEvent.SubscriptionPermissionUpdate,et),this.client.onSpeakersChanged=et=>this.emit(EngineEvent.SpeakersChanged,et),this.client.onStreamStateUpdate=et=>this.emit(EngineEvent.StreamStateChanged,et),this.client.onRequestResponse=et=>this.emit(EngineEvent.SignalRequestResponse,et)}get logContext(){var $,_e,et,tt,nt,rt,it,st;return{room:(_e=($=this.latestJoinResponse)===null||$===void 0?void 0:$.room)===null||_e===void 0?void 0:_e.name,roomID:(tt=(et=this.latestJoinResponse)===null||et===void 0?void 0:et.room)===null||tt===void 0?void 0:tt.sid,participant:(rt=(nt=this.latestJoinResponse)===null||nt===void 0?void 0:nt.participant)===null||rt===void 0?void 0:rt.identity,pID:(st=(it=this.latestJoinResponse)===null||it===void 0?void 0:it.participant)===null||st===void 0?void 0:st.sid}}join($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){this.url=$,this.token=_e,this.signalOpts=et,this.maxJoinAttempts=et.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const nt=yield this.client.join($,_e,et,tt);return this._isClosed=!1,this.latestJoinResponse=nt,this.subscriberPrimary=nt.subscriberPrimary,this.pcManager||(yield this.configure(nt)),(!this.subscriberPrimary||nt.fastPublish)&&this.negotiate(),this.clientConfiguration=nt.clientConfiguration,setTimeout(()=>{this.emit(EngineEvent.SignalConnected)},10),nt}catch(nt){if(nt instanceof ConnectionError&&nt.reason===ConnectionErrorReason.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join($,_e,et,tt);throw nt}})}close(){return __awaiter$1(this,void 0,void 0,function*(){const $=yield this.closingLock.lock();if(this.isClosed){$();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(EngineEvent.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{$()}})}cleanupPeerConnections(){return __awaiter$1(this,void 0,void 0,function*(){var $;yield($=this.pcManager)===null||$===void 0?void 0:$.close(),this.pcManager=void 0;const _e=et=>{et&&(et.close(),et.onbufferedamountlow=null,et.onclose=null,et.onclosing=null,et.onerror=null,et.onmessage=null,et.onopen=null)};_e(this.lossyDC),_e(this.lossyDCSub),_e(this.reliableDC),_e(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return __awaiter$1(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack($){if(this.pendingTrackResolvers[$.cid])throw new TrackInvalidError("a track with the same ID has already been published");return new Promise((_e,et)=>{const tt=setTimeout(()=>{delete this.pendingTrackResolvers[$.cid],et(new ConnectionError("publication of local track timed out, no response from server",ConnectionErrorReason.InternalError))},1e4);this.pendingTrackResolvers[$.cid]={resolve:nt=>{clearTimeout(tt),_e(nt)},reject:()=>{clearTimeout(tt),et(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack($)})}removeTrack($){if($.track&&this.pendingTrackResolvers[$.track.id]){const{reject:_e}=this.pendingTrackResolvers[$.track.id];_e&&_e(),delete this.pendingTrackResolvers[$.track.id]}try{return this.pcManager.removeTrack($),!0}catch(_e){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:_e}))}return!1}updateMuteStatus($,_e){this.client.sendMuteTrack($,_e)}get dataSubscriberReadyState(){var $;return($=this.reliableDCSub)===null||$===void 0?void 0:$.readyState}getConnectedServerAddress(){return __awaiter$1(this,void 0,void 0,function*(){var $;return($=this.pcManager)===null||$===void 0?void 0:$.getConnectedAddress()})}setRegionUrlProvider($){this.regionUrlProvider=$}configure($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et;if(this.pcManager&&this.pcManager.currentState!==PCTransportState.NEW)return;this.participantSid=(_e=$.participant)===null||_e===void 0?void 0:_e.sid;const tt=this.makeRTCConfiguration($);this.pcManager=new PCTransportManager(tt,$.subscriberPrimary,this.loggerOptions),this.emit(EngineEvent.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(nt,rt)=>{this.client.sendIceCandidate(nt,rt)},this.pcManager.onPublisherOffer=nt=>{this.client.sendOffer(nt)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(nt,rt,it)=>__awaiter$1(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(nt),this.logContext),["closed","disconnected","failed"].includes(rt)&&(this.publisherConnectionPromise=void 0),nt===PCTransportState.CONNECTED){const ot=this.pcState===PCState.New;this.pcState=PCState.Connected,ot&&this.emit(EngineEvent.Connected,$)}else nt===PCTransportState.FAILED&&this.pcState===PCState.Connected&&(this.pcState=PCState.Disconnected,this.handleDisconnect("peerconnection failed",it==="failed"?ReconnectReason.RR_SUBSCRIBER_FAILED:ReconnectReason.RR_PUBLISHER_FAILED));const st=this.client.isDisconnected||this.client.currentState===SignalConnectionState.RECONNECTING,at=[PCTransportState.FAILED,PCTransportState.CLOSING,PCTransportState.CLOSED].includes(nt);st&&at&&!this._isClosed&&this.emit(EngineEvent.Offline)}),this.pcManager.onTrack=nt=>{this.emit(EngineEvent.MediaTrackAdded,nt.track,nt.streams[0],nt.receiver)},supportOptionalDatachannel((et=$.serverInfo)===null||et===void 0?void 0:et.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=$=>__awaiter$1(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:$.type})),yield this.pcManager.setPublisherAnswer($))}),this.client.onTrickle=($,_e)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:$,target:_e})),this.pcManager.addIceCandidate($,_e))},this.client.onOffer=$=>__awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)return;const _e=yield this.pcManager.createSubscriberAnswerFromOffer($);this.client.sendAnswer(_e)}),this.client.onLocalTrackPublished=$=>{var _e;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:$.cid,track:(_e=$.track)===null||_e===void 0?void 0:_e.sid})),!this.pendingTrackResolvers[$.cid]){this.log.error("missing track resolver for ".concat($.cid),Object.assign(Object.assign({},this.logContext),{cid:$.cid}));return}const{resolve:et}=this.pendingTrackResolvers[$.cid];delete this.pendingTrackResolvers[$.cid],et($.track)},this.client.onLocalTrackUnpublished=$=>{this.emit(EngineEvent.LocalTrackUnpublished,$)},this.client.onLocalTrackSubscribed=$=>{this.emit(EngineEvent.LocalTrackSubscribed,$)},this.client.onTokenRefresh=$=>{this.token=$},this.client.onRemoteMuteChanged=($,_e)=>{this.emit(EngineEvent.RemoteMute,$,_e)},this.client.onSubscribedQualityUpdate=$=>{this.emit(EngineEvent.SubscribedQualityUpdate,$)},this.client.onClose=()=>{this.handleDisconnect("signal",ReconnectReason.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=$=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:$==null?void 0:$.reason})),$.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions($.regions)),$.action){case LeaveRequest_Action.DISCONNECT:this.emit(EngineEvent.Disconnected,$==null?void 0:$.reason),this.close();break;case LeaveRequest_Action.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(leaveReconnect);break;case LeaveRequest_Action.RESUME:this.handleDisconnect(leaveReconnect)}}}makeRTCConfiguration($){var _e;const et=Object.assign({},this.rtcConfig);if(!((_e=this.signalOpts)===null||_e===void 0)&&_e.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),et.encodedInsertableStreams=!0),$.iceServers&&!et.iceServers){const tt=[];$.iceServers.forEach(nt=>{const rt={urls:nt.urls};nt.username&&(rt.username=nt.username),nt.credential&&(rt.credential=nt.credential),tt.push(rt)}),et.iceServers=tt}return $.clientConfiguration&&$.clientConfiguration.forceRelay===ClientConfigSetting.ENABLED&&(et.iceTransportPolicy="relay"),et.sdpSemantics="unified-plan",et.continualGatheringPolicy="gather_continually",et}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(lossyDataChannel,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(reliableDataChannel,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){if(supportsTransceiver())return yield this.createTransceiverRTCRtpSender($,_e,et);if(supportsAddTrack())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender($.mediaStreamTrack);throw new UnexpectedConnectionState("Required webRTC APIs not supported on this device")})}createSimulcastSender($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){if(supportsTransceiver())return this.createSimulcastTransceiverSender($,_e,et,tt);if(supportsAddTrack())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender($.mediaStreamTrack);throw new UnexpectedConnectionState("Cannot stream on this device")})}createTransceiverRTCRtpSender($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");const tt=[];$.mediaStream&&tt.push($.mediaStream),isVideoTrack($)&&($.codec=_e.videoCodec);const nt={direction:"sendonly",streams:tt};return et&&(nt.sendEncodings=et),(yield this.pcManager.addPublisherTransceiver($.mediaStreamTrack,nt)).sender})}createSimulcastTransceiverSender($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");const nt={direction:"sendonly"};tt&&(nt.sendEncodings=tt);const rt=yield this.pcManager.addPublisherTransceiver(_e.mediaStreamTrack,nt);if(et.videoCodec)return $.setSimulcastTrackSender(et.videoCodec,rt.sender),rt.sender})}createRTCRtpSender($){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");return this.pcManager.addPublisherTrack($)})}attemptReconnect($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt;if(!this._isClosed){if(this.attemptingReconnect){livekitLogger.warn("already attempting reconnect, returning early",this.logContext);return}(((_e=this.clientConfiguration)===null||_e===void 0?void 0:_e.resumeConnection)===ClientConfigSetting.DISABLED||((tt=(et=this.pcManager)===null||et===void 0?void 0:et.currentState)!==null&&tt!==void 0?tt:PCTransportState.NEW)===PCTransportState.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection($),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(nt){this.reconnectAttempts+=1;let rt=!0;nt instanceof UnexpectedConnectionState?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:nt})),rt=!1):nt instanceof SignalReconnectError||(this.fullReconnectOnNext=!0),rt?this.handleDisconnect("reconnect",ReconnectReason.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(EngineEvent.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay($){try{return this.reconnectPolicy.nextRetryDelayInMs($)}catch(_e){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:_e}))}return null}restartConnection($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt;try{if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(EngineEvent.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let nt;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new SignalReconnectError;nt=yield this.join($??this.url,this.token,this.signalOpts)}catch(rt){throw rt instanceof ConnectionError&&rt.reason===ConnectionErrorReason.NotAllowed?new UnexpectedConnectionState("could not reconnect, token might be expired"):new SignalReconnectError}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(EngineEvent.SignalRestarted,nt),yield this.waitForPCReconnected(),this.client.currentState!==SignalConnectionState.CONNECTED)throw new SignalReconnectError("Signal connection got severed during reconnect");(_e=this.regionUrlProvider)===null||_e===void 0||_e.resetAttempts(),this.emit(EngineEvent.Restarted)}catch(nt){const rt=yield(et=this.regionUrlProvider)===null||et===void 0?void 0:et.getNextBestRegionUrl();if(rt){yield this.restartConnection(rt);return}else throw(tt=this.regionUrlProvider)===null||tt===void 0||tt.resetAttempts(),nt}})}resumeConnection($){return __awaiter$1(this,void 0,void 0,function*(){var _e;if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");if(!this.pcManager)throw new UnexpectedConnectionState("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(EngineEvent.Resuming);let et;try{this.setupSignalClientCallbacks(),et=yield this.client.reconnect(this.url,this.token,this.participantSid,$)}catch(tt){let nt="";throw tt instanceof Error&&(nt=tt.message,this.log.error(tt.message,Object.assign(Object.assign({},this.logContext),{error:tt}))),tt instanceof ConnectionError&&tt.reason===ConnectionErrorReason.NotAllowed?new UnexpectedConnectionState("could not reconnect, token might be expired"):tt instanceof ConnectionError&&tt.reason===ConnectionErrorReason.LeaveRequest?tt:new SignalReconnectError(nt)}if(this.emit(EngineEvent.SignalResumed),et){const tt=this.makeRTCConfiguration(et);this.pcManager.updateConfiguration(tt)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==SignalConnectionState.CONNECTED)throw new SignalReconnectError("Signal connection got severed during reconnect");this.client.setReconnected(),((_e=this.reliableDC)===null||_e===void 0?void 0:_e.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(EngineEvent.Resumed)})}waitForPCInitialConnection($,_e){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(_e,$)})}waitForPCReconnected(){return __awaiter$1(this,void 0,void 0,function*(){this.pcState=PCState.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield sleep$1(minReconnectWait),!this.pcManager)throw new UnexpectedConnectionState("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=PCState.Connected}catch($){throw this.pcState=PCState.Disconnected,new ConnectionError("could not establish PC connection, ".concat($.message),ConnectionErrorReason.InternalError)}})}publishRpcResponse($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){const nt=new DataPacket({destinationIdentities:[$],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcResponse",value:new RpcResponse({requestId:_e,value:tt?{case:"error",value:tt.toProto()}:{case:"payload",value:et??""}})}});yield this.sendDataPacket(nt,DataPacket_Kind.RELIABLE)})}publishRpcAck($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=new DataPacket({destinationIdentities:[$],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcAck",value:new RpcAck({requestId:_e})}});yield this.sendDataPacket(et,DataPacket_Kind.RELIABLE)})}sendDataPacket($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=$.toBinary();yield this.ensurePublisherConnected(_e);const tt=this.dataChannelForKind(_e);tt&&tt.send(et),this.updateAndEmitDCBufferStatus(_e)})}waitForBufferStatusLow($){return new Promise((_e,et)=>__awaiter$1(this,void 0,void 0,function*(){if(this.isBufferStatusLow($))_e();else{const tt=()=>et("Engine closed");for(this.once(EngineEvent.Closing,tt);!this.dcBufferStatus.get($);)yield sleep$1(10);this.off(EngineEvent.Closing,tt),_e()}}))}ensureDataTransportConnected($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var nt;if(!et.pcManager)throw new UnexpectedConnectionState("PC manager is closed");const rt=tt?et.pcManager.subscriber:et.pcManager.publisher,it=tt?"Subscriber":"Publisher";if(!rt)throw new ConnectionError("".concat(it," connection not set"),ConnectionErrorReason.InternalError);let st=!1;!tt&&!et.dataChannelForKind(_e,tt)&&(et.createDataChannels(),st=!0),!st&&!tt&&!et.pcManager.publisher.isICEConnected&&et.pcManager.publisher.getICEConnectionState()!=="checking"&&(st=!0),st&&et.negotiate();const at=et.dataChannelForKind(_e,tt);if((at==null?void 0:at.readyState)==="open")return;const ot=new Date().getTime()+et.peerConnectionTimeout;for(;new Date().getTime()<ot;){if(rt.isICEConnected&&((nt=et.dataChannelForKind(_e,tt))===null||nt===void 0?void 0:nt.readyState)==="open")return;yield sleep$1(50)}throw new ConnectionError("could not establish ".concat(it," connection, state: ").concat(rt.getICEConnectionState()),ConnectionErrorReason.InternalError)}()})}ensurePublisherConnected($){return __awaiter$1(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected($,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==PCTransportState.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return __awaiter$1(this,void 0,void 0,function*(){return new Promise(($,_e)=>__awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager){_e(new NegotiationError("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const et=new AbortController,tt=()=>{et.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),$()};this.isClosed&&_e("cannot negotiate on closed engine"),this.on(EngineEvent.Closing,tt),this.pcManager.publisher.once(PCEvents.RTPVideoPayloadTypes,nt=>{const rt=new Map;nt.forEach(it=>{const st=it.codec.toLowerCase();isVideoCodec(st)&&rt.set(it.payload,st)}),this.emit(EngineEvent.RTPVideoMapUpdate,rt)});try{yield this.pcManager.negotiate(et),$()}catch(nt){nt instanceof NegotiationError&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ReconnectReason.RR_UNKNOWN),_e(nt)}finally{this.off(EngineEvent.Closing,tt)}}))})}dataChannelForKind($,_e){if(_e){if($===DataPacket_Kind.LOSSY)return this.lossyDCSub;if($===DataPacket_Kind.RELIABLE)return this.reliableDCSub}else{if($===DataPacket_Kind.LOSSY)return this.lossyDC;if($===DataPacket_Kind.RELIABLE)return this.reliableDC}}sendSyncState($,_e){var et,tt;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const nt=this.pcManager.subscriber.getLocalDescription(),rt=this.pcManager.subscriber.getRemoteDescription(),it=(tt=(et=this.signalOpts)===null||et===void 0?void 0:et.autoSubscribe)!==null&&tt!==void 0?tt:!0,st=new Array,at=new Array;$.forEach(ot=>{ot.isDesired!==it&&st.push(ot.trackSid),ot.isEnabled||at.push(ot.trackSid)}),this.client.sendSyncState(new SyncState({answer:nt?toProtoSessionDescription({sdp:nt.sdp,type:nt.type}):void 0,offer:rt?toProtoSessionDescription({sdp:rt.sdp,type:rt.type}):void 0,subscription:new UpdateSubscription({trackSids:st,subscribe:!it,participantTracks:[]}),publishTracks:getTrackPublicationInfo(_e),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:at}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const $=[],_e=(et,tt)=>{(et==null?void 0:et.id)!==void 0&&et.id!==null&&$.push(new DataChannelInfo({label:et.label,id:et.id,target:tt}))};return _e(this.dataChannelForKind(DataPacket_Kind.LOSSY),SignalTarget.PUBLISHER),_e(this.dataChannelForKind(DataPacket_Kind.RELIABLE),SignalTarget.PUBLISHER),_e(this.dataChannelForKind(DataPacket_Kind.LOSSY,!0),SignalTarget.SUBSCRIBER),_e(this.dataChannelForKind(DataPacket_Kind.RELIABLE,!0),SignalTarget.SUBSCRIBER),$}clearReconnectTimeout(){this.reconnectTimeout&&CriticalTimers.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){isWeb()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){isWeb()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class SignalReconnectError extends Error{}function supportOptionalDatachannel(j){return j!==void 0&&j>13}function applyUserDataCompat(j,$){const _e=j.participantIdentity?j.participantIdentity:$.participantIdentity;j.participantIdentity=_e,$.participantIdentity=_e;const et=j.destinationIdentities.length!==0?j.destinationIdentities:$.destinationIdentities;j.destinationIdentities=et,$.destinationIdentities=et}class RegionUrlProvider{constructor($,_e){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL($),this.token=_e}updateToken($){this.token=$}isCloud(){return isCloud(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl($){return __awaiter$1(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings($));const _e=this.regionSettings.regions.filter(et=>!this.attemptedRegions.find(tt=>tt.url===et.url));if(_e.length>0){const et=_e[0];return this.attemptedRegions.push(et),livekitLogger.debug("next region: ".concat(et.region)),et.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings($){return __awaiter$1(this,void 0,void 0,function*(){const _e=yield fetch("".concat(getCloudConfigUrl(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:$});if(_e.ok){const et=yield _e.json();return this.lastUpdateAt=Date.now(),et}else throw new ConnectionError("Could not fetch region settings: ".concat(_e.statusText),_e.status===401?ConnectionErrorReason.NotAllowed:ConnectionErrorReason.InternalError,_e.status)})}setServerReportedRegions($){this.regionSettings=$,this.lastUpdateAt=Date.now()}}function getCloudConfigUrl(j){return"".concat(j.protocol.replace("ws","http"),"//").concat(j.host,"/settings")}class BaseStreamReader{get info(){return this._info}constructor($,_e,et){this.reader=_e,this.totalByteSize=et,this._info=$,this.bytesReceived=0}}class ByteStreamReader extends BaseStreamReader{handleChunkReceived($){var _e;this.bytesReceived+=$.content.byteLength;const et=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(_e=this.onProgress)===null||_e===void 0||_e.call(this,et)}[Symbol.asyncIterator](){const $=this.reader.getReader();return{next:()=>__awaiter$1(this,void 0,void 0,function*(){try{const{done:_e,value:et}=yield $.read();return _e?{done:!0,value:void 0}:(this.handleChunkReceived(et),{done:!1,value:et.content})}catch{return{done:!0,value:void 0}}}),return(){return __awaiter$1(this,void 0,void 0,function*(){return $.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return __awaiter$1(this,void 0,void 0,function*(){var $,_e,et,tt;let nt=new Set;try{for(var rt=!0,it=__asyncValues(this),st;st=yield it.next(),$=st.done,!$;rt=!0){tt=st.value,rt=!1;const at=tt;nt.add(at)}}catch(at){_e={error:at}}finally{try{!rt&&!$&&(et=it.return)&&(yield et.call(it))}finally{if(_e)throw _e.error}}return Array.from(nt)})}}class TextStreamReader extends BaseStreamReader{constructor($,_e,et){super($,_e,et),this.receivedChunks=new Map}handleChunkReceived($){var _e;const et=bigIntToNumber($.chunkIndex),tt=this.receivedChunks.get(et);if(tt&&tt.version>$.version)return;this.receivedChunks.set(et,$),this.bytesReceived+=$.content.byteLength;const nt=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(_e=this.onProgress)===null||_e===void 0||_e.call(this,nt)}[Symbol.asyncIterator](){const $=this.reader.getReader(),_e=new TextDecoder;return{next:()=>__awaiter$1(this,void 0,void 0,function*(){try{const{done:et,value:tt}=yield $.read();return et?{done:!0,value:void 0}:(this.handleChunkReceived(tt),{done:!1,value:_e.decode(tt.content)})}catch{return{done:!0,value:void 0}}}),return(){return __awaiter$1(this,void 0,void 0,function*(){return $.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return __awaiter$1(this,void 0,void 0,function*(){var $,_e,et,tt;let nt="";try{for(var rt=!0,it=__asyncValues(this),st;st=yield it.next(),$=st.done,!$;rt=!0)tt=st.value,rt=!1,nt+=tt}catch(at){_e={error:at}}finally{try{!rt&&!$&&(et=it.return)&&(yield et.call(it))}finally{if(_e)throw _e.error}}return nt})}}class BaseStreamWriter{constructor($,_e,et){this.writableStream=$,this.defaultWriter=$.getWriter(),this.onClose=et,this.info=_e}write($){return this.defaultWriter.write($)}close(){return __awaiter$1(this,void 0,void 0,function*(){var $;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),($=this.onClose)===null||$===void 0||$.call(this)})}}class TextStreamWriter extends BaseStreamWriter{}class ByteStreamWriter extends BaseStreamWriter{}class RemoteTrack extends Track{constructor($,_e,et,tt,nt){super($,et,nt),this.sid=_e,this.receiver=tt}get isLocal(){return!1}setMuted($){this.isMuted!==$&&(this.isMuted=$,this._mediaStreamTrack.enabled=!$,this.emit($?TrackEvent.Muted:TrackEvent.Unmuted,this))}setMediaStream($){this.mediaStream=$;const _e=et=>{et.track===this._mediaStreamTrack&&($.removeEventListener("removetrack",_e),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(TrackEvent.Ended,this))};$.addEventListener("removetrack",_e)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return __awaiter$1(this,void 0,void 0,function*(){var $;return!(($=this.receiver)===null||$===void 0)&&$.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay($){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=$:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),monitorFrequency)),supportsSynchronizationSources()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const $=()=>{var _e;this.timeSyncHandle=requestAnimationFrame(()=>$());const et=(_e=this.receiver)===null||_e===void 0?void 0:_e.getSynchronizationSources()[0];if(et){const{timestamp:tt,rtpTimestamp:nt}=et;nt&&this.rtpTimestamp!==nt&&(this.emit(TrackEvent.TimeSyncUpdate,{timestamp:tt,rtpTimestamp:nt}),this.rtpTimestamp=nt)}};$()}}class RemoteAudioTrack extends RemoteTrack{constructor($,_e,et,tt,nt,rt){super($,_e,Track.Kind.Audio,et,rt),this.monitorReceiver=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const it=yield this.getReceiverStats();it&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(it,this.prevStats)),this.prevStats=it}),this.audioContext=tt,this.webAudioPluginNodes=[],nt&&(this.sinkId=nt.deviceId)}setVolume($){var _e;for(const et of this.attachedElements)this.audioContext?(_e=this.gainNode)===null||_e===void 0||_e.gain.setTargetAtTime($,0,.1):et.volume=$;isReactNative$1()&&this._mediaStreamTrack._setVolume($),this.elementVolume=$}getVolume(){if(this.elementVolume)return this.elementVolume;if(isReactNative$1())return 1;let $=0;return this.attachedElements.forEach(_e=>{_e.volume>$&&($=_e.volume)}),$}setSinkId($){return __awaiter$1(this,void 0,void 0,function*(){this.sinkId=$,yield Promise.all(this.attachedElements.map(_e=>{if(supportsSetSinkId(_e))return _e.setSinkId($)}))})}attach($){const _e=this.attachedElements.length===0;return $?super.attach($):$=super.attach(),this.sinkId&&supportsSetSinkId($)&&$.setSinkId(this.sinkId),this.audioContext&&_e&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,$),$.volume=0,$.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),$}detach($){let _e;return $?(_e=super.detach($),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(_e=super.detach(),this.disconnectWebAudio()),_e}setAudioContext($){this.audioContext=$,$&&this.attachedElements.length>0?this.connectWebAudio($,this.attachedElements[0]):$||this.disconnectWebAudio()}setWebAudioPlugins($){this.webAudioPluginNodes=$,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio($,_e){this.disconnectWebAudio(),this.sourceNode=$.createMediaStreamSource(_e.srcObject);let et=this.sourceNode;this.webAudioPluginNodes.forEach(tt=>{et.connect(tt),et=tt}),this.gainNode=$.createGain(),et.connect(this.gainNode),this.gainNode.connect($.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),$.state!=="running"&&$.resume().then(()=>{$.state!=="running"&&this.emit(TrackEvent.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(tt=>{this.emit(TrackEvent.AudioPlaybackFailed,tt)})}disconnectWebAudio(){var $,_e;($=this.gainNode)===null||$===void 0||$.disconnect(),(_e=this.sourceNode)===null||_e===void 0||_e.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return __awaiter$1(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const $=yield this.receiver.getStats();let _e;return $.forEach(et=>{et.type==="inbound-rtp"&&(_e={type:"audio",streamId:et.id,timestamp:et.timestamp,jitter:et.jitter,bytesReceived:et.bytesReceived,concealedSamples:et.concealedSamples,concealmentEvents:et.concealmentEvents,silentConcealedSamples:et.silentConcealedSamples,silentConcealmentEvents:et.silentConcealmentEvents,totalAudioEnergy:et.totalAudioEnergy,totalSamplesDuration:et.totalSamplesDuration})}),_e})}}const REACTION_DELAY=100;class RemoteVideoTrack extends RemoteTrack{constructor($,_e,et,tt,nt){super($,_e,Track.Kind.Video,et,nt),this.elementInfos=[],this.monitorReceiver=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const rt=yield this.getReceiverStats();rt&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(rt,this.prevStats)),this.prevStats=rt}),this.debouncedHandleResize=r$3(()=>{this.updateDimensions()},REACTION_DELAY),this.adaptiveStreamSettings=tt}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted($){super.setMuted($),this.attachedElements.forEach(_e=>{$?detachTrack(this._mediaStreamTrack,_e):attachToElement(this._mediaStreamTrack,_e)})}attach($){if($?super.attach($):$=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(_e=>_e.element===$)===void 0){const _e=new HTMLElementInfo($);this.observeElementInfo(_e)}return $}observeElementInfo($){this.adaptiveStreamSettings&&this.elementInfos.find(_e=>_e===$)===void 0?($.handleResize=()=>{this.debouncedHandleResize()},$.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push($),$.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo($){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const _e=this.elementInfos.filter(et=>et===$);for(const et of _e)et.stopObserving();this.elementInfos=this.elementInfos.filter(et=>et!==$),this.updateVisibility(),this.debouncedHandleResize()}detach($){let _e=[];if($)return this.stopObservingElement($),super.detach($);_e=super.detach();for(const et of _e)this.stopObservingElement(et);return _e}getDecoderImplementation(){var $;return($=this.prevStats)===null||$===void 0?void 0:$.decoderImplementation}getReceiverStats(){return __awaiter$1(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const $=yield this.receiver.getStats();let _e,et="",tt=new Map;return $.forEach(nt=>{nt.type==="inbound-rtp"?(et=nt.codecId,_e={type:"video",streamId:nt.id,framesDecoded:nt.framesDecoded,framesDropped:nt.framesDropped,framesReceived:nt.framesReceived,packetsReceived:nt.packetsReceived,packetsLost:nt.packetsLost,frameWidth:nt.frameWidth,frameHeight:nt.frameHeight,pliCount:nt.pliCount,firCount:nt.firCount,nackCount:nt.nackCount,jitter:nt.jitter,timestamp:nt.timestamp,bytesReceived:nt.bytesReceived,decoderImplementation:nt.decoderImplementation}):nt.type==="codec"&&tt.set(nt.id,nt)}),_e&&et!==""&&tt.get(et)&&(_e.mimeType=tt.get(et).mimeType),_e})}stopObservingElement($){const _e=this.elementInfos.filter(et=>et.element===$);for(const et of _e)this.stopObservingElementInfo(et)}handleAppVisibilityChanged(){const $=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield $.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var $,_e;const et=this.elementInfos.reduce((it,st)=>Math.max(it,st.visibilityChangedAt||0),0),tt=!((_e=($=this.adaptiveStreamSettings)===null||$===void 0?void 0:$.pauseVideoInBackground)!==null&&_e!==void 0)||_e?this.isInBackground:!1,nt=this.elementInfos.some(it=>it.pictureInPicture),rt=this.elementInfos.some(it=>it.visible)&&!tt||nt;if(this.lastVisible!==rt){if(!rt&&Date.now()-et<REACTION_DELAY){CriticalTimers.setTimeout(()=>{this.updateVisibility()},REACTION_DELAY);return}this.lastVisible=rt,this.emit(TrackEvent.VisibilityChanged,rt,this)}}updateDimensions(){var $,_e;let et=0,tt=0;const nt=this.getPixelDensity();for(const rt of this.elementInfos){const it=rt.width()*nt,st=rt.height()*nt;it+st>et+tt&&(et=it,tt=st)}(($=this.lastDimensions)===null||$===void 0?void 0:$.width)===et&&((_e=this.lastDimensions)===null||_e===void 0?void 0:_e.height)===tt||(this.lastDimensions={width:et,height:tt},this.emit(TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var $;const _e=($=this.adaptiveStreamSettings)===null||$===void 0?void 0:$.pixelDensity;return _e==="screen"?getDevicePixelRatio():_e||(getDevicePixelRatio()>2?2:1)}}class HTMLElementInfo{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor($,_e){this.onVisibilityChanged=et=>{var tt;const{target:nt,isIntersecting:rt}=et;nt===this.element&&(this.isIntersecting=rt,this.isPiP=isElementInPiP(this.element),this.visibilityChangedAt=Date.now(),(tt=this.handleVisibilityChanged)===null||tt===void 0||tt.call(this))},this.onEnterPiP=()=>{var et,tt,nt;(tt=(et=window.documentPictureInPicture)===null||et===void 0?void 0:et.window)===null||tt===void 0||tt.addEventListener("pagehide",this.onLeavePiP),this.isPiP=isElementInPiP(this.element),(nt=this.handleVisibilityChanged)===null||nt===void 0||nt.call(this)},this.onLeavePiP=()=>{var et;this.isPiP=isElementInPiP(this.element),(et=this.handleVisibilityChanged)===null||et===void 0||et.call(this)},this.element=$,this.isIntersecting=_e??isElementInViewport($),this.isPiP=isWeb()&&isElementInPiP($),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var $,_e,et;this.isIntersecting=isElementInViewport(this.element),this.isPiP=isElementInPiP(this.element),this.element.handleResize=()=>{var tt;(tt=this.handleResize)===null||tt===void 0||tt.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,getIntersectionObserver().observe(this.element),getResizeObserver().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),($=window.documentPictureInPicture)===null||$===void 0||$.addEventListener("enter",this.onEnterPiP),(et=(_e=window.documentPictureInPicture)===null||_e===void 0?void 0:_e.window)===null||et===void 0||et.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var $,_e,et,tt,nt;($=getIntersectionObserver())===null||$===void 0||$.unobserve(this.element),(_e=getResizeObserver())===null||_e===void 0||_e.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(et=window.documentPictureInPicture)===null||et===void 0||et.removeEventListener("enter",this.onEnterPiP),(nt=(tt=window.documentPictureInPicture)===null||tt===void 0?void 0:tt.window)===null||nt===void 0||nt.removeEventListener("pagehide",this.onLeavePiP)}}function isElementInPiP(j){var $,_e;return document.pictureInPictureElement===j?!0:!(($=window.documentPictureInPicture)===null||$===void 0)&&$.window?isElementInViewport(j,(_e=window.documentPictureInPicture)===null||_e===void 0?void 0:_e.window):!1}function isElementInViewport(j,$){const _e=$||window;let et=j.offsetTop,tt=j.offsetLeft;const nt=j.offsetWidth,rt=j.offsetHeight,{hidden:it}=j,{display:st}=getComputedStyle(j);for(;j.offsetParent;)j=j.offsetParent,et+=j.offsetTop,tt+=j.offsetLeft;return et<_e.pageYOffset+_e.innerHeight&&tt<_e.pageXOffset+_e.innerWidth&&et+rt>_e.pageYOffset&&tt+nt>_e.pageXOffset&&!it&&st!=="none"}class TrackPublication extends eventsExports.EventEmitter{constructor($,_e,et,tt){var nt;super(),this.metadataMuted=!1,this.encryption=Encryption_Type.NONE,this.log=livekitLogger,this.handleMuted=()=>{this.emit(TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(TrackEvent.Unmuted)},this.log=getLogger$1((nt=tt==null?void 0:tt.loggerName)!==null&&nt!==void 0?nt:LoggerNames.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=$,this.trackSid=_e,this.trackName=et,this.source=Track.Source.Unknown}setTrack($){this.track&&(this.track.off(TrackEvent.Muted,this.handleMuted),this.track.off(TrackEvent.Unmuted,this.handleUnmuted)),this.track=$,$&&($.on(TrackEvent.Muted,this.handleMuted),$.on(TrackEvent.Unmuted,this.handleUnmuted))}get logContext(){var $;return Object.assign(Object.assign({},($=this.loggerContextCb)===null||$===void 0?void 0:$.call(this)),getLogContextFromTrack(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Encryption_Type.NONE}get audioTrack(){if(isAudioTrack(this.track))return this.track}get videoTrack(){if(isVideoTrack(this.track))return this.track}updateInfo($){this.trackSid=$.sid,this.trackName=$.name,this.source=Track.sourceFromProto($.source),this.mimeType=$.mimeType,this.kind===Track.Kind.Video&&$.width>0&&(this.dimensions={width:$.width,height:$.height},this.simulcasted=$.simulcast),this.encryption=$.encryption,this.trackInfo=$,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:$}))}}(function(j){(function($){$.Desired="desired",$.Subscribed="subscribed",$.Unsubscribed="unsubscribed"})(j.SubscriptionStatus||(j.SubscriptionStatus={})),function($){$.Allowed="allowed",$.NotAllowed="not_allowed"}(j.PermissionStatus||(j.PermissionStatus={}))})(TrackPublication||(TrackPublication={}));class LocalTrackPublication extends TrackPublication{get isUpstreamPaused(){var $;return($=this.track)===null||$===void 0?void 0:$.isUpstreamPaused}constructor($,_e,et,tt){super($,_e.sid,_e.name,tt),this.track=void 0,this.handleTrackEnded=()=>{this.emit(TrackEvent.Ended)},this.updateInfo(_e),this.setTrack(et)}setTrack($){this.track&&this.track.off(TrackEvent.Ended,this.handleTrackEnded),super.setTrack($),$&&$.on(TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return __awaiter$1(this,void 0,void 0,function*(){var $;return($=this.track)===null||$===void 0?void 0:$.mute()})}unmute(){return __awaiter$1(this,void 0,void 0,function*(){var $;return($=this.track)===null||$===void 0?void 0:$.unmute()})}pauseUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var $;yield($=this.track)===null||$===void 0?void 0:$.pauseUpstream()})}resumeUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var $;yield($=this.track)===null||$===void 0?void 0:$.resumeUpstream()})}getTrackFeatures(){var $;if(isAudioTrack(this.track)){const _e=this.track.getSourceTrackSettings(),et=new Set;return _e.autoGainControl&&et.add(AudioTrackFeature.TF_AUTO_GAIN_CONTROL),_e.echoCancellation&&et.add(AudioTrackFeature.TF_ECHO_CANCELLATION),_e.noiseSuppression&&et.add(AudioTrackFeature.TF_NOISE_SUPPRESSION),_e.channelCount&&_e.channelCount>1&&et.add(AudioTrackFeature.TF_STEREO),!(($=this.options)===null||$===void 0)&&$.dtx||et.add(AudioTrackFeature.TF_NO_DTX),this.track.enhancedNoiseCancellation&&et.add(AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION),Array.from(et.values())}else return[]}}function createLocalTracks(j,$){return __awaiter$1(this,void 0,void 0,function*(){j??(j={});let _e=!1;const{audioProcessor:et,videoProcessor:tt,optionsWithoutProcessor:nt}=extractProcessorsFromOptions(j);let rt=nt.audio,it=nt.video;if(et&&typeof nt.audio=="object"&&(nt.audio.processor=et),tt&&typeof nt.video=="object"&&(nt.video.processor=tt),j.audio&&typeof nt.audio=="object"&&typeof nt.audio.deviceId=="string"){const ct=nt.audio.deviceId;nt.audio.deviceId={exact:ct},_e=!0,rt=Object.assign(Object.assign({},nt.audio),{deviceId:{ideal:ct}})}if(nt.video&&typeof nt.video=="object"&&typeof nt.video.deviceId=="string"){const ct=nt.video.deviceId;nt.video.deviceId={exact:ct},_e=!0,it=Object.assign(Object.assign({},nt.video),{deviceId:{ideal:ct}})}(nt.audio===!0||typeof nt.audio=="object"&&!nt.audio.deviceId)&&(nt.audio={deviceId:"default"}),(nt.video===!0||typeof nt.video=="object"&&!nt.video.deviceId)&&(nt.video={deviceId:"default"});const st=mergeDefaultOptions(nt,audioDefaults,videoDefaults),at=constraintsForOptions(st),ot=navigator.mediaDevices.getUserMedia(at);nt.audio&&(DeviceManager.userMediaPromiseMap.set("audioinput",ot),ot.catch(()=>DeviceManager.userMediaPromiseMap.delete("audioinput"))),nt.video&&(DeviceManager.userMediaPromiseMap.set("videoinput",ot),ot.catch(()=>DeviceManager.userMediaPromiseMap.delete("videoinput")));try{const ct=yield ot;return yield Promise.all(ct.getTracks().map(lt=>__awaiter$1(this,void 0,void 0,function*(){const ut=lt.kind==="audio";let pt=ut?st.audio:st.video;(typeof pt=="boolean"||!pt)&&(pt={});let dt;const ht=ut?at.audio:at.video;typeof ht!="boolean"&&(dt=ht);const ft=lt.getSettings().deviceId;dt!=null&&dt.deviceId&&unwrapConstraint(dt.deviceId)!==ft?dt.deviceId=ft:dt||(dt={deviceId:ft});const mt=mediaTrackToLocalTrack(lt,dt,$);return mt.kind===Track.Kind.Video?mt.source=Track.Source.Camera:mt.kind===Track.Kind.Audio&&(mt.source=Track.Source.Microphone),mt.mediaStream=ct,isAudioTrack(mt)&&et?yield mt.setProcessor(et):isVideoTrack(mt)&&tt&&(yield mt.setProcessor(tt)),mt})))}catch(ct){if(!_e)throw ct;return createLocalTracks(Object.assign(Object.assign({},j),{audio:rt,video:it}),$)}})}function createLocalVideoTrack(j){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:!1,video:!0}))[0]})}function createLocalAudioTrack(j){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:j??!0,video:!1}))[0]})}var ConnectionQuality$2;(function(j){j.Excellent="excellent",j.Good="good",j.Poor="poor",j.Lost="lost",j.Unknown="unknown"})(ConnectionQuality$2||(ConnectionQuality$2={}));function qualityFromProto(j){switch(j){case ConnectionQuality$1.EXCELLENT:return ConnectionQuality$2.Excellent;case ConnectionQuality$1.GOOD:return ConnectionQuality$2.Good;case ConnectionQuality$1.POOR:return ConnectionQuality$2.Poor;case ConnectionQuality$1.LOST:return ConnectionQuality$2.Lost;default:return ConnectionQuality$2.Unknown}}class Participant extends eventsExports.EventEmitter{get logContext(){var $,_e;return Object.assign({},(_e=($=this.loggerOptions)===null||$===void 0?void 0:$.loggerContextCb)===null||_e===void 0?void 0:_e.call($))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every($=>$.isEncrypted)}get isAgent(){var $;return(($=this.permissions)===null||$===void 0?void 0:$.agent)||this.kind===ParticipantInfo_Kind.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor($,_e,et,tt,nt,rt){let it=arguments.length>6&&arguments[6]!==void 0?arguments[6]:ParticipantInfo_Kind.STANDARD;var st;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ConnectionQuality$2.Unknown,this.log=livekitLogger,this.log=getLogger$1((st=rt==null?void 0:rt.loggerName)!==null&&st!==void 0?st:LoggerNames.Participant),this.loggerOptions=rt,this.setMaxListeners(100),this.sid=$,this.identity=_e,this.name=et,this.metadata=tt,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=it,this._attributes=nt??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication($){for(const[,_e]of this.trackPublications)if(_e.source===$)return _e}getTrackPublicationByName($){for(const[,_e]of this.trackPublications)if(_e.trackName===$)return _e}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var $;const _e=this.getTrackPublication(Track.Source.Camera);return!(!(($=_e==null?void 0:_e.isMuted)!==null&&$!==void 0)||$)}get isMicrophoneEnabled(){var $;const _e=this.getTrackPublication(Track.Source.Microphone);return!(!(($=_e==null?void 0:_e.isMuted)!==null&&$!==void 0)||$)}get isScreenShareEnabled(){return!!this.getTrackPublication(Track.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo($){return this.participantInfo&&this.participantInfo.sid===$.sid&&this.participantInfo.version>$.version?!1:(this.identity=$.identity,this.sid=$.sid,this._setName($.name),this._setMetadata($.metadata),this._setAttributes($.attributes),$.permission&&this.setPermissions($.permission),this.participantInfo=$,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:$})),!0)}_setMetadata($){const _e=this.metadata!==$,et=this.metadata;this.metadata=$,_e&&this.emit(ParticipantEvent.ParticipantMetadataChanged,et)}_setName($){const _e=this.name!==$;this.name=$,_e&&this.emit(ParticipantEvent.ParticipantNameChanged,$)}_setAttributes($){const _e=diffAttributes(this.attributes,$);this._attributes=$,Object.keys(_e).length>0&&this.emit(ParticipantEvent.AttributesChanged,_e)}setPermissions($){var _e,et,tt,nt,rt,it;const st=this.permissions,at=$.canPublish!==((_e=this.permissions)===null||_e===void 0?void 0:_e.canPublish)||$.canSubscribe!==((et=this.permissions)===null||et===void 0?void 0:et.canSubscribe)||$.canPublishData!==((tt=this.permissions)===null||tt===void 0?void 0:tt.canPublishData)||$.hidden!==((nt=this.permissions)===null||nt===void 0?void 0:nt.hidden)||$.recorder!==((rt=this.permissions)===null||rt===void 0?void 0:rt.recorder)||$.canPublishSources.length!==this.permissions.canPublishSources.length||$.canPublishSources.some((ot,ct)=>{var lt;return ot!==((lt=this.permissions)===null||lt===void 0?void 0:lt.canPublishSources[ct])})||$.canSubscribeMetrics!==((it=this.permissions)===null||it===void 0?void 0:it.canSubscribeMetrics);return this.permissions=$,at&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,st),at}setIsSpeaking($){$!==this.isSpeaking&&(this.isSpeaking=$,$&&(this.lastSpokeAt=new Date),this.emit(ParticipantEvent.IsSpeakingChanged,$))}setConnectionQuality($){const _e=this._connectionQuality;this._connectionQuality=qualityFromProto($),_e!==this._connectionQuality&&this.emit(ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}setAudioContext($){this.audioContext=$,this.audioTrackPublications.forEach(_e=>isAudioTrack(_e.track)&&_e.track.setAudioContext($))}addTrackPublication($){$.on(TrackEvent.Muted,()=>{this.emit(ParticipantEvent.TrackMuted,$)}),$.on(TrackEvent.Unmuted,()=>{this.emit(ParticipantEvent.TrackUnmuted,$)});const _e=$;switch(_e.track&&(_e.track.sid=$.trackSid),this.trackPublications.set($.trackSid,$),$.kind){case Track.Kind.Audio:this.audioTrackPublications.set($.trackSid,$);break;case Track.Kind.Video:this.videoTrackPublications.set($.trackSid,$);break}}}function trackPermissionToProto(j){var $,_e,et;if(!j.participantSid&&!j.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new TrackPermission({participantIdentity:($=j.participantIdentity)!==null&&$!==void 0?$:"",participantSid:(_e=j.participantSid)!==null&&_e!==void 0?_e:"",allTracks:(et=j.allowAll)!==null&&et!==void 0?et:!1,trackSids:j.allowedTrackSids||[]})}const STREAM_CHUNK_SIZE=15e3;class LocalParticipant extends Participant{constructor($,_e,et,tt,nt){super($,_e,void 0,void 0,void 0,{loggerName:tt.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Encryption_Type.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Future)},this.handleReconnected=()=>{var rt,it;(it=(rt=this.reconnectFuture)===null||rt===void 0?void 0:rt.resolve)===null||it===void 0||it.call(rt),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var rt,it;this.reconnectFuture&&(this.reconnectFuture.promise.catch(st=>this.log.warn(st.message,this.logContext)),(it=(rt=this.reconnectFuture)===null||rt===void 0?void 0:rt.reject)===null||it===void 0||it.call(rt,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=rt=>{const{requestId:it,reason:st,message:at}=rt,ot=this.pendingSignalRequests.get(it);ot&&(st!==RequestResponse_Reason.OK&&ot.reject(new SignalRequestError(at,st)),this.pendingSignalRequests.delete(it))},this.handleDataPacket=rt=>{switch(rt.value.case){case"rpcResponse":let it=rt.value.value,st=null,at=null;it.value.case==="payload"?st=it.value.value:it.value.case==="error"&&(at=RpcError.fromProto(it.value.value)),this.handleIncomingRpcResponse(it.requestId,st,at);break;case"rpcAck":let ot=rt.value.value;this.handleIncomingRpcAck(ot.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(rt=>trackPermissionToProto(rt)))},this.onTrackUnmuted=rt=>{this.onTrackMuted(rt,rt.isUpstreamPaused)},this.onTrackMuted=(rt,it)=>{if(it===void 0&&(it=!0),!rt.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt)));return}this.engine.updateMuteStatus(rt.sid,it)},this.onTrackUpstreamPaused=rt=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),this.onTrackMuted(rt,!0)},this.onTrackUpstreamResumed=rt=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),this.onTrackMuted(rt,rt.isMuted)},this.onTrackFeatureUpdate=rt=>{const it=this.audioTrackPublications.get(rt.sid);if(!it){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(rt.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(it.trackSid,it.getTrackFeatures())},this.handleSubscribedQualityUpdate=rt=>__awaiter$1(this,void 0,void 0,function*(){var it,st,at,ot,ct,lt;if(!(!((ct=this.roomOptions)===null||ct===void 0)&&ct.dynacast))return;const ut=this.videoTrackPublications.get(rt.trackSid);if(!ut){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:rt.trackSid}));return}if(rt.subscribedCodecs.length>0){if(!ut.videoTrack)return;const ft=yield ut.videoTrack.setPublishingCodecs(rt.subscribedCodecs);try{for(var pt=!0,dt=__asyncValues(ft),ht;ht=yield dt.next(),it=ht.done,!it;pt=!0){ot=ht.value,pt=!1;const mt=ot;isBackupCodec(mt)&&(this.log.debug("publish ".concat(mt," for ").concat(ut.videoTrack.sid),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(ut))),yield this.publishAdditionalCodecForTrack(ut.videoTrack,mt,ut.options))}}catch(mt){st={error:mt}}finally{try{!pt&&!it&&(at=dt.return)&&(yield at.call(dt))}finally{if(st)throw st.error}}}else rt.subscribedQualities.length>0&&(yield(lt=ut.videoTrack)===null||lt===void 0?void 0:lt.setPublishingLayers(rt.subscribedQualities))}),this.handleLocalTrackUnpublished=rt=>{const it=this.trackPublications.get(rt.trackSid);if(!it){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:rt.trackSid}));return}this.unpublishTrack(it.track)},this.handleTrackEnded=rt=>__awaiter$1(this,void 0,void 0,function*(){if(rt.source===Track.Source.ScreenShare||rt.source===Track.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),this.unpublishTrack(rt);else if(rt.isUserProvided)yield rt.mute();else if(isLocalAudioTrack(rt)||isLocalVideoTrack(rt))try{if(isWeb())try{const it=yield navigator==null?void 0:navigator.permissions.query({name:rt.source===Track.Source.Camera?"camera":"microphone"});if(it&&it.state==="denied")throw this.log.warn("user has revoked access to ".concat(rt.source),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),it.onchange=()=>{it.state!=="denied"&&(rt.isMuted||rt.restartTrack(),it.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}rt.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),isLocalAudioTrack(rt)?yield rt.restartTrack({deviceId:"default"}):yield rt.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(rt))),yield rt.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=et,this.roomOptions=tt,this.setupEngine(et),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=nt}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Encryption_Type.NONE}getTrackPublication($){const _e=super.getTrackPublication($);if(_e)return _e}getTrackPublicationByName($){const _e=super.getTrackPublicationByName($);if(_e)return _e}setupEngine($){this.engine=$,this.engine.on(EngineEvent.RemoteMute,(_e,et)=>{const tt=this.trackPublications.get(_e);!tt||!tt.track||(et?tt.mute():tt.unmute())}),this.engine.on(EngineEvent.Connected,this.handleReconnected).on(EngineEvent.SignalRestarted,this.handleReconnected).on(EngineEvent.SignalResumed,this.handleReconnected).on(EngineEvent.Restarting,this.handleReconnecting).on(EngineEvent.Resuming,this.handleReconnecting).on(EngineEvent.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(EngineEvent.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(EngineEvent.Disconnected,this.handleDisconnected).on(EngineEvent.SignalRequestResponse,this.handleSignalRequestResponse).on(EngineEvent.DataPacketReceived,this.handleDataPacket)}setMetadata($){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:$})})}setName($){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:$})})}setAttributes($){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:$})})}requestMetadataUpdate($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let{metadata:tt,name:nt,attributes:rt}=_e;return function*(){return new Promise((it,st)=>__awaiter$1(et,void 0,void 0,function*(){var at,ot;try{let ct=!1;const lt=yield this.engine.client.sendUpdateLocalMetadata((at=tt??this.metadata)!==null&&at!==void 0?at:"",(ot=nt??this.name)!==null&&ot!==void 0?ot:"",rt),ut=performance.now();for(this.pendingSignalRequests.set(lt,{resolve:it,reject:pt=>{st(pt),ct=!0},values:{name:nt,metadata:tt,attributes:rt}});performance.now()-ut<5e3&&!ct;){if((!nt||this.name===nt)&&(!tt||this.metadata===tt)&&(!rt||Object.entries(rt).every(pt=>{let[dt,ht]=pt;return this.attributes[dt]===ht||ht===""&&!this.attributes[dt]}))){this.pendingSignalRequests.delete(lt),it();return}yield sleep$1(50)}st(new SignalRequestError("Request to update local metadata timed out","TimeoutError"))}catch(ct){ct instanceof Error&&st(ct)}}))}()})}setCameraEnabled($,_e,et){return this.setTrackEnabled(Track.Source.Camera,$,_e,et)}setMicrophoneEnabled($,_e,et){return this.setTrackEnabled(Track.Source.Microphone,$,_e,et)}setScreenShareEnabled($,_e,et){return this.setTrackEnabled(Track.Source.ScreenShare,$,_e,et)}setPermissions($){const _e=this.permissions,et=super.setPermissions($);return et&&_e&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,_e),et}setE2EEEnabled($){return __awaiter$1(this,void 0,void 0,function*(){this.encryptionType=$?Encryption_Type.GCM:Encryption_Type.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled($,_e,et,tt){return __awaiter$1(this,void 0,void 0,function*(){var nt,rt;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:$,enabled:_e})),this.republishPromise&&(yield this.republishPromise);let it=this.getTrackPublication($);if(_e)if(it)yield it.unmute();else{let st;if(this.pendingPublishing.has($)){const at=yield this.waitForPendingPublicationOfSource($);return at||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:$})),yield at==null?void 0:at.unmute(),at}this.pendingPublishing.add($);try{switch($){case Track.Source.Camera:st=yield this.createTracks({video:(nt=et)!==null&&nt!==void 0?nt:!0});break;case Track.Source.Microphone:st=yield this.createTracks({audio:(rt=et)!==null&&rt!==void 0?rt:!0});break;case Track.Source.ScreenShare:st=yield this.createScreenTracks(Object.assign({},et));break;default:throw new TrackInvalidError($)}}catch(at){throw st==null||st.forEach(ot=>{ot.stop()}),at instanceof Error&&this.emit(ParticipantEvent.MediaDevicesError,at),this.pendingPublishing.delete($),at}try{const at=[];for(const ct of st)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(ct))),at.push(this.publishTrack(ct,tt));[it]=yield Promise.all(at)}catch(at){throw st==null||st.forEach(ot=>{ot.stop()}),at}finally{this.pendingPublishing.delete($)}}else if(!(it!=null&&it.track)&&this.pendingPublishing.has($)&&(it=yield this.waitForPendingPublicationOfSource($),it||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:$}))),it&&it.track)if($===Track.Source.ScreenShare){it=yield this.unpublishTrack(it.track);const st=this.getTrackPublication(Track.Source.ScreenShareAudio);st&&st.track&&this.unpublishTrack(st.track)}else yield it.mute();return it})}enableCameraAndMicrophone(){return __awaiter$1(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Track.Source.Camera)||this.pendingPublishing.has(Track.Source.Microphone))){this.pendingPublishing.add(Track.Source.Camera),this.pendingPublishing.add(Track.Source.Microphone);try{const $=yield this.createTracks({audio:!0,video:!0});yield Promise.all($.map(_e=>this.publishTrack(_e)))}finally{this.pendingPublishing.delete(Track.Source.Camera),this.pendingPublishing.delete(Track.Source.Microphone)}}})}createTracks($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et;$??($={});const tt=mergeDefaultOptions($,(_e=this.roomOptions)===null||_e===void 0?void 0:_e.audioCaptureDefaults,(et=this.roomOptions)===null||et===void 0?void 0:et.videoCaptureDefaults);try{return(yield createLocalTracks(tt,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(it=>(isAudioTrack(it)&&(this.microphoneError=void 0,it.setAudioContext(this.audioContext),it.source=Track.Source.Microphone,this.emit(ParticipantEvent.AudioStreamAcquired)),isVideoTrack(it)&&(this.cameraError=void 0,it.source=Track.Source.Camera),it))}catch(nt){throw nt instanceof Error&&($.audio&&(this.microphoneError=nt),$.video&&(this.cameraError=nt)),nt}})}createScreenTracks($){return __awaiter$1(this,void 0,void 0,function*(){if($===void 0&&($={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new DeviceUnsupportedError("getDisplayMedia not supported");$.resolution===void 0&&!isSafari17()&&($.resolution=ScreenSharePresets.h1080fps30.resolution);const _e=screenCaptureToDisplayMediaStreamOptions($),et=yield navigator.mediaDevices.getDisplayMedia(_e),tt=et.getVideoTracks();if(tt.length===0)throw new TrackInvalidError("no video track found");const nt=new LocalVideoTrack(tt[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});nt.source=Track.Source.ScreenShare,$.contentHint&&(nt.mediaStreamTrack.contentHint=$.contentHint);const rt=[nt];if(et.getAudioTracks().length>0){this.emit(ParticipantEvent.AudioStreamAcquired);const it=new LocalAudioTrack(et.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});it.source=Track.Source.ScreenShareAudio,rt.push(it)}return rt})}publishTrack($,_e){return __awaiter$1(this,void 0,void 0,function*(){return this.publishOrRepublishTrack($,_e)})}publishOrRepublishTrack($,_e){return __awaiter$1(this,arguments,void 0,function(et,tt){var nt=this;let rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var it,st,at,ot;isLocalAudioTrack(et)&&et.setAudioContext(nt.audioContext),yield(it=nt.reconnectFuture)===null||it===void 0?void 0:it.promise,nt.republishPromise&&!rt&&(yield nt.republishPromise),isLocalTrack(et)&&nt.pendingPublishPromises.has(et)&&(yield nt.pendingPublishPromises.get(et));let ct;if(et instanceof MediaStreamTrack)ct=et.getConstraints();else{ct=et.constraints;let ft;switch(et.source){case Track.Source.Microphone:ft="audioinput";break;case Track.Source.Camera:ft="videoinput"}ft&&nt.activeDeviceMap.has(ft)&&(ct=Object.assign(Object.assign({},ct),{deviceId:nt.activeDeviceMap.get(ft)}))}if(et instanceof MediaStreamTrack)switch(et.kind){case"audio":et=new LocalAudioTrack(et,ct,!0,nt.audioContext,{loggerName:nt.roomOptions.loggerName,loggerContextCb:()=>nt.logContext});break;case"video":et=new LocalVideoTrack(et,ct,!0,{loggerName:nt.roomOptions.loggerName,loggerContextCb:()=>nt.logContext});break;default:throw new TrackInvalidError("unsupported MediaStreamTrack kind ".concat(et.kind))}else et.updateLoggerOptions({loggerName:nt.roomOptions.loggerName,loggerContextCb:()=>nt.logContext});let lt;if(nt.trackPublications.forEach(ft=>{ft.track&&ft.track===et&&(lt=ft)}),lt)return nt.log.warn("track has already been published, skipping",Object.assign(Object.assign({},nt.logContext),getLogContextFromTrack(lt))),lt;const ut="channelCount"in et.mediaStreamTrack.getSettings()&&et.mediaStreamTrack.getSettings().channelCount===2||et.mediaStreamTrack.getConstraints().channelCount===2,pt=(st=tt==null?void 0:tt.forceStereo)!==null&&st!==void 0?st:ut;pt&&(tt||(tt={}),tt.dtx===void 0&&nt.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},nt.logContext),getLogContextFromTrack(et))),tt.red===void 0&&nt.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(at=tt.dtx)!==null&&at!==void 0||(tt.dtx=!1),(ot=tt.red)!==null&&ot!==void 0||(tt.red=!1));const dt=Object.assign(Object.assign({},nt.roomOptions.publishDefaults),tt);!isE2EESimulcastSupported()&&nt.roomOptions.e2ee&&(nt.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},nt.logContext)),dt.simulcast=!1),dt.source&&(et.source=dt.source);const ht=new Promise((ft,mt)=>__awaiter$1(nt,void 0,void 0,function*(){try{if(this.engine.client.currentState!==SignalConnectionState.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:getLogContextFromTrack(et)}));const gt=()=>__awaiter$1(this,void 0,void 0,function*(){try{const yt=yield this.publish(et,dt,pt);ft(yt)}catch(yt){mt(yt)}});setTimeout(()=>{this.engine.off(EngineEvent.SignalConnected,gt),mt(new PublishTrackError("publishing rejected as engine not connected within timeout",408))},15e3),this.engine.once(EngineEvent.SignalConnected,gt),this.engine.on(EngineEvent.Closing,()=>{this.engine.off(EngineEvent.SignalConnected,gt),mt(new PublishTrackError("publishing rejected as engine closed",499))})}else try{const gt=yield this.publish(et,dt,pt);ft(gt)}catch(gt){mt(gt)}}catch(gt){mt(gt)}}));nt.pendingPublishPromises.set(et,ht);try{return yield ht}catch(ft){throw ft}finally{nt.pendingPublishPromises.delete(et)}}()})}hasPermissionsToPublish($){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))),!1;const{canPublish:_e,canPublishSources:et}=this.permissions;return _e&&(et.length===0||et.map(tt=>getTrackSourceFromProto(tt)).includes($.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))),!1)}publish($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){var tt,nt,rt,it,st,at,ot,ct,lt,ut;if(!this.hasPermissionsToPublish($))throw new PublishTrackError("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(vt=>isLocalTrack($)&&vt.source===$.source)&&$.source!==Track.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat($.source),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))),_e.stopMicTrackOnMute&&isAudioTrack($)&&($.stopOnMute=!0),$.source===Track.Source.ScreenShare&&isFireFox()&&(_e.simulcast=!1),_e.videoCodec==="av1"&&!supportsAV1()&&(_e.videoCodec=void 0),_e.videoCodec==="vp9"&&!supportsVP9()&&(_e.videoCodec=void 0),_e.videoCodec===void 0&&(_e.videoCodec=defaultVideoCodec),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(vt=>_e.videoCodec===mimeTypeToVideoCodecString(vt.mime))||(_e.videoCodec=mimeTypeToVideoCodecString(this.enabledPublishVideoCodecs[0].mime)));const dt=_e.videoCodec;$.on(TrackEvent.Muted,this.onTrackMuted),$.on(TrackEvent.Unmuted,this.onTrackUnmuted),$.on(TrackEvent.Ended,this.handleTrackEnded),$.on(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),$.on(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),$.on(TrackEvent.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const ht=new AddTrackRequest({cid:$.mediaStreamTrack.id,name:_e.name,type:Track.kindToProto($.kind),muted:$.isMuted,source:Track.sourceToProto($.source),disableDtx:!(!((tt=_e.dtx)!==null&&tt!==void 0)||tt),encryption:this.encryptionType,stereo:et,disableRed:this.isE2EEEnabled||!(!((nt=_e.red)!==null&&nt!==void 0)||nt),stream:_e==null?void 0:_e.stream,backupCodecPolicy:_e==null?void 0:_e.backupCodecPolicy});let ft;if($.kind===Track.Kind.Video){let vt={width:0,height:0};try{vt=yield $.waitForDimensions()}catch{const St=(it=(rt=this.roomOptions.videoCaptureDefaults)===null||rt===void 0?void 0:rt.resolution)!==null&&it!==void 0?it:VideoPresets.h720.resolution;vt={width:St.width,height:St.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($)),{dims:vt}))}ht.width=vt.width,ht.height=vt.height,isLocalVideoTrack($)&&(isSVCCodec(dt)&&($.source===Track.Source.ScreenShare&&(_e.scalabilityMode="L1T3","contentHint"in $.mediaStreamTrack&&($.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))))),_e.scalabilityMode=(st=_e.scalabilityMode)!==null&&st!==void 0?st:"L3T3_KEY"),ht.simulcastCodecs=[new SimulcastCodec({codec:dt,cid:$.mediaStreamTrack.id})],_e.backupCodec===!0&&(_e.backupCodec={codec:defaultVideoCodec}),_e.backupCodec&&dt!==_e.backupCodec.codec&&ht.encryption===Encryption_Type.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),ht.simulcastCodecs.push(new SimulcastCodec({codec:_e.backupCodec.codec,cid:""})))),ft=computeVideoEncodings($.source===Track.Source.ScreenShare,ht.width,ht.height,_e),ht.layers=videoLayersFromEncodings(ht.width,ht.height,ft,isSVCCodec(_e.videoCodec))}else $.kind===Track.Kind.Audio&&(ft=[{maxBitrate:(at=_e.audioPreset)===null||at===void 0?void 0:at.maxBitrate,priority:(ct=(ot=_e.audioPreset)===null||ot===void 0?void 0:ot.priority)!==null&&ct!==void 0?ct:"high",networkPriority:(ut=(lt=_e.audioPreset)===null||lt===void 0?void 0:lt.priority)!==null&&ut!==void 0?ut:"high"}]);if(!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const mt=()=>__awaiter$1(this,void 0,void 0,function*(){var vt,xt,St;if(!this.engine.pcManager)throw new UnexpectedConnectionState("pcManager is not ready");if($.sender=yield this.engine.createSender($,_e,ft),isLocalVideoTrack($)&&((vt=_e.degradationPreference)!==null&&vt!==void 0||(_e.degradationPreference=getDefaultDegradationPreference($)),$.setDegradationPreference(_e.degradationPreference)),ft)if(isFireFox()&&$.kind===Track.Kind.Audio){let Et;for(const wt of this.engine.pcManager.publisher.getTransceivers())if(wt.sender===$.sender){Et=wt;break}Et&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:Et,codec:"opus",maxbr:!((xt=ft[0])===null||xt===void 0)&&xt.maxBitrate?ft[0].maxBitrate/1e3:0})}else $.codec&&isSVCCodec($.codec)&&(!((St=ft[0])===null||St===void 0)&&St.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:ht.cid,codec:$.codec,maxbr:ft[0].maxBitrate/1e3});yield this.engine.negotiate()});let gt;if(this.enabledPublishVideoCodecs.length>0)gt=(yield Promise.all([this.engine.addTrack(ht),mt()]))[0];else{gt=yield this.engine.addTrack(ht);let vt;if(gt.codecs.forEach(xt=>{vt===void 0&&(vt=xt.mimeType)}),vt&&$.kind===Track.Kind.Video){const xt=mimeTypeToVideoCodecString(vt);xt!==dt&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($)),{codec:xt})),_e.videoCodec=xt,ft=computeVideoEncodings($.source===Track.Source.ScreenShare,ht.width,ht.height,_e))}yield mt()}const yt=new LocalTrackPublication($.kind,gt,$,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return yt.options=_e,$.sid=gt.sid,this.log.debug("publishing ".concat($.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:ft,trackInfo:gt})),isLocalVideoTrack($)?$.startMonitor(this.engine.client):isLocalAudioTrack($)&&$.startMonitor(),this.addTrackPublication(yt),this.emit(ParticipantEvent.LocalTrackPublished,yt),yt})}get isLocal(){return!0}publishAdditionalCodecForTrack($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){var tt;if(this.encryptionType!==Encryption_Type.NONE)return;let nt;if(this.trackPublications.forEach(ut=>{ut.track&&ut.track===$&&(nt=ut)}),!nt)throw new TrackInvalidError("track is not published");if(!isLocalVideoTrack($))throw new TrackInvalidError("track is not a video track");const rt=Object.assign(Object.assign({},(tt=this.roomOptions)===null||tt===void 0?void 0:tt.publishDefaults),et),it=computeTrackBackupEncodings($,_e,rt);if(!it){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($)));return}const st=$.addSimulcastTrack(_e,it);if(!st)return;const at=new AddTrackRequest({cid:st.mediaStreamTrack.id,type:Track.kindToProto($.kind),muted:$.isMuted,source:Track.sourceToProto($.source),sid:$.sid,simulcastCodecs:[{codec:rt.videoCodec,cid:st.mediaStreamTrack.id}]});if(at.layers=videoLayersFromEncodings(at.width,at.height,it),!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const ot=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender($,st,rt,it),yield this.engine.negotiate()}),lt=(yield Promise.all([this.engine.addTrack(at),ot()]))[0];this.log.debug("published ".concat(_e," for track ").concat($.sid),Object.assign(Object.assign({},this.logContext),{encodings:it,trackInfo:lt}))})}unpublishTrack($,_e){return __awaiter$1(this,void 0,void 0,function*(){var et,tt;if(isLocalTrack($)){const at=this.pendingPublishPromises.get($);at&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))),yield at)}const nt=this.getPublicationForTrack($),rt=nt?getLogContextFromTrack(nt):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),rt)),!nt||!nt.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),rt));return}$=nt.track,$.off(TrackEvent.Muted,this.onTrackMuted),$.off(TrackEvent.Unmuted,this.onTrackUnmuted),$.off(TrackEvent.Ended,this.handleTrackEnded),$.off(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),$.off(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),$.off(TrackEvent.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),_e===void 0&&(_e=(tt=(et=this.roomOptions)===null||et===void 0?void 0:et.stopLocalTrackOnUnpublish)!==null&&tt!==void 0?tt:!0),_e?$.stop():$.stopMonitor();let it=!1;const st=$.sender;if($.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<PCTransportState.FAILED&&st)try{for(const at of this.engine.pcManager.publisher.getTransceivers())at.sender===st&&(at.direction="inactive",it=!0);if(this.engine.removeTrack(st)&&(it=!0),isLocalVideoTrack($)){for(const[,at]of $.simulcastCodecs)at.sender&&(this.engine.removeTrack(at.sender)&&(it=!0),at.sender=void 0);$.simulcastCodecs.clear()}}catch(at){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),rt),{error:at}))}switch(this.trackPublications.delete(nt.trackSid),nt.kind){case Track.Kind.Audio:this.audioTrackPublications.delete(nt.trackSid);break;case Track.Kind.Video:this.videoTrackPublications.delete(nt.trackSid);break}return this.emit(ParticipantEvent.LocalTrackUnpublished,nt),nt.setTrack(void 0),it&&(yield this.engine.negotiate()),nt})}unpublishTracks($){return __awaiter$1(this,void 0,void 0,function*(){return(yield Promise.all($.map(et=>this.unpublishTrack(et)))).filter(et=>!!et)})}republishAllTracks($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){et.republishPromise&&(yield et.republishPromise),et.republishPromise=new Promise((nt,rt)=>__awaiter$1(et,void 0,void 0,function*(){try{const it=[];this.trackPublications.forEach(st=>{st.track&&(_e&&(st.options=Object.assign(Object.assign({},st.options),_e)),it.push(st))}),yield Promise.all(it.map(st=>__awaiter$1(this,void 0,void 0,function*(){const at=st.track;yield this.unpublishTrack(at,!1),tt&&!at.isMuted&&at.source!==Track.Source.ScreenShare&&at.source!==Track.Source.ScreenShareAudio&&(isLocalAudioTrack(at)||isLocalVideoTrack(at))&&!at.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:st.trackSid})),yield at.restartTrack()),yield this.publishOrRepublishTrack(at,st.options,!0)}))),nt()}catch(it){rt(it)}finally{this.republishPromise=void 0}})),yield et.republishPromise}()})}publishData($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const nt=tt.reliable?DataPacket_Kind.RELIABLE:DataPacket_Kind.LOSSY,rt=tt.destinationIdentities,it=tt.topic,st=new DataPacket({kind:nt,value:{case:"user",value:new UserPacket({participantIdentity:et.identity,payload:_e,destinationIdentities:rt,topic:it})}});yield et.engine.sendDataPacket(st,nt)}()})}publishDtmf($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=new DataPacket({kind:DataPacket_Kind.RELIABLE,value:{case:"sipDtmf",value:new SipDTMF({code:$,digit:_e})}});yield this.engine.sendDataPacket(et,DataPacket_Kind.RELIABLE)})}sendChatMessage($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et={id:crypto.randomUUID(),message:$,timestamp:Date.now(),attachedFiles:_e==null?void 0:_e.attachments},tt=new DataPacket({value:{case:"chatMessage",value:new ChatMessage(Object.assign(Object.assign({},et),{timestamp:protoInt64.parse(et.timestamp)}))}});return yield this.engine.sendDataPacket(tt,DataPacket_Kind.RELIABLE),this.emit(ParticipantEvent.ChatMessage,et),et})}editChatMessage($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=Object.assign(Object.assign({},_e),{message:$,editTimestamp:Date.now()}),tt=new DataPacket({value:{case:"chatMessage",value:new ChatMessage(Object.assign(Object.assign({},et),{timestamp:protoInt64.parse(et.timestamp),editTimestamp:protoInt64.parse(et.editTimestamp)}))}});return yield this.engine.sendDataPacket(tt,DataPacket_Kind.RELIABLE),this.emit(ParticipantEvent.ChatMessage,et),et})}sendText($,_e){return __awaiter$1(this,void 0,void 0,function*(){var et;const tt=crypto.randomUUID(),rt=new TextEncoder().encode($).byteLength,it=(et=_e==null?void 0:_e.attachments)===null||et===void 0?void 0:et.map(()=>crypto.randomUUID()),st=new Array(it?it.length+1:1).fill(0),at=(ct,lt)=>{var ut;st[lt]=ct;const pt=st.reduce((dt,ht)=>dt+ht,0);(ut=_e==null?void 0:_e.onProgress)===null||ut===void 0||ut.call(_e,pt)},ot=yield this.streamText({streamId:tt,totalSize:rt,destinationIdentities:_e==null?void 0:_e.destinationIdentities,topic:_e==null?void 0:_e.topic,attachedStreamIds:it,attributes:_e==null?void 0:_e.attributes});return yield ot.write($),at(1,0),yield ot.close(),_e!=null&&_e.attachments&&it&&(yield Promise.all(_e.attachments.map((ct,lt)=>__awaiter$1(this,void 0,void 0,function*(){return this._sendFile(it[lt],ct,{topic:_e.topic,mimeType:ct.type,onProgress:ut=>{at(ut,lt+1)}})})))),ot.info})}streamText($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et;const tt=(_e=$==null?void 0:$.streamId)!==null&&_e!==void 0?_e:crypto.randomUUID(),nt={id:tt,mimeType:"text/plain",timestamp:Date.now(),topic:(et=$==null?void 0:$.topic)!==null&&et!==void 0?et:"",size:$==null?void 0:$.totalSize,attributes:$==null?void 0:$.attributes},rt=new DataStream_Header({streamId:tt,mimeType:nt.mimeType,topic:nt.topic,timestamp:numberToBigInt(nt.timestamp),totalLength:numberToBigInt($==null?void 0:$.totalSize),attributes:nt.attributes,contentHeader:{case:"textHeader",value:new DataStream_TextHeader({version:$==null?void 0:$.version,attachedStreamIds:$==null?void 0:$.attachedStreamIds,replyToStreamId:$==null?void 0:$.replyToStreamId,operationType:($==null?void 0:$.type)==="update"?DataStream_OperationType.UPDATE:DataStream_OperationType.CREATE})}}),it=$==null?void 0:$.destinationIdentities,st=new DataPacket({destinationIdentities:it,value:{case:"streamHeader",value:rt}});yield this.engine.sendDataPacket(st,DataPacket_Kind.RELIABLE);let at=0;const ot=this,ct=new WritableStream({write(pt){return __awaiter$1(this,void 0,void 0,function*(){for(const dt of splitUtf8(pt,STREAM_CHUNK_SIZE)){yield ot.engine.waitForBufferStatusLow(DataPacket_Kind.RELIABLE);const ht=new DataStream_Chunk({content:dt,streamId:tt,chunkIndex:numberToBigInt(at)}),ft=new DataPacket({destinationIdentities:it,value:{case:"streamChunk",value:ht}});yield ot.engine.sendDataPacket(ft,DataPacket_Kind.RELIABLE),at+=1}})},close(){return __awaiter$1(this,void 0,void 0,function*(){const pt=new DataStream_Trailer({streamId:tt}),dt=new DataPacket({destinationIdentities:it,value:{case:"streamTrailer",value:pt}});yield ot.engine.sendDataPacket(dt,DataPacket_Kind.RELIABLE)})},abort(pt){console.log("Sink error:",pt)}});let lt=()=>__awaiter$1(this,void 0,void 0,function*(){yield ut.close()});ot.engine.once(EngineEvent.Closing,lt);const ut=new TextStreamWriter(ct,nt,()=>this.engine.off(EngineEvent.Closing,lt));return ut})}sendFile($,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=crypto.randomUUID();return yield this._sendFile(et,$,_e),{id:et}})}_sendFile($,_e,et){return __awaiter$1(this,void 0,void 0,function*(){var tt;const nt=yield this.streamBytes({streamId:$,totalSize:_e.size,name:_e.name,mimeType:(tt=et==null?void 0:et.mimeType)!==null&&tt!==void 0?tt:_e.type,topic:et==null?void 0:et.topic,destinationIdentities:et==null?void 0:et.destinationIdentities}),rt=_e.stream().getReader();for(;;){const{done:it,value:st}=yield rt.read();if(it)break;yield nt.write(st)}return yield nt.close(),nt.info})}streamBytes($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et,tt,nt,rt;const it=(_e=$==null?void 0:$.streamId)!==null&&_e!==void 0?_e:crypto.randomUUID(),st=$==null?void 0:$.destinationIdentities,at={id:it,mimeType:(et=$==null?void 0:$.mimeType)!==null&&et!==void 0?et:"application/octet-stream",topic:(tt=$==null?void 0:$.topic)!==null&&tt!==void 0?tt:"",timestamp:Date.now(),attributes:$==null?void 0:$.attributes,size:$==null?void 0:$.totalSize,name:(nt=$==null?void 0:$.name)!==null&&nt!==void 0?nt:"unknown"},ot=new DataStream_Header({totalLength:numberToBigInt((rt=at.size)!==null&&rt!==void 0?rt:0),mimeType:at.mimeType,streamId:it,topic:at.topic,timestamp:numberToBigInt(Date.now()),contentHeader:{case:"byteHeader",value:new DataStream_ByteHeader({name:at.name})}}),ct=new DataPacket({destinationIdentities:st,value:{case:"streamHeader",value:ot}});yield this.engine.sendDataPacket(ct,DataPacket_Kind.RELIABLE);let lt=0;const ut=new _$1,pt=this.engine,dt=this.log,ht=new WritableStream({write(mt){return __awaiter$1(this,void 0,void 0,function*(){const gt=yield ut.lock();let yt=0;try{for(;yt<mt.byteLength;){const vt=mt.slice(yt,yt+STREAM_CHUNK_SIZE);yield pt.waitForBufferStatusLow(DataPacket_Kind.RELIABLE);const xt=new DataPacket({destinationIdentities:st,value:{case:"streamChunk",value:new DataStream_Chunk({content:vt,streamId:it,chunkIndex:numberToBigInt(lt)})}});yield pt.sendDataPacket(xt,DataPacket_Kind.RELIABLE),lt+=1,yt+=vt.byteLength}}finally{gt()}})},close(){return __awaiter$1(this,void 0,void 0,function*(){const mt=new DataStream_Trailer({streamId:it}),gt=new DataPacket({destinationIdentities:st,value:{case:"streamTrailer",value:mt}});yield pt.sendDataPacket(gt,DataPacket_Kind.RELIABLE)})},abort(mt){dt.error("Sink error:",mt)}});return new ByteStreamWriter(ht,at)})}performRpc($){return __awaiter$1(this,arguments,void 0,function(_e){var et=this;let{destinationIdentity:tt,method:nt,payload:rt,responseTimeout:it=1e4}=_e;return function*(){return new Promise((at,ot)=>__awaiter$1(et,void 0,void 0,function*(){var ct,lt,ut,pt;if(byteLength(rt)>MAX_PAYLOAD_BYTES){ot(RpcError.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((lt=(ct=this.engine.latestJoinResponse)===null||ct===void 0?void 0:ct.serverInfo)===null||lt===void 0)&&lt.version&&compareVersions((pt=(ut=this.engine.latestJoinResponse)===null||ut===void 0?void 0:ut.serverInfo)===null||pt===void 0?void 0:pt.version,"1.8.0")<0){ot(RpcError.builtIn("UNSUPPORTED_SERVER"));return}const dt=crypto.randomUUID();yield this.publishRpcRequest(tt,dt,nt,rt,it-2e3);const ht=setTimeout(()=>{this.pendingAcks.delete(dt),ot(RpcError.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(dt),clearTimeout(ft)},2e3);this.pendingAcks.set(dt,{resolve:()=>{clearTimeout(ht)},participantIdentity:tt});const ft=setTimeout(()=>{this.pendingResponses.delete(dt),ot(RpcError.builtIn("RESPONSE_TIMEOUT"))},it);this.pendingResponses.set(dt,{resolve:(mt,gt)=>{clearTimeout(ft),this.pendingAcks.has(dt)&&(console.warn("RPC response received before ack",dt),this.pendingAcks.delete(dt),clearTimeout(ht)),gt?ot(gt):at(mt??"")},participantIdentity:tt})}))}()})}registerRpcMethod($,_e){this.rpcHandlers.has($)&&this.log.warn("you're overriding the RPC handler for method ".concat($,", in the future this will throw an error")),this.rpcHandlers.set($,_e)}unregisterRpcMethod($){this.rpcHandlers.delete($)}setTrackSubscriptionPermissions($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=_e,this.allParticipantsAllowedToSubscribe=$,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck($){const _e=this.pendingAcks.get($);_e?(_e.resolve(),this.pendingAcks.delete($)):console.error("Ack received for unexpected RPC request",$)}handleIncomingRpcResponse($,_e,et){const tt=this.pendingResponses.get($);tt?(tt.resolve(_e,et),this.pendingResponses.delete($)):console.error("Response received for unexpected RPC request",$)}publishRpcRequest($,_e,et,tt,nt){return __awaiter$1(this,void 0,void 0,function*(){const rt=new DataPacket({destinationIdentities:[$],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcRequest",value:new RpcRequest({id:_e,method:et,payload:tt,responseTimeoutMs:nt,version:1})}});yield this.engine.sendDataPacket(rt,DataPacket_Kind.RELIABLE)})}handleParticipantDisconnected($){for(const[_e,{participantIdentity:et}]of this.pendingAcks)et===$&&this.pendingAcks.delete(_e);for(const[_e,{participantIdentity:et,resolve:tt}]of this.pendingResponses)et===$&&(tt(null,RpcError.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(_e))}setEnabledPublishCodecs($){this.enabledPublishVideoCodecs=$.filter(_e=>_e.mime.split("/")[0].toLowerCase()==="video")}updateInfo($){return $.sid!==this.sid||!super.updateInfo($)?!1:($.tracks.forEach(_e=>{var et,tt;const nt=this.trackPublications.get(_e.sid);if(nt){const rt=nt.isMuted||((tt=(et=nt.track)===null||et===void 0?void 0:et.isUpstreamPaused)!==null&&tt!==void 0?tt:!1);rt!==_e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(nt)),{mutedOnServer:rt})),this.engine.client.sendMuteTrack(_e.sid,rt))}}),!0)}getPublicationForTrack($){let _e;return this.trackPublications.forEach(et=>{const tt=et.track;tt&&($ instanceof MediaStreamTrack?(isLocalAudioTrack(tt)||isLocalVideoTrack(tt))&&tt.mediaStreamTrack===$&&(_e=et):$===tt&&(_e=et))}),_e}waitForPendingPublicationOfSource($){return __awaiter$1(this,void 0,void 0,function*(){const et=Date.now();for(;Date.now()<et+1e4;){const tt=Array.from(this.pendingPublishPromises.entries()).find(nt=>{let[rt]=nt;return rt.source===$});if(tt)return tt[1];yield sleep$1(20)}})}}class RemoteTrackPublication extends TrackPublication{constructor($,_e,et,tt){super($,_e.sid,_e.name,tt),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=VideoQuality.HIGH,this.handleEnded=nt=>{this.setTrack(void 0),this.emit(TrackEvent.Ended,nt)},this.handleVisibilityChange=nt=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(nt),this.logContext),this.disabled=!nt,this.emitTrackUpdate()},this.handleVideoDimensionsChange=nt=>{this.log.debug("adaptivestream video dimensions ".concat(nt.width,"x").concat(nt.height),this.logContext),this.videoDimensions=nt,this.emitTrackUpdate()},this.subscribed=et,this.updateInfo(_e)}setSubscribed($){const _e=this.subscriptionStatus,et=this.permissionStatus;this.subscribed=$,$&&(this.allowed=!0);const tt=new UpdateSubscription({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ParticipantTracks({participantSid:"",trackSids:[this.trackSid]})]});this.emit(TrackEvent.UpdateSubscription,tt),this.emitSubscriptionUpdateIfChanged(_e),this.emitPermissionUpdateIfChanged(et)}get subscriptionStatus(){return this.subscribed===!1?TrackPublication.SubscriptionStatus.Unsubscribed:super.isSubscribed?TrackPublication.SubscriptionStatus.Subscribed:TrackPublication.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?TrackPublication.PermissionStatus.Allowed:TrackPublication.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled($){!this.isManualOperationAllowed()||this.disabled===!$||(this.disabled=!$,this.emitTrackUpdate())}setVideoQuality($){!this.isManualOperationAllowed()||this.currentVideoQuality===$||(this.currentVideoQuality=$,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions($){var _e,et;this.isManualOperationAllowed()&&(((_e=this.videoDimensions)===null||_e===void 0?void 0:_e.width)===$.width&&((et=this.videoDimensions)===null||et===void 0?void 0:et.height)===$.height||(isRemoteVideoTrack(this.track)&&(this.videoDimensions=$),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS($){this.isManualOperationAllowed()&&isRemoteVideoTrack(this.track)&&this.fps!==$&&(this.fps=$,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack($){const _e=this.subscriptionStatus,et=this.permissionStatus,tt=this.track;tt!==$&&(tt&&(tt.off(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),tt.off(TrackEvent.VisibilityChanged,this.handleVisibilityChange),tt.off(TrackEvent.Ended,this.handleEnded),tt.detach(),tt.stopMonitor(),this.emit(TrackEvent.Unsubscribed,tt)),super.setTrack($),$&&($.sid=this.trackSid,$.on(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),$.on(TrackEvent.VisibilityChanged,this.handleVisibilityChange),$.on(TrackEvent.Ended,this.handleEnded),this.emit(TrackEvent.Subscribed,$)),this.emitPermissionUpdateIfChanged(et),this.emitSubscriptionUpdateIfChanged(_e))}setAllowed($){const _e=this.subscriptionStatus,et=this.permissionStatus;this.allowed=$,this.emitPermissionUpdateIfChanged(et),this.emitSubscriptionUpdateIfChanged(_e)}setSubscriptionError($){this.emit(TrackEvent.SubscriptionFailed,$)}updateInfo($){super.updateInfo($);const _e=this.metadataMuted;this.metadataMuted=$.muted,this.track?this.track.setMuted($.muted):_e!==$.muted&&this.emit($.muted?TrackEvent.Muted:TrackEvent.Unmuted)}emitSubscriptionUpdateIfChanged($){const _e=this.subscriptionStatus;$!==_e&&this.emit(TrackEvent.SubscriptionStatusChanged,_e,$)}emitPermissionUpdateIfChanged($){this.permissionStatus!==$&&this.emit(TrackEvent.SubscriptionPermissionChanged,this.permissionStatus,$)}isManualOperationAllowed(){return this.kind===Track.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return isRemoteVideoTrack(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const $=new UpdateTrackSettings({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?($.width=Math.ceil(this.videoDimensions.width),$.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?$.quality=this.currentVideoQuality:$.quality=VideoQuality.HIGH,this.emit(TrackEvent.UpdateSettings,$)}}class RemoteParticipant extends Participant{static fromParticipantInfo($,_e,et){return new RemoteParticipant($,_e.sid,_e.identity,_e.name,_e.metadata,_e.attributes,et,_e.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor($,_e,et,tt,nt,rt,it){let st=arguments.length>7&&arguments[7]!==void 0?arguments[7]:ParticipantInfo_Kind.STANDARD;super(_e,et||"",tt,nt,rt,it,st),this.signalClient=$,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication($){super.addTrackPublication($),$.on(TrackEvent.UpdateSettings,_e=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack($))),this.signalClient.sendUpdateTrackSettings(_e)}),$.on(TrackEvent.UpdateSubscription,_e=>{_e.participantTracks.forEach(et=>{et.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(_e)}),$.on(TrackEvent.SubscriptionPermissionChanged,_e=>{this.emit(ParticipantEvent.TrackSubscriptionPermissionChanged,$,_e)}),$.on(TrackEvent.SubscriptionStatusChanged,_e=>{this.emit(ParticipantEvent.TrackSubscriptionStatusChanged,$,_e)}),$.on(TrackEvent.Subscribed,_e=>{this.emit(ParticipantEvent.TrackSubscribed,_e,$)}),$.on(TrackEvent.Unsubscribed,_e=>{this.emit(ParticipantEvent.TrackUnsubscribed,_e,$)}),$.on(TrackEvent.SubscriptionFailed,_e=>{this.emit(ParticipantEvent.TrackSubscriptionFailed,$.trackSid,_e)})}getTrackPublication($){const _e=super.getTrackPublication($);if(_e)return _e}getTrackPublicationByName($){const _e=super.getTrackPublicationByName($);if(_e)return _e}setVolume($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Track.Source.Microphone;this.volumeMap.set(_e,$);const et=this.getTrackPublication(_e);et&&et.track&&et.track.setVolume($)}getVolume(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Track.Source.Microphone;const _e=this.getTrackPublication($);return _e&&_e.track?_e.track.getVolume():this.volumeMap.get($)}addSubscribedMediaTrack($,_e,et,tt,nt,rt){let it=this.getTrackPublicationBySid(_e);if(it||_e.startsWith("TR")||this.trackPublications.forEach(ot=>{!it&&$.kind===ot.kind.toString()&&(it=ot)}),!it){if(rt===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:_e})),this.emit(ParticipantEvent.TrackSubscriptionFailed,_e);return}rt===void 0&&(rt=20),setTimeout(()=>{this.addSubscribedMediaTrack($,_e,et,tt,nt,rt-1)},150);return}if($.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(it))),this.emit(ParticipantEvent.TrackSubscriptionFailed,_e);return}const st=$.kind==="video";let at;return st?at=new RemoteVideoTrack($,_e,tt,nt):at=new RemoteAudioTrack($,_e,tt,this.audioContext,this.audioOutput),at.source=it.source,at.isMuted=it.isMuted,at.setMediaStream(et),at.start(),it.setTrack(at),this.volumeMap.has(it.source)&&isRemoteTrack(at)&&isAudioTrack(at)&&at.setVolume(this.volumeMap.get(it.source)),it}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid($){return this.trackPublications.get($)}updateInfo($){if(!super.updateInfo($))return!1;const _e=new Map,et=new Map;return $.tracks.forEach(tt=>{var nt,rt;let it=this.getTrackPublicationBySid(tt.sid);if(it)it.updateInfo(tt);else{const st=Track.kindFromProto(tt.type);if(!st)return;it=new RemoteTrackPublication(st,tt,(nt=this.signalClient.connectOptions)===null||nt===void 0?void 0:nt.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(rt=this.loggerOptions)===null||rt===void 0?void 0:rt.loggerName}),it.updateInfo(tt),et.set(tt.sid,it);const at=Array.from(this.trackPublications.values()).find(ot=>ot.source===(it==null?void 0:it.source));at&&it.source!==Track.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(it.source),Object.assign(Object.assign({},this.logContext),{oldTrack:getLogContextFromTrack(at),newTrack:getLogContextFromTrack(it)})),this.addTrackPublication(it)}_e.set(tt.sid,it)}),this.trackPublications.forEach(tt=>{_e.has(tt.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(tt))),this.unpublishTrack(tt.trackSid,!0))}),et.forEach(tt=>{this.emit(ParticipantEvent.TrackPublished,tt)}),!0}unpublishTrack($,_e){const et=this.trackPublications.get($);if(!et)return;const{track:tt}=et;switch(tt&&(tt.stop(),et.setTrack(void 0)),this.trackPublications.delete($),et.kind){case Track.Kind.Audio:this.audioTrackPublications.delete($);break;case Track.Kind.Video:this.videoTrackPublications.delete($);break}_e&&this.emit(ParticipantEvent.TrackUnpublished,et)}setAudioOutput($){return __awaiter$1(this,void 0,void 0,function*(){this.audioOutput=$;const _e=[];this.audioTrackPublications.forEach(et=>{var tt;isAudioTrack(et.track)&&isRemoteTrack(et.track)&&_e.push(et.track.setSinkId((tt=$.deviceId)!==null&&tt!==void 0?tt:"default"))}),yield Promise.all(_e)})}emit($){for(var _e=arguments.length,et=new Array(_e>1?_e-1:0),tt=1;tt<_e;tt++)et[tt-1]=arguments[tt];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:$,args:et})),super.emit($,...et)}}var ConnectionState;(function(j){j.Disconnected="disconnected",j.Connecting="connecting",j.Connected="connected",j.Reconnecting="reconnecting",j.SignalReconnecting="signalReconnecting"})(ConnectionState||(ConnectionState={}));const connectionReconcileFrequency=4*1e3;class Room extends eventsExports.EventEmitter{constructor($){var _e,et,tt,nt;if(super(),_e=this,this.state=ConnectionState.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=livekitLogger,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(rt,it,st)=>__awaiter$1(this,void 0,void 0,function*(){var at;if(!isBrowserSupported())throw isReactNative$1()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const ot=yield this.disconnectLock.lock();if(this.state===ConnectionState.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),ot(),Promise.resolve();if(this.connectFuture)return ot(),this.connectFuture.promise;this.setAndEmitConnectionState(ConnectionState.Connecting),((at=this.regionUrlProvider)===null||at===void 0?void 0:at.getServerUrl().toString())!==rt&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),isCloud(new URL(rt))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new RegionUrlProvider(rt,it):this.regionUrlProvider.updateToken(it),this.regionUrlProvider.fetchRegionSettings().then(ut=>{var pt;(pt=this.regionUrlProvider)===null||pt===void 0||pt.setServerReportedRegions(ut)}).catch(ut=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:ut}))}));const ct=(ut,pt,dt)=>__awaiter$1(this,void 0,void 0,function*(){var ht,ft;this.abortController&&this.abortController.abort();const mt=new AbortController;this.abortController=mt,ot==null||ot();try{yield this.attemptConnection(dt??rt,it,st,mt),this.abortController=void 0,ut()}catch(gt){if(this.regionUrlProvider&&gt instanceof ConnectionError&&gt.reason!==ConnectionErrorReason.Cancelled&&gt.reason!==ConnectionErrorReason.NotAllowed){let yt=null;try{yt=yield this.regionUrlProvider.getNextBestRegionUrl((ht=this.abortController)===null||ht===void 0?void 0:ht.signal)}catch(vt){if(vt instanceof ConnectionError&&(vt.status===401||vt.reason===ConnectionErrorReason.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),pt(vt);return}}yt&&!(!((ft=this.abortController)===null||ft===void 0)&&ft.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(gt.message,". Retrying with another region: ").concat(yt),this.logContext),this.recreateEngine(),yield ct(ut,pt,yt)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,getDisconnectReasonFromConnectionError(gt)),pt(gt))}else{let yt=DisconnectReason.UNKNOWN_REASON;gt instanceof ConnectionError&&(yt=getDisconnectReasonFromConnectionError(gt)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,yt),pt(gt)}}}),lt=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Future((ut,pt)=>{ct(ut,pt,lt)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(rt,it,st,at,ot,ct)=>__awaiter$1(this,void 0,void 0,function*(){var lt,ut,pt;const dt=yield st.join(rt,it,{autoSubscribe:at.autoSubscribe,adaptiveStream:typeof ot.adaptiveStream=="object"?!0:ot.adaptiveStream,maxRetries:at.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:at.websocketTimeout},ct.signal);let ht=dt.serverInfo;if(ht||(ht={version:dt.serverVersion,region:dt.serverRegion}),this.serverInfo=ht,this.log.debug("connected to Livekit Server ".concat(Object.entries(ht).map(ft=>{let[mt,gt]=ft;return"".concat(mt,": ").concat(gt)}).join(", ")),{room:(lt=dt.room)===null||lt===void 0?void 0:lt.name,roomSid:(ut=dt.room)===null||ut===void 0?void 0:ut.sid,identity:(pt=dt.participant)===null||pt===void 0?void 0:pt.identity}),!ht.version)throw new UnsupportedServer("unknown server version");return ht.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),ot.dynacast=!1),dt}),this.applyJoinResponse=rt=>{const it=rt.participant;if(this.localParticipant.sid=it.sid,this.localParticipant.identity=it.identity,this.localParticipant.setEnabledPublishCodecs(rt.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(rt.sifTrailer)}catch(st){this.log.error(st instanceof Error?st.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:st}))}this.handleParticipantUpdates([it,...rt.otherParticipants]),rt.room&&this.handleRoomUpdate(rt.room)},this.attemptConnection=(rt,it,st,at)=>__awaiter$1(this,void 0,void 0,function*(){var ot,ct;this.state===ConnectionState.Reconnecting||this.isResuming||!((ot=this.engine)===null||ot===void 0)&&ot.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((ct=this.regionUrlProvider)===null||ct===void 0)&&ct.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},roomConnectOptionDefaults),st),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const lt=yield this.connectSignal(rt,it,this.engine,this.connOptions,this.options,at);this.applyJoinResponse(lt),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected)}catch(lt){yield this.engine.close(),this.recreateEngine();const ut=new ConnectionError("could not establish signal connection",ConnectionErrorReason.ServerUnreachable);throw lt instanceof Error&&(ut.message="".concat(ut.message,": ").concat(lt.message)),lt instanceof ConnectionError&&(ut.reason=lt.reason,ut.status=lt.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:lt})),ut}if(at.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new ConnectionError("Connection attempt aborted",ConnectionErrorReason.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,at)}catch(lt){throw yield this.engine.close(),this.recreateEngine(),lt}isWeb()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),isWeb()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var rt=arguments.length,it=new Array(rt),st=0;st<rt;st++)it[st]=arguments[st];return __awaiter$1(_e,[...it],void 0,function(){var at=this;let ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var ct,lt,ut,pt;const dt=yield at.disconnectLock.lock();try{if(at.state===ConnectionState.Disconnected){at.log.debug("already disconnected",at.logContext);return}at.log.info("disconnect from room",Object.assign({},at.logContext)),(at.state===ConnectionState.Connecting||at.state===ConnectionState.Reconnecting||at.isResuming)&&(at.log.warn("abort connection attempt",at.logContext),(ct=at.abortController)===null||ct===void 0||ct.abort(),(ut=(lt=at.connectFuture)===null||lt===void 0?void 0:lt.reject)===null||ut===void 0||ut.call(lt,new ConnectionError("Client initiated disconnect",ConnectionErrorReason.Cancelled)),at.connectFuture=void 0),!((pt=at.engine)===null||pt===void 0)&&pt.client.isDisconnected||(yield at.engine.client.sendLeave()),at.engine&&(yield at.engine.close()),at.handleDisconnect(ot,DisconnectReason.CLIENT_INITIATED),at.engine=void 0}finally{dt()}}()})},this.onPageLeave=()=>__awaiter$1(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>__awaiter$1(this,void 0,void 0,function*(){const rt=[],it=getBrowser();if(it&&it.os==="iOS"){const st="livekit-dummy-audio-el";let at=document.getElementById(st);if(!at){at=document.createElement("audio"),at.id=st,at.autoplay=!0,at.hidden=!0;const ot=getEmptyAudioStreamTrack();ot.enabled=!0;const ct=new MediaStream([ot]);at.srcObject=ct,document.addEventListener("visibilitychange",()=>{at&&(at.srcObject=document.hidden?null:ct,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(at),this.once(RoomEvent.Disconnected,()=>{at==null||at.remove(),at=null})}rt.push(at)}this.remoteParticipants.forEach(st=>{st.audioTrackPublications.forEach(at=>{at.track&&at.track.attachedElements.forEach(ot=>{rt.push(ot)})})});try{yield Promise.all([this.acquireAudioContext(),...rt.map(st=>(st.muted=!1,st.play()))]),this.handleAudioPlaybackStarted()}catch(st){throw this.handleAudioPlaybackFailed(st),st}}),this.startVideo=()=>__awaiter$1(this,void 0,void 0,function*(){const rt=[];for(const it of this.remoteParticipants.values())it.videoTrackPublications.forEach(st=>{var at;(at=st.track)===null||at===void 0||at.attachedElements.forEach(ot=>{rt.includes(ot)||rt.push(ot)})});yield Promise.all(rt.map(it=>it.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(it=>{it.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const rt of this.remoteParticipants.values())this.handleParticipantDisconnected(rt.identity,rt);this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)},this.handleSignalRestarted=rt=>__awaiter$1(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(rt.serverRegion),Object.assign(Object.assign({},this.logContext),{region:rt.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(rt);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(it){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:it}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:rt.serverRegion}))}catch{return}this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=rt=>{rt.forEach(it=>{var st;if(it.identity===this.localParticipant.identity){this.localParticipant.updateInfo(it);return}it.identity===""&&(it.identity=(st=this.sidToIdentity.get(it.sid))!==null&&st!==void 0?st:"");let at=this.remoteParticipants.get(it.identity);it.state===ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(it.identity,at):at=this.getOrCreateParticipant(it.identity,it)})},this.handleActiveSpeakersUpdate=rt=>{const it=[],st={};rt.forEach(at=>{if(st[at.sid]=!0,at.sid===this.localParticipant.sid)this.localParticipant.audioLevel=at.level,this.localParticipant.setIsSpeaking(!0),it.push(this.localParticipant);else{const ot=this.getRemoteParticipantBySid(at.sid);ot&&(ot.audioLevel=at.level,ot.setIsSpeaking(!0),it.push(ot))}}),st[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(at=>{st[at.sid]||(at.audioLevel=0,at.setIsSpeaking(!1))}),this.activeSpeakers=it,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,it)},this.handleSpeakersChanged=rt=>{const it=new Map;this.activeSpeakers.forEach(at=>{const ot=this.remoteParticipants.get(at.identity);ot&&ot.sid!==at.sid||it.set(at.sid,at)}),rt.forEach(at=>{let ot=this.getRemoteParticipantBySid(at.sid);at.sid===this.localParticipant.sid&&(ot=this.localParticipant),ot&&(ot.audioLevel=at.level,ot.setIsSpeaking(at.active),at.active?it.set(at.sid,ot):it.delete(at.sid))});const st=Array.from(it.values());st.sort((at,ot)=>ot.audioLevel-at.audioLevel),this.activeSpeakers=st,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,st)},this.handleStreamStateUpdate=rt=>{rt.streamStates.forEach(it=>{const st=this.getRemoteParticipantBySid(it.participantSid);if(!st)return;const at=st.getTrackPublicationBySid(it.trackSid);if(!at||!at.track)return;const ot=Track.streamStateFromProto(it.state);ot!==at.track.streamState&&(at.track.streamState=ot,st.emit(ParticipantEvent.TrackStreamStateChanged,at,at.track.streamState),this.emitWhenConnected(RoomEvent.TrackStreamStateChanged,at,at.track.streamState,st))})},this.handleSubscriptionPermissionUpdate=rt=>{const it=this.getRemoteParticipantBySid(rt.participantSid);if(!it)return;const st=it.getTrackPublicationBySid(rt.trackSid);st&&st.setAllowed(rt.allowed)},this.handleSubscriptionError=rt=>{const it=Array.from(this.remoteParticipants.values()).find(at=>at.trackPublications.has(rt.trackSid));if(!it)return;const st=it.getTrackPublicationBySid(rt.trackSid);st&&st.setSubscriptionError(rt.err)},this.handleDataPacket=rt=>{const it=this.remoteParticipants.get(rt.participantIdentity);if(rt.value.case==="user")this.handleUserPacket(it,rt.value.value,rt.kind);else if(rt.value.case==="transcription")this.handleTranscription(it,rt.value.value);else if(rt.value.case==="sipDtmf")this.handleSipDtmf(it,rt.value.value);else if(rt.value.case==="chatMessage")this.handleChatMessage(it,rt.value.value);else if(rt.value.case==="metrics")this.handleMetrics(rt.value.value,it);else if(rt.value.case==="streamHeader")this.handleStreamHeader(rt.value.value,rt.participantIdentity);else if(rt.value.case==="streamChunk")this.handleStreamChunk(rt.value.value);else if(rt.value.case==="streamTrailer")this.handleStreamTrailer(rt.value.value);else if(rt.value.case==="rpcRequest"){const st=rt.value.value;this.handleIncomingRpcRequest(rt.participantIdentity,st.id,st.method,st.payload,st.responseTimeoutMs,st.version)}},this.handleUserPacket=(rt,it,st)=>{this.emit(RoomEvent.DataReceived,it.payload,rt,st,it.topic),rt==null||rt.emit(ParticipantEvent.DataReceived,it.payload,st)},this.handleSipDtmf=(rt,it)=>{this.emit(RoomEvent.SipDTMFReceived,it,rt),rt==null||rt.emit(ParticipantEvent.SipDTMFReceived,it)},this.bufferedSegments=new Map,this.handleTranscription=(rt,it)=>{const st=it.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(it.transcribedParticipantIdentity),at=st==null?void 0:st.trackPublications.get(it.trackId),ot=extractTranscriptionSegments(it,this.transcriptionReceivedTimes);at==null||at.emit(TrackEvent.TranscriptionReceived,ot),st==null||st.emit(ParticipantEvent.TranscriptionReceived,ot,at),this.emit(RoomEvent.TranscriptionReceived,ot,st,at)},this.handleChatMessage=(rt,it)=>{const st=extractChatMessage(it);this.emit(RoomEvent.ChatMessage,st,rt)},this.handleMetrics=(rt,it)=>{this.emit(RoomEvent.MetricsReceived,rt,it)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=rt=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:rt})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(RoomEvent.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(RoomEvent.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>__awaiter$1(this,void 0,void 0,function*(){var rt,it;const st=DeviceManager.getInstance().previousDevices,at=yield DeviceManager.getInstance().getDevices(void 0,!1),ot=getBrowser();if((ot==null?void 0:ot.name)==="Chrome"&&ot.os!=="iOS")for(let lt of at){const ut=st.find(pt=>pt.deviceId===lt.deviceId);ut&&ut.label!==""&&ut.kind===lt.kind&&ut.label!==lt.label&&this.getActiveDevice(lt.kind)==="default"&&this.emit(RoomEvent.ActiveDeviceChanged,lt.kind,lt.deviceId)}const ct=["audiooutput","audioinput","videoinput"];for(let lt of ct){const ut=at.filter(dt=>dt.kind===lt),pt=this.getActiveDevice(lt);if(pt===((rt=st.filter(dt=>dt.kind===lt)[0])===null||rt===void 0?void 0:rt.deviceId)&&ut.length>0&&((it=ut[0])===null||it===void 0?void 0:it.deviceId)!==pt){yield this.switchActiveDevice(lt,ut[0].deviceId);continue}lt==="audioinput"&&!isSafari()||lt==="videoinput"||ut.length>0&&!ut.find(dt=>dt.deviceId===this.getActiveDevice(lt))&&(yield this.switchActiveDevice(lt,ut[0].deviceId))}this.emit(RoomEvent.MediaDevicesChanged)}),this.handleRoomUpdate=rt=>{const it=this.roomInfo;this.roomInfo=rt,it&&it.metadata!==rt.metadata&&this.emitWhenConnected(RoomEvent.RoomMetadataChanged,rt.metadata),(it==null?void 0:it.activeRecording)!==rt.activeRecording&&this.emitWhenConnected(RoomEvent.RecordingStatusChanged,rt.activeRecording)},this.handleConnectionQualityUpdate=rt=>{rt.updates.forEach(it=>{if(it.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(it.quality);return}const st=this.getRemoteParticipantBySid(it.participantSid);st&&st.setConnectionQuality(it.quality)})},this.onLocalParticipantMetadataChanged=rt=>{this.emit(RoomEvent.ParticipantMetadataChanged,rt,this.localParticipant)},this.onLocalParticipantNameChanged=rt=>{this.emit(RoomEvent.ParticipantNameChanged,rt,this.localParticipant)},this.onLocalAttributesChanged=rt=>{this.emit(RoomEvent.ParticipantAttributesChanged,rt,this.localParticipant)},this.onLocalTrackMuted=rt=>{this.emit(RoomEvent.TrackMuted,rt,this.localParticipant)},this.onLocalTrackUnmuted=rt=>{this.emit(RoomEvent.TrackUnmuted,rt,this.localParticipant)},this.onTrackProcessorUpdate=rt=>{var it;(it=rt==null?void 0:rt.onPublish)===null||it===void 0||it.call(rt,this)},this.onLocalTrackPublished=rt=>__awaiter$1(this,void 0,void 0,function*(){var it,st,at,ot,ct,lt;(it=rt.track)===null||it===void 0||it.on(TrackEvent.TrackProcessorUpdate,this.onTrackProcessorUpdate),(st=rt.track)===null||st===void 0||st.on(TrackEvent.Restarted,this.onLocalTrackRestarted),(ct=(ot=(at=rt.track)===null||at===void 0?void 0:at.getProcessor())===null||ot===void 0?void 0:ot.onPublish)===null||ct===void 0||ct.call(ot,this),this.emit(RoomEvent.LocalTrackPublished,rt,this.localParticipant),isLocalAudioTrack(rt.track)&&(yield rt.track.checkForSilence())&&this.emit(RoomEvent.LocalAudioSilenceDetected,rt);const ut=yield(lt=rt.track)===null||lt===void 0?void 0:lt.getDeviceId(!1),pt=sourceToKind(rt.source);pt&&ut&&ut!==this.localParticipant.activeDeviceMap.get(pt)&&(this.localParticipant.activeDeviceMap.set(pt,ut),this.emit(RoomEvent.ActiveDeviceChanged,pt,ut))}),this.onLocalTrackUnpublished=rt=>{var it,st;(it=rt.track)===null||it===void 0||it.off(TrackEvent.TrackProcessorUpdate,this.onTrackProcessorUpdate),(st=rt.track)===null||st===void 0||st.off(TrackEvent.Restarted,this.onLocalTrackRestarted),this.emit(RoomEvent.LocalTrackUnpublished,rt,this.localParticipant)},this.onLocalTrackRestarted=rt=>__awaiter$1(this,void 0,void 0,function*(){const it=yield rt.getDeviceId(!1),st=sourceToKind(rt.source);st&&it&&it!==this.localParticipant.activeDeviceMap.get(st)&&(this.log.debug("local track restarted, setting ".concat(st," ").concat(it," active"),this.logContext),this.localParticipant.activeDeviceMap.set(st,it),this.emit(RoomEvent.ActiveDeviceChanged,st,it))}),this.onLocalConnectionQualityChanged=rt=>{this.emit(RoomEvent.ConnectionQualityChanged,rt,this.localParticipant)},this.onMediaDevicesError=rt=>{this.emit(RoomEvent.MediaDevicesError,rt)},this.onLocalParticipantPermissionsChanged=rt=>{this.emit(RoomEvent.ParticipantPermissionsChanged,rt,this.localParticipant)},this.onLocalChatMessageSent=rt=>{this.emit(RoomEvent.ChatMessage,rt,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},roomOptionDefaults),$),this.log=getLogger$1((et=this.options.loggerName)!==null&&et!==void 0?et:LoggerNames.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},audioDefaults),$==null?void 0:$.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},videoDefaults),$==null?void 0:$.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},publishDefaults),$==null?void 0:$.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new _$1,this.localParticipant=new LocalParticipant("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",unwrapConstraint(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",unwrapConstraint(this.options.audioCaptureDefaults.deviceId)),!((tt=this.options.audioOutput)===null||tt===void 0)&&tt.deviceId&&this.switchActiveDevice("audiooutput",unwrapConstraint(this.options.audioOutput.deviceId)).catch(rt=>this.log.warn("Could not set audio output: ".concat(rt.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),isWeb()){const rt=new AbortController;(nt=navigator.mediaDevices)===null||nt===void 0||nt.addEventListener("devicechange",this.handleDeviceChange,{signal:rt.signal}),Room.cleanupRegistry&&Room.cleanupRegistry.register(this,()=>{rt.abort()})}}registerTextStreamHandler($,_e){if(this.textStreamHandlers.has($))throw new TypeError('A text stream handler for topic "'.concat($,'" has already been set.'));this.textStreamHandlers.set($,_e)}unregisterTextStreamHandler($){this.textStreamHandlers.delete($)}registerByteStreamHandler($,_e){if(this.byteStreamHandlers.has($))throw new TypeError('A byte stream handler for topic "'.concat($,'" has already been set.'));this.byteStreamHandlers.set($,_e)}unregisterByteStreamHandler($){this.byteStreamHandlers.delete($)}registerRpcMethod($,_e){if(this.rpcHandlers.has($))throw Error("RPC handler already registered for method ".concat($,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set($,_e)}unregisterRpcMethod($){this.rpcHandlers.delete($)}handleIncomingRpcRequest($,_e,et,tt,nt,rt){return __awaiter$1(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck($,_e),rt!==1){yield this.engine.publishRpcResponse($,_e,null,RpcError.builtIn("UNSUPPORTED_VERSION"));return}const it=this.rpcHandlers.get(et);if(!it){yield this.engine.publishRpcResponse($,_e,null,RpcError.builtIn("UNSUPPORTED_METHOD"));return}let st=null,at=null;try{const ot=yield it({requestId:_e,callerIdentity:$,payload:tt,responseTimeout:nt});byteLength(ot)>MAX_PAYLOAD_BYTES?(st=RpcError.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(et))):at=ot}catch(ot){ot instanceof RpcError?st=ot:(console.warn("Uncaught error returned by RPC handler for ".concat(et,". Returning APPLICATION_ERROR instead."),ot),st=RpcError.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse($,_e,at,st)})}setE2EEEnabled($){return __awaiter$1(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled($)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled($,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var $;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new E2EEManager(this.options.e2ee),this.e2eeManager.on(EncryptionEvent.ParticipantEncryptionStatusChanged,(_e,et)=>{isLocalParticipant(et)&&(this.isE2EEEnabled=_e),this.emit(RoomEvent.ParticipantEncryptionStatusChanged,_e,et)}),this.e2eeManager.on(EncryptionEvent.EncryptionError,_e=>this.emit(RoomEvent.EncryptionError,_e)),($=this.e2eeManager)===null||$===void 0||$.setup(this))}get logContext(){var $;return{room:this.name,roomID:($=this.roomInfo)===null||$===void 0?void 0:$.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var $,_e;return(_e=($=this.roomInfo)===null||$===void 0?void 0:$.activeRecording)!==null&&_e!==void 0?_e:!1}getSid(){return __awaiter$1(this,void 0,void 0,function*(){return this.state===ConnectionState.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise(($,_e)=>{const et=tt=>{tt.sid!==""&&(this.engine.off(EngineEvent.RoomUpdate,et),$(tt.sid))};this.engine.on(EngineEvent.RoomUpdate,et),this.once(RoomEvent.Disconnected,()=>{this.engine.off(EngineEvent.RoomUpdate,et),_e("Room disconnected before room server id was available")})})})}get name(){var $,_e;return(_e=($=this.roomInfo)===null||$===void 0?void 0:$.name)!==null&&_e!==void 0?_e:""}get metadata(){var $;return($=this.roomInfo)===null||$===void 0?void 0:$.metadata}get numParticipants(){var $,_e;return(_e=($=this.roomInfo)===null||$===void 0?void 0:$.numParticipants)!==null&&_e!==void 0?_e:0}get numPublishers(){var $,_e;return(_e=($=this.roomInfo)===null||$===void 0?void 0:$.numPublishers)!==null&&_e!==void 0?_e:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new RTCEngine(this.options),this.engine.on(EngineEvent.ParticipantUpdate,this.handleParticipantUpdates).on(EngineEvent.RoomUpdate,this.handleRoomUpdate).on(EngineEvent.SpeakersChanged,this.handleSpeakersChanged).on(EngineEvent.StreamStateChanged,this.handleStreamStateUpdate).on(EngineEvent.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(EngineEvent.SubscriptionError,this.handleSubscriptionError).on(EngineEvent.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(EngineEvent.MediaTrackAdded,($,_e,et)=>{this.onTrackAdded($,_e,et)}).on(EngineEvent.Disconnected,$=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,$)}).on(EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(EngineEvent.DataPacketReceived,this.handleDataPacket).on(EngineEvent.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(ConnectionState.SignalReconnecting)&&this.emit(RoomEvent.SignalReconnecting)}).on(EngineEvent.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(ConnectionState.Connected)&&this.emit(RoomEvent.Reconnected)}).on(EngineEvent.SignalResumed,()=>{this.bufferedEvents=[],(this.state===ConnectionState.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(EngineEvent.Restarting,this.handleRestarting).on(EngineEvent.SignalRestarted,this.handleSignalRestarted).on(EngineEvent.Offline,()=>{this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)}).on(EngineEvent.DCBufferStatusChanged,($,_e)=>{this.emit(RoomEvent.DCBufferStatusChanged,$,_e)}).on(EngineEvent.LocalTrackSubscribed,$=>{const _e=this.localParticipant.getTrackPublications().find(et=>{let{trackSid:tt}=et;return tt===$});if(!_e){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ParticipantEvent.LocalTrackSubscribed,_e),this.emitWhenConnected(RoomEvent.LocalTrackSubscribed,_e,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return DeviceManager.getInstance().getDevices($,_e)}prepareConnection($,_e){return __awaiter$1(this,void 0,void 0,function*(){if(this.state===ConnectionState.Disconnected){this.log.debug("prepareConnection to ".concat($),this.logContext);try{if(isCloud(new URL($))&&_e){this.regionUrlProvider=new RegionUrlProvider($,_e);const et=yield this.regionUrlProvider.getNextBestRegionUrl();et&&this.state===ConnectionState.Disconnected&&(this.regionUrl=et,yield fetch(toHttpUrl(et),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(et),this.logContext))}else yield fetch(toHttpUrl($),{method:"HEAD"})}catch(et){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:et}))}}})}getParticipantByIdentity($){return this.localParticipant.identity===$?this.localParticipant:this.remoteParticipants.get($)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario($,_e){return __awaiter$1(this,void 0,void 0,function*(){let et=()=>{},tt;switch($){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":tt=new SimulateScenario({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":tt=new SimulateScenario({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":tt=new SimulateScenario({scenario:{case:"serverLeave",value:!0}});break;case"migration":tt=new SimulateScenario({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":et=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),tt=new SimulateScenario({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":et=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),tt=new SimulateScenario({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":tt=new SimulateScenario({scenario:{case:"switchCandidateProtocol",value:$==="force-tls"?2:1}}),et=()=>__awaiter$1(this,void 0,void 0,function*(){const nt=this.engine.client.onLeave;nt&&nt(new LeaveRequest({reason:DisconnectReason.CLIENT_INITIATED,action:LeaveRequest_Action.RECONNECT}))});break;case"subscriber-bandwidth":if(_e===void 0||typeof _e!="number")throw new Error("subscriber-bandwidth requires a number as argument");tt=new SimulateScenario({scenario:{case:"subscriberBandwidth",value:numberToBigInt(_e)}});break;case"leave-full-reconnect":tt=new SimulateScenario({scenario:{case:"leaveRequestFullReconnect",value:!0}})}tt&&(yield this.engine.client.sendSimulateScenario(tt),yield et())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice($){return this.localParticipant.activeDeviceMap.get($)}switchActiveDevice($,_e){return __awaiter$1(this,arguments,void 0,function(et,tt){var nt=this;let rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var it,st,at,ot,ct,lt,ut,pt;let dt=!0,ht=!1;const ft=rt?{exact:tt}:tt;if(et==="audioinput"){ht=nt.localParticipant.audioTrackPublications.size===0;const mt=(it=nt.getActiveDevice(et))!==null&&it!==void 0?it:nt.options.audioCaptureDefaults.deviceId;nt.options.audioCaptureDefaults.deviceId=ft;const gt=Array.from(nt.localParticipant.audioTrackPublications.values()).filter(yt=>yt.source===Track.Source.Microphone);try{dt=(yield Promise.all(gt.map(yt=>{var vt;return(vt=yt.audioTrack)===null||vt===void 0?void 0:vt.setDeviceId(ft)}))).every(yt=>yt===!0)}catch(yt){throw nt.options.audioCaptureDefaults.deviceId=mt,yt}}else if(et==="videoinput"){ht=nt.localParticipant.videoTrackPublications.size===0;const mt=(st=nt.getActiveDevice(et))!==null&&st!==void 0?st:nt.options.videoCaptureDefaults.deviceId;nt.options.videoCaptureDefaults.deviceId=ft;const gt=Array.from(nt.localParticipant.videoTrackPublications.values()).filter(yt=>yt.source===Track.Source.Camera);try{dt=(yield Promise.all(gt.map(yt=>{var vt;return(vt=yt.videoTrack)===null||vt===void 0?void 0:vt.setDeviceId(ft)}))).every(yt=>yt===!0)}catch(yt){throw nt.options.videoCaptureDefaults.deviceId=mt,yt}}else if(et==="audiooutput"){if(!supportsSetSinkId()&&!nt.options.webAudioMix||nt.options.webAudioMix&&nt.audioContext&&!("setSinkId"in nt.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");nt.options.webAudioMix&&(tt=(at=yield DeviceManager.getInstance().normalizeDeviceId("audiooutput",tt))!==null&&at!==void 0?at:""),(ot=(pt=nt.options).audioOutput)!==null&&ot!==void 0||(pt.audioOutput={});const mt=(ct=nt.getActiveDevice(et))!==null&&ct!==void 0?ct:nt.options.audioOutput.deviceId;nt.options.audioOutput.deviceId=tt;try{nt.options.webAudioMix&&((lt=nt.audioContext)===null||lt===void 0||lt.setSinkId(tt)),yield Promise.all(Array.from(nt.remoteParticipants.values()).map(gt=>gt.setAudioOutput({deviceId:tt})))}catch(gt){throw nt.options.audioOutput.deviceId=mt,gt}}return(ht||et==="audiooutput")&&(nt.localParticipant.activeDeviceMap.set(et,et==="audiooutput"&&((ut=nt.options.audioOutput)===null||ut===void 0?void 0:ut.deviceId)||tt),nt.emit(RoomEvent.ActiveDeviceChanged,et,tt)),dt}()})}setupLocalParticipantEvents(){this.localParticipant.on(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ParticipantEvent.AttributesChanged,this.onLocalAttributesChanged).on(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).on(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).on(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).on(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).on(ParticipantEvent.AudioStreamAcquired,this.startAudio).on(ParticipantEvent.ChatMessage,this.onLocalChatMessageSent).on(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var $;($=this.engine)===null||$===void 0||$.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded($,_e,et){if(this.state===ConnectionState.Connecting||this.state===ConnectionState.Reconnecting){const ot=()=>{this.onTrackAdded($,_e,et),ct()},ct=()=>{this.off(RoomEvent.Reconnected,ot),this.off(RoomEvent.Connected,ot),this.off(RoomEvent.Disconnected,ct)};this.once(RoomEvent.Reconnected,ot),this.once(RoomEvent.Connected,ot),this.once(RoomEvent.Disconnected,ct);return}if(this.state===ConnectionState.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if($.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const tt=unpackStreamId(_e.id),nt=tt[0];let rt=tt[1],it=$.id;if(rt&&rt.startsWith("TR")&&(it=rt),nt===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const st=Array.from(this.remoteParticipants.values()).find(ot=>ot.sid===nt);if(!st){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(nt),this.logContext);return}let at;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?at=this.options.adaptiveStream:at={}),st.addSubscribedMediaTrack($,it,_e,et,at)}handleDisconnect(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,_e=arguments.length>1?arguments[1]:void 0;var et;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==ConnectionState.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(tt=>{tt.trackPublications.forEach(nt=>{tt.unpublishTrack(nt.trackSid)})}),this.localParticipant.trackPublications.forEach(tt=>{var nt,rt,it;tt.track&&this.localParticipant.unpublishTrack(tt.track,$),$?((nt=tt.track)===null||nt===void 0||nt.detach(),(rt=tt.track)===null||rt===void 0||rt.stop()):(it=tt.track)===null||it===void 0||it.stopMonitor()}),this.localParticipant.off(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ParticipantEvent.AttributesChanged,this.onLocalAttributesChanged).off(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).off(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).off(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).off(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).off(ParticipantEvent.AudioStreamAcquired,this.startAudio).off(ParticipantEvent.ChatMessage,this.onLocalChatMessageSent).off(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),isWeb()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(et=navigator.mediaDevices)===null||et===void 0||et.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ConnectionState.Disconnected),this.emit(RoomEvent.Disconnected,_e)}}}handleParticipantDisconnected($,_e){var et;this.remoteParticipants.delete($),_e&&(_e.trackPublications.forEach(tt=>{_e.unpublishTrack(tt.trackSid,!0)}),this.emit(RoomEvent.ParticipantDisconnected,_e),(et=this.localParticipant)===null||et===void 0||et.handleParticipantDisconnected(_e.identity))}handleStreamHeader($,_e){return __awaiter$1(this,void 0,void 0,function*(){var et;if($.contentHeader.case==="byteHeader"){const tt=this.byteStreamHandlers.get($.topic);if(!tt){this.log.debug("ignoring incoming byte stream due to no handler for topic",$.topic);return}let nt;const rt={id:$.streamId,name:(et=$.contentHeader.value.name)!==null&&et!==void 0?et:"unknown",mimeType:$.mimeType,size:$.totalLength?Number($.totalLength):void 0,topic:$.topic,timestamp:bigIntToNumber($.timestamp),attributes:$.attributes},it=new ReadableStream({start:st=>{nt=st,this.byteStreamControllers.set($.streamId,{info:rt,controller:nt,startTime:Date.now()})}});tt(new ByteStreamReader(rt,it,bigIntToNumber($.totalLength)),{identity:_e})}else if($.contentHeader.case==="textHeader"){const tt=this.textStreamHandlers.get($.topic);if(!tt){this.log.debug("ignoring incoming text stream due to no handler for topic",$.topic);return}let nt;const rt={id:$.streamId,mimeType:$.mimeType,size:$.totalLength?Number($.totalLength):void 0,topic:$.topic,timestamp:Number($.timestamp),attributes:$.attributes},it=new ReadableStream({start:st=>{nt=st,this.textStreamControllers.set($.streamId,{info:rt,controller:nt,startTime:Date.now()})}});tt(new TextStreamReader(rt,it,bigIntToNumber($.totalLength)),{identity:_e})}})}handleStreamChunk($){const _e=this.byteStreamControllers.get($.streamId);_e&&$.content.length>0&&_e.controller.enqueue($);const et=this.textStreamControllers.get($.streamId);et&&$.content.length>0&&et.controller.enqueue($)}handleStreamTrailer($){const _e=this.textStreamControllers.get($.streamId);_e&&(_e.info.attributes=Object.assign(Object.assign({},_e.info.attributes),$.attributes),_e.controller.close(),this.textStreamControllers.delete($.streamId));const et=this.byteStreamControllers.get($.streamId);et&&(et.info.attributes=Object.assign(Object.assign({},et.info.attributes),$.attributes),et.controller.close(),this.byteStreamControllers.delete($.streamId))}acquireAudioContext(){return __awaiter$1(this,void 0,void 0,function*(){var $,_e;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=($=getNewAudioContext())!==null&&$!==void 0?$:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(tt=>tt.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),sleep$1(200)])}catch(tt){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:tt}))}const et=((_e=this.audioContext)===null||_e===void 0?void 0:_e.state)==="running";et!==this.canPlaybackAudio&&(this.audioEnabled=et,this.emit(RoomEvent.AudioPlaybackStatusChanged,et))})}createParticipant($,_e){var et;let tt;return _e?tt=RemoteParticipant.fromParticipantInfo(this.engine.client,_e,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):tt=new RemoteParticipant(this.engine.client,"",$,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&tt.setAudioContext(this.audioContext),!((et=this.options.audioOutput)===null||et===void 0)&&et.deviceId&&tt.setAudioOutput(this.options.audioOutput).catch(nt=>this.log.warn("Could not set audio output: ".concat(nt.message),this.logContext)),tt}getOrCreateParticipant($,_e){if(this.remoteParticipants.has($)){const tt=this.remoteParticipants.get($);return _e&&tt.updateInfo(_e)&&this.sidToIdentity.set(_e.sid,_e.identity),tt}const et=this.createParticipant($,_e);return this.remoteParticipants.set($,et),this.sidToIdentity.set(_e.sid,_e.identity),this.emitWhenConnected(RoomEvent.ParticipantConnected,et),et.on(ParticipantEvent.TrackPublished,tt=>{this.emitWhenConnected(RoomEvent.TrackPublished,tt,et)}).on(ParticipantEvent.TrackSubscribed,(tt,nt)=>{tt.kind===Track.Kind.Audio?(tt.on(TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),tt.on(TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):tt.kind===Track.Kind.Video&&(tt.on(TrackEvent.VideoPlaybackFailed,this.handleVideoPlaybackFailed),tt.on(TrackEvent.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(RoomEvent.TrackSubscribed,tt,nt,et)}).on(ParticipantEvent.TrackUnpublished,tt=>{this.emit(RoomEvent.TrackUnpublished,tt,et)}).on(ParticipantEvent.TrackUnsubscribed,(tt,nt)=>{this.emit(RoomEvent.TrackUnsubscribed,tt,nt,et)}).on(ParticipantEvent.TrackMuted,tt=>{this.emitWhenConnected(RoomEvent.TrackMuted,tt,et)}).on(ParticipantEvent.TrackUnmuted,tt=>{this.emitWhenConnected(RoomEvent.TrackUnmuted,tt,et)}).on(ParticipantEvent.ParticipantMetadataChanged,tt=>{this.emitWhenConnected(RoomEvent.ParticipantMetadataChanged,tt,et)}).on(ParticipantEvent.ParticipantNameChanged,tt=>{this.emitWhenConnected(RoomEvent.ParticipantNameChanged,tt,et)}).on(ParticipantEvent.AttributesChanged,tt=>{this.emitWhenConnected(RoomEvent.ParticipantAttributesChanged,tt,et)}).on(ParticipantEvent.ConnectionQualityChanged,tt=>{this.emitWhenConnected(RoomEvent.ConnectionQualityChanged,tt,et)}).on(ParticipantEvent.ParticipantPermissionsChanged,tt=>{this.emitWhenConnected(RoomEvent.ParticipantPermissionsChanged,tt,et)}).on(ParticipantEvent.TrackSubscriptionStatusChanged,(tt,nt)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionStatusChanged,tt,nt,et)}).on(ParticipantEvent.TrackSubscriptionFailed,(tt,nt)=>{this.emit(RoomEvent.TrackSubscriptionFailed,tt,et,nt)}).on(ParticipantEvent.TrackSubscriptionPermissionChanged,(tt,nt)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionPermissionChanged,tt,nt,et)}),_e&&et.updateInfo(_e),et}sendSyncState(){const $=Array.from(this.remoteParticipants.values()).reduce((et,tt)=>(et.push(...tt.getTrackPublications()),et),[]),_e=this.localParticipant.getTrackPublications();this.engine.sendSyncState($,_e)}updateSubscriptions(){for(const $ of this.remoteParticipants.values())for(const _e of $.videoTrackPublications.values())_e.isSubscribed&&isRemotePub(_e)&&_e.emitTrackUpdate()}getRemoteParticipantBySid($){const _e=this.sidToIdentity.get($);if(_e)return this.remoteParticipants.get(_e)}registerConnectionReconcile(){this.clearConnectionReconcile();let $=0;this.connectionReconcileInterval=CriticalTimers.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?($++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:$,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),$>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,DisconnectReason.STATE_MISMATCH))):$=0},connectionReconcileFrequency)}clearConnectionReconcile(){this.connectionReconcileInterval&&CriticalTimers.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState($){return $===this.state?!1:(this.state=$,this.emit(RoomEvent.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach($=>{let[_e,et]=$;this.emit(_e,...et)}),this.bufferedEvents=[]}emitWhenConnected($){for(var _e=arguments.length,et=new Array(_e>1?_e-1:0),tt=1;tt<_e;tt++)et[tt-1]=arguments[tt];if(this.state===ConnectionState.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([$,et]);else if(this.state===ConnectionState.Connected)return this.emit($,...et);return!1}simulateParticipants($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et;const tt=Object.assign({audio:!0,video:!0,useRealTracks:!1},$.publish),nt=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},$.participants);if(this.handleDisconnect(),this.roomInfo=new Room$1({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:protoInt64.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new ParticipantInfo({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected),this.emit(RoomEvent.Connected),this.setAndEmitConnectionState(ConnectionState.Connected),tt.video){const rt=new LocalTrackPublication(Track.Kind.Video,new TrackInfo({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO,name:"video-dummy"}),new LocalVideoTrack(tt.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:createDummyVideoStreamTrack(160*((_e=nt.aspectRatios[0])!==null&&_e!==void 0?_e:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(rt),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,rt)}if(tt.audio){const rt=new LocalTrackPublication(Track.Kind.Audio,new TrackInfo({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO}),new LocalAudioTrack(tt.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:getEmptyAudioStreamTrack(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(rt),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,rt)}for(let rt=0;rt<nt.count-1;rt+=1){let it=new ParticipantInfo({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(rt),state:ParticipantInfo_State.ACTIVE,tracks:[],joinedAt:protoInt64.parse(Date.now())});const st=this.getOrCreateParticipant(it.identity,it);if(nt.video){const at=createDummyVideoStreamTrack(160*((et=nt.aspectRatios[rt%nt.aspectRatios.length])!==null&&et!==void 0?et:1),160,!1,!0),ot=new TrackInfo({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});st.addSubscribedMediaTrack(at,ot.sid,new MediaStream([at]),new RTCRtpReceiver),it.tracks=[...it.tracks,ot]}if(nt.audio){const at=getEmptyAudioStreamTrack(),ot=new TrackInfo({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});st.addSubscribedMediaTrack(at,ot.sid,new MediaStream([at]),new RTCRtpReceiver),it.tracks=[...it.tracks,ot]}st.updateInfo(it)}})}emit($){for(var _e=arguments.length,et=new Array(_e>1?_e-1:0),tt=1;tt<_e;tt++)et[tt-1]=arguments[tt];if($!==RoomEvent.ActiveSpeakersChanged&&$!==RoomEvent.TranscriptionReceived){const nt=mapArgs(et).filter(rt=>rt!==void 0);this.log.debug("room event ".concat($),Object.assign(Object.assign({},this.logContext),{event:$,args:nt}))}return super.emit($,...et)}}Room.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(j=>{j()});function mapArgs(j){return j.map($=>{if($)return Array.isArray($)?mapArgs($):typeof $=="object"?"logContext"in $?$.logContext:void 0:$})}var CheckStatus;(function(j){j[j.IDLE=0]="IDLE",j[j.RUNNING=1]="RUNNING",j[j.SKIPPED=2]="SKIPPED",j[j.SUCCESS=3]="SUCCESS",j[j.FAILED=4]="FAILED"})(CheckStatus||(CheckStatus={}));class Checker extends eventsExports.EventEmitter{constructor($,_e){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=CheckStatus.IDLE,this.logs=[],this.options={},this.url=$,this.token=_e,this.name=this.constructor.name,this.room=new Room(et.roomOptions),this.connectOptions=et.connectOptions,this.options=et}run($){return __awaiter$1(this,void 0,void 0,function*(){if(this.status!==CheckStatus.IDLE)throw Error("check is running already");this.setStatus(CheckStatus.RUNNING);try{yield this.perform()}catch(_e){_e instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(_e.message):this.appendError(_e.message))}return yield this.disconnect(),yield new Promise(_e=>setTimeout(_e,500)),this.status!==CheckStatus.SKIPPED&&this.setStatus(this.isSuccess()?CheckStatus.SUCCESS:CheckStatus.FAILED),$&&$(),this.getInfo()})}isSuccess(){return!this.logs.some($=>$.level==="error")}connect($){return __awaiter$1(this,void 0,void 0,function*(){return this.room.state===ConnectionState.Connected?this.room:($||($=this.url),yield this.room.connect($,this.token,this.connectOptions),this.room)})}disconnect(){return __awaiter$1(this,void 0,void 0,function*(){this.room&&this.room.state!==ConnectionState.Disconnected&&(yield this.room.disconnect(),yield new Promise($=>setTimeout($,500)))})}skip(){this.setStatus(CheckStatus.SKIPPED)}switchProtocol($){return __awaiter$1(this,void 0,void 0,function*(){let _e=!1,et=!1;if(this.room.on(RoomEvent.Reconnecting,()=>{_e=!0}),this.room.once(RoomEvent.Reconnected,()=>{et=!0}),this.room.simulateScenario("force-".concat($)),yield new Promise(nt=>setTimeout(nt,1e3)),!_e)return;const tt=Date.now()+1e4;for(;Date.now()<tt;){if(et)return;yield sleep$1(100)}throw new Error("Could not reconnect using ".concat($," protocol after 10 seconds"))})}appendMessage($){this.logs.push({level:"info",message:$}),this.emit("update",this.getInfo())}appendWarning($){this.logs.push({level:"warning",message:$}),this.emit("update",this.getInfo())}appendError($){this.logs.push({level:"error",message:$}),this.emit("update",this.getInfo())}setStatus($){this.status=$,this.emit("update",this.getInfo())}get engine(){var $;return($=this.room)===null||$===void 0?void 0:$.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class CloudRegionCheck extends Checker{get description(){return"Cloud regions"}perform(){return __awaiter$1(this,void 0,void 0,function*(){const $=new RegionUrlProvider(this.url,this.token);if(!$.isCloud()){this.skip();return}const _e=[],et=new Set;for(let nt=0;nt<3;nt++){const rt=yield $.getNextBestRegionUrl();if(!rt)break;if(et.has(rt))continue;et.add(rt);const it=yield this.checkCloudRegion(rt);this.appendMessage("".concat(it.region," RTT: ").concat(it.rtt,"ms, duration: ").concat(it.duration,"ms")),_e.push(it)}_e.sort((nt,rt)=>(nt.duration-rt.duration)*.5+(nt.rtt-rt.rtt)*.5);const tt=_e[0];this.bestStats=tt,this.appendMessage("best Cloud region: ".concat(tt.region))})}getInfo(){const $=super.getInfo();return $.data=this.bestStats,$}checkCloudRegion($){return __awaiter$1(this,void 0,void 0,function*(){var _e,et;yield this.connect($),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const tt=(_e=this.room.serverInfo)===null||_e===void 0?void 0:_e.region;if(!tt)throw new Error("Region not found");const nt=yield this.room.localParticipant.streamText({topic:"test"}),rt=1e3,st=1e6/rt,at="A".repeat(rt),ot=Date.now();for(let pt=0;pt<st;pt++)yield nt.write(at);yield nt.close();const ct=Date.now(),lt=yield(et=this.room.engine.pcManager)===null||et===void 0?void 0:et.publisher.getStats(),ut={region:tt,rtt:1e4,duration:ct-ot};return lt==null||lt.forEach(pt=>{pt.type==="candidate-pair"&&pt.nominated&&(ut.rtt=pt.currentRoundTripTime*1e3)}),yield this.disconnect(),ut})}}const TEST_DURATION=1e4;class ConnectionProtocolCheck extends Checker{get description(){return"Connection via UDP vs TCP"}perform(){return __awaiter$1(this,void 0,void 0,function*(){const $=yield this.checkConnectionProtocol("udp"),_e=yield this.checkConnectionProtocol("tcp");this.bestStats=$,$.qualityLimitationDurations.bandwidth-_e.qualityLimitationDurations.bandwidth>.5||($.packetsLost-_e.packetsLost)/$.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=_e):this.appendMessage("best connection quality via udp");const et=this.bestStats;this.appendMessage("upstream bitrate: ".concat((et.bitrateTotal/et.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((et.rttTotal/et.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((et.jitterTotal/et.count*1e3).toFixed(2)," ms")),et.packetsLost>0&&this.appendWarning("packets lost: ".concat((et.packetsLost/et.packetsSent*100).toFixed(2),"%")),et.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((et.qualityLimitationDurations.bandwidth/(TEST_DURATION/1e3)*100).toFixed(2),"%")),et.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((et.qualityLimitationDurations.cpu/(TEST_DURATION/1e3)*100).toFixed(2),"%"))})}getInfo(){const $=super.getInfo();return $.data=this.bestStats,$}checkConnectionProtocol($){return __awaiter$1(this,void 0,void 0,function*(){yield this.connect(),$==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const _e=document.createElement("canvas");_e.width=1280,_e.height=720;const et=_e.getContext("2d");if(!et)throw new Error("Could not get canvas context");let tt=0;const nt=()=>{tt=(tt+1)%360,et.fillStyle="hsl(".concat(tt,", 100%, 50%)"),et.fillRect(0,0,_e.width,_e.height),requestAnimationFrame(nt)};nt();const it=_e.captureStream(30).getVideoTracks()[0],at=(yield this.room.localParticipant.publishTrack(it,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,ot={protocol:$,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},ct=setInterval(()=>__awaiter$1(this,void 0,void 0,function*(){const lt=yield at.getRTCStatsReport();lt==null||lt.forEach(ut=>{ut.type==="outbound-rtp"?(ot.packetsSent=ut.packetsSent,ot.qualityLimitationDurations=ut.qualityLimitationDurations,ot.bitrateTotal+=ut.targetBitrate,ot.count++):ut.type==="remote-inbound-rtp"&&(ot.packetsLost=ut.packetsLost,ot.rttTotal+=ut.roundTripTime,ot.jitterTotal+=ut.jitter)})}),1e3);return yield new Promise(lt=>setTimeout(lt,TEST_DURATION)),clearInterval(ct),it.stop(),_e.remove(),yield this.disconnect(),ot})}}class PublishAudioCheck extends Checker{get description(){return"Can publish audio"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.connect(),et=yield createLocalAudioTrack();if(yield detectSilence(et,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),_e.localParticipant.publishTrack(et),yield new Promise(it=>setTimeout(it,3e3));const nt=yield($=et.sender)===null||$===void 0?void 0:$.getStats();if(!nt)throw new Error("Could not get RTCStats");let rt=0;if(nt.forEach(it=>{it.type==="outbound-rtp"&&(it.kind==="audio"||!it.kind&&it.mediaType==="audio")&&(rt=it.packetsSent)}),rt===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(rt," audio packets"))})}}class PublishVideoCheck extends Checker{get description(){return"Can publish video"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.connect(),et=yield createLocalVideoTrack();yield this.checkForVideo(et.mediaStreamTrack),_e.localParticipant.publishTrack(et),yield new Promise(rt=>setTimeout(rt,5e3));const tt=yield($=et.sender)===null||$===void 0?void 0:$.getStats();if(!tt)throw new Error("Could not get RTCStats");let nt=0;if(tt.forEach(rt=>{rt.type==="outbound-rtp"&&(rt.kind==="video"||!rt.kind&&rt.mediaType==="video")&&(nt+=rt.packetsSent)}),nt===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(nt," video packets"))})}checkForVideo($){return __awaiter$1(this,void 0,void 0,function*(){const _e=new MediaStream;_e.addTrack($.clone());const et=document.createElement("video");et.srcObject=_e,et.muted=!0,yield new Promise(tt=>{et.onplay=()=>{setTimeout(()=>{var nt,rt,it,st;const at=document.createElement("canvas"),ot=$.getSettings(),ct=(rt=(nt=ot.width)!==null&&nt!==void 0?nt:et.videoWidth)!==null&&rt!==void 0?rt:1280,lt=(st=(it=ot.height)!==null&&it!==void 0?it:et.videoHeight)!==null&&st!==void 0?st:720;at.width=ct,at.height=lt;const ut=at.getContext("2d");ut.drawImage(et,0,0);const dt=ut.getImageData(0,0,at.width,at.height).data;let ht=!0;for(let ft=0;ft<dt.length;ft+=4)if(dt[ft]!==0||dt[ft+1]!==0||dt[ft+2]!==0){ht=!1;break}ht?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),tt()},1e3)},et.play()}),et.remove()})}}class ReconnectCheck extends Checker{get description(){return"Resuming connection after interruption"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var $;const _e=yield this.connect();let et=!1,tt=!1,nt;const rt=new Promise(at=>{setTimeout(at,5e3),nt=at}),it=()=>{et=!0};_e.on(RoomEvent.SignalReconnecting,it).on(RoomEvent.Reconnecting,it).on(RoomEvent.Reconnected,()=>{tt=!0,nt(!0)}),($=_e.engine.client.ws)===null||$===void 0||$.close();const st=_e.engine.client.onClose;if(st&&st(""),yield rt,et){if(!tt||_e.state!==ConnectionState.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class TURNCheck extends Checker{get description(){return"Can connect via TURN"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var $,_e;const et=new SignalClient,tt=yield et.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let nt=!1,rt=!1,it=!1;for(let st of tt.iceServers)for(let at of st.urls)at.startsWith("turn:")?(rt=!0,it=!0):at.startsWith("turns:")&&(rt=!0,it=!0,nt=!0),at.startsWith("stun:")&&(it=!0);it?rt&&!nt&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield et.close(),!((_e=($=this.connectOptions)===null||$===void 0?void 0:$.rtcConfig)===null||_e===void 0)&&_e.iceServers||rt?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(st=>setTimeout(st,0)))})}}class WebRTCCheck extends Checker{get description(){return"Establishing WebRTC connection"}perform(){return __awaiter$1(this,void 0,void 0,function*(){let $=!1,_e=!1;this.room.on(RoomEvent.SignalConnected,()=>{const et=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(tt,nt)=>{if(tt.candidate){const rt=new RTCIceCandidate(tt);let it="".concat(rt.protocol," ").concat(rt.address,":").concat(rt.port," ").concat(rt.type);rt.address&&(isIPPrivate(rt.address)?it+=" (private)":rt.protocol==="tcp"&&rt.tcpType==="passive"?($=!0,it+=" (passive)"):rt.protocol==="udp"&&(_e=!0)),this.appendMessage(it)}et&&et(tt,nt)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=tt=>{tt instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(tt.errorCode," ").concat(tt.errorText," ").concat(tt.url))})});try{yield this.connect(),livekitLogger.info("now the room is connected")}catch(et){throw this.appendWarning("ports need to be open on firewall in order to connect."),et}$||this.appendWarning("Server is not configured for ICE/TCP"),_e||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function isIPPrivate(j){const $=j.split(".");if($.length===4){if($[0]==="10")return!0;if($[0]==="192"&&$[1]==="168")return!0;if($[0]==="172"){const _e=parseInt($[1],10);if(_e>=16&&_e<=31)return!0}}return!1}class WebSocketCheck extends Checker{get description(){return"Connecting to signal connection via WebSocket"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var $,_e,et;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let tt=new SignalClient;const nt=yield tt.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(nt.serverVersion,".")),(($=nt.serverInfo)===null||$===void 0?void 0:$.edition)===ServerInfo_Edition.Cloud&&(!((_e=nt.serverInfo)===null||_e===void 0)&&_e.region)&&this.appendMessage("LiveKit Cloud: ".concat((et=nt.serverInfo)===null||et===void 0?void 0:et.region)),yield tt.close()})}}class ConnectionCheck extends eventsExports.EventEmitter{constructor($,_e){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=$,this.token=_e,this.options=et}getNextCheckId(){const $=this.checkResults.size;return this.checkResults.set($,{logs:[],status:CheckStatus.IDLE,name:"",description:""}),$}updateCheck($,_e){this.checkResults.set($,_e),this.emit("checkUpdate",$,_e)}isSuccess(){return Array.from(this.checkResults.values()).every($=>$.status!==CheckStatus.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck($){return __awaiter$1(this,void 0,void 0,function*(){const _e=this.getNextCheckId(),et=new $(this.url,this.token,this.options),tt=rt=>{this.updateCheck(_e,rt)};et.on("update",tt);const nt=yield et.run();return et.off("update",tt),nt})}checkWebsocket(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(WebSocketCheck)})}checkWebRTC(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(WebRTCCheck)})}checkTURN(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(TURNCheck)})}checkReconnect(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(ReconnectCheck)})}checkPublishAudio(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishAudioCheck)})}checkPublishVideo(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishVideoCheck)})}checkConnectionProtocol(){return __awaiter$1(this,void 0,void 0,function*(){const $=yield this.createAndRunCheck(ConnectionProtocolCheck);if($.data&&"protocol"in $.data){const _e=$.data;this.options.protocol=_e.protocol}return $})}checkCloudRegion(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(CloudRegionCheck)})}}var src={exports:{}},indexLight={exports:{}},indexMinimal={},minimal={},aspromise=asPromise$1;function asPromise$1(j,$){for(var _e=new Array(arguments.length-1),et=0,tt=2,nt=!0;tt<arguments.length;)_e[et++]=arguments[tt++];return new Promise(function(it,st){_e[et]=function(ot){if(nt)if(nt=!1,ot)st(ot);else{for(var ct=new Array(arguments.length-1),lt=0;lt<ct.length;)ct[lt++]=arguments[lt];it.apply(null,ct)}};try{j.apply($||null,_e)}catch(at){nt&&(nt=!1,st(at))}})}var base64$1={};(function(j){var $=j;$.length=function(it){var st=it.length;if(!st)return 0;for(var at=0;--st%4>1&&it.charAt(st)==="=";)++at;return Math.ceil(it.length*3)/4-at};for(var _e=new Array(64),et=new Array(123),tt=0;tt<64;)et[_e[tt]=tt<26?tt+65:tt<52?tt+71:tt<62?tt-4:tt-59|43]=tt++;$.encode=function(it,st,at){for(var ot=null,ct=[],lt=0,ut=0,pt;st<at;){var dt=it[st++];switch(ut){case 0:ct[lt++]=_e[dt>>2],pt=(dt&3)<<4,ut=1;break;case 1:ct[lt++]=_e[pt|dt>>4],pt=(dt&15)<<2,ut=2;break;case 2:ct[lt++]=_e[pt|dt>>6],ct[lt++]=_e[dt&63],ut=0;break}lt>8191&&((ot||(ot=[])).push(String.fromCharCode.apply(String,ct)),lt=0)}return ut&&(ct[lt++]=_e[pt],ct[lt++]=61,ut===1&&(ct[lt++]=61)),ot?(lt&&ot.push(String.fromCharCode.apply(String,ct.slice(0,lt))),ot.join("")):String.fromCharCode.apply(String,ct.slice(0,lt))};var nt="invalid encoding";$.decode=function(it,st,at){for(var ot=at,ct=0,lt,ut=0;ut<it.length;){var pt=it.charCodeAt(ut++);if(pt===61&&ct>1)break;if((pt=et[pt])===void 0)throw Error(nt);switch(ct){case 0:lt=pt,ct=1;break;case 1:st[at++]=lt<<2|(pt&48)>>4,lt=pt,ct=2;break;case 2:st[at++]=(lt&15)<<4|(pt&60)>>2,lt=pt,ct=3;break;case 3:st[at++]=(lt&3)<<6|pt,ct=0;break}}if(ct===1)throw Error(nt);return at-ot},$.test=function(it){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(it)}})(base64$1);var eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function($,_e,et){return(this._listeners[$]||(this._listeners[$]=[])).push({fn:_e,ctx:et||this}),this};EventEmitter$1.prototype.off=function($,_e){if($===void 0)this._listeners={};else if(_e===void 0)this._listeners[$]=[];else for(var et=this._listeners[$],tt=0;tt<et.length;)et[tt].fn===_e?et.splice(tt,1):++tt;return this};EventEmitter$1.prototype.emit=function($){var _e=this._listeners[$];if(_e){for(var et=[],tt=1;tt<arguments.length;)et.push(arguments[tt++]);for(tt=0;tt<_e.length;)_e[tt].fn.apply(_e[tt++].ctx,et)}return this};var float=factory(factory);function factory(j){return typeof Float32Array<"u"?function(){var $=new Float32Array([-0]),_e=new Uint8Array($.buffer),et=_e[3]===128;function tt(st,at,ot){$[0]=st,at[ot]=_e[0],at[ot+1]=_e[1],at[ot+2]=_e[2],at[ot+3]=_e[3]}function nt(st,at,ot){$[0]=st,at[ot]=_e[3],at[ot+1]=_e[2],at[ot+2]=_e[1],at[ot+3]=_e[0]}j.writeFloatLE=et?tt:nt,j.writeFloatBE=et?nt:tt;function rt(st,at){return _e[0]=st[at],_e[1]=st[at+1],_e[2]=st[at+2],_e[3]=st[at+3],$[0]}function it(st,at){return _e[3]=st[at],_e[2]=st[at+1],_e[1]=st[at+2],_e[0]=st[at+3],$[0]}j.readFloatLE=et?rt:it,j.readFloatBE=et?it:rt}():function(){function $(et,tt,nt,rt){var it=tt<0?1:0;if(it&&(tt=-tt),tt===0)et(1/tt>0?0:2147483648,nt,rt);else if(isNaN(tt))et(2143289344,nt,rt);else if(tt>34028234663852886e22)et((it<<31|2139095040)>>>0,nt,rt);else if(tt<11754943508222875e-54)et((it<<31|Math.round(tt/1401298464324817e-60))>>>0,nt,rt);else{var st=Math.floor(Math.log(tt)/Math.LN2),at=Math.round(tt*Math.pow(2,-st)*8388608)&8388607;et((it<<31|st+127<<23|at)>>>0,nt,rt)}}j.writeFloatLE=$.bind(null,writeUintLE),j.writeFloatBE=$.bind(null,writeUintBE);function _e(et,tt,nt){var rt=et(tt,nt),it=(rt>>31)*2+1,st=rt>>>23&255,at=rt&8388607;return st===255?at?NaN:it*(1/0):st===0?it*1401298464324817e-60*at:it*Math.pow(2,st-150)*(at+8388608)}j.readFloatLE=_e.bind(null,readUintLE),j.readFloatBE=_e.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var $=new Float64Array([-0]),_e=new Uint8Array($.buffer),et=_e[7]===128;function tt(st,at,ot){$[0]=st,at[ot]=_e[0],at[ot+1]=_e[1],at[ot+2]=_e[2],at[ot+3]=_e[3],at[ot+4]=_e[4],at[ot+5]=_e[5],at[ot+6]=_e[6],at[ot+7]=_e[7]}function nt(st,at,ot){$[0]=st,at[ot]=_e[7],at[ot+1]=_e[6],at[ot+2]=_e[5],at[ot+3]=_e[4],at[ot+4]=_e[3],at[ot+5]=_e[2],at[ot+6]=_e[1],at[ot+7]=_e[0]}j.writeDoubleLE=et?tt:nt,j.writeDoubleBE=et?nt:tt;function rt(st,at){return _e[0]=st[at],_e[1]=st[at+1],_e[2]=st[at+2],_e[3]=st[at+3],_e[4]=st[at+4],_e[5]=st[at+5],_e[6]=st[at+6],_e[7]=st[at+7],$[0]}function it(st,at){return _e[7]=st[at],_e[6]=st[at+1],_e[5]=st[at+2],_e[4]=st[at+3],_e[3]=st[at+4],_e[2]=st[at+5],_e[1]=st[at+6],_e[0]=st[at+7],$[0]}j.readDoubleLE=et?rt:it,j.readDoubleBE=et?it:rt}():function(){function $(et,tt,nt,rt,it,st){var at=rt<0?1:0;if(at&&(rt=-rt),rt===0)et(0,it,st+tt),et(1/rt>0?0:2147483648,it,st+nt);else if(isNaN(rt))et(0,it,st+tt),et(2146959360,it,st+nt);else if(rt>17976931348623157e292)et(0,it,st+tt),et((at<<31|2146435072)>>>0,it,st+nt);else{var ot;if(rt<22250738585072014e-324)ot=rt/5e-324,et(ot>>>0,it,st+tt),et((at<<31|ot/4294967296)>>>0,it,st+nt);else{var ct=Math.floor(Math.log(rt)/Math.LN2);ct===1024&&(ct=1023),ot=rt*Math.pow(2,-ct),et(ot*4503599627370496>>>0,it,st+tt),et((at<<31|ct+1023<<20|ot*1048576&1048575)>>>0,it,st+nt)}}}j.writeDoubleLE=$.bind(null,writeUintLE,0,4),j.writeDoubleBE=$.bind(null,writeUintBE,4,0);function _e(et,tt,nt,rt,it){var st=et(rt,it+tt),at=et(rt,it+nt),ot=(at>>31)*2+1,ct=at>>>20&2047,lt=4294967296*(at&1048575)+st;return ct===2047?lt?NaN:ot*(1/0):ct===0?ot*5e-324*lt:ot*Math.pow(2,ct-1075)*(lt+4503599627370496)}j.readDoubleLE=_e.bind(null,readUintLE,0,4),j.readDoubleBE=_e.bind(null,readUintBE,4,0)}(),j}function writeUintLE(j,$,_e){$[_e]=j&255,$[_e+1]=j>>>8&255,$[_e+2]=j>>>16&255,$[_e+3]=j>>>24}function writeUintBE(j,$,_e){$[_e]=j>>>24,$[_e+1]=j>>>16&255,$[_e+2]=j>>>8&255,$[_e+3]=j&255}function readUintLE(j,$){return(j[$]|j[$+1]<<8|j[$+2]<<16|j[$+3]<<24)>>>0}function readUintBE(j,$){return(j[$]<<24|j[$+1]<<16|j[$+2]<<8|j[$+3])>>>0}var inquire_1=inquire$1;function inquire$1(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(j){}return null}var utf8$2={};(function(j){var $=j;$.length=function(et){for(var tt=0,nt=0,rt=0;rt<et.length;++rt)nt=et.charCodeAt(rt),nt<128?tt+=1:nt<2048?tt+=2:(nt&64512)===55296&&(et.charCodeAt(rt+1)&64512)===56320?(++rt,tt+=4):tt+=3;return tt},$.read=function(et,tt,nt){var rt=nt-tt;if(rt<1)return"";for(var it=null,st=[],at=0,ot;tt<nt;)ot=et[tt++],ot<128?st[at++]=ot:ot>191&&ot<224?st[at++]=(ot&31)<<6|et[tt++]&63:ot>239&&ot<365?(ot=((ot&7)<<18|(et[tt++]&63)<<12|(et[tt++]&63)<<6|et[tt++]&63)-65536,st[at++]=55296+(ot>>10),st[at++]=56320+(ot&1023)):st[at++]=(ot&15)<<12|(et[tt++]&63)<<6|et[tt++]&63,at>8191&&((it||(it=[])).push(String.fromCharCode.apply(String,st)),at=0);return it?(at&&it.push(String.fromCharCode.apply(String,st.slice(0,at))),it.join("")):String.fromCharCode.apply(String,st.slice(0,at))},$.write=function(et,tt,nt){for(var rt=nt,it,st,at=0;at<et.length;++at)it=et.charCodeAt(at),it<128?tt[nt++]=it:it<2048?(tt[nt++]=it>>6|192,tt[nt++]=it&63|128):(it&64512)===55296&&((st=et.charCodeAt(at+1))&64512)===56320?(it=65536+((it&1023)<<10)+(st&1023),++at,tt[nt++]=it>>18|240,tt[nt++]=it>>12&63|128,tt[nt++]=it>>6&63|128,tt[nt++]=it&63|128):(tt[nt++]=it>>12|224,tt[nt++]=it>>6&63|128,tt[nt++]=it&63|128);return nt-rt}})(utf8$2);var pool_1=pool;function pool(j,$,_e){var et=_e||8192,tt=et>>>1,nt=null,rt=et;return function(st){if(st<1||st>tt)return j(st);rt+st>et&&(nt=j(et),rt=0);var at=$.call(nt,rt,rt+=st);return rt&7&&(rt=(rt|7)+1),at}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=$;var j=requireMinimal();function $(nt,rt){this.lo=nt>>>0,this.hi=rt>>>0}var _e=$.zero=new $(0,0);_e.toNumber=function(){return 0},_e.zzEncode=_e.zzDecode=function(){return this},_e.length=function(){return 1};var et=$.zeroHash="\0\0\0\0\0\0\0\0";$.fromNumber=function(rt){if(rt===0)return _e;var it=rt<0;it&&(rt=-rt);var st=rt>>>0,at=(rt-st)/4294967296>>>0;return it&&(at=~at>>>0,st=~st>>>0,++st>4294967295&&(st=0,++at>4294967295&&(at=0))),new $(st,at)},$.from=function(rt){if(typeof rt=="number")return $.fromNumber(rt);if(j.isString(rt))if(j.Long)rt=j.Long.fromString(rt);else return $.fromNumber(parseInt(rt,10));return rt.low||rt.high?new $(rt.low>>>0,rt.high>>>0):_e},$.prototype.toNumber=function(rt){if(!rt&&this.hi>>>31){var it=~this.lo+1>>>0,st=~this.hi>>>0;return it||(st=st+1>>>0),-(it+st*4294967296)}return this.lo+this.hi*4294967296},$.prototype.toLong=function(rt){return j.Long?new j.Long(this.lo|0,this.hi|0,!!rt):{low:this.lo|0,high:this.hi|0,unsigned:!!rt}};var tt=String.prototype.charCodeAt;return $.fromHash=function(rt){return rt===et?_e:new $((tt.call(rt,0)|tt.call(rt,1)<<8|tt.call(rt,2)<<16|tt.call(rt,3)<<24)>>>0,(tt.call(rt,4)|tt.call(rt,5)<<8|tt.call(rt,6)<<16|tt.call(rt,7)<<24)>>>0)},$.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},$.prototype.zzEncode=function(){var rt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^rt)>>>0,this.lo=(this.lo<<1^rt)>>>0,this},$.prototype.zzDecode=function(){var rt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^rt)>>>0,this.hi=(this.hi>>>1^rt)>>>0,this},$.prototype.length=function(){var rt=this.lo,it=(this.lo>>>28|this.hi<<4)>>>0,st=this.hi>>>24;return st===0?it===0?rt<16384?rt<128?1:2:rt<2097152?3:4:it<16384?it<128?5:6:it<2097152?7:8:st<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(j){var $=j;$.asPromise=aspromise,$.base64=base64$1,$.EventEmitter=eventemitter,$.float=float,$.inquire=inquire_1,$.utf8=utf8$2,$.pool=pool_1,$.LongBits=requireLongbits(),$.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),$.global=$.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,$.emptyArray=Object.freeze?Object.freeze([]):[],$.emptyObject=Object.freeze?Object.freeze({}):{},$.isInteger=Number.isInteger||function(nt){return typeof nt=="number"&&isFinite(nt)&&Math.floor(nt)===nt},$.isString=function(nt){return typeof nt=="string"||nt instanceof String},$.isObject=function(nt){return nt&&typeof nt=="object"},$.isset=$.isSet=function(nt,rt){var it=nt[rt];return it!=null&&nt.hasOwnProperty(rt)?typeof it!="object"||(Array.isArray(it)?it.length:Object.keys(it).length)>0:!1},$.Buffer=function(){try{var tt=$.inquire("buffer").Buffer;return tt.prototype.utf8Write?tt:null}catch{return null}}(),$._Buffer_from=null,$._Buffer_allocUnsafe=null,$.newBuffer=function(nt){return typeof nt=="number"?$.Buffer?$._Buffer_allocUnsafe(nt):new $.Array(nt):$.Buffer?$._Buffer_from(nt):typeof Uint8Array>"u"?nt:new Uint8Array(nt)},$.Array=typeof Uint8Array<"u"?Uint8Array:Array,$.Long=$.global.dcodeIO&&$.global.dcodeIO.Long||$.global.Long||$.inquire("long"),$.key2Re=/^true|false|0|1$/,$.key32Re=/^-?(?:0|[1-9][0-9]*)$/,$.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,$.longToHash=function(nt){return nt?$.LongBits.from(nt).toHash():$.LongBits.zeroHash},$.longFromHash=function(nt,rt){var it=$.LongBits.fromHash(nt);return $.Long?$.Long.fromBits(it.lo,it.hi,rt):it.toNumber(!!rt)};function _e(tt,nt,rt){for(var it=Object.keys(nt),st=0;st<it.length;++st)(tt[it[st]]===void 0||!rt)&&(tt[it[st]]=nt[it[st]]);return tt}$.merge=_e,$.lcFirst=function(nt){return nt.charAt(0).toLowerCase()+nt.substring(1)};function et(tt){function nt(rt,it){if(!(this instanceof nt))return new nt(rt,it);Object.defineProperty(this,"message",{get:function(){return rt}}),Error.captureStackTrace?Error.captureStackTrace(this,nt):Object.defineProperty(this,"stack",{value:new Error().stack||""}),it&&_e(this,it)}return nt.prototype=Object.create(Error.prototype,{constructor:{value:nt,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return tt},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),nt}$.newError=et,$.ProtocolError=et("ProtocolError"),$.oneOfGetter=function(nt){for(var rt={},it=0;it<nt.length;++it)rt[nt[it]]=1;return function(){for(var st=Object.keys(this),at=st.length-1;at>-1;--at)if(rt[st[at]]===1&&this[st[at]]!==void 0&&this[st[at]]!==null)return st[at]}},$.oneOfSetter=function(nt){return function(rt){for(var it=0;it<nt.length;++it)nt[it]!==rt&&delete this[nt[it]]}},$.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},$._configure=function(){var tt=$.Buffer;if(!tt){$._Buffer_from=$._Buffer_allocUnsafe=null;return}$._Buffer_from=tt.from!==Uint8Array.from&&tt.from||function(rt,it){return new tt(rt,it)},$._Buffer_allocUnsafe=tt.allocUnsafe||function(rt){return new tt(rt)}}}(minimal)),minimal}var writer=Writer$1,util$8=requireMinimal(),BufferWriter$1,LongBits$1=util$8.LongBits,base64=util$8.base64,utf8$1=util$8.utf8;function Op(j,$,_e){this.fn=j,this.len=$,this.next=void 0,this.val=_e}function noop$6(){}function State(j){this.head=j.head,this.tail=j.tail,this.len=j.len,this.next=j.states}function Writer$1(){this.len=0,this.head=new Op(noop$6,0,0),this.tail=this.head,this.states=null}var create$2=function j(){return util$8.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$2();Writer$1.alloc=function j($){return new util$8.Array($)};util$8.Array!==Array&&(Writer$1.alloc=util$8.pool(Writer$1.alloc,util$8.Array.prototype.subarray));Writer$1.prototype._push=function j($,_e,et){return this.tail=this.tail.next=new Op($,_e,et),this.len+=_e,this};function writeByte(j,$,_e){$[_e]=j&255}function writeVarint32(j,$,_e){for(;j>127;)$[_e++]=j&127|128,j>>>=7;$[_e]=j}function VarintOp(j,$){this.len=j,this.next=void 0,this.val=$}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function j($){return this.len+=(this.tail=this.tail.next=new VarintOp(($=$>>>0)<128?1:$<16384?2:$<2097152?3:$<268435456?4:5,$)).len,this};Writer$1.prototype.int32=function j($){return $<0?this._push(writeVarint64,10,LongBits$1.fromNumber($)):this.uint32($)};Writer$1.prototype.sint32=function j($){return this.uint32(($<<1^$>>31)>>>0)};function writeVarint64(j,$,_e){for(;j.hi;)$[_e++]=j.lo&127|128,j.lo=(j.lo>>>7|j.hi<<25)>>>0,j.hi>>>=7;for(;j.lo>127;)$[_e++]=j.lo&127|128,j.lo=j.lo>>>7;$[_e++]=j.lo}Writer$1.prototype.uint64=function j($){var _e=LongBits$1.from($);return this._push(writeVarint64,_e.length(),_e)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function j($){var _e=LongBits$1.from($).zzEncode();return this._push(writeVarint64,_e.length(),_e)};Writer$1.prototype.bool=function j($){return this._push(writeByte,1,$?1:0)};function writeFixed32(j,$,_e){$[_e]=j&255,$[_e+1]=j>>>8&255,$[_e+2]=j>>>16&255,$[_e+3]=j>>>24}Writer$1.prototype.fixed32=function j($){return this._push(writeFixed32,4,$>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function j($){var _e=LongBits$1.from($);return this._push(writeFixed32,4,_e.lo)._push(writeFixed32,4,_e.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function j($){return this._push(util$8.float.writeFloatLE,4,$)};Writer$1.prototype.double=function j($){return this._push(util$8.float.writeDoubleLE,8,$)};var writeBytes=util$8.Array.prototype.set?function j($,_e,et){_e.set($,et)}:function j($,_e,et){for(var tt=0;tt<$.length;++tt)_e[et+tt]=$[tt]};Writer$1.prototype.bytes=function j($){var _e=$.length>>>0;if(!_e)return this._push(writeByte,1,0);if(util$8.isString($)){var et=Writer$1.alloc(_e=base64.length($));base64.decode($,et,0),$=et}return this.uint32(_e)._push(writeBytes,_e,$)};Writer$1.prototype.string=function j($){var _e=utf8$1.length($);return _e?this.uint32(_e)._push(utf8$1.write,_e,$):this._push(writeByte,1,0)};Writer$1.prototype.fork=function j(){return this.states=new State(this),this.head=this.tail=new Op(noop$6,0,0),this.len=0,this};Writer$1.prototype.reset=function j(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$6,0,0),this.len=0),this};Writer$1.prototype.ldelim=function j(){var $=this.head,_e=this.tail,et=this.len;return this.reset().uint32(et),et&&(this.tail.next=$.next,this.tail=_e,this.len+=et),this};Writer$1.prototype.finish=function j(){for(var $=this.head.next,_e=this.constructor.alloc(this.len),et=0;$;)$.fn($.val,_e,et),et+=$.len,$=$.next;return _e};Writer$1._configure=function(j){BufferWriter$1=j,Writer$1.create=create$2(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$7=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$7._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$7.Buffer&&util$7.Buffer.prototype instanceof Uint8Array&&util$7.Buffer.prototype.set.name==="set"?function($,_e,et){_e.set($,et)}:function($,_e,et){if($.copy)$.copy(_e,et,0,$.length);else for(var tt=0;tt<$.length;)_e[et++]=$[tt++]}};BufferWriter.prototype.bytes=function j($){util$7.isString($)&&($=util$7._Buffer_from($,"base64"));var _e=$.length>>>0;return this.uint32(_e),_e&&this._push(BufferWriter.writeBytesBuffer,_e,$),this};function writeStringBuffer(j,$,_e){j.length<40?util$7.utf8.write(j,$,_e):$.utf8Write?$.utf8Write(j,_e):$.write(j,_e)}BufferWriter.prototype.string=function j($){var _e=util$7.Buffer.byteLength($);return this.uint32(_e),_e&&this._push(writeStringBuffer,_e,$),this};BufferWriter._configure();var reader=Reader$1,util$6=requireMinimal(),BufferReader$1,LongBits=util$6.LongBits,utf8=util$6.utf8;function indexOutOfRange(j,$){return RangeError("index out of range: "+j.pos+" + "+($||1)+" > "+j.len)}function Reader$1(j){this.buf=j,this.pos=0,this.len=j.length}var create_array=typeof Uint8Array<"u"?function j($){if($ instanceof Uint8Array||Array.isArray($))return new Reader$1($);throw Error("illegal buffer")}:function j($){if(Array.isArray($))return new Reader$1($);throw Error("illegal buffer")},create$1=function j(){return util$6.Buffer?function(_e){return(Reader$1.create=function(tt){return util$6.Buffer.isBuffer(tt)?new BufferReader$1(tt):create_array(tt)})(_e)}:create_array};Reader$1.create=create$1();Reader$1.prototype._slice=util$6.Array.prototype.subarray||util$6.Array.prototype.slice;Reader$1.prototype.uint32=function j(){var $=4294967295;return function(){if($=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||($=($|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||($=($|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||($=($|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||($=($|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return $;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return $}}();Reader$1.prototype.int32=function j(){return this.uint32()|0};Reader$1.prototype.sint32=function j(){var $=this.uint32();return $>>>1^-($&1)|0};function readLongVarint(){var j=new LongBits(0,0),$=0;if(this.len-this.pos>4){for(;$<4;++$)if(j.lo=(j.lo|(this.buf[this.pos]&127)<<$*7)>>>0,this.buf[this.pos++]<128)return j;if(j.lo=(j.lo|(this.buf[this.pos]&127)<<28)>>>0,j.hi=(j.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return j;$=0}else{for(;$<3;++$){if(this.pos>=this.len)throw indexOutOfRange(this);if(j.lo=(j.lo|(this.buf[this.pos]&127)<<$*7)>>>0,this.buf[this.pos++]<128)return j}return j.lo=(j.lo|(this.buf[this.pos++]&127)<<$*7)>>>0,j}if(this.len-this.pos>4){for(;$<5;++$)if(j.hi=(j.hi|(this.buf[this.pos]&127)<<$*7+3)>>>0,this.buf[this.pos++]<128)return j}else for(;$<5;++$){if(this.pos>=this.len)throw indexOutOfRange(this);if(j.hi=(j.hi|(this.buf[this.pos]&127)<<$*7+3)>>>0,this.buf[this.pos++]<128)return j}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function j(){return this.uint32()!==0};function readFixed32_end(j,$){return(j[$-4]|j[$-3]<<8|j[$-2]<<16|j[$-1]<<24)>>>0}Reader$1.prototype.fixed32=function j(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function j(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function j(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var $=util$6.float.readFloatLE(this.buf,this.pos);return this.pos+=4,$};Reader$1.prototype.double=function j(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var $=util$6.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,$};Reader$1.prototype.bytes=function j(){var $=this.uint32(),_e=this.pos,et=this.pos+$;if(et>this.len)throw indexOutOfRange(this,$);if(this.pos+=$,Array.isArray(this.buf))return this.buf.slice(_e,et);if(_e===et){var tt=util$6.Buffer;return tt?tt.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,_e,et)};Reader$1.prototype.string=function j(){var $=this.bytes();return utf8.read($,0,$.length)};Reader$1.prototype.skip=function j($){if(typeof $=="number"){if(this.pos+$>this.len)throw indexOutOfRange(this,$);this.pos+=$}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(j){switch(j){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(j=this.uint32()&7)!==4;)this.skipType(j);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+j+" at offset "+this.pos)}return this};Reader$1._configure=function(j){BufferReader$1=j,Reader$1.create=create$1(),BufferReader$1._configure();var $=util$6.Long?"toLong":"toNumber";util$6.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[$](!1)},uint64:function(){return readLongVarint.call(this)[$](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[$](!1)},fixed64:function(){return readFixed64.call(this)[$](!0)},sfixed64:function(){return readFixed64.call(this)[$](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$5=requireMinimal();function BufferReader(j){Reader.call(this,j)}BufferReader._configure=function(){util$5.Buffer&&(BufferReader.prototype._slice=util$5.Buffer.prototype.slice)};BufferReader.prototype.string=function j(){var $=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+$,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+$,this.len))};BufferReader._configure();var rpc={},service$1=Service$1,util$4=requireMinimal();(Service$1.prototype=Object.create(util$4.EventEmitter.prototype)).constructor=Service$1;function Service$1(j,$,_e){if(typeof j!="function")throw TypeError("rpcImpl must be a function");util$4.EventEmitter.call(this),this.rpcImpl=j,this.requestDelimited=!!$,this.responseDelimited=!!_e}Service$1.prototype.rpcCall=function j($,_e,et,tt,nt){if(!tt)throw TypeError("request must be specified");var rt=this;if(!nt)return util$4.asPromise(j,rt,$,_e,et,tt);if(!rt.rpcImpl){setTimeout(function(){nt(Error("already ended"))},0);return}try{return rt.rpcImpl($,_e[rt.requestDelimited?"encodeDelimited":"encode"](tt).finish(),function(st,at){if(st)return rt.emit("error",st,$),nt(st);if(at===null){rt.end(!0);return}if(!(at instanceof et))try{at=et[rt.responseDelimited?"decodeDelimited":"decode"](at)}catch(ot){return rt.emit("error",ot,$),nt(ot)}return rt.emit("data",at,$),nt(null,at)})}catch(it){rt.emit("error",it,$),setTimeout(function(){nt(it)},0);return}};Service$1.prototype.end=function j($){return this.rpcImpl&&($||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(j){var $=j;$.Service=service$1})(rpc);var roots={};(function(j){var $=j;$.build="minimal",$.Writer=writer,$.BufferWriter=writer_buffer,$.Reader=reader,$.BufferReader=reader_buffer,$.util=requireMinimal(),$.rpc=rpc,$.roots=roots,$.configure=_e;function _e(){$.util._configure(),$.Writer._configure($.BufferWriter),$.Reader._configure($.BufferReader)}_e()})(indexMinimal);var types$2={},util$3={exports:{}},codegen_1=codegen;function codegen(j,$){typeof j=="string"&&($=j,j=void 0);var _e=[];function et(nt){if(typeof nt!="string"){var rt=tt();if(codegen.verbose&&console.log("codegen: "+rt),rt="return "+rt,nt){for(var it=Object.keys(nt),st=new Array(it.length+1),at=new Array(it.length),ot=0;ot<it.length;)st[ot]=it[ot],at[ot]=nt[it[ot++]];return st[ot]=rt,Function.apply(null,st).apply(null,at)}return Function(rt)()}for(var ct=new Array(arguments.length-1),lt=0;lt<ct.length;)ct[lt]=arguments[++lt];if(lt=0,nt=nt.replace(/%([%dfijs])/g,function(pt,dt){var ht=ct[lt++];switch(dt){case"d":case"f":return String(Number(ht));case"i":return String(Math.floor(ht));case"j":return JSON.stringify(ht);case"s":return String(ht)}return"%"}),lt!==ct.length)throw Error("parameter count mismatch");return _e.push(nt),et}function tt(nt){return"function "+(nt||$||"")+"("+(j&&j.join(",")||"")+`){
  `+_e.join(`
  `)+`
}`}return et.toString=tt,et}codegen.verbose=!1;var fetch_1=fetch$1,asPromise=aspromise,inquire=inquire_1,fs=inquire("fs");function fetch$1(j,$,_e){return typeof $=="function"?(_e=$,$={}):$||($={}),_e?!$.xhr&&fs&&fs.readFile?fs.readFile(j,function(tt,nt){return tt&&typeof XMLHttpRequest<"u"?fetch$1.xhr(j,$,_e):tt?_e(tt):_e(null,$.binary?nt:nt.toString("utf8"))}):fetch$1.xhr(j,$,_e):asPromise(fetch$1,this,j,$)}fetch$1.xhr=function j($,_e,et){var tt=new XMLHttpRequest;tt.onreadystatechange=function(){if(tt.readyState===4){if(tt.status!==0&&tt.status!==200)return et(Error("status "+tt.status));if(_e.binary){var rt=tt.response;if(!rt){rt=[];for(var it=0;it<tt.responseText.length;++it)rt.push(tt.responseText.charCodeAt(it)&255)}return et(null,typeof Uint8Array<"u"?new Uint8Array(rt):rt)}return et(null,tt.responseText)}},_e.binary&&("overrideMimeType"in tt&&tt.overrideMimeType("text/plain; charset=x-user-defined"),tt.responseType="arraybuffer"),tt.open("GET",$),tt.send()};var path={};(function(j){var $=j,_e=$.isAbsolute=function(nt){return/^(?:\/|\w+:)/.test(nt)},et=$.normalize=function(nt){nt=nt.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var rt=nt.split("/"),it=_e(nt),st="";it&&(st=rt.shift()+"/");for(var at=0;at<rt.length;)rt[at]===".."?at>0&&rt[at-1]!==".."?rt.splice(--at,2):it?rt.splice(at,1):++at:rt[at]==="."?rt.splice(at,1):++at;return st+rt.join("/")};$.resolve=function(nt,rt,it){return it||(rt=et(rt)),_e(rt)?rt:(it||(nt=et(nt)),(nt=nt.replace(/(?:\/|^)[^/]+$/,"")).length?et(nt+"/"+rt):rt)}})(path);var namespace,hasRequiredNamespace;function requireNamespace(){if(hasRequiredNamespace)return namespace;hasRequiredNamespace=1,namespace=st;var j=requireObject();((st.prototype=Object.create(j.prototype)).constructor=st).className="Namespace";var $=requireField(),_e=requireUtil(),et=requireOneof(),tt,nt,rt;st.fromJSON=function(ct,lt){return new st(ct,lt.options).addJSON(lt.nested)};function it(ot,ct){if(ot&&ot.length){for(var lt={},ut=0;ut<ot.length;++ut)lt[ot[ut].name]=ot[ut].toJSON(ct);return lt}}st.arrayToJSON=it,st.isReservedId=function(ct,lt){if(ct){for(var ut=0;ut<ct.length;++ut)if(typeof ct[ut]!="string"&&ct[ut][0]<=lt&&ct[ut][1]>lt)return!0}return!1},st.isReservedName=function(ct,lt){if(ct){for(var ut=0;ut<ct.length;++ut)if(ct[ut]===lt)return!0}return!1};function st(ot,ct){j.call(this,ot,ct),this.nested=void 0,this._nestedArray=null}function at(ot){return ot._nestedArray=null,ot}return Object.defineProperty(st.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=_e.toArray(this.nested))}}),st.prototype.toJSON=function(ct){return _e.toObject(["options",this.options,"nested",it(this.nestedArray,ct)])},st.prototype.addJSON=function(ct){var lt=this;if(ct)for(var ut=Object.keys(ct),pt=0,dt;pt<ut.length;++pt)dt=ct[ut[pt]],lt.add((dt.fields!==void 0?tt.fromJSON:dt.values!==void 0?rt.fromJSON:dt.methods!==void 0?nt.fromJSON:dt.id!==void 0?$.fromJSON:st.fromJSON)(ut[pt],dt));return this},st.prototype.get=function(ct){return this.nested&&this.nested[ct]||null},st.prototype.getEnum=function(ct){if(this.nested&&this.nested[ct]instanceof rt)return this.nested[ct].values;throw Error("no such enum: "+ct)},st.prototype.add=function(ct){if(!(ct instanceof $&&ct.extend!==void 0||ct instanceof tt||ct instanceof et||ct instanceof rt||ct instanceof nt||ct instanceof st))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var lt=this.get(ct.name);if(lt)if(lt instanceof st&&ct instanceof st&&!(lt instanceof tt||lt instanceof nt)){for(var ut=lt.nestedArray,pt=0;pt<ut.length;++pt)ct.add(ut[pt]);this.remove(lt),this.nested||(this.nested={}),ct.setOptions(lt.options,!0)}else throw Error("duplicate name '"+ct.name+"' in "+this)}return this.nested[ct.name]=ct,this instanceof tt||this instanceof nt||this instanceof rt||this instanceof $||ct._edition||(ct._edition=ct._defaultEdition),ct.onAdd(this),at(this)},st.prototype.remove=function(ct){if(!(ct instanceof j))throw TypeError("object must be a ReflectionObject");if(ct.parent!==this)throw Error(ct+" is not a member of "+this);return delete this.nested[ct.name],Object.keys(this.nested).length||(this.nested=void 0),ct.onRemove(this),at(this)},st.prototype.define=function(ct,lt){if(_e.isString(ct))ct=ct.split(".");else if(!Array.isArray(ct))throw TypeError("illegal path");if(ct&&ct.length&&ct[0]==="")throw Error("path must be relative");for(var ut=this;ct.length>0;){var pt=ct.shift();if(ut.nested&&ut.nested[pt]){if(ut=ut.nested[pt],!(ut instanceof st))throw Error("path conflicts with non-namespace objects")}else ut.add(ut=new st(pt))}return lt&&ut.addJSON(lt),ut},st.prototype.resolveAll=function(){var ct=this.nestedArray,lt=0;for(this.resolve();lt<ct.length;)ct[lt]instanceof st?ct[lt++].resolveAll():ct[lt++].resolve();return this},st.prototype._resolveFeaturesRecursive=function(ct){return ct=this._edition||ct,j.prototype._resolveFeaturesRecursive.call(this,ct),this.nestedArray.forEach(lt=>{lt._resolveFeaturesRecursive(ct)}),this},st.prototype.lookup=function(ct,lt,ut){if(typeof lt=="boolean"?(ut=lt,lt=void 0):lt&&!Array.isArray(lt)&&(lt=[lt]),_e.isString(ct)&&ct.length){if(ct===".")return this.root;ct=ct.split(".")}else if(!ct.length)return this;if(ct[0]==="")return this.root.lookup(ct.slice(1),lt);var pt=this.get(ct[0]);if(pt){if(ct.length===1){if(!lt||lt.indexOf(pt.constructor)>-1)return pt}else if(pt instanceof st&&(pt=pt.lookup(ct.slice(1),lt,!0)))return pt}else for(var dt=0;dt<this.nestedArray.length;++dt)if(this._nestedArray[dt]instanceof st&&(pt=this._nestedArray[dt].lookup(ct,lt,!0)))return pt;return this.parent===null||ut?null:this.parent.lookup(ct,lt)},st.prototype.lookupType=function(ct){var lt=this.lookup(ct,[tt]);if(!lt)throw Error("no such type: "+ct);return lt},st.prototype.lookupEnum=function(ct){var lt=this.lookup(ct,[rt]);if(!lt)throw Error("no such Enum '"+ct+"' in "+this);return lt},st.prototype.lookupTypeOrEnum=function(ct){var lt=this.lookup(ct,[tt,rt]);if(!lt)throw Error("no such Type or Enum '"+ct+"' in "+this);return lt},st.prototype.lookupService=function(ct){var lt=this.lookup(ct,[nt]);if(!lt)throw Error("no such Service '"+ct+"' in "+this);return lt},st._configure=function(ot,ct,lt){tt=ot,nt=ct,rt=lt},namespace}var mapfield,hasRequiredMapfield;function requireMapfield(){if(hasRequiredMapfield)return mapfield;hasRequiredMapfield=1,mapfield=et;var j=requireField();((et.prototype=Object.create(j.prototype)).constructor=et).className="MapField";var $=requireTypes(),_e=requireUtil();function et(tt,nt,rt,it,st,at){if(j.call(this,tt,nt,it,void 0,void 0,st,at),!_e.isString(rt))throw TypeError("keyType must be a string");this.keyType=rt,this.resolvedKeyType=null,this.map=!0}return et.fromJSON=function(nt,rt){return new et(nt,rt.id,rt.keyType,rt.type,rt.options,rt.comment)},et.prototype.toJSON=function(nt){var rt=nt?!!nt.keepComments:!1;return _e.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",rt?this.comment:void 0])},et.prototype.resolve=function(){if(this.resolved)return this;if($.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return j.prototype.resolve.call(this)},et.d=function(nt,rt,it){return typeof it=="function"?it=_e.decorateType(it).name:it&&typeof it=="object"&&(it=_e.decorateEnum(it).name),function(at,ot){_e.decorateType(at.constructor).add(new et(ot,nt,rt,it))}},mapfield}var method,hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return method;hasRequiredMethod=1,method=_e;var j=requireObject();((_e.prototype=Object.create(j.prototype)).constructor=_e).className="Method";var $=requireUtil();function _e(et,tt,nt,rt,it,st,at,ot,ct){if($.isObject(it)?(at=it,it=st=void 0):$.isObject(st)&&(at=st,st=void 0),!(tt===void 0||$.isString(tt)))throw TypeError("type must be a string");if(!$.isString(nt))throw TypeError("requestType must be a string");if(!$.isString(rt))throw TypeError("responseType must be a string");j.call(this,et,at),this.type=tt||"rpc",this.requestType=nt,this.requestStream=it?!0:void 0,this.responseType=rt,this.responseStream=st?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=ot,this.parsedOptions=ct}return _e.fromJSON=function(tt,nt){return new _e(tt,nt.type,nt.requestType,nt.responseType,nt.requestStream,nt.responseStream,nt.options,nt.comment,nt.parsedOptions)},_e.prototype.toJSON=function(tt){var nt=tt?!!tt.keepComments:!1;return $.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",nt?this.comment:void 0,"parsedOptions",this.parsedOptions])},_e.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),j.prototype.resolve.call(this))},method}var service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=tt;var j=requireNamespace();((tt.prototype=Object.create(j.prototype)).constructor=tt).className="Service";var $=requireMethod(),_e=requireUtil(),et=rpc;function tt(rt,it){j.call(this,rt,it),this.methods={},this._methodsArray=null}tt.fromJSON=function(it,st){var at=new tt(it,st.options);if(st.methods)for(var ot=Object.keys(st.methods),ct=0;ct<ot.length;++ct)at.add($.fromJSON(ot[ct],st.methods[ot[ct]]));return st.nested&&at.addJSON(st.nested),st.edition&&(at._edition=st.edition),at.comment=st.comment,at._defaultEdition="proto3",at},tt.prototype.toJSON=function(it){var st=j.prototype.toJSON.call(this,it),at=it?!!it.keepComments:!1;return _e.toObject(["edition",this._editionToJSON(),"options",st&&st.options||void 0,"methods",j.arrayToJSON(this.methodsArray,it)||{},"nested",st&&st.nested||void 0,"comment",at?this.comment:void 0])},Object.defineProperty(tt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=_e.toArray(this.methods))}});function nt(rt){return rt._methodsArray=null,rt}return tt.prototype.get=function(it){return this.methods[it]||j.prototype.get.call(this,it)},tt.prototype.resolveAll=function(){j.prototype.resolve.call(this);for(var it=this.methodsArray,st=0;st<it.length;++st)it[st].resolve();return this},tt.prototype._resolveFeaturesRecursive=function(it){return it=this._edition||it,j.prototype._resolveFeaturesRecursive.call(this,it),this.methodsArray.forEach(st=>{st._resolveFeaturesRecursive(it)}),this},tt.prototype.add=function(it){if(this.get(it.name))throw Error("duplicate name '"+it.name+"' in "+this);return it instanceof $?(this.methods[it.name]=it,it.parent=this,nt(this)):j.prototype.add.call(this,it)},tt.prototype.remove=function(it){if(it instanceof $){if(this.methods[it.name]!==it)throw Error(it+" is not a member of "+this);return delete this.methods[it.name],it.parent=null,nt(this)}return j.prototype.remove.call(this,it)},tt.prototype.create=function(it,st,at){for(var ot=new et.Service(it,st,at),ct=0,lt;ct<this.methodsArray.length;++ct){var ut=_e.lcFirst((lt=this._methodsArray[ct]).resolve().name).replace(/[^$\w_]/g,"");ot[ut]=_e.codegen(["r","c"],_e.isReserved(ut)?ut+"_":ut)("return this.rpcCall(m,q,s,r,c)")({m:lt,q:lt.resolvedRequestType.ctor,s:lt.resolvedResponseType.ctor})}return ot},service}var message$1=Message,util$2=requireMinimal();function Message(j){if(j)for(var $=Object.keys(j),_e=0;_e<$.length;++_e)this[$[_e]]=j[$[_e]]}Message.create=function j($){return this.$type.create($)};Message.encode=function j($,_e){return this.$type.encode($,_e)};Message.encodeDelimited=function j($,_e){return this.$type.encodeDelimited($,_e)};Message.decode=function j($){return this.$type.decode($)};Message.decodeDelimited=function j($){return this.$type.decodeDelimited($)};Message.verify=function j($){return this.$type.verify($)};Message.fromObject=function j($){return this.$type.fromObject($)};Message.toObject=function j($,_e){return this.$type.toObject($,_e)};Message.prototype.toJSON=function j(){return this.$type.toObject(this,util$2.toJSONOptions)};var decoder_1,hasRequiredDecoder;function requireDecoder(){if(hasRequiredDecoder)return decoder_1;hasRequiredDecoder=1,decoder_1=tt;var j=require_enum(),$=requireTypes(),_e=requireUtil();function et(nt){return"missing required '"+nt.name+"'"}function tt(nt){for(var rt=_e.codegen(["r","l","e"],nt.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(nt.fieldsArray.filter(function(lt){return lt.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),it=0;it<nt.fieldsArray.length;++it){var st=nt._fieldsArray[it].resolve(),at=st.resolvedType instanceof j?"int32":st.type,ot="m"+_e.safeProp(st.name);rt("case %i: {",st.id),st.map?(rt("if(%s===util.emptyObject)",ot)("%s={}",ot)("var c2 = r.uint32()+r.pos"),$.defaults[st.keyType]!==void 0?rt("k=%j",$.defaults[st.keyType]):rt("k=null"),$.defaults[at]!==void 0?rt("value=%j",$.defaults[at]):rt("value=null"),rt("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",st.keyType)("case 2:"),$.basic[at]===void 0?rt("value=types[%i].decode(r,r.uint32())",it):rt("value=r.%s()",at),rt("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),$.long[st.keyType]!==void 0?rt('%s[typeof k==="object"?util.longToHash(k):k]=value',ot):rt("%s[k]=value",ot)):st.repeated?(rt("if(!(%s&&%s.length))",ot,ot)("%s=[]",ot),$.packed[at]!==void 0&&rt("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",ot,at)("}else"),$.basic[at]===void 0?rt(st.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",ot,it):rt("%s.push(r.%s())",ot,at)):$.basic[at]===void 0?rt(st.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",ot,it):rt("%s=r.%s()",ot,at),rt("break")("}")}for(rt("default:")("r.skipType(t&7)")("break")("}")("}"),it=0;it<nt._fieldsArray.length;++it){var ct=nt._fieldsArray[it];ct.required&&rt("if(!m.hasOwnProperty(%j))",ct.name)("throw util.ProtocolError(%j,{instance:m})",et(ct))}return rt("return m")}return decoder_1}var verifier_1,hasRequiredVerifier;function requireVerifier(){if(hasRequiredVerifier)return verifier_1;hasRequiredVerifier=1,verifier_1=nt;var j=require_enum(),$=requireUtil();function _e(rt,it){return rt.name+": "+it+(rt.repeated&&it!=="array"?"[]":rt.map&&it!=="object"?"{k:"+rt.keyType+"}":"")+" expected"}function et(rt,it,st,at){if(it.resolvedType)if(it.resolvedType instanceof j){rt("switch(%s){",at)("default:")("return%j",_e(it,"enum value"));for(var ot=Object.keys(it.resolvedType.values),ct=0;ct<ot.length;++ct)rt("case %i:",it.resolvedType.values[ot[ct]]);rt("break")("}")}else rt("{")("var e=types[%i].verify(%s);",st,at)("if(e)")("return%j+e",it.name+".")("}");else switch(it.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":rt("if(!util.isInteger(%s))",at)("return%j",_e(it,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":rt("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",at,at,at,at)("return%j",_e(it,"integer|Long"));break;case"float":case"double":rt('if(typeof %s!=="number")',at)("return%j",_e(it,"number"));break;case"bool":rt('if(typeof %s!=="boolean")',at)("return%j",_e(it,"boolean"));break;case"string":rt("if(!util.isString(%s))",at)("return%j",_e(it,"string"));break;case"bytes":rt('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',at,at,at)("return%j",_e(it,"buffer"));break}return rt}function tt(rt,it,st){switch(it.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":rt("if(!util.key32Re.test(%s))",st)("return%j",_e(it,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":rt("if(!util.key64Re.test(%s))",st)("return%j",_e(it,"integer|Long key"));break;case"bool":rt("if(!util.key2Re.test(%s))",st)("return%j",_e(it,"boolean key"));break}return rt}function nt(rt){var it=$.codegen(["m"],rt.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),st=rt.oneofsArray,at={};st.length&&it("var p={}");for(var ot=0;ot<rt.fieldsArray.length;++ot){var ct=rt._fieldsArray[ot].resolve(),lt="m"+$.safeProp(ct.name);if(ct.optional&&it("if(%s!=null&&m.hasOwnProperty(%j)){",lt,ct.name),ct.map)it("if(!util.isObject(%s))",lt)("return%j",_e(ct,"object"))("var k=Object.keys(%s)",lt)("for(var i=0;i<k.length;++i){"),tt(it,ct,"k[i]"),et(it,ct,ot,lt+"[k[i]]")("}");else if(ct.repeated)it("if(!Array.isArray(%s))",lt)("return%j",_e(ct,"array"))("for(var i=0;i<%s.length;++i){",lt),et(it,ct,ot,lt+"[i]")("}");else{if(ct.partOf){var ut=$.safeProp(ct.partOf.name);at[ct.partOf.name]===1&&it("if(p%s===1)",ut)("return%j",ct.partOf.name+": multiple values"),at[ct.partOf.name]=1,it("p%s=1",ut)}et(it,ct,ot,lt)}ct.optional&&it("}")}return it("return null")}return verifier_1}var converter={},hasRequiredConverter;function requireConverter(){return hasRequiredConverter||(hasRequiredConverter=1,function(j){var $=j,_e=require_enum(),et=requireUtil();function tt(rt,it,st,at){var ot=!1;if(it.resolvedType)if(it.resolvedType instanceof _e){rt("switch(d%s){",at);for(var ct=it.resolvedType.values,lt=Object.keys(ct),ut=0;ut<lt.length;++ut)ct[lt[ut]]===it.typeDefault&&!ot&&(rt("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',at,at,at),it.repeated||rt("break"),ot=!0),rt("case%j:",lt[ut])("case %i:",ct[lt[ut]])("m%s=%j",at,ct[lt[ut]])("break");rt("}")}else rt('if(typeof d%s!=="object")',at)("throw TypeError(%j)",it.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",at,st,at);else{var pt=!1;switch(it.type){case"double":case"float":rt("m%s=Number(d%s)",at,at);break;case"uint32":case"fixed32":rt("m%s=d%s>>>0",at,at);break;case"int32":case"sint32":case"sfixed32":rt("m%s=d%s|0",at,at);break;case"uint64":pt=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":rt("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",at,at,pt)('else if(typeof d%s==="string")',at)("m%s=parseInt(d%s,10)",at,at)('else if(typeof d%s==="number")',at)("m%s=d%s",at,at)('else if(typeof d%s==="object")',at)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",at,at,at,pt?"true":"");break;case"bytes":rt('if(typeof d%s==="string")',at)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",at,at,at)("else if(d%s.length >= 0)",at)("m%s=d%s",at,at);break;case"string":rt("m%s=String(d%s)",at,at);break;case"bool":rt("m%s=Boolean(d%s)",at,at);break}}return rt}$.fromObject=function(it){var st=it.fieldsArray,at=et.codegen(["d"],it.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!st.length)return at("return new this.ctor");at("var m=new this.ctor");for(var ot=0;ot<st.length;++ot){var ct=st[ot].resolve(),lt=et.safeProp(ct.name);ct.map?(at("if(d%s){",lt)('if(typeof d%s!=="object")',lt)("throw TypeError(%j)",ct.fullName+": object expected")("m%s={}",lt)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",lt),tt(at,ct,ot,lt+"[ks[i]]")("}")("}")):ct.repeated?(at("if(d%s){",lt)("if(!Array.isArray(d%s))",lt)("throw TypeError(%j)",ct.fullName+": array expected")("m%s=[]",lt)("for(var i=0;i<d%s.length;++i){",lt),tt(at,ct,ot,lt+"[i]")("}")("}")):(ct.resolvedType instanceof _e||at("if(d%s!=null){",lt),tt(at,ct,ot,lt),ct.resolvedType instanceof _e||at("}"))}return at("return m")};function nt(rt,it,st,at){if(it.resolvedType)it.resolvedType instanceof _e?rt("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",at,st,at,at,st,at,at):rt("d%s=types[%i].toObject(m%s,o)",at,st,at);else{var ot=!1;switch(it.type){case"double":case"float":rt("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",at,at,at,at);break;case"uint64":ot=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":rt('if(typeof m%s==="number")',at)("d%s=o.longs===String?String(m%s):m%s",at,at,at)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",at,at,at,at,ot?"true":"",at);break;case"bytes":rt("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",at,at,at,at,at);break;default:rt("d%s=m%s",at,at);break}}return rt}$.toObject=function(it){var st=it.fieldsArray.slice().sort(et.compareFieldsById);if(!st.length)return et.codegen()("return {}");for(var at=et.codegen(["m","o"],it.name+"$toObject")("if(!o)")("o={}")("var d={}"),ot=[],ct=[],lt=[],ut=0;ut<st.length;++ut)st[ut].partOf||(st[ut].resolve().repeated?ot:st[ut].map?ct:lt).push(st[ut]);if(ot.length){for(at("if(o.arrays||o.defaults){"),ut=0;ut<ot.length;++ut)at("d%s=[]",et.safeProp(ot[ut].name));at("}")}if(ct.length){for(at("if(o.objects||o.defaults){"),ut=0;ut<ct.length;++ut)at("d%s={}",et.safeProp(ct[ut].name));at("}")}if(lt.length){for(at("if(o.defaults){"),ut=0;ut<lt.length;++ut){var pt=lt[ut],dt=et.safeProp(pt.name);if(pt.resolvedType instanceof _e)at("d%s=o.enums===String?%j:%j",dt,pt.resolvedType.valuesById[pt.typeDefault],pt.typeDefault);else if(pt.long)at("if(util.Long){")("var n=new util.Long(%i,%i,%j)",pt.typeDefault.low,pt.typeDefault.high,pt.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",dt)("}else")("d%s=o.longs===String?%j:%i",dt,pt.typeDefault.toString(),pt.typeDefault.toNumber());else if(pt.bytes){var ht="["+Array.prototype.slice.call(pt.typeDefault).join(",")+"]";at("if(o.bytes===String)d%s=%j",dt,String.fromCharCode.apply(String,pt.typeDefault))("else{")("d%s=%s",dt,ht)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",dt,dt)("}")}else at("d%s=%j",dt,pt.typeDefault)}at("}")}var ft=!1;for(ut=0;ut<st.length;++ut){var pt=st[ut],mt=it._fieldsArray.indexOf(pt),dt=et.safeProp(pt.name);pt.map?(ft||(ft=!0,at("var ks2")),at("if(m%s&&(ks2=Object.keys(m%s)).length){",dt,dt)("d%s={}",dt)("for(var j=0;j<ks2.length;++j){"),nt(at,pt,mt,dt+"[ks2[j]]")("}")):pt.repeated?(at("if(m%s&&m%s.length){",dt,dt)("d%s=[]",dt)("for(var j=0;j<m%s.length;++j){",dt),nt(at,pt,mt,dt+"[j]")("}")):(at("if(m%s!=null&&m.hasOwnProperty(%j)){",dt,pt.name),nt(at,pt,mt,dt),pt.partOf&&at("if(o.oneofs)")("d%s=%j",et.safeProp(pt.partOf.name),pt.name)),at("}")}return at("return d")}}(converter)),converter}var wrappers={};(function(j){var $=j,_e=message$1;$[".google.protobuf.Any"]={fromObject:function(et){if(et&&et["@type"]){var tt=et["@type"].substring(et["@type"].lastIndexOf("/")+1),nt=this.lookup(tt);if(nt){var rt=et["@type"].charAt(0)==="."?et["@type"].slice(1):et["@type"];return rt.indexOf("/")===-1&&(rt="/"+rt),this.create({type_url:rt,value:nt.encode(nt.fromObject(et)).finish()})}}return this.fromObject(et)},toObject:function(et,tt){var nt="type.googleapis.com/",rt="",it="";if(tt&&tt.json&&et.type_url&&et.value){it=et.type_url.substring(et.type_url.lastIndexOf("/")+1),rt=et.type_url.substring(0,et.type_url.lastIndexOf("/")+1);var st=this.lookup(it);st&&(et=st.decode(et.value))}if(!(et instanceof this.ctor)&&et instanceof _e){var at=et.$type.toObject(et,tt),ot=et.$type.fullName[0]==="."?et.$type.fullName.slice(1):et.$type.fullName;return rt===""&&(rt=nt),it=rt+ot,at["@type"]=it,at}return this.toObject(et,tt)}}})(wrappers);var type,hasRequiredType;function requireType(){if(hasRequiredType)return type;hasRequiredType=1,type=dt;var j=requireNamespace();((dt.prototype=Object.create(j.prototype)).constructor=dt).className="Type";var $=require_enum(),_e=requireOneof(),et=requireField(),tt=requireMapfield(),nt=requireService(),rt=message$1,it=reader,st=writer,at=requireUtil(),ot=requireEncoder(),ct=requireDecoder(),lt=requireVerifier(),ut=requireConverter(),pt=wrappers;function dt(ft,mt){j.call(this,ft,mt),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(dt.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var ft=Object.keys(this.fields),mt=0;mt<ft.length;++mt){var gt=this.fields[ft[mt]],yt=gt.id;if(this._fieldsById[yt])throw Error("duplicate id "+yt+" in "+this);this._fieldsById[yt]=gt}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=at.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=at.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=dt.generateConstructor(this)())},set:function(ft){var mt=ft.prototype;mt instanceof rt||((ft.prototype=new rt).constructor=ft,at.merge(ft.prototype,mt)),ft.$type=ft.prototype.$type=this,at.merge(ft,rt,!0),this._ctor=ft;for(var gt=0;gt<this.fieldsArray.length;++gt)this._fieldsArray[gt].resolve();var yt={};for(gt=0;gt<this.oneofsArray.length;++gt)yt[this._oneofsArray[gt].resolve().name]={get:at.oneOfGetter(this._oneofsArray[gt].oneof),set:at.oneOfSetter(this._oneofsArray[gt].oneof)};gt&&Object.defineProperties(ft.prototype,yt)}}}),dt.generateConstructor=function(mt){for(var gt=at.codegen(["p"],mt.name),yt=0,vt;yt<mt.fieldsArray.length;++yt)(vt=mt._fieldsArray[yt]).map?gt("this%s={}",at.safeProp(vt.name)):vt.repeated&&gt("this%s=[]",at.safeProp(vt.name));return gt("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function ht(ft){return ft._fieldsById=ft._fieldsArray=ft._oneofsArray=null,delete ft.encode,delete ft.decode,delete ft.verify,ft}return dt.fromJSON=function(mt,gt){var yt=new dt(mt,gt.options);yt.extensions=gt.extensions,yt.reserved=gt.reserved;for(var vt=Object.keys(gt.fields),xt=0;xt<vt.length;++xt)yt.add((typeof gt.fields[vt[xt]].keyType<"u"?tt.fromJSON:et.fromJSON)(vt[xt],gt.fields[vt[xt]]));if(gt.oneofs)for(vt=Object.keys(gt.oneofs),xt=0;xt<vt.length;++xt)yt.add(_e.fromJSON(vt[xt],gt.oneofs[vt[xt]]));if(gt.nested)for(vt=Object.keys(gt.nested),xt=0;xt<vt.length;++xt){var St=gt.nested[vt[xt]];yt.add((St.id!==void 0?et.fromJSON:St.fields!==void 0?dt.fromJSON:St.values!==void 0?$.fromJSON:St.methods!==void 0?nt.fromJSON:j.fromJSON)(vt[xt],St))}return gt.extensions&&gt.extensions.length&&(yt.extensions=gt.extensions),gt.reserved&&gt.reserved.length&&(yt.reserved=gt.reserved),gt.group&&(yt.group=!0),gt.comment&&(yt.comment=gt.comment),gt.edition&&(yt._edition=gt.edition),yt._defaultEdition="proto3",yt},dt.prototype.toJSON=function(mt){var gt=j.prototype.toJSON.call(this,mt),yt=mt?!!mt.keepComments:!1;return at.toObject(["edition",this._editionToJSON(),"options",gt&&gt.options||void 0,"oneofs",j.arrayToJSON(this.oneofsArray,mt),"fields",j.arrayToJSON(this.fieldsArray.filter(function(vt){return!vt.declaringField}),mt)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",gt&&gt.nested||void 0,"comment",yt?this.comment:void 0])},dt.prototype.resolveAll=function(){j.prototype.resolveAll.call(this);var mt=this.oneofsArray;for(yt=0;yt<mt.length;)mt[yt++].resolve();for(var gt=this.fieldsArray,yt=0;yt<gt.length;)gt[yt++].resolve();return this},dt.prototype._resolveFeaturesRecursive=function(mt){return mt=this._edition||mt,j.prototype._resolveFeaturesRecursive.call(this,mt),this.oneofsArray.forEach(gt=>{gt._resolveFeatures(mt)}),this.fieldsArray.forEach(gt=>{gt._resolveFeatures(mt)}),this},dt.prototype.get=function(mt){return this.fields[mt]||this.oneofs&&this.oneofs[mt]||this.nested&&this.nested[mt]||null},dt.prototype.add=function(mt){if(this.get(mt.name))throw Error("duplicate name '"+mt.name+"' in "+this);if(mt instanceof et&&mt.extend===void 0){if(this._fieldsById?this._fieldsById[mt.id]:this.fieldsById[mt.id])throw Error("duplicate id "+mt.id+" in "+this);if(this.isReservedId(mt.id))throw Error("id "+mt.id+" is reserved in "+this);if(this.isReservedName(mt.name))throw Error("name '"+mt.name+"' is reserved in "+this);return mt.parent&&mt.parent.remove(mt),this.fields[mt.name]=mt,mt.message=this,mt.onAdd(this),ht(this)}return mt instanceof _e?(this.oneofs||(this.oneofs={}),this.oneofs[mt.name]=mt,mt.onAdd(this),ht(this)):j.prototype.add.call(this,mt)},dt.prototype.remove=function(mt){if(mt instanceof et&&mt.extend===void 0){if(!this.fields||this.fields[mt.name]!==mt)throw Error(mt+" is not a member of "+this);return delete this.fields[mt.name],mt.parent=null,mt.onRemove(this),ht(this)}if(mt instanceof _e){if(!this.oneofs||this.oneofs[mt.name]!==mt)throw Error(mt+" is not a member of "+this);return delete this.oneofs[mt.name],mt.parent=null,mt.onRemove(this),ht(this)}return j.prototype.remove.call(this,mt)},dt.prototype.isReservedId=function(mt){return j.isReservedId(this.reserved,mt)},dt.prototype.isReservedName=function(mt){return j.isReservedName(this.reserved,mt)},dt.prototype.create=function(mt){return new this.ctor(mt)},dt.prototype.setup=function(){for(var mt=this.fullName,gt=[],yt=0;yt<this.fieldsArray.length;++yt)gt.push(this._fieldsArray[yt].resolve().resolvedType);this.encode=ot(this)({Writer:st,types:gt,util:at}),this.decode=ct(this)({Reader:it,types:gt,util:at}),this.verify=lt(this)({types:gt,util:at}),this.fromObject=ut.fromObject(this)({types:gt,util:at}),this.toObject=ut.toObject(this)({types:gt,util:at});var vt=pt[mt];if(vt){var xt=Object.create(this);xt.fromObject=this.fromObject,this.fromObject=vt.fromObject.bind(xt),xt.toObject=this.toObject,this.toObject=vt.toObject.bind(xt)}return this},dt.prototype.encode=function(mt,gt){return this.setup().encode(mt,gt)},dt.prototype.encodeDelimited=function(mt,gt){return this.encode(mt,gt&&gt.len?gt.fork():gt).ldelim()},dt.prototype.decode=function(mt,gt){return this.setup().decode(mt,gt)},dt.prototype.decodeDelimited=function(mt){return mt instanceof it||(mt=it.create(mt)),this.decode(mt,mt.uint32())},dt.prototype.verify=function(mt){return this.setup().verify(mt)},dt.prototype.fromObject=function(mt){return this.setup().fromObject(mt)},dt.prototype.toObject=function(mt,gt){return this.setup().toObject(mt,gt)},dt.d=function(mt){return function(yt){at.decorateType(yt,mt)}},type}var root$2,hasRequiredRoot;function requireRoot(){if(hasRequiredRoot)return root$2;hasRequiredRoot=1,root$2=st;var j=requireNamespace();((st.prototype=Object.create(j.prototype)).constructor=st).className="Root";var $=requireField(),_e=require_enum(),et=requireOneof(),tt=requireUtil(),nt,rt,it;function st(lt){j.call(this,"",lt),this.deferred=[],this.files=[],this._edition="proto2"}st.fromJSON=function(ut,pt){return pt||(pt=new st),ut.options&&pt.setOptions(ut.options),pt.addJSON(ut.nested).resolveAll()},st.prototype.resolvePath=tt.path.resolve,st.prototype.fetch=tt.fetch;function at(){}st.prototype.load=function lt(ut,pt,dt){typeof pt=="function"&&(dt=pt,pt=void 0);var ht=this;if(!dt)return tt.asPromise(lt,ht,ut,pt);var ft=dt===at;function mt(wt,Tt){if(dt){if(ft)throw wt;var Ct=dt;dt=null,Tt&&Tt.resolveAll(),Ct(wt,Tt)}}function gt(wt){var Tt=wt.lastIndexOf("google/protobuf/");if(Tt>-1){var Ct=wt.substring(Tt);if(Ct in it)return Ct}return null}function yt(wt,Tt){try{if(tt.isString(Tt)&&Tt.charAt(0)==="{"&&(Tt=JSON.parse(Tt)),!tt.isString(Tt))ht.setOptions(Tt.options).addJSON(Tt.nested);else{rt.filename=wt;var Ct=rt(Tt,ht,pt),Rt,jt=0;if(Ct.imports)for(;jt<Ct.imports.length;++jt)(Rt=gt(Ct.imports[jt])||ht.resolvePath(wt,Ct.imports[jt]))&&vt(Rt);if(Ct.weakImports)for(jt=0;jt<Ct.weakImports.length;++jt)(Rt=gt(Ct.weakImports[jt])||ht.resolvePath(wt,Ct.weakImports[jt]))&&vt(Rt,!0)}}catch(Ot){mt(Ot)}!ft&&!xt&&mt(null,ht)}function vt(wt,Tt){if(wt=gt(wt)||wt,!(ht.files.indexOf(wt)>-1)){if(ht.files.push(wt),wt in it){ft?yt(wt,it[wt]):(++xt,setTimeout(function(){--xt,yt(wt,it[wt])}));return}if(ft){var Ct;try{Ct=tt.fs.readFileSync(wt).toString("utf8")}catch(Rt){Tt||mt(Rt);return}yt(wt,Ct)}else++xt,ht.fetch(wt,function(Rt,jt){if(--xt,!!dt){if(Rt){Tt?xt||mt(null,ht):mt(Rt);return}yt(wt,jt)}})}}var xt=0;tt.isString(ut)&&(ut=[ut]);for(var St=0,Et;St<ut.length;++St)(Et=ht.resolvePath("",ut[St]))&&vt(Et);return ht.resolveAll(),ft||xt||mt(null,ht),ht},st.prototype.loadSync=function(ut,pt){if(!tt.isNode)throw Error("not supported");return this.load(ut,pt,at)},st.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(ut){return"'extend "+ut.extend+"' in "+ut.parent.fullName}).join(", "));return j.prototype.resolveAll.call(this)};var ot=/^[A-Z]/;function ct(lt,ut){var pt=ut.parent.lookup(ut.extend);if(pt){var dt=new $(ut.fullName,ut.id,ut.type,ut.rule,void 0,ut.options);return pt.get(dt.name)||(dt.declaringField=ut,ut.extensionField=dt,pt.add(dt)),!0}return!1}return st.prototype._handleAdd=function(ut){if(ut instanceof $)ut.extend!==void 0&&!ut.extensionField&&(ct(this,ut)||this.deferred.push(ut));else if(ut instanceof _e)ot.test(ut.name)&&(ut.parent[ut.name]=ut.values);else if(!(ut instanceof et)){if(ut instanceof nt)for(var pt=0;pt<this.deferred.length;)ct(this,this.deferred[pt])?this.deferred.splice(pt,1):++pt;for(var dt=0;dt<ut.nestedArray.length;++dt)this._handleAdd(ut._nestedArray[dt]);ot.test(ut.name)&&(ut.parent[ut.name]=ut)}},st.prototype._handleRemove=function(ut){if(ut instanceof $){if(ut.extend!==void 0)if(ut.extensionField)ut.extensionField.parent.remove(ut.extensionField),ut.extensionField=null;else{var pt=this.deferred.indexOf(ut);pt>-1&&this.deferred.splice(pt,1)}}else if(ut instanceof _e)ot.test(ut.name)&&delete ut.parent[ut.name];else if(ut instanceof j){for(var dt=0;dt<ut.nestedArray.length;++dt)this._handleRemove(ut._nestedArray[dt]);ot.test(ut.name)&&delete ut.parent[ut.name]}},st._configure=function(lt,ut,pt){nt=lt,rt=ut,it=pt},root$2}var hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util$3.exports;hasRequiredUtil=1;var j=util$3.exports=requireMinimal(),$=roots,_e,et;j.codegen=codegen_1,j.fetch=fetch_1,j.path=path,j.fs=j.inquire("fs"),j.toArray=function(at){if(at){for(var ot=Object.keys(at),ct=new Array(ot.length),lt=0;lt<ot.length;)ct[lt]=at[ot[lt++]];return ct}return[]},j.toObject=function(at){for(var ot={},ct=0;ct<at.length;){var lt=at[ct++],ut=at[ct++];ut!==void 0&&(ot[lt]=ut)}return ot};var tt=/\\/g,nt=/"/g;j.isReserved=function(at){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(at)},j.safeProp=function(at){return!/^[$\w_]+$/.test(at)||j.isReserved(at)?'["'+at.replace(tt,"\\\\").replace(nt,'\\"')+'"]':"."+at},j.ucFirst=function(at){return at.charAt(0).toUpperCase()+at.substring(1)};var rt=/_([a-z])/g;j.camelCase=function(at){return at.substring(0,1)+at.substring(1).replace(rt,function(ot,ct){return ct.toUpperCase()})},j.compareFieldsById=function(at,ot){return at.id-ot.id},j.decorateType=function(at,ot){if(at.$type)return ot&&at.$type.name!==ot&&(j.decorateRoot.remove(at.$type),at.$type.name=ot,j.decorateRoot.add(at.$type)),at.$type;_e||(_e=requireType());var ct=new _e(ot||at.name);return j.decorateRoot.add(ct),ct.ctor=at,Object.defineProperty(at,"$type",{value:ct,enumerable:!1}),Object.defineProperty(at.prototype,"$type",{value:ct,enumerable:!1}),ct};var it=0;return j.decorateEnum=function(at){if(at.$type)return at.$type;et||(et=require_enum());var ot=new et("Enum"+it++,at);return j.decorateRoot.add(ot),Object.defineProperty(at,"$type",{value:ot,enumerable:!1}),ot},j.setProperty=function(at,ot,ct,lt){function ut(pt,dt,ht){var ft=dt.shift();if(ft==="__proto__"||ft==="prototype")return pt;if(dt.length>0)pt[ft]=ut(pt[ft]||{},dt,ht);else{var mt=pt[ft];if(mt&&lt)return pt;mt&&(ht=[].concat(mt).concat(ht)),pt[ft]=ht}return pt}if(typeof at!="object")throw TypeError("dst must be an object");if(!ot)throw TypeError("path must be specified");return ot=ot.split("."),ut(at,ot,ct)},Object.defineProperty(j,"decorateRoot",{get:function(){return $.decorated||($.decorated=new(requireRoot()))}}),util$3.exports}var hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(j){var $=j,_e=requireUtil(),et=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function tt(nt,rt){var it=0,st={};for(rt|=0;it<nt.length;)st[et[it+rt]]=nt[it++];return st}$.basic=tt([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),$.defaults=tt([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",_e.emptyArray,null]),$.long=tt([0,0,0,1,1],7),$.mapKey=tt([0,0,0,5,5,0,0,0,1,1,0,2],2),$.packed=tt([1,5,0,0,0,5,5,0,0,0,1,1,0])}(types$2)),types$2}var field,hasRequiredField;function requireField(){if(hasRequiredField)return field;hasRequiredField=1,field=rt;var j=requireObject();((rt.prototype=Object.create(j.prototype)).constructor=rt).className="Field";var $=require_enum(),_e=requireTypes(),et=requireUtil(),tt,nt=/^required|optional|repeated$/;rt.fromJSON=function(st,at){var ot=new rt(st,at.id,at.type,at.rule,at.extend,at.options,at.comment);return at.edition&&(ot._edition=at.edition),ot._defaultEdition="proto3",ot};function rt(it,st,at,ot,ct,lt,ut){if(et.isObject(ot)?(ut=ct,lt=ot,ot=ct=void 0):et.isObject(ct)&&(ut=lt,lt=ct,ct=void 0),j.call(this,it,lt),!et.isInteger(st)||st<0)throw TypeError("id must be a non-negative integer");if(!et.isString(at))throw TypeError("type must be a string");if(ot!==void 0&&!nt.test(ot=ot.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(ct!==void 0&&!et.isString(ct))throw TypeError("extend must be a string");ot==="proto3_optional"&&(ot="optional"),this.rule=ot&&ot!=="optional"?ot:void 0,this.type=at,this.id=st,this.extend=ct||void 0,this.repeated=ot==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=et.Long?_e.long[at]!==void 0:!1,this.bytes=at==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=ut}return Object.defineProperty(rt.prototype,"required",{get:function(){return this._features.field_presence==="LEGACY_REQUIRED"}}),Object.defineProperty(rt.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(rt.prototype,"delimited",{get:function(){return this.resolvedType instanceof tt&&this._features.message_encoding==="DELIMITED"}}),Object.defineProperty(rt.prototype,"packed",{get:function(){return this._features.repeated_field_encoding==="PACKED"}}),Object.defineProperty(rt.prototype,"hasPresence",{get:function(){return this.repeated||this.map?!1:this.partOf||this.declaringField||this.extensionField||this._features.field_presence!=="IMPLICIT"}}),rt.prototype.setOption=function(st,at,ot){return j.prototype.setOption.call(this,st,at,ot)},rt.prototype.toJSON=function(st){var at=st?!!st.keepComments:!1;return et.toObject(["edition",this._editionToJSON(),"rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",at?this.comment:void 0])},rt.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=_e.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof tt?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof $&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof $)&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=et.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var st;et.base64.test(this.typeDefault)?et.base64.decode(this.typeDefault,st=et.newBuffer(et.base64.length(this.typeDefault)),0):et.utf8.write(this.typeDefault,st=et.newBuffer(et.utf8.length(this.typeDefault)),0),this.typeDefault=st}return this.map?this.defaultValue=et.emptyObject:this.repeated?this.defaultValue=et.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof tt&&(this.parent.ctor.prototype[this.name]=this.defaultValue),j.prototype.resolve.call(this)},rt.prototype._inferLegacyProtoFeatures=function(st){if(st!=="proto2"&&st!=="proto3")return{};var at={};return this.resolve(),this.rule==="required"&&(at.field_presence="LEGACY_REQUIRED"),this.resolvedType instanceof tt&&this.resolvedType.group&&(at.message_encoding="DELIMITED"),this.getOption("packed")===!0?at.repeated_field_encoding="PACKED":this.getOption("packed")===!1&&(at.repeated_field_encoding="EXPANDED"),at},rt.prototype._resolveFeatures=function(st){return j.prototype._resolveFeatures.call(this,this._edition||st)},rt.d=function(st,at,ot,ct){return typeof at=="function"?at=et.decorateType(at).name:at&&typeof at=="object"&&(at=et.decorateEnum(at).name),function(ut,pt){et.decorateType(ut.constructor).add(new rt(pt,st,at,ot,{default:ct}))}},rt._configure=function(st){tt=st},field}var oneof,hasRequiredOneof;function requireOneof(){if(hasRequiredOneof)return oneof;hasRequiredOneof=1,oneof=et;var j=requireObject();((et.prototype=Object.create(j.prototype)).constructor=et).className="OneOf";var $=requireField(),_e=requireUtil();function et(nt,rt,it,st){if(Array.isArray(rt)||(it=rt,rt=void 0),j.call(this,nt,it),!(rt===void 0||Array.isArray(rt)))throw TypeError("fieldNames must be an Array");this.oneof=rt||[],this.fieldsArray=[],this.comment=st}et.fromJSON=function(rt,it){return new et(rt,it.oneof,it.options,it.comment)},et.prototype.toJSON=function(rt){var it=rt?!!rt.keepComments:!1;return _e.toObject(["options",this.options,"oneof",this.oneof,"comment",it?this.comment:void 0])};function tt(nt){if(nt.parent)for(var rt=0;rt<nt.fieldsArray.length;++rt)nt.fieldsArray[rt].parent||nt.parent.add(nt.fieldsArray[rt])}return et.prototype.add=function(rt){if(!(rt instanceof $))throw TypeError("field must be a Field");return rt.parent&&rt.parent!==this.parent&&rt.parent.remove(rt),this.oneof.push(rt.name),this.fieldsArray.push(rt),rt.partOf=this,tt(this),this},et.prototype.remove=function(rt){if(!(rt instanceof $))throw TypeError("field must be a Field");var it=this.fieldsArray.indexOf(rt);if(it<0)throw Error(rt+" is not a member of "+this);return this.fieldsArray.splice(it,1),it=this.oneof.indexOf(rt.name),it>-1&&this.oneof.splice(it,1),rt.partOf=null,this},et.prototype.onAdd=function(rt){j.prototype.onAdd.call(this,rt);for(var it=this,st=0;st<this.oneof.length;++st){var at=rt.get(this.oneof[st]);at&&!at.partOf&&(at.partOf=it,it.fieldsArray.push(at))}tt(this)},et.prototype.onRemove=function(rt){for(var it=0,st;it<this.fieldsArray.length;++it)(st=this.fieldsArray[it]).parent&&st.parent.remove(st);j.prototype.onRemove.call(this,rt)},Object.defineProperty(et.prototype,"isProto3Optional",{get:function(){if(this.fieldsArray==null||this.fieldsArray.length!==1)return!1;var nt=this.fieldsArray[0];return nt.options!=null&&nt.options.proto3_optional===!0}}),et.d=function(){for(var rt=new Array(arguments.length),it=0;it<arguments.length;)rt[it]=arguments[it++];return function(at,ot){_e.decorateType(at.constructor).add(new et(ot,rt)),Object.defineProperty(at,ot,{get:_e.oneOfGetter(rt),set:_e.oneOfSetter(rt)})}},oneof}var object$1,hasRequiredObject;function requireObject(){if(hasRequiredObject)return object$1;hasRequiredObject=1,object$1=rt,rt.className="ReflectionObject";const j=requireOneof();var $=requireUtil(),_e,et={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},tt={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},nt={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function rt(it,st){if(!$.isString(it))throw TypeError("name must be a string");if(st&&!$.isObject(st))throw TypeError("options must be an object");this.options=st,this.parsedOptions=null,this.name=it,this._edition=null,this._defaultEdition="proto2",this._features={},this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}return Object.defineProperties(rt.prototype,{root:{get:function(){for(var it=this;it.parent!==null;)it=it.parent;return it}},fullName:{get:function(){for(var it=[this.name],st=this.parent;st;)it.unshift(st.name),st=st.parent;return it.join(".")}}}),rt.prototype.toJSON=function(){throw Error()},rt.prototype.onAdd=function(st){this.parent&&this.parent!==st&&this.parent.remove(this),this.parent=st,this.resolved=!1;var at=st.root;at instanceof _e&&at._handleAdd(this)},rt.prototype.onRemove=function(st){var at=st.root;at instanceof _e&&at._handleRemove(this),this.parent=null,this.resolved=!1},rt.prototype.resolve=function(){return this.resolved?this:(this instanceof _e&&(this._resolveFeaturesRecursive(this._edition),this.resolved=!0),this)},rt.prototype._resolveFeaturesRecursive=function(st){return this._resolveFeatures(this._edition||st)},rt.prototype._resolveFeatures=function(st){var at={};if(!st)throw new Error("Unknown edition for "+this.fullName);var ot=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(st));if(this._edition){if(st==="proto2")at=Object.assign({},tt);else if(st==="proto3")at=Object.assign({},nt);else if(st==="2023")at=Object.assign({},et);else throw new Error("Unknown edition: "+st);this._features=Object.assign(at,ot||{});return}if(this.partOf instanceof j){var ct=Object.assign({},this.partOf._features);this._features=Object.assign(ct,ot||{})}else if(!this.declaringField)if(this.parent){var lt=Object.assign({},this.parent._features);this._features=Object.assign(lt,ot||{})}else throw new Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features)},rt.prototype._inferLegacyProtoFeatures=function(){return{}},rt.prototype.getOption=function(st){if(this.options)return this.options[st]},rt.prototype.setOption=function(st,at,ot){return this.options||(this.options={}),/^features\./.test(st)?$.setProperty(this.options,st,at,ot):(!ot||this.options[st]===void 0)&&(this.getOption(st)!==at&&(this.resolved=!1),this.options[st]=at),this},rt.prototype.setParsedOption=function(st,at,ot){this.parsedOptions||(this.parsedOptions=[]);var ct=this.parsedOptions;if(ot){var lt=ct.find(function(dt){return Object.prototype.hasOwnProperty.call(dt,st)});if(lt){var ut=lt[st];$.setProperty(ut,ot,at)}else lt={},lt[st]=$.setProperty({},ot,at),ct.push(lt)}else{var pt={};pt[st]=at,ct.push(pt)}return this},rt.prototype.setOptions=function(st,at){if(st)for(var ot=Object.keys(st),ct=0;ct<ot.length;++ct)this.setOption(ot[ct],st[ot[ct]],at);return this},rt.prototype.toString=function(){var st=this.constructor.className,at=this.fullName;return at.length?st+" "+at:st},rt.prototype._editionToJSON=function(){if(!(!this._edition||this._edition==="proto3"))return this._edition},rt._configure=function(it){_e=it},object$1}var _enum,hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,_enum=et;var j=requireObject();((et.prototype=Object.create(j.prototype)).constructor=et).className="Enum";var $=requireNamespace(),_e=requireUtil();function et(tt,nt,rt,it,st,at){if(j.call(this,tt,rt),nt&&typeof nt!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=it,this.comments=st||{},this.valuesOptions=at,this._valuesFeatures={},this.reserved=void 0,nt)for(var ot=Object.keys(nt),ct=0;ct<ot.length;++ct)typeof nt[ot[ct]]=="number"&&(this.valuesById[this.values[ot[ct]]=nt[ot[ct]]]=ot[ct])}return et.prototype._resolveFeatures=function(nt){return nt=this._edition||nt,j.prototype._resolveFeatures.call(this,nt),Object.keys(this.values).forEach(rt=>{var it=Object.assign({},this._features);this._valuesFeatures[rt]=Object.assign(it,this.valuesOptions&&this.valuesOptions[rt]&&this.valuesOptions[rt].features)}),this},et.fromJSON=function(nt,rt){var it=new et(nt,rt.values,rt.options,rt.comment,rt.comments);return it.reserved=rt.reserved,rt.edition&&(it._edition=rt.edition),it._defaultEdition="proto3",it},et.prototype.toJSON=function(nt){var rt=nt?!!nt.keepComments:!1;return _e.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",rt?this.comment:void 0,"comments",rt?this.comments:void 0])},et.prototype.add=function(nt,rt,it,st){if(!_e.isString(nt))throw TypeError("name must be a string");if(!_e.isInteger(rt))throw TypeError("id must be an integer");if(this.values[nt]!==void 0)throw Error("duplicate name '"+nt+"' in "+this);if(this.isReservedId(rt))throw Error("id "+rt+" is reserved in "+this);if(this.isReservedName(nt))throw Error("name '"+nt+"' is reserved in "+this);if(this.valuesById[rt]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+rt+" in "+this);this.values[nt]=rt}else this.valuesById[this.values[nt]=rt]=nt;return st&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[nt]=st||null),this.comments[nt]=it||null,this},et.prototype.remove=function(nt){if(!_e.isString(nt))throw TypeError("name must be a string");var rt=this.values[nt];if(rt==null)throw Error("name '"+nt+"' does not exist in "+this);return delete this.valuesById[rt],delete this.values[nt],delete this.comments[nt],this.valuesOptions&&delete this.valuesOptions[nt],this},et.prototype.isReservedId=function(nt){return $.isReservedId(this.reserved,nt)},et.prototype.isReservedName=function(nt){return $.isReservedName(this.reserved,nt)},_enum}var encoder_1,hasRequiredEncoder;function requireEncoder(){if(hasRequiredEncoder)return encoder_1;hasRequiredEncoder=1,encoder_1=tt;var j=require_enum(),$=requireTypes(),_e=requireUtil();function et(nt,rt,it,st){return rt.delimited?nt("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",it,st,(rt.id<<3|3)>>>0,(rt.id<<3|4)>>>0):nt("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",it,st,(rt.id<<3|2)>>>0)}function tt(nt){for(var rt=_e.codegen(["m","w"],nt.name+"$encode")("if(!w)")("w=Writer.create()"),it,st,at=nt.fieldsArray.slice().sort(_e.compareFieldsById),it=0;it<at.length;++it){var ot=at[it].resolve(),ct=nt._fieldsArray.indexOf(ot),lt=ot.resolvedType instanceof j?"int32":ot.type,ut=$.basic[lt];st="m"+_e.safeProp(ot.name),ot.map?(rt("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",st,ot.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",st)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(ot.id<<3|2)>>>0,8|$.mapKey[ot.keyType],ot.keyType),ut===void 0?rt("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",ct,st):rt(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|ut,lt,st),rt("}")("}")):ot.repeated?(rt("if(%s!=null&&%s.length){",st,st),ot.packed&&$.packed[lt]!==void 0?rt("w.uint32(%i).fork()",(ot.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",st)("w.%s(%s[i])",lt,st)("w.ldelim()"):(rt("for(var i=0;i<%s.length;++i)",st),ut===void 0?et(rt,ot,ct,st+"[i]"):rt("w.uint32(%i).%s(%s[i])",(ot.id<<3|ut)>>>0,lt,st)),rt("}")):(ot.optional&&rt("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",st,ot.name),ut===void 0?et(rt,ot,ct,st):rt("w.uint32(%i).%s(%s)",(ot.id<<3|ut)>>>0,lt,st))}return rt("return w")}return encoder_1}var protobuf$2=indexLight.exports=indexMinimal;protobuf$2.build="light";function load(j,$,_e){return typeof $=="function"?(_e=$,$=new protobuf$2.Root):$||($=new protobuf$2.Root),$.load(j,_e)}protobuf$2.load=load;function loadSync(j,$){return $||($=new protobuf$2.Root),$.loadSync(j)}protobuf$2.loadSync=loadSync;protobuf$2.encoder=requireEncoder();protobuf$2.decoder=requireDecoder();protobuf$2.verifier=requireVerifier();protobuf$2.converter=requireConverter();protobuf$2.ReflectionObject=requireObject();protobuf$2.Namespace=requireNamespace();protobuf$2.Root=requireRoot();protobuf$2.Enum=require_enum();protobuf$2.Type=requireType();protobuf$2.Field=requireField();protobuf$2.OneOf=requireOneof();protobuf$2.MapField=requireMapfield();protobuf$2.Service=requireService();protobuf$2.Method=requireMethod();protobuf$2.Message=message$1;protobuf$2.wrappers=wrappers;protobuf$2.types=requireTypes();protobuf$2.util=requireUtil();protobuf$2.ReflectionObject._configure(protobuf$2.Root);protobuf$2.Namespace._configure(protobuf$2.Type,protobuf$2.Service,protobuf$2.Enum);protobuf$2.Root._configure(protobuf$2.Type);protobuf$2.Field._configure(protobuf$2.Type);var indexLightExports=indexLight.exports,tokenize_1=tokenize$1,delimRe=/[\s{}=;:[\],'"()<>]/g,stringDoubleRe=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,stringSingleRe=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,setCommentRe=/^ *[*/]+ */,setCommentAltRe=/^\s*\*?\/*/,setCommentSplitRe=/\n/g,whitespaceRe=/\s/,unescapeRe=/\\(.?)/g,unescapeMap={0:"\0",r:"\r",n:`
`,t:"	"};function unescape$1(j){return j.replace(unescapeRe,function($,_e){switch(_e){case"\\":case"":return _e;default:return unescapeMap[_e]||""}})}tokenize$1.unescape=unescape$1;function tokenize$1(j,$){j=j.toString();var _e=0,et=j.length,tt=1,nt=0,rt={},it=[],st=null;function at(yt){return Error("illegal "+yt+" (line "+tt+")")}function ot(){var yt=st==="'"?stringSingleRe:stringDoubleRe;yt.lastIndex=_e-1;var vt=yt.exec(j);if(!vt)throw at("string");return _e=yt.lastIndex,ht(st),st=null,unescape$1(vt[1])}function ct(yt){return j.charAt(yt)}function lt(yt,vt,xt){var St={type:j.charAt(yt++),lineEmpty:!1,leading:xt},Et;$?Et=2:Et=3;var wt=yt-Et,Tt;do if(--wt<0||(Tt=j.charAt(wt))===`
`){St.lineEmpty=!0;break}while(Tt===" "||Tt==="	");for(var Ct=j.substring(yt,vt).split(setCommentSplitRe),Rt=0;Rt<Ct.length;++Rt)Ct[Rt]=Ct[Rt].replace($?setCommentAltRe:setCommentRe,"").trim();St.text=Ct.join(`
`).trim(),rt[tt]=St,nt=tt}function ut(yt){var vt=pt(yt),xt=j.substring(yt,vt),St=/^\s*\/\//.test(xt);return St}function pt(yt){for(var vt=yt;vt<et&&ct(vt)!==`
`;)vt++;return vt}function dt(){if(it.length>0)return it.shift();if(st)return ot();var yt,vt,xt,St,Et,wt=_e===0;do{if(_e===et)return null;for(yt=!1;whitespaceRe.test(xt=ct(_e));)if(xt===`
`&&(wt=!0,++tt),++_e===et)return null;if(ct(_e)==="/"){if(++_e===et)throw at("comment");if(ct(_e)==="/")if($){if(St=_e,Et=!1,ut(_e-1)){Et=!0;do if(_e=pt(_e),_e===et||(_e++,!wt))break;while(ut(_e))}else _e=Math.min(et,pt(_e)+1);Et&&(lt(St,_e,wt),wt=!0),tt++,yt=!0}else{for(Et=ct(St=_e+1)==="/";ct(++_e)!==`
`;)if(_e===et)return null;++_e,Et&&(lt(St,_e-1,wt),wt=!0),++tt,yt=!0}else if((xt=ct(_e))==="*"){St=_e+1,Et=$||ct(St)==="*";do{if(xt===`
`&&++tt,++_e===et)throw at("comment");vt=xt,xt=ct(_e)}while(vt!=="*"||xt!=="/");++_e,Et&&(lt(St,_e-2,wt),wt=!0),yt=!0}else return"/"}}while(yt);var Tt=_e;delimRe.lastIndex=0;var Ct=delimRe.test(ct(Tt++));if(!Ct)for(;Tt<et&&!delimRe.test(ct(Tt));)++Tt;var Rt=j.substring(_e,_e=Tt);return(Rt==='"'||Rt==="'")&&(st=Rt),Rt}function ht(yt){it.push(yt)}function ft(){if(!it.length){var yt=dt();if(yt===null)return null;ht(yt)}return it[0]}function mt(yt,vt){var xt=ft(),St=xt===yt;if(St)return dt(),!0;if(!vt)throw at("token '"+xt+"', '"+yt+"' expected");return!1}function gt(yt){var vt=null,xt;return yt===void 0?(xt=rt[tt-1],delete rt[tt-1],xt&&($||xt.type==="*"||xt.lineEmpty)&&(vt=xt.leading?xt.text:null)):(nt<yt&&ft(),xt=rt[yt],delete rt[yt],xt&&!xt.lineEmpty&&($||xt.type==="/")&&(vt=xt.leading?null:xt.text)),vt}return Object.defineProperty({next:dt,peek:ft,push:ht,skip:mt,cmnt:gt},"line",{get:function(){return tt}})}var parse_1=parse$3;parse$3.filename=null;parse$3.defaults={keepCase:!1};var tokenize=tokenize_1,Root$2=requireRoot(),Type=requireType(),Field=requireField(),MapField=requireMapfield(),OneOf=requireOneof(),Enum=require_enum(),Service=requireService(),Method=requireMethod(),ReflectionObject=requireObject(),types$1=requireTypes(),util$1=requireUtil(),base10Re=/^[1-9][0-9]*$/,base10NegRe=/^-?[1-9][0-9]*$/,base16Re=/^0[x][0-9a-fA-F]+$/,base16NegRe=/^-?0[x][0-9a-fA-F]+$/,base8Re=/^0[0-7]+$/,base8NegRe=/^-?0[0-7]+$/,numberRe$1=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,nameRe$1=/^[a-zA-Z_][a-zA-Z_0-9]*$/,typeRefRe=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function parse$3(j,$,_e){$ instanceof Root$2||(_e=$,$=new Root$2),_e||(_e=parse$3.defaults);var et=_e.preferTrailingComment||!1,tt=tokenize(j,_e.alternateCommentMode||!1),nt=tt.next,rt=tt.push,it=tt.peek,st=tt.skip,at=tt.cmnt,ot=!0,ct,lt,ut,pt="proto2",dt=$,ht=[],ft={},mt=_e.keepCase?function(Pt){return Pt}:util$1.camelCase;function gt(){ht.forEach(Pt=>{Pt._edition=pt,Object.keys(ft).forEach(Mt=>{Pt.getOption(Mt)===void 0&&Pt.setOption(Mt,ft[Mt],!0)})})}function yt(Pt,Mt,Vt){var qt=parse$3.filename;return Vt||(parse$3.filename=null),Error("illegal "+(Mt||"token")+" '"+Pt+"' ("+(qt?qt+", ":"")+"line "+tt.line+")")}function vt(){var Pt=[],Mt;do{if((Mt=nt())!=='"'&&Mt!=="'")throw yt(Mt);Pt.push(nt()),st(Mt),Mt=it()}while(Mt==='"'||Mt==="'");return Pt.join("")}function xt(Pt){var Mt=nt();switch(Mt){case"'":case'"':return rt(Mt),vt();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return Et(Mt,!0)}catch{if(typeRefRe.test(Mt))return Mt;throw yt(Mt,"value")}}function St(Pt,Mt){var Vt,qt;do if(Mt&&((Vt=it())==='"'||Vt==="'")){var en=vt();if(Pt.push(en),pt>=2023)throw yt(en,"id")}else try{Pt.push([qt=wt(nt()),st("to",!0)?wt(nt()):qt])}catch(Cn){if(Mt&&typeRefRe.test(Vt)&&pt>=2023)Pt.push(Vt);else throw Cn}while(st(",",!0));var fn={options:void 0};fn.setOption=function(Cn,En){this.options===void 0&&(this.options={}),this.options[Cn]=En},$t(fn,function(En){if(En==="option")_t(fn,En),st(";");else throw yt(En)},function(){It(fn)})}function Et(Pt,Mt){var Vt=1;switch(Pt.charAt(0)==="-"&&(Vt=-1,Pt=Pt.substring(1)),Pt){case"inf":case"INF":case"Inf":return Vt*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(base10Re.test(Pt))return Vt*parseInt(Pt,10);if(base16Re.test(Pt))return Vt*parseInt(Pt,16);if(base8Re.test(Pt))return Vt*parseInt(Pt,8);if(numberRe$1.test(Pt))return Vt*parseFloat(Pt);throw yt(Pt,"number",Mt)}function wt(Pt,Mt){switch(Pt){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!Mt&&Pt.charAt(0)==="-")throw yt(Pt,"id");if(base10NegRe.test(Pt))return parseInt(Pt,10);if(base16NegRe.test(Pt))return parseInt(Pt,16);if(base8NegRe.test(Pt))return parseInt(Pt,8);throw yt(Pt,"id")}function Tt(){if(ct!==void 0)throw yt("package");if(ct=nt(),!typeRefRe.test(ct))throw yt(ct,"name");dt=dt.define(ct),st(";")}function Ct(){var Pt=it(),Mt;switch(Pt){case"weak":Mt=ut||(ut=[]),nt();break;case"public":nt();default:Mt=lt||(lt=[]);break}Pt=vt(),st(";"),Mt.push(Pt)}function Rt(){if(st("="),pt=vt(),pt<2023)throw yt(pt,"syntax");st(";")}function jt(){if(st("="),pt=vt(),!["2023"].includes(pt))throw yt(pt,"edition");st(";")}function Ot(Pt,Mt){switch(Mt){case"option":return _t(Pt,Mt),st(";"),!0;case"message":return Kt(Pt,Mt),!0;case"enum":return rn(Pt,Mt),!0;case"service":return Zt(Pt,Mt),!0;case"extend":return Xt(Pt,Mt),!0}return!1}function $t(Pt,Mt,Vt){var qt=tt.line;if(Pt&&(typeof Pt.comment!="string"&&(Pt.comment=at()),Pt.filename=parse$3.filename),st("{",!0)){for(var en;(en=nt())!=="}";)Mt(en);st(";",!0)}else Vt&&Vt(),st(";"),Pt&&(typeof Pt.comment!="string"||et)&&(Pt.comment=at(qt)||Pt.comment)}function Kt(Pt,Mt){if(!nameRe$1.test(Mt=nt()))throw yt(Mt,"type name");var Vt=new Type(Mt);$t(Vt,function(en){if(!Ot(Vt,en))switch(en){case"map":Bt(Vt);break;case"required":if(pt!=="proto2")throw yt(en);case"repeated":Lt(Vt,en);break;case"optional":if(pt==="proto3")Lt(Vt,"proto3_optional");else{if(pt!=="proto2")throw yt(en);Lt(Vt,"optional")}break;case"oneof":kt(Vt,en);break;case"extensions":St(Vt.extensions||(Vt.extensions=[]));break;case"reserved":St(Vt.reserved||(Vt.reserved=[]),!0);break;default:if(pt==="proto2"||!typeRefRe.test(en))throw yt(en);rt(en),Lt(Vt,"optional");break}}),Pt.add(Vt),Pt===dt&&ht.push(Vt)}function Lt(Pt,Mt,Vt){var qt=nt();if(qt==="group"){Nt(Pt,Mt);return}for(;qt.endsWith(".")||it().startsWith(".");)qt+=nt();if(!typeRefRe.test(qt))throw yt(qt,"type");var en=nt();if(!nameRe$1.test(en))throw yt(en,"name");en=mt(en),st("=");var fn=new Field(en,wt(nt()),qt,Mt,Vt);if($t(fn,function(Pn){if(Pn==="option")_t(fn,Pn),st(";");else throw yt(Pn)},function(){It(fn)}),Mt==="proto3_optional"){var Cn=new OneOf("_"+en);fn.setOption("proto3_optional",!0),Cn.add(fn),Pt.add(Cn)}else Pt.add(fn);Pt===dt&&ht.push(fn)}function Nt(Pt,Mt){if(pt>=2023)throw yt("group");var Vt=nt();if(!nameRe$1.test(Vt))throw yt(Vt,"name");var qt=util$1.lcFirst(Vt);Vt===qt&&(Vt=util$1.ucFirst(Vt)),st("=");var en=wt(nt()),fn=new Type(Vt);fn.group=!0;var Cn=new Field(qt,en,Vt,Mt);Cn.filename=parse$3.filename,$t(fn,function(Pn){switch(Pn){case"option":_t(fn,Pn),st(";");break;case"required":case"repeated":Lt(fn,Pn);break;case"optional":pt==="proto3"?Lt(fn,"proto3_optional"):Lt(fn,"optional");break;case"message":Kt(fn,Pn);break;case"enum":rn(fn,Pn);break;default:throw yt(Pn)}}),Pt.add(fn).add(Cn)}function Bt(Pt){st("<");var Mt=nt();if(types$1.mapKey[Mt]===void 0)throw yt(Mt,"type");st(",");var Vt=nt();if(!typeRefRe.test(Vt))throw yt(Vt,"type");st(">");var qt=nt();if(!nameRe$1.test(qt))throw yt(qt,"name");st("=");var en=new MapField(mt(qt),wt(nt()),Mt,Vt);$t(en,function(Cn){if(Cn==="option")_t(en,Cn),st(";");else throw yt(Cn)},function(){It(en)}),Pt.add(en)}function kt(Pt,Mt){if(!nameRe$1.test(Mt=nt()))throw yt(Mt,"name");var Vt=new OneOf(mt(Mt));$t(Vt,function(en){en==="option"?(_t(Vt,en),st(";")):(rt(en),Lt(Vt,"optional"))}),Pt.add(Vt)}function rn(Pt,Mt){if(!nameRe$1.test(Mt=nt()))throw yt(Mt,"name");var Vt=new Enum(Mt);$t(Vt,function(en){switch(en){case"option":_t(Vt,en),st(";");break;case"reserved":St(Vt.reserved||(Vt.reserved=[]),!0),Vt.reserved===void 0&&(Vt.reserved=[]);break;default:Gt(Vt,en)}}),Pt.add(Vt),Pt===dt&&ht.push(Vt)}function Gt(Pt,Mt){if(!nameRe$1.test(Mt))throw yt(Mt,"name");st("=");var Vt=wt(nt(),!0),qt={options:void 0};qt.getOption=function(en){return this.options[en]},qt.setOption=function(en,fn){ReflectionObject.prototype.setOption.call(qt,en,fn)},qt.setParsedOption=function(){},$t(qt,function(fn){if(fn==="option")_t(qt,fn),st(";");else throw yt(fn)},function(){It(qt)}),Pt.add(Mt,Vt,qt.comment,qt.parsedOptions||qt.options)}function _t(Pt,Mt){var Vt,qt,en=!0;for(Mt==="option"&&(Mt=nt());Mt!=="=";){if(Mt==="("){var fn=nt();st(")"),Mt="("+fn+")"}if(en){if(en=!1,Mt.includes(".")&&!Mt.includes("(")){var Cn=Mt.split(".");Vt=Cn[0]+".",Mt=Cn[1];continue}Vt=Mt}else qt=qt?qt+=Mt:Mt;Mt=nt()}var En=qt?Vt.concat(qt):Vt,Pn=sn(Pt,En);qt=qt&&qt[0]==="."?qt.slice(1):qt,Vt=Vt&&Vt[Vt.length-1]==="."?Vt.slice(0,-1):Vt,on(Pt,Vt,Pn,qt)}function sn(Pt,Mt){if(st("{",!0)){for(var Vt={};!st("}",!0);){if(!nameRe$1.test(Ht=nt()))throw yt(Ht,"name");if(Ht===null)throw yt(Ht,"end of input");var qt,en=Ht;if(st(":",!0),it()==="{")qt=sn(Pt,Mt+"."+Ht);else if(it()==="["){qt=[];var fn;if(st("[",!0)){do fn=xt(),qt.push(fn);while(st(",",!0));st("]"),typeof fn<"u"&&tn(Pt,Mt+"."+Ht,fn)}}else qt=xt(),tn(Pt,Mt+"."+Ht,qt);var Cn=Vt[en];Cn&&(qt=[].concat(Cn).concat(qt)),Vt[en]=qt,st(",",!0),st(";",!0)}return Vt}var En=xt();return tn(Pt,Mt,En),En}function tn(Pt,Mt,Vt){if(dt===Pt&&/^features\./.test(Mt)){ft[Mt]=Vt;return}Pt.setOption&&Pt.setOption(Mt,Vt)}function on(Pt,Mt,Vt,qt){Pt.setParsedOption&&Pt.setParsedOption(Mt,Vt,qt)}function It(Pt){if(st("[",!0)){do _t(Pt,"option");while(st(",",!0));st("]")}return Pt}function Zt(Pt,Mt){if(!nameRe$1.test(Mt=nt()))throw yt(Mt,"service name");var Vt=new Service(Mt);$t(Vt,function(en){if(!Ot(Vt,en))if(en==="rpc")Ut(Vt,en);else throw yt(en)}),Pt.add(Vt),Pt===dt&&ht.push(Vt)}function Ut(Pt,Mt){var Vt=at(),qt=Mt;if(!nameRe$1.test(Mt=nt()))throw yt(Mt,"name");var en=Mt,fn,Cn,En,Pn;if(st("("),st("stream",!0)&&(Cn=!0),!typeRefRe.test(Mt=nt())||(fn=Mt,st(")"),st("returns"),st("("),st("stream",!0)&&(Pn=!0),!typeRefRe.test(Mt=nt())))throw yt(Mt);En=Mt,st(")");var Rn=new Method(en,qt,fn,En,Cn,Pn);Rn.comment=Vt,$t(Rn,function(xn){if(xn==="option")_t(Rn,xn),st(";");else throw yt(xn)}),Pt.add(Rn)}function Xt(Pt,Mt){if(!typeRefRe.test(Mt=nt()))throw yt(Mt,"reference");var Vt=Mt;$t(null,function(en){switch(en){case"required":case"repeated":Lt(Pt,en,Vt);break;case"optional":pt==="proto3"?Lt(Pt,"proto3_optional",Vt):Lt(Pt,"optional",Vt);break;default:if(pt==="proto2"||!typeRefRe.test(en))throw yt(en);rt(en),Lt(Pt,"optional",Vt);break}})}for(var Ht;(Ht=nt())!==null;)switch(Ht){case"package":if(!ot)throw yt(Ht);Tt();break;case"import":if(!ot)throw yt(Ht);Ct();break;case"syntax":if(!ot)throw yt(Ht);Rt();break;case"edition":if(!ot)throw yt(Ht);jt();break;case"option":_t(dt,Ht),st(";",!0);break;default:if(Ot(dt,Ht)){ot=!1;continue}throw yt(Ht)}return gt(),parse$3.filename=null,{package:ct,imports:lt,weakImports:ut,root:$}}var common_1=common$1,commonRe=/\/|\./;function common$1(j,$){commonRe.test(j)||(j="google/protobuf/"+j+".proto",$={nested:{google:{nested:{protobuf:{nested:$}}}}}),common$1[j]=$}common$1("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var timeType;common$1("duration",{Duration:timeType={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common$1("timestamp",{Timestamp:timeType});common$1("empty",{Empty:{fields:{}}});common$1("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common$1("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common$1("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common$1.get=function j($){return common$1[$]||null};var protobuf$1=src.exports=indexLightExports;protobuf$1.build="full";protobuf$1.tokenize=tokenize_1;protobuf$1.parse=parse_1;protobuf$1.common=common_1;protobuf$1.Root._configure(protobuf$1.Type,protobuf$1.parse,protobuf$1.common);var srcExports=src.exports,protobufjs=srcExports;const protobuf=getDefaultExportFromCjs$1(protobufjs);var extendStatics=function(j,$){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_e,et){_e.__proto__=et}||function(_e,et){for(var tt in et)Object.prototype.hasOwnProperty.call(et,tt)&&(_e[tt]=et[tt])},extendStatics(j,$)};function __extends(j,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");extendStatics(j,$);function _e(){this.constructor=j}j.prototype=$===null?Object.create($):(_e.prototype=$.prototype,new _e)}var __assign$1=function(){return __assign$1=Object.assign||function($){for(var _e,et=1,tt=arguments.length;et<tt;et++){_e=arguments[et];for(var nt in _e)Object.prototype.hasOwnProperty.call(_e,nt)&&($[nt]=_e[nt])}return $},__assign$1.apply(this,arguments)};function __awaiter(j,$,_e,et){function tt(nt){return nt instanceof _e?nt:new _e(function(rt){rt(nt)})}return new(_e||(_e=Promise))(function(nt,rt){function it(ot){try{at(et.next(ot))}catch(ct){rt(ct)}}function st(ot){try{at(et.throw(ot))}catch(ct){rt(ct)}}function at(ot){ot.done?nt(ot.value):tt(ot.value).then(it,st)}at((et=et.apply(j,$||[])).next())})}function __generator(j,$){var _e={label:0,sent:function(){if(nt[0]&1)throw nt[1];return nt[1]},trys:[],ops:[]},et,tt,nt,rt=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return rt.next=it(0),rt.throw=it(1),rt.return=it(2),typeof Symbol=="function"&&(rt[Symbol.iterator]=function(){return this}),rt;function it(at){return function(ot){return st([at,ot])}}function st(at){if(et)throw new TypeError("Generator is already executing.");for(;rt&&(rt=0,at[0]&&(_e=0)),_e;)try{if(et=1,tt&&(nt=at[0]&2?tt.return:at[0]?tt.throw||((nt=tt.return)&&nt.call(tt),0):tt.next)&&!(nt=nt.call(tt,at[1])).done)return nt;switch(tt=0,nt&&(at=[at[0]&2,nt.value]),at[0]){case 0:case 1:nt=at;break;case 4:return _e.label++,{value:at[1],done:!1};case 5:_e.label++,tt=at[1],at=[0];continue;case 7:at=_e.ops.pop(),_e.trys.pop();continue;default:if(nt=_e.trys,!(nt=nt.length>0&&nt[nt.length-1])&&(at[0]===6||at[0]===2)){_e=0;continue}if(at[0]===3&&(!nt||at[1]>nt[0]&&at[1]<nt[3])){_e.label=at[1];break}if(at[0]===6&&_e.label<nt[1]){_e.label=nt[1],nt=at;break}if(nt&&_e.label<nt[2]){_e.label=nt[2],_e.ops.push(at);break}nt[2]&&_e.ops.pop(),_e.trys.pop();continue}at=$.call(j,_e)}catch(ot){at=[6,ot],tt=0}finally{et=nt=0}if(at[0]&5)throw at[1];return{value:at[0]?at[1]:void 0,done:!0}}}typeof SuppressedError=="function"&&SuppressedError;var options$1={syntax:"proto3"},nested={pipecat:{nested:{TextFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3}}},AudioRawFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},audio:{type:"bytes",id:3},sampleRate:{type:"uint32",id:4},numChannels:{type:"uint32",id:5}}},TranscriptionFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3},userId:{type:"string",id:4},timestamp:{type:"string",id:5}}},Frame:{oneofs:{frame:{oneof:["text","audio","transcription"]}},fields:{text:{type:"TextFrame",id:1},audio:{type:"AudioRawFrame",id:2},transcription:{type:"TranscriptionFrame",id:3}}}}}},jsonDescriptor={options:options$1,nested},ConnectionQuality;(function(j){j.UNKNOWN="UNKNOWN",j.GOOD="GOOD",j.BAD="BAD"})(ConnectionQuality||(ConnectionQuality={}));var AbstractConnectionQualityIndicator=function(){function j($){this._connectionQuality=ConnectionQuality.UNKNOWN,this.onConnectionQualityChanged=$}return Object.defineProperty(j.prototype,"connectionQuality",{get:function(){return this._connectionQuality},enumerable:!1,configurable:!0}),j.prototype.handleStatsChanged=function(){var $=this.calculateConnectionQuality();$!==this._connectionQuality&&(this._connectionQuality=$,this.onConnectionQualityChanged($))},j.prototype.start=function($){this.stop(!0),this._start($)},j.prototype.stop=function($){$===void 0&&($=!1),this._stop(),this._connectionQuality=ConnectionQuality.UNKNOWN,$||this.onConnectionQualityChanged(ConnectionQuality.UNKNOWN)},j}();function QualityIndicatorMixer(){for(var j=[],$=0;$<arguments.length;$++)j[$]=arguments[$];var _e=function(et){__extends(tt,et);function tt(nt){var rt=et.call(this,nt)||this;return rt.childTrackers=j.map(function(it){var st=it.getParams,at=it.TrackerClass;return{tracker:new at(function(){return rt.handleStatsChanged()}),getParams:st}}),rt}return tt.prototype.calculateConnectionQuality=function(){var nt=this.childTrackers.map(function(rt){var it=rt.tracker;return it.connectionQuality});return nt.some(function(rt){return rt===ConnectionQuality.BAD})?ConnectionQuality.BAD:nt.every(function(rt){return rt===ConnectionQuality.UNKNOWN})?ConnectionQuality.UNKNOWN:ConnectionQuality.GOOD},tt.prototype._start=function(nt){this.childTrackers.forEach(function(rt){var it=rt.tracker,st=rt.getParams;return it.start(st(nt))})},tt.prototype._stop=function(){this.childTrackers.forEach(function(nt){var rt=nt.tracker;return rt.stop(!0)})},tt}(AbstractConnectionQualityIndicator);return _e}var LiveKitConnectionQualityIndicator=function(j){__extends($,j);function $(){var _e=j!==null&&j.apply(this,arguments)||this;return _e.room=null,_e.liveKitConnectionQuality=ConnectionQuality$2.Unknown,_e.liveKitConnectionState=null,_e.handleConnectionQualityChanged=function(et){_e.liveKitConnectionQuality=et,_e.handleStatsChanged()},_e.handleConnectionStateChanged=function(et){_e.liveKitConnectionState=et,_e.handleStatsChanged()},_e}return $.prototype._start=function(_e){this.room=_e,this.room.localParticipant.on(ParticipantEvent.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.on(RoomEvent.ConnectionStateChanged,this.handleConnectionStateChanged)},$.prototype._stop=function(){this.room&&(this.room.localParticipant.off(RoomEvent.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.off(RoomEvent.ConnectionStateChanged,this.handleConnectionStateChanged))},$.prototype.calculateConnectionQuality=function(){return[ConnectionQuality$2.Lost,ConnectionQuality$2.Poor].includes(this.liveKitConnectionQuality)||this.liveKitConnectionState&&[ConnectionState.Disconnected,ConnectionState.Reconnecting,ConnectionState.SignalReconnecting].includes(this.liveKitConnectionState)?ConnectionQuality.BAD:ConnectionQuality.GOOD},$}(AbstractConnectionQualityIndicator),t,e,s$1,n;function r$2(){}function o(){o.init.call(this)}function i(j){return j._maxListeners===void 0?o.defaultMaxListeners:j._maxListeners}function a$1(j,$,_e){if($)j.call(_e);else for(var et=j.length,tt=m(j,et),nt=0;nt<et;++nt)tt[nt].call(_e)}function c$1(j,$,_e,et){if($)j.call(_e,et);else for(var tt=j.length,nt=m(j,tt),rt=0;rt<tt;++rt)nt[rt].call(_e,et)}function d(j,$,_e,et,tt){if($)j.call(_e,et,tt);else for(var nt=j.length,rt=m(j,nt),it=0;it<nt;++it)rt[it].call(_e,et,tt)}function u(j,$,_e,et,tt,nt){if($)j.call(_e,et,tt,nt);else for(var rt=j.length,it=m(j,rt),st=0;st<rt;++st)it[st].call(_e,et,tt,nt)}function h(j,$,_e,et){if($)j.apply(_e,et);else for(var tt=j.length,nt=m(j,tt),rt=0;rt<tt;++rt)nt[rt].apply(_e,et)}function l(j,$,_e,et){var tt,nt,rt,it;if(typeof _e!="function")throw new TypeError('"listener" argument must be a function');if((nt=j._events)?(nt.newListener&&(j.emit("newListener",$,_e.listener?_e.listener:_e),nt=j._events),rt=nt[$]):(nt=j._events=new r$2,j._eventsCount=0),rt){if(typeof rt=="function"?rt=nt[$]=et?[_e,rt]:[rt,_e]:et?rt.unshift(_e):rt.push(_e),!rt.warned&&(tt=i(j))&&tt>0&&rt.length>tt){rt.warned=!0;var st=new Error("Possible EventEmitter memory leak detected. "+rt.length+" "+$+" listeners added. Use emitter.setMaxListeners() to increase limit");st.name="MaxListenersExceededWarning",st.emitter=j,st.type=$,st.count=rt.length,it=st,typeof console.warn=="function"?console.warn(it):console.log(it)}}else rt=nt[$]=_e,++j._eventsCount;return j}function p(j,$,_e){var et=!1;function tt(){j.removeListener($,tt),et||(et=!0,_e.apply(j,arguments))}return tt.listener=_e,tt}function f(j){var $=this._events;if($){var _e=$[j];if(typeof _e=="function")return 1;if(_e)return _e.length}return 0}function m(j,$){for(var _e=new Array($);$--;)_e[$]=j[$];return _e}r$2.prototype=Object.create(null),o.EventEmitter=o,o.usingDomains=!1,o.prototype.domain=void 0,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.init=function(){this.domain=null,o.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new r$2,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||isNaN(j))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=j,this},o.prototype.getMaxListeners=function(){return i(this)},o.prototype.emit=function(j){var $,_e,et,tt,nt,rt,it,st=j==="error";if(rt=this._events)st=st&&rt.error==null;else if(!st)return!1;if(it=this.domain,st){if($=arguments[1],!it){if($ instanceof Error)throw $;var at=new Error('Uncaught, unspecified "error" event. ('+$+")");throw at.context=$,at}return $||($=new Error('Uncaught, unspecified "error" event')),$.domainEmitter=this,$.domain=it,$.domainThrown=!1,it.emit("error",$),!1}if(!(_e=rt[j]))return!1;var ot=typeof _e=="function";switch(et=arguments.length){case 1:a$1(_e,ot,this);break;case 2:c$1(_e,ot,this,arguments[1]);break;case 3:d(_e,ot,this,arguments[1],arguments[2]);break;case 4:u(_e,ot,this,arguments[1],arguments[2],arguments[3]);break;default:for(tt=new Array(et-1),nt=1;nt<et;nt++)tt[nt-1]=arguments[nt];h(_e,ot,this,tt)}return!0},o.prototype.addListener=function(j,$){return l(this,j,$,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(j,$){return l(this,j,$,!0)},o.prototype.once=function(j,$){if(typeof $!="function")throw new TypeError('"listener" argument must be a function');return this.on(j,p(this,j,$)),this},o.prototype.prependOnceListener=function(j,$){if(typeof $!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(j,p(this,j,$)),this},o.prototype.removeListener=function(j,$){var _e,et,tt,nt,rt;if(typeof $!="function")throw new TypeError('"listener" argument must be a function');if(!(et=this._events))return this;if(!(_e=et[j]))return this;if(_e===$||_e.listener&&_e.listener===$)--this._eventsCount==0?this._events=new r$2:(delete et[j],et.removeListener&&this.emit("removeListener",j,_e.listener||$));else if(typeof _e!="function"){for(tt=-1,nt=_e.length;nt-- >0;)if(_e[nt]===$||_e[nt].listener&&_e[nt].listener===$){rt=_e[nt].listener,tt=nt;break}if(tt<0)return this;if(_e.length===1){if(_e[0]=void 0,--this._eventsCount==0)return this._events=new r$2,this;delete et[j]}else(function(it,st){for(var at=st,ot=at+1,ct=it.length;ot<ct;at+=1,ot+=1)it[at]=it[ot];it.pop()})(_e,tt);et.removeListener&&this.emit("removeListener",j,rt||$)}return this},o.prototype.off=function(j,$){return this.removeListener(j,$)},o.prototype.removeAllListeners=function(j){var $,_e;if(!(_e=this._events))return this;if(!_e.removeListener)return arguments.length===0?(this._events=new r$2,this._eventsCount=0):_e[j]&&(--this._eventsCount==0?this._events=new r$2:delete _e[j]),this;if(arguments.length===0){for(var et,tt=Object.keys(_e),nt=0;nt<tt.length;++nt)(et=tt[nt])!=="removeListener"&&this.removeAllListeners(et);return this.removeAllListeners("removeListener"),this._events=new r$2,this._eventsCount=0,this}if(typeof($=_e[j])=="function")this.removeListener(j,$);else if($)do this.removeListener(j,$[$.length-1]);while($[0]);return this},o.prototype.listeners=function(j){var $,_e=this._events;return _e&&($=_e[j])?typeof $=="function"?[$.listener||$]:function(et){for(var tt=new Array(et.length),nt=0;nt<tt.length;++nt)tt[nt]=et[nt].listener||et[nt];return tt}($):[]},o.listenerCount=function(j,$){return typeof j.listenerCount=="function"?j.listenerCount($):f.call(j,$)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class g extends o{}(function(j){j.Issue="issue",j.NetworkScoresUpdated="network-scores-updated",j.StatsParsingFinished="stats-parsing-finished"})(t||(t={})),function(j){j.Network="network",j.CPU="cpu",j.Server="server",j.Stream="stream"}(e||(e={})),function(j){j.OutboundNetworkQuality="outbound-network-quality",j.InboundNetworkQuality="inbound-network-quality",j.OutboundNetworkMediaLatency="outbound-network-media-latency",j.InboundNetworkMediaLatency="inbound-network-media-latency",j.NetworkMediaSyncFailure="network-media-sync-failure",j.OutboundNetworkThroughput="outbound-network-throughput",j.InboundNetworkThroughput="inbound-network-throughput",j.EncoderCPUThrottling="encoder-cpu-throttling",j.DecoderCPUThrottling="decoder-cpu-throttling",j.ServerIssue="server-issue",j.UnknownVideoDecoderIssue="unknown-video-decoder",j.LowInboundMOS="low-inbound-mean-opinion-score",j.LowOutboundMOS="low-outbound-mean-opinion-score",j.FrozenVideoTrack="frozen-video-track",j.MissingVideoStreamData="missing-video-stream-data",j.MissingAudioStreamData="missing-audio-stream-data"}(s$1||(s$1={})),function(j){j[j.BAD=2.1]="BAD",j[j.POOR=2.6]="POOR",j[j.FAIR=3.1]="FAIR",j[j.GOOD=3.8]="GOOD",j[j.EXCELLENT=4.3]="EXCELLENT"}(n||(n={}));const Ss=class Ss extends o{constructor(_e){super();Wt(this,"isStopped",!1);Wt(this,"reportTimer");Wt(this,"getStatsInterval");Wt(this,"compositeStatsParser");this.compositeStatsParser=_e.compositeStatsParser,this.getStatsInterval=_e.getStatsInterval??1e4}get isRunning(){return!!this.reportTimer&&!this.isStopped}startReporting(){if(this.reportTimer)return;const _e=()=>setTimeout(()=>{this.isStopped?this.reportTimer=void 0:this.parseReports().finally(()=>{this.reportTimer=_e()})},this.getStatsInterval);this.isStopped=!1,this.reportTimer=_e()}stopReporting(){this.isStopped=!0,this.reportTimer&&(clearTimeout(this.reportTimer),this.reportTimer=void 0)}async parseReports(){const _e=Date.now(),et=await this.compositeStatsParser.parse(),tt=Date.now()-_e;this.emit(Ss.STATS_REPORTS_PARSED,{timeTaken:tt,reportItems:et}),et.forEach(nt=>{this.emit(Ss.STATS_REPORT_READY_EVENT,nt)})}};Wt(Ss,"STATS_REPORT_READY_EVENT","stats-report-ready"),Wt(Ss,"STATS_REPORTS_PARSED","stats-reports-parsed");let S=Ss;const v=(()=>{const j=new Map;return $=>{const{taskId:_e,delayMs:et,maxJitterMs:tt,callback:nt}=$,rt=Math.ceil(Math.random()*(tt||0)),it=j.get(_e);it&&clearTimeout(it);const st=setTimeout(()=>{nt(),j.delete(_e)},et+rt);j.set(_e,st)}})();var os,Zl;let k$1=(Zl=class{constructor(){zt(this,os,{})}calculate($){const{connection:{id:_e}}=$,{mos:et,stats:tt}=this.calculateOutboundScore($)||{},{mos:nt,stats:rt}=this.calculateInboundScore($)||{};return bt(this,os)[_e]=$,v({taskId:_e,delayMs:35e3,callback:()=>delete bt(this,os)[_e]}),{outbound:et,inbound:nt,connectionId:_e,statsSamples:{inboundStatsSample:rt,outboundStatsSample:tt}}}calculateOutboundScore($){var pt,dt,ht,ft;const _e=[...((pt=$.remote)==null?void 0:pt.audio.inbound)||[],...((dt=$.remote)==null?void 0:dt.video.inbound)||[]];if(!_e.length)return;const et=bt(this,os)[$.connection.id];if(!et)return;const tt=[...((ht=et.remote)==null?void 0:ht.audio.inbound)||[],...((ft=et.remote)==null?void 0:ft.video.inbound)||[]],{packetsSent:nt}=$.connection,rt=et.connection.packetsSent,it=_e.reduce((mt,gt)=>{const yt=tt.find(vt=>vt.ssrc===gt.ssrc);return{sumJitter:mt.sumJitter+gt.jitter,packetsLost:mt.packetsLost+gt.packetsLost,lastPacketsLost:mt.lastPacketsLost+((yt==null?void 0:yt.packetsLost)||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),st=1e3*$.connection.currentRoundTripTime||0,{sumJitter:at}=it,ot=at/_e.length,ct=nt-rt,lt=it.packetsLost-it.lastPacketsLost,ut=ct&&lt?Math.round(100*lt/(ct+lt)):0;return{mos:this.calculateMOS({avgJitter:ot,rtt:st,packetsLoss:ut}),stats:{avgJitter:ot,rtt:st,packetsLoss:ut}}}calculateInboundScore($){var pt,dt,ht,ft;const _e=[...(pt=$.audio)==null?void 0:pt.inbound,...(dt=$.video)==null?void 0:dt.inbound];if(!_e.length)return;const et=bt(this,os)[$.connection.id];if(!et)return;const tt=[...(ht=et.video)==null?void 0:ht.inbound,...(ft=et.audio)==null?void 0:ft.inbound],{packetsReceived:nt}=$.connection,rt=et.connection.packetsReceived,it=_e.reduce((mt,gt)=>{const yt=tt.find(vt=>vt.ssrc===gt.ssrc);return{sumJitter:mt.sumJitter+gt.jitter,packetsLost:mt.packetsLost+gt.packetsLost,lastPacketsLost:mt.lastPacketsLost+((yt==null?void 0:yt.packetsLost)||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),st=1e3*$.connection.currentRoundTripTime||0,{sumJitter:at}=it,ot=at/_e.length,ct=nt-rt,lt=it.packetsLost-it.lastPacketsLost,ut=ct&&lt?Math.round(100*lt/(ct+lt)):0;return{mos:this.calculateMOS({avgJitter:ot,rtt:st,packetsLoss:ut}),stats:{avgJitter:ot,rtt:st,packetsLoss:ut}}}calculateMOS({avgJitter:$,rtt:_e,packetsLoss:et}){const tt=_e+2*$+10;let nt=tt<160?93.2-tt/40:93.2-tt/120-10;return nt-=2.5*et,1+.035*nt+7e-6*nt*(nt-60)*(100-nt)}},os=new WeakMap,Zl);var jr,_a,$a,Yl;let y$1=(Yl=class{constructor($={}){zt(this,jr,new Map);zt(this,_a);zt(this,$a);Dt(this,_a,$.statsCleanupTtlMs??35e3),Dt(this,$a,$.maxParsedStatsStorageSize??5)}detect($,_e){const et={...$,networkScores:{..._e,statsSamples:(_e==null?void 0:_e.statsSamples)||{}}},tt=this.performDetection(et);return this.setLastProcessedStats($.connection.id,et),this.performPrevStatsCleanup({connectionId:$.connection.id}),tt}performPrevStatsCleanup($){const{connectionId:_e,cleanupCallback:et}=$;bt(this,jr).has(_e)&&v({taskId:_e,delayMs:bt(this,_a),callback:()=>{this.deleteLastProcessedStats(_e),typeof et=="function"&&et()}})}setLastProcessedStats($,_e){if(!$||_e.connection.id!==$)return;const et=bt(this,jr).get($)??[];et.push(_e),et.length>bt(this,$a)&&et.shift(),bt(this,jr).set($,et)}getLastProcessedStats($){const _e=bt(this,jr).get($);return _e==null?void 0:_e[_e.length-1]}getAllLastProcessedStats($){return bt(this,jr).get($)??[]}deleteLastProcessedStats($){bt(this,jr).delete($)}},jr=new WeakMap,_a=new WeakMap,$a=new WeakMap,Yl);var eo;class w extends y$1{constructor(_e={}){super(_e);zt(this,eo);Dt(this,eo,_e.availableOutgoingBitrateThreshold??1e5)}performDetection(_e){const et=[],{availableOutgoingBitrate:tt}=_e.connection;if(tt===void 0)return et;const nt=_e.audio.outbound.reduce((st,at)=>st+at.targetBitrate,0),rt=_e.video.outbound.reduce((st,at)=>st+at.bitrate,0);if(!nt&&!rt)return et;const it={availableOutgoingBitrate:tt,videoStreamsTotalBitrate:rt,audioStreamsTotalTargetBitrate:nt};return(nt>tt||rt>0&&tt<bt(this,eo))&&et.push({statsSample:it,type:e.Network,reason:s$1.OutboundNetworkThroughput}),et}}eo=new WeakMap;var no,ro,io,so;class b extends y$1{constructor(_e={}){super();zt(this,no);zt(this,ro);zt(this,io);zt(this,so);Dt(this,no,_e.highPacketLossThresholdPct??5),Dt(this,ro,_e.highJitterThreshold??200),Dt(this,io,_e.highJitterBufferDelayThresholdMs??500),Dt(this,so,_e.highRttThresholdMs??250)}performDetection(_e){return this.processData(_e)}processData(_e){var Tt,Ct,Rt,jt;const et=[],tt=[...(Tt=_e.audio)==null?void 0:Tt.inbound,...(Ct=_e.video)==null?void 0:Ct.inbound];if(!tt.length)return et;const nt=this.getLastProcessedStats(_e.connection.id);if(!nt)return et;const rt=[...(Rt=nt.video)==null?void 0:Rt.inbound,...(jt=nt.audio)==null?void 0:jt.inbound],{packetsReceived:it}=_e.connection,st=nt.connection.packetsReceived,at=tt.reduce((Ot,$t)=>{const Kt=rt.find(Gt=>Gt.ssrc===$t.ssrc),Lt=(Kt==null?void 0:Kt.jitterBufferDelay)||0,Nt=(Kt==null?void 0:Kt.jitterBufferEmittedCount)||0,Bt=$t.jitterBufferDelay-Lt,kt=$t.jitterBufferEmittedCount-Nt,rn=Bt&&kt?1e3*Bt/kt:0;return{sumJitter:Ot.sumJitter+$t.jitter,sumJitterBufferDelayMs:Ot.sumJitterBufferDelayMs+rn,packetsLost:Ot.packetsLost+$t.packetsLost,lastPacketsLost:Ot.lastPacketsLost+((Kt==null?void 0:Kt.packetsLost)||0)}},{sumJitter:0,sumJitterBufferDelayMs:0,packetsLost:0,lastPacketsLost:0}),ot=1e3*_e.connection.currentRoundTripTime||0,{sumJitter:ct,sumJitterBufferDelayMs:lt}=at,ut=ct/tt.length,pt=lt/tt.length,dt=it-st,ht=at.packetsLost-at.lastPacketsLost,ft=dt&&ht?Math.round(100*ht/(dt+ht)):0,mt=ft>bt(this,no),gt=ut>=bt(this,ro),yt=ot>=bt(this,so),vt=pt>bt(this,io),xt=yt&&!gt&&!mt,St=mt&&gt,Et=gt&&vt,wt={rtt:ot,packetLossPct:ft,avgJitter:ut,avgJitterBufferDelay:pt};return(gt||mt)&&et.push({statsSample:wt,type:e.Network,reason:s$1.InboundNetworkQuality,iceCandidate:_e.connection.local.id}),xt&&et.push({statsSample:wt,type:e.Server,reason:s$1.ServerIssue,iceCandidate:_e.connection.remote.id}),St&&et.push({statsSample:wt,type:e.Network,reason:s$1.InboundNetworkMediaLatency,iceCandidate:_e.connection.local.id}),Et&&et.push({statsSample:wt,type:e.Network,reason:s$1.NetworkMediaSyncFailure,iceCandidate:_e.connection.local.id}),et}}no=new WeakMap,ro=new WeakMap,io=new WeakMap,so=new WeakMap;var ao,Xl;let P$1=(Xl=class extends y$1{constructor(_e={}){super();zt(this,ao);Dt(this,ao,_e.correctedSamplesThresholdPct??5)}performDetection(_e){return this.processData(_e)}processData(_e){var rt;const et=_e.audio.inbound,tt=[],nt=(rt=this.getLastProcessedStats(_e.connection.id))==null?void 0:rt.audio.inbound;return nt&&et.forEach(it=>{const st=nt.find(dt=>dt.ssrc===it.ssrc);if(!st)return;const at=it.track.insertedSamplesForDeceleration+it.track.removedSamplesForAcceleration,ot=st.track.insertedSamplesForDeceleration+st.track.removedSamplesForAcceleration;if(at===ot)return;const ct=it.track.totalSamplesReceived-st.track.totalSamplesReceived,lt=at-ot,ut=Math.round(100*lt/ct),pt={correctedSamplesPct:ut};ut>bt(this,ao)&&tt.push({statsSample:pt,type:e.Network,reason:s$1.NetworkMediaSyncFailure,ssrc:it.ssrc})}),tt}},ao=new WeakMap,Xl);var oo,co;class T extends y$1{constructor(_e={}){super();zt(this,oo);zt(this,co);Dt(this,oo,_e.highPacketLossThresholdPct??5),Dt(this,co,_e.highJitterThreshold??200)}performDetection(_e){return this.processData(_e)}processData(_e){var yt,vt,xt,St;const et=[],tt=[...((yt=_e.remote)==null?void 0:yt.audio.inbound)||[],...((vt=_e.remote)==null?void 0:vt.video.inbound)||[]];if(!tt.length)return et;const nt=this.getLastProcessedStats(_e.connection.id);if(!nt)return et;const rt=[...((xt=nt.remote)==null?void 0:xt.audio.inbound)||[],...((St=nt.remote)==null?void 0:St.video.inbound)||[]],{packetsSent:it}=_e.connection,st=nt.connection.packetsSent,at=tt.reduce((Et,wt)=>{const Tt=rt.find(Ct=>Ct.ssrc===wt.ssrc);return{sumJitter:Et.sumJitter+wt.jitter,packetsLost:Et.packetsLost+wt.packetsLost,lastPacketsLost:Et.lastPacketsLost+((Tt==null?void 0:Tt.packetsLost)||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),ot=1e3*_e.connection.currentRoundTripTime||0,{sumJitter:ct}=at,lt=ct/tt.length,ut=it-st,pt=at.packetsLost-at.lastPacketsLost,dt=ut&&pt?Math.round(100*pt/(ut+pt)):0,ht=dt>bt(this,oo),ft=lt>=bt(this,co),mt=!ht&&ft||ft||ht,gt={rtt:ot,avgJitter:lt,packetLossPct:dt};return ht&&ft&&et.push({statsSample:gt,type:e.Network,reason:s$1.OutboundNetworkMediaLatency,iceCandidate:_e.connection.local.id}),mt&&et.push({statsSample:gt,type:e.Network,reason:s$1.OutboundNetworkQuality,iceCandidate:_e.connection.local.id}),et}}oo=new WeakMap,co=new WeakMap;class L extends y$1{performDetection($){return this.processData($)}processData($){var nt;const _e=$.video.outbound.filter(rt=>rt.qualityLimitationReason!=="none"),et=[],tt=(nt=this.getLastProcessedStats($.connection.id))==null?void 0:nt.video.outbound;return tt&&_e.forEach(rt=>{const it=tt.find(at=>at.ssrc===rt.ssrc);if(!it)return;const st={qualityLimitationReason:rt.qualityLimitationReason};rt.framesSent>it.framesSent||(rt.qualityLimitationReason==="cpu"&&et.push({statsSample:st,type:e.CPU,reason:s$1.EncoderCPUThrottling,ssrc:rt.ssrc}),rt.qualityLimitationReason==="bandwidth"&&et.push({statsSample:st,type:e.Network,reason:s$1.OutboundNetworkThroughput,ssrc:rt.ssrc}))}),et}}var cs;class D extends y$1{constructor(){super(...arguments);Wt(this,"UNKNOWN_DECODER","unknown");zt(this,cs,{})}performDetection(_e){return this.processData(_e)}performPrevStatsCleanup(_e){const{connectionId:et,cleanupCallback:tt}=_e;super.performPrevStatsCleanup({..._e,cleanupCallback:()=>{delete bt(this,cs)[et],typeof tt=="function"&&tt()}})}processData(_e){var rt;const et=[],{id:tt}=_e.connection,nt=(rt=this.getLastProcessedStats(tt))==null?void 0:rt.video.inbound;return _e.video.inbound.forEach(it=>{const{decoderImplementation:st,ssrc:at}=it;if(nt==null?void 0:nt.find(ct=>ct.ssrc===at))if(st===this.UNKNOWN_DECODER){if(!this.hadLastDecoderWithIssue(tt,at)){this.setLastDecoderWithIssue(tt,at,this.UNKNOWN_DECODER);const ct={mimeType:it.mimeType,decoderImplementation:st};et.push({ssrc:at,statsSample:ct,type:e.Stream,reason:s$1.UnknownVideoDecoderIssue,trackIdentifier:it.track.trackIdentifier})}}else this.setLastDecoderWithIssue(tt,at,void 0)}),et}setLastDecoderWithIssue(_e,et,tt){const nt=bt(this,cs)[_e]??{};tt===void 0?delete nt[et]:nt[et]=tt,bt(this,cs)[_e]=nt}hadLastDecoderWithIssue(_e,et){const tt=bt(this,cs)[_e];return(tt&&tt[et])===this.UNKNOWN_DECODER}}cs=new WeakMap;const C=j=>j.reduce(($,_e)=>$+_e,0)/j.length,R=(j,$,_e=30)=>{var tt,nt,rt,it,st;const et=[];for(let at=1;at<$.length-1;at+=1){const ot=(nt=(tt=$[at])==null?void 0:tt.video)==null?void 0:nt.inbound.find(pt=>pt.ssrc===j);if(!ot)continue;const ct=(st=(it=(rt=$[at-1])==null?void 0:rt.video)==null?void 0:it.inbound)==null?void 0:st.find(pt=>pt.ssrc===j);if(!ot||!ct)continue;const lt=ot.timestamp-ct.timestamp,ut=ot.framesDecoded-ct.framesDecoded;if(ut>0){const pt=lt/ut;et.push(pt)}}return et.length<=1?!1:(at=>{const ot=((ct,lt)=>lt.reduce((ut,pt)=>ut+(pt-ct)**2,0)/lt.length)(C(at),at);return Math.sqrt(ot)})(et)>_e},M=(j,$)=>{for(let _e=1;_e<$.length;_e+=1){const et=$[_e].video.inbound.find(it=>it.ssrc===j);if(!et)continue;const tt=$[_e-1].video.inbound.find(it=>it.ssrc===j),nt=et.frameWidth!==(tt==null?void 0:tt.frameWidth),rt=et.frameHeight!==(tt==null?void 0:tt.frameHeight);if(nt||rt)return!0}return!1};var lo,uo,po;class I extends y$1{constructor(_e={}){super();zt(this,lo);zt(this,uo);zt(this,po);Dt(this,lo,_e.avgFreezeDurationThresholdMs??1e3),Dt(this,uo,_e.frozenDurationThresholdPct??30),Dt(this,po,_e.minMosQuality??n.BAD)}performDetection(_e){const et=_e.networkScores.inbound;return et!==void 0&&et<=bt(this,po)?[]:this.processData(_e)}processData(_e){const et=[],tt=this.getAllLastProcessedStats(_e.connection.id);if(tt.length===0)return[];const nt=_e.video.inbound.map(rt=>{const it=tt[tt.length-1].video.inbound.find(lt=>lt.ssrc===rt.ssrc);if(!it||M(rt.ssrc,[tt[tt.length-1],_e])||R(rt.ssrc,tt))return;const st=rt.freezeCount-(it.freezeCount??0),at=1e3*(rt.totalFreezesDuration-(it.totalFreezesDuration??0)),ot=st>0?at/st:0,ct=at/(rt.timestamp-it.timestamp)*100;return ct>bt(this,uo)||ot>bt(this,lo)?{ssrc:rt.ssrc,avgFreezeDurationMs:ot,frozenDurationPct:ct}:void 0}).filter(rt=>rt!==void 0);return nt.length>0&&(et.push({type:e.Stream,reason:s$1.FrozenVideoTrack,statsSample:{ssrcs:nt.map(rt=>rt.ssrc)}}),this.deleteLastProcessedStats(_e.connection.id)),et}}lo=new WeakMap,uo=new WeakMap,po=new WeakMap;var fo,ho,mo;class E extends y$1{constructor(_e={}){super(_e);zt(this,fo);zt(this,ho);zt(this,mo);Dt(this,fo,_e.volatilityThreshold??8),Dt(this,ho,_e.affectedStreamsPercentThreshold??30),Dt(this,mo,_e.minMosQuality??n.BAD)}performDetection(_e){return[...this.getAllLastProcessedStats(_e.connection.id),_e].find(et=>et.networkScores.inbound!==void 0&&et.networkScores.inbound<=bt(this,mo))?[]:this.processData(_e)}processData(_e){const et=[],tt=[...this.getAllLastProcessedStats(_e.connection.id),_e],nt=_e.video.inbound.map(it=>{if(tt.length<5||M(it.ssrc,tt))return;const st=[];for(let ot=0;ot<tt.length-1;ot+=1){const ct=tt[ot].video.inbound.find(lt=>lt.ssrc===it.ssrc);(ct==null?void 0:ct.framesPerSecond)!==void 0&&st.push(ct.framesPerSecond)}if(st.length<5||R(it.ssrc,tt))return;const at=(ot=>{if(ot.length===0)throw new Error("Cannot calculate volatility for empty array");const ct=C(ot);return ot.reduce((lt,ut)=>lt+Math.abs(ut-ct),0)/ot.length*100/ct})(st);return at>bt(this,fo)?{ssrc:it.ssrc,allFps:st,volatility:at}:void 0}).filter(it=>!!it);if(nt.length===0)return et;const rt=nt.length/(_e.video.inbound.length/100);return rt>bt(this,ho)&&(et.push({type:e.CPU,reason:s$1.DecoderCPUThrottling,statsSample:{affectedStreamsPercent:rt,throtthedStreams:nt}}),this.deleteLastProcessedStats(_e.connection.id)),et}}fo=new WeakMap,ho=new WeakMap,mo=new WeakMap;const N=j=>j.iceConnectionState==="closed"||j.connectionState==="closed",_=(j,$,_e)=>8*((et,tt,nt)=>{if(!tt)return 0;const rt=et[nt],it=tt[nt];if(rt==null||it==null)return 0;const st=Math.floor(et.timestamp)-Math.floor(tt.timestamp);return st===0?0:(Number(rt)-Number(it))/st*1e3})(j,$,_e);class A{constructor($){Wt(this,"connections",[]);Wt(this,"statsParser");this.statsParser=$.statsParser}listConnections(){return[...this.connections]}addPeerConnection($){this.connections.push({id:$.id??String(Date.now()+Math.random().toString(32)),pc:$.pc})}removePeerConnection($){const _e=this.connections.findIndex(({pc:et})=>et===$.pc);_e>=0&&this.removeConnectionsByIndexes([_e])}async parse(){const $=[],_e=this.connections.map(async(et,tt)=>{if(!N(et.pc))return this.statsParser.parse(et);$.unshift(tt)});return $.length&&this.removeConnectionsByIndexes($),(await Promise.all(_e)).filter(et=>et!==void 0)}removeConnectionsByIndexes($){$.forEach(_e=>{this.connections.splice(_e,1)})}}let O$1=class{constructor($){Wt(this,"prevStats",new Map);Wt(this,"allowedReportTypes",new Set(["candidate-pair","inbound-rtp","outbound-rtp","remote-outbound-rtp","remote-inbound-rtp","track","transport"]));Wt(this,"ignoreSSRCList");Wt(this,"logger");this.ignoreSSRCList=$.ignoreSSRCList??[],this.logger=$.logger}get previouslyParsedStatsConnectionsIds(){return[...this.prevStats.keys()]}async parse($){if(!N($.pc))return this.getConnectionStats($);this.logger.debug("Skip stats parsing. Connection is closed.",{connection:$})}async getConnectionStats($){const{pc:_e,id:et}=$;try{const tt=Date.now(),nt=_e.getReceivers().filter(at=>{var ot;return(ot=at.track)==null?void 0:ot.enabled}),rt=_e.getSenders().filter(at=>{var ot;return(ot=at.track)==null?void 0:ot.enabled}),it=await Promise.all(nt.map(at=>at.getStats())),st=await Promise.all(rt.map(at=>at.getStats()));return{id:et,stats:this.mapReportsStats([...it,...st],$),timeTaken:Date.now()-tt}}catch(tt){return void this.logger.error("Failed to get stats for PC",{id:et,pc:_e,error:tt})}}mapReportsStats($,_e){const et={audio:{inbound:[],outbound:[]},video:{inbound:[],outbound:[]},connection:{},remote:{video:{inbound:[],outbound:[]},audio:{inbound:[],outbound:[]}}};$.forEach(rt=>{rt.forEach(it=>{this.allowedReportTypes.has(it.type)&&this.updateMappedStatsWithReportItemData(it,et,rt)})});const{id:tt}=_e,nt=this.prevStats.get(tt);return nt&&this.propagateStatsWithRateValues(et,nt.stats),this.prevStats.set(tt,{stats:et,ts:Date.now()}),v({taskId:tt,delayMs:35e3,callback:()=>this.prevStats.delete(tt)}),et}updateMappedStatsWithReportItemData($,_e,et){const tt=$.type;if(tt==="candidate-pair"&&$.state==="succeeded"&&$.nominated)return void(_e.connection=this.prepareConnectionStats($,et));const nt=this.getMediaType($);if(!nt)return;const rt=$.ssrc;if(!rt||!this.ignoreSSRCList.includes(rt))if(tt!=="outbound-rtp")if(tt!=="inbound-rtp")tt!=="remote-outbound-rtp"?tt==="remote-inbound-rtp"&&(this.mapConnectionStatsIfNecessary(_e,$,et),_e.remote[nt].inbound.push({...$})):_e.remote[nt].outbound.push({...$});else{const it=et.get($.trackId)||et.get($.mediaSourceId)||{};this.mapConnectionStatsIfNecessary(_e,$,et);const st={...$,track:{...it}};_e[nt].inbound.push(st)}else{const it=et.get($.trackId)||et.get($.mediaSourceId)||{},st={...$,track:{...it}};_e[nt].outbound.push(st)}}getMediaType($){const _e=$.mediaType||$.kind;if(!["audio","video"].includes(_e)){const{id:et}=$;return et?String(et).includes("Video")?"video":String(et).includes("Audio")?"audio":void 0:void 0}return _e}propagateStatsWithRateValues($,_e){$.audio.inbound.forEach(et=>{const tt=_e.audio.inbound.find(({id:nt})=>nt===et.id);et.bitrate=_(et,tt,"bytesReceived"),et.packetRate=_(et,tt,"packetsReceived")}),$.audio.outbound.forEach(et=>{const tt=_e.audio.outbound.find(({id:nt})=>nt===et.id);et.bitrate=_(et,tt,"bytesSent"),et.packetRate=_(et,tt,"packetsSent")}),$.video.inbound.forEach(et=>{const tt=_e.video.inbound.find(({id:nt})=>nt===et.id);et.bitrate=_(et,tt,"bytesReceived"),et.packetRate=_(et,tt,"packetsReceived")}),$.video.outbound.forEach(et=>{const tt=_e.video.outbound.find(({id:nt})=>nt===et.id);et.bitrate=_(et,tt,"bytesSent"),et.packetRate=_(et,tt,"packetsSent")})}mapConnectionStatsIfNecessary($,_e,et){if($.connection.id||!_e.transportId)return;const tt=et.get(_e.transportId);if(tt&&tt.selectedCandidatePairId){const nt=et.get(tt.selectedCandidatePairId);$.connection=this.prepareConnectionStats(nt,et)}}prepareConnectionStats($,_e){if(!$||!_e)return{};const et={...$};if(et.remoteCandidateId){const tt=_e.get(et.remoteCandidateId);et.remote={...tt}}if(et.localCandidateId){const tt=_e.get(et.localCandidateId);et.local={...tt}}return et}};var qr,Ds,$s;const Uo=class Uo extends y$1{constructor(_e={}){super();zt(this,qr,new Map);zt(this,Ds);zt(this,$s);Dt(this,Ds,_e.timeoutMs??15e3),Dt(this,$s,_e.steps??3)}performDetection(_e){return this.processData(_e)}processData(_e){const et=[],tt=[...this.getAllLastProcessedStats(_e.connection.id),_e];if(tt.length<bt(this,$s))return et;const nt=tt.slice(-bt(this,$s)),rt=nt.map(st=>st.video.inbound),it=nt.map(st=>st.audio.inbound);return et.push(...this.detectMissingData(it,e.Stream,s$1.MissingAudioStreamData)),et.push(...this.detectMissingData(rt,e.Stream,s$1.MissingVideoStreamData)),new Set(bt(this,qr).keys()).forEach(st=>{const at=bt(this,qr).get(st);at&&Date.now()-at>bt(this,Ds)&&this.removeMarkedIssue(st)}),et}detectMissingData(_e,et,tt){const nt=[],rt=_e.pop(),it=Uo.mapStatsByTrackId(_e);return rt.forEach(st=>{const at=st.track.trackIdentifier,ot=it.get(at);if(!Array.isArray(ot)||ot.length===0||st.track.detached||st.track.ended)return;if(!Uo.isAllBytesReceivedDidntChange(st.bytesReceived,ot))return void this.removeMarkedIssue(at);if(!this.markIssue(at))return;const ct={bytesReceived:st.bytesReceived};nt.push({type:et,reason:tt,statsSample:ct,trackIdentifier:at})}),nt}static mapStatsByTrackId(_e){const et=new Map;return _e.forEach(tt=>{tt.forEach(nt=>{const rt=et.get(nt.track.trackIdentifier)||[];rt.push(nt),et.set(nt.track.trackIdentifier,rt)})}),et}static isAllBytesReceivedDidntChange(_e,et){for(let tt=0;tt<et.length;tt+=1)if(et[tt].bytesReceived!==_e)return!1;return!0}markIssue(_e){const et=Date.now(),tt=bt(this,qr).get(_e);return(!tt||et-tt>bt(this,Ds))&&(bt(this,qr).set(_e,et),!0)}removeMarkedIssue(_e){bt(this,qr).delete(_e)}};qr=new WeakMap,Ds=new WeakMap,$s=new WeakMap;let J=Uo;var Rr,Ql;let x$1=(Ql=class{constructor($){Wt(this,"eventEmitter");zt(this,Rr,!1);Wt(this,"detectors",[]);Wt(this,"networkScoresCalculator");Wt(this,"statsReporter");Wt(this,"compositeStatsParser");Wt(this,"logger");Wt(this,"autoAddPeerConnections");this.logger=$.logger??{debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},this.eventEmitter=$.issueEmitter??new g,$.onIssues&&this.eventEmitter.on(t.Issue,$.onIssues),$.onNetworkScoresUpdated&&this.eventEmitter.on(t.NetworkScoresUpdated,$.onNetworkScoresUpdated),this.detectors=$.detectors??[new L,new b,new T,new P$1,new w,new D,new I,new E,new J],this.networkScoresCalculator=$.networkScoresCalculator??new k$1,this.compositeStatsParser=$.compositeStatsParser??new A({statsParser:new O$1({ignoreSSRCList:$.ignoreSSRCList,logger:this.logger})}),this.statsReporter=$.statsReporter??new S({compositeStatsParser:this.compositeStatsParser,getStatsInterval:$.getStatsInterval??5e3}),window.wid=this,this.autoAddPeerConnections=$.autoAddPeerConnections??!0,this.autoAddPeerConnections&&this.wrapRTCPeerConnection(),this.statsReporter.on(S.STATS_REPORT_READY_EVENT,_e=>{const et=this.calculateNetworkScores(_e.stats);this.detectIssues({data:_e.stats},et)}),this.statsReporter.on(S.STATS_REPORTS_PARSED,_e=>{const et={timeTaken:_e.timeTaken,ts:Date.now()};$.onStats&&$.onStats(_e.reportItems),this.eventEmitter.emit(t.StatsParsingFinished,et)})}watchNewPeerConnections(){if(!this.autoAddPeerConnections)throw new Error("Auto add peer connections was disabled in the constructor.");bt(this,Rr)?this.logger.warn("WebRTCIssueDetector is already started. Skip processing"):(this.logger.info("Start watching peer connections"),Dt(this,Rr,!0),this.statsReporter.startReporting())}stopWatchingNewPeerConnections(){bt(this,Rr)?(this.logger.info("Stop watching peer connections"),Dt(this,Rr,!1),this.statsReporter.stopReporting()):this.logger.warn("WebRTCIssueDetector is already stopped. Skip processing")}handleNewPeerConnection($,_e){bt(this,Rr)||!this.autoAddPeerConnections?(bt(this,Rr)||this.autoAddPeerConnections!==!1||(this.logger.info("Starting stats reporting for new peer connection"),Dt(this,Rr,!0),this.statsReporter.startReporting()),this.logger.debug("Handling new peer connection",$),this.compositeStatsParser.addPeerConnection({pc:$,id:_e})):this.logger.debug("Skip handling new peer connection. Detector is not running",$)}emitIssues($){this.eventEmitter.emit(t.Issue,$)}detectIssues({data:$},_e){const et=this.detectors.reduce((tt,nt)=>[...tt,...nt.detect($,_e)],[]);et.length>0&&this.emitIssues(et)}calculateNetworkScores($){const _e=this.networkScoresCalculator.calculate($);return this.eventEmitter.emit(t.NetworkScoresUpdated,_e),_e}wrapRTCPeerConnection(){if(!window.RTCPeerConnection)return void this.logger.warn("No RTCPeerConnection found in browser window. Skipping");const $=window.RTCPeerConnection,_e=tt=>this.handleNewPeerConnection(tt);function et(tt){const nt=new $(tt);return _e(nt),nt}et.prototype=$.prototype,window.RTCPeerConnection=et}},Rr=new WeakMap,Ql);var WebRTCConnectionQualityIndicator=function(j){__extends($,j);function $(){var _e=j!==null&&j.apply(this,arguments)||this;return _e.issueDetector=null,_e.mosScores=null,_e}return $.prototype._start=function(_e){var et=this;this.issueDetector=new x$1({autoAddPeerConnections:!1,getStatsInterval:3e3,onNetworkScoresUpdated:function(tt){et.mosScores=tt,et.handleStatsChanged()}}),this.issueDetector.handleNewPeerConnection(_e)},$.prototype._stop=function(){this.issueDetector&&(this.issueDetector.stopWatchingNewPeerConnections(),this.issueDetector=null),this.mosScores=null},$.prototype.calculateConnectionQuality=function(){return!this.mosScores||this.mosScores.inbound&&this.mosScores.outbound?ConnectionQuality.UNKNOWN:this.mosScores.inbound&&this.mosScores.inbound<3||this.mosScores.outbound&&this.mosScores.outbound<3?ConnectionQuality.BAD:ConnectionQuality.GOOD},$}(AbstractConnectionQualityIndicator),VoiceChatState;(function(j){j.INACTIVE="inactive",j.STARTING="starting",j.ACTIVE="started",j.STOPPING="stopping"})(VoiceChatState||(VoiceChatState={}));var AbstractVoiceChat=function(){function j(){}return j}(),AbstractVoiceChatImplementation=function(j){__extends($,j);function $(){var _e=j!==null&&j.apply(this,arguments)||this;return _e._isMuted=!0,_e.state=VoiceChatState.INACTIVE,_e}return Object.defineProperty($.prototype,"isMuted",{get:function(){return this._isMuted},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"isVoiceChatting",{get:function(){return this.state!==VoiceChatState.INACTIVE},enumerable:!1,configurable:!0}),$.prototype.startVoiceChat=function(_e){return __awaiter(this,void 0,void 0,function(){var et;return __generator(this,function(tt){switch(tt.label){case 0:return this.state===VoiceChatState.INACTIVE?[3,2]:[4,this.stopVoiceChat()];case 1:tt.sent(),tt.label=2;case 2:return tt.trys.push([2,4,,6]),this.state=VoiceChatState.STARTING,[4,this._startVoiceChat(_e)];case 3:return tt.sent(),this.state=VoiceChatState.ACTIVE,[3,6];case 4:return et=tt.sent(),[4,this.stopVoiceChat()];case 5:throw tt.sent(),et;case 6:return[2]}})})},$.prototype.stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){switch(_e.label){case 0:return this.state===VoiceChatState.INACTIVE?[2]:(this.state=VoiceChatState.STOPPING,[4,this._stopVoiceChat()]);case 1:return _e.sent(),this._isMuted=!0,this.state=VoiceChatState.INACTIVE,[2]}})})},$.prototype._mute=function(){},$.prototype._unmute=function(){},$.prototype.mute=function(){this.isVoiceChatting&&(this._mute(),this._isMuted=!0)},$.prototype.unmute=function(){this.isVoiceChatting&&(this._unmute(),this._isMuted=!1)},$}(AbstractVoiceChat);function sleep(j){return new Promise(function($){return setTimeout($,j)})}function convertFloat32ToS16PCM(j){for(var $=new Int16Array(j.length),_e=0;_e<j.length;_e++){var et=Math.max(-1,Math.min(1,j[_e]));$[_e]=et<0?et*32768:et*32767}return $}var LivekitVoiceChat=function(j){__extends($,j);function $(){var _e=j!==null&&j.apply(this,arguments)||this;return _e.room=null,_e.track=null,_e}return $.prototype._startVoiceChat=function(_e){return __awaiter(this,void 0,void 0,function(){var et,tt;return __generator(this,function(nt){switch(nt.label){case 0:return this.room=_e.room,et=this,[4,createLocalAudioTrack({echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0})];case 1:return et.track=nt.sent(),[4,this.room.localParticipant.publishTrack(this.track)];case 2:return nt.sent(),!((tt=_e.config)===null||tt===void 0)&&tt.defaultMuted?this.mute():this.unmute(),[4,sleep(4e3)];case 3:return nt.sent(),[2]}})})},$.prototype._stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(et){return!((_e=this.room)===null||_e===void 0)&&_e.localParticipant&&this.room.localParticipant.getTrackPublications().forEach(function(tt){tt.track&&tt.track.kind===Track.Kind.Audio&&tt.track.stop()}),this.track&&(this.track.stop(),this.track=null),[2]})})},$.prototype._mute=function(){this.track&&!this.track.isMuted&&this.track.mute()},$.prototype._unmute=function(){this.track&&this.track.isMuted&&this.track.unmute()},$}(AbstractVoiceChatImplementation),WebSocketVoiceChat=function(j){__extends($,j);function $(){var _e=j!==null&&j.apply(this,arguments)||this;return _e.audioContext=null,_e.webSocket=null,_e.scriptProcessor=null,_e.mediaStreamAudioSource=null,_e.mediaDevicesStream=null,_e.audioRawFrame=null,_e}return $.prototype._startVoiceChat=function(_e){return __awaiter(this,void 0,void 0,function(){var et,tt=this,nt,rt,it,st;return __generator(this,function(at){switch(at.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Cannot start voice chat without media devices");return this.webSocket=_e.webSocket,this.audioRawFrame=_e.audioRawFrame,this.audioContext=new window.AudioContext({latencyHint:"interactive",sampleRate:16e3}),!((nt=_e.config)===null||nt===void 0)&&nt.defaultMuted||this.unmute(),[4,navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0}})];case 1:return et=at.sent(),this.mediaDevicesStream=et,this.mediaStreamAudioSource=(rt=this.audioContext)===null||rt===void 0?void 0:rt.createMediaStreamSource(et),this.scriptProcessor=(it=this.audioContext)===null||it===void 0?void 0:it.createScriptProcessor(512,1,1),this.mediaStreamAudioSource.connect(this.scriptProcessor),this.scriptProcessor.connect((st=this.audioContext)===null||st===void 0?void 0:st.destination),this.scriptProcessor.onaudioprocess=function(ot){var ct;if(!(!tt.webSocket||!tt.audioRawFrame)){var lt;tt.isMuted?lt=new Float32Array(512):lt=ot.inputBuffer.getChannelData(0);var ut=convertFloat32ToS16PCM(lt),pt=new Uint8Array(ut.buffer),dt=tt.audioRawFrame.create({audio:{audio:Array.from(pt),sampleRate:16e3,numChannels:1}}),ht=new Uint8Array(tt.audioRawFrame.encode(dt).finish());(ct=tt.webSocket)===null||ct===void 0||ct.send(ht)}},[4,sleep(2e3)];case 2:return at.sent(),[2]}})})},$.prototype._stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var _e,et;return __generator(this,function(tt){return this.audioContext&&(this.audioContext=null),this.scriptProcessor&&(this.scriptProcessor.disconnect(),this.scriptProcessor=null),this.mediaStreamAudioSource&&(this.mediaStreamAudioSource.disconnect(),this.mediaStreamAudioSource=null),this.mediaDevicesStream&&((et=(_e=this.mediaDevicesStream)===null||_e===void 0?void 0:_e.getTracks())===null||et===void 0||et.forEach(function(nt){return nt.stop()}),this.mediaDevicesStream=null),[2]})})},$}(AbstractVoiceChatImplementation),VoiceChatTransport;(function(j){j.LIVEKIT="livekit",j.WEBSOCKET="websocket"})(VoiceChatTransport||(VoiceChatTransport={}));var VoiceChatFactory=function(j){__extends($,j);function $(_e){var et=_e.voiceChatInstance,tt=_e.initialConfig,nt=j.call(this)||this;return nt.initialConfig=tt,nt.voiceChat=et,nt}return Object.defineProperty($.prototype,"isMuted",{get:function(){return this.voiceChat.isMuted},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"isVoiceChatting",{get:function(){return this.voiceChat.isVoiceChatting},enumerable:!1,configurable:!0}),$.prototype.startVoiceChat=function(_e){return __awaiter(this,arguments,void 0,function(et){var tt=et.config;return __generator(this,function(nt){switch(nt.label){case 0:return[4,this.voiceChat.startVoiceChat(__assign$1(__assign$1({},this.initialConfig),{config:tt}))];case 1:return nt.sent(),[2]}})})},$.prototype.stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){switch(_e.label){case 0:return[4,this.voiceChat.stopVoiceChat()];case 1:return _e.sent(),[2]}})})},$.prototype.mute=function(){this.voiceChat.mute()},$.prototype.unmute=function(){this.voiceChat.unmute()},$.createLiveKitVoiceChat=function(_e){return new this({voiceChatInstance:new LivekitVoiceChat,initialConfig:_e})},$.createWebSocketVoiceChat=function(_e){return new this({voiceChatInstance:new WebSocketVoiceChat,initialConfig:_e})},$}(AbstractVoiceChat),AvatarQuality;(function(j){j.Low="low",j.Medium="medium",j.High="high"})(AvatarQuality||(AvatarQuality={}));var VoiceEmotion;(function(j){j.EXCITED="excited",j.SERIOUS="serious",j.FRIENDLY="friendly",j.SOOTHING="soothing",j.BROADCASTER="broadcaster"})(VoiceEmotion||(VoiceEmotion={}));var ElevenLabsModel;(function(j){j.eleven_flash_v2_5="eleven_flash_v2_5",j.eleven_multilingual_v2="eleven_multilingual_v2"})(ElevenLabsModel||(ElevenLabsModel={}));var STTProvider;(function(j){j.DEEPGRAM="deepgram",j.GLADIA="gladia"})(STTProvider||(STTProvider={}));var TaskType;(function(j){j.TALK="talk",j.REPEAT="repeat"})(TaskType||(TaskType={}));var TaskMode;(function(j){j.SYNC="sync",j.ASYNC="async"})(TaskMode||(TaskMode={}));var StreamingEvents;(function(j){j.AVATAR_START_TALKING="avatar_start_talking",j.AVATAR_STOP_TALKING="avatar_stop_talking",j.AVATAR_TALKING_MESSAGE="avatar_talking_message",j.AVATAR_END_MESSAGE="avatar_end_message",j.USER_TALKING_MESSAGE="user_talking_message",j.USER_END_MESSAGE="user_end_message",j.USER_START="user_start",j.USER_STOP="user_stop",j.USER_SILENCE="user_silence",j.STREAM_READY="stream_ready",j.STREAM_DISCONNECTED="stream_disconnected",j.CONNECTION_QUALITY_CHANGED="connection_quality_changed"})(StreamingEvents||(StreamingEvents={}));var APIError=function(j){__extends($,j);function $(_e,et,tt){var nt=j.call(this,_e)||this;return nt.name="APIError",nt.status=et,nt.responseText=tt,nt}return $}(Error),ConnectionQualityIndicatorClass=QualityIndicatorMixer({TrackerClass:LiveKitConnectionQualityIndicator,getParams:function(j){return j}},{TrackerClass:WebRTCConnectionQualityIndicator,getParams:function(j){var $;return(($=j.engine.pcManager)===null||$===void 0?void 0:$.subscriber)._pc}}),StreamingAvatar=function(){function j($){var _e=$.token,et=$.basePath,tt=et===void 0?"https://api.heygen.com":et,nt=this;this.room=null,this.mediaStream=null,this.eventTarget=new EventTarget,this.webSocket=null,this.sessionId=null,this.voiceChat=null,this.isLiveKitTransport=!1,this.enablePushToTalk=!1,this.token=_e,this.basePath=tt,this.connectionQualityIndicator=new ConnectionQualityIndicatorClass(function(rt){return nt.emit(StreamingEvents.CONNECTION_QUALITY_CHANGED,rt)})}return Object.defineProperty(j.prototype,"connectionQuality",{get:function(){return this.connectionQualityIndicator.connectionQuality},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isInputAudioMuted",{get:function(){var $,_e;return(_e=($=this.voiceChat)===null||$===void 0?void 0:$.isMuted)!==null&&_e!==void 0?_e:!0},enumerable:!1,configurable:!0}),j.prototype.muteInputAudio=function(){var $;($=this.voiceChat)===null||$===void 0||$.mute()},j.prototype.unmuteInputAudio=function(){var $;($=this.voiceChat)===null||$===void 0||$.unmute()},j.prototype.createStartAvatar=function($){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(et){switch(et.label){case 0:return[4,this.newSession($)];case 1:return _e=et.sent(),[2,this.startAvatar($,_e)]}})})},j.prototype.startAvatar=function($,_e){return __awaiter(this,void 0,void 0,function(){var et,tt,nt=this,rt;return __generator(this,function(it){switch(it.label){case 0:this.sessionId=_e.session_id,this.isLiveKitTransport=$.voiceChatTransport===VoiceChatTransport.LIVEKIT,et=new Room({adaptiveStream:!0,dynacast:!0,videoCaptureDefaults:{resolution:VideoPresets.h720.resolution}}),this.room=et,this.mediaStream=null,this.enablePushToTalk=(rt=$.enablePushToTalk)!==null&&rt!==void 0?rt:!1,et.on(RoomEvent.DataReceived,function(st){var at=null;try{var ot=new TextDecoder().decode(st);at=JSON.parse(ot)}catch(ct){console.error(ct)}at&&nt.emit(at.type,at)}),tt=new MediaStream,et.on(RoomEvent.TrackSubscribed,function(st){if(st.kind==="video"||st.kind==="audio"){tt.addTrack(st.mediaStreamTrack);var at=tt.getVideoTracks().length>0,ot=tt.getAudioTracks().length>0;at&&ot&&!nt.mediaStream&&(nt.mediaStream=tt,nt.emit(StreamingEvents.STREAM_READY,nt.mediaStream))}}),et.on(RoomEvent.TrackUnsubscribed,function(st){var at=st.mediaStreamTrack;at&&tt.removeTrack(at)}),et.on(RoomEvent.Disconnected,function(st){nt.emit(StreamingEvents.STREAM_DISCONNECTED,st)}),it.label=1;case 1:return it.trys.push([1,3,,4]),[4,et.prepareConnection(_e.url,_e.access_token)];case 2:return it.sent(),[3,4];case 3:return it.sent(),[3,4];case 4:return[4,this.startSession()];case 5:return it.sent(),[4,et.connect(_e.url,_e.access_token)];case 6:return it.sent(),[4,this.connectWebSocket({useSilencePrompt:!!$.useSilencePrompt})];case 7:return it.sent(),this.initVoiceChat($.voiceChatTransport||VoiceChatTransport.WEBSOCKET),this.connectionQualityIndicator.start(et),[2,_e]}})})},j.prototype.startVoiceChat=function(){return __awaiter(this,arguments,void 0,function($){var _e,et=$===void 0?{}:$,tt=et.isInputAudioMuted;return __generator(this,function(nt){switch(nt.label){case 0:return[4,(_e=this.voiceChat)===null||_e===void 0?void 0:_e.startVoiceChat({config:{defaultMuted:tt}})];case 1:return nt.sent(),[2]}})})},j.prototype.closeVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var $;return __generator(this,function(_e){switch(_e.label){case 0:return[4,($=this.voiceChat)===null||$===void 0?void 0:$.stopVoiceChat()];case 1:return _e.sent(),[2]}})})},j.prototype.newSession=function($){return __awaiter(this,void 0,void 0,function(){var _e,et,tt,nt,rt;return __generator(this,function(it){return[2,this.request("/v1/streaming.new",{avatar_name:$.avatarName,quality:$.quality,knowledge_base_id:$.knowledgeId,knowledge_base:$.knowledgeBase,voice:{voice_id:(_e=$.voice)===null||_e===void 0?void 0:_e.voiceId,rate:(et=$.voice)===null||et===void 0?void 0:et.rate,emotion:(tt=$.voice)===null||tt===void 0?void 0:tt.emotion,elevenlabs_settings:__assign$1(__assign$1({},(nt=$==null?void 0:$.voice)===null||nt===void 0?void 0:nt.elevenlabsSettings),{model_id:(rt=$.voice)===null||rt===void 0?void 0:rt.model})},language:$.language,version:"v2",video_encoding:"H264",source:"sdk",disable_idle_timeout:$.disableIdleTimeout,stt_settings:$.sttSettings,ia_is_livekit_transport:$.voiceChatTransport===VoiceChatTransport.LIVEKIT,silence_response:$.useSilencePrompt,activity_idle_timeout:$.activityIdleTimeout})]})})},j.prototype.startSession=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return[2,this.request("/v1/streaming.start",{session_id:this.sessionId})]})})},j.prototype.speak=function($){return __awaiter(this,void 0,void 0,function(){var _e,et;return __generator(this,function(tt){if(_e=$.taskType||$.task_type||TaskType.TALK,et=$.taskMode||TaskMode.ASYNC,_e===TaskType.TALK&&et===TaskMode.ASYNC){if(this.isLiveKitTransport&&this.room)return this.sendLivekitMessage($.text),[2];if(!this.isLiveKitTransport&&this.webSocket&&this.audioRawFrame)return this.sendWebsocketMessage($.text),[2]}return[2,this.request("/v1/streaming.task",{text:$.text,session_id:this.sessionId,task_mode:$.taskMode,task_type:$.taskType})]})})},j.prototype.startListening=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return[2,this.request("/v1/streaming.start_listening",{session_id:this.sessionId})]})})},j.prototype.stopListening=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return[2,this.request("/v1/streaming.stop_listening",{session_id:this.sessionId})]})})},j.prototype.interrupt=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return[2,this.request("/v1/streaming.interrupt",{session_id:this.sessionId})]})})},j.prototype.stopAvatar=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return this.closeVoiceChat(),this.connectionQualityIndicator.stop(),this.voiceChat=null,this.webSocket&&(this.webSocket.close(),this.webSocket=null),[2,this.request("/v1/streaming.stop",{session_id:this.sessionId})]})})},j.prototype.pushToTalkStart=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){if(!this.isLiveKitTransport)throw new Error("push to talk is only supported for LiveKit transport");if(!this.enablePushToTalk)throw new Error("push to talk is not enabled");if(!this.voiceChat.isVoiceChatting)throw new Error("voice chat is not active");if(!this.room)throw new Error("room is not initialized");return[2,this.sendLivekitMessage("push_to_talk:start")]})})},j.prototype.pushToTalkStop=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){if(!this.isLiveKitTransport)throw new Error("push to talk is only supported for LiveKit transport");if(!this.enablePushToTalk)throw new Error("push to talk is not enabled");if(this.voiceChat.isVoiceChatting||console.log("voice chat is not active"),!this.room)throw new Error("room is not initialized");return[2,this.sendLivekitMessage("push_to_talk:stop")]})})},j.prototype.keepAlive=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($){return[2,this.request("/v1/streaming.keep_alive",{session_id:this.sessionId})]})})},j.prototype.on=function($,_e){return this.eventTarget.addEventListener($,_e),this},j.prototype.off=function($,_e){return this.eventTarget.removeEventListener($,_e),this},j.prototype.sendLivekitMessage=function($){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(et){return this.room?(_e=new TextEncoder().encode(JSON.stringify($)),this.room.localParticipant.publishData(_e,{reliable:!0}),[2]):[2]})})},j.prototype.sendWebsocketMessage=function($){return __awaiter(this,void 0,void 0,function(){var _e,et,tt,nt;return __generator(this,function(rt){return!this.webSocket||!this.audioRawFrame?[2]:(_e=(tt=this.audioRawFrame)===null||tt===void 0?void 0:tt.create({text:{text:$}}),et=new Uint8Array((nt=this.audioRawFrame)===null||nt===void 0?void 0:nt.encode(_e).finish()),this.webSocket.send(et),[2])})})},j.prototype.initVoiceChat=function($){if($===VoiceChatTransport.WEBSOCKET){if(this.loadAudioRawFrame(),!this.audioRawFrame||!this.webSocket)return;this.voiceChat=VoiceChatFactory.createWebSocketVoiceChat({webSocket:this.webSocket,audioRawFrame:this.audioRawFrame})}else{if(!this.room)return;this.voiceChat=VoiceChatFactory.createLiveKitVoiceChat({room:this.room})}},j.prototype.request=function($,_e,et){return __awaiter(this,void 0,void 0,function(){var tt,nt,rt,it;return __generator(this,function(st){switch(st.label){case 0:return st.trys.push([0,5,,6]),[4,fetch(this.getRequestUrl($),{method:"POST",headers:{Authorization:"Bearer ".concat(this.token),"Content-Type":"application/json"},body:JSON.stringify(_e)})];case 1:return tt=st.sent(),tt.ok?[3,3]:[4,tt.text()];case 2:throw nt=st.sent(),new APIError("API request failed with status ".concat(tt.status),tt.status,nt);case 3:return[4,tt.json()];case 4:return rt=st.sent(),[2,rt.data];case 5:throw it=st.sent(),it;case 6:return[2]}})})},j.prototype.emit=function($,_e){var et=new CustomEvent($,{detail:_e});this.eventTarget.dispatchEvent(et)},j.prototype.getRequestUrl=function($){return"".concat(this.basePath).concat($)},j.prototype.connectWebSocket=function($){return __awaiter(this,void 0,void 0,function(){var _e,et=this;return __generator(this,function(tt){return _e="wss://".concat(new URL(this.basePath).hostname,"/v1/ws/streaming.chat?session_id=").concat(this.sessionId,"&session_token=").concat(this.token).concat(this.isLiveKitTransport?"&arch_version=v2":"","&silence_response=").concat($.useSilencePrompt,"&push_to_talk=").concat(this.enablePushToTalk),this.webSocket=new WebSocket(_e),this.webSocket.addEventListener("message",function(nt){var rt=null;try{rt=JSON.parse(nt.data)}catch(it){console.error(it);return}rt&&et.emit(rt.event_type,rt)}),this.webSocket.addEventListener("close",function(nt){et.webSocket=null}),[2,new Promise(function(nt,rt){var it,st;(it=et.webSocket)===null||it===void 0||it.addEventListener("error",function(at){et.webSocket=null,rt(at)}),(st=et.webSocket)===null||st===void 0||st.addEventListener("open",function(){nt(!0)})})]})})},j.prototype.loadAudioRawFrame=function(){return __awaiter(this,void 0,void 0,function(){var $;return __generator(this,function(_e){return this.audioRawFrame||($=protobuf.Root.fromJSON(jsonDescriptor),this.audioRawFrame=$==null?void 0:$.lookupType("pipecat.Frame")),[2]})})},j}();const TOKEN_CACHE_DURATION=10*60*1e3,SESSION_MAX_AGE=15*60*1e3,globalSessionState={preWarmedSession:null,previousSession:null,cachedToken:null,warmingState:{isWarming:!1,progress:0,status:""},warmingRef:{current:!1},avatarRef:{current:null},listeners:new Set,tokenFetchPromise:null};function notifyListeners(){globalSessionState.listeners.forEach(j=>j())}const AvatarSessionContext=reactExports.createContext(null);function AvatarSessionProvider({children:j}){const[,$]=reactExports.useState({});reactExports.useEffect(()=>{const ot=()=>$({});return globalSessionState.listeners.add(ot),()=>{globalSessionState.listeners.delete(ot)}},[]);const _e=async(ot=!1)=>{if(!ot&&globalSessionState.cachedToken){const{token:ct,expiresAt:lt}=globalSessionState.cachedToken;if(Date.now()<lt)return console.log("Using cached token"),ct}return globalSessionState.tokenFetchPromise?(console.log("Waiting for existing token fetch..."),globalSessionState.tokenFetchPromise):(console.log("Fetching new access token..."),globalSessionState.tokenFetchPromise=(async()=>{try{const ct=await fetch("/api/avatar/get-access-token",{method:"POST",headers:{"Content-Type":"application/json"}});if(!ct.ok)throw new Error(`Token fetch failed: ${ct.status}`);const lt=await ct.text();if(!lt||lt.trim()==="")throw new Error("Received empty token");const ut=lt.trim();return globalSessionState.cachedToken={token:ut,expiresAt:Date.now()+TOKEN_CACHE_DURATION},ut}catch(ct){return console.error("Error fetching access token for pre-warming:",ct),null}finally{globalSessionState.tokenFetchPromise=null}})(),globalSessionState.tokenFetchPromise)},et=ot=>{globalSessionState.warmingState={...globalSessionState.warmingState,...ot},notifyListeners()},tt=async ot=>{if(ot!=null&&ot.avatar)try{await ot.avatar.stopAvatar()}catch(ct){console.error("Error stopping avatar:",ct)}},nt=reactExports.useCallback(async()=>{await _e()},[]),rt=reactExports.useCallback(async(ot,ct=0)=>{var dt,ht,ft,mt;if(globalSessionState.warmingRef.current){console.log("Already warming, skipping...");return}if((dt=globalSessionState.preWarmedSession)!=null&&dt.isReady){const gt=globalSessionState.preWarmedSession;if(gt.avatarId===ot.avatarId&&gt.knowledgeBase===ot.knowledgeBase&&Date.now()-gt.createdAt<SESSION_MAX_AGE){console.log("Valid session already exists, skipping warm...");return}}globalSessionState.warmingRef.current=!0,et({isWarming:!0,progress:10,status:"Preparing AI assistant..."});let pt=null;try{et({progress:25,status:"Getting access token..."});const gt=await _e();if(!gt)throw new Error("Failed to get access token");if(!globalSessionState.warmingRef.current){console.log("Warming cancelled during token fetch");return}et({progress:45,status:"Initializing avatar..."});const yt=new StreamingAvatar({token:gt});pt=yt,globalSessionState.avatarRef.current=yt;let vt=null,xt=null;const St=new Promise(Tt=>{xt=Tt,setTimeout(()=>Tt(null),8e3)});if(yt.on(StreamingEvents.STREAM_READY,Tt=>{console.log("Pre-warm: Stream is ready"),vt=Tt.detail,xt&&xt(Tt.detail)}),yt.on(StreamingEvents.STREAM_DISCONNECTED,Tt=>{console.error("Pre-warm stream disconnected:",Tt)}),et({progress:60,status:"Starting avatar session..."}),!globalSessionState.warmingRef.current){console.log("Warming cancelled before createStartAvatar"),await yt.stopAvatar(),pt=null;return}const Et=await yt.createStartAvatar({quality:AvatarQuality.Low,avatarName:ot.avatarId,knowledgeId:ot.knowledgeId,knowledgeBase:ot.knowledgeBase||"",voice:{rate:1,emotion:VoiceEmotion.FRIENDLY},language:ot.language||"en",voiceChatTransport:VoiceChatTransport.WEBSOCKET});if(!globalSessionState.warmingRef.current){console.log("Warming cancelled after createStartAvatar"),await yt.stopAvatar(),pt=null;return}et({progress:85,status:"Waiting for stream..."});const wt=await St;et({progress:100,status:"Ready!"}),globalSessionState.previousSession&&(await tt(globalSessionState.previousSession),globalSessionState.previousSession=null),globalSessionState.preWarmedSession={token:gt,avatar:yt,sessionData:Et,stream:wt||vt,avatarId:ot.avatarId,knowledgeId:ot.knowledgeId,knowledgeBase:ot.knowledgeBase,isReady:!0,createdAt:Date.now()},pt=null,console.log("Pre-warming complete! Session ready:",Et==null?void 0:Et.session_id),notifyListeners()}catch(gt){if(console.error("Error during pre-warming:",gt),(((ht=gt==null?void 0:gt.responseText)==null?void 0:ht.includes("10004"))||((ft=gt==null?void 0:gt.message)==null?void 0:ft.includes("Concurrent limit")))&&ct<2){if(console.log(`Concurrent limit hit, retrying in 3000ms (attempt ${ct+1}/2)...`),et({status:"Server busy, retrying..."}),pt){try{await pt.stopAvatar()}catch(vt){console.error("Error cleaning up before retry:",vt)}pt=null}if(globalSessionState.warmingRef.current=!1,await new Promise(vt=>setTimeout(vt,3e3)),(mt=globalSessionState.preWarmedSession)!=null&&mt.isReady){console.log("Session already ready after retry delay, skipping retry");return}return rt(ot,ct+1)}et({status:"Will connect on start"}),globalSessionState.preWarmedSession=null}finally{if(pt&&!globalSessionState.preWarmedSession){console.log("Cleaning up orphaned avatar in finally block");try{await pt.stopAvatar()}catch(gt){console.error("Error stopping orphaned avatar:",gt)}}et({isWarming:!1}),globalSessionState.warmingRef.current=!1}},[]),it=reactExports.useCallback(ot=>{var lt;let ct=globalSessionState.preWarmedSession;if(ct!=null&&ct.isReady&&Date.now()-ct.createdAt>SESSION_MAX_AGE&&(console.log("Pre-warmed session expired, discarding"),tt(ct),globalSessionState.preWarmedSession=null,ct=null),ct!=null&&ct.isReady){if(ot&&ct.knowledgeBase!==ot)if(console.log("Pre-warmed session knowledgeBase mismatch, checking previous session..."),(lt=globalSessionState.previousSession)!=null&&lt.isReady&&globalSessionState.previousSession.knowledgeBase===ot)console.log("Using previous session with matching config"),ct=globalSessionState.previousSession,globalSessionState.previousSession=null;else return tt(ct),globalSessionState.preWarmedSession=null,et({progress:0,status:""}),globalSessionState.avatarRef.current=null,notifyListeners(),null;return globalSessionState.preWarmedSession=null,et({progress:0,status:""}),globalSessionState.avatarRef.current=null,console.log("Pre-warmed session consumed"),notifyListeners(),ct}return null},[]),st=reactExports.useCallback(async ot=>{var ct;console.log("Restarting warming with new config"),globalSessionState.warmingRef.current=!1,(ct=globalSessionState.preWarmedSession)!=null&&ct.isReady&&(globalSessionState.previousSession&&await tt(globalSessionState.previousSession),globalSessionState.previousSession=globalSessionState.preWarmedSession,console.log("Keeping previous session as fallback")),globalSessionState.preWarmedSession=null,globalSessionState.avatarRef.current=null,et({isWarming:!1,progress:0,status:""}),notifyListeners(),await new Promise(lt=>setTimeout(lt,50)),await rt(ot)},[rt]),at=reactExports.useCallback(()=>{globalSessionState.warmingRef.current=!1,et({isWarming:!1,progress:0,status:""}),globalSessionState.avatarRef.current&&(globalSessionState.avatarRef.current.stopAvatar().catch(console.error),globalSessionState.avatarRef.current=null),globalSessionState.preWarmedSession=null,notifyListeners(),console.log("Pre-warming cancelled")},[]);return jsxRuntimeExports.jsx(AvatarSessionContext.Provider,{value:{preWarmedSession:globalSessionState.preWarmedSession,isWarming:globalSessionState.warmingState.isWarming,warmingProgress:globalSessionState.warmingState.progress,warmingStatus:globalSessionState.warmingState.status,startWarming:rt,restartWarming:st,consumePreWarmedSession:it,cancelWarming:at,preWarmToken:nt},children:j})}function useAvatarSession(){const j=reactExports.useContext(AvatarSessionContext);return j||null}async function fetchUser(){const j=await fetch("/api/auth/user",{credentials:"include"});return j.ok?j.json():null}function useAuth$1(){const{data:j,isLoading:$}=useQuery({queryKey:["auth","user"],queryFn:fetchUser,retry:!1,staleTime:3e5});return{user:j??null,isLoading:$,isAuthenticated:!!j}}/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=j=>j.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(j,$)=>{const _e=reactExports.forwardRef(({color:et="currentColor",size:tt=24,strokeWidth:nt=2,absoluteStrokeWidth:rt,className:it="",children:st,...at},ot)=>reactExports.createElement("svg",{ref:ot,...defaultAttributes,width:tt,height:tt,stroke:et,strokeWidth:rt?Number(nt)*24/Number(tt):nt,className:["lucide",`lucide-${toKebabCase(j)}`,it].join(" "),...at},[...$.map(([ct,lt])=>reactExports.createElement(ct,lt)),...Array.isArray(st)?st:[st]]));return _e.displayName=`${j}`,_e};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertCircle=createLucideIcon("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AlertTriangle=createLucideIcon("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowLeft=createLucideIcon("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowRight=createLucideIcon("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ArrowUpRight=createLucideIcon("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Award=createLucideIcon("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BarChart3=createLucideIcon("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BookOpen=createLucideIcon("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bot=createLucideIcon("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Brain=createLucideIcon("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Briefcase=createLucideIcon("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle2=createLucideIcon("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CheckCircle=createLucideIcon("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronDown=createLucideIcon("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronUp=createLucideIcon("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clipboard=createLucideIcon("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Compass=createLucideIcon("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Globe=createLucideIcon("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Home=createLucideIcon("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Layers=createLucideIcon("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lightbulb=createLucideIcon("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LogIn=createLucideIcon("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LogOut=createLucideIcon("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MessageCircle=createLucideIcon("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MessageSquare=createLucideIcon("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mic=createLucideIcon("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PenLine=createLucideIcon("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PhoneOff=createLucideIcon("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Phone=createLucideIcon("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Plus=createLucideIcon("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RefreshCw=createLucideIcon("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Save=createLucideIcon("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Search=createLucideIcon("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings2=createLucideIcon("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sparkles=createLucideIcon("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Target=createLucideIcon("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ThumbsDown=createLucideIcon("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ThumbsUp=createLucideIcon("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TrendingDown=createLucideIcon("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TrendingUp=createLucideIcon("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Trophy=createLucideIcon("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const User=createLucideIcon("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Users=createLucideIcon("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Video=createLucideIcon("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Volume2=createLucideIcon("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VolumeX=createLucideIcon("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wand2=createLucideIcon("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zap=createLucideIcon("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function ProtectedRoute({children:j}){const{isAuthenticated:$,isLoading:_e}=useAuth$1(),et=useLocation();if(_e)return jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-8 h-8 animate-spin text-blue-600"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Checking authentication..."})]})});if(!$){const tt=encodeURIComponent(et.pathname+et.search);return jsxRuntimeExports.jsx(Navigate,{to:`/login?returnUrl=${tt}`,replace:!0})}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:j})}function HomePage(){const{user:j,isAuthenticated:$,isLoading:_e}=useAuth$1();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:[jsxRuntimeExports.jsx("header",{className:"container mx-auto px-6 py-8",children:jsxRuntimeExports.jsxs("nav",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-slate-800",children:"Conversation Lab"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:_e?jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 animate-pulse"}):$&&j?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Link,{to:"/avatar/dashboard",className:"text-slate-600 hover:text-slate-900 font-medium",children:"Dashboard"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[j.profileImageUrl?jsxRuntimeExports.jsx("img",{src:j.profileImageUrl,alt:j.firstName||"User",className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-blue-600"})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-slate-700 hidden lg:block",children:j.firstName||j.username||"User"})]}),jsxRuntimeExports.jsxs("button",{onClick:async()=>{await fetch("/api/auth/logout",{method:"POST"}),window.location.href="/"},className:"flex items-center gap-1 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(LogOut,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden lg:inline",children:"Sign out"})]})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Link,{to:"/login",className:"text-slate-600 hover:text-slate-900 font-medium",children:"Sign in"}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",className:"bg-blue-600 text-white px-6 py-2.5 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Get Started"})]})})]})}),jsxRuntimeExports.jsxs("main",{className:"container mx-auto px-6 py-16",children:[jsxRuntimeExports.jsxs("section",{className:"text-center max-w-4xl mx-auto mb-24",children:[jsxRuntimeExports.jsxs("h1",{className:"text-5xl font-bold text-slate-900 mb-6 leading-tight",children:["Practice Real Conversations",jsxRuntimeExports.jsx("br",{}),"Before They Happen"]}),jsxRuntimeExports.jsx("p",{className:"text-xl text-slate-600 mb-10 max-w-2xl mx-auto",children:"A voice-based AI practice lab that helps you think clearly, speak confidently, and handle difficult conversations with ease."}),jsxRuntimeExports.jsxs(Link,{to:"/avatar/start",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-8 py-4 rounded-xl text-lg font-medium hover:bg-blue-700 transition-colors",children:["Start Practicing",jsxRuntimeExports.jsx(ArrowRight,{className:"w-5 h-5"})]})]}),jsxRuntimeExports.jsxs("section",{className:"grid md:grid-cols-3 gap-8 max-w-5xl mx-auto mb-24",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[jsxRuntimeExports.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-7 h-7 text-blue-600"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-3",children:"Voice-First Practice"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Speak naturally with an AI avatar that responds in real-time. No scripts, no pre-written dialogue."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[jsxRuntimeExports.jsx("div",{className:"w-14 h-14 bg-green-100 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(Target,{className:"w-7 h-7 text-green-600"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-3",children:"Real Scenarios"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Practice difficult conversations: giving feedback, handling conflict, persuading stakeholders."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[jsxRuntimeExports.jsx("div",{className:"w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(Brain,{className:"w-7 h-7 text-purple-600"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-3",children:"Grounded Feedback"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Receive personalized analysis on clarity, presence, listening, and how you handle tension."})]})]}),jsxRuntimeExports.jsxs("section",{className:"text-center max-w-3xl mx-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-slate-900 mb-6",children:"Not a chatbot. Not a language app."}),jsxRuntimeExports.jsx("p",{className:"text-lg text-slate-600 mb-10",children:"This is a safe, realistic environment where you practice how you think, speak, listen, and respond in real-life conversations. The AI plays the role of the other person. The app plays the role of your coach."}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[jsxRuntimeExports.jsx("span",{className:"px-4 py-2 bg-slate-100 rounded-full text-slate-700 text-sm",children:"Workplace & Leadership"}),jsxRuntimeExports.jsx("span",{className:"px-4 py-2 bg-slate-100 rounded-full text-slate-700 text-sm",children:"Difficult Feedback"}),jsxRuntimeExports.jsx("span",{className:"px-4 py-2 bg-slate-100 rounded-full text-slate-700 text-sm",children:"Conflict Resolution"}),jsxRuntimeExports.jsx("span",{className:"px-4 py-2 bg-slate-100 rounded-full text-slate-700 text-sm",children:"Interview Prep"}),jsxRuntimeExports.jsx("span",{className:"px-4 py-2 bg-slate-100 rounded-full text-slate-700 text-sm",children:"Personal Growth"})]})]})]}),jsxRuntimeExports.jsx("footer",{className:"container mx-auto px-6 py-12 border-t border-slate-100",children:jsxRuntimeExports.jsx("div",{className:"text-center text-slate-500 text-sm",children:"AI Avatar Conversation Lab - Practice conversations before they happen"})})]})}function LoginPage(){useNavigate();const[j]=useSearchParams(),$=j.get("returnUrl")||"/avatar/start",[_e,et]=reactExports.useState(""),[tt,nt]=reactExports.useState(""),[rt,it]=reactExports.useState(""),[st,at]=reactExports.useState(!1),ot=async ct=>{ct.preventDefault(),it(""),at(!0);try{const lt=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:_e,password:tt})}),ut=await lt.json();if(!lt.ok){it(ut.message||"Login failed"),at(!1);return}window.location.href=decodeURIComponent($)}catch(lt){console.error("Login error:",lt),it("An error occurred. Please try again."),at(!1)}};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"container mx-auto px-6 py-8",children:jsxRuntimeExports.jsx("nav",{className:"flex justify-between items-center",children:jsxRuntimeExports.jsxs(Link,{to:"/",className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-slate-800",children:"Conversation Lab"})]})})}),jsxRuntimeExports.jsx("main",{className:"flex-1 flex items-center justify-center px-6 py-12",children:jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2 text-center",children:"Welcome back"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 text-center mb-8",children:"Sign in to continue practicing"}),jsxRuntimeExports.jsxs("form",{onSubmit:ot,className:"space-y-5",children:[rt&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-lg text-sm",children:rt}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),jsxRuntimeExports.jsx("input",{id:"username",type:"text",value:_e,onChange:ct=>et(ct.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your username",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),jsxRuntimeExports.jsx("input",{id:"password",type:"password",value:tt,onChange:ct=>nt(ct.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your password",required:!0})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:st,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:st?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):"Sign In"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-600",children:["Don't have an account?"," ",jsxRuntimeExports.jsx(Link,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Create one"})]})})]})})})]})}function RegisterPage(){const j=useNavigate(),[$,_e]=reactExports.useState(""),[et,tt]=reactExports.useState(""),[nt,rt]=reactExports.useState(""),[it,st]=reactExports.useState(""),[at,ot]=reactExports.useState(""),[ct,lt]=reactExports.useState(!1),ut=async pt=>{if(pt.preventDefault(),ot(""),nt!==it){ot("Passwords do not match");return}if(nt.length<6){ot("Password must be at least 6 characters");return}lt(!0);try{const dt=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:$,email:et||void 0,password:nt})}),ht=await dt.json();if(!dt.ok){ot(ht.message||"Registration failed"),lt(!1);return}j("/avatar/start")}catch{ot("An error occurred. Please try again."),lt(!1)}};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"container mx-auto px-6 py-8",children:jsxRuntimeExports.jsx("nav",{className:"flex justify-between items-center",children:jsxRuntimeExports.jsxs(Link,{to:"/",className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-slate-800",children:"Conversation Lab"})]})})}),jsxRuntimeExports.jsx("main",{className:"flex-1 flex items-center justify-center px-6 py-12",children:jsxRuntimeExports.jsx("div",{className:"w-full max-w-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2 text-center",children:"Create an account"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 text-center mb-8",children:"Start practicing conversations today"}),jsxRuntimeExports.jsxs("form",{onSubmit:ut,className:"space-y-5",children:[at&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-lg text-sm",children:at}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),jsxRuntimeExports.jsx("input",{id:"username",type:"text",value:$,onChange:pt=>_e(pt.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Choose a username",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:["Email ",jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:"(optional)"})]}),jsxRuntimeExports.jsx("input",{id:"email",type:"email",value:et,onChange:pt=>tt(pt.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),jsxRuntimeExports.jsx("input",{id:"password",type:"password",value:nt,onChange:pt=>rt(pt.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Create a password (min 6 characters)",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm Password"}),jsxRuntimeExports.jsx("input",{id:"confirmPassword",type:"password",value:it,onChange:pt=>st(pt.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirm your password",required:!0})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:ct,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ct?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 animate-spin"}),"Creating account..."]}):"Create Account"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-600",children:["Already have an account?"," ",jsxRuntimeExports.jsx(Link,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})]})}function r$1(j){var $,_e,et="";if(typeof j=="string"||typeof j=="number")et+=j;else if(typeof j=="object")if(Array.isArray(j)){var tt=j.length;for($=0;$<tt;$++)j[$]&&(_e=r$1(j[$]))&&(et&&(et+=" "),et+=_e)}else for(_e in j)j[_e]&&(et&&(et+=" "),et+=_e);return et}function clsx$1(){for(var j,$,_e=0,et="",tt=arguments.length;_e<tt;_e++)(j=arguments[_e])&&($=r$1(j))&&(et&&(et+=" "),et+=$);return et}const CLASS_PART_SEPARATOR="-",createClassGroupUtils=j=>{const $=createClassMap(j),{conflictingClassGroups:_e,conflictingClassGroupModifiers:et}=j;return{getClassGroupId:rt=>{const it=rt.split(CLASS_PART_SEPARATOR);return it[0]===""&&it.length!==1&&it.shift(),getGroupRecursive(it,$)||getGroupIdForArbitraryProperty(rt)},getConflictingClassGroupIds:(rt,it)=>{const st=_e[rt]||[];return it&&et[rt]?[...st,...et[rt]]:st}}},getGroupRecursive=(j,$)=>{var rt;if(j.length===0)return $.classGroupId;const _e=j[0],et=$.nextPart.get(_e),tt=et?getGroupRecursive(j.slice(1),et):void 0;if(tt)return tt;if($.validators.length===0)return;const nt=j.join(CLASS_PART_SEPARATOR);return(rt=$.validators.find(({validator:it})=>it(nt)))==null?void 0:rt.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=j=>{if(arbitraryPropertyRegex.test(j)){const $=arbitraryPropertyRegex.exec(j)[1],_e=$==null?void 0:$.substring(0,$.indexOf(":"));if(_e)return"arbitrary.."+_e}},createClassMap=j=>{const{theme:$,prefix:_e}=j,et={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(j.classGroups),_e).forEach(([nt,rt])=>{processClassesRecursively(rt,et,nt,$)}),et},processClassesRecursively=(j,$,_e,et)=>{j.forEach(tt=>{if(typeof tt=="string"){const nt=tt===""?$:getPart($,tt);nt.classGroupId=_e;return}if(typeof tt=="function"){if(isThemeGetter(tt)){processClassesRecursively(tt(et),$,_e,et);return}$.validators.push({validator:tt,classGroupId:_e});return}Object.entries(tt).forEach(([nt,rt])=>{processClassesRecursively(rt,getPart($,nt),_e,et)})})},getPart=(j,$)=>{let _e=j;return $.split(CLASS_PART_SEPARATOR).forEach(et=>{_e.nextPart.has(et)||_e.nextPart.set(et,{nextPart:new Map,validators:[]}),_e=_e.nextPart.get(et)}),_e},isThemeGetter=j=>j.isThemeGetter,getPrefixedClassGroupEntries=(j,$)=>$?j.map(([_e,et])=>{const tt=et.map(nt=>typeof nt=="string"?$+nt:typeof nt=="object"?Object.fromEntries(Object.entries(nt).map(([rt,it])=>[$+rt,it])):nt);return[_e,tt]}):j,createLruCache=j=>{if(j<1)return{get:()=>{},set:()=>{}};let $=0,_e=new Map,et=new Map;const tt=(nt,rt)=>{_e.set(nt,rt),$++,$>j&&($=0,et=_e,_e=new Map)};return{get(nt){let rt=_e.get(nt);if(rt!==void 0)return rt;if((rt=et.get(nt))!==void 0)return tt(nt,rt),rt},set(nt,rt){_e.has(nt)?_e.set(nt,rt):tt(nt,rt)}}},IMPORTANT_MODIFIER="!",createParseClassName=j=>{const{separator:$,experimentalParseClassName:_e}=j,et=$.length===1,tt=$[0],nt=$.length,rt=it=>{const st=[];let at=0,ot=0,ct;for(let ht=0;ht<it.length;ht++){let ft=it[ht];if(at===0){if(ft===tt&&(et||it.slice(ht,ht+nt)===$)){st.push(it.slice(ot,ht)),ot=ht+nt;continue}if(ft==="/"){ct=ht;continue}}ft==="["?at++:ft==="]"&&at--}const lt=st.length===0?it:it.substring(ot),ut=lt.startsWith(IMPORTANT_MODIFIER),pt=ut?lt.substring(1):lt,dt=ct&&ct>ot?ct-ot:void 0;return{modifiers:st,hasImportantModifier:ut,baseClassName:pt,maybePostfixModifierPosition:dt}};return _e?it=>_e({className:it,parseClassName:rt}):rt},sortModifiers=j=>{if(j.length<=1)return j;const $=[];let _e=[];return j.forEach(et=>{et[0]==="["?($.push(..._e.sort(),et),_e=[]):_e.push(et)}),$.push(..._e.sort()),$},createConfigUtils=j=>({cache:createLruCache(j.cacheSize),parseClassName:createParseClassName(j),...createClassGroupUtils(j)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(j,$)=>{const{parseClassName:_e,getClassGroupId:et,getConflictingClassGroupIds:tt}=$,nt=[],rt=j.trim().split(SPLIT_CLASSES_REGEX);let it="";for(let st=rt.length-1;st>=0;st-=1){const at=rt[st],{modifiers:ot,hasImportantModifier:ct,baseClassName:lt,maybePostfixModifierPosition:ut}=_e(at);let pt=!!ut,dt=et(pt?lt.substring(0,ut):lt);if(!dt){if(!pt){it=at+(it.length>0?" "+it:it);continue}if(dt=et(lt),!dt){it=at+(it.length>0?" "+it:it);continue}pt=!1}const ht=sortModifiers(ot).join(":"),ft=ct?ht+IMPORTANT_MODIFIER:ht,mt=ft+dt;if(nt.includes(mt))continue;nt.push(mt);const gt=tt(dt,pt);for(let yt=0;yt<gt.length;++yt){const vt=gt[yt];nt.push(ft+vt)}it=at+(it.length>0?" "+it:it)}return it};function twJoin(){let j=0,$,_e,et="";for(;j<arguments.length;)($=arguments[j++])&&(_e=toValue($))&&(et&&(et+=" "),et+=_e);return et}const toValue=j=>{if(typeof j=="string")return j;let $,_e="";for(let et=0;et<j.length;et++)j[et]&&($=toValue(j[et]))&&(_e&&(_e+=" "),_e+=$);return _e};function createTailwindMerge(j,...$){let _e,et,tt,nt=rt;function rt(st){const at=$.reduce((ot,ct)=>ct(ot),j());return _e=createConfigUtils(at),et=_e.cache.get,tt=_e.cache.set,nt=it,it(st)}function it(st){const at=et(st);if(at)return at;const ot=mergeClassList(st,_e);return tt(st,ot),ot}return function(){return nt(twJoin.apply(null,arguments))}}const fromTheme=j=>{const $=_e=>_e[j]||[];return $.isThemeGetter=!0,$},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength$1=j=>isNumber$1(j)||stringLengths.has(j)||fractionRegex.test(j),isArbitraryLength=j=>getIsArbitraryValue(j,"length",isLengthOnly),isNumber$1=j=>!!j&&!Number.isNaN(Number(j)),isArbitraryNumber=j=>getIsArbitraryValue(j,"number",isNumber$1),isInteger=j=>!!j&&Number.isInteger(Number(j)),isPercent$1=j=>j.endsWith("%")&&isNumber$1(j.slice(0,-1)),isArbitraryValue=j=>arbitraryValueRegex.test(j),isTshirtSize=j=>tshirtUnitRegex.test(j),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=j=>getIsArbitraryValue(j,sizeLabels,isNever),isArbitraryPosition=j=>getIsArbitraryValue(j,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=j=>getIsArbitraryValue(j,imageLabels,isImage),isArbitraryShadow=j=>getIsArbitraryValue(j,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(j,$,_e)=>{const et=arbitraryValueRegex.exec(j);return et?et[1]?typeof $=="string"?et[1]===$:$.has(et[1]):_e(et[2]):!1},isLengthOnly=j=>lengthUnitRegex.test(j)&&!colorFunctionRegex.test(j),isNever=()=>!1,isShadow=j=>shadowRegex.test(j),isImage=j=>imageRegex.test(j),getDefaultConfig=()=>{const j=fromTheme("colors"),$=fromTheme("spacing"),_e=fromTheme("blur"),et=fromTheme("brightness"),tt=fromTheme("borderColor"),nt=fromTheme("borderRadius"),rt=fromTheme("borderSpacing"),it=fromTheme("borderWidth"),st=fromTheme("contrast"),at=fromTheme("grayscale"),ot=fromTheme("hueRotate"),ct=fromTheme("invert"),lt=fromTheme("gap"),ut=fromTheme("gradientColorStops"),pt=fromTheme("gradientColorStopPositions"),dt=fromTheme("inset"),ht=fromTheme("margin"),ft=fromTheme("opacity"),mt=fromTheme("padding"),gt=fromTheme("saturate"),yt=fromTheme("scale"),vt=fromTheme("sepia"),xt=fromTheme("skew"),St=fromTheme("space"),Et=fromTheme("translate"),wt=()=>["auto","contain","none"],Tt=()=>["auto","hidden","clip","visible","scroll"],Ct=()=>["auto",isArbitraryValue,$],Rt=()=>[isArbitraryValue,$],jt=()=>["",isLength$1,isArbitraryLength],Ot=()=>["auto",isNumber$1,isArbitraryValue],$t=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Kt=()=>["solid","dashed","dotted","double","none"],Lt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Nt=()=>["start","end","center","between","around","evenly","stretch"],Bt=()=>["","0",isArbitraryValue],kt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],rn=()=>[isNumber$1,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength$1,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:rn(),borderColor:[j],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:Rt(),borderWidth:jt(),contrast:rn(),grayscale:Bt(),hueRotate:rn(),invert:Bt(),gap:Rt(),gradientColorStops:[j],gradientColorStopPositions:[isPercent$1,isArbitraryLength],inset:Ct(),margin:Ct(),opacity:rn(),padding:Rt(),saturate:rn(),scale:rn(),sepia:Bt(),skew:rn(),space:Rt(),translate:Rt()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":kt()}],"break-before":[{"break-before":kt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$t(),isArbitraryValue]}],overflow:[{overflow:Tt()}],"overflow-x":[{"overflow-x":Tt()}],"overflow-y":[{"overflow-y":Tt()}],overscroll:[{overscroll:wt()}],"overscroll-x":[{"overscroll-x":wt()}],"overscroll-y":[{"overscroll-y":wt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[dt]}],"inset-x":[{"inset-x":[dt]}],"inset-y":[{"inset-y":[dt]}],start:[{start:[dt]}],end:[{end:[dt]}],top:[{top:[dt]}],right:[{right:[dt]}],bottom:[{bottom:[dt]}],left:[{left:[dt]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:Ct()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:Bt()}],shrink:[{shrink:Bt()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":Ot()}],"col-end":[{"col-end":Ot()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":Ot()}],"row-end":[{"row-end":Ot()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[lt]}],"gap-x":[{"gap-x":[lt]}],"gap-y":[{"gap-y":[lt]}],"justify-content":[{justify:["normal",...Nt()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Nt(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Nt(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[mt]}],px:[{px:[mt]}],py:[{py:[mt]}],ps:[{ps:[mt]}],pe:[{pe:[mt]}],pt:[{pt:[mt]}],pr:[{pr:[mt]}],pb:[{pb:[mt]}],pl:[{pl:[mt]}],m:[{m:[ht]}],mx:[{mx:[ht]}],my:[{my:[ht]}],ms:[{ms:[ht]}],me:[{me:[ht]}],mt:[{mt:[ht]}],mr:[{mr:[ht]}],mb:[{mb:[ht]}],ml:[{ml:[ht]}],"space-x":[{"space-x":[St]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[St]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,$]}],"min-w":[{"min-w":[isArbitraryValue,$,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,$,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,$,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,$,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,$,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,$,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber$1,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength$1,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[j]}],"placeholder-opacity":[{"placeholder-opacity":[ft]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[j]}],"text-opacity":[{"text-opacity":[ft]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Kt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength$1,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength$1,isArbitraryValue]}],"text-decoration-color":[{decoration:[j]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Rt()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[ft]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$t(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[j]}],"gradient-from-pos":[{from:[pt]}],"gradient-via-pos":[{via:[pt]}],"gradient-to-pos":[{to:[pt]}],"gradient-from":[{from:[ut]}],"gradient-via":[{via:[ut]}],"gradient-to":[{to:[ut]}],rounded:[{rounded:[nt]}],"rounded-s":[{"rounded-s":[nt]}],"rounded-e":[{"rounded-e":[nt]}],"rounded-t":[{"rounded-t":[nt]}],"rounded-r":[{"rounded-r":[nt]}],"rounded-b":[{"rounded-b":[nt]}],"rounded-l":[{"rounded-l":[nt]}],"rounded-ss":[{"rounded-ss":[nt]}],"rounded-se":[{"rounded-se":[nt]}],"rounded-ee":[{"rounded-ee":[nt]}],"rounded-es":[{"rounded-es":[nt]}],"rounded-tl":[{"rounded-tl":[nt]}],"rounded-tr":[{"rounded-tr":[nt]}],"rounded-br":[{"rounded-br":[nt]}],"rounded-bl":[{"rounded-bl":[nt]}],"border-w":[{border:[it]}],"border-w-x":[{"border-x":[it]}],"border-w-y":[{"border-y":[it]}],"border-w-s":[{"border-s":[it]}],"border-w-e":[{"border-e":[it]}],"border-w-t":[{"border-t":[it]}],"border-w-r":[{"border-r":[it]}],"border-w-b":[{"border-b":[it]}],"border-w-l":[{"border-l":[it]}],"border-opacity":[{"border-opacity":[ft]}],"border-style":[{border:[...Kt(),"hidden"]}],"divide-x":[{"divide-x":[it]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[it]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[ft]}],"divide-style":[{divide:Kt()}],"border-color":[{border:[tt]}],"border-color-x":[{"border-x":[tt]}],"border-color-y":[{"border-y":[tt]}],"border-color-s":[{"border-s":[tt]}],"border-color-e":[{"border-e":[tt]}],"border-color-t":[{"border-t":[tt]}],"border-color-r":[{"border-r":[tt]}],"border-color-b":[{"border-b":[tt]}],"border-color-l":[{"border-l":[tt]}],"divide-color":[{divide:[tt]}],"outline-style":[{outline:["",...Kt()]}],"outline-offset":[{"outline-offset":[isLength$1,isArbitraryValue]}],"outline-w":[{outline:[isLength$1,isArbitraryLength]}],"outline-color":[{outline:[j]}],"ring-w":[{ring:jt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[j]}],"ring-opacity":[{"ring-opacity":[ft]}],"ring-offset-w":[{"ring-offset":[isLength$1,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[j]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[ft]}],"mix-blend":[{"mix-blend":[...Lt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Lt()}],filter:[{filter:["","none"]}],blur:[{blur:[_e]}],brightness:[{brightness:[et]}],contrast:[{contrast:[st]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[at]}],"hue-rotate":[{"hue-rotate":[ot]}],invert:[{invert:[ct]}],saturate:[{saturate:[gt]}],sepia:[{sepia:[vt]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[_e]}],"backdrop-brightness":[{"backdrop-brightness":[et]}],"backdrop-contrast":[{"backdrop-contrast":[st]}],"backdrop-grayscale":[{"backdrop-grayscale":[at]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ot]}],"backdrop-invert":[{"backdrop-invert":[ct]}],"backdrop-opacity":[{"backdrop-opacity":[ft]}],"backdrop-saturate":[{"backdrop-saturate":[gt]}],"backdrop-sepia":[{"backdrop-sepia":[vt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[rt]}],"border-spacing-x":[{"border-spacing-x":[rt]}],"border-spacing-y":[{"border-spacing-y":[rt]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:rn()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:rn()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[yt]}],"scale-x":[{"scale-x":[yt]}],"scale-y":[{"scale-y":[yt]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[Et]}],"translate-y":[{"translate-y":[Et]}],"skew-x":[{"skew-x":[xt]}],"skew-y":[{"skew-y":[xt]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",j]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[j]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Rt()}],"scroll-mx":[{"scroll-mx":Rt()}],"scroll-my":[{"scroll-my":Rt()}],"scroll-ms":[{"scroll-ms":Rt()}],"scroll-me":[{"scroll-me":Rt()}],"scroll-mt":[{"scroll-mt":Rt()}],"scroll-mr":[{"scroll-mr":Rt()}],"scroll-mb":[{"scroll-mb":Rt()}],"scroll-ml":[{"scroll-ml":Rt()}],"scroll-p":[{"scroll-p":Rt()}],"scroll-px":[{"scroll-px":Rt()}],"scroll-py":[{"scroll-py":Rt()}],"scroll-ps":[{"scroll-ps":Rt()}],"scroll-pe":[{"scroll-pe":Rt()}],"scroll-pt":[{"scroll-pt":Rt()}],"scroll-pr":[{"scroll-pr":Rt()}],"scroll-pb":[{"scroll-pb":Rt()}],"scroll-pl":[{"scroll-pl":Rt()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[j,"none"]}],"stroke-w":[{stroke:[isLength$1,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[j,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...j){return twMerge(clsx$1(j))}const Card=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("div",{ref:_e,className:cn("rounded-xl border border-slate-200 bg-white shadow-sm",j),...$}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("div",{ref:_e,className:cn("flex flex-col space-y-1.5 p-6",j),...$}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("h3",{ref:_e,className:cn("font-semibold leading-none tracking-tight",j),...$}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("p",{ref:_e,className:cn("text-sm text-slate-500",j),...$}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("div",{ref:_e,className:cn("p-6 pt-0",j),...$}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx("div",{ref:_e,className:cn("flex items-center p-6 pt-0",j),...$}));CardFooter.displayName="CardFooter";const Button=reactExports.forwardRef(({className:j,variant:$="default",size:_e="default",color:et,...tt},nt)=>{const rt="inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",it={default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-slate-200 bg-white hover:bg-slate-100 hover:text-slate-900",secondary:"bg-slate-100 text-slate-900 hover:bg-slate-200",ghost:"hover:bg-slate-100 hover:text-slate-900",link:"text-blue-600 underline-offset-4 hover:underline"},st={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},at={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-slate-600 text-white hover:bg-slate-700",danger:"bg-red-600 text-white hover:bg-red-700"};return jsxRuntimeExports.jsx("button",{className:cn(rt,et?at[et]:it[$],st[_e],j),ref:nt,...tt})});Button.displayName="Button";function Spinner({size:j="md",className:$}){const _e={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return jsxRuntimeExports.jsx("div",{className:cn("animate-spin rounded-full border-2 border-slate-200 border-t-blue-600",_e[j],$)})}function ModernDashboardLayout({children:j}){const $=useLocation(),{user:_e,isAuthenticated:et,isLoading:tt}=useAuth$1(),nt=[{href:"/avatar/dashboard",label:"Dashboard",icon:Home},{href:"/avatar/practice",label:"Practice",icon:Target},{href:"/avatar/results",label:"Results",icon:BarChart3}];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto px-6 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-5 h-5 text-white"})}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-slate-800",children:"Conversation Lab"})]}),jsxRuntimeExports.jsx("nav",{className:"hidden md:flex items-center gap-1",children:nt.map(rt=>{const it=rt.icon,st=$.pathname===rt.href;return jsxRuntimeExports.jsxs(Link,{to:rt.href,className:cn("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors",st?"bg-blue-50 text-blue-700":"text-slate-600 hover:bg-slate-100"),children:[jsxRuntimeExports.jsx(it,{className:"w-4 h-4"}),rt.label]},rt.href)})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:tt?jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 animate-pulse"}):et&&_e?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[_e.profileImageUrl?jsxRuntimeExports.jsx("img",{src:_e.profileImageUrl,alt:_e.firstName||"User",className:"w-8 h-8 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-blue-600"})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-slate-700 hidden lg:block",children:_e.firstName||_e.username||"User"})]}),jsxRuntimeExports.jsxs("button",{onClick:async()=>{await fetch("/api/auth/logout",{method:"POST"}),window.location.href="/"},className:"flex items-center gap-1 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(LogOut,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"hidden lg:inline",children:"Sign out"})]})]}):jsxRuntimeExports.jsxs(Link,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[jsxRuntimeExports.jsx(LogIn,{className:"w-4 h-4"}),"Sign in"]})})]})})}),jsxRuntimeExports.jsx("main",{className:"container mx-auto px-6 py-8",children:j})]})}function AvatarSimulatorDashboard(){const[j,$]=reactExports.useState([]),[_e,et]=reactExports.useState([]),[tt,nt]=reactExports.useState({totalTime:"0h 0m",completedScenarios:0,skillProgress:0,averageSessionDuration:"0m",uniqueSkillsPracticed:0,totalSessions:0,lastSessionDate:"-",skillBreakdown:{}}),[rt,it]=reactExports.useState(!0),st=async()=>{const yt=await(await fetch("/api/avatar/get-skills")).json();if(!yt.success)throw new Error("Failed to fetch skills");return yt.skills},at=async()=>{try{const yt=await(await fetch("/api/avatar/get-transcripts",{credentials:"include"})).json();return yt.success?yt.transcripts||[]:[]}catch{return[]}},ot=useQuery({queryKey:["/avatar/get-skills"],queryFn:st}),ct=useQuery({queryKey:["/avatar/get-transcripts"],queryFn:at,enabled:!!ot.data,refetchOnMount:"always",staleTime:0}),ut=useQuery({queryKey:["/avatar/skill-progress"],queryFn:async()=>{try{const yt=await(await fetch("/api/avatar/skill-progress",{credentials:"include"})).json();return yt.success?yt.skillProgress||[]:[]}catch{return[]}},enabled:!!ot.data,refetchOnMount:"always",staleTime:0});if(reactExports.useEffect(()=>{ot.data&&$(ot.data)},[ot.data]),reactExports.useEffect(()=>{ut.data&&et(ut.data)},[ut.data]),reactExports.useEffect(()=>{var gt;if(ot.data){const yt=ct.data||[],vt=ut.data||[],xt={},St=new Set,Et=new Map;let wt=0,Tt=0;yt.forEach(Lt=>{Lt.knowledge_id&&St.add(Lt.knowledge_id),Lt.custom_scenario_id&&St.add(`custom_${Lt.custom_scenario_id}`),Lt.skill_id&&(Et.set(Lt.skill_id,!0),xt[Lt.skill_id]=(xt[Lt.skill_id]||0)+1);const Nt=parseInt(Lt.duration);!isNaN(Nt)&&Nt>0&&(wt+=Nt,Tt++)}),vt.filter(Lt=>Lt.sessionCount>0).forEach(Lt=>{Et.set(Lt.skillId,!0)});const Rt=Math.floor(wt/3600),jt=Math.floor(wt%3600/60),Ot=yt.length?Math.round(wt/yt.length):0,$t=Math.round(Ot/60),Kt=(gt=yt[0])!=null&&gt.created_at?new Date(yt[0].created_at).toLocaleDateString():"-";nt({totalTime:`${Rt}h ${jt}m`,completedScenarios:St.size,skillProgress:ot.data.length>0?Math.min(Math.round(Et.size/ot.data.length*100),100):0,averageSessionDuration:`${$t}m`,uniqueSkillsPracticed:Et.size,totalSessions:Tt,lastSessionDate:Kt,skillBreakdown:xt}),it(!1)}},[ot.data,ct.data,ut.data]),rt)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-screen",children:jsxRuntimeExports.jsx(Spinner,{size:"lg"})})});const pt=_e.filter(gt=>gt.sessionCount>0),dt=pt.length>0?pt.reduce((gt,yt)=>gt+(yt.avgScore||0),0)/pt.length:0,ht=pt.length>0?pt.reduce((gt,yt)=>(yt.avgScore||0)>(gt.avgScore||0)?yt:gt):null,ft=pt.length>1?pt.reduce((gt,yt)=>(yt.avgScore||5)<(gt.avgScore||5)?yt:gt):null,mt=()=>{const gt=_e.filter(yt=>yt.sessionCount===0);if(ft&&ft.frameworkMapping){const yt=gt.filter(vt=>vt.frameworkMapping===ft.frameworkMapping).slice(0,3);if(yt.length>0)return yt}return gt.slice(0,3)};return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsxs("div",{className:"p-6 lg:p-8 max-w-7xl mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 p-8 text-white",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/2 -translate-x-1/2"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome Back!"}),jsxRuntimeExports.jsx("p",{className:"text-white/80 text-lg",children:pt.length>0?`You've practiced ${pt.length} skill${pt.length>1?"s":""} across ${tt.totalSessions} sessions`:"Start your first practice session to track your progress"})]}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",children:jsxRuntimeExports.jsxs(Button,{className:"bg-white text-indigo-600 hover:bg-white/90 px-8 py-3 text-lg font-semibold shadow-lg","data-testid":"button-start-voice-practice",children:[jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 mr-2"}),"Start Practice"]})})]}),pt.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-8 flex flex-wrap gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-6 py-4",children:[jsxRuntimeExports.jsx("p",{className:"text-white/70 text-sm",children:"Average Score"}),jsxRuntimeExports.jsxs("p",{className:"text-3xl font-bold",children:[dt.toFixed(1),jsxRuntimeExports.jsx("span",{className:"text-lg",children:"/5"})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-6 py-4",children:[jsxRuntimeExports.jsx("p",{className:"text-white/70 text-sm",children:"Practice Time"}),jsxRuntimeExports.jsx("p",{className:"text-3xl font-bold",children:tt.totalTime})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-6 py-4",children:[jsxRuntimeExports.jsx("p",{className:"text-white/70 text-sm",children:"Skills Explored"}),jsxRuntimeExports.jsxs("p",{className:"text-3xl font-bold",children:[tt.skillProgress,"%"]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsx(Card,{className:"p-5 border-0 shadow-sm bg-gradient-to-br from-blue-50 to-blue-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-xl bg-blue-500 text-white",children:jsxRuntimeExports.jsx(Clock,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-blue-600 font-medium uppercase tracking-wide",children:"Practice Time"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-blue-900",children:tt.totalTime})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-5 border-0 shadow-sm bg-gradient-to-br from-green-50 to-green-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-xl bg-green-500 text-white",children:jsxRuntimeExports.jsx(Target,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600 font-medium uppercase tracking-wide",children:"Scenarios"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-green-900",children:tt.completedScenarios})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-5 border-0 shadow-sm bg-gradient-to-br from-purple-50 to-purple-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-xl bg-purple-500 text-white",children:jsxRuntimeExports.jsx(Brain,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-purple-600 font-medium uppercase tracking-wide",children:"Skills"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-purple-900",children:tt.uniqueSkillsPracticed})]})]})}),jsxRuntimeExports.jsx(Card,{className:"p-5 border-0 shadow-sm bg-gradient-to-br from-orange-50 to-orange-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-xl bg-orange-500 text-white",children:jsxRuntimeExports.jsx(BarChart3,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-orange-600 font-medium uppercase tracking-wide",children:"Sessions"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-orange-900",children:tt.totalSessions})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[jsxRuntimeExports.jsxs(Card,{className:"p-6 border-0 shadow-sm",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between mb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-indigo-100",children:jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 text-indigo-600"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"What to Practice Next"})]})}),ft&&ft.avgScore!==null?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-amber-500 text-white flex-shrink-0",children:jsxRuntimeExports.jsx(Target,{className:"w-5 h-5"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-700 font-medium mb-1",children:"Recommended Focus"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-amber-900",children:ft.skillName}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-amber-600 mt-1",children:["Your current score is ",ft.avgScore.toFixed(1),"/5. Practice more to improve!"]}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",className:"inline-block mt-3",children:jsxRuntimeExports.jsx(Button,{size:"sm",className:"bg-amber-500 hover:bg-amber-600 text-white",children:"Practice This Skill"})})]})]})}),mt().length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Or try these related skills:"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:mt().slice(0,4).map(gt=>jsxRuntimeExports.jsxs(Link,{to:"/avatar/start",className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 hover:bg-indigo-50 border border-gray-100 hover:border-indigo-200 transition-colors group",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-indigo-700",children:gt.skillName}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-500"})]},gt.skillId))})]})]}):jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-indigo-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(Brain,{className:"w-8 h-8 text-indigo-500"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Start?"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-6 max-w-sm mx-auto",children:"Pick a scenario and start practicing your communication skills with AI avatars"}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",children:jsxRuntimeExports.jsxs(Button,{className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6",children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4 mr-2"}),"Choose a Scenario"]})})]})]}),pt.length>0&&jsxRuntimeExports.jsxs(Card,{className:"p-6 border-0 shadow-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-purple-100",children:jsxRuntimeExports.jsx(BarChart3,{className:"w-5 h-5 text-purple-600"})}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Skills at a Glance"})]}),jsxRuntimeExports.jsxs(Link,{to:"/avatar/results",className:"text-sm text-indigo-600 hover:text-indigo-700 flex items-center gap-1",children:["View Full Analysis ",jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4"})]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:pt.slice(0,6).map(gt=>{var vt;const yt=gt.avgScore!==null?gt.avgScore>=4?"text-green-600 bg-green-50":gt.avgScore>=2.5?"text-amber-600 bg-amber-50":"text-red-600 bg-red-50":"text-gray-500 bg-gray-50";return jsxRuntimeExports.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 border border-gray-100",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 truncate mb-1",children:gt.skillName}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:`text-lg font-bold px-2 py-0.5 rounded ${yt}`,children:((vt=gt.avgScore)==null?void 0:vt.toFixed(1))||"-"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500",children:[gt.sessionCount," sess."]})]})]},gt.skillId)})}),pt.length>6&&jsxRuntimeExports.jsxs(Link,{to:"/avatar/results",className:"block mt-4 text-center text-sm text-indigo-600 hover:text-indigo-700",children:["+",pt.length-6," more skills "]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[ht&&ht.avgScore!==null&&jsxRuntimeExports.jsxs(Card,{className:"p-6 border-0 shadow-sm bg-gradient-to-br from-emerald-50 to-teal-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-emerald-500 text-white",children:jsxRuntimeExports.jsx(Trophy,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-emerald-900",children:"Your Strongest"})]}),jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-emerald-800 mb-1",children:ht.skillName}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-emerald-600",children:["Score: ",ht.avgScore.toFixed(1),"/5"]})]}),jsxRuntimeExports.jsxs(Card,{className:"p-6 border-0 shadow-sm",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Activity"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:"Last Session"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:tt.lastSessionDate})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:"Avg Duration"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:tt.averageSessionDuration})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:"Skills Explored"}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium",children:[tt.skillProgress,"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 pt-4 border-t",children:jsxRuntimeExports.jsxs(Link,{to:"/avatar/results",className:"flex items-center justify-center gap-2 text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:[jsxRuntimeExports.jsx(BarChart3,{className:"w-4 h-4"}),"View Full Results"]})})]}),jsxRuntimeExports.jsxs(Card,{className:"p-6 border-0 shadow-sm bg-gradient-to-br from-indigo-50 to-purple-50",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Start"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Link,{to:"/avatar/start",className:"flex items-center justify-between p-3 rounded-lg bg-white hover:bg-indigo-100 transition-colors group border border-indigo-100",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Browse Scenarios"}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-500"})]}),jsxRuntimeExports.jsxs(Link,{to:"/avatar/practice/custom-scenario",className:"flex items-center justify-between p-3 rounded-lg bg-white hover:bg-purple-100 transition-colors group border border-purple-100",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Create Custom Scenario"}),jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-gray-400 group-hover:text-purple-500"})]})]})]})]})]})]})})}function Badge({className:j,variant:$="default",..._e}){const et={default:"bg-blue-600 text-white",secondary:"bg-slate-100 text-slate-900",destructive:"bg-red-600 text-white",outline:"border border-slate-200 text-slate-900"};return jsxRuntimeExports.jsx("div",{className:cn("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors",et[$],j),..._e})}const Input=reactExports.forwardRef(({className:j,type:$,..._e},et)=>jsxRuntimeExports.jsx("input",{type:$,className:cn("flex h-10 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",j),ref:et,..._e}));Input.displayName="Input";function LoadingSpinner({className:j,size:$="md"}){const _e={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-2",lg:"w-12 h-12 border-3"};return jsxRuntimeExports.jsx("div",{className:cn("animate-spin rounded-full border-slate-200 border-t-blue-600",_e[$],j)})}function clamp$2(j,[$,_e]){return Math.min(_e,Math.max($,j))}function composeEventHandlers$1(j,$,{checkForDefaultPrevented:_e=!0}={}){return function(tt){if(j==null||j(tt),_e===!1||!tt.defaultPrevented)return $==null?void 0:$(tt)}}function createContextScope$1(j,$=[]){let _e=[];function et(nt,rt){const it=reactExports.createContext(rt),st=_e.length;_e=[..._e,rt];const at=ct=>{var ft;const{scope:lt,children:ut,...pt}=ct,dt=((ft=lt==null?void 0:lt[j])==null?void 0:ft[st])||it,ht=reactExports.useMemo(()=>pt,Object.values(pt));return jsxRuntimeExports.jsx(dt.Provider,{value:ht,children:ut})};at.displayName=nt+"Provider";function ot(ct,lt){var dt;const ut=((dt=lt==null?void 0:lt[j])==null?void 0:dt[st])||it,pt=reactExports.useContext(ut);if(pt)return pt;if(rt!==void 0)return rt;throw new Error(`\`${ct}\` must be used within \`${nt}\``)}return[at,ot]}const tt=()=>{const nt=_e.map(rt=>reactExports.createContext(rt));return function(it){const st=(it==null?void 0:it[j])||nt;return reactExports.useMemo(()=>({[`__scope${j}`]:{...it,[j]:st}}),[it,st])}};return tt.scopeName=j,[et,composeContextScopes$1(tt,...$)]}function composeContextScopes$1(...j){const $=j[0];if(j.length===1)return $;const _e=()=>{const et=j.map(tt=>({useScope:tt(),scopeName:tt.scopeName}));return function(nt){const rt=et.reduce((it,{useScope:st,scopeName:at})=>{const ct=st(nt)[`__scope${at}`];return{...it,...ct}},{});return reactExports.useMemo(()=>({[`__scope${$.scopeName}`]:rt}),[rt])}};return _e.scopeName=$.scopeName,_e}function setRef$2(j,$){if(typeof j=="function")return j($);j!=null&&(j.current=$)}function composeRefs$2(...j){return $=>{let _e=!1;const et=j.map(tt=>{const nt=setRef$2(tt,$);return!_e&&typeof nt=="function"&&(_e=!0),nt});if(_e)return()=>{for(let tt=0;tt<et.length;tt++){const nt=et[tt];typeof nt=="function"?nt():setRef$2(j[tt],null)}}}}function useComposedRefs$2(...j){return reactExports.useCallback(composeRefs$2(...j),j)}function createSlot$5(j){const $=createSlotClone$5(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable$5);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone$5(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$6(tt),it=mergeProps$5(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs$2(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER$5=Symbol("radix.slottable");function isSlottable$5(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER$5}function mergeProps$5(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$6(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}function createCollection$1(j){const $=j+"CollectionProvider",[_e,et]=createContextScope$1($),[tt,nt]=_e($,{collectionRef:{current:null},itemMap:new Map}),rt=dt=>{const{scope:ht,children:ft}=dt,mt=React$4.useRef(null),gt=React$4.useRef(new Map).current;return jsxRuntimeExports.jsx(tt,{scope:ht,itemMap:gt,collectionRef:mt,children:ft})};rt.displayName=$;const it=j+"CollectionSlot",st=createSlot$5(it),at=React$4.forwardRef((dt,ht)=>{const{scope:ft,children:mt}=dt,gt=nt(it,ft),yt=useComposedRefs$2(ht,gt.collectionRef);return jsxRuntimeExports.jsx(st,{ref:yt,children:mt})});at.displayName=it;const ot=j+"CollectionItemSlot",ct="data-radix-collection-item",lt=createSlot$5(ot),ut=React$4.forwardRef((dt,ht)=>{const{scope:ft,children:mt,...gt}=dt,yt=React$4.useRef(null),vt=useComposedRefs$2(ht,yt),xt=nt(ot,ft);return React$4.useEffect(()=>(xt.itemMap.set(yt,{ref:yt,...gt}),()=>void xt.itemMap.delete(yt))),jsxRuntimeExports.jsx(lt,{[ct]:"",ref:vt,children:mt})});ut.displayName=ot;function pt(dt){const ht=nt(j+"CollectionConsumer",dt);return React$4.useCallback(()=>{const mt=ht.collectionRef.current;if(!mt)return[];const gt=Array.from(mt.querySelectorAll(`[${ct}]`));return Array.from(ht.itemMap.values()).sort((xt,St)=>gt.indexOf(xt.ref.current)-gt.indexOf(St.ref.current))},[ht.collectionRef,ht.itemMap])}return[{Provider:rt,Slot:at,ItemSlot:ut},pt,et]}var DirectionContext$1=reactExports.createContext(void 0);function useDirection$1(j){const $=reactExports.useContext(DirectionContext$1);return j||$||"ltr"}function createSlot$4(j){const $=createSlotClone$4(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable$4);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone$4(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$5(tt),it=mergeProps$4(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs$2(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER$4=Symbol("radix.slottable");function isSlottable$4(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER$4}function mergeProps$4(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$5(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}var NODES$2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive$2=NODES$2.reduce((j,$)=>{const _e=createSlot$4(`Primitive.${$}`),et=reactExports.forwardRef((tt,nt)=>{const{asChild:rt,...it}=tt,st=rt?_e:$;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(st,{...it,ref:nt})});return et.displayName=`Primitive.${$}`,{...j,[$]:et}},{});function dispatchDiscreteCustomEvent(j,$){j&&reactDomExports.flushSync(()=>j.dispatchEvent($))}function useCallbackRef$1(j){const $=reactExports.useRef(j);return reactExports.useEffect(()=>{$.current=j}),reactExports.useMemo(()=>(..._e)=>{var et;return(et=$.current)==null?void 0:et.call($,..._e)},[])}function useEscapeKeydown(j,$=globalThis==null?void 0:globalThis.document){const _e=useCallbackRef$1(j);reactExports.useEffect(()=>{const et=tt=>{tt.key==="Escape"&&_e(tt)};return $.addEventListener("keydown",et,{capture:!0}),()=>$.removeEventListener("keydown",et,{capture:!0})},[_e,$])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((j,$)=>{const{disableOutsidePointerEvents:_e=!1,onEscapeKeyDown:et,onPointerDownOutside:tt,onFocusOutside:nt,onInteractOutside:rt,onDismiss:it,...st}=j,at=reactExports.useContext(DismissableLayerContext),[ot,ct]=reactExports.useState(null),lt=(ot==null?void 0:ot.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,ut]=reactExports.useState({}),pt=useComposedRefs$2($,St=>ct(St)),dt=Array.from(at.layers),[ht]=[...at.layersWithOutsidePointerEventsDisabled].slice(-1),ft=dt.indexOf(ht),mt=ot?dt.indexOf(ot):-1,gt=at.layersWithOutsidePointerEventsDisabled.size>0,yt=mt>=ft,vt=usePointerDownOutside(St=>{const Et=St.target,wt=[...at.branches].some(Tt=>Tt.contains(Et));!yt||wt||(tt==null||tt(St),rt==null||rt(St),St.defaultPrevented||it==null||it())},lt),xt=useFocusOutside(St=>{const Et=St.target;[...at.branches].some(Tt=>Tt.contains(Et))||(nt==null||nt(St),rt==null||rt(St),St.defaultPrevented||it==null||it())},lt);return useEscapeKeydown(St=>{mt===at.layers.size-1&&(et==null||et(St),!St.defaultPrevented&&it&&(St.preventDefault(),it()))},lt),reactExports.useEffect(()=>{if(ot)return _e&&(at.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=lt.body.style.pointerEvents,lt.body.style.pointerEvents="none"),at.layersWithOutsidePointerEventsDisabled.add(ot)),at.layers.add(ot),dispatchUpdate(),()=>{_e&&at.layersWithOutsidePointerEventsDisabled.size===1&&(lt.body.style.pointerEvents=originalBodyPointerEvents)}},[ot,lt,_e,at]),reactExports.useEffect(()=>()=>{ot&&(at.layers.delete(ot),at.layersWithOutsidePointerEventsDisabled.delete(ot),dispatchUpdate())},[ot,at]),reactExports.useEffect(()=>{const St=()=>ut({});return document.addEventListener(CONTEXT_UPDATE,St),()=>document.removeEventListener(CONTEXT_UPDATE,St)},[]),jsxRuntimeExports.jsx(Primitive$2.div,{...st,ref:pt,style:{pointerEvents:gt?yt?"auto":"none":void 0,...j.style},onFocusCapture:composeEventHandlers$1(j.onFocusCapture,xt.onFocusCapture),onBlurCapture:composeEventHandlers$1(j.onBlurCapture,xt.onBlurCapture),onPointerDownCapture:composeEventHandlers$1(j.onPointerDownCapture,vt.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((j,$)=>{const _e=reactExports.useContext(DismissableLayerContext),et=reactExports.useRef(null),tt=useComposedRefs$2($,et);return reactExports.useEffect(()=>{const nt=et.current;if(nt)return _e.branches.add(nt),()=>{_e.branches.delete(nt)}},[_e.branches]),jsxRuntimeExports.jsx(Primitive$2.div,{...j,ref:tt})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(j,$=globalThis==null?void 0:globalThis.document){const _e=useCallbackRef$1(j),et=reactExports.useRef(!1),tt=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const nt=it=>{if(it.target&&!et.current){let st=function(){handleAndDispatchCustomEvent(POINTER_DOWN_OUTSIDE,_e,at,{discrete:!0})};const at={originalEvent:it};it.pointerType==="touch"?($.removeEventListener("click",tt.current),tt.current=st,$.addEventListener("click",tt.current,{once:!0})):st()}else $.removeEventListener("click",tt.current);et.current=!1},rt=window.setTimeout(()=>{$.addEventListener("pointerdown",nt)},0);return()=>{window.clearTimeout(rt),$.removeEventListener("pointerdown",nt),$.removeEventListener("click",tt.current)}},[$,_e]),{onPointerDownCapture:()=>et.current=!0}}function useFocusOutside(j,$=globalThis==null?void 0:globalThis.document){const _e=useCallbackRef$1(j),et=reactExports.useRef(!1);return reactExports.useEffect(()=>{const tt=nt=>{nt.target&&!et.current&&handleAndDispatchCustomEvent(FOCUS_OUTSIDE,_e,{originalEvent:nt},{discrete:!1})};return $.addEventListener("focusin",tt),()=>$.removeEventListener("focusin",tt)},[$,_e]),{onFocusCapture:()=>et.current=!0,onBlurCapture:()=>et.current=!1}}function dispatchUpdate(){const j=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(j)}function handleAndDispatchCustomEvent(j,$,_e,{discrete:et}){const tt=_e.originalEvent.target,nt=new CustomEvent(j,{bubbles:!1,cancelable:!0,detail:_e});$&&tt.addEventListener(j,$,{once:!0}),et?dispatchDiscreteCustomEvent(tt,nt):tt.dispatchEvent(nt)}var count$2=0;function useFocusGuards(){reactExports.useEffect(()=>{const j=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",j[0]??createFocusGuard()),document.body.insertAdjacentElement("beforeend",j[1]??createFocusGuard()),count$2++,()=>{count$2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach($=>$.remove()),count$2--}},[])}function createFocusGuard(){const j=document.createElement("span");return j.setAttribute("data-radix-focus-guard",""),j.tabIndex=0,j.style.outline="none",j.style.opacity="0",j.style.position="fixed",j.style.pointerEvents="none",j}var AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS={bubbles:!1,cancelable:!0},FOCUS_SCOPE_NAME="FocusScope",FocusScope=reactExports.forwardRef((j,$)=>{const{loop:_e=!1,trapped:et=!1,onMountAutoFocus:tt,onUnmountAutoFocus:nt,...rt}=j,[it,st]=reactExports.useState(null),at=useCallbackRef$1(tt),ot=useCallbackRef$1(nt),ct=reactExports.useRef(null),lt=useComposedRefs$2($,dt=>st(dt)),ut=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(et){let dt=function(gt){if(ut.paused||!it)return;const yt=gt.target;it.contains(yt)?ct.current=yt:focus(ct.current,{select:!0})},ht=function(gt){if(ut.paused||!it)return;const yt=gt.relatedTarget;yt!==null&&(it.contains(yt)||focus(ct.current,{select:!0}))},ft=function(gt){if(document.activeElement===document.body)for(const vt of gt)vt.removedNodes.length>0&&focus(it)};document.addEventListener("focusin",dt),document.addEventListener("focusout",ht);const mt=new MutationObserver(ft);return it&&mt.observe(it,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",dt),document.removeEventListener("focusout",ht),mt.disconnect()}}},[et,it,ut.paused]),reactExports.useEffect(()=>{if(it){focusScopesStack.add(ut);const dt=document.activeElement;if(!it.contains(dt)){const ft=new CustomEvent(AUTOFOCUS_ON_MOUNT,EVENT_OPTIONS);it.addEventListener(AUTOFOCUS_ON_MOUNT,at),it.dispatchEvent(ft),ft.defaultPrevented||(focusFirst(removeLinks(getTabbableCandidates(it)),{select:!0}),document.activeElement===dt&&focus(it))}return()=>{it.removeEventListener(AUTOFOCUS_ON_MOUNT,at),setTimeout(()=>{const ft=new CustomEvent(AUTOFOCUS_ON_UNMOUNT,EVENT_OPTIONS);it.addEventListener(AUTOFOCUS_ON_UNMOUNT,ot),it.dispatchEvent(ft),ft.defaultPrevented||focus(dt??document.body,{select:!0}),it.removeEventListener(AUTOFOCUS_ON_UNMOUNT,ot),focusScopesStack.remove(ut)},0)}}},[it,at,ot,ut]);const pt=reactExports.useCallback(dt=>{if(!_e&&!et||ut.paused)return;const ht=dt.key==="Tab"&&!dt.altKey&&!dt.ctrlKey&&!dt.metaKey,ft=document.activeElement;if(ht&&ft){const mt=dt.currentTarget,[gt,yt]=getTabbableEdges(mt);gt&&yt?!dt.shiftKey&&ft===yt?(dt.preventDefault(),_e&&focus(gt,{select:!0})):dt.shiftKey&&ft===gt&&(dt.preventDefault(),_e&&focus(yt,{select:!0})):ft===mt&&dt.preventDefault()}},[_e,et,ut.paused]);return jsxRuntimeExports.jsx(Primitive$2.div,{tabIndex:-1,...rt,ref:lt,onKeyDown:pt})});FocusScope.displayName=FOCUS_SCOPE_NAME;function focusFirst(j,{select:$=!1}={}){const _e=document.activeElement;for(const et of j)if(focus(et,{select:$}),document.activeElement!==_e)return}function getTabbableEdges(j){const $=getTabbableCandidates(j),_e=findVisible($,j),et=findVisible($.reverse(),j);return[_e,et]}function getTabbableCandidates(j){const $=[],_e=document.createTreeWalker(j,NodeFilter.SHOW_ELEMENT,{acceptNode:et=>{const tt=et.tagName==="INPUT"&&et.type==="hidden";return et.disabled||et.hidden||tt?NodeFilter.FILTER_SKIP:et.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;_e.nextNode();)$.push(_e.currentNode);return $}function findVisible(j,$){for(const _e of j)if(!isHidden(_e,{upTo:$}))return _e}function isHidden(j,{upTo:$}){if(getComputedStyle(j).visibility==="hidden")return!0;for(;j;){if($!==void 0&&j===$)return!1;if(getComputedStyle(j).display==="none")return!0;j=j.parentElement}return!1}function isSelectableInput(j){return j instanceof HTMLInputElement&&"select"in j}function focus(j,{select:$=!1}={}){if(j&&j.focus){const _e=document.activeElement;j.focus({preventScroll:!0}),j!==_e&&isSelectableInput(j)&&$&&j.select()}}var focusScopesStack=createFocusScopesStack();function createFocusScopesStack(){let j=[];return{add($){const _e=j[0];$!==_e&&(_e==null||_e.pause()),j=arrayRemove(j,$),j.unshift($)},remove($){var _e;j=arrayRemove(j,$),(_e=j[0])==null||_e.resume()}}}function arrayRemove(j,$){const _e=[...j],et=_e.indexOf($);return et!==-1&&_e.splice(et,1),_e}function removeLinks(j){return j.filter($=>$.tagName!=="A")}var useLayoutEffect2$1=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},useReactId$1=React$5[" useId ".trim().toString()]||(()=>{}),count$1=0;function useId$2(j){const[$,_e]=reactExports.useState(useReactId$1());return useLayoutEffect2$1(()=>{_e(et=>et??String(count$1++))},[j]),$?`radix-${$}`:""}const sides=["top","right","bottom","left"],min$1=Math.min,max$1=Math.max,round$1=Math.round,floor=Math.floor,createCoords=j=>({x:j,y:j}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$1(j,$,_e){return max$1(j,min$1($,_e))}function evaluate(j,$){return typeof j=="function"?j($):j}function getSide(j){return j.split("-")[0]}function getAlignment(j){return j.split("-")[1]}function getOppositeAxis(j){return j==="x"?"y":"x"}function getAxisLength(j){return j==="y"?"height":"width"}const yAxisSides=new Set(["top","bottom"]);function getSideAxis(j){return yAxisSides.has(getSide(j))?"y":"x"}function getAlignmentAxis(j){return getOppositeAxis(getSideAxis(j))}function getAlignmentSides(j,$,_e){_e===void 0&&(_e=!1);const et=getAlignment(j),tt=getAlignmentAxis(j),nt=getAxisLength(tt);let rt=tt==="x"?et===(_e?"end":"start")?"right":"left":et==="start"?"bottom":"top";return $.reference[nt]>$.floating[nt]&&(rt=getOppositePlacement(rt)),[rt,getOppositePlacement(rt)]}function getExpandedPlacements(j){const $=getOppositePlacement(j);return[getOppositeAlignmentPlacement(j),$,getOppositeAlignmentPlacement($)]}function getOppositeAlignmentPlacement(j){return j.replace(/start|end/g,$=>oppositeAlignmentMap[$])}const lrPlacement=["left","right"],rlPlacement=["right","left"],tbPlacement=["top","bottom"],btPlacement=["bottom","top"];function getSideList(j,$,_e){switch(j){case"top":case"bottom":return _e?$?rlPlacement:lrPlacement:$?lrPlacement:rlPlacement;case"left":case"right":return $?tbPlacement:btPlacement;default:return[]}}function getOppositeAxisPlacements(j,$,_e,et){const tt=getAlignment(j);let nt=getSideList(getSide(j),_e==="start",et);return tt&&(nt=nt.map(rt=>rt+"-"+tt),$&&(nt=nt.concat(nt.map(getOppositeAlignmentPlacement)))),nt}function getOppositePlacement(j){return j.replace(/left|right|bottom|top/g,$=>oppositeSideMap[$])}function expandPaddingObject(j){return{top:0,right:0,bottom:0,left:0,...j}}function getPaddingObject(j){return typeof j!="number"?expandPaddingObject(j):{top:j,right:j,bottom:j,left:j}}function rectToClientRect(j){const{x:$,y:_e,width:et,height:tt}=j;return{width:et,height:tt,top:_e,left:$,right:$+et,bottom:_e+tt,x:$,y:_e}}function computeCoordsFromPlacement(j,$,_e){let{reference:et,floating:tt}=j;const nt=getSideAxis($),rt=getAlignmentAxis($),it=getAxisLength(rt),st=getSide($),at=nt==="y",ot=et.x+et.width/2-tt.width/2,ct=et.y+et.height/2-tt.height/2,lt=et[it]/2-tt[it]/2;let ut;switch(st){case"top":ut={x:ot,y:et.y-tt.height};break;case"bottom":ut={x:ot,y:et.y+et.height};break;case"right":ut={x:et.x+et.width,y:ct};break;case"left":ut={x:et.x-tt.width,y:ct};break;default:ut={x:et.x,y:et.y}}switch(getAlignment($)){case"start":ut[rt]-=lt*(_e&&at?-1:1);break;case"end":ut[rt]+=lt*(_e&&at?-1:1);break}return ut}const computePosition$1=async(j,$,_e)=>{const{placement:et="bottom",strategy:tt="absolute",middleware:nt=[],platform:rt}=_e,it=nt.filter(Boolean),st=await(rt.isRTL==null?void 0:rt.isRTL($));let at=await rt.getElementRects({reference:j,floating:$,strategy:tt}),{x:ot,y:ct}=computeCoordsFromPlacement(at,et,st),lt=et,ut={},pt=0;for(let dt=0;dt<it.length;dt++){const{name:ht,fn:ft}=it[dt],{x:mt,y:gt,data:yt,reset:vt}=await ft({x:ot,y:ct,initialPlacement:et,placement:lt,strategy:tt,middlewareData:ut,rects:at,platform:rt,elements:{reference:j,floating:$}});ot=mt??ot,ct=gt??ct,ut={...ut,[ht]:{...ut[ht],...yt}},vt&&pt<=50&&(pt++,typeof vt=="object"&&(vt.placement&&(lt=vt.placement),vt.rects&&(at=vt.rects===!0?await rt.getElementRects({reference:j,floating:$,strategy:tt}):vt.rects),{x:ot,y:ct}=computeCoordsFromPlacement(at,lt,st)),dt=-1)}return{x:ot,y:ct,placement:lt,strategy:tt,middlewareData:ut}};async function detectOverflow(j,$){var _e;$===void 0&&($={});const{x:et,y:tt,platform:nt,rects:rt,elements:it,strategy:st}=j,{boundary:at="clippingAncestors",rootBoundary:ot="viewport",elementContext:ct="floating",altBoundary:lt=!1,padding:ut=0}=evaluate($,j),pt=getPaddingObject(ut),ht=it[lt?ct==="floating"?"reference":"floating":ct],ft=rectToClientRect(await nt.getClippingRect({element:(_e=await(nt.isElement==null?void 0:nt.isElement(ht)))==null||_e?ht:ht.contextElement||await(nt.getDocumentElement==null?void 0:nt.getDocumentElement(it.floating)),boundary:at,rootBoundary:ot,strategy:st})),mt=ct==="floating"?{x:et,y:tt,width:rt.floating.width,height:rt.floating.height}:rt.reference,gt=await(nt.getOffsetParent==null?void 0:nt.getOffsetParent(it.floating)),yt=await(nt.isElement==null?void 0:nt.isElement(gt))?await(nt.getScale==null?void 0:nt.getScale(gt))||{x:1,y:1}:{x:1,y:1},vt=rectToClientRect(nt.convertOffsetParentRelativeRectToViewportRelativeRect?await nt.convertOffsetParentRelativeRectToViewportRelativeRect({elements:it,rect:mt,offsetParent:gt,strategy:st}):mt);return{top:(ft.top-vt.top+pt.top)/yt.y,bottom:(vt.bottom-ft.bottom+pt.bottom)/yt.y,left:(ft.left-vt.left+pt.left)/yt.x,right:(vt.right-ft.right+pt.right)/yt.x}}const arrow$3=j=>({name:"arrow",options:j,async fn($){const{x:_e,y:et,placement:tt,rects:nt,platform:rt,elements:it,middlewareData:st}=$,{element:at,padding:ot=0}=evaluate(j,$)||{};if(at==null)return{};const ct=getPaddingObject(ot),lt={x:_e,y:et},ut=getAlignmentAxis(tt),pt=getAxisLength(ut),dt=await rt.getDimensions(at),ht=ut==="y",ft=ht?"top":"left",mt=ht?"bottom":"right",gt=ht?"clientHeight":"clientWidth",yt=nt.reference[pt]+nt.reference[ut]-lt[ut]-nt.floating[pt],vt=lt[ut]-nt.reference[ut],xt=await(rt.getOffsetParent==null?void 0:rt.getOffsetParent(at));let St=xt?xt[gt]:0;(!St||!await(rt.isElement==null?void 0:rt.isElement(xt)))&&(St=it.floating[gt]||nt.floating[pt]);const Et=yt/2-vt/2,wt=St/2-dt[pt]/2-1,Tt=min$1(ct[ft],wt),Ct=min$1(ct[mt],wt),Rt=Tt,jt=St-dt[pt]-Ct,Ot=St/2-dt[pt]/2+Et,$t=clamp$1(Rt,Ot,jt),Kt=!st.arrow&&getAlignment(tt)!=null&&Ot!==$t&&nt.reference[pt]/2-(Ot<Rt?Tt:Ct)-dt[pt]/2<0,Lt=Kt?Ot<Rt?Ot-Rt:Ot-jt:0;return{[ut]:lt[ut]+Lt,data:{[ut]:$t,centerOffset:Ot-$t-Lt,...Kt&&{alignmentOffset:Lt}},reset:Kt}}}),flip$2=function(j){return j===void 0&&(j={}),{name:"flip",options:j,async fn($){var _e,et;const{placement:tt,middlewareData:nt,rects:rt,initialPlacement:it,platform:st,elements:at}=$,{mainAxis:ot=!0,crossAxis:ct=!0,fallbackPlacements:lt,fallbackStrategy:ut="bestFit",fallbackAxisSideDirection:pt="none",flipAlignment:dt=!0,...ht}=evaluate(j,$);if((_e=nt.arrow)!=null&&_e.alignmentOffset)return{};const ft=getSide(tt),mt=getSideAxis(it),gt=getSide(it)===it,yt=await(st.isRTL==null?void 0:st.isRTL(at.floating)),vt=lt||(gt||!dt?[getOppositePlacement(it)]:getExpandedPlacements(it)),xt=pt!=="none";!lt&&xt&&vt.push(...getOppositeAxisPlacements(it,dt,pt,yt));const St=[it,...vt],Et=await detectOverflow($,ht),wt=[];let Tt=((et=nt.flip)==null?void 0:et.overflows)||[];if(ot&&wt.push(Et[ft]),ct){const Ot=getAlignmentSides(tt,rt,yt);wt.push(Et[Ot[0]],Et[Ot[1]])}if(Tt=[...Tt,{placement:tt,overflows:wt}],!wt.every(Ot=>Ot<=0)){var Ct,Rt;const Ot=(((Ct=nt.flip)==null?void 0:Ct.index)||0)+1,$t=St[Ot];if($t&&(!(ct==="alignment"?mt!==getSideAxis($t):!1)||Tt.every(Nt=>getSideAxis(Nt.placement)===mt?Nt.overflows[0]>0:!0)))return{data:{index:Ot,overflows:Tt},reset:{placement:$t}};let Kt=(Rt=Tt.filter(Lt=>Lt.overflows[0]<=0).sort((Lt,Nt)=>Lt.overflows[1]-Nt.overflows[1])[0])==null?void 0:Rt.placement;if(!Kt)switch(ut){case"bestFit":{var jt;const Lt=(jt=Tt.filter(Nt=>{if(xt){const Bt=getSideAxis(Nt.placement);return Bt===mt||Bt==="y"}return!0}).map(Nt=>[Nt.placement,Nt.overflows.filter(Bt=>Bt>0).reduce((Bt,kt)=>Bt+kt,0)]).sort((Nt,Bt)=>Nt[1]-Bt[1])[0])==null?void 0:jt[0];Lt&&(Kt=Lt);break}case"initialPlacement":Kt=it;break}if(tt!==Kt)return{reset:{placement:Kt}}}return{}}}};function getSideOffsets(j,$){return{top:j.top-$.height,right:j.right-$.width,bottom:j.bottom-$.height,left:j.left-$.width}}function isAnySideFullyClipped(j){return sides.some($=>j[$]>=0)}const hide$2=function(j){return j===void 0&&(j={}),{name:"hide",options:j,async fn($){const{rects:_e}=$,{strategy:et="referenceHidden",...tt}=evaluate(j,$);switch(et){case"referenceHidden":{const nt=await detectOverflow($,{...tt,elementContext:"reference"}),rt=getSideOffsets(nt,_e.reference);return{data:{referenceHiddenOffsets:rt,referenceHidden:isAnySideFullyClipped(rt)}}}case"escaped":{const nt=await detectOverflow($,{...tt,altBoundary:!0}),rt=getSideOffsets(nt,_e.floating);return{data:{escapedOffsets:rt,escaped:isAnySideFullyClipped(rt)}}}default:return{}}}}},originSides=new Set(["left","top"]);async function convertValueToCoords(j,$){const{placement:_e,platform:et,elements:tt}=j,nt=await(et.isRTL==null?void 0:et.isRTL(tt.floating)),rt=getSide(_e),it=getAlignment(_e),st=getSideAxis(_e)==="y",at=originSides.has(rt)?-1:1,ot=nt&&st?-1:1,ct=evaluate($,j);let{mainAxis:lt,crossAxis:ut,alignmentAxis:pt}=typeof ct=="number"?{mainAxis:ct,crossAxis:0,alignmentAxis:null}:{mainAxis:ct.mainAxis||0,crossAxis:ct.crossAxis||0,alignmentAxis:ct.alignmentAxis};return it&&typeof pt=="number"&&(ut=it==="end"?pt*-1:pt),st?{x:ut*ot,y:lt*at}:{x:lt*at,y:ut*ot}}const offset$2=function(j){return j===void 0&&(j=0),{name:"offset",options:j,async fn($){var _e,et;const{x:tt,y:nt,placement:rt,middlewareData:it}=$,st=await convertValueToCoords($,j);return rt===((_e=it.offset)==null?void 0:_e.placement)&&(et=it.arrow)!=null&&et.alignmentOffset?{}:{x:tt+st.x,y:nt+st.y,data:{...st,placement:rt}}}}},shift$2=function(j){return j===void 0&&(j={}),{name:"shift",options:j,async fn($){const{x:_e,y:et,placement:tt}=$,{mainAxis:nt=!0,crossAxis:rt=!1,limiter:it={fn:ht=>{let{x:ft,y:mt}=ht;return{x:ft,y:mt}}},...st}=evaluate(j,$),at={x:_e,y:et},ot=await detectOverflow($,st),ct=getSideAxis(getSide(tt)),lt=getOppositeAxis(ct);let ut=at[lt],pt=at[ct];if(nt){const ht=lt==="y"?"top":"left",ft=lt==="y"?"bottom":"right",mt=ut+ot[ht],gt=ut-ot[ft];ut=clamp$1(mt,ut,gt)}if(rt){const ht=ct==="y"?"top":"left",ft=ct==="y"?"bottom":"right",mt=pt+ot[ht],gt=pt-ot[ft];pt=clamp$1(mt,pt,gt)}const dt=it.fn({...$,[lt]:ut,[ct]:pt});return{...dt,data:{x:dt.x-_e,y:dt.y-et,enabled:{[lt]:nt,[ct]:rt}}}}}},limitShift$2=function(j){return j===void 0&&(j={}),{options:j,fn($){const{x:_e,y:et,placement:tt,rects:nt,middlewareData:rt}=$,{offset:it=0,mainAxis:st=!0,crossAxis:at=!0}=evaluate(j,$),ot={x:_e,y:et},ct=getSideAxis(tt),lt=getOppositeAxis(ct);let ut=ot[lt],pt=ot[ct];const dt=evaluate(it,$),ht=typeof dt=="number"?{mainAxis:dt,crossAxis:0}:{mainAxis:0,crossAxis:0,...dt};if(st){const gt=lt==="y"?"height":"width",yt=nt.reference[lt]-nt.floating[gt]+ht.mainAxis,vt=nt.reference[lt]+nt.reference[gt]-ht.mainAxis;ut<yt?ut=yt:ut>vt&&(ut=vt)}if(at){var ft,mt;const gt=lt==="y"?"width":"height",yt=originSides.has(getSide(tt)),vt=nt.reference[ct]-nt.floating[gt]+(yt&&((ft=rt.offset)==null?void 0:ft[ct])||0)+(yt?0:ht.crossAxis),xt=nt.reference[ct]+nt.reference[gt]+(yt?0:((mt=rt.offset)==null?void 0:mt[ct])||0)-(yt?ht.crossAxis:0);pt<vt?pt=vt:pt>xt&&(pt=xt)}return{[lt]:ut,[ct]:pt}}}},size$2=function(j){return j===void 0&&(j={}),{name:"size",options:j,async fn($){var _e,et;const{placement:tt,rects:nt,platform:rt,elements:it}=$,{apply:st=()=>{},...at}=evaluate(j,$),ot=await detectOverflow($,at),ct=getSide(tt),lt=getAlignment(tt),ut=getSideAxis(tt)==="y",{width:pt,height:dt}=nt.floating;let ht,ft;ct==="top"||ct==="bottom"?(ht=ct,ft=lt===(await(rt.isRTL==null?void 0:rt.isRTL(it.floating))?"start":"end")?"left":"right"):(ft=ct,ht=lt==="end"?"top":"bottom");const mt=dt-ot.top-ot.bottom,gt=pt-ot.left-ot.right,yt=min$1(dt-ot[ht],mt),vt=min$1(pt-ot[ft],gt),xt=!$.middlewareData.shift;let St=yt,Et=vt;if((_e=$.middlewareData.shift)!=null&&_e.enabled.x&&(Et=gt),(et=$.middlewareData.shift)!=null&&et.enabled.y&&(St=mt),xt&&!lt){const Tt=max$1(ot.left,0),Ct=max$1(ot.right,0),Rt=max$1(ot.top,0),jt=max$1(ot.bottom,0);ut?Et=pt-2*(Tt!==0||Ct!==0?Tt+Ct:max$1(ot.left,ot.right)):St=dt-2*(Rt!==0||jt!==0?Rt+jt:max$1(ot.top,ot.bottom))}await st({...$,availableWidth:Et,availableHeight:St});const wt=await rt.getDimensions(it.floating);return pt!==wt.width||dt!==wt.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(j){return isNode(j)?(j.nodeName||"").toLowerCase():"#document"}function getWindow(j){var $;return(j==null||($=j.ownerDocument)==null?void 0:$.defaultView)||window}function getDocumentElement(j){var $;return($=(isNode(j)?j.ownerDocument:j.document)||window.document)==null?void 0:$.documentElement}function isNode(j){return hasWindow()?j instanceof Node||j instanceof getWindow(j).Node:!1}function isElement(j){return hasWindow()?j instanceof Element||j instanceof getWindow(j).Element:!1}function isHTMLElement$1(j){return hasWindow()?j instanceof HTMLElement||j instanceof getWindow(j).HTMLElement:!1}function isShadowRoot(j){return!hasWindow()||typeof ShadowRoot>"u"?!1:j instanceof ShadowRoot||j instanceof getWindow(j).ShadowRoot}const invalidOverflowDisplayValues=new Set(["inline","contents"]);function isOverflowElement(j){const{overflow:$,overflowX:_e,overflowY:et,display:tt}=getComputedStyle$2(j);return/auto|scroll|overlay|hidden|clip/.test($+et+_e)&&!invalidOverflowDisplayValues.has(tt)}const tableElements$1=new Set(["table","td","th"]);function isTableElement(j){return tableElements$1.has(getNodeName(j))}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(j){return topLayerSelectors.some($=>{try{return j.matches($)}catch{return!1}})}const transformProperties=["transform","translate","scale","rotate","perspective"],willChangeValues=["transform","translate","scale","rotate","perspective","filter"],containValues=["paint","layout","strict","content"];function isContainingBlock(j){const $=isWebKit(),_e=isElement(j)?getComputedStyle$2(j):j;return transformProperties.some(et=>_e[et]?_e[et]!=="none":!1)||(_e.containerType?_e.containerType!=="normal":!1)||!$&&(_e.backdropFilter?_e.backdropFilter!=="none":!1)||!$&&(_e.filter?_e.filter!=="none":!1)||willChangeValues.some(et=>(_e.willChange||"").includes(et))||containValues.some(et=>(_e.contain||"").includes(et))}function getContainingBlock(j){let $=getParentNode(j);for(;isHTMLElement$1($)&&!isLastTraversableNode($);){if(isContainingBlock($))return $;if(isTopLayer($))return null;$=getParentNode($)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lastTraversableNodeNames=new Set(["html","body","#document"]);function isLastTraversableNode(j){return lastTraversableNodeNames.has(getNodeName(j))}function getComputedStyle$2(j){return getWindow(j).getComputedStyle(j)}function getNodeScroll(j){return isElement(j)?{scrollLeft:j.scrollLeft,scrollTop:j.scrollTop}:{scrollLeft:j.scrollX,scrollTop:j.scrollY}}function getParentNode(j){if(getNodeName(j)==="html")return j;const $=j.assignedSlot||j.parentNode||isShadowRoot(j)&&j.host||getDocumentElement(j);return isShadowRoot($)?$.host:$}function getNearestOverflowAncestor(j){const $=getParentNode(j);return isLastTraversableNode($)?j.ownerDocument?j.ownerDocument.body:j.body:isHTMLElement$1($)&&isOverflowElement($)?$:getNearestOverflowAncestor($)}function getOverflowAncestors(j,$,_e){var et;$===void 0&&($=[]),_e===void 0&&(_e=!0);const tt=getNearestOverflowAncestor(j),nt=tt===((et=j.ownerDocument)==null?void 0:et.body),rt=getWindow(tt);if(nt){const it=getFrameElement(rt);return $.concat(rt,rt.visualViewport||[],isOverflowElement(tt)?tt:[],it&&_e?getOverflowAncestors(it):[])}return $.concat(tt,getOverflowAncestors(tt,[],_e))}function getFrameElement(j){return j.parent&&Object.getPrototypeOf(j.parent)?j.frameElement:null}function getCssDimensions(j){const $=getComputedStyle$2(j);let _e=parseFloat($.width)||0,et=parseFloat($.height)||0;const tt=isHTMLElement$1(j),nt=tt?j.offsetWidth:_e,rt=tt?j.offsetHeight:et,it=round$1(_e)!==nt||round$1(et)!==rt;return it&&(_e=nt,et=rt),{width:_e,height:et,$:it}}function unwrapElement(j){return isElement(j)?j:j.contextElement}function getScale(j){const $=unwrapElement(j);if(!isHTMLElement$1($))return createCoords(1);const _e=$.getBoundingClientRect(),{width:et,height:tt,$:nt}=getCssDimensions($);let rt=(nt?round$1(_e.width):_e.width)/et,it=(nt?round$1(_e.height):_e.height)/tt;return(!rt||!Number.isFinite(rt))&&(rt=1),(!it||!Number.isFinite(it))&&(it=1),{x:rt,y:it}}const noOffsets=createCoords(0);function getVisualOffsets(j){const $=getWindow(j);return!isWebKit()||!$.visualViewport?noOffsets:{x:$.visualViewport.offsetLeft,y:$.visualViewport.offsetTop}}function shouldAddVisualOffsets(j,$,_e){return $===void 0&&($=!1),!_e||$&&_e!==getWindow(j)?!1:$}function getBoundingClientRect(j,$,_e,et){$===void 0&&($=!1),_e===void 0&&(_e=!1);const tt=j.getBoundingClientRect(),nt=unwrapElement(j);let rt=createCoords(1);$&&(et?isElement(et)&&(rt=getScale(et)):rt=getScale(j));const it=shouldAddVisualOffsets(nt,_e,et)?getVisualOffsets(nt):createCoords(0);let st=(tt.left+it.x)/rt.x,at=(tt.top+it.y)/rt.y,ot=tt.width/rt.x,ct=tt.height/rt.y;if(nt){const lt=getWindow(nt),ut=et&&isElement(et)?getWindow(et):et;let pt=lt,dt=getFrameElement(pt);for(;dt&&et&&ut!==pt;){const ht=getScale(dt),ft=dt.getBoundingClientRect(),mt=getComputedStyle$2(dt),gt=ft.left+(dt.clientLeft+parseFloat(mt.paddingLeft))*ht.x,yt=ft.top+(dt.clientTop+parseFloat(mt.paddingTop))*ht.y;st*=ht.x,at*=ht.y,ot*=ht.x,ct*=ht.y,st+=gt,at+=yt,pt=getWindow(dt),dt=getFrameElement(pt)}}return rectToClientRect({width:ot,height:ct,x:st,y:at})}function getWindowScrollBarX(j,$){const _e=getNodeScroll(j).scrollLeft;return $?$.left+_e:getBoundingClientRect(getDocumentElement(j)).left+_e}function getHTMLOffset(j,$){const _e=j.getBoundingClientRect(),et=_e.left+$.scrollLeft-getWindowScrollBarX(j,_e),tt=_e.top+$.scrollTop;return{x:et,y:tt}}function convertOffsetParentRelativeRectToViewportRelativeRect(j){let{elements:$,rect:_e,offsetParent:et,strategy:tt}=j;const nt=tt==="fixed",rt=getDocumentElement(et),it=$?isTopLayer($.floating):!1;if(et===rt||it&&nt)return _e;let st={scrollLeft:0,scrollTop:0},at=createCoords(1);const ot=createCoords(0),ct=isHTMLElement$1(et);if((ct||!ct&&!nt)&&((getNodeName(et)!=="body"||isOverflowElement(rt))&&(st=getNodeScroll(et)),isHTMLElement$1(et))){const ut=getBoundingClientRect(et);at=getScale(et),ot.x=ut.x+et.clientLeft,ot.y=ut.y+et.clientTop}const lt=rt&&!ct&&!nt?getHTMLOffset(rt,st):createCoords(0);return{width:_e.width*at.x,height:_e.height*at.y,x:_e.x*at.x-st.scrollLeft*at.x+ot.x+lt.x,y:_e.y*at.y-st.scrollTop*at.y+ot.y+lt.y}}function getClientRects(j){return Array.from(j.getClientRects())}function getDocumentRect(j){const $=getDocumentElement(j),_e=getNodeScroll(j),et=j.ownerDocument.body,tt=max$1($.scrollWidth,$.clientWidth,et.scrollWidth,et.clientWidth),nt=max$1($.scrollHeight,$.clientHeight,et.scrollHeight,et.clientHeight);let rt=-_e.scrollLeft+getWindowScrollBarX(j);const it=-_e.scrollTop;return getComputedStyle$2(et).direction==="rtl"&&(rt+=max$1($.clientWidth,et.clientWidth)-tt),{width:tt,height:nt,x:rt,y:it}}const SCROLLBAR_MAX=25;function getViewportRect(j,$){const _e=getWindow(j),et=getDocumentElement(j),tt=_e.visualViewport;let nt=et.clientWidth,rt=et.clientHeight,it=0,st=0;if(tt){nt=tt.width,rt=tt.height;const ot=isWebKit();(!ot||ot&&$==="fixed")&&(it=tt.offsetLeft,st=tt.offsetTop)}const at=getWindowScrollBarX(et);if(at<=0){const ot=et.ownerDocument,ct=ot.body,lt=getComputedStyle(ct),ut=ot.compatMode==="CSS1Compat"&&parseFloat(lt.marginLeft)+parseFloat(lt.marginRight)||0,pt=Math.abs(et.clientWidth-ct.clientWidth-ut);pt<=SCROLLBAR_MAX&&(nt-=pt)}else at<=SCROLLBAR_MAX&&(nt+=at);return{width:nt,height:rt,x:it,y:st}}const absoluteOrFixed=new Set(["absolute","fixed"]);function getInnerBoundingClientRect(j,$){const _e=getBoundingClientRect(j,!0,$==="fixed"),et=_e.top+j.clientTop,tt=_e.left+j.clientLeft,nt=isHTMLElement$1(j)?getScale(j):createCoords(1),rt=j.clientWidth*nt.x,it=j.clientHeight*nt.y,st=tt*nt.x,at=et*nt.y;return{width:rt,height:it,x:st,y:at}}function getClientRectFromClippingAncestor(j,$,_e){let et;if($==="viewport")et=getViewportRect(j,_e);else if($==="document")et=getDocumentRect(getDocumentElement(j));else if(isElement($))et=getInnerBoundingClientRect($,_e);else{const tt=getVisualOffsets(j);et={x:$.x-tt.x,y:$.y-tt.y,width:$.width,height:$.height}}return rectToClientRect(et)}function hasFixedPositionAncestor(j,$){const _e=getParentNode(j);return _e===$||!isElement(_e)||isLastTraversableNode(_e)?!1:getComputedStyle$2(_e).position==="fixed"||hasFixedPositionAncestor(_e,$)}function getClippingElementAncestors(j,$){const _e=$.get(j);if(_e)return _e;let et=getOverflowAncestors(j,[],!1).filter(it=>isElement(it)&&getNodeName(it)!=="body"),tt=null;const nt=getComputedStyle$2(j).position==="fixed";let rt=nt?getParentNode(j):j;for(;isElement(rt)&&!isLastTraversableNode(rt);){const it=getComputedStyle$2(rt),st=isContainingBlock(rt);!st&&it.position==="fixed"&&(tt=null),(nt?!st&&!tt:!st&&it.position==="static"&&!!tt&&absoluteOrFixed.has(tt.position)||isOverflowElement(rt)&&!st&&hasFixedPositionAncestor(j,rt))?et=et.filter(ot=>ot!==rt):tt=it,rt=getParentNode(rt)}return $.set(j,et),et}function getClippingRect(j){let{element:$,boundary:_e,rootBoundary:et,strategy:tt}=j;const rt=[..._e==="clippingAncestors"?isTopLayer($)?[]:getClippingElementAncestors($,this._c):[].concat(_e),et],it=rt[0],st=rt.reduce((at,ot)=>{const ct=getClientRectFromClippingAncestor($,ot,tt);return at.top=max$1(ct.top,at.top),at.right=min$1(ct.right,at.right),at.bottom=min$1(ct.bottom,at.bottom),at.left=max$1(ct.left,at.left),at},getClientRectFromClippingAncestor($,it,tt));return{width:st.right-st.left,height:st.bottom-st.top,x:st.left,y:st.top}}function getDimensions(j){const{width:$,height:_e}=getCssDimensions(j);return{width:$,height:_e}}function getRectRelativeToOffsetParent(j,$,_e){const et=isHTMLElement$1($),tt=getDocumentElement($),nt=_e==="fixed",rt=getBoundingClientRect(j,!0,nt,$);let it={scrollLeft:0,scrollTop:0};const st=createCoords(0);function at(){st.x=getWindowScrollBarX(tt)}if(et||!et&&!nt)if((getNodeName($)!=="body"||isOverflowElement(tt))&&(it=getNodeScroll($)),et){const ut=getBoundingClientRect($,!0,nt,$);st.x=ut.x+$.clientLeft,st.y=ut.y+$.clientTop}else tt&&at();nt&&!et&&tt&&at();const ot=tt&&!et&&!nt?getHTMLOffset(tt,it):createCoords(0),ct=rt.left+it.scrollLeft-st.x-ot.x,lt=rt.top+it.scrollTop-st.y-ot.y;return{x:ct,y:lt,width:rt.width,height:rt.height}}function isStaticPositioned(j){return getComputedStyle$2(j).position==="static"}function getTrueOffsetParent(j,$){if(!isHTMLElement$1(j)||getComputedStyle$2(j).position==="fixed")return null;if($)return $(j);let _e=j.offsetParent;return getDocumentElement(j)===_e&&(_e=_e.ownerDocument.body),_e}function getOffsetParent(j,$){const _e=getWindow(j);if(isTopLayer(j))return _e;if(!isHTMLElement$1(j)){let tt=getParentNode(j);for(;tt&&!isLastTraversableNode(tt);){if(isElement(tt)&&!isStaticPositioned(tt))return tt;tt=getParentNode(tt)}return _e}let et=getTrueOffsetParent(j,$);for(;et&&isTableElement(et)&&isStaticPositioned(et);)et=getTrueOffsetParent(et,$);return et&&isLastTraversableNode(et)&&isStaticPositioned(et)&&!isContainingBlock(et)?_e:et||getContainingBlock(j)||_e}const getElementRects=async function(j){const $=this.getOffsetParent||getOffsetParent,_e=this.getDimensions,et=await _e(j.floating);return{reference:getRectRelativeToOffsetParent(j.reference,await $(j.floating),j.strategy),floating:{x:0,y:0,width:et.width,height:et.height}}};function isRTL(j){return getComputedStyle$2(j).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function rectsAreEqual(j,$){return j.x===$.x&&j.y===$.y&&j.width===$.width&&j.height===$.height}function observeMove(j,$){let _e=null,et;const tt=getDocumentElement(j);function nt(){var it;clearTimeout(et),(it=_e)==null||it.disconnect(),_e=null}function rt(it,st){it===void 0&&(it=!1),st===void 0&&(st=1),nt();const at=j.getBoundingClientRect(),{left:ot,top:ct,width:lt,height:ut}=at;if(it||$(),!lt||!ut)return;const pt=floor(ct),dt=floor(tt.clientWidth-(ot+lt)),ht=floor(tt.clientHeight-(ct+ut)),ft=floor(ot),gt={rootMargin:-pt+"px "+-dt+"px "+-ht+"px "+-ft+"px",threshold:max$1(0,min$1(1,st))||1};let yt=!0;function vt(xt){const St=xt[0].intersectionRatio;if(St!==st){if(!yt)return rt();St?rt(!1,St):et=setTimeout(()=>{rt(!1,1e-7)},1e3)}St===1&&!rectsAreEqual(at,j.getBoundingClientRect())&&rt(),yt=!1}try{_e=new IntersectionObserver(vt,{...gt,root:tt.ownerDocument})}catch{_e=new IntersectionObserver(vt,gt)}_e.observe(j)}return rt(!0),nt}function autoUpdate(j,$,_e,et){et===void 0&&(et={});const{ancestorScroll:tt=!0,ancestorResize:nt=!0,elementResize:rt=typeof ResizeObserver=="function",layoutShift:it=typeof IntersectionObserver=="function",animationFrame:st=!1}=et,at=unwrapElement(j),ot=tt||nt?[...at?getOverflowAncestors(at):[],...getOverflowAncestors($)]:[];ot.forEach(ft=>{tt&&ft.addEventListener("scroll",_e,{passive:!0}),nt&&ft.addEventListener("resize",_e)});const ct=at&&it?observeMove(at,_e):null;let lt=-1,ut=null;rt&&(ut=new ResizeObserver(ft=>{let[mt]=ft;mt&&mt.target===at&&ut&&(ut.unobserve($),cancelAnimationFrame(lt),lt=requestAnimationFrame(()=>{var gt;(gt=ut)==null||gt.observe($)})),_e()}),at&&!st&&ut.observe(at),ut.observe($));let pt,dt=st?getBoundingClientRect(j):null;st&&ht();function ht(){const ft=getBoundingClientRect(j);dt&&!rectsAreEqual(dt,ft)&&_e(),dt=ft,pt=requestAnimationFrame(ht)}return _e(),()=>{var ft;ot.forEach(mt=>{tt&&mt.removeEventListener("scroll",_e),nt&&mt.removeEventListener("resize",_e)}),ct==null||ct(),(ft=ut)==null||ft.disconnect(),ut=null,st&&cancelAnimationFrame(pt)}}const offset$1=offset$2,shift$1=shift$2,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(j,$,_e)=>{const et=new Map,tt={platform,..._e},nt={...tt.platform,_c:et};return computePosition$1(j,$,{...tt,platform:nt})};var isClient=typeof document<"u",noop$5=function j(){},index$2=isClient?reactExports.useLayoutEffect:noop$5;function deepEqual(j,$){if(j===$)return!0;if(typeof j!=typeof $)return!1;if(typeof j=="function"&&j.toString()===$.toString())return!0;let _e,et,tt;if(j&&$&&typeof j=="object"){if(Array.isArray(j)){if(_e=j.length,_e!==$.length)return!1;for(et=_e;et--!==0;)if(!deepEqual(j[et],$[et]))return!1;return!0}if(tt=Object.keys(j),_e=tt.length,_e!==Object.keys($).length)return!1;for(et=_e;et--!==0;)if(!{}.hasOwnProperty.call($,tt[et]))return!1;for(et=_e;et--!==0;){const nt=tt[et];if(!(nt==="_owner"&&j.$$typeof)&&!deepEqual(j[nt],$[nt]))return!1}return!0}return j!==j&&$!==$}function getDPR(j){return typeof window>"u"?1:(j.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(j,$){const _e=getDPR(j);return Math.round($*_e)/_e}function useLatestRef(j){const $=reactExports.useRef(j);return index$2(()=>{$.current=j}),$}function useFloating(j){j===void 0&&(j={});const{placement:$="bottom",strategy:_e="absolute",middleware:et=[],platform:tt,elements:{reference:nt,floating:rt}={},transform:it=!0,whileElementsMounted:st,open:at}=j,[ot,ct]=reactExports.useState({x:0,y:0,strategy:_e,placement:$,middlewareData:{},isPositioned:!1}),[lt,ut]=reactExports.useState(et);deepEqual(lt,et)||ut(et);const[pt,dt]=reactExports.useState(null),[ht,ft]=reactExports.useState(null),mt=reactExports.useCallback(Nt=>{Nt!==xt.current&&(xt.current=Nt,dt(Nt))},[]),gt=reactExports.useCallback(Nt=>{Nt!==St.current&&(St.current=Nt,ft(Nt))},[]),yt=nt||pt,vt=rt||ht,xt=reactExports.useRef(null),St=reactExports.useRef(null),Et=reactExports.useRef(ot),wt=st!=null,Tt=useLatestRef(st),Ct=useLatestRef(tt),Rt=useLatestRef(at),jt=reactExports.useCallback(()=>{if(!xt.current||!St.current)return;const Nt={placement:$,strategy:_e,middleware:lt};Ct.current&&(Nt.platform=Ct.current),computePosition(xt.current,St.current,Nt).then(Bt=>{const kt={...Bt,isPositioned:Rt.current!==!1};Ot.current&&!deepEqual(Et.current,kt)&&(Et.current=kt,reactDomExports.flushSync(()=>{ct(kt)}))})},[lt,$,_e,Ct,Rt]);index$2(()=>{at===!1&&Et.current.isPositioned&&(Et.current.isPositioned=!1,ct(Nt=>({...Nt,isPositioned:!1})))},[at]);const Ot=reactExports.useRef(!1);index$2(()=>(Ot.current=!0,()=>{Ot.current=!1}),[]),index$2(()=>{if(yt&&(xt.current=yt),vt&&(St.current=vt),yt&&vt){if(Tt.current)return Tt.current(yt,vt,jt);jt()}},[yt,vt,jt,Tt,wt]);const $t=reactExports.useMemo(()=>({reference:xt,floating:St,setReference:mt,setFloating:gt}),[mt,gt]),Kt=reactExports.useMemo(()=>({reference:yt,floating:vt}),[yt,vt]),Lt=reactExports.useMemo(()=>{const Nt={position:_e,left:0,top:0};if(!Kt.floating)return Nt;const Bt=roundByDPR(Kt.floating,ot.x),kt=roundByDPR(Kt.floating,ot.y);return it?{...Nt,transform:"translate("+Bt+"px, "+kt+"px)",...getDPR(Kt.floating)>=1.5&&{willChange:"transform"}}:{position:_e,left:Bt,top:kt}},[_e,it,Kt.floating,ot.x,ot.y]);return reactExports.useMemo(()=>({...ot,update:jt,refs:$t,elements:Kt,floatingStyles:Lt}),[ot,jt,$t,Kt,Lt])}const arrow$1=j=>{function $(_e){return{}.hasOwnProperty.call(_e,"current")}return{name:"arrow",options:j,fn(_e){const{element:et,padding:tt}=typeof j=="function"?j(_e):j;return et&&$(et)?et.current!=null?arrow$2({element:et.current,padding:tt}).fn(_e):{}:et?arrow$2({element:et,padding:tt}).fn(_e):{}}}},offset=(j,$)=>({...offset$1(j),options:[j,$]}),shift=(j,$)=>({...shift$1(j),options:[j,$]}),limitShift=(j,$)=>({...limitShift$1(j),options:[j,$]}),flip=(j,$)=>({...flip$1(j),options:[j,$]}),size=(j,$)=>({...size$1(j),options:[j,$]}),hide=(j,$)=>({...hide$1(j),options:[j,$]}),arrow=(j,$)=>({...arrow$1(j),options:[j,$]});var NAME$1="Arrow",Arrow$1=reactExports.forwardRef((j,$)=>{const{children:_e,width:et=10,height:tt=5,...nt}=j;return jsxRuntimeExports.jsx(Primitive$2.svg,{...nt,ref:$,width:et,height:tt,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:j.asChild?_e:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME$1;var Root$1=Arrow$1;function useSize(j){const[$,_e]=reactExports.useState(void 0);return useLayoutEffect2$1(()=>{if(j){_e({width:j.offsetWidth,height:j.offsetHeight});const et=new ResizeObserver(tt=>{if(!Array.isArray(tt)||!tt.length)return;const nt=tt[0];let rt,it;if("borderBoxSize"in nt){const st=nt.borderBoxSize,at=Array.isArray(st)?st[0]:st;rt=at.inlineSize,it=at.blockSize}else rt=j.offsetWidth,it=j.offsetHeight;_e({width:rt,height:it})});return et.observe(j,{box:"border-box"}),()=>et.unobserve(j)}else _e(void 0)},[j]),$}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope$1(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=j=>{const{__scopePopper:$,children:_e}=j,[et,tt]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:$,anchor:et,onAnchorChange:tt,children:_e})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME="PopperAnchor",PopperAnchor=reactExports.forwardRef((j,$)=>{const{__scopePopper:_e,virtualRef:et,...tt}=j,nt=usePopperContext(ANCHOR_NAME,_e),rt=reactExports.useRef(null),it=useComposedRefs$2($,rt),st=reactExports.useRef(null);return reactExports.useEffect(()=>{const at=st.current;st.current=(et==null?void 0:et.current)||rt.current,at!==st.current&&nt.onAnchorChange(st.current)}),et?null:jsxRuntimeExports.jsx(Primitive$2.div,{...tt,ref:it})});PopperAnchor.displayName=ANCHOR_NAME;var CONTENT_NAME$3="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$3),PopperContent=reactExports.forwardRef((j,$)=>{var It,Zt,Ut,Xt,Ht,Pt;const{__scopePopper:_e,side:et="bottom",sideOffset:tt=0,align:nt="center",alignOffset:rt=0,arrowPadding:it=0,avoidCollisions:st=!0,collisionBoundary:at=[],collisionPadding:ot=0,sticky:ct="partial",hideWhenDetached:lt=!1,updatePositionStrategy:ut="optimized",onPlaced:pt,...dt}=j,ht=usePopperContext(CONTENT_NAME$3,_e),[ft,mt]=reactExports.useState(null),gt=useComposedRefs$2($,Mt=>mt(Mt)),[yt,vt]=reactExports.useState(null),xt=useSize(yt),St=(xt==null?void 0:xt.width)??0,Et=(xt==null?void 0:xt.height)??0,wt=et+(nt!=="center"?"-"+nt:""),Tt=typeof ot=="number"?ot:{top:0,right:0,bottom:0,left:0,...ot},Ct=Array.isArray(at)?at:[at],Rt=Ct.length>0,jt={padding:Tt,boundary:Ct.filter(isNotNull$2),altBoundary:Rt},{refs:Ot,floatingStyles:$t,placement:Kt,isPositioned:Lt,middlewareData:Nt}=useFloating({strategy:"fixed",placement:wt,whileElementsMounted:(...Mt)=>autoUpdate(...Mt,{animationFrame:ut==="always"}),elements:{reference:ht.anchor},middleware:[offset({mainAxis:tt+Et,alignmentAxis:rt}),st&&shift({mainAxis:!0,crossAxis:!1,limiter:ct==="partial"?limitShift():void 0,...jt}),st&&flip({...jt}),size({...jt,apply:({elements:Mt,rects:Vt,availableWidth:qt,availableHeight:en})=>{const{width:fn,height:Cn}=Vt.reference,En=Mt.floating.style;En.setProperty("--radix-popper-available-width",`${qt}px`),En.setProperty("--radix-popper-available-height",`${en}px`),En.setProperty("--radix-popper-anchor-width",`${fn}px`),En.setProperty("--radix-popper-anchor-height",`${Cn}px`)}}),yt&&arrow({element:yt,padding:it}),transformOrigin({arrowWidth:St,arrowHeight:Et}),lt&&hide({strategy:"referenceHidden",...jt})]}),[Bt,kt]=getSideAndAlignFromPlacement(Kt),rn=useCallbackRef$1(pt);useLayoutEffect2$1(()=>{Lt&&(rn==null||rn())},[Lt,rn]);const Gt=(It=Nt.arrow)==null?void 0:It.x,_t=(Zt=Nt.arrow)==null?void 0:Zt.y,sn=((Ut=Nt.arrow)==null?void 0:Ut.centerOffset)!==0,[tn,on]=reactExports.useState();return useLayoutEffect2$1(()=>{ft&&on(window.getComputedStyle(ft).zIndex)},[ft]),jsxRuntimeExports.jsx("div",{ref:Ot.setFloating,"data-radix-popper-content-wrapper":"",style:{...$t,transform:Lt?$t.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:tn,"--radix-popper-transform-origin":[(Xt=Nt.transformOrigin)==null?void 0:Xt.x,(Ht=Nt.transformOrigin)==null?void 0:Ht.y].join(" "),...((Pt=Nt.hide)==null?void 0:Pt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:j.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:_e,placedSide:Bt,onArrowChange:vt,arrowX:Gt,arrowY:_t,shouldHideArrow:sn,children:jsxRuntimeExports.jsx(Primitive$2.div,{"data-side":Bt,"data-align":kt,...dt,ref:gt,style:{...dt.style,animation:Lt?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$3;var ARROW_NAME$1="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function j($,_e){const{__scopePopper:et,...tt}=$,nt=useContentContext(ARROW_NAME$1,et),rt=OPPOSITE_SIDE[nt.placedSide];return jsxRuntimeExports.jsx("span",{ref:nt.onArrowChange,style:{position:"absolute",left:nt.arrowX,top:nt.arrowY,[rt]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[nt.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[nt.placedSide],visibility:nt.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$1,{...tt,ref:_e,style:{...tt.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$1;function isNotNull$2(j){return j!==null}var transformOrigin=j=>({name:"transformOrigin",options:j,fn($){var ht,ft,mt;const{placement:_e,rects:et,middlewareData:tt}=$,rt=((ht=tt.arrow)==null?void 0:ht.centerOffset)!==0,it=rt?0:j.arrowWidth,st=rt?0:j.arrowHeight,[at,ot]=getSideAndAlignFromPlacement(_e),ct={start:"0%",center:"50%",end:"100%"}[ot],lt=(((ft=tt.arrow)==null?void 0:ft.x)??0)+it/2,ut=(((mt=tt.arrow)==null?void 0:mt.y)??0)+st/2;let pt="",dt="";return at==="bottom"?(pt=rt?ct:`${lt}px`,dt=`${-st}px`):at==="top"?(pt=rt?ct:`${lt}px`,dt=`${et.floating.height+st}px`):at==="right"?(pt=`${-st}px`,dt=rt?ct:`${ut}px`):at==="left"&&(pt=`${et.floating.width+st}px`,dt=rt?ct:`${ut}px`),{data:{x:pt,y:dt}}}});function getSideAndAlignFromPlacement(j){const[$,_e="center"]=j.split("-");return[$,_e]}var Root2$2=Popper,Anchor=PopperAnchor,Content$1=PopperContent,Arrow=PopperArrow,PORTAL_NAME$1="Portal",Portal$1=reactExports.forwardRef((j,$)=>{var it;const{container:_e,...et}=j,[tt,nt]=reactExports.useState(!1);useLayoutEffect2$1(()=>nt(!0),[]);const rt=_e||tt&&((it=globalThis==null?void 0:globalThis.document)==null?void 0:it.body);return rt?ReactDOM.createPortal(jsxRuntimeExports.jsx(Primitive$2.div,{...et,ref:$}),rt):null});Portal$1.displayName=PORTAL_NAME$1;function createSlot$3(j){const $=createSlotClone$3(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable$3);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone$3(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$4(tt),it=mergeProps$3(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs$2(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER$3=Symbol("radix.slottable");function isSlottable$3(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER$3}function mergeProps$3(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$4(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}var useInsertionEffect$2=React$5[" useInsertionEffect ".trim().toString()]||useLayoutEffect2$1;function useControllableState$1({prop:j,defaultProp:$,onChange:_e=()=>{},caller:et}){const[tt,nt,rt]=useUncontrolledState$1({defaultProp:$,onChange:_e}),it=j!==void 0,st=it?j:tt;{const ot=reactExports.useRef(j!==void 0);reactExports.useEffect(()=>{const ct=ot.current;ct!==it&&console.warn(`${et} is changing from ${ct?"controlled":"uncontrolled"} to ${it?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),ot.current=it},[it,et])}const at=reactExports.useCallback(ot=>{var ct;if(it){const lt=isFunction$2(ot)?ot(j):ot;lt!==j&&((ct=rt.current)==null||ct.call(rt,lt))}else nt(ot)},[it,j,nt,rt]);return[st,at]}function useUncontrolledState$1({defaultProp:j,onChange:$}){const[_e,et]=reactExports.useState(j),tt=reactExports.useRef(_e),nt=reactExports.useRef($);return useInsertionEffect$2(()=>{nt.current=$},[$]),reactExports.useEffect(()=>{var rt;tt.current!==_e&&((rt=nt.current)==null||rt.call(nt,_e),tt.current=_e)},[_e,tt]),[_e,et,nt]}function isFunction$2(j){return typeof j=="function"}function usePrevious(j){const $=reactExports.useRef({value:j,previous:j});return reactExports.useMemo(()=>($.current.value!==j&&($.current.previous=$.current.value,$.current.value=j),$.current.previous),[j])}var VISUALLY_HIDDEN_STYLES=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NAME="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((j,$)=>jsxRuntimeExports.jsx(Primitive$2.span,{...j,ref:$,style:{...VISUALLY_HIDDEN_STYLES,...j.style}}));VisuallyHidden.displayName=NAME;var getDefaultParent=function(j){if(typeof document>"u")return null;var $=Array.isArray(j)?j[0]:j;return $.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(j){return j&&(j.host||unwrapHost(j.parentNode))},correctTargets=function(j,$){return $.map(function(_e){if(j.contains(_e))return _e;var et=unwrapHost(_e);return et&&j.contains(et)?et:(console.error("aria-hidden",_e,"in not contained inside",j,". Doing nothing"),null)}).filter(function(_e){return!!_e})},applyAttributeToOthers=function(j,$,_e,et){var tt=correctTargets($,Array.isArray(j)?j:[j]);markerMap[_e]||(markerMap[_e]=new WeakMap);var nt=markerMap[_e],rt=[],it=new Set,st=new Set(tt),at=function(ct){!ct||it.has(ct)||(it.add(ct),at(ct.parentNode))};tt.forEach(at);var ot=function(ct){!ct||st.has(ct)||Array.prototype.forEach.call(ct.children,function(lt){if(it.has(lt))ot(lt);else try{var ut=lt.getAttribute(et),pt=ut!==null&&ut!=="false",dt=(counterMap.get(lt)||0)+1,ht=(nt.get(lt)||0)+1;counterMap.set(lt,dt),nt.set(lt,ht),rt.push(lt),dt===1&&pt&&uncontrolledNodes.set(lt,!0),ht===1&&lt.setAttribute(_e,"true"),pt||lt.setAttribute(et,"true")}catch(ft){console.error("aria-hidden: cannot operate on ",lt,ft)}})};return ot($),it.clear(),lockCount++,function(){rt.forEach(function(ct){var lt=counterMap.get(ct)-1,ut=nt.get(ct)-1;counterMap.set(ct,lt),nt.set(ct,ut),lt||(uncontrolledNodes.has(ct)||ct.removeAttribute(et),uncontrolledNodes.delete(ct)),ut||ct.removeAttribute(_e)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(j,$,_e){_e===void 0&&(_e="data-aria-hidden");var et=Array.from(Array.isArray(j)?j:[j]),tt=getDefaultParent(j);return tt?(et.push.apply(et,Array.from(tt.querySelectorAll("[aria-live], script"))),applyAttributeToOthers(et,tt,_e,"aria-hidden")):function(){return null}},__assign=function(){return __assign=Object.assign||function($){for(var _e,et=1,tt=arguments.length;et<tt;et++){_e=arguments[et];for(var nt in _e)Object.prototype.hasOwnProperty.call(_e,nt)&&($[nt]=_e[nt])}return $},__assign.apply(this,arguments)};function __rest(j,$){var _e={};for(var et in j)Object.prototype.hasOwnProperty.call(j,et)&&$.indexOf(et)<0&&(_e[et]=j[et]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function")for(var tt=0,et=Object.getOwnPropertySymbols(j);tt<et.length;tt++)$.indexOf(et[tt])<0&&Object.prototype.propertyIsEnumerable.call(j,et[tt])&&(_e[et[tt]]=j[et[tt]]);return _e}function __spreadArray(j,$,_e){if(_e||arguments.length===2)for(var et=0,tt=$.length,nt;et<tt;et++)(nt||!(et in $))&&(nt||(nt=Array.prototype.slice.call($,0,et)),nt[et]=$[et]);return j.concat(nt||Array.prototype.slice.call($))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(j,$){return typeof j=="function"?j($):j&&(j.current=$),j}function useCallbackRef(j,$){var _e=reactExports.useState(function(){return{value:j,callback:$,facade:{get current(){return _e.value},set current(et){var tt=_e.value;tt!==et&&(_e.value=et,_e.callback(et,tt))}}}})[0];return _e.callback=$,_e.facade}var useIsomorphicLayoutEffect$3=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(j,$){var _e=useCallbackRef(null,function(et){return j.forEach(function(tt){return assignRef(tt,et)})});return useIsomorphicLayoutEffect$3(function(){var et=currentValues.get(_e);if(et){var tt=new Set(et),nt=new Set(j),rt=_e.current;tt.forEach(function(it){nt.has(it)||assignRef(it,null)}),nt.forEach(function(it){tt.has(it)||assignRef(it,rt)})}currentValues.set(_e,j)},[j]),_e}function ItoI(j){return j}function innerCreateMedium(j,$){$===void 0&&($=ItoI);var _e=[],et=!1,tt={read:function(){if(et)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return _e.length?_e[_e.length-1]:j},useMedium:function(nt){var rt=$(nt,et);return _e.push(rt),function(){_e=_e.filter(function(it){return it!==rt})}},assignSyncMedium:function(nt){for(et=!0;_e.length;){var rt=_e;_e=[],rt.forEach(nt)}_e={push:function(it){return nt(it)},filter:function(){return _e}}},assignMedium:function(nt){et=!0;var rt=[];if(_e.length){var it=_e;_e=[],it.forEach(nt),rt=_e}var st=function(){var ot=rt;rt=[],ot.forEach(nt)},at=function(){return Promise.resolve().then(st)};at(),_e={push:function(ot){rt.push(ot),at()},filter:function(ot){return rt=rt.filter(ot),_e}}}};return tt}function createSidecarMedium(j){j===void 0&&(j={});var $=innerCreateMedium(null);return $.options=__assign({async:!0,ssr:!1},j),$}var SideCar$1=function(j){var $=j.sideCar,_e=__rest(j,["sideCar"]);if(!$)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var et=$.read();if(!et)throw new Error("Sidecar medium not found");return reactExports.createElement(et,__assign({},_e))};SideCar$1.isSideCarExport=!0;function exportSidecar(j,$){return j.useMedium($),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(j,$){var _e=reactExports.useRef(null),et=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),tt=et[0],nt=et[1],rt=j.forwardProps,it=j.children,st=j.className,at=j.removeScrollBar,ot=j.enabled,ct=j.shards,lt=j.sideCar,ut=j.noRelative,pt=j.noIsolation,dt=j.inert,ht=j.allowPinchZoom,ft=j.as,mt=ft===void 0?"div":ft,gt=j.gapMode,yt=__rest(j,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),vt=lt,xt=useMergeRefs([_e,$]),St=__assign(__assign({},yt),tt);return reactExports.createElement(reactExports.Fragment,null,ot&&reactExports.createElement(vt,{sideCar:effectCar,removeScrollBar:at,shards:ct,noRelative:ut,noIsolation:pt,inert:dt,setCallbacks:nt,allowPinchZoom:!!ht,lockRef:_e,gapMode:gt}),rt?reactExports.cloneElement(reactExports.Children.only(it),__assign(__assign({},St),{ref:xt})):reactExports.createElement(mt,__assign({},St,{className:st,ref:xt}),it))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var j=document.createElement("style");j.type="text/css";var $=getNonce();return $&&j.setAttribute("nonce",$),j}function injectStyles(j,$){j.styleSheet?j.styleSheet.cssText=$:j.appendChild(document.createTextNode($))}function insertStyleTag(j){var $=document.head||document.getElementsByTagName("head")[0];$.appendChild(j)}var stylesheetSingleton=function(){var j=0,$=null;return{add:function(_e){j==0&&($=makeStyleTag())&&(injectStyles($,_e),insertStyleTag($)),j++},remove:function(){j--,!j&&$&&($.parentNode&&$.parentNode.removeChild($),$=null)}}},styleHookSingleton=function(){var j=stylesheetSingleton();return function($,_e){reactExports.useEffect(function(){return j.add($),function(){j.remove()}},[$&&_e])}},styleSingleton=function(){var j=styleHookSingleton(),$=function(_e){var et=_e.styles,tt=_e.dynamic;return j(et,tt),null};return $},zeroGap={left:0,top:0,right:0,gap:0},parse$2=function(j){return parseInt(j||"",10)||0},getOffset=function(j){var $=window.getComputedStyle(document.body),_e=$[j==="padding"?"paddingLeft":"marginLeft"],et=$[j==="padding"?"paddingTop":"marginTop"],tt=$[j==="padding"?"paddingRight":"marginRight"];return[parse$2(_e),parse$2(et),parse$2(tt)]},getGapWidth=function(j){if(j===void 0&&(j="margin"),typeof window>"u")return zeroGap;var $=getOffset(j),_e=document.documentElement.clientWidth,et=window.innerWidth;return{left:$[0],top:$[1],right:$[2],gap:Math.max(0,et-_e+$[2]-$[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles=function(j,$,_e,et){var tt=j.left,nt=j.top,rt=j.right,it=j.gap;return _e===void 0&&(_e="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(et,`;
   padding-right: `).concat(it,"px ").concat(et,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(et,`;
    overscroll-behavior: contain;
    `).concat([$&&"position: relative ".concat(et,";"),_e==="margin"&&`
    padding-left: `.concat(tt,`px;
    padding-top: `).concat(nt,`px;
    padding-right: `).concat(rt,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(it,"px ").concat(et,`;
    `),_e==="padding"&&"padding-right: ".concat(it,"px ").concat(et,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(it,"px ").concat(et,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(it,"px ").concat(et,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(et,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(et,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(it,`px;
  }
`)},getCurrentUseCounter=function(){var j=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(j)?j:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var j=getCurrentUseCounter()-1;j<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,j.toString())}},[])},RemoveScrollBar=function(j){var $=j.noRelative,_e=j.noImportant,et=j.gapMode,tt=et===void 0?"margin":et;useLockAttribute();var nt=reactExports.useMemo(function(){return getGapWidth(tt)},[tt]);return reactExports.createElement(Style,{styles:getStyles(nt,!$,tt,_e?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(j){return j.tagName==="TEXTAREA"},elementCanBeScrolled=function(j,$){if(!(j instanceof Element))return!1;var _e=window.getComputedStyle(j);return _e[$]!=="hidden"&&!(_e.overflowY===_e.overflowX&&!alwaysContainsScroll(j)&&_e[$]==="visible")},elementCouldBeVScrolled=function(j){return elementCanBeScrolled(j,"overflowY")},elementCouldBeHScrolled=function(j){return elementCanBeScrolled(j,"overflowX")},locationCouldBeScrolled=function(j,$){var _e=$.ownerDocument,et=$;do{typeof ShadowRoot<"u"&&et instanceof ShadowRoot&&(et=et.host);var tt=elementCouldBeScrolled(j,et);if(tt){var nt=getScrollVariables(j,et),rt=nt[1],it=nt[2];if(rt>it)return!0}et=et.parentNode}while(et&&et!==_e.body);return!1},getVScrollVariables=function(j){var $=j.scrollTop,_e=j.scrollHeight,et=j.clientHeight;return[$,_e,et]},getHScrollVariables=function(j){var $=j.scrollLeft,_e=j.scrollWidth,et=j.clientWidth;return[$,_e,et]},elementCouldBeScrolled=function(j,$){return j==="v"?elementCouldBeVScrolled($):elementCouldBeHScrolled($)},getScrollVariables=function(j,$){return j==="v"?getVScrollVariables($):getHScrollVariables($)},getDirectionFactor=function(j,$){return j==="h"&&$==="rtl"?-1:1},handleScroll=function(j,$,_e,et,tt){var nt=getDirectionFactor(j,window.getComputedStyle($).direction),rt=nt*et,it=_e.target,st=$.contains(it),at=!1,ot=rt>0,ct=0,lt=0;do{if(!it)break;var ut=getScrollVariables(j,it),pt=ut[0],dt=ut[1],ht=ut[2],ft=dt-ht-nt*pt;(pt||ft)&&elementCouldBeScrolled(j,it)&&(ct+=ft,lt+=pt);var mt=it.parentNode;it=mt&&mt.nodeType===Node.DOCUMENT_FRAGMENT_NODE?mt.host:mt}while(!st&&it!==document.body||st&&($.contains(it)||$===it));return(ot&&Math.abs(ct)<1||!ot&&Math.abs(lt)<1)&&(at=!0),at},getTouchXY=function(j){return"changedTouches"in j?[j.changedTouches[0].clientX,j.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(j){return[j.deltaX,j.deltaY]},extractRef=function(j){return j&&"current"in j?j.current:j},deltaCompare=function(j,$){return j[0]===$[0]&&j[1]===$[1]},generateStyle=function(j){return`
  .block-interactivity-`.concat(j,` {pointer-events: none;}
  .allow-interactivity-`).concat(j,` {pointer-events: all;}
`)},idCounter$1=0,lockStack=[];function RemoveScrollSideCar(j){var $=reactExports.useRef([]),_e=reactExports.useRef([0,0]),et=reactExports.useRef(),tt=reactExports.useState(idCounter$1++)[0],nt=reactExports.useState(styleSingleton)[0],rt=reactExports.useRef(j);reactExports.useEffect(function(){rt.current=j},[j]),reactExports.useEffect(function(){if(j.inert){document.body.classList.add("block-interactivity-".concat(tt));var dt=__spreadArray([j.lockRef.current],(j.shards||[]).map(extractRef),!0).filter(Boolean);return dt.forEach(function(ht){return ht.classList.add("allow-interactivity-".concat(tt))}),function(){document.body.classList.remove("block-interactivity-".concat(tt)),dt.forEach(function(ht){return ht.classList.remove("allow-interactivity-".concat(tt))})}}},[j.inert,j.lockRef.current,j.shards]);var it=reactExports.useCallback(function(dt,ht){if("touches"in dt&&dt.touches.length===2||dt.type==="wheel"&&dt.ctrlKey)return!rt.current.allowPinchZoom;var ft=getTouchXY(dt),mt=_e.current,gt="deltaX"in dt?dt.deltaX:mt[0]-ft[0],yt="deltaY"in dt?dt.deltaY:mt[1]-ft[1],vt,xt=dt.target,St=Math.abs(gt)>Math.abs(yt)?"h":"v";if("touches"in dt&&St==="h"&&xt.type==="range")return!1;var Et=window.getSelection(),wt=Et&&Et.anchorNode,Tt=wt?wt===xt||wt.contains(xt):!1;if(Tt)return!1;var Ct=locationCouldBeScrolled(St,xt);if(!Ct)return!0;if(Ct?vt=St:(vt=St==="v"?"h":"v",Ct=locationCouldBeScrolled(St,xt)),!Ct)return!1;if(!et.current&&"changedTouches"in dt&&(gt||yt)&&(et.current=vt),!vt)return!0;var Rt=et.current||vt;return handleScroll(Rt,ht,dt,Rt==="h"?gt:yt)},[]),st=reactExports.useCallback(function(dt){var ht=dt;if(!(!lockStack.length||lockStack[lockStack.length-1]!==nt)){var ft="deltaY"in ht?getDeltaXY(ht):getTouchXY(ht),mt=$.current.filter(function(vt){return vt.name===ht.type&&(vt.target===ht.target||ht.target===vt.shadowParent)&&deltaCompare(vt.delta,ft)})[0];if(mt&&mt.should){ht.cancelable&&ht.preventDefault();return}if(!mt){var gt=(rt.current.shards||[]).map(extractRef).filter(Boolean).filter(function(vt){return vt.contains(ht.target)}),yt=gt.length>0?it(ht,gt[0]):!rt.current.noIsolation;yt&&ht.cancelable&&ht.preventDefault()}}},[]),at=reactExports.useCallback(function(dt,ht,ft,mt){var gt={name:dt,delta:ht,target:ft,should:mt,shadowParent:getOutermostShadowParent(ft)};$.current.push(gt),setTimeout(function(){$.current=$.current.filter(function(yt){return yt!==gt})},1)},[]),ot=reactExports.useCallback(function(dt){_e.current=getTouchXY(dt),et.current=void 0},[]),ct=reactExports.useCallback(function(dt){at(dt.type,getDeltaXY(dt),dt.target,it(dt,j.lockRef.current))},[]),lt=reactExports.useCallback(function(dt){at(dt.type,getTouchXY(dt),dt.target,it(dt,j.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(nt),j.setCallbacks({onScrollCapture:ct,onWheelCapture:ct,onTouchMoveCapture:lt}),document.addEventListener("wheel",st,nonPassive),document.addEventListener("touchmove",st,nonPassive),document.addEventListener("touchstart",ot,nonPassive),function(){lockStack=lockStack.filter(function(dt){return dt!==nt}),document.removeEventListener("wheel",st,nonPassive),document.removeEventListener("touchmove",st,nonPassive),document.removeEventListener("touchstart",ot,nonPassive)}},[]);var ut=j.removeScrollBar,pt=j.inert;return reactExports.createElement(reactExports.Fragment,null,pt?reactExports.createElement(nt,{styles:generateStyle(tt)}):null,ut?reactExports.createElement(RemoveScrollBar,{noRelative:j.noRelative,gapMode:j.gapMode}):null)}function getOutermostShadowParent(j){for(var $=null;j!==null;)j instanceof ShadowRoot&&($=j.host,j=j.host),j=j.parentNode;return $}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(j,$){return reactExports.createElement(RemoveScroll,__assign({},j,{ref:$,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],SELECTION_KEYS=[" ","Enter"],SELECT_NAME="Select",[Collection$1,useCollection$1,createCollectionScope$1]=createCollection$1(SELECT_NAME),[createSelectContext]=createContextScope$1(SELECT_NAME,[createCollectionScope$1,createPopperScope]),usePopperScope=createPopperScope(),[SelectProvider,useSelectContext]=createSelectContext(SELECT_NAME),[SelectNativeOptionsProvider,useSelectNativeOptionsContext]=createSelectContext(SELECT_NAME),Select$1=j=>{const{__scopeSelect:$,children:_e,open:et,defaultOpen:tt,onOpenChange:nt,value:rt,defaultValue:it,onValueChange:st,dir:at,name:ot,autoComplete:ct,disabled:lt,required:ut,form:pt}=j,dt=usePopperScope($),[ht,ft]=reactExports.useState(null),[mt,gt]=reactExports.useState(null),[yt,vt]=reactExports.useState(!1),xt=useDirection$1(at),[St,Et]=useControllableState$1({prop:et,defaultProp:tt??!1,onChange:nt,caller:SELECT_NAME}),[wt,Tt]=useControllableState$1({prop:rt,defaultProp:it,onChange:st,caller:SELECT_NAME}),Ct=reactExports.useRef(null),Rt=ht?pt||!!ht.closest("form"):!0,[jt,Ot]=reactExports.useState(new Set),$t=Array.from(jt).map(Kt=>Kt.props.value).join(";");return jsxRuntimeExports.jsx(Root2$2,{...dt,children:jsxRuntimeExports.jsxs(SelectProvider,{required:ut,scope:$,trigger:ht,onTriggerChange:ft,valueNode:mt,onValueNodeChange:gt,valueNodeHasChildren:yt,onValueNodeHasChildrenChange:vt,contentId:useId$2(),value:wt,onValueChange:Tt,open:St,onOpenChange:Et,dir:xt,triggerPointerDownPosRef:Ct,disabled:lt,children:[jsxRuntimeExports.jsx(Collection$1.Provider,{scope:$,children:jsxRuntimeExports.jsx(SelectNativeOptionsProvider,{scope:j.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(Kt=>{Ot(Lt=>new Set(Lt).add(Kt))},[]),onNativeOptionRemove:reactExports.useCallback(Kt=>{Ot(Lt=>{const Nt=new Set(Lt);return Nt.delete(Kt),Nt})},[]),children:_e})}),Rt?jsxRuntimeExports.jsxs(SelectBubbleInput,{"aria-hidden":!0,required:ut,tabIndex:-1,name:ot,autoComplete:ct,value:wt,onChange:Kt=>Tt(Kt.target.value),disabled:lt,form:pt,children:[wt===void 0?jsxRuntimeExports.jsx("option",{value:""}):null,Array.from(jt)]},$t):null]})})};Select$1.displayName=SELECT_NAME;var TRIGGER_NAME$2="SelectTrigger",SelectTrigger$1=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,disabled:et=!1,...tt}=j,nt=usePopperScope(_e),rt=useSelectContext(TRIGGER_NAME$2,_e),it=rt.disabled||et,st=useComposedRefs$2($,rt.onTriggerChange),at=useCollection$1(_e),ot=reactExports.useRef("touch"),[ct,lt,ut]=useTypeaheadSearch(dt=>{const ht=at().filter(gt=>!gt.disabled),ft=ht.find(gt=>gt.value===rt.value),mt=findNextItem(ht,dt,ft);mt!==void 0&&rt.onValueChange(mt.value)}),pt=dt=>{it||(rt.onOpenChange(!0),ut()),dt&&(rt.triggerPointerDownPosRef.current={x:Math.round(dt.pageX),y:Math.round(dt.pageY)})};return jsxRuntimeExports.jsx(Anchor,{asChild:!0,...nt,children:jsxRuntimeExports.jsx(Primitive$2.button,{type:"button",role:"combobox","aria-controls":rt.contentId,"aria-expanded":rt.open,"aria-required":rt.required,"aria-autocomplete":"none",dir:rt.dir,"data-state":rt.open?"open":"closed",disabled:it,"data-disabled":it?"":void 0,"data-placeholder":shouldShowPlaceholder(rt.value)?"":void 0,...tt,ref:st,onClick:composeEventHandlers$1(tt.onClick,dt=>{dt.currentTarget.focus(),ot.current!=="mouse"&&pt(dt)}),onPointerDown:composeEventHandlers$1(tt.onPointerDown,dt=>{ot.current=dt.pointerType;const ht=dt.target;ht.hasPointerCapture(dt.pointerId)&&ht.releasePointerCapture(dt.pointerId),dt.button===0&&dt.ctrlKey===!1&&dt.pointerType==="mouse"&&(pt(dt),dt.preventDefault())}),onKeyDown:composeEventHandlers$1(tt.onKeyDown,dt=>{const ht=ct.current!=="";!(dt.ctrlKey||dt.altKey||dt.metaKey)&&dt.key.length===1&&lt(dt.key),!(ht&&dt.key===" ")&&OPEN_KEYS.includes(dt.key)&&(pt(),dt.preventDefault())})})})});SelectTrigger$1.displayName=TRIGGER_NAME$2;var VALUE_NAME="SelectValue",SelectValue$1=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,className:et,style:tt,children:nt,placeholder:rt="",...it}=j,st=useSelectContext(VALUE_NAME,_e),{onValueNodeHasChildrenChange:at}=st,ot=nt!==void 0,ct=useComposedRefs$2($,st.onValueNodeChange);return useLayoutEffect2$1(()=>{at(ot)},[at,ot]),jsxRuntimeExports.jsx(Primitive$2.span,{...it,ref:ct,style:{pointerEvents:"none"},children:shouldShowPlaceholder(st.value)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:rt}):nt})});SelectValue$1.displayName=VALUE_NAME;var ICON_NAME="SelectIcon",SelectIcon=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,children:et,...tt}=j;return jsxRuntimeExports.jsx(Primitive$2.span,{"aria-hidden":!0,...tt,ref:$,children:et||""})});SelectIcon.displayName=ICON_NAME;var PORTAL_NAME="SelectPortal",SelectPortal=j=>jsxRuntimeExports.jsx(Portal$1,{asChild:!0,...j});SelectPortal.displayName=PORTAL_NAME;var CONTENT_NAME$2="SelectContent",SelectContent$1=reactExports.forwardRef((j,$)=>{const _e=useSelectContext(CONTENT_NAME$2,j.__scopeSelect),[et,tt]=reactExports.useState();if(useLayoutEffect2$1(()=>{tt(new DocumentFragment)},[]),!_e.open){const nt=et;return nt?reactDomExports.createPortal(jsxRuntimeExports.jsx(SelectContentProvider,{scope:j.__scopeSelect,children:jsxRuntimeExports.jsx(Collection$1.Slot,{scope:j.__scopeSelect,children:jsxRuntimeExports.jsx("div",{children:j.children})})}),nt):null}return jsxRuntimeExports.jsx(SelectContentImpl,{...j,ref:$})});SelectContent$1.displayName=CONTENT_NAME$2;var CONTENT_MARGIN=10,[SelectContentProvider,useSelectContentContext]=createSelectContext(CONTENT_NAME$2),CONTENT_IMPL_NAME="SelectContentImpl",Slot=createSlot$3("SelectContent.RemoveScroll"),SelectContentImpl=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,position:et="item-aligned",onCloseAutoFocus:tt,onEscapeKeyDown:nt,onPointerDownOutside:rt,side:it,sideOffset:st,align:at,alignOffset:ot,arrowPadding:ct,collisionBoundary:lt,collisionPadding:ut,sticky:pt,hideWhenDetached:dt,avoidCollisions:ht,...ft}=j,mt=useSelectContext(CONTENT_NAME$2,_e),[gt,yt]=reactExports.useState(null),[vt,xt]=reactExports.useState(null),St=useComposedRefs$2($,It=>yt(It)),[Et,wt]=reactExports.useState(null),[Tt,Ct]=reactExports.useState(null),Rt=useCollection$1(_e),[jt,Ot]=reactExports.useState(!1),$t=reactExports.useRef(!1);reactExports.useEffect(()=>{if(gt)return hideOthers(gt)},[gt]),useFocusGuards();const Kt=reactExports.useCallback(It=>{const[Zt,...Ut]=Rt().map(Pt=>Pt.ref.current),[Xt]=Ut.slice(-1),Ht=document.activeElement;for(const Pt of It)if(Pt===Ht||(Pt==null||Pt.scrollIntoView({block:"nearest"}),Pt===Zt&&vt&&(vt.scrollTop=0),Pt===Xt&&vt&&(vt.scrollTop=vt.scrollHeight),Pt==null||Pt.focus(),document.activeElement!==Ht))return},[Rt,vt]),Lt=reactExports.useCallback(()=>Kt([Et,gt]),[Kt,Et,gt]);reactExports.useEffect(()=>{jt&&Lt()},[jt,Lt]);const{onOpenChange:Nt,triggerPointerDownPosRef:Bt}=mt;reactExports.useEffect(()=>{if(gt){let It={x:0,y:0};const Zt=Xt=>{var Ht,Pt;It={x:Math.abs(Math.round(Xt.pageX)-(((Ht=Bt.current)==null?void 0:Ht.x)??0)),y:Math.abs(Math.round(Xt.pageY)-(((Pt=Bt.current)==null?void 0:Pt.y)??0))}},Ut=Xt=>{It.x<=10&&It.y<=10?Xt.preventDefault():gt.contains(Xt.target)||Nt(!1),document.removeEventListener("pointermove",Zt),Bt.current=null};return Bt.current!==null&&(document.addEventListener("pointermove",Zt),document.addEventListener("pointerup",Ut,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Zt),document.removeEventListener("pointerup",Ut,{capture:!0})}}},[gt,Nt,Bt]),reactExports.useEffect(()=>{const It=()=>Nt(!1);return window.addEventListener("blur",It),window.addEventListener("resize",It),()=>{window.removeEventListener("blur",It),window.removeEventListener("resize",It)}},[Nt]);const[kt,rn]=useTypeaheadSearch(It=>{const Zt=Rt().filter(Ht=>!Ht.disabled),Ut=Zt.find(Ht=>Ht.ref.current===document.activeElement),Xt=findNextItem(Zt,It,Ut);Xt&&setTimeout(()=>Xt.ref.current.focus())}),Gt=reactExports.useCallback((It,Zt,Ut)=>{const Xt=!$t.current&&!Ut;(mt.value!==void 0&&mt.value===Zt||Xt)&&(wt(It),Xt&&($t.current=!0))},[mt.value]),_t=reactExports.useCallback(()=>gt==null?void 0:gt.focus(),[gt]),sn=reactExports.useCallback((It,Zt,Ut)=>{const Xt=!$t.current&&!Ut;(mt.value!==void 0&&mt.value===Zt||Xt)&&Ct(It)},[mt.value]),tn=et==="popper"?SelectPopperPosition:SelectItemAlignedPosition,on=tn===SelectPopperPosition?{side:it,sideOffset:st,align:at,alignOffset:ot,arrowPadding:ct,collisionBoundary:lt,collisionPadding:ut,sticky:pt,hideWhenDetached:dt,avoidCollisions:ht}:{};return jsxRuntimeExports.jsx(SelectContentProvider,{scope:_e,content:gt,viewport:vt,onViewportChange:xt,itemRefCallback:Gt,selectedItem:Et,onItemLeave:_t,itemTextRefCallback:sn,focusSelectedItem:Lt,selectedItemText:Tt,position:et,isPositioned:jt,searchRef:kt,children:jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot,allowPinchZoom:!0,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:mt.open,onMountAutoFocus:It=>{It.preventDefault()},onUnmountAutoFocus:composeEventHandlers$1(tt,It=>{var Zt;(Zt=mt.trigger)==null||Zt.focus({preventScroll:!0}),It.preventDefault()}),children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:nt,onPointerDownOutside:rt,onFocusOutside:It=>It.preventDefault(),onDismiss:()=>mt.onOpenChange(!1),children:jsxRuntimeExports.jsx(tn,{role:"listbox",id:mt.contentId,"data-state":mt.open?"open":"closed",dir:mt.dir,onContextMenu:It=>It.preventDefault(),...ft,...on,onPlaced:()=>Ot(!0),ref:St,style:{display:"flex",flexDirection:"column",outline:"none",...ft.style},onKeyDown:composeEventHandlers$1(ft.onKeyDown,It=>{const Zt=It.ctrlKey||It.altKey||It.metaKey;if(It.key==="Tab"&&It.preventDefault(),!Zt&&It.key.length===1&&rn(It.key),["ArrowUp","ArrowDown","Home","End"].includes(It.key)){let Xt=Rt().filter(Ht=>!Ht.disabled).map(Ht=>Ht.ref.current);if(["ArrowUp","End"].includes(It.key)&&(Xt=Xt.slice().reverse()),["ArrowUp","ArrowDown"].includes(It.key)){const Ht=It.target,Pt=Xt.indexOf(Ht);Xt=Xt.slice(Pt+1)}setTimeout(()=>Kt(Xt)),It.preventDefault()}})})})})})})});SelectContentImpl.displayName=CONTENT_IMPL_NAME;var ITEM_ALIGNED_POSITION_NAME="SelectItemAlignedPosition",SelectItemAlignedPosition=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,onPlaced:et,...tt}=j,nt=useSelectContext(CONTENT_NAME$2,_e),rt=useSelectContentContext(CONTENT_NAME$2,_e),[it,st]=reactExports.useState(null),[at,ot]=reactExports.useState(null),ct=useComposedRefs$2($,St=>ot(St)),lt=useCollection$1(_e),ut=reactExports.useRef(!1),pt=reactExports.useRef(!0),{viewport:dt,selectedItem:ht,selectedItemText:ft,focusSelectedItem:mt}=rt,gt=reactExports.useCallback(()=>{if(nt.trigger&&nt.valueNode&&it&&at&&dt&&ht&&ft){const St=nt.trigger.getBoundingClientRect(),Et=at.getBoundingClientRect(),wt=nt.valueNode.getBoundingClientRect(),Tt=ft.getBoundingClientRect();if(nt.dir!=="rtl"){const Ht=Tt.left-Et.left,Pt=wt.left-Ht,Mt=St.left-Pt,Vt=St.width+Mt,qt=Math.max(Vt,Et.width),en=window.innerWidth-CONTENT_MARGIN,fn=clamp$2(Pt,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,en-qt)]);it.style.minWidth=Vt+"px",it.style.left=fn+"px"}else{const Ht=Et.right-Tt.right,Pt=window.innerWidth-wt.right-Ht,Mt=window.innerWidth-St.right-Pt,Vt=St.width+Mt,qt=Math.max(Vt,Et.width),en=window.innerWidth-CONTENT_MARGIN,fn=clamp$2(Pt,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,en-qt)]);it.style.minWidth=Vt+"px",it.style.right=fn+"px"}const Ct=lt(),Rt=window.innerHeight-CONTENT_MARGIN*2,jt=dt.scrollHeight,Ot=window.getComputedStyle(at),$t=parseInt(Ot.borderTopWidth,10),Kt=parseInt(Ot.paddingTop,10),Lt=parseInt(Ot.borderBottomWidth,10),Nt=parseInt(Ot.paddingBottom,10),Bt=$t+Kt+jt+Nt+Lt,kt=Math.min(ht.offsetHeight*5,Bt),rn=window.getComputedStyle(dt),Gt=parseInt(rn.paddingTop,10),_t=parseInt(rn.paddingBottom,10),sn=St.top+St.height/2-CONTENT_MARGIN,tn=Rt-sn,on=ht.offsetHeight/2,It=ht.offsetTop+on,Zt=$t+Kt+It,Ut=Bt-Zt;if(Zt<=sn){const Ht=Ct.length>0&&ht===Ct[Ct.length-1].ref.current;it.style.bottom="0px";const Pt=at.clientHeight-dt.offsetTop-dt.offsetHeight,Mt=Math.max(tn,on+(Ht?_t:0)+Pt+Lt),Vt=Zt+Mt;it.style.height=Vt+"px"}else{const Ht=Ct.length>0&&ht===Ct[0].ref.current;it.style.top="0px";const Mt=Math.max(sn,$t+dt.offsetTop+(Ht?Gt:0)+on)+Ut;it.style.height=Mt+"px",dt.scrollTop=Zt-sn+dt.offsetTop}it.style.margin=`${CONTENT_MARGIN}px 0`,it.style.minHeight=kt+"px",it.style.maxHeight=Rt+"px",et==null||et(),requestAnimationFrame(()=>ut.current=!0)}},[lt,nt.trigger,nt.valueNode,it,at,dt,ht,ft,nt.dir,et]);useLayoutEffect2$1(()=>gt(),[gt]);const[yt,vt]=reactExports.useState();useLayoutEffect2$1(()=>{at&&vt(window.getComputedStyle(at).zIndex)},[at]);const xt=reactExports.useCallback(St=>{St&&pt.current===!0&&(gt(),mt==null||mt(),pt.current=!1)},[gt,mt]);return jsxRuntimeExports.jsx(SelectViewportProvider,{scope:_e,contentWrapper:it,shouldExpandOnScrollRef:ut,onScrollButtonChange:xt,children:jsxRuntimeExports.jsx("div",{ref:st,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:yt},children:jsxRuntimeExports.jsx(Primitive$2.div,{...tt,ref:ct,style:{boxSizing:"border-box",maxHeight:"100%",...tt.style}})})})});SelectItemAlignedPosition.displayName=ITEM_ALIGNED_POSITION_NAME;var POPPER_POSITION_NAME="SelectPopperPosition",SelectPopperPosition=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,align:et="start",collisionPadding:tt=CONTENT_MARGIN,...nt}=j,rt=usePopperScope(_e);return jsxRuntimeExports.jsx(Content$1,{...rt,...nt,ref:$,align:et,collisionPadding:tt,style:{boxSizing:"border-box",...nt.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SelectPopperPosition.displayName=POPPER_POSITION_NAME;var[SelectViewportProvider,useSelectViewportContext]=createSelectContext(CONTENT_NAME$2,{}),VIEWPORT_NAME="SelectViewport",SelectViewport=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,nonce:et,...tt}=j,nt=useSelectContentContext(VIEWPORT_NAME,_e),rt=useSelectViewportContext(VIEWPORT_NAME,_e),it=useComposedRefs$2($,nt.onViewportChange),st=reactExports.useRef(0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:et}),jsxRuntimeExports.jsx(Collection$1.Slot,{scope:_e,children:jsxRuntimeExports.jsx(Primitive$2.div,{"data-radix-select-viewport":"",role:"presentation",...tt,ref:it,style:{position:"relative",flex:1,overflow:"hidden auto",...tt.style},onScroll:composeEventHandlers$1(tt.onScroll,at=>{const ot=at.currentTarget,{contentWrapper:ct,shouldExpandOnScrollRef:lt}=rt;if(lt!=null&&lt.current&&ct){const ut=Math.abs(st.current-ot.scrollTop);if(ut>0){const pt=window.innerHeight-CONTENT_MARGIN*2,dt=parseFloat(ct.style.minHeight),ht=parseFloat(ct.style.height),ft=Math.max(dt,ht);if(ft<pt){const mt=ft+ut,gt=Math.min(pt,mt),yt=mt-gt;ct.style.height=gt+"px",ct.style.bottom==="0px"&&(ot.scrollTop=yt>0?yt:0,ct.style.justifyContent="flex-end")}}}st.current=ot.scrollTop})})})]})});SelectViewport.displayName=VIEWPORT_NAME;var GROUP_NAME="SelectGroup",[SelectGroupContextProvider,useSelectGroupContext]=createSelectContext(GROUP_NAME),SelectGroup=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,...et}=j,tt=useId$2();return jsxRuntimeExports.jsx(SelectGroupContextProvider,{scope:_e,id:tt,children:jsxRuntimeExports.jsx(Primitive$2.div,{role:"group","aria-labelledby":tt,...et,ref:$})})});SelectGroup.displayName=GROUP_NAME;var LABEL_NAME="SelectLabel",SelectLabel=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,...et}=j,tt=useSelectGroupContext(LABEL_NAME,_e);return jsxRuntimeExports.jsx(Primitive$2.div,{id:tt.id,...et,ref:$})});SelectLabel.displayName=LABEL_NAME;var ITEM_NAME$1="SelectItem",[SelectItemContextProvider,useSelectItemContext]=createSelectContext(ITEM_NAME$1),SelectItem$1=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,value:et,disabled:tt=!1,textValue:nt,...rt}=j,it=useSelectContext(ITEM_NAME$1,_e),st=useSelectContentContext(ITEM_NAME$1,_e),at=it.value===et,[ot,ct]=reactExports.useState(nt??""),[lt,ut]=reactExports.useState(!1),pt=useComposedRefs$2($,mt=>{var gt;return(gt=st.itemRefCallback)==null?void 0:gt.call(st,mt,et,tt)}),dt=useId$2(),ht=reactExports.useRef("touch"),ft=()=>{tt||(it.onValueChange(et),it.onOpenChange(!1))};if(et==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return jsxRuntimeExports.jsx(SelectItemContextProvider,{scope:_e,value:et,disabled:tt,textId:dt,isSelected:at,onItemTextChange:reactExports.useCallback(mt=>{ct(gt=>gt||((mt==null?void 0:mt.textContent)??"").trim())},[]),children:jsxRuntimeExports.jsx(Collection$1.ItemSlot,{scope:_e,value:et,disabled:tt,textValue:ot,children:jsxRuntimeExports.jsx(Primitive$2.div,{role:"option","aria-labelledby":dt,"data-highlighted":lt?"":void 0,"aria-selected":at&&lt,"data-state":at?"checked":"unchecked","aria-disabled":tt||void 0,"data-disabled":tt?"":void 0,tabIndex:tt?void 0:-1,...rt,ref:pt,onFocus:composeEventHandlers$1(rt.onFocus,()=>ut(!0)),onBlur:composeEventHandlers$1(rt.onBlur,()=>ut(!1)),onClick:composeEventHandlers$1(rt.onClick,()=>{ht.current!=="mouse"&&ft()}),onPointerUp:composeEventHandlers$1(rt.onPointerUp,()=>{ht.current==="mouse"&&ft()}),onPointerDown:composeEventHandlers$1(rt.onPointerDown,mt=>{ht.current=mt.pointerType}),onPointerMove:composeEventHandlers$1(rt.onPointerMove,mt=>{var gt;ht.current=mt.pointerType,tt?(gt=st.onItemLeave)==null||gt.call(st):ht.current==="mouse"&&mt.currentTarget.focus({preventScroll:!0})}),onPointerLeave:composeEventHandlers$1(rt.onPointerLeave,mt=>{var gt;mt.currentTarget===document.activeElement&&((gt=st.onItemLeave)==null||gt.call(st))}),onKeyDown:composeEventHandlers$1(rt.onKeyDown,mt=>{var yt;((yt=st.searchRef)==null?void 0:yt.current)!==""&&mt.key===" "||(SELECTION_KEYS.includes(mt.key)&&ft(),mt.key===" "&&mt.preventDefault())})})})})});SelectItem$1.displayName=ITEM_NAME$1;var ITEM_TEXT_NAME="SelectItemText",SelectItemText=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,className:et,style:tt,...nt}=j,rt=useSelectContext(ITEM_TEXT_NAME,_e),it=useSelectContentContext(ITEM_TEXT_NAME,_e),st=useSelectItemContext(ITEM_TEXT_NAME,_e),at=useSelectNativeOptionsContext(ITEM_TEXT_NAME,_e),[ot,ct]=reactExports.useState(null),lt=useComposedRefs$2($,ft=>ct(ft),st.onItemTextChange,ft=>{var mt;return(mt=it.itemTextRefCallback)==null?void 0:mt.call(it,ft,st.value,st.disabled)}),ut=ot==null?void 0:ot.textContent,pt=reactExports.useMemo(()=>jsxRuntimeExports.jsx("option",{value:st.value,disabled:st.disabled,children:ut},st.value),[st.disabled,st.value,ut]),{onNativeOptionAdd:dt,onNativeOptionRemove:ht}=at;return useLayoutEffect2$1(()=>(dt(pt),()=>ht(pt)),[dt,ht,pt]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Primitive$2.span,{id:st.textId,...nt,ref:lt}),st.isSelected&&rt.valueNode&&!rt.valueNodeHasChildren?reactDomExports.createPortal(nt.children,rt.valueNode):null]})});SelectItemText.displayName=ITEM_TEXT_NAME;var ITEM_INDICATOR_NAME="SelectItemIndicator",SelectItemIndicator=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,...et}=j;return useSelectItemContext(ITEM_INDICATOR_NAME,_e).isSelected?jsxRuntimeExports.jsx(Primitive$2.span,{"aria-hidden":!0,...et,ref:$}):null});SelectItemIndicator.displayName=ITEM_INDICATOR_NAME;var SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",SelectScrollUpButton=reactExports.forwardRef((j,$)=>{const _e=useSelectContentContext(SCROLL_UP_BUTTON_NAME,j.__scopeSelect),et=useSelectViewportContext(SCROLL_UP_BUTTON_NAME,j.__scopeSelect),[tt,nt]=reactExports.useState(!1),rt=useComposedRefs$2($,et.onScrollButtonChange);return useLayoutEffect2$1(()=>{if(_e.viewport&&_e.isPositioned){let it=function(){const at=st.scrollTop>0;nt(at)};const st=_e.viewport;return it(),st.addEventListener("scroll",it),()=>st.removeEventListener("scroll",it)}},[_e.viewport,_e.isPositioned]),tt?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...j,ref:rt,onAutoScroll:()=>{const{viewport:it,selectedItem:st}=_e;it&&st&&(it.scrollTop=it.scrollTop-st.offsetHeight)}}):null});SelectScrollUpButton.displayName=SCROLL_UP_BUTTON_NAME;var SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",SelectScrollDownButton=reactExports.forwardRef((j,$)=>{const _e=useSelectContentContext(SCROLL_DOWN_BUTTON_NAME,j.__scopeSelect),et=useSelectViewportContext(SCROLL_DOWN_BUTTON_NAME,j.__scopeSelect),[tt,nt]=reactExports.useState(!1),rt=useComposedRefs$2($,et.onScrollButtonChange);return useLayoutEffect2$1(()=>{if(_e.viewport&&_e.isPositioned){let it=function(){const at=st.scrollHeight-st.clientHeight,ot=Math.ceil(st.scrollTop)<at;nt(ot)};const st=_e.viewport;return it(),st.addEventListener("scroll",it),()=>st.removeEventListener("scroll",it)}},[_e.viewport,_e.isPositioned]),tt?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...j,ref:rt,onAutoScroll:()=>{const{viewport:it,selectedItem:st}=_e;it&&st&&(it.scrollTop=it.scrollTop+st.offsetHeight)}}):null});SelectScrollDownButton.displayName=SCROLL_DOWN_BUTTON_NAME;var SelectScrollButtonImpl=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,onAutoScroll:et,...tt}=j,nt=useSelectContentContext("SelectScrollButton",_e),rt=reactExports.useRef(null),it=useCollection$1(_e),st=reactExports.useCallback(()=>{rt.current!==null&&(window.clearInterval(rt.current),rt.current=null)},[]);return reactExports.useEffect(()=>()=>st(),[st]),useLayoutEffect2$1(()=>{var ot;const at=it().find(ct=>ct.ref.current===document.activeElement);(ot=at==null?void 0:at.ref.current)==null||ot.scrollIntoView({block:"nearest"})},[it]),jsxRuntimeExports.jsx(Primitive$2.div,{"aria-hidden":!0,...tt,ref:$,style:{flexShrink:0,...tt.style},onPointerDown:composeEventHandlers$1(tt.onPointerDown,()=>{rt.current===null&&(rt.current=window.setInterval(et,50))}),onPointerMove:composeEventHandlers$1(tt.onPointerMove,()=>{var at;(at=nt.onItemLeave)==null||at.call(nt),rt.current===null&&(rt.current=window.setInterval(et,50))}),onPointerLeave:composeEventHandlers$1(tt.onPointerLeave,()=>{st()})})}),SEPARATOR_NAME="SelectSeparator",SelectSeparator=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,...et}=j;return jsxRuntimeExports.jsx(Primitive$2.div,{"aria-hidden":!0,...et,ref:$})});SelectSeparator.displayName=SEPARATOR_NAME;var ARROW_NAME="SelectArrow",SelectArrow=reactExports.forwardRef((j,$)=>{const{__scopeSelect:_e,...et}=j,tt=usePopperScope(_e),nt=useSelectContext(ARROW_NAME,_e),rt=useSelectContentContext(ARROW_NAME,_e);return nt.open&&rt.position==="popper"?jsxRuntimeExports.jsx(Arrow,{...tt,...et,ref:$}):null});SelectArrow.displayName=ARROW_NAME;var BUBBLE_INPUT_NAME="SelectBubbleInput",SelectBubbleInput=reactExports.forwardRef(({__scopeSelect:j,value:$,..._e},et)=>{const tt=reactExports.useRef(null),nt=useComposedRefs$2(et,tt),rt=usePrevious($);return reactExports.useEffect(()=>{const it=tt.current;if(!it)return;const st=window.HTMLSelectElement.prototype,ot=Object.getOwnPropertyDescriptor(st,"value").set;if(rt!==$&&ot){const ct=new Event("change",{bubbles:!0});ot.call(it,$),it.dispatchEvent(ct)}},[rt,$]),jsxRuntimeExports.jsx(Primitive$2.select,{..._e,style:{...VISUALLY_HIDDEN_STYLES,..._e.style},ref:nt,defaultValue:$})});SelectBubbleInput.displayName=BUBBLE_INPUT_NAME;function shouldShowPlaceholder(j){return j===""||j===void 0}function useTypeaheadSearch(j){const $=useCallbackRef$1(j),_e=reactExports.useRef(""),et=reactExports.useRef(0),tt=reactExports.useCallback(rt=>{const it=_e.current+rt;$(it),function st(at){_e.current=at,window.clearTimeout(et.current),at!==""&&(et.current=window.setTimeout(()=>st(""),1e3))}(it)},[$]),nt=reactExports.useCallback(()=>{_e.current="",window.clearTimeout(et.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(et.current),[]),[_e,tt,nt]}function findNextItem(j,$,_e){const tt=$.length>1&&Array.from($).every(at=>at===$[0])?$[0]:$,nt=_e?j.indexOf(_e):-1;let rt=wrapArray(j,Math.max(nt,0));tt.length===1&&(rt=rt.filter(at=>at!==_e));const st=rt.find(at=>at.textValue.toLowerCase().startsWith(tt.toLowerCase()));return st!==_e?st:void 0}function wrapArray(j,$){return j.map((_e,et)=>j[($+et)%j.length])}var Root2$1=Select$1,Trigger$1=SelectTrigger$1,Value=SelectValue$1,Icon=SelectIcon,Portal=SelectPortal,Content2$1=SelectContent$1,Viewport=SelectViewport,Item$1=SelectItem$1,ItemText=SelectItemText,ItemIndicator=SelectItemIndicator;const Select=Root2$1,SelectValue=Value,SelectTrigger=reactExports.forwardRef(({className:j,children:$,..._e},et)=>jsxRuntimeExports.jsxs(Trigger$1,{ref:et,className:cn("flex h-10 w-full items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",j),..._e,children:[$,jsxRuntimeExports.jsx(Icon,{asChild:!0,children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 opacity-50"})})]}));SelectTrigger.displayName=Trigger$1.displayName;const SelectContent=reactExports.forwardRef(({className:j,children:$,position:_e="popper",...et},tt)=>jsxRuntimeExports.jsx(Portal,{children:jsxRuntimeExports.jsx(Content2$1,{ref:tt,className:cn("relative z-50 min-w-[8rem] overflow-hidden rounded-lg border border-slate-200 bg-white text-slate-900 shadow-md animate-in fade-in-80",_e==="popper"&&"translate-y-1",j),position:_e,...et,children:jsxRuntimeExports.jsx(Viewport,{className:cn("p-1",_e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:$})})}));SelectContent.displayName=Content2$1.displayName;const SelectItem=reactExports.forwardRef(({className:j,children:$,..._e},et)=>jsxRuntimeExports.jsxs(Item$1,{ref:et,className:cn("relative flex w-full cursor-default select-none items-center rounded-md py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-slate-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",j),..._e,children:[jsxRuntimeExports.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:jsxRuntimeExports.jsx(ItemIndicator,{children:jsxRuntimeExports.jsx(Check,{className:"h-4 w-4"})})}),jsxRuntimeExports.jsx(ItemText,{children:$})]}));SelectItem.displayName=Item$1.displayName;const scenarioIcons=[{icon:MessageSquare,color:"text-blue-500",bg:"bg-blue-100"},{icon:Target,color:"text-purple-500",bg:"bg-purple-100"},{icon:Zap,color:"text-amber-500",bg:"bg-amber-100"},{icon:Users,color:"text-green-500",bg:"bg-green-100"},{icon:Briefcase,color:"text-rose-500",bg:"bg-rose-100"},{icon:Sparkles,color:"text-cyan-500",bg:"bg-cyan-100"}],getDifficultyColor$1=j=>{switch(j==null?void 0:j.toUpperCase()){case"BEGINNER":return"bg-green-100 text-green-700 border-green-200";case"INTERMEDIATE":return"bg-amber-100 text-amber-700 border-amber-200";case"ADVANCED":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};function PracticePage(){const[j,$]=reactExports.useState([]),[_e,et]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[rt,it]=reactExports.useState(!1),[st,at]=reactExports.useState(null),[ot,ct]=reactExports.useState(""),[lt]=useSearchParams(),ut=lt.get("skill"),[pt,dt]=reactExports.useState(""),{data:ht=[],isLoading:ft}=useQuery({queryKey:["/api/avatar/avatar-roles"],queryFn:async()=>{const yt=await fetch("/api/avatar/avatar-roles");if(!yt.ok)throw new Error("Failed to fetch roles");const vt=await yt.json();return vt==null?void 0:vt.data}});reactExports.useEffect(()=>{let yt=!0,vt=new AbortController;return(async()=>{try{it(!0);const St=new URLSearchParams;st&&St.append("skillId",st.toString()),pt&&St.append("role",pt.toString());const[Et,wt]=await Promise.all([fetch(`/api/avatar/get-scenarios?${St.toString()||""}`,{signal:vt.signal}),fetch("/api/avatar/get-skills",{signal:vt.signal})]),[Tt,Ct]=await Promise.all([Et.json(),wt.json()]);if(!yt)return;if(Tt.success){const Rt=Tt.scenarios.map(jt=>({id:jt.id,skillId:jt.skill_id||jt.skillId,name:jt.name,description:jt.description||"",context:jt.context||"",instructions:jt.instructions||"",difficulty:jt.difficulty||"STANDARD",knowledgeId:jt.knowledge_id||jt.knowledgeId||"",image:jt.image||"/demo.png"}));et(Rt),nt(Rt)}Ct.success&&Ct.skills&&$(Ct.skills)}catch(St){console.error("Error loading data:",St)}finally{it(!1)}})(),()=>{yt=!1}},[st,pt]),reactExports.useEffect(()=>{ut&&ut!==st&&at(ut)},[ut]),reactExports.useEffect(()=>{if(ot.trim()){const yt=_e.filter(vt=>vt.name.toLowerCase().includes(ot.toLowerCase())||vt.description.toLowerCase().includes(ot.toLowerCase()));nt(yt)}else nt(_e)},[ot,_e]);const mt=j.find(yt=>yt.id===st),gt=yt=>{at(yt),yt?window.history.pushState({},"",`/avatar/practice?skill=${yt}`):window.history.pushState({},"","/avatar/practice")};return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:rt||ft?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-screen",children:jsxRuntimeExports.jsx(LoadingSpinner,{})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-7xl",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs(Link,{to:"/avatar/dashboard",className:"inline-flex items-center text-gray-500 hover:text-primary mb-4 text-sm font-medium transition-colors","data-testid":"link-back-dashboard",children:[jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 rotate-180 mr-1"}),"Back to Dashboard"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900","data-testid":"text-page-title",children:st&&mt?`${mt.name} Scenarios`:"Practice Scenarios"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-1","data-testid":"text-page-subtitle",children:"Choose a scenario to practice with voice-first AI conversations"})]}),jsxRuntimeExports.jsxs("div",{className:"relative w-full lg:w-80",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),jsxRuntimeExports.jsx(Input,{type:"text",placeholder:"Search scenarios...",value:ot,onChange:yt=>ct(yt.target.value),className:"pl-10 bg-white border-gray-200","data-testid":"input-search-scenarios"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-6 shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>gt(null),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${st?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-primary text-white shadow-sm"}`,"data-testid":"button-filter-all",children:["All (",_e.length,")"]}),j.map(yt=>jsxRuntimeExports.jsxs("button",{onClick:()=>gt(yt.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${st===yt.id?"bg-primary text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"data-testid":`button-filter-skill-${yt.id}`,children:[yt.name,yt.scenario_count>0&&jsxRuntimeExports.jsxs("span",{className:"ml-1.5 opacity-75",children:["(",yt.scenario_count,")"]})]},yt.id))]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-4 h-4 text-gray-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"Role:"})]}),jsxRuntimeExports.jsxs(Select,{value:pt||"all",onValueChange:yt=>dt(yt==="all"?"":yt),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-44 bg-white","data-testid":"select-role-filter",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"All Roles"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"All Roles"}),ht.map(yt=>jsxRuntimeExports.jsx(SelectItem,{value:yt,children:yt},yt))]})]})]})]})}),tt.length>0&&jsxRuntimeExports.jsx("div",{className:"mb-4",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-700",children:tt.length})," scenario",tt.length!==1?"s":""]})}),tt.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border border-gray-200",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-2xl flex items-center justify-center",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-10 h-10 text-gray-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No scenarios found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-4 max-w-md mx-auto",children:ot?"Try adjusting your search or filters to find what you're looking for.":"Try selecting a different category or check back later for new scenarios."}),(st||ot)&&jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>{gt(null),ct("")},"data-testid":"button-clear-filters",children:"Clear Filters"})]}):jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:tt.map((yt,vt)=>{const xt=scenarioIcons[vt%scenarioIcons.length],St=xt.icon;return jsxRuntimeExports.jsx(Link,{to:`/avatar/practice/avatar-select?scenarioId=${yt.id}`,className:"block",children:jsxRuntimeExports.jsx(Card,{className:"group bg-white border border-gray-200 hover:border-primary/30 hover:shadow-lg transition-all duration-200 overflow-hidden cursor-pointer","data-testid":`card-scenario-${yt.id}`,children:jsxRuntimeExports.jsx(CardContent,{className:"p-0",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:`w-20 flex-shrink-0 ${xt.bg} flex items-center justify-center`,children:jsxRuntimeExports.jsx(St,{className:`w-8 h-8 ${xt.color}`})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 p-4 flex flex-col min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-gray-900 line-clamp-1 group-hover:text-primary transition-colors",children:yt.name}),jsxRuntimeExports.jsx(Badge,{variant:"outline",className:`flex-shrink-0 text-xs ${getDifficultyColor$1(yt.difficulty)}`,children:yt.difficulty||"Standard"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3 flex-1",children:yt.description||"Practice this scenario with an AI-powered avatar to improve your communication skills."}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400",children:"Voice-First AI Practice"}),jsxRuntimeExports.jsx(Button,{size:"sm",className:"bg-primary hover:bg-primary/90 text-white h-8 px-4 text-sm font-medium","data-testid":`button-start-scenario-${yt.id}`,children:"Start Voice Practice"})]})]})]})})})},yt.id)})})]})})})}const entryOptions=[{id:"common",icon:jsxRuntimeExports.jsx(BookOpen,{className:"w-8 h-8"}),title:"Practice a common scenario",description:"Browse pre-built scenarios organized by skill. Great for systematic practice.",route:"/avatar/practice",color:"text-blue-600",bgColor:"bg-blue-50 hover:bg-blue-100"},{id:"custom",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"w-8 h-8"}),title:"Practice my real situation",description:"Describe a conversation you're preparing for. We'll help you practice it.",route:"/avatar/practice/custom-scenario",color:"text-purple-600",bgColor:"bg-purple-50 hover:bg-purple-100"},{id:"explore",icon:jsxRuntimeExports.jsx(Lightbulb,{className:"w-8 h-8"}),title:"Just explore a topic",description:"Have a thoughtful conversation to explore ideas or reflect on something.",route:"/avatar/practice/explore",color:"text-emerald-600",bgColor:"bg-emerald-50 hover:bg-emerald-100"}];function IntentEntryPage(){const j=useNavigate(),[$,_e]=reactExports.useState(null);return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-6 py-12 max-w-4xl",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-12",children:[jsxRuntimeExports.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-6",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4"}),"Conversation Practice Lab"]}),jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-slate-900 mb-4",children:"What kind of conversation are you preparing for?"}),jsxRuntimeExports.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Choose how you'd like to practice today. Each path leads to realistic, voice-first practice with an AI avatar."})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:entryOptions.map(et=>jsxRuntimeExports.jsx(Card,{className:`cursor-pointer transition-all duration-200 border-2 ${$===et.id?`border-${et.color.split("-")[1]}-300 shadow-lg`:"border-transparent hover:border-slate-200"} ${et.bgColor}`,onMouseEnter:()=>_e(et.id),onMouseLeave:()=>_e(null),onClick:()=>j(et.route),children:jsxRuntimeExports.jsxs("div",{className:"p-6 flex items-center gap-6",children:[jsxRuntimeExports.jsx("div",{className:`${et.color} p-4 rounded-xl bg-white shadow-sm`,children:et.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-1",children:et.title}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:et.description})]}),jsxRuntimeExports.jsx(ArrowRight,{className:`w-6 h-6 transition-transform duration-200 ${$===et.id?"translate-x-1 text-slate-700":"text-slate-400"}`})]})},et.id))}),jsxRuntimeExports.jsxs("div",{className:"mt-12 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Not sure where to start?"}),jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>j("/avatar/dashboard"),className:"text-slate-600",children:"View your practice history"})]})]})})})}const TENSION_ARCHETYPES=[{id:"misaligned_expectations",label:"Misaligned Expectations",description:"Different assumptions about what should happen",examples:["Timeline disagreements","Scope confusion","Quality standards gap"]},{id:"power_imbalance",label:"Power Imbalance",description:"Unequal authority or influence in the conversation",examples:["Speaking up to leadership","Pushing back on decisions","Challenging authority"]},{id:"emotional_defensiveness",label:"Emotional Defensiveness",description:"The other person may react emotionally to feedback or challenges",examples:["Delivering criticism","Addressing performance","Confronting behavior"]},{id:"uncertainty_ambiguity",label:"Uncertainty / Ambiguity",description:"Lack of clarity about facts, expectations, or next steps",examples:["Unclear requirements","Changing priorities","Unknown outcomes"]},{id:"time_pressure",label:"Time Pressure",description:"Urgency that limits discussion or decision-making",examples:["Tight deadlines","Quick decisions needed","Limited meeting time"]},{id:"value_disagreement",label:"Value Disagreement",description:"Different beliefs about what matters most",examples:["Ethical concerns","Priority conflicts","Cultural differences"]},{id:"fear_of_consequences",label:"Fear of Consequences",description:"Concern about negative outcomes from speaking up",examples:["Career impact","Relationship damage","Reputation risk"]},{id:"conflicting_incentives",label:"Conflicting Incentives",description:"Different motivations or goals between parties",examples:["Resource competition","Credit attribution","Competing priorities"]},{id:"honesty_vs_harmony",label:"Honesty vs Harmony",description:"Tension between being truthful and maintaining the relationship",examples:["Difficult feedback","Saying no","Expressing disagreement"]},{id:"resistance_to_change",label:"Resistance to Change",description:"The other person is reluctant to accept new ideas or directions",examples:["Process changes","New approaches","Shifting strategies"]},{id:"credibility_challenge",label:"Credibility Challenge",description:"Your expertise or position may be questioned",examples:["New in role","Crossing domains","Unpopular opinion"]},{id:"high_stakes_low_trust",label:"High Stakes, Low Trust",description:"Important conversation with limited relationship foundation",examples:["New relationships","Past conflicts","Skeptical audience"]}],COUNTER_PERSONA_ARCHETYPES=[{id:"skeptical_peer",label:"Skeptical Peer",description:"Questions ideas and seeks evidence",caresAbout:"accuracy",pressureResponse:"challenges_logic",trigger:"perceived_incompetence",behaviorHints:["Asks probing questions","Requests data","Plays devil's advocate"]},{id:"impatient_stakeholder",label:"Impatient Stakeholder",description:"Focuses on speed and results",caresAbout:"speed",pressureResponse:"pushes_back",trigger:"uncertainty",behaviorHints:["Interrupts","Wants bottom line first","Pushes for commitment"]},{id:"defensive_manager",label:"Defensive Manager",description:"Protects their decisions and team",caresAbout:"control",pressureResponse:"becomes_rigid",trigger:"being_questioned",behaviorHints:["Justifies past decisions","Deflects criticism","Pulls rank"]},{id:"idealistic_thinker",label:"Idealistic Thinker",description:"Prioritizes principles over practicality",caresAbout:"fairness",pressureResponse:"becomes_emotional",trigger:"value_conflict",behaviorHints:["Appeals to values","Struggles with compromise","Sees big picture"]},{id:"risk_averse_authority",label:"Risk-Averse Authority",description:"Prioritizes safety and stability over innovation",caresAbout:"safety",pressureResponse:"withdraws",trigger:"uncertainty",behaviorHints:["Asks about risks","Prefers proven approaches","Seeks guarantees"]},{id:"emotionally_invested",label:"Emotionally Invested Partner",description:"Takes things personally, cares deeply about outcomes",caresAbout:"recognition",pressureResponse:"becomes_emotional",trigger:"feeling_ignored",behaviorHints:["Expresses feelings","Seeks validation","May become hurt"]},{id:"overconfident_expert",label:"Overconfident Expert",description:"Believes strongly in their expertise",caresAbout:"status",pressureResponse:"pushes_back",trigger:"being_questioned",behaviorHints:["Dismisses alternatives","Cites experience","Speaks with certainty"]},{id:"passive_resistor",label:"Passive Resistor",description:"Agrees superficially but doesn't commit",caresAbout:"stability",pressureResponse:"withdraws",trigger:"losing_control",behaviorHints:["Says yes but delays","Raises obstacles later","Avoids direct conflict"]}],USER_OBJECTIVES=[{id:"clarify",label:"Clarify",description:"Make understanding explicit",successIndicators:["Shared understanding established","Ambiguity resolved","Clear next steps defined"],promptHint:"Help the user articulate and confirm mutual understanding"},{id:"align",label:"Align",description:"Reach shared ground",successIndicators:["Agreement on key points","Commitment to direction","Buy-in achieved"],promptHint:"Create opportunities for finding common ground while presenting different perspectives"},{id:"influence",label:"Influence",description:"Shift perspective or decision",successIndicators:["Other party considers new angle","Decision moved in desired direction","Mind changed"],promptHint:"Be initially resistant to change, requiring compelling arguments to shift position"},{id:"set_boundaries",label:"Set Boundaries",description:"Protect time, scope, or values",successIndicators:["Limits clearly communicated","Boundaries respected","Terms established"],promptHint:"Push against the user's boundaries to test their firmness and clarity"},{id:"resolve",label:"Resolve",description:"Close an issue or conflict",successIndicators:["Issue addressed","Path forward agreed","Tension reduced"],promptHint:"Maintain the tension initially, requiring skilled navigation to reach resolution"},{id:"explore",label:"Explore",description:"Understand viewpoints without requiring a decision",successIndicators:["Perspectives shared","Understanding deepened","Options surfaced"],promptHint:"Share perspectives openly and engage in genuine exploration of ideas"},{id:"reflect",label:"Reflect",description:"Articulate thinking or emotions",successIndicators:["Thoughts clarified","Feelings expressed","Insights gained"],promptHint:"Ask thoughtful questions that help the user articulate their thoughts and feelings"}],CONVERSATION_MODES=[{id:"explore",label:"Explore",description:"Curiosity, openness, understanding",avatarBehavior:["Asks open questions","Shows genuine interest","Follows threads"],pacing:"relaxed"},{id:"persuade",label:"Persuade",description:"Framing, logic, emotional appeal",avatarBehavior:["Presents counterpoints","Tests arguments","Requires convincing"],pacing:"engaged"},{id:"resolve",label:"Resolve",description:"Closure, agreement, next steps",avatarBehavior:["Drives toward decision","Seeks commitment","Addresses blockers"],pacing:"focused"},{id:"reflect",label:"Reflect",description:"Insight, self-expression, meaning",avatarBehavior:["Asks deepening questions","Creates space","Mirrors back"],pacing:"slow"},{id:"challenge",label:"Challenge",description:"Testing ideas, surfacing assumptions",avatarBehavior:["Pushes back","Questions premises","Plays devil's advocate"],pacing:"intense"}],SKILL_LENSES=[{id:"clarity_of_thought",label:"Clarity of Thought",description:"Organizing and expressing ideas clearly",feedbackFocus:["Structure of arguments","Logical flow","Conciseness"]},{id:"assertiveness",label:"Assertiveness",description:"Expressing views confidently without aggression",feedbackFocus:["Directness","Confidence in statements","Standing ground"]},{id:"active_listening",label:"Active Listening",description:"Understanding and responding to what others say",feedbackFocus:["Acknowledgment","Building on points","Asking follow-ups"]},{id:"emotional_regulation",label:"Emotional Regulation",description:"Managing emotions during difficult moments",feedbackFocus:["Tone stability","Response to pressure","Composure"]},{id:"structured_reasoning",label:"Structured Reasoning",description:"Using logic and evidence effectively",feedbackFocus:["Evidence use","Logical connections","Addressing counterpoints"]},{id:"presence_confidence",label:"Presence & Confidence",description:"Projecting confidence and authority",feedbackFocus:["Pacing","Filler words","Certainty of language"]},{id:"questioning",label:"Questioning",description:"Asking effective questions to understand and guide",feedbackFocus:["Question quality","Follow-up questions","Curiosity shown"]}];function getTensionById(j){return TENSION_ARCHETYPES.find($=>$.id===j)}function getCounterPersonaById(j){return COUNTER_PERSONA_ARCHETYPES.find($=>$.id===j)}function getObjectiveById(j){return USER_OBJECTIVES.find($=>$.id===j)}function getModeById(j){return CONVERSATION_MODES.find($=>$.id===j)}function getSkillLensById(j){return SKILL_LENSES.find($=>$.id===j)}function generateAvatarPromptFromBlueprint(j){var rt,it,st,at;const $=getCounterPersonaById(j.counterPersona.archetype),_e=getModeById(j.conversationMode),et=getObjectiveById(j.userObjective),tt=getTensionById(j.tension.primary);return`
## Your Role & Behavior

You are playing the role described below. Stay in character throughout the conversation.
${j.scenarioSummary.userRole||j.scenarioSummary.avatarRole?`
### Role Assignment
- The USER is playing: ${j.scenarioSummary.userRole||"the professional practicing their skills"}
- YOU are playing: ${j.scenarioSummary.avatarRole||j.scenarioSummary.counterPersonaDescription}
`:""}
### Who You Are
${j.scenarioSummary.avatarRole?`${j.scenarioSummary.avatarRole} - `:""}${j.scenarioSummary.counterPersonaDescription}

### Your Primary Concern
You care most about: ${($==null?void 0:$.caresAbout)||j.counterPersona.caresAbout}

### How You Respond Under Pressure
When challenged or pressed, you tend to: ${((rt=$==null?void 0:$.pressureResponse)==null?void 0:rt.replace(/_/g," "))||j.counterPersona.pressureResponse}

### What Triggers You
You become more difficult when: ${((it=$==null?void 0:$.trigger)==null?void 0:it.replace(/_/g," "))||j.counterPersona.trigger}

### Behavioral Guidelines
${((st=$==null?void 0:$.behaviorHints)==null?void 0:st.map(ot=>`- ${ot}`).join(`
`))||"- Stay in character"}

## Conversation Context

### The Situation
${j.scenarioSummary.context}

### The Core Tension
${(tt==null?void 0:tt.description)||j.tension.primary}

### What Makes This Tricky
${j.scenarioSummary.whatMakesItTricky}

## Conversation Mode: ${(_e==null?void 0:_e.label)||j.conversationMode}

${(_e==null?void 0:_e.description)||""}

Pacing: ${(_e==null?void 0:_e.pacing)||"natural"}

Your behavior in this mode:
${((at=_e==null?void 0:_e.avatarBehavior)==null?void 0:at.map(ot=>`- ${ot}`).join(`
`))||"- Engage naturally"}

## The User's Objective (hidden from user)

The user is trying to: ${et==null?void 0:et.label} - ${et==null?void 0:et.description}

Your role: ${(et==null?void 0:et.promptHint)||"Engage authentically with appropriate resistance"}

Remember: You are NOT trying to help the user succeed easily. You are creating realistic resistance that helps them practice. Be authentic to your character while remaining professional.
`.trim()}function inferFrameworkFromScenario(j){var st;const $=`${j.name} ${j.description||""} ${j.context||""} ${j.instructions||""}`.toLowerCase();let _e="misaligned_expectations";$.includes("denied")||$.includes("promotion")||$.includes("salary")||$.includes("raise")?_e="power_imbalance":$.includes("feedback")||$.includes("performance")||$.includes("criticism")?_e="emotional_defensiveness":$.includes("deadline")||$.includes("busy")||$.includes("urgent")||$.includes("tight")?_e="time_pressure":$.includes("conflict")||$.includes("disagree")||$.includes("concern")?_e="value_disagreement":$.includes("miscommunication")||$.includes("unclear")||$.includes("clarif")?_e="uncertainty_ambiguity":($.includes("boundary")||$.includes("accommodation")||$.includes("leave")||$.includes("support"))&&(_e="honesty_vs_harmony");let et="skeptical_peer";const tt=((st=j.avatarRole)==null?void 0:st.toLowerCase())||"";tt.includes("manager")||tt.includes("boss")||tt.includes("leader")||$.includes("manager")?et="defensive_manager":tt.includes("stakeholder")||tt.includes("client")||tt.includes("exec")?et="impatient_stakeholder":tt.includes("hr")||tt.includes("human resources")?et="risk_averse_authority":(tt.includes("colleague")||tt.includes("peer")||tt.includes("teammate"))&&($.includes("deadline")||$.includes("miss")?et="passive_resistor":et="skeptical_peer");let nt="align";$.includes("ask")||$.includes("request")||$.includes("negotiate")?nt="influence":$.includes("clarif")||$.includes("understand")||$.includes("miscommunication")?nt="clarify":$.includes("address")||$.includes("resolve")||$.includes("concern")?nt="resolve":($.includes("boundary")||$.includes("accommodation")||$.includes("support"))&&(nt="set_boundaries");let rt="resolve";$.includes("explore")||$.includes("brainstorm")||$.includes("discuss")?rt="explore":$.includes("negotiate")||$.includes("persuade")||$.includes("convince")?rt="persuade":($.includes("reflect")||$.includes("feedback"))&&(rt="reflect");let it="clarity_of_thought";return $.includes("assert")||$.includes("stand up")||$.includes("push back")?it="assertiveness":$.includes("listen")||$.includes("understand")||$.includes("hear")?it="active_listening":$.includes("emotion")||$.includes("difficult")||$.includes("tense")?it="emotional_regulation":($.includes("present")||$.includes("confiden"))&&(it="presence_confidence"),{tension:_e,counterPersona:et,objective:nt,mode:rt,skillLens:it}}function createBlueprintFromScenario(j){var et,tt;const $=inferFrameworkFromScenario(j),_e=getCounterPersonaById($.counterPersona);return{context:"workplace_semiformal",counterPersona:{archetype:$.counterPersona,caresAbout:(_e==null?void 0:_e.caresAbout)||"results",pressureResponse:(_e==null?void 0:_e.pressureResponse)||"pushes_back",trigger:(_e==null?void 0:_e.trigger)||"being_challenged"},tension:{primary:$.tension},userObjective:$.objective,conversationMode:$.mode,skillLens:{primary:$.skillLens},scenarioSummary:{title:j.name,context:j.context||j.description||"",counterPersonaDescription:j.avatarRole?`A ${j.avatarRole} in a professional setting`:"A colleague in a professional setting",whatMakesItTricky:`This scenario involves ${((et=getTensionById($.tension))==null?void 0:et.label)||$.tension}`,objectiveStatement:`${((tt=getObjectiveById($.objective))==null?void 0:tt.description)||$.objective}`}}}function CustomScenarioPage(){var kt,rn;const j=useNavigate(),{isAuthenticated:$}=useAuth$1(),[_e,et]=reactExports.useState("describe"),[tt,nt]=reactExports.useState(""),[rt,it]=reactExports.useState({relationshipType:null,challenges:[],objective:null}),[st,at]=reactExports.useState("resolve"),[ot,ct]=reactExports.useState(null),[lt,ut]=reactExports.useState(!1),[pt,dt]=reactExports.useState(null),[ht,ft]=reactExports.useState(!1),[mt,gt]=reactExports.useState(""),[yt,vt]=reactExports.useState(""),[xt,St]=reactExports.useState(!1),[Et,wt]=reactExports.useState(""),[Tt,Ct]=reactExports.useState([]),[Rt,jt]=reactExports.useState(""),Ot=()=>{tt.trim().length>10&&(et("clarify"),$t(tt))},$t=async Gt=>{St(!0);try{const _t=await fetch("/api/avatar/custom-scenarios/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scenarioDescription:Gt})});if(_t.ok){const sn=await _t.json();gt(sn.userRole||""),vt(sn.avatarRole||""),wt(sn.rationale||""),jt(sn.title||""),sn.relationshipType&&it(tn=>({...tn,relationshipType:sn.relationshipType})),sn.challenges&&sn.challenges.length>0&&(Ct(sn.challenges),it(tn=>({...tn,challenges:sn.challenges.slice(0,2)}))),sn.suggestedObjective&&it(tn=>({...tn,objective:sn.suggestedObjective}))}}catch(_t){console.error("Failed to analyze scenario:",_t)}finally{St(!1)}},Kt=Gt=>{it(_t=>_t.challenges.some(tn=>tn.id===Gt.id)?{..._t,challenges:_t.challenges.filter(tn=>tn.id!==Gt.id)}:_t.challenges.length<2?{..._t,challenges:[..._t.challenges,Gt]}:{..._t,challenges:[_t.challenges[1],Gt]})},Lt=()=>{var on,It;const Gt=COUNTER_PERSONA_ARCHETYPES.find(Zt=>Zt.id==="skeptical_peer"),_t=rt.relationshipType,sn=rt.objective;rt.challenges.map(Zt=>Zt.label).join(" and ");const tn={context:"workplace_semiformal",counterPersona:{archetype:"skeptical_peer",caresAbout:(Gt==null?void 0:Gt.caresAbout)||"results",pressureResponse:(Gt==null?void 0:Gt.pressureResponse)||"pushes_back",trigger:(Gt==null?void 0:Gt.trigger)||"uncertainty"},tension:{primary:((on=rt.challenges[0])==null?void 0:on.id)||"misaligned_expectations",secondary:(It=rt.challenges[1])==null?void 0:It.id},userObjective:(sn==null?void 0:sn.id)||"resolve",conversationMode:st,skillLens:{primary:"assertiveness",secondary:"clarity_of_thought"},scenarioSummary:{title:Rt||"Practice Scenario",context:tt,counterPersonaDescription:yt?`${yt}${_t?` - ${_t.description}`:""}`:(_t==null?void 0:_t.description)||"The other party in this conversation",whatMakesItTricky:rt.challenges.length>0?rt.challenges.map(Zt=>`${Zt.label}: ${Zt.description}`).join(". "):"This conversation requires careful navigation",objectiveStatement:sn?`${sn.label}: ${sn.description}`:"Navigate this conversation effectively",userRole:mt||void 0,avatarRole:yt||void 0}};ct(tn),et("preview"),$&&Nt(tn,mt,yt)},Nt=async(Gt,_t,sn)=>{var tn;if($){ut(!0),dt(null),ft(!1);try{const on=await fetch("/api/avatar/custom-scenarios",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:Gt.scenarioSummary.title,userDescription:tt,blueprint:Gt,userRole:_t||null,avatarRole:sn||null})});if(on.ok){const It=await on.json();dt(((tn=It.scenario)==null?void 0:tn.id)||null)}else ft(!0)}catch(on){console.error("Failed to save scenario:",on),ft(!0)}finally{ut(!1)}}},Bt=()=>{if(ot){const Gt=encodeURIComponent(JSON.stringify(ot)),_t=pt?`&customScenarioId=${pt}`:"";j(`/avatar/practice/avatar-select?blueprint=${Gt}&mode=custom${_t}`)}};return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-3xl",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>_e==="describe"?j("/avatar/start"):et(_e==="preview"?"clarify":"describe"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 mb-8",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4"}),"Back"]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2 mb-8",children:["describe","clarify","preview"].map((Gt,_t)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${_e===Gt?"bg-blue-600 text-white":["describe","clarify","preview"].indexOf(_e)>_t?"bg-green-500 text-white":"bg-slate-200 text-slate-600"}`,children:["describe","clarify","preview"].indexOf(_e)>_t?jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}):_t+1}),_t<2&&jsxRuntimeExports.jsx("div",{className:"w-12 h-0.5 bg-slate-200"})]},Gt))}),_e==="describe"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Describe your situation"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Tell us about the conversation you're preparing for. Be as specific as you'd like."})]}),jsxRuntimeExports.jsx(Card,{className:"p-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-purple-50 rounded-xl",children:jsxRuntimeExports.jsx(PenLine,{className:"w-6 h-6 text-purple-600"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("textarea",{value:tt,onChange:Gt=>nt(Gt.target.value),placeholder:"Example: My stakeholder wants a delivery in two weeks. I know it's not realistic, but I don't want to come across as negative or incapable...",className:"w-full h-40 p-4 border border-slate-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-2",children:tt.length<10?"Keep typing... be specific about what makes this conversation challenging.":""})]})]})}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsxs(Button,{onClick:Ot,disabled:tt.trim().length<10,className:"bg-blue-600 hover:bg-blue-700",children:["Continue",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4 ml-2"})]})})]}),_e==="clarify"&&jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:xt?"Analyzing your scenario...":"Here's what I understood"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:xt?"Using AI to understand your scenario context...":"Review and adjust these details as needed."})]}),xt?jsxRuntimeExports.jsxs(Card,{className:"p-8 flex flex-col items-center justify-center space-y-4",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-8 h-8 animate-spin text-blue-600"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Analyzing roles, challenges, and objectives..."})]}):jsxRuntimeExports.jsxs(Card,{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"border-b border-slate-100 pb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-5 h-5 text-purple-600"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-900",children:"Roles in this conversation"})]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>$t(tt),disabled:xt,className:"text-xs",children:[jsxRuntimeExports.jsx(Wand2,{className:"w-3 h-3 mr-1"}),"Re-analyze"]})]}),Et&&jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500 mb-3 italic bg-slate-50 p-2 rounded",children:Et}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-1.5 text-sm font-medium text-slate-600 mb-2",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4"}),"Your role"]}),jsxRuntimeExports.jsx("input",{type:"text",value:mt,onChange:Gt=>gt(Gt.target.value),placeholder:"e.g., Product Manager",className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-1.5 text-sm font-medium text-slate-600 mb-2",children:[jsxRuntimeExports.jsx(Bot,{className:"w-4 h-4"}),"Avatar's role"]}),jsxRuntimeExports.jsx("input",{type:"text",value:yt,onChange:Gt=>vt(Gt.target.value),placeholder:"e.g., Engineering Lead",className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]}),rt.relationshipType&&jsxRuntimeExports.jsxs("div",{className:"border-b border-slate-100 pb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-blue-600"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-900",children:"Relationship Dynamic"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-blue-900",children:rt.relationshipType.label}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-700 mt-1",children:rt.relationshipType.description})]})]}),Tt.length>0&&jsxRuntimeExports.jsxs("div",{className:"border-b border-slate-100 pb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 text-amber-600"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-900",children:"What makes this difficult?"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-500",children:"(AI-identified challenges)"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:Tt.map(Gt=>jsxRuntimeExports.jsxs("button",{onClick:()=>Kt(Gt),className:`w-full p-4 text-left rounded-lg border-2 transition-all ${rt.challenges.some(_t=>_t.id===Gt.id)?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-slate-300"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-slate-900",children:Gt.label}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-600 mt-1",children:Gt.description})]},Gt.id))})]}),rt.objective&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx(Target,{className:"w-5 h-5 text-green-600"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-900",children:"Your objective"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-green-900",children:rt.objective.label}),jsxRuntimeExports.jsx("p",{className:"text-sm text-green-700 mt-1",children:rt.objective.description})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:()=>et("describe"),children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsxs(Button,{onClick:Lt,disabled:xt||!mt&&!yt,className:"bg-blue-600 hover:bg-blue-700",children:["Generate Scenario",jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 ml-2"})]})]})]}),_e==="preview"&&ot&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Your practice scenario"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Here's what we've set up based on your situation."})]}),jsxRuntimeExports.jsxs(Card,{className:"p-6 space-y-6 border-2 border-blue-100",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:ot.scenarioSummary.title})}),(ot.scenarioSummary.userRole||ot.scenarioSummary.avatarRole)&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-100",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-purple-600"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"You"})]}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-purple-900",children:ot.scenarioSummary.userRole||"Yourself"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center border-l border-purple-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(Bot,{className:"w-4 h-4 text-blue-600"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Avatar"})]}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-blue-900",children:ot.scenarioSummary.avatarRole||"The other person"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Situation"}),jsxRuntimeExports.jsx("p",{className:"text-slate-700",children:ot.scenarioSummary.context})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"The dynamic"}),jsxRuntimeExports.jsx("p",{className:"text-slate-700",children:ot.scenarioSummary.counterPersonaDescription})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Key challenges"}),jsxRuntimeExports.jsx("p",{className:"text-slate-700",children:ot.scenarioSummary.whatMakesItTricky})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Your goal"}),jsxRuntimeExports.jsx("p",{className:"text-slate-700",children:ot.scenarioSummary.objectiveStatement})]}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-slate-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:"Conversation Style"}),jsxRuntimeExports.jsx("div",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:(kt=CONVERSATION_MODES.find(Gt=>Gt.id===ot.conversationMode))==null?void 0:kt.label})]}),$&&jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2 text-sm",children:lt?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-slate-500",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):pt?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),"Saved to your scenarios"]}):ht?jsxRuntimeExports.jsx("span",{className:"flex items-center gap-1 text-red-600",children:"Could not save"}):null})]})})]})]}),!$&&jsxRuntimeExports.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Save,{className:"w-5 h-5 text-amber-600"}),jsxRuntimeExports.jsx("span",{className:"text-amber-800 text-sm",children:"Sign in to save this scenario for later"})]}),jsxRuntimeExports.jsx("a",{href:"/login",className:"text-sm font-medium text-amber-700 hover:text-amber-900 underline",children:"Sign in"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Conversation Mode"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:CONVERSATION_MODES.map(Gt=>jsxRuntimeExports.jsx("button",{onClick:()=>{at(Gt.id),ot&&ct({...ot,conversationMode:Gt.id})},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${ot.conversationMode===Gt.id?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:Gt.label},Gt.id))}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-2",children:(rn=CONVERSATION_MODES.find(Gt=>Gt.id===ot.conversationMode))==null?void 0:rn.description})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between pt-4",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:()=>et("clarify"),children:[jsxRuntimeExports.jsx(PenLine,{className:"w-4 h-4 mr-2"}),"Edit scenario"]}),jsxRuntimeExports.jsx(Button,{onClick:Bt,disabled:lt,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:lt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Start practice",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4 ml-2"})]})})]})]})]})})})}const EXPLORE_TOPICS=[{id:"decision",icon:jsxRuntimeExports.jsx(Compass,{className:"w-6 h-6"}),title:"Think through a decision",description:"Explore the pros and cons of something you're considering",prompt:"Help me think through a decision I'm facing"},{id:"idea",icon:jsxRuntimeExports.jsx(Lightbulb,{className:"w-6 h-6"}),title:"Develop an idea",description:"Talk through an idea to make it clearer and stronger",prompt:"Help me develop and refine an idea"},{id:"perspective",icon:jsxRuntimeExports.jsx(Brain,{className:"w-6 h-6"}),title:"Challenge my thinking",description:"Get a thoughtful counterpoint to stress-test your views",prompt:"Challenge my perspective on something"},{id:"reflect",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"w-6 h-6"}),title:"Reflect on an experience",description:"Process something that happened and gain clarity",prompt:"Help me reflect on a recent experience"}];function ExplorePage(){const j=useNavigate(),[$,_e]=reactExports.useState(null),[et,tt]=reactExports.useState(""),nt=()=>{const rt=EXPLORE_TOPICS.find(at=>at.id===$),it={context:"reflective_coaching",counterPersona:{archetype:"idealistic_thinker",caresAbout:"understanding",pressureResponse:"asks_questions",trigger:"surface_level_thinking"},tension:{primary:"uncertainty_ambiguity"},userObjective:$==="perspective"?"influence":"reflect",conversationMode:$==="perspective"?"challenge":"explore",skillLens:{primary:"clarity_of_thought",secondary:"structured_reasoning"},scenarioSummary:{title:(rt==null?void 0:rt.title)||"Thoughtful Exploration",context:et||(rt==null?void 0:rt.prompt)||"An open exploration of ideas",counterPersonaDescription:"A thoughtful conversational partner who asks good questions and helps you think clearly",whatMakesItTricky:"Articulating thoughts clearly and examining assumptions",objectiveStatement:"Gain clarity and insight through conversation"}},st=encodeURIComponent(JSON.stringify(it));j(`/avatar/practice/avatar-select?blueprint=${st}&mode=explore`)};return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-3xl",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>j("/avatar/start"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 mb-8",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4"}),"Back"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-50 text-emerald-700 px-3 py-1 rounded-full text-sm font-medium mb-4",children:[jsxRuntimeExports.jsx(Lightbulb,{className:"w-4 h-4"}),"Exploration Mode"]}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"What would you like to explore?"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600",children:"Have a thoughtful conversation to develop ideas, challenge your thinking, or reflect on experiences."})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-4",children:EXPLORE_TOPICS.map(rt=>jsxRuntimeExports.jsxs(Card,{className:`p-5 cursor-pointer transition-all ${$===rt.id?"border-2 border-emerald-500 bg-emerald-50":"border-2 border-transparent hover:border-slate-200"}`,onClick:()=>_e(rt.id),children:[jsxRuntimeExports.jsx("div",{className:`mb-3 ${$===rt.id?"text-emerald-600":"text-slate-400"}`,children:rt.icon}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:rt.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-600",children:rt.description})]},rt.id))}),$&&jsxRuntimeExports.jsx("div",{className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Add more context (optional)"}),jsxRuntimeExports.jsx("textarea",{value:et,onChange:rt=>tt(rt.target.value),placeholder:"Tell me more about what you'd like to explore...",className:"w-full h-24 p-4 border border-slate-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),jsxRuntimeExports.jsx("div",{className:"flex justify-end pt-4",children:jsxRuntimeExports.jsxs(Button,{onClick:nt,disabled:!$,className:"bg-emerald-600 hover:bg-emerald-700",children:["Choose an Avatar",jsxRuntimeExports.jsx(ArrowRight,{className:"w-4 h-4 ml-2"})]})})]})]})})})}const useAvatars=({initialPage:j=1,initialLimit:$=30,initialFilters:_e={}}={})=>{const[et,tt]=reactExports.useState(j),[nt]=reactExports.useState($),[rt,it]=reactExports.useState(_e),{data:st,isLoading:at,isError:ot,error:ct,refetch:lt}=useQuery({queryKey:["/api/avatar",et,nt,rt],queryFn:async()=>{const ht=new URLSearchParams;ht.append("page",et.toString()),ht.append("limit",nt.toString()),Object.keys(rt).forEach(mt=>{const gt=rt[mt];gt&&ht.append(mt,gt)});const ft=await fetch(`/api/avatar/list?${ht.toString()}`);if(!ft.ok)throw new Error("Failed to fetch avatars");return ft.json()},placeholderData:ht=>ht}),ut=(st==null?void 0:st.data)||[],pt=(st==null?void 0:st.totalPages)||1,dt=(st==null?void 0:st.total)||0;return{avatarData:ut,isLoading:at,isError:ot,error:ct,page:et,totalPages:pt,totalCount:dt,setPage:tt,filters:rt,setFilters:it,refetch:lt}},useAvatarById=j=>useQuery({queryKey:["avatar",j],queryFn:async()=>{var et;if(!j)throw new Error("Avatar ID is required");const $=await fetch(`/api/avatar/get-avatar/${j}`);if(!$.ok)throw new Error(`Failed to fetch avatar: ${$.statusText}`);const _e=await $.json();if(!_e.success)throw new Error(_e.error||"Unknown error");return(et=_e.data)==null?void 0:et[0]},enabled:!!j});function AvatarSelectPage(){const j=useNavigate(),[$]=useSearchParams(),_e=$.get("scenarioId"),[et,tt]=reactExports.useState(null),nt=useAvatarSession(),{avatarData:rt,isLoading:it,isError:st,page:at,totalPages:ot,setPage:ct,filters:lt,setFilters:ut}=useAvatars(),pt=reactExports.useMemo(()=>{if(!rt||rt.length===0)return[];const ft={};rt.forEach(vt=>{var St;const xt=((St=vt.name)==null?void 0:St.split(" ")[0])||vt.name||"Unknown";ft[xt]||(ft[xt]=[]),ft[xt].push(vt)}),Object.values(ft).forEach(vt=>{for(let xt=vt.length-1;xt>0;xt--){const St=Math.floor(Math.random()*(xt+1));[vt[xt],vt[St]]=[vt[St],vt[xt]]}});const mt=Object.keys(ft);for(let vt=mt.length-1;vt>0;vt--){const xt=Math.floor(Math.random()*(vt+1));[mt[vt],mt[xt]]=[mt[xt],mt[vt]]}const gt=[];let yt=Math.max(...Object.values(ft).map(vt=>vt.length));for(let vt=0;vt<yt;vt++)for(const xt of mt)ft[xt][vt]&&gt.push(ft[xt][vt]);return gt},[rt]);reactExports.useEffect(()=>{nt!=null&&nt.preWarmToken&&(console.log("Pre-warming token on avatar selection page..."),nt.preWarmToken())},[nt]);const dt=ft=>{tt(ft)},ht=()=>{if(et){const ft=$.get("blueprint"),mt=$.get("mode"),gt=$.get("customScenarioId"),yt=new URLSearchParams;yt.set("avatarId",et),_e&&yt.set("scenarioId",_e),ft&&yt.set("blueprint",ft),mt&&yt.set("mode",mt),gt&&yt.set("customScenarioId",gt),j(`/avatar/practice/pre-session?${yt.toString()}`)}};return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-7xl",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs(Link,{to:"/avatar/practice",className:"inline-flex items-center text-gray-500 hover:text-primary mb-4 text-sm font-medium transition-colors","data-testid":"link-back-scenarios",children:[jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 rotate-180 mr-1"}),"Back to Scenarios"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900","data-testid":"text-page-title",children:"Choose Your Practice Partner"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-1","data-testid":"text-page-subtitle",children:"Select an AI avatar to practice with"})]}),et&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-primary/10 text-primary px-4 py-2 rounded-lg",children:[jsxRuntimeExports.jsx(Check,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:"Avatar Selected"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-6 shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-4 h-4 text-gray-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"Filters:"})]}),jsxRuntimeExports.jsxs(Select,{value:lt.gender||"all",onValueChange:ft=>ut({...lt,gender:ft==="all"?void 0:ft}),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-36 bg-white","data-testid":"select-gender-filter",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Gender"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"All Genders"}),jsxRuntimeExports.jsx(SelectItem,{value:"male",children:"Male"}),jsxRuntimeExports.jsx(SelectItem,{value:"female",children:"Female"})]})]}),jsxRuntimeExports.jsxs(Select,{value:lt.ethnicity||"all",onValueChange:ft=>ut({...lt,ethnicity:ft==="all"?void 0:ft}),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-44 bg-white","data-testid":"select-ethnicity-filter",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Ethnicity"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"All Ethnicities"}),jsxRuntimeExports.jsx(SelectItem,{value:"Indian",children:"Indian"}),jsxRuntimeExports.jsx(SelectItem,{value:"Caucasian",children:"Caucasian"}),jsxRuntimeExports.jsx(SelectItem,{value:"African-American",children:"African-American"}),jsxRuntimeExports.jsx(SelectItem,{value:"East Asian",children:"East Asian"}),jsxRuntimeExports.jsx(SelectItem,{value:"Middle Eastern",children:"Middle Eastern"}),jsxRuntimeExports.jsx(SelectItem,{value:"Latinx",children:"Latinx"}),jsxRuntimeExports.jsx(SelectItem,{value:"Southeast Asian",children:"Southeast Asian"}),jsxRuntimeExports.jsx(SelectItem,{value:"Mediterranean",children:"Mediterranean"})]})]})]})}),it?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center py-20",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(LoadingSpinner,{}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-4",children:"Loading avatars..."})]})}):st?jsxRuntimeExports.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-gray-200",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-red-100 rounded-2xl flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-10 h-10 text-red-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Failed to load avatars"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-4",children:"Please try refreshing the page or check back later."}),jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>window.location.reload(),children:"Retry"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 mb-8",children:pt==null?void 0:pt.map(ft=>{var yt,vt;const mt=et===ft.id,gt=((yt=ft==null?void 0:ft.name)==null?void 0:yt.split(" ").length)>1?(vt=ft==null?void 0:ft.name)==null?void 0:vt.split(" ")[0]:ft==null?void 0:ft.name;return jsxRuntimeExports.jsx(Card,{className:`group cursor-pointer transition-all duration-200 overflow-hidden ${mt?"ring-2 ring-primary border-primary shadow-md":"border-gray-200 hover:border-primary/30 hover:shadow-sm"}`,onClick:()=>dt(ft.id),role:"button",tabIndex:0,"data-testid":`card-avatar-${ft.id}`,children:jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsxs("div",{className:"aspect-square relative bg-gradient-to-br from-gray-100 to-gray-50 overflow-hidden",children:[jsxRuntimeExports.jsx("img",{src:ft.imageUrl,alt:ft.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),mt&&jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-primary rounded-full flex items-center justify-center shadow-md",children:jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 text-white"})}),jsxRuntimeExports.jsx("div",{className:"absolute top-2 left-2",children:jsxRuntimeExports.jsx(Badge,{className:"bg-green-100 text-green-700 border-green-200 text-[10px] px-1.5 py-0.5 font-medium",children:"Available"})})]}),jsxRuntimeExports.jsx("div",{className:"p-2 bg-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:gt}),mt&&jsxRuntimeExports.jsx(Check,{className:"w-3 h-3 text-primary flex-shrink-0"})]})})]})},ft.id)})}),ot>1&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 mb-8",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>ct(at-1),disabled:at===1,className:"w-9 h-9 p-0","data-testid":"button-prev-page",children:jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:ot},(ft,mt)=>mt+1).map(ft=>jsxRuntimeExports.jsx(Button,{variant:at===ft?"default":"outline",size:"sm",onClick:()=>ct(ft),className:"w-9 h-9 p-0","data-testid":`button-page-${ft}`,children:ft},ft))}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>ct(at+1),disabled:at===ot,className:"w-9 h-9 p-0","data-testid":"button-next-page",children:jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"sticky bottom-0 bg-gradient-to-t from-gray-50 via-gray-50 to-transparent pt-8 pb-4",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsxs(Button,{size:"lg",onClick:ht,disabled:!et,className:`px-8 py-3 text-base font-semibold min-w-[220px] transition-all ${et?"bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed opacity-60"}`,"data-testid":"button-continue-setup",children:["Continue to Setup",jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 ml-2"})]})}),!et&&jsxRuntimeExports.jsx("p",{className:"text-center text-sm text-gray-400 mt-3",children:"Select an avatar to continue"})]})]})})})}const ENGLISH_ACCENTS=[{id:"american",label:"American English",description:"Standard American accent",heygenLanguageCode:"en"},{id:"british",label:"British English",description:"British received pronunciation",heygenLanguageCode:"en"},{id:"indian",label:"Indian English",description:"Indian-accented English",heygenLanguageCode:"en"},{id:"australian",label:"Australian English",description:"Australian accent",heygenLanguageCode:"en"}];function getAccentFromEthnicity(j){if(!j)return"american";const $=j.toLowerCase();return $.includes("indian")?"indian":$.includes("british")?"british":$.includes("australian")?"australian":($.includes("american")||$.includes("african-american")||$.includes("asian")||$.includes("east asian")||$.includes("southeast asian")||$.includes("german")||$.includes("french")||$.includes("caucasian")||$.includes("middle eastern")||$.includes("latinx")||$.includes("latin"),"american")}function getAccentInstruction(j){switch(j){case"indian":return"Speak with an Indian English accent, using characteristic intonation patterns and rhythm typical of Indian speakers.";case"british":return"Speak with a British accent, using received pronunciation with characteristic British intonation.";case"australian":return"Speak with an Australian accent, with the characteristic rising intonation and Australian vowel sounds.";case"american":default:return"Speak with a standard American English accent."}}const SUPPORTED_LANGUAGES=[{code:"en",name:"English",flag:""},{code:"es",name:"Spanish",flag:""},{code:"fr",name:"French",flag:""},{code:"de",name:"German",flag:""},{code:"it",name:"Italian",flag:""},{code:"pt",name:"Portuguese",flag:""},{code:"zh",name:"Chinese",flag:""},{code:"ja",name:"Japanese",flag:""},{code:"ko",name:"Korean",flag:""},{code:"hi",name:"Hindi",flag:""},{code:"ar",name:"Arabic",flag:""},{code:"ru",name:"Russian",flag:""},{code:"nl",name:"Dutch",flag:""},{code:"pl",name:"Polish",flag:""},{code:"tr",name:"Turkish",flag:""}];function PreSessionPage(){var Gn,xn,_n,Zn,Ft;const j=useNavigate(),[$]=useSearchParams(),_e=$.get("scenarioId"),et=$.get("avatarId"),tt=$.get("blueprint"),nt=$.get("mode"),rt=$.get("customScenarioId"),[it,st]=reactExports.useState(null),[at,ot]=reactExports.useState(!0),[ct,lt]=reactExports.useState("/avatar/practice/session?mode=voice"),[ut,pt]=reactExports.useState($.get("language")||"en"),[dt,ht]=reactExports.useState($.get("culturalPreset")||null),ft=$.get("accent"),[mt,gt]=reactExports.useState(ft||"american"),[yt,vt]=reactExports.useState(!!ft),[xt,St]=reactExports.useState(null),[Et,wt]=reactExports.useState(null),[Tt,Ct]=reactExports.useState(null),[Rt,jt]=reactExports.useState(null),Ot=useAvatarSession(),{data:$t,isLoading:Kt}=useAvatarById(et||void 0);reactExports.useEffect(()=>{if($t!=null&&$t.ethnicity&&ut==="en"&&!yt){const At=getAccentFromEthnicity($t.ethnicity);gt(At),vt(!0)}},[$t==null?void 0:$t.ethnicity,ut,yt]),reactExports.useEffect(()=>{var At;if(tt)try{const Jt=JSON.parse(decodeURIComponent(tt));St(Jt),wt(((At=Jt.counterPersona)==null?void 0:At.archetype)||null),Ct(Jt.userObjective||null),jt(Jt.conversationMode||null)}catch(Jt){console.error("Failed to parse blueprint:",Jt)}finally{ot(!1)}},[tt]);const Lt=reactExports.useMemo(()=>{if(!xt)return null;const At=Et?getCounterPersonaById(Et):null;return{...xt,counterPersona:At?{archetype:Et,caresAbout:At.caresAbout,pressureResponse:At.pressureResponse,trigger:At.trigger}:xt.counterPersona,userObjective:Tt||xt.userObjective,conversationMode:Rt||xt.conversationMode}},[xt,Et,Tt,Rt]);async function Nt(){const At=await fetch("/api/avatar/cultural-presets"),Jt=await At.json();if(!At.ok)throw new Error((Jt==null?void 0:Jt.error)||"Failed to fetch cultural presets");return Jt.presets||[]}const{data:Bt=[]}=useQuery({queryKey:["culturalPresets"],queryFn:Nt}),[kt,rn]=reactExports.useState(0),[Gt,_t]=reactExports.useState(null),[sn,tn]=reactExports.useState(!0),on=reactExports.useRef(rt),It=10;reactExports.useEffect(()=>{on.current=rt,rn(0),_t(null),tn(!!rt)},[rt]);const{data:Zt=[],isLoading:Ut,refetch:Xt,isRefetching:Ht}=useQuery({queryKey:["customScenarioSkills",rt],queryFn:async({queryKey:At})=>{const Jt=At[1];if(!Jt)return[];const vn=await fetch(`/api/avatar/custom-scenarios/${Jt}/skills`,{credentials:"include"});if(on.current!==Jt)return[];if(vn.status===401)return _t("Please log in to view skill mappings"),tn(!1),[];if(!vn.ok)return _t("Failed to load skill mappings. Try refreshing."),tn(!1),[];_t(null);const $n=(await vn.json()).skillMappings||[];return on.current!==Jt||($n.length>0?tn(!1):rn(Yn=>{const er=Yn+1;return er>=It&&tn(!1),er})),$n},enabled:!!rt,refetchInterval:sn?3e3:!1}),Pt=()=>{rn(0),_t(null),tn(!0),Xt()},Mt=Zt.length===0&&kt<It&&!Gt&&sn,Vt=Zt.length===0&&kt>=It&&!Gt;reactExports.useEffect(()=>{_e&&!tt?(async()=>{try{const vn=await(await fetch(`/api/avatar/get-scenarios?scenarioId=${_e}`)).json();if(vn.scenarios&&vn.scenarios.length>0){const bn=vn.scenarios[0];st(bn);const $n=createBlueprintFromScenario({id:bn.id,name:bn.name,description:bn.description,context:bn.context,instructions:bn.instructions,avatarRole:bn.avatarRole||bn.avatar_role,difficulty:bn.difficulty});St($n),wt($n.counterPersona.archetype),Ct($n.userObjective),jt($n.conversationMode)}}catch(Jt){console.error("Error fetching scenario:",Jt)}finally{ot(!1)}})():tt||ot(!1)},[_e,tt]);const qt=()=>Lt?generateAvatarPromptFromBlueprint(Lt):it?`
Context: ${(it==null?void 0:it.context)||"Not specified"}
Description: ${(it==null?void 0:it.description)||"Not specified"}
Instructions: ${(it==null?void 0:it.instructions)||"Not specified"}
${it!=null&&it.avatarRole?`Role: ${it.avatarRole}`:""}

Please be conversational, helpful, and stay in character based on the provided context.
    `.trim():"",en=reactExports.useRef({language:"en"});reactExports.useEffect(()=>{var At,Jt;if((it||Lt)&&et&&Ot&&ct==="/avatar/practice/session"){const vn=qt();en.current.language!==ut&&((At=Ot.preWarmedSession)!=null&&At.isReady||Ot.isWarming)?(console.log("Config changed, restarting warming with new language"),en.current={language:ut},Ot.restartWarming({avatarId:et,knowledgeBase:vn,language:ut})):!((Jt=Ot.preWarmedSession)!=null&&Jt.isReady)&&!Ot.isWarming&&(console.log("Pre-warming avatar session for:",et),en.current={language:ut},Ot.startWarming({avatarId:et,knowledgeBase:vn,language:ut}))}},[it,Lt,et,Ot,ct,ut]),reactExports.useEffect(()=>()=>{var At;Ot&&!((At=Ot.preWarmedSession)!=null&&At.isReady)&&Ot.cancelWarming()},[]);const fn=()=>{const At=ct.includes("mode=voice"),Jt=new URLSearchParams;_e&&Jt.set("scenarioId",_e),et&&Jt.set("avatarId",et),Jt.set("language",ut),Jt.set("autostart","true"),Lt&&Jt.set("blueprint",encodeURIComponent(JSON.stringify(Lt))),rt&&Jt.set("customScenarioId",rt),dt&&Jt.set("culturalPreset",dt),ut==="en"&&mt&&Jt.set("accent",mt),j(At?`/avatar/assessment-session/roleplay?${Jt.toString()}`:`/avatar/practice/session?${Jt.toString()}`)},Cn=At=>{switch(At==null?void 0:At.toLowerCase()){case"beginner":case"easy":return"bg-green-100 text-green-700 border-green-200";case"intermediate":case"medium":return"bg-amber-100 text-amber-700 border-amber-200";case"advanced":case"hard":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},En=nt==="custom"&&Lt;if(at)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50 flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-600",children:"Loading scenario details..."})]})})});if(!it&&!Lt)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50 flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center max-w-md",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-8 h-8 text-red-600"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Scenario Not Found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-6",children:"The practice scenario you're looking for doesn't exist or may have been removed."}),jsxRuntimeExports.jsx(Link,{to:"/avatar/practice",children:jsxRuntimeExports.jsxs(Button,{size:"lg","data-testid":"button-return-practice",children:[jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4 mr-2"}),"Return to Practice"]})})]})})});const Pn=(Gn=Lt==null?void 0:Lt.tension)!=null&&Gn.primary?getTensionById(Lt.tension.primary):null,Rn=(xn=Lt==null?void 0:Lt.tension)!=null&&xn.secondary?getTensionById(Lt.tension.secondary):null;return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-6xl",children:[jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs(Link,{to:En?"/avatar/start":`/avatar/practice/avatar-select?scenarioId=${_e}`,className:"inline-flex items-center text-gray-500 hover:text-primary mb-4 text-sm font-medium transition-colors group","data-testid":"link-back-avatar",children:[jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4 mr-1 group-hover:-translate-x-0.5 transition-transform"}),En?"Back to Start":"Back to Avatar Selection"]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-6 mb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary to-primary/80 rounded-xl",children:jsxRuntimeExports.jsx(Target,{className:"w-5 h-5 text-white"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900","data-testid":"text-page-title",children:En&&Lt?Lt.scenarioSummary.title:(it==null?void 0:it.name)||"Practice Session"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 ml-12",children:"Customize your practice settings and begin when ready"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 ml-12 lg:ml-0",children:[(it==null?void 0:it.difficulty)&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:`${Cn(it.difficulty)} px-3 py-1`,"data-testid":"badge-difficulty",children:[it.difficulty," Level"]}),jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-primary/10 text-primary border-0 px-3 py-1",children:[jsxRuntimeExports.jsx(Mic,{className:"w-3 h-3 mr-1.5"}),"Voice-First"]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-4 space-y-5 order-1 lg:order-2",children:[jsxRuntimeExports.jsx(Card,{className:"border-2 border-primary/20 shadow-lg bg-gradient-to-br from-white to-primary/5 sticky top-6","data-testid":"card-start-session",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-5",children:[$t!=null&&$t.imageUrl?jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-3 rounded-full overflow-hidden ring-4 ring-primary/20 shadow-lg",children:jsxRuntimeExports.jsx("img",{src:$t.imageUrl,alt:$t.name||"Avatar",className:"w-full h-full object-cover"})}):jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-3 bg-gradient-to-br from-primary to-primary/80 rounded-full flex items-center justify-center shadow-lg shadow-primary/20",children:jsxRuntimeExports.jsx(User,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:["Ready to practice",$t!=null&&$t.name?` with ${$t.name}`:"","?"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:ct.includes("mode=voice")?"Voice session starts instantly":"Video avatar connects in seconds"})]}),jsxRuntimeExports.jsx(Button,{size:"lg",onClick:fn,className:"w-full py-6 text-base font-semibold bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg shadow-blue-600/20 transition-all hover:shadow-xl hover:shadow-blue-600/30 hover:-translate-y-0.5","data-testid":"button-start-session",children:ct.includes("mode=voice")?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Mic,{className:"w-5 h-5 mr-2"}),"Start Voice Practice"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Video,{className:"w-5 h-5 mr-2"}),"Start Video Session"]})}),ct.includes("mode=voice")?jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500"}),jsxRuntimeExports.jsx("span",{className:"text-green-600 text-xs font-medium",children:"Voice connects instantly"})]}):Ot&&jsxRuntimeExports.jsx("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm",children:Ot.isWarming?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 animate-spin text-primary"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:Ot.warmingStatus}),Ot.warmingProgress>0&&jsxRuntimeExports.jsxs("span",{className:"text-gray-400",children:["(",Ot.warmingProgress,"%)"]})]}):(_n=Ot.preWarmedSession)!=null&&_n.isReady?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500"}),jsxRuntimeExports.jsx("span",{className:"text-green-600 text-xs font-medium",children:"Video avatar ready"})]}):null})]})}),jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden","data-testid":"card-mode-selection",children:[jsxRuntimeExports.jsx("div",{className:"px-5 py-4 border-b border-gray-100 bg-gray-50/50",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Practice Mode"})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-4 space-y-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>lt("/avatar/practice/session"),className:cn("w-full p-4 rounded-xl border-2 text-left transition-all",ct==="/avatar/practice/session"?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-gray-200 hover:border-primary/50 hover:bg-gray-50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg",ct==="/avatar/practice/session"?"bg-primary text-white":"bg-gray-100 text-gray-500"),children:jsxRuntimeExports.jsx(Video,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:"Video Avatar"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Full video experience"})]}),ct==="/avatar/practice/session"&&jsxRuntimeExports.jsx(CheckCircle2,{className:"w-5 h-5 text-primary"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>lt("/avatar/practice/session?mode=voice"),className:cn("w-full p-4 rounded-xl border-2 text-left transition-all",ct==="/avatar/practice/session?mode=voice"?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-gray-200 hover:border-primary/50 hover:bg-gray-50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:cn("p-2 rounded-lg",ct==="/avatar/practice/session?mode=voice"?"bg-primary text-white":"bg-gray-100 text-gray-500"),children:jsxRuntimeExports.jsx(Mic,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:"Voice Only"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Faster startup"})]}),ct==="/avatar/practice/session?mode=voice"&&jsxRuntimeExports.jsx(CheckCircle2,{className:"w-5 h-5 text-primary"})]})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"lg:col-span-8 space-y-5 order-2 lg:order-1",children:[!En&&jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden","data-testid":"card-settings",children:[jsxRuntimeExports.jsxs("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Settings2,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Customize Your Experience"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Personalize how the avatar behaves during your practice"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"p-5",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Globe,{className:"w-4 h-4 text-gray-500"}),"Language"]})}),jsxRuntimeExports.jsxs(Select,{value:ut,onValueChange:pt,children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-language",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select language..."})}),jsxRuntimeExports.jsx(SelectContent,{className:"z-[100]",children:SUPPORTED_LANGUAGES.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.code,children:jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:At.flag}),jsxRuntimeExports.jsx("span",{children:At.name})]})},At.code))})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Conversation language"})]}),ut==="en"&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Mic,{className:"w-4 h-4 text-gray-500"}),"Accent"]})}),jsxRuntimeExports.jsxs(Select,{value:mt,onValueChange:At=>{gt(At),vt(!0)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-accent",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select accent..."})}),jsxRuntimeExports.jsx(SelectContent,{className:"z-[100]",children:ENGLISH_ACCENTS.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.id,children:At.label},At.id))})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:$t!=null&&$t.ethnicity&&getAccentFromEthnicity($t.ethnicity)===mt?`Auto-selected based on ${$t.name||"avatar"}`:"English accent variant"})]})]}),Bt.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Compass,{className:"w-4 h-4 text-gray-500"}),"Cultural Communication Style",jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs ml-1 bg-blue-50 text-blue-600 border-blue-200",children:"Optional"})]})}),jsxRuntimeExports.jsxs(Select,{value:dt||"none",onValueChange:At=>ht(At==="none"?null:At),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-cultural-preset",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Default (no cultural overlay)"})}),jsxRuntimeExports.jsxs(SelectContent,{className:"z-[100]",children:[jsxRuntimeExports.jsx(SelectItem,{value:"none",children:"Default (no cultural overlay)"}),Bt.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.id,children:At.name},At.id))]})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"Practice with different communication styles based on behavioral patterns"})]})})]})]}),En&&jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden","data-testid":"card-language",children:[jsxRuntimeExports.jsx("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Globe,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Language Setting"})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-5",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-xs",children:[jsxRuntimeExports.jsxs(Select,{value:ut,onValueChange:pt,children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-language",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select a language..."})}),jsxRuntimeExports.jsx(SelectContent,{className:"z-[100]",children:SUPPORTED_LANGUAGES.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.code,children:jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{children:At.flag}),jsxRuntimeExports.jsx("span",{children:At.name})]})},At.code))})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"The avatar will speak and understand this language"}),ut==="en"&&jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Mic,{className:"w-4 h-4 text-gray-500"}),"Accent"]})}),jsxRuntimeExports.jsxs(Select,{value:mt,onValueChange:At=>{gt(At),vt(!0)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-accent",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select accent..."})}),jsxRuntimeExports.jsx(SelectContent,{className:"z-[100]",children:ENGLISH_ACCENTS.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.id,children:At.label},At.id))})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:$t!=null&&$t.ethnicity&&getAccentFromEthnicity($t.ethnicity)===mt?`Auto-selected based on ${$t.name||"avatar"}`:"English accent variant"})]})]}),Bt.length>0&&jsxRuntimeExports.jsxs("div",{className:"max-w-xs mt-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Compass,{className:"w-4 h-4 text-gray-500"}),"Cultural Style",jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs ml-1 bg-blue-50 text-blue-600 border-blue-200",children:"Optional"})]})}),jsxRuntimeExports.jsxs(Select,{value:dt||"none",onValueChange:At=>ht(At==="none"?null:At),children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-full bg-white h-11","data-testid":"select-cultural-preset",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Default (no cultural overlay)"})}),jsxRuntimeExports.jsxs(SelectContent,{className:"z-[100]",children:[jsxRuntimeExports.jsx(SelectItem,{value:"none",children:"Default (no cultural overlay)"}),Bt.map(At=>jsxRuntimeExports.jsx(SelectItem,{value:At.id,children:At.name},At.id))]})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Practice with different communication styles"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-5",children:En&&Lt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-primary/10 px-6 py-4 border-b border-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-900","data-testid":"text-scenario-name",children:Lt.scenarioSummary.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Custom Scenario"})]}),jsxRuntimeExports.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:jsxRuntimeExports.jsx(Target,{className:"w-6 h-6 text-primary"})})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-6 space-y-5",children:[jsxRuntimeExports.jsxs("div",{"data-testid":"section-scenario",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-4 h-4 text-blue-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Situation"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-700 leading-relaxed pl-9",children:Lt.scenarioSummary.context})]}),Pn&&jsxRuntimeExports.jsxs("div",{className:"bg-amber-50/50 rounded-xl p-4 border border-amber-100","data-testid":"section-tension",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-amber-100 rounded-lg",children:jsxRuntimeExports.jsx(AlertTriangle,{className:"w-4 h-4 text-amber-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"What Makes This Tricky"})]}),jsxRuntimeExports.jsxs("div",{className:"pl-9 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"bg-amber-100 text-amber-700 border-amber-200",children:Pn.label}),Rn&&jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"bg-amber-50 text-amber-600 border-amber-200",children:Rn.label})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm",children:Lt.scenarioSummary.whatMakesItTricky})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 rounded-xl p-4 border border-primary/10","data-testid":"section-avatar-role",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-primary/20 rounded-lg",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-primary"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Conversation Partner"})]}),jsxRuntimeExports.jsx("div",{className:"pl-9",children:jsxRuntimeExports.jsx("p",{className:"text-gray-700 leading-relaxed",children:Lt.scenarioSummary.counterPersonaDescription})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50/50 rounded-xl p-4 border border-green-100","data-testid":"section-objective",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-green-100 rounded-lg",children:jsxRuntimeExports.jsx(Target,{className:"w-4 h-4 text-green-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Objective"})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-700 pl-9",children:Lt.scenarioSummary.objectiveStatement})]})]})]}),rt&&jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden","data-testid":"card-skills-assessment",children:[jsxRuntimeExports.jsx("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-purple-50 to-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-purple-100 rounded-lg",children:jsxRuntimeExports.jsx(BookOpen,{className:"w-5 h-5 text-purple-600"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Skills You'll Practice"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"AI-identified from your scenario"})]})]}),jsxRuntimeExports.jsx("button",{onClick:Pt,disabled:Ht,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Refresh skill analysis",children:jsxRuntimeExports.jsx(RefreshCw,{className:cn("w-4 h-4",Ht&&"animate-spin")})})]})}),jsxRuntimeExports.jsx(CardContent,{className:"p-5",children:Ut||Ht?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 py-4",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 animate-spin text-purple-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:"Analyzing your scenario..."}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400",children:"AI is matching skills from professional frameworks"})]})]}):Zt.length>0?jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[Zt.map(At=>jsxRuntimeExports.jsx("div",{className:cn("p-4 rounded-xl border-2 transition-all",At.isConfirmed?"border-purple-200 bg-purple-50/50":"border-gray-200 bg-gray-50/50"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-gray-900",children:At.skillName}),At.isConfirmed&&jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-purple-100 text-purple-700 text-xs",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-3 h-3 mr-1"}),"Confirmed"]})]}),At.frameworkMapping&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-purple-600 mb-2",children:["Framework: ",At.frameworkMapping]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:At.rationale})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsxs("div",{className:cn("text-lg font-bold",At.confidenceScore>=.8?"text-green-600":At.confidenceScore>=.6?"text-amber-600":"text-gray-500"),children:[Math.round(At.confidenceScore*100),"%"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:"match"})]})]})},At.skillId)),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 pt-2",children:"After your session, you'll receive detailed feedback on each skill based on professional assessment frameworks."})]}):Gt?jsxRuntimeExports.jsxs("div",{className:"text-center py-6",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-6 h-6 text-red-500"})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-red-600 mb-2",children:Gt}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:Pt,className:"gap-2",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-3 h-3"}),"Try Again"]})]}):Vt?jsxRuntimeExports.jsxs("div",{className:"text-center py-6",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-amber-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(Clock,{className:"w-6 h-6 text-amber-500"})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Analysis is taking longer than expected"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"The AI is still processing your scenario. You can start practicing now or wait."}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:Pt,className:"gap-2",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-3 h-3"}),"Check Again"]})]}):Mt?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 py-4",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 animate-spin text-purple-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:"Analyzing your scenario..."}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400",children:"AI is matching skills from professional frameworks"})]})]}):jsxRuntimeExports.jsxs("div",{className:"text-center py-6",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-6 h-6 text-gray-400"})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"No skill mappings found"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400",children:"Your scenario may require skills not yet in our catalog"})]})})]}),nt!=="custom"&&jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm","data-testid":"card-framework-settings",children:[jsxRuntimeExports.jsxs("div",{className:"px-5 py-4 border-b border-gray-100",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Settings2,{className:"w-5 h-5 text-gray-400"}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Customize Your Practice"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Adjust these settings to change how the AI behaves"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"p-5 space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-gray-500"}),"Counter-Persona"]})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"How should the other person behave in this conversation?"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:COUNTER_PERSONA_ARCHETYPES.map(At=>jsxRuntimeExports.jsxs("button",{onClick:()=>wt(At.id),className:cn("p-3 rounded-lg border-2 text-left transition-all",Et===At.id?"border-primary bg-primary/5":"border-gray-200 hover:border-primary/50"),children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-sm text-gray-900",children:At.label}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-1",children:At.description})]},At.id))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Target,{className:"w-4 h-4 text-gray-500"}),"Your Objective"]})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"What are you trying to achieve in this conversation?"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:USER_OBJECTIVES.map(At=>jsxRuntimeExports.jsxs("button",{onClick:()=>Ct(At.id),className:cn("p-3 rounded-lg border-2 text-left transition-all",Tt===At.id?"border-primary bg-primary/5":"border-gray-200 hover:border-primary/50"),children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-sm text-gray-900",children:At.label}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-1",children:At.description})]},At.id))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Compass,{className:"w-4 h-4 text-gray-500"}),"Conversation Mode"]})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"What's the overall feel of the conversation?"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:CONVERSATION_MODES.map(At=>jsxRuntimeExports.jsx("button",{onClick:()=>jt(At.id),className:cn("px-4 py-2 rounded-full border-2 text-sm font-medium transition-all",Rt===At.id?"border-primary bg-primary text-white":"border-gray-200 text-gray-700 hover:border-primary/50"),children:At.label},At.id))}),Rt&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:(Zn=getModeById(Rt))==null?void 0:Zn.description})]})]})]})]}):it&&jsxRuntimeExports.jsxs(Card,{className:"border border-gray-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-primary/10 px-6 py-4 border-b border-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-900","data-testid":"text-scenario-name",children:it.name}),jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:`mt-2 ${Cn(it.difficulty)}`,"data-testid":"badge-difficulty",children:[it.difficulty||"Beginner"," Level"]})]}),jsxRuntimeExports.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:jsxRuntimeExports.jsx(Target,{className:"w-6 h-6 text-primary"})})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-6 space-y-5",children:[it.description&&jsxRuntimeExports.jsxs("div",{"data-testid":"section-practice",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:jsxRuntimeExports.jsx(Lightbulb,{className:"w-4 h-4 text-blue-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"What You'll Learn"})]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600 leading-relaxed pl-9",children:["In this practice session, you will develop skills in ",jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-800",children:it.description.toLowerCase().replace(/\.$/,"")}),". You'll receive real-time feedback to help improve your approach."]})]}),it.context&&jsxRuntimeExports.jsxs("div",{className:"bg-amber-50/50 rounded-xl p-4 border border-amber-100","data-testid":"section-scenario",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-amber-100 rounded-lg",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-4 h-4 text-amber-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"The Situation"})]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 leading-relaxed pl-9",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-amber-700",children:"Your scenario:"})," ",it.context]})]}),it.avatarRole&&jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 rounded-xl p-4 border border-primary/10","data-testid":"section-avatar-role",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-primary/20 rounded-lg",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-primary"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Conversation Partner"})]}),jsxRuntimeExports.jsxs("div",{className:"pl-9",children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-medium text-primary mb-2",children:it.avatarRole}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"You'll be speaking with an AI playing this role. They will respond realistically based on the scenario, giving you authentic practice for real-world situations."})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50/50 rounded-xl p-4 border border-green-100","data-testid":"section-objective",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 bg-green-100 rounded-lg",children:jsxRuntimeExports.jsx(Target,{className:"w-4 h-4 text-green-600"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Objectives"})]}),jsxRuntimeExports.jsxs("ul",{className:"space-y-2 pl-9",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-gray-700",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsxs("span",{className:"leading-relaxed",children:["Practice and develop your skills in: ",((Ft=it.description)==null?void 0:Ft.toLowerCase().replace(/\.$/,""))||"this scenario"]})]}),it.avatarRole&&jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-gray-700",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsxs("span",{className:"leading-relaxed",children:["Engage in a realistic conversation with a ",it.avatarRole.toLowerCase()]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-gray-700",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"leading-relaxed",children:"Demonstrate effective communication and active listening"})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-gray-700",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{className:"leading-relaxed",children:"Receive AI-powered feedback on your performance"})]})]})]})]})]})})]})]})]})})})}const Separator=reactExports.forwardRef(({className:j,orientation:$="horizontal",..._e},et)=>jsxRuntimeExports.jsx("div",{ref:et,className:cn("shrink-0 bg-slate-200",$==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",j),..._e}));Separator.displayName="Separator";const getDifficultyColor=j=>{switch(j==null?void 0:j.toUpperCase()){case"BEGINNER":return"bg-green-100 text-green-700 border-green-200";case"INTERMEDIATE":return"bg-amber-100 text-amber-700 border-amber-200";case"ADVANCED":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},getDifficultyDescription=j=>{switch(j==null?void 0:j.toUpperCase()){case"BEGINNER":return"Great for those new to this type of conversation";case"INTERMEDIATE":return"Suitable for those with some experience";case"ADVANCED":return"Challenging scenario for experienced practitioners";default:return"Standard difficulty level"}};function ScenarioDetailsPage(){const j=useNavigate(),[$]=useSearchParams(),_e=$.get("scenarioId"),[et,tt]=reactExports.useState(null),[nt,rt]=reactExports.useState(null),[it,st]=reactExports.useState(!0),[at,ot]=reactExports.useState("");reactExports.useEffect(()=>{(async()=>{if(!_e){ot("No scenario selected"),st(!1);return}try{st(!0);const pt=await(await fetch(`/api/avatar/get-scenarios?scenarioId=${_e}`)).json();if(pt.success&&pt.scenarios&&pt.scenarios.length>0){const dt=pt.scenarios[0];if(tt({id:dt.id,skillId:dt.skill_id||dt.skillId,name:dt.name,description:dt.description||"",context:dt.context||"",instructions:dt.instructions||"",difficulty:dt.difficulty||"STANDARD",avatarRole:dt.avatar_role||dt.avatarRole||"",estimatedTime:dt.estimated_time||"5-10 minutes"}),dt.skill_id||dt.skillId){const ft=await(await fetch("/api/avatar/get-skills")).json();if(ft.success&&ft.skills){const mt=ft.skills.find(gt=>gt.id===(dt.skill_id||dt.skillId));mt&&rt(mt)}}}else ot("Scenario not found")}catch(ut){console.error("Error fetching scenario:",ut),ot("Failed to load scenario details")}finally{st(!1)}})()},[_e]);const ct=()=>{j(`/avatar/practice/avatar-select?scenarioId=${_e}`)};return it?jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-screen",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(LoadingSpinner,{}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-4",children:"Loading scenario details..."})]})})}):at||!et?jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-4xl",children:jsxRuntimeExports.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-gray-200",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-red-100 rounded-2xl flex items-center justify-center",children:jsxRuntimeExports.jsx(AlertCircle,{className:"w-10 h-10 text-red-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:at||"Scenario not found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-6",children:"Please go back and select a valid scenario to practice."}),jsxRuntimeExports.jsx(Link,{to:"/avatar/practice",children:jsxRuntimeExports.jsxs(Button,{variant:"outline","data-testid":"button-back-to-scenarios",children:[jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4 mr-2"}),"Back to Scenarios"]})})]})})})}):jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50/50",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-4xl",children:[jsxRuntimeExports.jsxs(Link,{to:"/avatar/practice",className:"inline-flex items-center text-gray-500 hover:text-primary mb-6 text-sm font-medium transition-colors","data-testid":"link-back-scenarios",children:[jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4 mr-1"}),"Back to Scenarios"]}),jsxRuntimeExports.jsxs(Card,{className:"bg-white border border-gray-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-2xl font-bold text-gray-900 mb-2","data-testid":"text-scenario-title",children:et.name}),nt&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-primary"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-primary font-medium",children:nt.name})]})]}),jsxRuntimeExports.jsx(Badge,{variant:"outline",className:`flex-shrink-0 text-sm px-3 py-1 ${getDifficultyColor(et.difficulty)}`,"data-testid":"badge-difficulty",children:et.difficulty||"Standard"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:et.estimatedTime})]}),et.avatarRole&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(Users,{className:"w-4 h-4"}),jsxRuntimeExports.jsxs("span",{children:["You'll practice with: ",et.avatarRole]})]})]})]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs(CardContent,{className:"pt-6 space-y-6",children:[et.description&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{className:"w-4 h-4"}),"Description"]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 leading-relaxed","data-testid":"text-scenario-description",children:et.description})]}),et.context&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Target,{className:"w-4 h-4"}),"Context"]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 leading-relaxed bg-gray-50 p-4 rounded-lg","data-testid":"text-scenario-context",children:et.context})]}),et.instructions&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Instructions"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 leading-relaxed","data-testid":"text-scenario-instructions",children:et.instructions})]}),jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 rounded-lg p-4 border border-primary/10",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:["Difficulty: ",et.difficulty||"Standard"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:getDifficultyDescription(et.difficulty)})]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-8 flex justify-center",children:jsxRuntimeExports.jsxs(Button,{size:"lg",onClick:ct,className:"px-8 py-3 text-base font-semibold min-w-[280px] bg-primary hover:bg-primary/90 text-white shadow-lg hover:shadow-xl transition-all","data-testid":"button-continue-avatar-select",children:["Continue to Select Avatar",jsxRuntimeExports.jsx(ChevronRight,{className:"w-5 h-5 ml-2"})]})}),jsxRuntimeExports.jsx("p",{className:"text-center text-sm text-gray-400 mt-4",children:"Next step: Choose an AI avatar to practice with"})]})})})}var useMemoizedFn=function(j){var $=reactExports.useRef(j);$.current=reactExports.useMemo(function(){return j},[j]);var _e=reactExports.useRef(void 0);return _e.current||(_e.current=function(){for(var et=[],tt=0;tt<arguments.length;tt++)et[tt]=arguments[tt];return $.current.apply(this,et)}),_e.current};function parse$1(j,$){if(j instanceof RegExp)return{keys:!1,pattern:j};var _e,et,tt,nt,rt=[],it="",st=j.split("/");for(st[0]||st.shift();tt=st.shift();)_e=tt[0],_e==="*"?(rt.push(_e),it+=tt[1]==="?"?"(?:/(.*))?":"/(.*)"):_e===":"?(et=tt.indexOf("?",1),nt=tt.indexOf(".",1),rt.push(tt.substring(1,~et?et:~nt?nt:tt.length)),it+=~et&&!~nt?"(?:/([^/]+?))?":"/([^/]+?)",~nt&&(it+=(~et?"?":"")+"\\"+tt.substring(nt))):it+="/"+tt;return{keys:rt,pattern:new RegExp("^"+it+($?"(?=$|/)":"/?$"),"i")}}var shim$4={exports:{}},useSyncExternalStoreShim_production$1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$3=reactExports;function is$6(j,$){return j===$&&(j!==0||1/j===1/$)||j!==j&&$!==$}var objectIs$3=typeof Object.is=="function"?Object.is:is$6,useState$1=React$3.useState,useEffect$3=React$3.useEffect,useLayoutEffect$1=React$3.useLayoutEffect,useDebugValue$3=React$3.useDebugValue;function useSyncExternalStore$2$1(j,$){var _e=$(),et=useState$1({inst:{value:_e,getSnapshot:$}}),tt=et[0].inst,nt=et[1];return useLayoutEffect$1(function(){tt.value=_e,tt.getSnapshot=$,checkIfSnapshotChanged$1(tt)&&nt({inst:tt})},[j,_e,$]),useEffect$3(function(){return checkIfSnapshotChanged$1(tt)&&nt({inst:tt}),j(function(){checkIfSnapshotChanged$1(tt)&&nt({inst:tt})})},[j]),useDebugValue$3(_e),_e}function checkIfSnapshotChanged$1(j){var $=j.getSnapshot;j=j.value;try{var _e=$();return!objectIs$3(j,_e)}catch{return!0}}function useSyncExternalStore$1$2(j,$){return $()}var shim$3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1$2:useSyncExternalStore$2$1;useSyncExternalStoreShim_production$1.useSyncExternalStore=React$3.useSyncExternalStore!==void 0?React$3.useSyncExternalStore:shim$3;shim$4.exports=useSyncExternalStoreShim_production$1;var shimExports$1=shim$4.exports;const useBuiltinInsertionEffect=React$5.useInsertionEffect,canUseDOM$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",useIsomorphicLayoutEffect$2=canUseDOM$1?reactExports.useLayoutEffect:reactExports.useEffect,useInsertionEffect$1=useBuiltinInsertionEffect||useIsomorphicLayoutEffect$2,useEvent$1=j=>{const $=reactExports.useRef([j,(..._e)=>$[0](..._e)]).current;return useInsertionEffect$1(()=>{$[0]=j}),$[1]},eventPopstate="popstate",eventPushState="pushState",eventReplaceState="replaceState",eventHashchange="hashchange",events=[eventPopstate,eventPushState,eventReplaceState,eventHashchange],subscribeToLocationUpdates=j=>{for(const $ of events)addEventListener($,j);return()=>{for(const $ of events)removeEventListener($,j)}},useLocationProperty=(j,$)=>shimExports$1.useSyncExternalStore(subscribeToLocationUpdates,j,$),currentSearch=()=>location.search,useSearch=({ssrSearch:j}={})=>useLocationProperty(currentSearch,j!=null?()=>j:currentSearch),currentPathname=()=>location.pathname,usePathname=({ssrPath:j}={})=>useLocationProperty(currentPathname,j!=null?()=>j:currentPathname),navigate=(j,{replace:$=!1,state:_e=null}={})=>history[$?eventReplaceState:eventPushState](_e,"",j),useBrowserLocation=(j={})=>[usePathname(j),navigate],patchKey=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[patchKey]>"u"){for(const j of[eventPushState,eventReplaceState]){const $=history[j];history[j]=function(){const _e=$.apply(this,arguments),et=new Event(j);return et.arguments=arguments,dispatchEvent(et),_e}}Object.defineProperty(window,patchKey,{value:!0})}const _relativePath=(j,$)=>$.toLowerCase().indexOf(j.toLowerCase())?"~"+$:$.slice(j.length)||"/",baseDefaults=(j="")=>j==="/"?"":j,absolutePath=(j,$)=>j[0]==="~"?j.slice(1):baseDefaults($)+j,relativePath=(j="",$)=>_relativePath(unescape(baseDefaults(j)),unescape($)),unescape=j=>{try{return decodeURI(j)}catch{return j}},defaultRouter={hook:useBrowserLocation,searchHook:useSearch,parser:parse$1,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:j=>j},RouterCtx=reactExports.createContext(defaultRouter),useRouter=()=>reactExports.useContext(RouterCtx),Params0={};reactExports.createContext(Params0);const useLocationFromRouter=j=>{const[$,_e]=j.hook(j);return[relativePath(j.base,$),useEvent$1((et,tt)=>_e(absolutePath(et,j.base),tt))]};reactExports.forwardRef((j,$)=>{const _e=useRouter(),[et,tt]=useLocationFromRouter(_e),{to:nt="",href:rt=nt,onClick:it,asChild:st,children:at,className:ot,replace:ct,state:lt,...ut}=j,pt=useEvent$1(ht=>{ht.ctrlKey||ht.metaKey||ht.altKey||ht.shiftKey||ht.button!==0||(it==null||it(ht),ht.defaultPrevented||(ht.preventDefault(),tt(rt,j)))}),dt=_e.hrefs(rt[0]==="~"?rt.slice(1):_e.base+rt,_e);return st&&reactExports.isValidElement(at)?reactExports.cloneElement(at,{onClick:pt,href:dt}):reactExports.createElement("a",{...ut,onClick:pt,href:dt,className:ot!=null&&ot.call?ot(et===rt):ot,children:at,ref:$})});const AuthContext=reactExports.createContext(null);function useAuth(){const j=reactExports.useContext(AuthContext);return j||{user:{id:1,username:"demo",email:"demo@example.com",displayName:"Demo User",userType:"user"},isLoading:!1,login:async()=>!0,logout:()=>{}}}const LayoutGroupContext=reactExports.createContext({});function useConstant(j){const $=reactExports.useRef(null);return $.current===null&&($.current=j()),$.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect$1=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(j,$){j.indexOf($)===-1&&j.push($)}function removeItem(j,$){const _e=j.indexOf($);_e>-1&&j.splice(_e,1)}const clamp=(j,$,_e)=>_e>$?$:_e<j?j:_e;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=j=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(j);function isObject$1(j){return typeof j=="object"&&j!==null}const isZeroValueString=j=>/^0[^.\s]+$/u.test(j);function memo(j){let $;return()=>($===void 0&&($=j()),$)}const noop$4=j=>j,combineFunctions=(j,$)=>_e=>$(j(_e)),pipe=(...j)=>j.reduce(combineFunctions),progress=(j,$,_e)=>{const et=$-j;return et===0?1:(_e-j)/et};class SubscriptionManager{constructor(){this.subscriptions=[]}add($){return addUniqueItem(this.subscriptions,$),()=>removeItem(this.subscriptions,$)}notify($,_e,et){const tt=this.subscriptions.length;if(tt)if(tt===1)this.subscriptions[0]($,_e,et);else for(let nt=0;nt<tt;nt++){const rt=this.subscriptions[nt];rt&&rt($,_e,et)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=j=>j*1e3,millisecondsToSeconds=j=>j/1e3;function velocityPerSecond(j,$){return $?j*(1e3/$):0}const calcBezier=(j,$,_e)=>(((1-3*_e+3*$)*j+(3*_e-6*$))*j+3*$)*j,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(j,$,_e,et,tt){let nt,rt,it=0;do rt=$+(_e-$)/2,nt=calcBezier(rt,et,tt)-j,nt>0?_e=rt:$=rt;while(Math.abs(nt)>subdivisionPrecision&&++it<subdivisionMaxIterations);return rt}function cubicBezier$1(j,$,_e,et){if(j===$&&_e===et)return noop$4;const tt=nt=>binarySubdivide(nt,0,1,j,_e);return nt=>nt===0||nt===1?nt:calcBezier(tt(nt),$,et)}const mirrorEasing=j=>$=>$<=.5?j(2*$)/2:(2-j(2*(1-$)))/2,reverseEasing=j=>$=>1-j(1-$),backOut=cubicBezier$1(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=j=>(j*=2)<1?.5*backIn(j):.5*(2-Math.pow(2,-10*(j-1))),circIn=j=>1-Math.sin(Math.acos(j)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier$1(.42,0,1,1),easeOut=cubicBezier$1(0,0,.58,1),easeInOut=cubicBezier$1(.42,0,.58,1),isEasingArray=j=>Array.isArray(j)&&typeof j[0]!="number",isBezierDefinition=j=>Array.isArray(j)&&typeof j[0]=="number",easingLookup={linear:noop$4,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=j=>typeof j=="string",easingDefinitionToFunction=j=>{if(isBezierDefinition(j)){invariant(j.length===4);const[$,_e,et,tt]=j;return cubicBezier$1($,_e,et,tt)}else if(isValidEasing(j))return easingLookup[j];return j},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(j,$){let _e=new Set,et=new Set,tt=!1,nt=!1;const rt=new WeakSet;let it={delta:0,timestamp:0,isProcessing:!1};function st(ot){rt.has(ot)&&(at.schedule(ot),j()),ot(it)}const at={schedule:(ot,ct=!1,lt=!1)=>{const pt=lt&&tt?_e:et;return ct&&rt.add(ot),pt.has(ot)||pt.add(ot),ot},cancel:ot=>{et.delete(ot),rt.delete(ot)},process:ot=>{if(it=ot,tt){nt=!0;return}tt=!0,[_e,et]=[et,_e],_e.forEach(st),_e.clear(),tt=!1,nt&&(nt=!1,at.process(ot))}};return at}const maxElapsed=40;function createRenderBatcher(j,$){let _e=!1,et=!0;const tt={delta:0,timestamp:0,isProcessing:!1},nt=()=>_e=!0,rt=stepsOrder.reduce((gt,yt)=>(gt[yt]=createRenderStep(nt),gt),{}),{setup:it,read:st,resolveKeyframes:at,preUpdate:ot,update:ct,preRender:lt,render:ut,postRender:pt}=rt,dt=()=>{const gt=MotionGlobalConfig.useManualTiming?tt.timestamp:performance.now();_e=!1,MotionGlobalConfig.useManualTiming||(tt.delta=et?1e3/60:Math.max(Math.min(gt-tt.timestamp,maxElapsed),1)),tt.timestamp=gt,tt.isProcessing=!0,it.process(tt),st.process(tt),at.process(tt),ot.process(tt),ct.process(tt),lt.process(tt),ut.process(tt),pt.process(tt),tt.isProcessing=!1,_e&&$&&(et=!1,j(dt))},ht=()=>{_e=!0,et=!0,tt.isProcessing||j(dt)};return{schedule:stepsOrder.reduce((gt,yt)=>{const vt=rt[yt];return gt[yt]=(xt,St=!1,Et=!1)=>(_e||ht(),vt.schedule(xt,St,Et)),gt},{}),cancel:gt=>{for(let yt=0;yt<stepsOrder.length;yt++)rt[stepsOrder[yt]].cancel(gt)},state:tt,steps:rt}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$4,!0);let now;function clearTime(){now=void 0}const time$1={now:()=>(now===void 0&&time$1.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:j=>{now=j,queueMicrotask(clearTime)}},checkStringStartsWith=j=>$=>typeof $=="string"&&$.startsWith(j),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=j=>startsAsVariableToken(j)?singleCssVariableRegex.test(j.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number$4={test:j=>typeof j=="number",parse:parseFloat,transform:j=>j},alpha$1={...number$4,transform:j=>clamp(0,1,j)},scale={...number$4,default:1},sanitize=j=>Math.round(j*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish$1(j){return j==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(j,$)=>_e=>!!(typeof _e=="string"&&singleColorRegex.test(_e)&&_e.startsWith(j)||$&&!isNullish$1(_e)&&Object.prototype.hasOwnProperty.call(_e,$)),splitColor=(j,$,_e)=>et=>{if(typeof et!="string")return et;const[tt,nt,rt,it]=et.match(floatRegex);return{[j]:parseFloat(tt),[$]:parseFloat(nt),[_e]:parseFloat(rt),alpha:it!==void 0?parseFloat(it):1}},clampRgbUnit=j=>clamp(0,255,j),rgbUnit={...number$4,transform:j=>Math.round(clampRgbUnit(j))},rgba$1={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:j,green:$,blue:_e,alpha:et=1})=>"rgba("+rgbUnit.transform(j)+", "+rgbUnit.transform($)+", "+rgbUnit.transform(_e)+", "+sanitize(alpha$1.transform(et))+")"};function parseHex(j){let $="",_e="",et="",tt="";return j.length>5?($=j.substring(1,3),_e=j.substring(3,5),et=j.substring(5,7),tt=j.substring(7,9)):($=j.substring(1,2),_e=j.substring(2,3),et=j.substring(3,4),tt=j.substring(4,5),$+=$,_e+=_e,et+=et,tt+=tt),{red:parseInt($,16),green:parseInt(_e,16),blue:parseInt(et,16),alpha:tt?parseInt(tt,16)/255:1}}const hex$1={test:isColorString("#"),parse:parseHex,transform:rgba$1.transform},createUnitType=j=>({test:$=>typeof $=="string"&&$.endsWith(j)&&$.split(" ").length===1,parse:parseFloat,transform:$=>`${$}${j}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:j=>percent.parse(j)/100,transform:j=>percent.transform(j*100)},hsla$1={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:j,saturation:$,lightness:_e,alpha:et=1})=>"hsla("+Math.round(j)+", "+percent.transform(sanitize($))+", "+percent.transform(sanitize(_e))+", "+sanitize(alpha$1.transform(et))+")"},color$2={test:j=>rgba$1.test(j)||hex$1.test(j)||hsla$1.test(j),parse:j=>rgba$1.test(j)?rgba$1.parse(j):hsla$1.test(j)?hsla$1.parse(j):hex$1.parse(j),transform:j=>typeof j=="string"?j:j.hasOwnProperty("red")?rgba$1.transform(j):hsla$1.transform(j),getAnimatableNone:j=>{const $=color$2.parse(j);return $.alpha=0,color$2.transform($)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(j){var $,_e;return isNaN(j)&&typeof j=="string"&&((($=j.match(floatRegex))==null?void 0:$.length)||0)+(((_e=j.match(colorRegex))==null?void 0:_e.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(j){const $=j.toString(),_e=[],et={color:[],number:[],var:[]},tt=[];let nt=0;const it=$.replace(complexRegex,st=>(color$2.test(st)?(et.color.push(nt),tt.push(COLOR_TOKEN),_e.push(color$2.parse(st))):st.startsWith(VAR_FUNCTION_TOKEN)?(et.var.push(nt),tt.push(VAR_TOKEN),_e.push(st)):(et.number.push(nt),tt.push(NUMBER_TOKEN),_e.push(parseFloat(st))),++nt,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:_e,split:it,indexes:et,types:tt}}function parseComplexValue(j){return analyseComplexValue(j).values}function createTransformer(j){const{split:$,types:_e}=analyseComplexValue(j),et=$.length;return tt=>{let nt="";for(let rt=0;rt<et;rt++)if(nt+=$[rt],tt[rt]!==void 0){const it=_e[rt];it===NUMBER_TOKEN?nt+=sanitize(tt[rt]):it===COLOR_TOKEN?nt+=color$2.transform(tt[rt]):nt+=tt[rt]}return nt}}const convertNumbersToZero=j=>typeof j=="number"?0:color$2.test(j)?color$2.getAnimatableNone(j):j;function getAnimatableNone$1(j){const $=parseComplexValue(j);return createTransformer(j)($.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(j,$,_e){return _e<0&&(_e+=1),_e>1&&(_e-=1),_e<1/6?j+($-j)*6*_e:_e<1/2?$:_e<2/3?j+($-j)*(2/3-_e)*6:j}function hslaToRgba({hue:j,saturation:$,lightness:_e,alpha:et}){j/=360,$/=100,_e/=100;let tt=0,nt=0,rt=0;if(!$)tt=nt=rt=_e;else{const it=_e<.5?_e*(1+$):_e+$-_e*$,st=2*_e-it;tt=hueToRgb(st,it,j+1/3),nt=hueToRgb(st,it,j),rt=hueToRgb(st,it,j-1/3)}return{red:Math.round(tt*255),green:Math.round(nt*255),blue:Math.round(rt*255),alpha:et}}function mixImmediate(j,$){return _e=>_e>0?$:j}const mixNumber$1=(j,$,_e)=>j+($-j)*_e,mixLinearColor=(j,$,_e)=>{const et=j*j,tt=_e*($*$-et)+et;return tt<0?0:Math.sqrt(tt)},colorTypes=[hex$1,rgba$1,hsla$1],getColorType=j=>colorTypes.find($=>$.test(j));function asRGBA(j){const $=getColorType(j);if(!$)return!1;let _e=$.parse(j);return $===hsla$1&&(_e=hslaToRgba(_e)),_e}const mixColor=(j,$)=>{const _e=asRGBA(j),et=asRGBA($);if(!_e||!et)return mixImmediate(j,$);const tt={..._e};return nt=>(tt.red=mixLinearColor(_e.red,et.red,nt),tt.green=mixLinearColor(_e.green,et.green,nt),tt.blue=mixLinearColor(_e.blue,et.blue,nt),tt.alpha=mixNumber$1(_e.alpha,et.alpha,nt),rgba$1.transform(tt))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(j,$){return invisibleValues.has(j)?_e=>_e<=0?j:$:_e=>_e>=1?$:j}function mixNumber(j,$){return _e=>mixNumber$1(j,$,_e)}function getMixer(j){return typeof j=="number"?mixNumber:typeof j=="string"?isCSSVariableToken(j)?mixImmediate:color$2.test(j)?mixColor:mixComplex:Array.isArray(j)?mixArray:typeof j=="object"?color$2.test(j)?mixColor:mixObject:mixImmediate}function mixArray(j,$){const _e=[...j],et=_e.length,tt=j.map((nt,rt)=>getMixer(nt)(nt,$[rt]));return nt=>{for(let rt=0;rt<et;rt++)_e[rt]=tt[rt](nt);return _e}}function mixObject(j,$){const _e={...j,...$},et={};for(const tt in _e)j[tt]!==void 0&&$[tt]!==void 0&&(et[tt]=getMixer(j[tt])(j[tt],$[tt]));return tt=>{for(const nt in et)_e[nt]=et[nt](tt);return _e}}function matchOrder(j,$){const _e=[],et={color:0,var:0,number:0};for(let tt=0;tt<$.values.length;tt++){const nt=$.types[tt],rt=j.indexes[nt][et[nt]],it=j.values[rt]??0;_e[tt]=it,et[nt]++}return _e}const mixComplex=(j,$)=>{const _e=complex.createTransformer($),et=analyseComplexValue(j),tt=analyseComplexValue($);return et.indexes.var.length===tt.indexes.var.length&&et.indexes.color.length===tt.indexes.color.length&&et.indexes.number.length>=tt.indexes.number.length?invisibleValues.has(j)&&!tt.values.length||invisibleValues.has($)&&!et.values.length?mixVisibility(j,$):pipe(mixArray(matchOrder(et,tt),tt.values),_e):mixImmediate(j,$)};function mix(j,$,_e){return typeof j=="number"&&typeof $=="number"&&typeof _e=="number"?mixNumber$1(j,$,_e):getMixer(j)(j,$)}const frameloopDriver=j=>{const $=({timestamp:_e})=>j(_e);return{start:(_e=!0)=>frame.update($,_e),stop:()=>cancelFrame($),now:()=>frameData.isProcessing?frameData.timestamp:time$1.now()}},generateLinearEasing=(j,$,_e=10)=>{let et="";const tt=Math.max(Math.round($/_e),2);for(let nt=0;nt<tt;nt++)et+=Math.round(j(nt/(tt-1))*1e4)/1e4+", ";return`linear(${et.substring(0,et.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(j){let $=0;const _e=50;let et=j.next($);for(;!et.done&&$<maxGeneratorDuration;)$+=_e,et=j.next($);return $>=maxGeneratorDuration?1/0:$}function createGeneratorEasing(j,$=100,_e){const et=_e({...j,keyframes:[0,$]}),tt=Math.min(calcGeneratorDuration(et),maxGeneratorDuration);return{type:"keyframes",ease:nt=>et.next(tt*nt).value/$,duration:millisecondsToSeconds(tt)}}const velocitySampleDuration=5;function calcGeneratorVelocity(j,$,_e){const et=Math.max($-velocitySampleDuration,0);return velocityPerSecond(_e-j(et),$-et)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:j=springDefaults.duration,bounce:$=springDefaults.bounce,velocity:_e=springDefaults.velocity,mass:et=springDefaults.mass}){let tt,nt,rt=1-$;rt=clamp(springDefaults.minDamping,springDefaults.maxDamping,rt),j=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(j)),rt<1?(tt=at=>{const ot=at*rt,ct=ot*j,lt=ot-_e,ut=calcAngularFreq(at,rt),pt=Math.exp(-ct);return safeMin-lt/ut*pt},nt=at=>{const ct=at*rt*j,lt=ct*_e+_e,ut=Math.pow(rt,2)*Math.pow(at,2)*j,pt=Math.exp(-ct),dt=calcAngularFreq(Math.pow(at,2),rt);return(-tt(at)+safeMin>0?-1:1)*((lt-ut)*pt)/dt}):(tt=at=>{const ot=Math.exp(-at*j),ct=(at-_e)*j+1;return-safeMin+ot*ct},nt=at=>{const ot=Math.exp(-at*j),ct=(_e-at)*(j*j);return ot*ct});const it=5/j,st=approximateRoot(tt,nt,it);if(j=secondsToMilliseconds(j),isNaN(st))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:j};{const at=Math.pow(st,2)*et;return{stiffness:at,damping:rt*2*Math.sqrt(et*at),duration:j}}}const rootIterations=12;function approximateRoot(j,$,_e){let et=_e;for(let tt=1;tt<rootIterations;tt++)et=et-j(et)/$(et);return et}function calcAngularFreq(j,$){return j*Math.sqrt(1-$*$)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(j,$){return $.some(_e=>j[_e]!==void 0)}function getSpringOptions(j){let $={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...j};if(!isSpringType(j,physicsKeys)&&isSpringType(j,durationKeys))if(j.visualDuration){const _e=j.visualDuration,et=2*Math.PI/(_e*1.2),tt=et*et,nt=2*clamp(.05,1,1-(j.bounce||0))*Math.sqrt(tt);$={...$,mass:springDefaults.mass,stiffness:tt,damping:nt}}else{const _e=findSpring(j);$={...$,..._e,mass:springDefaults.mass},$.isResolvedFromDuration=!0}return $}function spring(j=springDefaults.visualDuration,$=springDefaults.bounce){const _e=typeof j!="object"?{visualDuration:j,keyframes:[0,1],bounce:$}:j;let{restSpeed:et,restDelta:tt}=_e;const nt=_e.keyframes[0],rt=_e.keyframes[_e.keyframes.length-1],it={done:!1,value:nt},{stiffness:st,damping:at,mass:ot,duration:ct,velocity:lt,isResolvedFromDuration:ut}=getSpringOptions({..._e,velocity:-millisecondsToSeconds(_e.velocity||0)}),pt=lt||0,dt=at/(2*Math.sqrt(st*ot)),ht=rt-nt,ft=millisecondsToSeconds(Math.sqrt(st/ot)),mt=Math.abs(ht)<5;et||(et=mt?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),tt||(tt=mt?springDefaults.restDelta.granular:springDefaults.restDelta.default);let gt;if(dt<1){const vt=calcAngularFreq(ft,dt);gt=xt=>{const St=Math.exp(-dt*ft*xt);return rt-St*((pt+dt*ft*ht)/vt*Math.sin(vt*xt)+ht*Math.cos(vt*xt))}}else if(dt===1)gt=vt=>rt-Math.exp(-ft*vt)*(ht+(pt+ft*ht)*vt);else{const vt=ft*Math.sqrt(dt*dt-1);gt=xt=>{const St=Math.exp(-dt*ft*xt),Et=Math.min(vt*xt,300);return rt-St*((pt+dt*ft*ht)*Math.sinh(Et)+vt*ht*Math.cosh(Et))/vt}}const yt={calculatedDuration:ut&&ct||null,next:vt=>{const xt=gt(vt);if(ut)it.done=vt>=ct;else{let St=vt===0?pt:0;dt<1&&(St=vt===0?secondsToMilliseconds(pt):calcGeneratorVelocity(gt,vt,xt));const Et=Math.abs(St)<=et,wt=Math.abs(rt-xt)<=tt;it.done=Et&&wt}return it.value=it.done?rt:xt,it},toString:()=>{const vt=Math.min(calcGeneratorDuration(yt),maxGeneratorDuration),xt=generateLinearEasing(St=>yt.next(vt*St).value,vt,30);return vt+"ms "+xt},toTransition:()=>{}};return yt}spring.applyToOptions=j=>{const $=createGeneratorEasing(j,100,spring);return j.ease=$.ease,j.duration=secondsToMilliseconds($.duration),j.type="keyframes",j};function inertia({keyframes:j,velocity:$=0,power:_e=.8,timeConstant:et=325,bounceDamping:tt=10,bounceStiffness:nt=500,modifyTarget:rt,min:it,max:st,restDelta:at=.5,restSpeed:ot}){const ct=j[0],lt={done:!1,value:ct},ut=Et=>it!==void 0&&Et<it||st!==void 0&&Et>st,pt=Et=>it===void 0?st:st===void 0||Math.abs(it-Et)<Math.abs(st-Et)?it:st;let dt=_e*$;const ht=ct+dt,ft=rt===void 0?ht:rt(ht);ft!==ht&&(dt=ft-ct);const mt=Et=>-dt*Math.exp(-Et/et),gt=Et=>ft+mt(Et),yt=Et=>{const wt=mt(Et),Tt=gt(Et);lt.done=Math.abs(wt)<=at,lt.value=lt.done?ft:Tt};let vt,xt;const St=Et=>{ut(lt.value)&&(vt=Et,xt=spring({keyframes:[lt.value,pt(lt.value)],velocity:calcGeneratorVelocity(gt,Et,lt.value),damping:tt,stiffness:nt,restDelta:at,restSpeed:ot}))};return St(0),{calculatedDuration:null,next:Et=>{let wt=!1;return!xt&&vt===void 0&&(wt=!0,yt(Et),St(Et)),vt!==void 0&&Et>=vt?xt.next(Et-vt):(!wt&&yt(Et),lt)}}}function createMixers(j,$,_e){const et=[],tt=_e||MotionGlobalConfig.mix||mix,nt=j.length-1;for(let rt=0;rt<nt;rt++){let it=tt(j[rt],j[rt+1]);if($){const st=Array.isArray($)?$[rt]||noop$4:$;it=pipe(st,it)}et.push(it)}return et}function interpolate$2(j,$,{clamp:_e=!0,ease:et,mixer:tt}={}){const nt=j.length;if(invariant(nt===$.length),nt===1)return()=>$[0];if(nt===2&&$[0]===$[1])return()=>$[1];const rt=j[0]===j[1];j[0]>j[nt-1]&&(j=[...j].reverse(),$=[...$].reverse());const it=createMixers($,et,tt),st=it.length,at=ot=>{if(rt&&ot<j[0])return $[0];let ct=0;if(st>1)for(;ct<j.length-2&&!(ot<j[ct+1]);ct++);const lt=progress(j[ct],j[ct+1],ot);return it[ct](lt)};return _e?ot=>at(clamp(j[0],j[nt-1],ot)):at}function fillOffset(j,$){const _e=j[j.length-1];for(let et=1;et<=$;et++){const tt=progress(0,$,et);j.push(mixNumber$1(_e,1,tt))}}function defaultOffset(j){const $=[0];return fillOffset($,j.length-1),$}function convertOffsetToTimes(j,$){return j.map(_e=>_e*$)}function defaultEasing(j,$){return j.map(()=>$||easeInOut).splice(0,j.length-1)}function keyframes({duration:j=300,keyframes:$,times:_e,ease:et="easeInOut"}){const tt=isEasingArray(et)?et.map(easingDefinitionToFunction):easingDefinitionToFunction(et),nt={done:!1,value:$[0]},rt=convertOffsetToTimes(_e&&_e.length===$.length?_e:defaultOffset($),j),it=interpolate$2(rt,$,{ease:Array.isArray(tt)?tt:defaultEasing($,tt)});return{calculatedDuration:j,next:st=>(nt.value=it(st),nt.done=st>=j,nt)}}const isNotNull$1=j=>j!==null;function getFinalKeyframe$1(j,{repeat:$,repeatType:_e="loop"},et,tt=1){const nt=j.filter(isNotNull$1),it=tt<0||$&&_e!=="loop"&&$%2===1?0:nt.length-1;return!it||et===void 0?nt[it]:et}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(j){typeof j.type=="string"&&(j.type=transitionTypeMap[j.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise($=>{this.resolve=$})}notifyFinished(){this.resolve()}then($,_e){return this.finished.then($,_e)}}const percentToProgress=j=>j/100;class JSAnimation extends WithPromise{constructor($){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var et,tt;const{motionValue:_e}=this.options;_e&&_e.updatedAt!==time$1.now()&&this.tick(time$1.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(tt=(et=this.options).onStop)==null||tt.call(et))},this.options=$,this.initAnimation(),this.play(),$.autoplay===!1&&this.pause()}initAnimation(){const{options:$}=this;replaceTransitionType($);const{type:_e=keyframes,repeat:et=0,repeatDelay:tt=0,repeatType:nt,velocity:rt=0}=$;let{keyframes:it}=$;const st=_e||keyframes;st!==keyframes&&typeof it[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(it[0],it[1])),it=[0,100]);const at=st({...$,keyframes:it});nt==="mirror"&&(this.mirroredGenerator=st({...$,keyframes:[...it].reverse(),velocity:-rt})),at.calculatedDuration===null&&(at.calculatedDuration=calcGeneratorDuration(at));const{calculatedDuration:ot}=at;this.calculatedDuration=ot,this.resolvedDuration=ot+tt,this.totalDuration=this.resolvedDuration*(et+1)-tt,this.generator=at}updateTime($){const _e=Math.round($-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=_e}tick($,_e=!1){const{generator:et,totalDuration:tt,mixKeyframes:nt,mirroredGenerator:rt,resolvedDuration:it,calculatedDuration:st}=this;if(this.startTime===null)return et.next(0);const{delay:at=0,keyframes:ot,repeat:ct,repeatType:lt,repeatDelay:ut,type:pt,onUpdate:dt,finalKeyframe:ht}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,$):this.speed<0&&(this.startTime=Math.min($-tt/this.speed,this.startTime)),_e?this.currentTime=$:this.updateTime($);const ft=this.currentTime-at*(this.playbackSpeed>=0?1:-1),mt=this.playbackSpeed>=0?ft<0:ft>tt;this.currentTime=Math.max(ft,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=tt);let gt=this.currentTime,yt=et;if(ct){const Et=Math.min(this.currentTime,tt)/it;let wt=Math.floor(Et),Tt=Et%1;!Tt&&Et>=1&&(Tt=1),Tt===1&&wt--,wt=Math.min(wt,ct+1),!!(wt%2)&&(lt==="reverse"?(Tt=1-Tt,ut&&(Tt-=ut/it)):lt==="mirror"&&(yt=rt)),gt=clamp(0,1,Tt)*it}const vt=mt?{done:!1,value:ot[0]}:yt.next(gt);nt&&(vt.value=nt(vt.value));let{done:xt}=vt;!mt&&st!==null&&(xt=this.playbackSpeed>=0?this.currentTime>=tt:this.currentTime<=0);const St=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&xt);return St&&pt!==inertia&&(vt.value=getFinalKeyframe$1(ot,this.options,ht,this.speed)),dt&&dt(vt.value),St&&this.finish(),vt}then($,_e){return this.finished.then($,_e)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:$=0}=this.options||{};return this.duration+millisecondsToSeconds($)}get time(){return millisecondsToSeconds(this.currentTime)}set time($){var _e;$=secondsToMilliseconds($),this.currentTime=$,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=$:this.driver&&(this.startTime=this.driver.now()-$/this.playbackSpeed),(_e=this.driver)==null||_e.start(!1)}get speed(){return this.playbackSpeed}set speed($){this.updateTime(time$1.now());const _e=this.playbackSpeed!==$;this.playbackSpeed=$,_e&&(this.time=millisecondsToSeconds(this.currentTime))}play(){var tt,nt;if(this.isStopped)return;const{driver:$=frameloopDriver,startTime:_e}=this.options;this.driver||(this.driver=$(rt=>this.tick(rt))),(nt=(tt=this.options).onPlay)==null||nt.call(tt);const et=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=et):this.holdTime!==null?this.startTime=et-this.holdTime:this.startTime||(this.startTime=_e??et),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time$1.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var $,_e;this.notifyFinished(),this.teardown(),this.state="finished",(_e=($=this.options).onComplete)==null||_e.call($)}cancel(){var $,_e;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(_e=($=this.options).onCancel)==null||_e.call($)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample($){return this.startTime=0,this.tick($,!0)}attachTimeline($){var _e;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(_e=this.driver)==null||_e.stop(),$.observe(this)}}function fillWildcards(j){for(let $=1;$<j.length;$++)j[$]??(j[$]=j[$-1])}const radToDeg=j=>j*180/Math.PI,rotate=j=>{const $=radToDeg(Math.atan2(j[1],j[0]));return rebaseAngle($)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:j=>(Math.abs(j[0])+Math.abs(j[3]))/2,rotate,rotateZ:rotate,skewX:j=>radToDeg(Math.atan(j[1])),skewY:j=>radToDeg(Math.atan(j[2])),skew:j=>(Math.abs(j[1])+Math.abs(j[2]))/2},rebaseAngle=j=>(j=j%360,j<0&&(j+=360),j),rotateZ=rotate,scaleX=j=>Math.sqrt(j[0]*j[0]+j[1]*j[1]),scaleY=j=>Math.sqrt(j[4]*j[4]+j[5]*j[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:j=>(scaleX(j)+scaleY(j))/2,rotateX:j=>rebaseAngle(radToDeg(Math.atan2(j[6],j[5]))),rotateY:j=>rebaseAngle(radToDeg(Math.atan2(-j[2],j[0]))),rotateZ,rotate:rotateZ,skewX:j=>radToDeg(Math.atan(j[4])),skewY:j=>radToDeg(Math.atan(j[1])),skew:j=>(Math.abs(j[1])+Math.abs(j[4]))/2};function defaultTransformValue(j){return j.includes("scale")?1:0}function parseValueFromTransform(j,$){if(!j||j==="none")return defaultTransformValue($);const _e=j.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let et,tt;if(_e)et=matrix3dParsers,tt=_e;else{const it=j.match(/^matrix\(([-\d.e\s,]+)\)$/u);et=matrix2dParsers,tt=it}if(!tt)return defaultTransformValue($);const nt=et[$],rt=tt[1].split(",").map(convertTransformToNumber);return typeof nt=="function"?nt(rt):rt[nt]}const readTransformValue=(j,$)=>{const{transform:_e="none"}=getComputedStyle(j);return parseValueFromTransform(_e,$)};function convertTransformToNumber(j){return parseFloat(j.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=j=>j===number$4||j===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(j=>!transformKeys.has(j));function removeNonTranslationalTransform(j){const $=[];return nonTranslationalTransformKeys.forEach(_e=>{const et=j.getValue(_e);et!==void 0&&($.push([_e,et.get()]),et.set(_e.startsWith("scale")?1:0))}),$}const positionalValues={width:({x:j},{paddingLeft:$="0",paddingRight:_e="0"})=>j.max-j.min-parseFloat($)-parseFloat(_e),height:({y:j},{paddingTop:$="0",paddingBottom:_e="0"})=>j.max-j.min-parseFloat($)-parseFloat(_e),top:(j,{top:$})=>parseFloat($),left:(j,{left:$})=>parseFloat($),bottom:({y:j},{top:$})=>parseFloat($)+(j.max-j.min),right:({x:j},{left:$})=>parseFloat($)+(j.max-j.min),x:(j,{transform:$})=>parseValueFromTransform($,"x"),y:(j,{transform:$})=>parseValueFromTransform($,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const j=Array.from(toResolve).filter(et=>et.needsMeasurement),$=new Set(j.map(et=>et.element)),_e=new Map;$.forEach(et=>{const tt=removeNonTranslationalTransform(et);tt.length&&(_e.set(et,tt),et.render())}),j.forEach(et=>et.measureInitialState()),$.forEach(et=>{et.render();const tt=_e.get(et);tt&&tt.forEach(([nt,rt])=>{var it;(it=et.getValue(nt))==null||it.set(rt)})}),j.forEach(et=>et.measureEndState()),j.forEach(et=>{et.suspendedScrollY!==void 0&&window.scrollTo(0,et.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(j=>j.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(j=>{j.readKeyframes(),j.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor($,_e,et,tt,nt,rt=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...$],this.onComplete=_e,this.name=et,this.motionValue=tt,this.element=nt,this.isAsync=rt}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:$,name:_e,element:et,motionValue:tt}=this;if($[0]===null){const nt=tt==null?void 0:tt.get(),rt=$[$.length-1];if(nt!==void 0)$[0]=nt;else if(et&&_e){const it=et.readValue(_e,rt);it!=null&&($[0]=it)}$[0]===void 0&&($[0]=rt),tt&&nt===void 0&&tt.set($[0])}fillWildcards($)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete($=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,$),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=j=>j.startsWith("--");function setStyle(j,$,_e){isCSSVar($)?j.style.setProperty($,_e):j.style[$]=_e}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(j,$){const _e=memo(j);return()=>supportsFlags[$]??_e()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([j,$,_e,et])=>`cubic-bezier(${j}, ${$}, ${_e}, ${et})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(j,$){if(j)return typeof j=="function"?supportsLinearEasing()?generateLinearEasing(j,$):"ease-out":isBezierDefinition(j)?cubicBezierAsString(j):Array.isArray(j)?j.map(_e=>mapEasingToNativeEasing(_e,$)||supportedWaapiEasing.easeOut):supportedWaapiEasing[j]}function startWaapiAnimation(j,$,_e,{delay:et=0,duration:tt=300,repeat:nt=0,repeatType:rt="loop",ease:it="easeOut",times:st}={},at=void 0){const ot={[$]:_e};st&&(ot.offset=st);const ct=mapEasingToNativeEasing(it,tt);Array.isArray(ct)&&(ot.easing=ct);const lt={delay:et,duration:tt,easing:Array.isArray(ct)?"linear":ct,fill:"both",iterations:nt+1,direction:rt==="reverse"?"alternate":"normal"};return at&&(lt.pseudoElement=at),j.animate(ot,lt)}function isGenerator(j){return typeof j=="function"&&"applyToOptions"in j}function applyGeneratorOptions({type:j,...$}){return isGenerator(j)&&supportsLinearEasing()?j.applyToOptions($):($.duration??($.duration=300),$.ease??($.ease="easeOut"),$)}class NativeAnimation extends WithPromise{constructor($){if(super(),this.finishedTime=null,this.isStopped=!1,!$)return;const{element:_e,name:et,keyframes:tt,pseudoElement:nt,allowFlatten:rt=!1,finalKeyframe:it,onComplete:st}=$;this.isPseudoElement=!!nt,this.allowFlatten=rt,this.options=$,invariant(typeof $.type!="string");const at=applyGeneratorOptions($);this.animation=startWaapiAnimation(_e,et,tt,at,nt),at.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!nt){const ot=getFinalKeyframe$1(tt,this.options,it,this.speed);this.updateMotionValue?this.updateMotionValue(ot):setStyle(_e,et,ot),this.animation.cancel()}st==null||st(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var $,_e;(_e=($=this.animation).finish)==null||_e.call($)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:$}=this;$==="idle"||$==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var $,_e;this.isPseudoElement||(_e=($=this.animation).commitStyles)==null||_e.call($)}get duration(){var _e,et;const $=((et=(_e=this.animation.effect)==null?void 0:_e.getComputedTiming)==null?void 0:et.call(_e).duration)||0;return millisecondsToSeconds(Number($))}get iterationDuration(){const{delay:$=0}=this.options||{};return this.duration+millisecondsToSeconds($)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time($){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds($)}get speed(){return this.animation.playbackRate}set speed($){$<0&&(this.finishedTime=null),this.animation.playbackRate=$}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime($){this.animation.startTime=$}attachTimeline({timeline:$,observe:_e}){var et;return this.allowFlatten&&((et=this.animation.effect)==null||et.updateTiming({easing:"linear"})),this.animation.onfinish=null,$&&supportsScrollTimeline()?(this.animation.timeline=$,noop$4):_e(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(j){return j in unsupportedEasingFunctions}function replaceStringEasing(j){typeof j.ease=="string"&&isUnsupportedEase(j.ease)&&(j.ease=unsupportedEasingFunctions[j.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor($){replaceStringEasing($),replaceTransitionType($),super($),$.startTime&&(this.startTime=$.startTime),this.options=$}updateMotionValue($){const{motionValue:_e,onUpdate:et,onComplete:tt,element:nt,...rt}=this.options;if(!_e)return;if($!==void 0){_e.set($);return}const it=new JSAnimation({...rt,autoplay:!1}),st=secondsToMilliseconds(this.finishedTime??this.time);_e.setWithVelocity(it.sample(st-sampleDelta).value,it.sample(st).value,sampleDelta),it.stop()}}const isAnimatable=(j,$)=>$==="zIndex"?!1:!!(typeof j=="number"||Array.isArray(j)||typeof j=="string"&&(complex.test(j)||j==="0")&&!j.startsWith("url("));function hasKeyframesChanged(j){const $=j[0];if(j.length===1)return!0;for(let _e=0;_e<j.length;_e++)if(j[_e]!==$)return!0}function canAnimate(j,$,_e,et){const tt=j[0];if(tt===null)return!1;if($==="display"||$==="visibility")return!0;const nt=j[j.length-1],rt=isAnimatable(tt,$),it=isAnimatable(nt,$);return!rt||!it?!1:hasKeyframesChanged(j)||(_e==="spring"||isGenerator(_e))&&et}function makeAnimationInstant(j){j.duration=0,j.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(j){var ot;const{motionValue:$,name:_e,repeatDelay:et,repeatType:tt,damping:nt,type:rt}=j;if(!(((ot=$==null?void 0:$.owner)==null?void 0:ot.current)instanceof HTMLElement))return!1;const{onUpdate:st,transformTemplate:at}=$.owner.getProps();return supportsWaapi()&&_e&&acceleratedValues.has(_e)&&(_e!=="transform"||!at)&&!st&&!et&&tt!=="mirror"&&nt!==0&&rt!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:$=!0,delay:_e=0,type:et="keyframes",repeat:tt=0,repeatDelay:nt=0,repeatType:rt="loop",keyframes:it,name:st,motionValue:at,element:ot,...ct}){var pt;super(),this.stop=()=>{var dt,ht;this._animation&&(this._animation.stop(),(dt=this.stopTimeline)==null||dt.call(this)),(ht=this.keyframeResolver)==null||ht.cancel()},this.createdAt=time$1.now();const lt={autoplay:$,delay:_e,type:et,repeat:tt,repeatDelay:nt,repeatType:rt,name:st,motionValue:at,element:ot,...ct},ut=(ot==null?void 0:ot.KeyframeResolver)||KeyframeResolver;this.keyframeResolver=new ut(it,(dt,ht,ft)=>this.onKeyframesResolved(dt,ht,lt,!ft),st,at,ot),(pt=this.keyframeResolver)==null||pt.scheduleResolve()}onKeyframesResolved($,_e,et,tt){this.keyframeResolver=void 0;const{name:nt,type:rt,velocity:it,delay:st,isHandoff:at,onUpdate:ot}=et;this.resolvedAt=time$1.now(),canAnimate($,nt,rt,it)||((MotionGlobalConfig.instantAnimations||!st)&&(ot==null||ot(getFinalKeyframe$1($,et,_e))),$[0]=$[$.length-1],makeAnimationInstant(et),et.repeat=0);const lt={startTime:tt?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:_e,...et,keyframes:$},ut=!at&&supportsBrowserAnimation(lt)?new NativeAnimationExtended({...lt,element:lt.motionValue.owner.current}):new JSAnimation(lt);ut.finished.then(()=>this.notifyFinished()).catch(noop$4),this.pendingTimeline&&(this.stopTimeline=ut.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=ut}get finished(){return this._animation?this.animation.finished:this._finished}then($,_e){return this.finished.finally($).then(()=>{})}get animation(){var $;return this._animation||(($=this.keyframeResolver)==null||$.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time($){this.animation.time=$}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed($){this.animation.speed=$}get startTime(){return this.animation.startTime}attachTimeline($){return this._animation?this.stopTimeline=this.animation.attachTimeline($):this.pendingTimeline=$,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var $;this._animation&&this.animation.cancel(),($=this.keyframeResolver)==null||$.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(j){const $=splitCSSVariableRegex.exec(j);if(!$)return[,];const[,_e,et,tt]=$;return[`--${_e??et}`,tt]}function getVariableValue(j,$,_e=1){const[et,tt]=parseCSSVariable(j);if(!et)return;const nt=window.getComputedStyle($).getPropertyValue(et);if(nt){const rt=nt.trim();return isNumericalString(rt)?parseFloat(rt):rt}return isCSSVariableToken(tt)?getVariableValue(tt,$,_e+1):tt}function getValueTransition(j,$){return(j==null?void 0:j[$])??(j==null?void 0:j.default)??j}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:j=>j==="auto",parse:j=>j},testValueType=j=>$=>$.test(j),dimensionValueTypes=[number$4,px,percent,degrees,vw,vh,auto],findDimensionValueType=j=>dimensionValueTypes.find(testValueType(j));function isNone(j){return typeof j=="number"?j===0:j!==null?j==="none"||j==="0"||isZeroValueString(j):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(j){const[$,_e]=j.slice(0,-1).split("(");if($==="drop-shadow")return j;const[et]=_e.match(floatRegex)||[];if(!et)return j;const tt=_e.replace(et,"");let nt=maxDefaults.has($)?1:0;return et!==_e&&(nt*=100),$+"("+nt+tt+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:j=>{const $=j.match(functionRegex);return $?$.map(applyDefaultFilter).join(" "):j}},int={...number$4,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha$1,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha$1,strokeOpacity:alpha$1,numOctaves:int},defaultValueTypes={...numberValueTypes,color:color$2,backgroundColor:color$2,outlineColor:color$2,fill:color$2,stroke:color$2,borderColor:color$2,borderTopColor:color$2,borderRightColor:color$2,borderBottomColor:color$2,borderLeftColor:color$2,filter,WebkitFilter:filter},getDefaultValueType=j=>defaultValueTypes[j];function getAnimatableNone(j,$){let _e=getDefaultValueType(j);return _e!==filter&&(_e=complex),_e.getAnimatableNone?_e.getAnimatableNone($):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(j,$,_e){let et=0,tt;for(;et<j.length&&!tt;){const nt=j[et];typeof nt=="string"&&!invalidTemplates.has(nt)&&analyseComplexValue(nt).values.length&&(tt=j[et]),et++}if(tt&&_e)for(const nt of $)j[nt]=getAnimatableNone(_e,tt)}class DOMKeyframesResolver extends KeyframeResolver{constructor($,_e,et,tt,nt){super($,_e,et,tt,nt,!0)}readKeyframes(){const{unresolvedKeyframes:$,element:_e,name:et}=this;if(!_e||!_e.current)return;super.readKeyframes();for(let st=0;st<$.length;st++){let at=$[st];if(typeof at=="string"&&(at=at.trim(),isCSSVariableToken(at))){const ot=getVariableValue(at,_e.current);ot!==void 0&&($[st]=ot),st===$.length-1&&(this.finalKeyframe=at)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(et)||$.length!==2)return;const[tt,nt]=$,rt=findDimensionValueType(tt),it=findDimensionValueType(nt);if(rt!==it)if(isNumOrPxType(rt)&&isNumOrPxType(it))for(let st=0;st<$.length;st++){const at=$[st];typeof at=="string"&&($[st]=parseFloat(at))}else positionalValues[et]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:$,name:_e}=this,et=[];for(let tt=0;tt<$.length;tt++)($[tt]===null||isNone($[tt]))&&et.push(tt);et.length&&makeNoneKeyframesAnimatable($,et,_e)}measureInitialState(){const{element:$,unresolvedKeyframes:_e,name:et}=this;if(!$||!$.current)return;et==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[et]($.measureViewportBox(),window.getComputedStyle($.current)),_e[0]=this.measuredOrigin;const tt=_e[_e.length-1];tt!==void 0&&$.getValue(et,tt).jump(tt,!1)}measureEndState(){var it;const{element:$,name:_e,unresolvedKeyframes:et}=this;if(!$||!$.current)return;const tt=$.getValue(_e);tt&&tt.jump(this.measuredOrigin,!1);const nt=et.length-1,rt=et[nt];et[nt]=positionalValues[_e]($.measureViewportBox(),window.getComputedStyle($.current)),rt!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=rt),(it=this.removedTransforms)!=null&&it.length&&this.removedTransforms.forEach(([st,at])=>{$.getValue(st).set(at)}),this.resolveNoneKeyframes()}}function resolveElements(j,$,_e){if(j instanceof EventTarget)return[j];if(typeof j=="string"){let et=document;const tt=(_e==null?void 0:_e[j])??et.querySelectorAll(j);return tt?Array.from(tt):[]}return Array.from(j)}const getValueAsType=(j,$)=>$&&typeof j=="number"?$.transform(j):j;function isHTMLElement(j){return isObject$1(j)&&"offsetHeight"in j}const MAX_VELOCITY_DELTA=30,isFloat=j=>!isNaN(parseFloat(j));class MotionValue{constructor($,_e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=et=>{var nt;const tt=time$1.now();if(this.updatedAt!==tt&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(et),this.current!==this.prev&&((nt=this.events.change)==null||nt.notify(this.current),this.dependents))for(const rt of this.dependents)rt.dirty()},this.hasAnimated=!1,this.setCurrent($),this.owner=_e.owner}setCurrent($){this.current=$,this.updatedAt=time$1.now(),this.canTrackVelocity===null&&$!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue($=this.current){this.prevFrameValue=$,this.prevUpdatedAt=this.updatedAt}onChange($){return this.on("change",$)}on($,_e){this.events[$]||(this.events[$]=new SubscriptionManager);const et=this.events[$].add(_e);return $==="change"?()=>{et(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:et}clearListeners(){for(const $ in this.events)this.events[$].clear()}attach($,_e){this.passiveEffect=$,this.stopPassiveEffect=_e}set($){this.passiveEffect?this.passiveEffect($,this.updateAndNotify):this.updateAndNotify($)}setWithVelocity($,_e,et){this.set(_e),this.prev=void 0,this.prevFrameValue=$,this.prevUpdatedAt=this.updatedAt-et}jump($,_e=!0){this.updateAndNotify($),this.prev=$,this.prevUpdatedAt=this.prevFrameValue=void 0,_e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var $;($=this.events.change)==null||$.notify(this.current)}addDependent($){this.dependents||(this.dependents=new Set),this.dependents.add($)}removeDependent($){this.dependents&&this.dependents.delete($)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const $=time$1.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||$-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const _e=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),_e)}start($){return this.stop(),new Promise(_e=>{this.hasAnimated=!0,this.animation=$(_e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var $,_e;($=this.dependents)==null||$.clear(),(_e=this.events.destroy)==null||_e.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(j,$){return new MotionValue(j,$)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(j){return j==="x"||j==="y"?isDragging[j]?null:(isDragging[j]=!0,()=>{isDragging[j]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(j,$){const _e=resolveElements(j),et=new AbortController,tt={passive:!0,...$,signal:et.signal};return[_e,tt,()=>et.abort()]}function isValidHover(j){return!(j.pointerType==="touch"||isDragActive())}function hover(j,$,_e={}){const[et,tt,nt]=setupGesture(j,_e),rt=it=>{if(!isValidHover(it))return;const{target:st}=it,at=$(st,it);if(typeof at!="function"||!st)return;const ot=ct=>{isValidHover(ct)&&(at(ct),st.removeEventListener("pointerleave",ot))};st.addEventListener("pointerleave",ot,tt)};return et.forEach(it=>{it.addEventListener("pointerenter",rt,tt)}),nt}const isNodeOrChild=(j,$)=>$?j===$?!0:isNodeOrChild(j,$.parentElement):!1,isPrimaryPointer=j=>j.pointerType==="mouse"?typeof j.button!="number"||j.button<=0:j.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(j){return focusableElements.has(j.tagName)||j.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(j){return $=>{$.key==="Enter"&&j($)}}function firePointerEvent(j,$){j.dispatchEvent(new PointerEvent("pointer"+$,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(j,$)=>{const _e=j.currentTarget;if(!_e)return;const et=filterEvents(()=>{if(isPressing.has(_e))return;firePointerEvent(_e,"down");const tt=filterEvents(()=>{firePointerEvent(_e,"up")}),nt=()=>firePointerEvent(_e,"cancel");_e.addEventListener("keyup",tt,$),_e.addEventListener("blur",nt,$)});_e.addEventListener("keydown",et,$),_e.addEventListener("blur",()=>_e.removeEventListener("keydown",et),$)};function isValidPressEvent(j){return isPrimaryPointer(j)&&!isDragActive()}function press(j,$,_e={}){const[et,tt,nt]=setupGesture(j,_e),rt=it=>{const st=it.currentTarget;if(!isValidPressEvent(it))return;isPressing.add(st);const at=$(st,it),ot=(ut,pt)=>{window.removeEventListener("pointerup",ct),window.removeEventListener("pointercancel",lt),isPressing.has(st)&&isPressing.delete(st),isValidPressEvent(ut)&&typeof at=="function"&&at(ut,{success:pt})},ct=ut=>{ot(ut,st===window||st===document||_e.useGlobalTarget||isNodeOrChild(st,ut.target))},lt=ut=>{ot(ut,!1)};window.addEventListener("pointerup",ct,tt),window.addEventListener("pointercancel",lt,tt)};return et.forEach(it=>{(_e.useGlobalTarget?window:it).addEventListener("pointerdown",rt,tt),isHTMLElement(it)&&(it.addEventListener("focus",at=>enableKeyboardPress(at,tt)),!isElementKeyboardAccessible(it)&&!it.hasAttribute("tabindex")&&(it.tabIndex=0))}),nt}function isSVGElement(j){return isObject$1(j)&&"ownerSVGElement"in j}function isSVGSVGElement(j){return isSVGElement(j)&&j.tagName==="svg"}const isMotionValue=j=>!!(j&&j.getVelocity),valueTypes=[...dimensionValueTypes,color$2,complex],findValueType=j=>valueTypes.find(testValueType(j)),MotionConfigContext=reactExports.createContext({transformPagePoint:j=>j,isStatic:!1,reducedMotion:"never"});function setRef$1(j,$){if(typeof j=="function")return j($);j!=null&&(j.current=$)}function composeRefs$1(...j){return $=>{let _e=!1;const et=j.map(tt=>{const nt=setRef$1(tt,$);return!_e&&typeof nt=="function"&&(_e=!0),nt});if(_e)return()=>{for(let tt=0;tt<et.length;tt++){const nt=et[tt];typeof nt=="function"?nt():setRef$1(j[tt],null)}}}}function useComposedRefs$1(...j){return reactExports.useCallback(composeRefs$1(...j),j)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate($){const _e=this.props.childRef.current;if(_e&&$.isPresent&&!this.props.isPresent){const et=_e.offsetParent,tt=isHTMLElement(et)&&et.offsetWidth||0,nt=this.props.sizeRef.current;nt.height=_e.offsetHeight||0,nt.width=_e.offsetWidth||0,nt.top=_e.offsetTop,nt.left=_e.offsetLeft,nt.right=tt-nt.width-nt.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:j,isPresent:$,anchorX:_e,root:et}){const tt=reactExports.useId(),nt=reactExports.useRef(null),rt=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:it}=reactExports.useContext(MotionConfigContext),st=useComposedRefs$1(nt,j==null?void 0:j.ref);return reactExports.useInsertionEffect(()=>{const{width:at,height:ot,top:ct,left:lt,right:ut}=rt.current;if($||!nt.current||!at||!ot)return;const pt=_e==="left"?`left: ${lt}`:`right: ${ut}`;nt.current.dataset.motionPopId=tt;const dt=document.createElement("style");it&&(dt.nonce=it);const ht=et??document.head;return ht.appendChild(dt),dt.sheet&&dt.sheet.insertRule(`
          [data-motion-pop-id="${tt}"] {
            position: absolute !important;
            width: ${at}px !important;
            height: ${ot}px !important;
            ${pt}px !important;
            top: ${ct}px !important;
          }
        `),()=>{ht.contains(dt)&&ht.removeChild(dt)}},[$]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:$,childRef:nt,sizeRef:rt,children:reactExports.cloneElement(j,{ref:st})})}const PresenceChild=({children:j,initial:$,isPresent:_e,onExitComplete:et,custom:tt,presenceAffectsLayout:nt,mode:rt,anchorX:it,root:st})=>{const at=useConstant(newChildrenMap),ot=reactExports.useId();let ct=!0,lt=reactExports.useMemo(()=>(ct=!1,{id:ot,initial:$,isPresent:_e,custom:tt,onExitComplete:ut=>{at.set(ut,!0);for(const pt of at.values())if(!pt)return;et&&et()},register:ut=>(at.set(ut,!1),()=>at.delete(ut))}),[_e,at,et]);return nt&&ct&&(lt={...lt}),reactExports.useMemo(()=>{at.forEach((ut,pt)=>at.set(pt,!1))},[_e]),reactExports.useEffect(()=>{!_e&&!at.size&&et&&et()},[_e]),rt==="popLayout"&&(j=jsxRuntimeExports.jsx(PopChild,{isPresent:_e,anchorX:it,root:st,children:j})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:lt,children:j})};function newChildrenMap(){return new Map}function usePresence$1(j=!0){const $=reactExports.useContext(PresenceContext);if($===null)return[!0,null];const{isPresent:_e,onExitComplete:et,register:tt}=$,nt=reactExports.useId();reactExports.useEffect(()=>{if(j)return tt(nt)},[j]);const rt=reactExports.useCallback(()=>j&&et&&et(nt),[nt,et,j]);return!_e&&et?[!1,rt]:[!0]}const getChildKey=j=>j.key||"";function onlyElements(j){const $=[];return reactExports.Children.forEach(j,_e=>{reactExports.isValidElement(_e)&&$.push(_e)}),$}const AnimatePresence=({children:j,custom:$,initial:_e=!0,onExitComplete:et,presenceAffectsLayout:tt=!0,mode:nt="sync",propagate:rt=!1,anchorX:it="left",root:st})=>{const[at,ot]=usePresence$1(rt),ct=reactExports.useMemo(()=>onlyElements(j),[j]),lt=rt&&!at?[]:ct.map(getChildKey),ut=reactExports.useRef(!0),pt=reactExports.useRef(ct),dt=useConstant(()=>new Map),[ht,ft]=reactExports.useState(ct),[mt,gt]=reactExports.useState(ct);useIsomorphicLayoutEffect$1(()=>{ut.current=!1,pt.current=ct;for(let xt=0;xt<mt.length;xt++){const St=getChildKey(mt[xt]);lt.includes(St)?dt.delete(St):dt.get(St)!==!0&&dt.set(St,!1)}},[mt,lt.length,lt.join("-")]);const yt=[];if(ct!==ht){let xt=[...ct];for(let St=0;St<mt.length;St++){const Et=mt[St],wt=getChildKey(Et);lt.includes(wt)||(xt.splice(St,0,Et),yt.push(Et))}return nt==="wait"&&yt.length&&(xt=yt),gt(onlyElements(xt)),ft(ct),null}const{forceRender:vt}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:mt.map(xt=>{const St=getChildKey(xt),Et=rt&&!at?!1:ct===mt||lt.includes(St),wt=()=>{if(dt.has(St))dt.set(St,!0);else return;let Tt=!0;dt.forEach(Ct=>{Ct||(Tt=!1)}),Tt&&(vt==null||vt(),gt(pt.current),rt&&(ot==null||ot()),et&&et())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:Et,initial:!ut.current||_e?void 0:!1,custom:$,presenceAffectsLayout:tt,mode:nt,root:st,onExitComplete:Et?void 0:wt,anchorX:it,children:xt},St)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const j in featureProps)featureDefinitions[j]={isEnabled:$=>featureProps[j].some(_e=>!!$[_e])};function loadFeatures(j){for(const $ in j)featureDefinitions[$]={...featureDefinitions[$],...j[$]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(j){return j.startsWith("while")||j.startsWith("drag")&&j!=="draggable"||j.startsWith("layout")||j.startsWith("onTap")||j.startsWith("onPan")||j.startsWith("onLayout")||validMotionProps.has(j)}let shouldForward=j=>!isValidMotionProp(j);function loadExternalIsValidProp(j){typeof j=="function"&&(shouldForward=$=>$.startsWith("on")?!isValidMotionProp($):j($))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(j,$,_e){const et={};for(const tt in j)tt==="values"&&typeof j.values=="object"||(shouldForward(tt)||_e===!0&&isValidMotionProp(tt)||!$&&!isValidMotionProp(tt)||j.draggable&&tt.startsWith("onDrag"))&&(et[tt]=j[tt]);return et}const MotionContext=reactExports.createContext({});function isAnimationControls(j){return j!==null&&typeof j=="object"&&typeof j.start=="function"}function isVariantLabel(j){return typeof j=="string"||Array.isArray(j)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(j){return isAnimationControls(j.animate)||variantProps.some($=>isVariantLabel(j[$]))}function isVariantNode(j){return!!(isControllingVariants(j)||j.variants)}function getCurrentTreeVariants(j,$){if(isControllingVariants(j)){const{initial:_e,animate:et}=j;return{initial:_e===!1||isVariantLabel(_e)?_e:void 0,animate:isVariantLabel(et)?et:void 0}}return j.inherit!==!1?$:{}}function useCreateMotionContext(j){const{initial:$,animate:_e}=getCurrentTreeVariants(j,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:$,animate:_e}),[variantLabelsAsDependency($),variantLabelsAsDependency(_e)])}function variantLabelsAsDependency(j){return Array.isArray(j)?j.join(" "):j}function pixelsToPercent(j,$){return $.max===$.min?0:j/($.max-$.min)*100}const correctBorderRadius={correct:(j,$)=>{if(!$.target)return j;if(typeof j=="string")if(px.test(j))j=parseFloat(j);else return j;const _e=pixelsToPercent(j,$.target.x),et=pixelsToPercent(j,$.target.y);return`${_e}% ${et}%`}},correctBoxShadow={correct:(j,{treeScale:$,projectionDelta:_e})=>{const et=j,tt=complex.parse(j);if(tt.length>5)return et;const nt=complex.createTransformer(j),rt=typeof tt[0]!="number"?1:0,it=_e.x.scale*$.x,st=_e.y.scale*$.y;tt[0+rt]/=it,tt[1+rt]/=st;const at=mixNumber$1(it,st,.5);return typeof tt[2+rt]=="number"&&(tt[2+rt]/=at),typeof tt[3+rt]=="number"&&(tt[3+rt]/=at),nt(tt)}},scaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function isForcedMotionValue(j,{layout:$,layoutId:_e}){return transformProps.has(j)||j.startsWith("origin")||($||_e!==void 0)&&(!!scaleCorrectors[j]||j==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(j,$,_e){let et="",tt=!0;for(let nt=0;nt<numTransforms;nt++){const rt=transformPropOrder[nt],it=j[rt];if(it===void 0)continue;let st=!0;if(typeof it=="number"?st=it===(rt.startsWith("scale")?1:0):st=parseFloat(it)===0,!st||_e){const at=getValueAsType(it,numberValueTypes[rt]);if(!st){tt=!1;const ot=translateAlias[rt]||rt;et+=`${ot}(${at}) `}_e&&($[rt]=at)}}return et=et.trim(),_e?et=_e($,tt?"":et):tt&&(et="none"),et}function buildHTMLStyles(j,$,_e){const{style:et,vars:tt,transformOrigin:nt}=j;let rt=!1,it=!1;for(const st in $){const at=$[st];if(transformProps.has(st)){rt=!0;continue}else if(isCSSVariableName(st)){tt[st]=at;continue}else{const ot=getValueAsType(at,numberValueTypes[st]);st.startsWith("origin")?(it=!0,nt[st]=ot):et[st]=ot}}if($.transform||(rt||_e?et.transform=buildTransform($,j.transform,_e):et.transform&&(et.transform="none")),it){const{originX:st="50%",originY:at="50%",originZ:ot=0}=nt;et.transformOrigin=`${st} ${at} ${ot}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(j,$,_e){for(const et in $)!isMotionValue($[et])&&!isForcedMotionValue(et,_e)&&(j[et]=$[et])}function useInitialMotionValues({transformTemplate:j},$){return reactExports.useMemo(()=>{const _e=createHtmlRenderState();return buildHTMLStyles(_e,$,j),Object.assign({},_e.vars,_e.style)},[$])}function useStyle(j,$){const _e=j.style||{},et={};return copyRawValuesOnly(et,_e,j),Object.assign(et,useInitialMotionValues(j,$)),et}function useHTMLProps(j,$){const _e={},et=useStyle(j,$);return j.drag&&j.dragListener!==!1&&(_e.draggable=!1,et.userSelect=et.WebkitUserSelect=et.WebkitTouchCallout="none",et.touchAction=j.drag===!0?"none":`pan-${j.drag==="x"?"y":"x"}`),j.tabIndex===void 0&&(j.onTap||j.onTapStart||j.whileTap)&&(_e.tabIndex=0),_e.style=et,_e}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(j,$,_e=1,et=0,tt=!0){j.pathLength=1;const nt=tt?dashKeys:camelKeys;j[nt.offset]=px.transform(-et);const rt=px.transform($),it=px.transform(_e);j[nt.array]=`${rt} ${it}`}function buildSVGAttrs(j,{attrX:$,attrY:_e,attrScale:et,pathLength:tt,pathSpacing:nt=1,pathOffset:rt=0,...it},st,at,ot){if(buildHTMLStyles(j,it,at),st){j.style.viewBox&&(j.attrs.viewBox=j.style.viewBox);return}j.attrs=j.style,j.style={};const{attrs:ct,style:lt}=j;ct.transform&&(lt.transform=ct.transform,delete ct.transform),(lt.transform||ct.transformOrigin)&&(lt.transformOrigin=ct.transformOrigin??"50% 50%",delete ct.transformOrigin),lt.transform&&(lt.transformBox=(ot==null?void 0:ot.transformBox)??"fill-box",delete ct.transformBox),$!==void 0&&(ct.x=$),_e!==void 0&&(ct.y=_e),et!==void 0&&(ct.scale=et),tt!==void 0&&buildSVGPath(ct,tt,nt,rt,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=j=>typeof j=="string"&&j.toLowerCase()==="svg";function useSVGProps(j,$,_e,et){const tt=reactExports.useMemo(()=>{const nt=createSvgRenderState();return buildSVGAttrs(nt,$,isSVGTag(et),j.transformTemplate,j.style),{...nt.attrs,style:{...nt.style}}},[$]);if(j.style){const nt={};copyRawValuesOnly(nt,j.style,j),tt.style={...nt,...tt.style}}return tt}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(j){return typeof j!="string"||j.includes("-")?!1:!!(lowercaseSVGElements.indexOf(j)>-1||/[A-Z]/u.test(j))}function useRender(j,$,_e,{latestValues:et},tt,nt=!1){const it=(isSVGComponent(j)?useSVGProps:useHTMLProps)($,et,tt,j),st=filterProps($,typeof j=="string",nt),at=j!==reactExports.Fragment?{...st,...it,ref:_e}:{},{children:ot}=$,ct=reactExports.useMemo(()=>isMotionValue(ot)?ot.get():ot,[ot]);return reactExports.createElement(j,{...at,children:ct})}function getValueState(j){const $=[{},{}];return j==null||j.values.forEach((_e,et)=>{$[0][et]=_e.get(),$[1][et]=_e.getVelocity()}),$}function resolveVariantFromProps(j,$,_e,et){if(typeof $=="function"){const[tt,nt]=getValueState(et);$=$(_e!==void 0?_e:j.custom,tt,nt)}if(typeof $=="string"&&($=j.variants&&j.variants[$]),typeof $=="function"){const[tt,nt]=getValueState(et);$=$(_e!==void 0?_e:j.custom,tt,nt)}return $}function resolveMotionValue(j){return isMotionValue(j)?j.get():j}function makeState({scrapeMotionValuesFromProps:j,createRenderState:$},_e,et,tt){return{latestValues:makeLatestValues(_e,et,tt,j),renderState:$()}}function makeLatestValues(j,$,_e,et){const tt={},nt=et(j,{});for(const lt in nt)tt[lt]=resolveMotionValue(nt[lt]);let{initial:rt,animate:it}=j;const st=isControllingVariants(j),at=isVariantNode(j);$&&at&&!st&&j.inherit!==!1&&(rt===void 0&&(rt=$.initial),it===void 0&&(it=$.animate));let ot=_e?_e.initial===!1:!1;ot=ot||rt===!1;const ct=ot?it:rt;if(ct&&typeof ct!="boolean"&&!isAnimationControls(ct)){const lt=Array.isArray(ct)?ct:[ct];for(let ut=0;ut<lt.length;ut++){const pt=resolveVariantFromProps(j,lt[ut]);if(pt){const{transitionEnd:dt,transition:ht,...ft}=pt;for(const mt in ft){let gt=ft[mt];if(Array.isArray(gt)){const yt=ot?gt.length-1:0;gt=gt[yt]}gt!==null&&(tt[mt]=gt)}for(const mt in dt)tt[mt]=dt[mt]}}}return tt}const makeUseVisualState=j=>($,_e)=>{const et=reactExports.useContext(MotionContext),tt=reactExports.useContext(PresenceContext),nt=()=>makeState(j,$,et,tt);return _e?nt():useConstant(nt)};function scrapeMotionValuesFromProps$1(j,$,_e){var nt;const{style:et}=j,tt={};for(const rt in et)(isMotionValue(et[rt])||$.style&&isMotionValue($.style[rt])||isForcedMotionValue(rt,j)||((nt=_e==null?void 0:_e.getValue(rt))==null?void 0:nt.liveStyle)!==void 0)&&(tt[rt]=et[rt]);return tt}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(j,$,_e){const et=scrapeMotionValuesFromProps$1(j,$,_e);for(const tt in j)if(isMotionValue(j[tt])||isMotionValue($[tt])){const nt=transformPropOrder.indexOf(tt)!==-1?"attr"+tt.charAt(0).toUpperCase()+tt.substring(1):tt;et[nt]=j[tt]}return et}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(j){return j&&typeof j=="object"&&Object.prototype.hasOwnProperty.call(j,"current")}function useMotionRef(j,$,_e){return reactExports.useCallback(et=>{et&&j.onMount&&j.onMount(et),$&&(et?$.mount(et):$.unmount()),_e&&(typeof _e=="function"?_e(et):isRefObject(_e)&&(_e.current=et))},[$])}const camelToDash=j=>j.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(j,$,_e,et,tt){var dt,ht;const{visualElement:nt}=reactExports.useContext(MotionContext),rt=reactExports.useContext(LazyContext),it=reactExports.useContext(PresenceContext),st=reactExports.useContext(MotionConfigContext).reducedMotion,at=reactExports.useRef(null);et=et||rt.renderer,!at.current&&et&&(at.current=et(j,{visualState:$,parent:nt,props:_e,presenceContext:it,blockInitialAnimation:it?it.initial===!1:!1,reducedMotionConfig:st}));const ot=at.current,ct=reactExports.useContext(SwitchLayoutGroupContext);ot&&!ot.projection&&tt&&(ot.type==="html"||ot.type==="svg")&&createProjectionNode$1(at.current,_e,tt,ct);const lt=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{ot&&lt.current&&ot.update(_e,it)});const ut=_e[optimizedAppearDataAttribute],pt=reactExports.useRef(!!ut&&!((dt=window.MotionHandoffIsComplete)!=null&&dt.call(window,ut))&&((ht=window.MotionHasOptimisedAnimation)==null?void 0:ht.call(window,ut)));return useIsomorphicLayoutEffect$1(()=>{ot&&(lt.current=!0,window.MotionIsMounted=!0,ot.updateFeatures(),ot.scheduleRenderMicrotask(),pt.current&&ot.animationState&&ot.animationState.animateChanges())}),reactExports.useEffect(()=>{ot&&(!pt.current&&ot.animationState&&ot.animationState.animateChanges(),pt.current&&(queueMicrotask(()=>{var ft;(ft=window.MotionHandoffMarkAsComplete)==null||ft.call(window,ut)}),pt.current=!1),ot.enteringChildren=void 0)}),ot}function createProjectionNode$1(j,$,_e,et){const{layoutId:tt,layout:nt,drag:rt,dragConstraints:it,layoutScroll:st,layoutRoot:at,layoutCrossfade:ot}=$;j.projection=new _e(j.latestValues,$["data-framer-portal-id"]?void 0:getClosestProjectingNode(j.parent)),j.projection.setOptions({layoutId:tt,layout:nt,alwaysMeasureLayout:!!rt||it&&isRefObject(it),visualElement:j,animationType:typeof nt=="string"?nt:"both",initialPromotionConfig:et,crossfade:ot,layoutScroll:st,layoutRoot:at})}function getClosestProjectingNode(j){if(j)return j.options.allowProjection!==!1?j.projection:getClosestProjectingNode(j.parent)}function createMotionComponent(j,{forwardMotionProps:$=!1}={},_e,et){_e&&loadFeatures(_e);const tt=isSVGComponent(j)?useSVGVisualState:useHTMLVisualState;function nt(it,st){let at;const ot={...reactExports.useContext(MotionConfigContext),...it,layoutId:useLayoutId(it)},{isStatic:ct}=ot,lt=useCreateMotionContext(it),ut=tt(it,ct);if(!ct&&isBrowser){useStrictMode();const pt=getProjectionFunctionality(ot);at=pt.MeasureLayout,lt.visualElement=useVisualElement(j,ut,ot,et,pt.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:lt,children:[at&&lt.visualElement?jsxRuntimeExports.jsx(at,{visualElement:lt.visualElement,...ot}):null,useRender(j,it,useMotionRef(ut,lt.visualElement,st),ut,ct,$)]})}nt.displayName=`motion.${typeof j=="string"?j:`create(${j.displayName??j.name??""})`}`;const rt=reactExports.forwardRef(nt);return rt[motionComponentSymbol]=j,rt}function useLayoutId({layoutId:j}){const $=reactExports.useContext(LayoutGroupContext).id;return $&&j!==void 0?$+"-"+j:j}function useStrictMode(j,$){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(j){const{drag:$,layout:_e}=featureDefinitions;if(!$&&!_e)return{};const et={...$,..._e};return{MeasureLayout:$!=null&&$.isEnabled(j)||_e!=null&&_e.isEnabled(j)?et.MeasureLayout:void 0,ProjectionNode:et.ProjectionNode}}function createMotionProxy(j,$){if(typeof Proxy>"u")return createMotionComponent;const _e=new Map,et=(nt,rt)=>createMotionComponent(nt,rt,j,$),tt=(nt,rt)=>et(nt,rt);return new Proxy(tt,{get:(nt,rt)=>rt==="create"?et:(_e.has(rt)||_e.set(rt,createMotionComponent(rt,void 0,j,$)),_e.get(rt))})}function convertBoundingBoxToBox({top:j,left:$,right:_e,bottom:et}){return{x:{min:$,max:_e},y:{min:j,max:et}}}function convertBoxToBoundingBox({x:j,y:$}){return{top:$.min,right:j.max,bottom:$.max,left:j.min}}function transformBoxPoints(j,$){if(!$)return j;const _e=$({x:j.left,y:j.top}),et=$({x:j.right,y:j.bottom});return{top:_e.y,left:_e.x,bottom:et.y,right:et.x}}function isIdentityScale(j){return j===void 0||j===1}function hasScale({scale:j,scaleX:$,scaleY:_e}){return!isIdentityScale(j)||!isIdentityScale($)||!isIdentityScale(_e)}function hasTransform(j){return hasScale(j)||has2DTranslate(j)||j.z||j.rotate||j.rotateX||j.rotateY||j.skewX||j.skewY}function has2DTranslate(j){return is2DTranslate(j.x)||is2DTranslate(j.y)}function is2DTranslate(j){return j&&j!=="0%"}function scalePoint(j,$,_e){const et=j-_e,tt=$*et;return _e+tt}function applyPointDelta(j,$,_e,et,tt){return tt!==void 0&&(j=scalePoint(j,tt,et)),scalePoint(j,_e,et)+$}function applyAxisDelta(j,$=0,_e=1,et,tt){j.min=applyPointDelta(j.min,$,_e,et,tt),j.max=applyPointDelta(j.max,$,_e,et,tt)}function applyBoxDelta(j,{x:$,y:_e}){applyAxisDelta(j.x,$.translate,$.scale,$.originPoint),applyAxisDelta(j.y,_e.translate,_e.scale,_e.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(j,$,_e,et=!1){const tt=_e.length;if(!tt)return;$.x=$.y=1;let nt,rt;for(let it=0;it<tt;it++){nt=_e[it],rt=nt.projectionDelta;const{visualElement:st}=nt.options;st&&st.props.style&&st.props.style.display==="contents"||(et&&nt.options.layoutScroll&&nt.scroll&&nt!==nt.root&&transformBox(j,{x:-nt.scroll.offset.x,y:-nt.scroll.offset.y}),rt&&($.x*=rt.x.scale,$.y*=rt.y.scale,applyBoxDelta(j,rt)),et&&hasTransform(nt.latestValues)&&transformBox(j,nt.latestValues))}$.x<TREE_SCALE_SNAP_MAX&&$.x>TREE_SCALE_SNAP_MIN&&($.x=1),$.y<TREE_SCALE_SNAP_MAX&&$.y>TREE_SCALE_SNAP_MIN&&($.y=1)}function translateAxis(j,$){j.min=j.min+$,j.max=j.max+$}function transformAxis(j,$,_e,et,tt=.5){const nt=mixNumber$1(j.min,j.max,tt);applyAxisDelta(j,$,_e,nt,et)}function transformBox(j,$){transformAxis(j.x,$.x,$.scaleX,$.scale,$.originX),transformAxis(j.y,$.y,$.scaleY,$.scale,$.originY)}function measureViewportBox(j,$){return convertBoundingBoxToBox(transformBoxPoints(j.getBoundingClientRect(),$))}function measurePageBox(j,$,_e){const et=measureViewportBox(j,_e),{scroll:tt}=$;return tt&&(translateAxis(et.x,tt.offset.x),translateAxis(et.y,tt.offset.y)),et}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const j=window.matchMedia("(prefers-reduced-motion)"),$=()=>prefersReducedMotion.current=j.matches;j.addEventListener("change",$),$()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(j,$,_e){for(const et in $){const tt=$[et],nt=_e[et];if(isMotionValue(tt))j.addValue(et,tt);else if(isMotionValue(nt))j.addValue(et,motionValue(tt,{owner:j}));else if(nt!==tt)if(j.hasValue(et)){const rt=j.getValue(et);rt.liveStyle===!0?rt.jump(tt):rt.hasAnimated||rt.set(tt)}else{const rt=j.getStaticValue(et);j.addValue(et,motionValue(rt!==void 0?rt:tt,{owner:j}))}}for(const et in _e)$[et]===void 0&&j.removeValue(et);return $}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps($,_e,et){return{}}constructor({parent:$,props:_e,presenceContext:et,reducedMotionConfig:tt,blockInitialAnimation:nt,visualState:rt},it={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const lt=time$1.now();this.renderScheduledAt<lt&&(this.renderScheduledAt=lt,frame.render(this.render,!1,!0))};const{latestValues:st,renderState:at}=rt;this.latestValues=st,this.baseTarget={...st},this.initialValues=_e.initial?{...st}:{},this.renderState=at,this.parent=$,this.props=_e,this.presenceContext=et,this.depth=$?$.depth+1:0,this.reducedMotionConfig=tt,this.options=it,this.blockInitialAnimation=!!nt,this.isControllingVariants=isControllingVariants(_e),this.isVariantNode=isVariantNode(_e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!($&&$.current);const{willChange:ot,...ct}=this.scrapeMotionValuesFromProps(_e,{},this);for(const lt in ct){const ut=ct[lt];st[lt]!==void 0&&isMotionValue(ut)&&ut.set(st[lt])}}mount($){var _e;this.current=$,visualElementStore.set($,this),this.projection&&!this.projection.instance&&this.projection.mount($),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((et,tt)=>this.bindToMotionValue(tt,et)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,(_e=this.parent)==null||_e.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var $;this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(_e=>_e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),($=this.parent)==null||$.removeChild(this);for(const _e in this.events)this.events[_e].clear();for(const _e in this.features){const et=this.features[_e];et&&(et.unmount(),et.isMounted=!1)}this.current=null}addChild($){this.children.add($),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add($)}removeChild($){this.children.delete($),this.enteringChildren&&this.enteringChildren.delete($)}bindToMotionValue($,_e){this.valueSubscriptions.has($)&&this.valueSubscriptions.get($)();const et=transformProps.has($);et&&this.onBindTransform&&this.onBindTransform();const tt=_e.on("change",rt=>{this.latestValues[$]=rt,this.props.onUpdate&&frame.preRender(this.notifyUpdate),et&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let nt;window.MotionCheckAppearSync&&(nt=window.MotionCheckAppearSync(this,$,_e)),this.valueSubscriptions.set($,()=>{tt(),nt&&nt(),_e.owner&&_e.stop()})}sortNodePosition($){return!this.current||!this.sortInstanceNodePosition||this.type!==$.type?0:this.sortInstanceNodePosition(this.current,$.current)}updateFeatures(){let $="animation";for($ in featureDefinitions){const _e=featureDefinitions[$];if(!_e)continue;const{isEnabled:et,Feature:tt}=_e;if(!this.features[$]&&tt&&et(this.props)&&(this.features[$]=new tt(this)),this.features[$]){const nt=this.features[$];nt.isMounted?nt.update():(nt.mount(),nt.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue($){return this.latestValues[$]}setStaticValue($,_e){this.latestValues[$]=_e}update($,_e){($.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=$,this.prevPresenceContext=this.presenceContext,this.presenceContext=_e;for(let et=0;et<propEventHandlers.length;et++){const tt=propEventHandlers[et];this.propEventSubscriptions[tt]&&(this.propEventSubscriptions[tt](),delete this.propEventSubscriptions[tt]);const nt="on"+tt,rt=$[nt];rt&&(this.propEventSubscriptions[tt]=this.on(tt,rt))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps($,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant($){return this.props.variants?this.props.variants[$]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild($){const _e=this.getClosestVariantNode();if(_e)return _e.variantChildren&&_e.variantChildren.add($),()=>_e.variantChildren.delete($)}addValue($,_e){const et=this.values.get($);_e!==et&&(et&&this.removeValue($),this.bindToMotionValue($,_e),this.values.set($,_e),this.latestValues[$]=_e.get())}removeValue($){this.values.delete($);const _e=this.valueSubscriptions.get($);_e&&(_e(),this.valueSubscriptions.delete($)),delete this.latestValues[$],this.removeValueFromRenderState($,this.renderState)}hasValue($){return this.values.has($)}getValue($,_e){if(this.props.values&&this.props.values[$])return this.props.values[$];let et=this.values.get($);return et===void 0&&_e!==void 0&&(et=motionValue(_e===null?void 0:_e,{owner:this}),this.addValue($,et)),et}readValue($,_e){let et=this.latestValues[$]!==void 0||!this.current?this.latestValues[$]:this.getBaseTargetFromProps(this.props,$)??this.readValueFromInstance(this.current,$,this.options);return et!=null&&(typeof et=="string"&&(isNumericalString(et)||isZeroValueString(et))?et=parseFloat(et):!findValueType(et)&&complex.test(_e)&&(et=getAnimatableNone($,_e)),this.setBaseTarget($,isMotionValue(et)?et.get():et)),isMotionValue(et)?et.get():et}setBaseTarget($,_e){this.baseTarget[$]=_e}getBaseTarget($){var nt;const{initial:_e}=this.props;let et;if(typeof _e=="string"||typeof _e=="object"){const rt=resolveVariantFromProps(this.props,_e,(nt=this.presenceContext)==null?void 0:nt.custom);rt&&(et=rt[$])}if(_e&&et!==void 0)return et;const tt=this.getBaseTargetFromProps(this.props,$);return tt!==void 0&&!isMotionValue(tt)?tt:this.initialValues[$]!==void 0&&et===void 0?void 0:this.baseTarget[$]}on($,_e){return this.events[$]||(this.events[$]=new SubscriptionManager),this.events[$].add(_e)}notify($,..._e){this.events[$]&&this.events[$].notify(..._e)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition($,_e){return $.compareDocumentPosition(_e)&2?1:-1}getBaseTargetFromProps($,_e){return $.style?$.style[_e]:void 0}removeValueFromRenderState($,{vars:_e,style:et}){delete _e[$],delete et[$]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:$}=this.props;isMotionValue($)&&(this.childSubscription=$.on("change",_e=>{this.current&&(this.current.textContent=`${_e}`)}))}}function renderHTML(j,{style:$,vars:_e},et,tt){const nt=j.style;let rt;for(rt in $)nt[rt]=$[rt];tt==null||tt.applyProjectionStyles(nt,et);for(rt in _e)nt.setProperty(rt,_e[rt])}function getComputedStyle$1(j){return window.getComputedStyle(j)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance($,_e){var et;if(transformProps.has(_e))return(et=this.projection)!=null&&et.isProjecting?defaultTransformValue(_e):readTransformValue($,_e);{const tt=getComputedStyle$1($),nt=(isCSSVariableName(_e)?tt.getPropertyValue(_e):tt[_e])||0;return typeof nt=="string"?nt.trim():nt}}measureInstanceViewportBox($,{transformPagePoint:_e}){return measureViewportBox($,_e)}build($,_e,et){buildHTMLStyles($,_e,et.transformTemplate)}scrapeMotionValuesFromProps($,_e,et){return scrapeMotionValuesFromProps$1($,_e,et)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(j,$,_e,et){renderHTML(j,$,void 0,et);for(const tt in $.attrs)j.setAttribute(camelCaseAttributes.has(tt)?tt:camelToDash(tt),$.attrs[tt])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps($,_e){return $[_e]}readValueFromInstance($,_e){if(transformProps.has(_e)){const et=getDefaultValueType(_e);return et&&et.default||0}return _e=camelCaseAttributes.has(_e)?_e:camelToDash(_e),$.getAttribute(_e)}scrapeMotionValuesFromProps($,_e,et){return scrapeMotionValuesFromProps($,_e,et)}build($,_e,et){buildSVGAttrs($,_e,this.isSVGTag,et.transformTemplate,et.style)}renderInstance($,_e,et,tt){renderSVG($,_e,et,tt)}mount($){this.isSVGTag=isSVGTag($.tagName),super.mount($)}}const createDomVisualElement=(j,$)=>isSVGComponent(j)?new SVGVisualElement($):new HTMLVisualElement($,{allowProjection:j!==reactExports.Fragment});function resolveVariant(j,$,_e){const et=j.getProps();return resolveVariantFromProps(et,$,_e!==void 0?_e:et.custom,j)}const isKeyframesTarget=j=>Array.isArray(j);function setMotionValue(j,$,_e){j.hasValue($)?j.getValue($).set(_e):j.addValue($,motionValue(_e))}function resolveFinalValueInKeyframes(j){return isKeyframesTarget(j)?j[j.length-1]||0:j}function setTarget(j,$){const _e=resolveVariant(j,$);let{transitionEnd:et={},transition:tt={},...nt}=_e||{};nt={...nt,...et};for(const rt in nt){const it=resolveFinalValueInKeyframes(nt[rt]);setMotionValue(j,rt,it)}}function isWillChangeMotionValue(j){return!!(isMotionValue(j)&&j.add)}function addValueToWillChange(j,$){const _e=j.getValue("willChange");if(isWillChangeMotionValue(_e))return _e.add($);if(!_e&&MotionGlobalConfig.WillChange){const et=new MotionGlobalConfig.WillChange("auto");j.addValue("willChange",et),et.add($)}}function getOptimisedAppearId(j){return j.props[optimizedAppearDataAttribute]}const isNotNull=j=>j!==null;function getFinalKeyframe(j,{repeat:$,repeatType:_e="loop"},et){const tt=j.filter(isNotNull),nt=$&&_e!=="loop"&&$%2===1?0:tt.length-1;return tt[nt]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=j=>({type:"spring",stiffness:550,damping:j===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(j,{keyframes:$})=>$.length>2?keyframesTransition:transformProps.has(j)?j.startsWith("scale")?criticallyDampedSpring($[1]):underDampedSpring:ease;function isTransitionDefined({when:j,delay:$,delayChildren:_e,staggerChildren:et,staggerDirection:tt,repeat:nt,repeatType:rt,repeatDelay:it,from:st,elapsed:at,...ot}){return!!Object.keys(ot).length}const animateMotionValue=(j,$,_e,et={},tt,nt)=>rt=>{const it=getValueTransition(et,j)||{},st=it.delay||et.delay||0;let{elapsed:at=0}=et;at=at-secondsToMilliseconds(st);const ot={keyframes:Array.isArray(_e)?_e:[null,_e],ease:"easeOut",velocity:$.getVelocity(),...it,delay:-at,onUpdate:lt=>{$.set(lt),it.onUpdate&&it.onUpdate(lt)},onComplete:()=>{rt(),it.onComplete&&it.onComplete()},name:j,motionValue:$,element:nt?void 0:tt};isTransitionDefined(it)||Object.assign(ot,getDefaultTransition(j,ot)),ot.duration&&(ot.duration=secondsToMilliseconds(ot.duration)),ot.repeatDelay&&(ot.repeatDelay=secondsToMilliseconds(ot.repeatDelay)),ot.from!==void 0&&(ot.keyframes[0]=ot.from);let ct=!1;if((ot.type===!1||ot.duration===0&&!ot.repeatDelay)&&(makeAnimationInstant(ot),ot.delay===0&&(ct=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(ct=!0,makeAnimationInstant(ot),ot.delay=0),ot.allowFlatten=!it.type&&!it.ease,ct&&!nt&&$.get()!==void 0){const lt=getFinalKeyframe(ot.keyframes,it);if(lt!==void 0){frame.update(()=>{ot.onUpdate(lt),ot.onComplete()});return}}return it.isSync?new JSAnimation(ot):new AsyncMotionValueAnimation(ot)};function shouldBlockAnimation({protectedKeys:j,needsAnimating:$},_e){const et=j.hasOwnProperty(_e)&&$[_e]!==!0;return $[_e]=!1,et}function animateTarget(j,$,{delay:_e=0,transitionOverride:et,type:tt}={}){let{transition:nt=j.getDefaultTransition(),transitionEnd:rt,...it}=$;et&&(nt=et);const st=[],at=tt&&j.animationState&&j.animationState.getState()[tt];for(const ot in it){const ct=j.getValue(ot,j.latestValues[ot]??null),lt=it[ot];if(lt===void 0||at&&shouldBlockAnimation(at,ot))continue;const ut={delay:_e,...getValueTransition(nt||{},ot)},pt=ct.get();if(pt!==void 0&&!ct.isAnimating&&!Array.isArray(lt)&&lt===pt&&!ut.velocity)continue;let dt=!1;if(window.MotionHandoffAnimation){const ft=getOptimisedAppearId(j);if(ft){const mt=window.MotionHandoffAnimation(ft,ot,frame);mt!==null&&(ut.startTime=mt,dt=!0)}}addValueToWillChange(j,ot),ct.start(animateMotionValue(ot,ct,lt,j.shouldReduceMotion&&positionalKeys.has(ot)?{type:!1}:ut,j,dt));const ht=ct.animation;ht&&st.push(ht)}return rt&&Promise.all(st).then(()=>{frame.update(()=>{rt&&setTarget(j,rt)})}),st}function calcChildStagger(j,$,_e,et=0,tt=1){const nt=Array.from(j).sort((at,ot)=>at.sortNodePosition(ot)).indexOf($),rt=j.size,it=(rt-1)*et;return typeof _e=="function"?_e(nt,rt):tt===1?nt*et:it-nt*et}function animateVariant(j,$,_e={}){var st;const et=resolveVariant(j,$,_e.type==="exit"?(st=j.presenceContext)==null?void 0:st.custom:void 0);let{transition:tt=j.getDefaultTransition()||{}}=et||{};_e.transitionOverride&&(tt=_e.transitionOverride);const nt=et?()=>Promise.all(animateTarget(j,et,_e)):()=>Promise.resolve(),rt=j.variantChildren&&j.variantChildren.size?(at=0)=>{const{delayChildren:ot=0,staggerChildren:ct,staggerDirection:lt}=tt;return animateChildren(j,$,at,ot,ct,lt,_e)}:()=>Promise.resolve(),{when:it}=tt;if(it){const[at,ot]=it==="beforeChildren"?[nt,rt]:[rt,nt];return at().then(()=>ot())}else return Promise.all([nt(),rt(_e.delay)])}function animateChildren(j,$,_e=0,et=0,tt=0,nt=1,rt){const it=[];for(const st of j.variantChildren)st.notify("AnimationStart",$),it.push(animateVariant(st,$,{...rt,delay:_e+(typeof et=="function"?0:et)+calcChildStagger(j.variantChildren,st,et,tt,nt)}).then(()=>st.notify("AnimationComplete",$)));return Promise.all(it)}function animateVisualElement(j,$,_e={}){j.notify("AnimationStart",$);let et;if(Array.isArray($)){const tt=$.map(nt=>animateVariant(j,nt,_e));et=Promise.all(tt)}else if(typeof $=="string")et=animateVariant(j,$,_e);else{const tt=typeof $=="function"?resolveVariant(j,$,_e.custom):$;et=Promise.all(animateTarget(j,tt,_e))}return et.then(()=>{j.notify("AnimationComplete",$)})}function shallowCompare(j,$){if(!Array.isArray($))return!1;const _e=$.length;if(_e!==j.length)return!1;for(let et=0;et<_e;et++)if($[et]!==j[et])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(j){if(!j)return;if(!j.isControllingVariants){const _e=j.parent?getVariantContext(j.parent)||{}:{};return j.props.initial!==void 0&&(_e.initial=j.props.initial),_e}const $={};for(let _e=0;_e<numVariantProps;_e++){const et=variantProps[_e],tt=j.props[et];(isVariantLabel(tt)||tt===!1)&&($[et]=tt)}return $}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(j){return $=>Promise.all($.map(({animation:_e,options:et})=>animateVisualElement(j,_e,et)))}function createAnimationState(j){let $=animateList(j),_e=createState$1(),et=!0;const tt=st=>(at,ot)=>{var lt;const ct=resolveVariant(j,ot,st==="exit"?(lt=j.presenceContext)==null?void 0:lt.custom:void 0);if(ct){const{transition:ut,transitionEnd:pt,...dt}=ct;at={...at,...dt,...pt}}return at};function nt(st){$=st(j)}function rt(st){const{props:at}=j,ot=getVariantContext(j.parent)||{},ct=[],lt=new Set;let ut={},pt=1/0;for(let ht=0;ht<numAnimationTypes;ht++){const ft=reversePriorityOrder[ht],mt=_e[ft],gt=at[ft]!==void 0?at[ft]:ot[ft],yt=isVariantLabel(gt),vt=ft===st?mt.isActive:null;vt===!1&&(pt=ht);let xt=gt===ot[ft]&&gt!==at[ft]&&yt;if(xt&&et&&j.manuallyAnimateOnMount&&(xt=!1),mt.protectedKeys={...ut},!mt.isActive&&vt===null||!gt&&!mt.prevProp||isAnimationControls(gt)||typeof gt=="boolean")continue;const St=checkVariantsDidChange(mt.prevProp,gt);let Et=St||ft===st&&mt.isActive&&!xt&&yt||ht>pt&&yt,wt=!1;const Tt=Array.isArray(gt)?gt:[gt];let Ct=Tt.reduce(tt(ft),{});vt===!1&&(Ct={});const{prevResolvedValues:Rt={}}=mt,jt={...Rt,...Ct},Ot=Lt=>{Et=!0,lt.has(Lt)&&(wt=!0,lt.delete(Lt)),mt.needsAnimating[Lt]=!0;const Nt=j.getValue(Lt);Nt&&(Nt.liveStyle=!1)};for(const Lt in jt){const Nt=Ct[Lt],Bt=Rt[Lt];if(ut.hasOwnProperty(Lt))continue;let kt=!1;isKeyframesTarget(Nt)&&isKeyframesTarget(Bt)?kt=!shallowCompare(Nt,Bt):kt=Nt!==Bt,kt?Nt!=null?Ot(Lt):lt.add(Lt):Nt!==void 0&&lt.has(Lt)?Ot(Lt):mt.protectedKeys[Lt]=!0}mt.prevProp=gt,mt.prevResolvedValues=Ct,mt.isActive&&(ut={...ut,...Ct}),et&&j.blockInitialAnimation&&(Et=!1);const $t=xt&&St;Et&&(!$t||wt)&&ct.push(...Tt.map(Lt=>{const Nt={type:ft};if(typeof Lt=="string"&&et&&!$t&&j.manuallyAnimateOnMount&&j.parent){const{parent:Bt}=j,kt=resolveVariant(Bt,Lt);if(Bt.enteringChildren&&kt){const{delayChildren:rn}=kt.transition||{};Nt.delay=calcChildStagger(Bt.enteringChildren,j,rn)}}return{animation:Lt,options:Nt}}))}if(lt.size){const ht={};if(typeof at.initial!="boolean"){const ft=resolveVariant(j,Array.isArray(at.initial)?at.initial[0]:at.initial);ft&&ft.transition&&(ht.transition=ft.transition)}lt.forEach(ft=>{const mt=j.getBaseTarget(ft),gt=j.getValue(ft);gt&&(gt.liveStyle=!0),ht[ft]=mt??null}),ct.push({animation:ht})}let dt=!!ct.length;return et&&(at.initial===!1||at.initial===at.animate)&&!j.manuallyAnimateOnMount&&(dt=!1),et=!1,dt?$(ct):Promise.resolve()}function it(st,at){var ct;if(_e[st].isActive===at)return Promise.resolve();(ct=j.variantChildren)==null||ct.forEach(lt=>{var ut;return(ut=lt.animationState)==null?void 0:ut.setActive(st,at)}),_e[st].isActive=at;const ot=rt(st);for(const lt in _e)_e[lt].protectedKeys={};return ot}return{animateChanges:rt,setActive:it,setAnimateFunction:nt,getState:()=>_e,reset:()=>{_e=createState$1()}}}function checkVariantsDidChange(j,$){return typeof $=="string"?$!==j:Array.isArray($)?!shallowCompare($,j):!1}function createTypeState(j=!1){return{isActive:j,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState$1(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor($){this.isMounted=!1,this.node=$}update(){}}class AnimationFeature extends Feature{constructor($){super($),$.animationState||($.animationState=createAnimationState($))}updateAnimationControlsSubscription(){const{animate:$}=this.node.getProps();isAnimationControls($)&&(this.unmountControls=$.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:$}=this.node.getProps(),{animate:_e}=this.node.prevProps||{};$!==_e&&this.updateAnimationControlsSubscription()}unmount(){var $;this.node.animationState.reset(),($=this.unmountControls)==null||$.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:$,onExitComplete:_e}=this.node.presenceContext,{isPresent:et}=this.node.prevPresenceContext||{};if(!this.node.animationState||$===et)return;const tt=this.node.animationState.setActive("exit",!$);_e&&!$&&tt.then(()=>{_e(this.id)})}mount(){const{register:$,onExitComplete:_e}=this.node.presenceContext||{};_e&&_e(this.id),$&&(this.unmount=$(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(j,$,_e,et={passive:!0}){return j.addEventListener($,_e,et),()=>j.removeEventListener($,_e)}function extractEventInfo(j){return{point:{x:j.pageX,y:j.pageY}}}const addPointerInfo=j=>$=>isPrimaryPointer($)&&j($,extractEventInfo($));function addPointerEvent(j,$,_e,et){return addDomEvent(j,$,addPointerInfo(_e),et)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(j){return j.max-j.min}function isNear(j,$,_e){return Math.abs(j-$)<=_e}function calcAxisDelta(j,$,_e,et=.5){j.origin=et,j.originPoint=mixNumber$1($.min,$.max,j.origin),j.scale=calcLength(_e)/calcLength($),j.translate=mixNumber$1(_e.min,_e.max,j.origin)-j.originPoint,(j.scale>=SCALE_MIN&&j.scale<=SCALE_MAX||isNaN(j.scale))&&(j.scale=1),(j.translate>=TRANSLATE_MIN&&j.translate<=TRANSLATE_MAX||isNaN(j.translate))&&(j.translate=0)}function calcBoxDelta(j,$,_e,et){calcAxisDelta(j.x,$.x,_e.x,et?et.originX:void 0),calcAxisDelta(j.y,$.y,_e.y,et?et.originY:void 0)}function calcRelativeAxis(j,$,_e){j.min=_e.min+$.min,j.max=j.min+calcLength($)}function calcRelativeBox(j,$,_e){calcRelativeAxis(j.x,$.x,_e.x),calcRelativeAxis(j.y,$.y,_e.y)}function calcRelativeAxisPosition(j,$,_e){j.min=$.min-_e.min,j.max=j.min+calcLength($)}function calcRelativePosition(j,$,_e){calcRelativeAxisPosition(j.x,$.x,_e.x),calcRelativeAxisPosition(j.y,$.y,_e.y)}function eachAxis(j){return[j("x"),j("y")]}const getContextWindow=({current:j})=>j?j.ownerDocument.defaultView:null,distance=(j,$)=>Math.abs(j-$);function distance2D(j,$){const _e=distance(j.x,$.x),et=distance(j.y,$.y);return Math.sqrt(_e**2+et**2)}class PanSession{constructor($,_e,{transformPagePoint:et,contextWindow:tt=window,dragSnapToOrigin:nt=!1,distanceThreshold:rt=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const lt=getPanInfo(this.lastMoveEventInfo,this.history),ut=this.startEvent!==null,pt=distance2D(lt.offset,{x:0,y:0})>=this.distanceThreshold;if(!ut&&!pt)return;const{point:dt}=lt,{timestamp:ht}=frameData;this.history.push({...dt,timestamp:ht});const{onStart:ft,onMove:mt}=this.handlers;ut||(ft&&ft(this.lastMoveEvent,lt),this.startEvent=this.lastMoveEvent),mt&&mt(this.lastMoveEvent,lt)},this.handlePointerMove=(lt,ut)=>{this.lastMoveEvent=lt,this.lastMoveEventInfo=transformPoint(ut,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(lt,ut)=>{this.end();const{onEnd:pt,onSessionEnd:dt,resumeAnimation:ht}=this.handlers;if(this.dragSnapToOrigin&&ht&&ht(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ft=getPanInfo(lt.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(ut,this.transformPagePoint),this.history);this.startEvent&&pt&&pt(lt,ft),dt&&dt(lt,ft)},!isPrimaryPointer($))return;this.dragSnapToOrigin=nt,this.handlers=_e,this.transformPagePoint=et,this.distanceThreshold=rt,this.contextWindow=tt||window;const it=extractEventInfo($),st=transformPoint(it,this.transformPagePoint),{point:at}=st,{timestamp:ot}=frameData;this.history=[{...at,timestamp:ot}];const{onSessionStart:ct}=_e;ct&&ct($,getPanInfo(st,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers($){this.handlers=$}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(j,$){return $?{point:$(j.point)}:j}function subtractPoint(j,$){return{x:j.x-$.x,y:j.y-$.y}}function getPanInfo({point:j},$){return{point:j,delta:subtractPoint(j,lastDevicePoint($)),offset:subtractPoint(j,startDevicePoint($)),velocity:getVelocity($,.1)}}function startDevicePoint(j){return j[0]}function lastDevicePoint(j){return j[j.length-1]}function getVelocity(j,$){if(j.length<2)return{x:0,y:0};let _e=j.length-1,et=null;const tt=lastDevicePoint(j);for(;_e>=0&&(et=j[_e],!(tt.timestamp-et.timestamp>secondsToMilliseconds($)));)_e--;if(!et)return{x:0,y:0};const nt=millisecondsToSeconds(tt.timestamp-et.timestamp);if(nt===0)return{x:0,y:0};const rt={x:(tt.x-et.x)/nt,y:(tt.y-et.y)/nt};return rt.x===1/0&&(rt.x=0),rt.y===1/0&&(rt.y=0),rt}function applyConstraints(j,{min:$,max:_e},et){return $!==void 0&&j<$?j=et?mixNumber$1($,j,et.min):Math.max(j,$):_e!==void 0&&j>_e&&(j=et?mixNumber$1(_e,j,et.max):Math.min(j,_e)),j}function calcRelativeAxisConstraints(j,$,_e){return{min:$!==void 0?j.min+$:void 0,max:_e!==void 0?j.max+_e-(j.max-j.min):void 0}}function calcRelativeConstraints(j,{top:$,left:_e,bottom:et,right:tt}){return{x:calcRelativeAxisConstraints(j.x,_e,tt),y:calcRelativeAxisConstraints(j.y,$,et)}}function calcViewportAxisConstraints(j,$){let _e=$.min-j.min,et=$.max-j.max;return $.max-$.min<j.max-j.min&&([_e,et]=[et,_e]),{min:_e,max:et}}function calcViewportConstraints(j,$){return{x:calcViewportAxisConstraints(j.x,$.x),y:calcViewportAxisConstraints(j.y,$.y)}}function calcOrigin(j,$){let _e=.5;const et=calcLength(j),tt=calcLength($);return tt>et?_e=progress($.min,$.max-et,j.min):et>tt&&(_e=progress(j.min,j.max-tt,$.min)),clamp(0,1,_e)}function rebaseAxisConstraints(j,$){const _e={};return $.min!==void 0&&(_e.min=$.min-j.min),$.max!==void 0&&(_e.max=$.max-j.min),_e}const defaultElastic=.35;function resolveDragElastic(j=defaultElastic){return j===!1?j=0:j===!0&&(j=defaultElastic),{x:resolveAxisElastic(j,"left","right"),y:resolveAxisElastic(j,"top","bottom")}}function resolveAxisElastic(j,$,_e){return{min:resolvePointElastic(j,$),max:resolvePointElastic(j,_e)}}function resolvePointElastic(j,$){return typeof j=="number"?j:j[$]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor($){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=$}start($,{snapToCursor:_e=!1,distanceThreshold:et}={}){const{presenceContext:tt}=this.visualElement;if(tt&&tt.isPresent===!1)return;const nt=ct=>{const{dragSnapToOrigin:lt}=this.getProps();lt?this.pauseAnimation():this.stopAnimation(),_e&&this.snapToCursor(extractEventInfo(ct).point)},rt=(ct,lt)=>{const{drag:ut,dragPropagation:pt,onDragStart:dt}=this.getProps();if(ut&&!pt&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(ut),!this.openDragLock))return;this.latestPointerEvent=ct,this.latestPanInfo=lt,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(ft=>{let mt=this.getAxisMotionValue(ft).get()||0;if(percent.test(mt)){const{projection:gt}=this.visualElement;if(gt&&gt.layout){const yt=gt.layout.layoutBox[ft];yt&&(mt=calcLength(yt)*(parseFloat(mt)/100))}}this.originPoint[ft]=mt}),dt&&frame.postRender(()=>dt(ct,lt)),addValueToWillChange(this.visualElement,"transform");const{animationState:ht}=this.visualElement;ht&&ht.setActive("whileDrag",!0)},it=(ct,lt)=>{this.latestPointerEvent=ct,this.latestPanInfo=lt;const{dragPropagation:ut,dragDirectionLock:pt,onDirectionLock:dt,onDrag:ht}=this.getProps();if(!ut&&!this.openDragLock)return;const{offset:ft}=lt;if(pt&&this.currentDirection===null){this.currentDirection=getCurrentDirection(ft),this.currentDirection!==null&&dt&&dt(this.currentDirection);return}this.updateAxis("x",lt.point,ft),this.updateAxis("y",lt.point,ft),this.visualElement.render(),ht&&ht(ct,lt)},st=(ct,lt)=>{this.latestPointerEvent=ct,this.latestPanInfo=lt,this.stop(ct,lt),this.latestPointerEvent=null,this.latestPanInfo=null},at=()=>eachAxis(ct=>{var lt;return this.getAnimationState(ct)==="paused"&&((lt=this.getAxisMotionValue(ct).animation)==null?void 0:lt.play())}),{dragSnapToOrigin:ot}=this.getProps();this.panSession=new PanSession($,{onSessionStart:nt,onStart:rt,onMove:it,onSessionEnd:st,resumeAnimation:at},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:ot,distanceThreshold:et,contextWindow:getContextWindow(this.visualElement)})}stop($,_e){const et=$||this.latestPointerEvent,tt=_e||this.latestPanInfo,nt=this.isDragging;if(this.cancel(),!nt||!tt||!et)return;const{velocity:rt}=tt;this.startAnimation(rt);const{onDragEnd:it}=this.getProps();it&&frame.postRender(()=>it(et,tt))}cancel(){this.isDragging=!1;const{projection:$,animationState:_e}=this.visualElement;$&&($.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:et}=this.getProps();!et&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),_e&&_e.setActive("whileDrag",!1)}updateAxis($,_e,et){const{drag:tt}=this.getProps();if(!et||!shouldDrag($,tt,this.currentDirection))return;const nt=this.getAxisMotionValue($);let rt=this.originPoint[$]+et[$];this.constraints&&this.constraints[$]&&(rt=applyConstraints(rt,this.constraints[$],this.elastic[$])),nt.set(rt)}resolveConstraints(){var nt;const{dragConstraints:$,dragElastic:_e}=this.getProps(),et=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(nt=this.visualElement.projection)==null?void 0:nt.layout,tt=this.constraints;$&&isRefObject($)?this.constraints||(this.constraints=this.resolveRefConstraints()):$&&et?this.constraints=calcRelativeConstraints(et.layoutBox,$):this.constraints=!1,this.elastic=resolveDragElastic(_e),tt!==this.constraints&&et&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(rt=>{this.constraints!==!1&&this.getAxisMotionValue(rt)&&(this.constraints[rt]=rebaseAxisConstraints(et.layoutBox[rt],this.constraints[rt]))})}resolveRefConstraints(){const{dragConstraints:$,onMeasureDragConstraints:_e}=this.getProps();if(!$||!isRefObject($))return!1;const et=$.current,{projection:tt}=this.visualElement;if(!tt||!tt.layout)return!1;const nt=measurePageBox(et,tt.root,this.visualElement.getTransformPagePoint());let rt=calcViewportConstraints(tt.layout.layoutBox,nt);if(_e){const it=_e(convertBoxToBoundingBox(rt));this.hasMutatedConstraints=!!it,it&&(rt=convertBoundingBoxToBox(it))}return rt}startAnimation($){const{drag:_e,dragMomentum:et,dragElastic:tt,dragTransition:nt,dragSnapToOrigin:rt,onDragTransitionEnd:it}=this.getProps(),st=this.constraints||{},at=eachAxis(ot=>{if(!shouldDrag(ot,_e,this.currentDirection))return;let ct=st&&st[ot]||{};rt&&(ct={min:0,max:0});const lt=tt?200:1e6,ut=tt?40:1e7,pt={type:"inertia",velocity:et?$[ot]:0,bounceStiffness:lt,bounceDamping:ut,timeConstant:750,restDelta:1,restSpeed:10,...nt,...ct};return this.startAxisValueAnimation(ot,pt)});return Promise.all(at).then(it)}startAxisValueAnimation($,_e){const et=this.getAxisMotionValue($);return addValueToWillChange(this.visualElement,$),et.start(animateMotionValue($,et,0,_e,this.visualElement,!1))}stopAnimation(){eachAxis($=>this.getAxisMotionValue($).stop())}pauseAnimation(){eachAxis($=>{var _e;return(_e=this.getAxisMotionValue($).animation)==null?void 0:_e.pause()})}getAnimationState($){var _e;return(_e=this.getAxisMotionValue($).animation)==null?void 0:_e.state}getAxisMotionValue($){const _e=`_drag${$.toUpperCase()}`,et=this.visualElement.getProps(),tt=et[_e];return tt||this.visualElement.getValue($,(et.initial?et.initial[$]:void 0)||0)}snapToCursor($){eachAxis(_e=>{const{drag:et}=this.getProps();if(!shouldDrag(_e,et,this.currentDirection))return;const{projection:tt}=this.visualElement,nt=this.getAxisMotionValue(_e);if(tt&&tt.layout){const{min:rt,max:it}=tt.layout.layoutBox[_e];nt.set($[_e]-mixNumber$1(rt,it,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:$,dragConstraints:_e}=this.getProps(),{projection:et}=this.visualElement;if(!isRefObject(_e)||!et||!this.constraints)return;this.stopAnimation();const tt={x:0,y:0};eachAxis(rt=>{const it=this.getAxisMotionValue(rt);if(it&&this.constraints!==!1){const st=it.get();tt[rt]=calcOrigin({min:st,max:st},this.constraints[rt])}});const{transformTemplate:nt}=this.visualElement.getProps();this.visualElement.current.style.transform=nt?nt({},""):"none",et.root&&et.root.updateScroll(),et.updateLayout(),this.resolveConstraints(),eachAxis(rt=>{if(!shouldDrag(rt,$,null))return;const it=this.getAxisMotionValue(rt),{min:st,max:at}=this.constraints[rt];it.set(mixNumber$1(st,at,tt[rt]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const $=this.visualElement.current,_e=addPointerEvent($,"pointerdown",st=>{const{drag:at,dragListener:ot=!0}=this.getProps();at&&ot&&this.start(st)}),et=()=>{const{dragConstraints:st}=this.getProps();isRefObject(st)&&st.current&&(this.constraints=this.resolveRefConstraints())},{projection:tt}=this.visualElement,nt=tt.addEventListener("measure",et);tt&&!tt.layout&&(tt.root&&tt.root.updateScroll(),tt.updateLayout()),frame.read(et);const rt=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),it=tt.addEventListener("didUpdate",({delta:st,hasLayoutChanged:at})=>{this.isDragging&&at&&(eachAxis(ot=>{const ct=this.getAxisMotionValue(ot);ct&&(this.originPoint[ot]+=st[ot].translate,ct.set(ct.get()+st[ot].translate))}),this.visualElement.render())});return()=>{rt(),_e(),nt(),it&&it()}}getProps(){const $=this.visualElement.getProps(),{drag:_e=!1,dragDirectionLock:et=!1,dragPropagation:tt=!1,dragConstraints:nt=!1,dragElastic:rt=defaultElastic,dragMomentum:it=!0}=$;return{...$,drag:_e,dragDirectionLock:et,dragPropagation:tt,dragConstraints:nt,dragElastic:rt,dragMomentum:it}}}function shouldDrag(j,$,_e){return($===!0||$===j)&&(_e===null||_e===j)}function getCurrentDirection(j,$=10){let _e=null;return Math.abs(j.y)>$?_e="y":Math.abs(j.x)>$&&(_e="x"),_e}class DragGesture extends Feature{constructor($){super($),this.removeGroupControls=noop$4,this.removeListeners=noop$4,this.controls=new VisualElementDragControls($)}mount(){const{dragControls:$}=this.node.getProps();$&&(this.removeGroupControls=$.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$4}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=j=>($,_e)=>{j&&frame.postRender(()=>j($,_e))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$4}onPointerDown($){this.session=new PanSession($,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:$,onPanStart:_e,onPan:et,onPanEnd:tt}=this.node.getProps();return{onSessionStart:asyncHandler($),onStart:asyncHandler(_e),onMove:et,onEnd:(nt,rt)=>{delete this.session,tt&&frame.postRender(()=>tt(nt,rt))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",$=>this.onPointerDown($))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:$,layoutGroup:_e,switchLayoutGroup:et,layoutId:tt}=this.props,{projection:nt}=$;nt&&(_e.group&&_e.group.add(nt),et&&et.register&&tt&&et.register(nt),hasTakenAnySnapshot&&nt.root.didUpdate(),nt.addEventListener("animationComplete",()=>{this.safeToRemove()}),nt.setOptions({...nt.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate($){const{layoutDependency:_e,visualElement:et,drag:tt,isPresent:nt}=this.props,{projection:rt}=et;return rt&&(rt.isPresent=nt,hasTakenAnySnapshot=!0,tt||$.layoutDependency!==_e||_e===void 0||$.isPresent!==nt?rt.willUpdate():this.safeToRemove(),$.isPresent!==nt&&(nt?rt.promote():rt.relegate()||frame.postRender(()=>{const it=rt.getStack();(!it||!it.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:$}=this.props.visualElement;$&&($.root.didUpdate(),microtask.postRender(()=>{!$.currentAnimation&&$.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:$,layoutGroup:_e,switchLayoutGroup:et}=this.props,{projection:tt}=$;hasTakenAnySnapshot=!0,tt&&(tt.scheduleCheckAfterUnmount(),_e&&_e.group&&_e.group.remove(tt),et&&et.deregister&&et.deregister(tt))}safeToRemove(){const{safeToRemove:$}=this.props;$&&$()}render(){return null}}function MeasureLayout(j){const[$,_e]=usePresence$1(),et=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...j,layoutGroup:et,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:$,safeToRemove:_e})}function animateSingleValue(j,$,_e){const et=isMotionValue(j)?j:motionValue(j);return et.start(animateMotionValue("",et,$,_e)),et.animation}const compareByDepth=(j,$)=>j.depth-$.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add($){addUniqueItem(this.children,$),this.isDirty=!0}remove($){removeItem(this.children,$),this.isDirty=!0}forEach($){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach($)}}function delay(j,$){const _e=time$1.now(),et=({timestamp:tt})=>{const nt=tt-_e;nt>=$&&(cancelFrame(et),j(nt-$))};return frame.setup(et,!0),()=>cancelFrame(et)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=j=>typeof j=="string"?parseFloat(j):j,isPx=j=>typeof j=="number"||px.test(j);function mixValues(j,$,_e,et,tt,nt){tt?(j.opacity=mixNumber$1(0,_e.opacity??1,easeCrossfadeIn(et)),j.opacityExit=mixNumber$1($.opacity??1,0,easeCrossfadeOut(et))):nt&&(j.opacity=mixNumber$1($.opacity??1,_e.opacity??1,et));for(let rt=0;rt<numBorders;rt++){const it=`border${borders[rt]}Radius`;let st=getRadius($,it),at=getRadius(_e,it);if(st===void 0&&at===void 0)continue;st||(st=0),at||(at=0),st===0||at===0||isPx(st)===isPx(at)?(j[it]=Math.max(mixNumber$1(asNumber(st),asNumber(at),et),0),(percent.test(at)||percent.test(st))&&(j[it]+="%")):j[it]=at}($.rotate||_e.rotate)&&(j.rotate=mixNumber$1($.rotate||0,_e.rotate||0,et))}function getRadius(j,$){return j[$]!==void 0?j[$]:j.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$4);function compress(j,$,_e){return et=>et<j?0:et>$?1:_e(progress(j,$,et))}function copyAxisInto(j,$){j.min=$.min,j.max=$.max}function copyBoxInto(j,$){copyAxisInto(j.x,$.x),copyAxisInto(j.y,$.y)}function copyAxisDeltaInto(j,$){j.translate=$.translate,j.scale=$.scale,j.originPoint=$.originPoint,j.origin=$.origin}function removePointDelta(j,$,_e,et,tt){return j-=$,j=scalePoint(j,1/_e,et),tt!==void 0&&(j=scalePoint(j,1/tt,et)),j}function removeAxisDelta(j,$=0,_e=1,et=.5,tt,nt=j,rt=j){if(percent.test($)&&($=parseFloat($),$=mixNumber$1(rt.min,rt.max,$/100)-rt.min),typeof $!="number")return;let it=mixNumber$1(nt.min,nt.max,et);j===nt&&(it-=$),j.min=removePointDelta(j.min,$,_e,it,tt),j.max=removePointDelta(j.max,$,_e,it,tt)}function removeAxisTransforms(j,$,[_e,et,tt],nt,rt){removeAxisDelta(j,$[_e],$[et],$[tt],$.scale,nt,rt)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(j,$,_e,et){removeAxisTransforms(j.x,$,xKeys,_e?_e.x:void 0,et?et.x:void 0),removeAxisTransforms(j.y,$,yKeys,_e?_e.y:void 0,et?et.y:void 0)}function isAxisDeltaZero(j){return j.translate===0&&j.scale===1}function isDeltaZero(j){return isAxisDeltaZero(j.x)&&isAxisDeltaZero(j.y)}function axisEquals(j,$){return j.min===$.min&&j.max===$.max}function boxEquals(j,$){return axisEquals(j.x,$.x)&&axisEquals(j.y,$.y)}function axisEqualsRounded(j,$){return Math.round(j.min)===Math.round($.min)&&Math.round(j.max)===Math.round($.max)}function boxEqualsRounded(j,$){return axisEqualsRounded(j.x,$.x)&&axisEqualsRounded(j.y,$.y)}function aspectRatio(j){return calcLength(j.x)/calcLength(j.y)}function axisDeltaEquals(j,$){return j.translate===$.translate&&j.scale===$.scale&&j.originPoint===$.originPoint}class NodeStack{constructor(){this.members=[]}add($){addUniqueItem(this.members,$),$.scheduleRender()}remove($){if(removeItem(this.members,$),$===this.prevLead&&(this.prevLead=void 0),$===this.lead){const _e=this.members[this.members.length-1];_e&&this.promote(_e)}}relegate($){const _e=this.members.findIndex(tt=>$===tt);if(_e===0)return!1;let et;for(let tt=_e;tt>=0;tt--){const nt=this.members[tt];if(nt.isPresent!==!1){et=nt;break}}return et?(this.promote(et),!0):!1}promote($,_e){const et=this.lead;if($!==et&&(this.prevLead=et,this.lead=$,$.show(),et)){et.instance&&et.scheduleRender(),$.scheduleRender(),$.resumeFrom=et,_e&&($.resumeFrom.preserveOpacity=!0),et.snapshot&&($.snapshot=et.snapshot,$.snapshot.latestValues=et.animationValues||et.latestValues),$.root&&$.root.isUpdating&&($.isLayoutDirty=!0);const{crossfade:tt}=$.options;tt===!1&&et.hide()}}exitAnimationComplete(){this.members.forEach($=>{const{options:_e,resumingFrom:et}=$;_e.onExitComplete&&_e.onExitComplete(),et&&et.options.onExitComplete&&et.options.onExitComplete()})}scheduleRender(){this.members.forEach($=>{$.instance&&$.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(j,$,_e){let et="";const tt=j.x.translate/$.x,nt=j.y.translate/$.y,rt=(_e==null?void 0:_e.z)||0;if((tt||nt||rt)&&(et=`translate3d(${tt}px, ${nt}px, ${rt}px) `),($.x!==1||$.y!==1)&&(et+=`scale(${1/$.x}, ${1/$.y}) `),_e){const{transformPerspective:at,rotate:ot,rotateX:ct,rotateY:lt,skewX:ut,skewY:pt}=_e;at&&(et=`perspective(${at}px) ${et}`),ot&&(et+=`rotate(${ot}deg) `),ct&&(et+=`rotateX(${ct}deg) `),lt&&(et+=`rotateY(${lt}deg) `),ut&&(et+=`skewX(${ut}deg) `),pt&&(et+=`skewY(${pt}deg) `)}const it=j.x.scale*$.x,st=j.y.scale*$.y;return(it!==1||st!==1)&&(et+=`scale(${it}, ${st})`),et||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(j,$,_e,et){const{latestValues:tt}=$;tt[j]&&(_e[j]=tt[j],$.setStaticValue(j,0),et&&(et[j]=0))}function cancelTreeOptimisedTransformAnimations(j){if(j.hasCheckedOptimisedAppear=!0,j.root===j)return;const{visualElement:$}=j.options;if(!$)return;const _e=getOptimisedAppearId($);if(window.MotionHasOptimisedAnimation(_e,"transform")){const{layout:tt,layoutId:nt}=j.options;window.MotionCancelOptimisedAnimation(_e,"transform",frame,!(tt||nt))}const{parent:et}=j;et&&!et.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(et)}function createProjectionNode({attachResizeListener:j,defaultParent:$,measureScroll:_e,checkIsScrollRoot:et,resetTransform:tt}){return class{constructor(rt={},it=$==null?void 0:$()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=rt,this.root=it?it.root||it:this,this.path=it?[...it.path,it]:[],this.parent=it,this.depth=it?it.depth+1:0;for(let st=0;st<this.path.length;st++)this.path[st].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(rt,it){return this.eventHandlers.has(rt)||this.eventHandlers.set(rt,new SubscriptionManager),this.eventHandlers.get(rt).add(it)}notifyListeners(rt,...it){const st=this.eventHandlers.get(rt);st&&st.notify(...it)}hasListeners(rt){return this.eventHandlers.has(rt)}mount(rt){if(this.instance)return;this.isSVG=isSVGElement(rt)&&!isSVGSVGElement(rt),this.instance=rt;const{layoutId:it,layout:st,visualElement:at}=this.options;if(at&&!at.current&&at.mount(rt),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(st||it)&&(this.isLayoutDirty=!0),j){let ot,ct=0;const lt=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{ct=window.innerWidth}),j(rt,()=>{const ut=window.innerWidth;ut!==ct&&(ct=ut,this.root.updateBlockedByResize=!0,ot&&ot(),ot=delay(lt,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}it&&this.root.registerSharedNode(it,this),this.options.animate!==!1&&at&&(it||st)&&this.addEventListener("didUpdate",({delta:ot,hasLayoutChanged:ct,hasRelativeLayoutChanged:lt,layout:ut})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const pt=this.options.transition||at.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:dt,onLayoutAnimationComplete:ht}=at.getProps(),ft=!this.targetLayout||!boxEqualsRounded(this.targetLayout,ut),mt=!ct&&lt;if(this.options.layoutRoot||this.resumeFrom||mt||ct&&(ft||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const gt={...getValueTransition(pt,"layout"),onPlay:dt,onComplete:ht};(at.shouldReduceMotion||this.options.layoutRoot)&&(gt.delay=0,gt.type=!1),this.startAnimation(gt),this.setAnimationOrigin(ot,mt)}else ct||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=ut})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const rt=this.getStack();rt&&rt.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:rt}=this.options;return rt&&rt.getProps().transformTemplate}willUpdate(rt=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let ot=0;ot<this.path.length;ot++){const ct=this.path[ot];ct.shouldResetTransform=!0,ct.updateScroll("snapshot"),ct.options.layoutRoot&&ct.willUpdate(!1)}const{layoutId:it,layout:st}=this.options;if(it===void 0&&!st)return;const at=this.getTransformTemplate();this.prevTransformTemplateValue=at?at(this.latestValues,""):void 0,this.updateSnapshot(),rt&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const it=time$1.now();frameData.delta=clamp(0,1e3/60,it-frameData.timestamp),frameData.timestamp=it,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let st=0;st<this.path.length;st++)this.path[st].updateScroll();const rt=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:it}=this.options;it&&it.notify("LayoutMeasure",this.layout.layoutBox,rt?rt.layoutBox:void 0)}updateScroll(rt="measure"){let it=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===rt&&(it=!1),it&&this.instance){const st=et(this.instance);this.scroll={animationId:this.root.animationId,phase:rt,isRoot:st,offset:_e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:st}}}resetTransform(){if(!tt)return;const rt=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,it=this.projectionDelta&&!isDeltaZero(this.projectionDelta),st=this.getTransformTemplate(),at=st?st(this.latestValues,""):void 0,ot=at!==this.prevTransformTemplateValue;rt&&this.instance&&(it||hasTransform(this.latestValues)||ot)&&(tt(this.instance,at),this.shouldResetTransform=!1,this.scheduleRender())}measure(rt=!0){const it=this.measurePageBox();let st=this.removeElementScroll(it);return rt&&(st=this.removeTransform(st)),roundBox(st),{animationId:this.root.animationId,measuredBox:it,layoutBox:st,latestValues:{},source:this.id}}measurePageBox(){var at;const{visualElement:rt}=this.options;if(!rt)return createBox();const it=rt.measureViewportBox();if(!(((at=this.scroll)==null?void 0:at.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:ot}=this.root;ot&&(translateAxis(it.x,ot.offset.x),translateAxis(it.y,ot.offset.y))}return it}removeElementScroll(rt){var st;const it=createBox();if(copyBoxInto(it,rt),(st=this.scroll)!=null&&st.wasRoot)return it;for(let at=0;at<this.path.length;at++){const ot=this.path[at],{scroll:ct,options:lt}=ot;ot!==this.root&&ct&&lt.layoutScroll&&(ct.wasRoot&&copyBoxInto(it,rt),translateAxis(it.x,ct.offset.x),translateAxis(it.y,ct.offset.y))}return it}applyTransform(rt,it=!1){const st=createBox();copyBoxInto(st,rt);for(let at=0;at<this.path.length;at++){const ot=this.path[at];!it&&ot.options.layoutScroll&&ot.scroll&&ot!==ot.root&&transformBox(st,{x:-ot.scroll.offset.x,y:-ot.scroll.offset.y}),hasTransform(ot.latestValues)&&transformBox(st,ot.latestValues)}return hasTransform(this.latestValues)&&transformBox(st,this.latestValues),st}removeTransform(rt){const it=createBox();copyBoxInto(it,rt);for(let st=0;st<this.path.length;st++){const at=this.path[st];if(!at.instance||!hasTransform(at.latestValues))continue;hasScale(at.latestValues)&&at.updateSnapshot();const ot=createBox(),ct=at.measurePageBox();copyBoxInto(ot,ct),removeBoxTransforms(it,at.latestValues,at.snapshot?at.snapshot.layoutBox:void 0,ot)}return hasTransform(this.latestValues)&&removeBoxTransforms(it,this.latestValues),it}setTargetDelta(rt){this.targetDelta=rt,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(rt){this.options={...this.options,...rt,crossfade:rt.crossfade!==void 0?rt.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(rt=!1){var ut;const it=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=it.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=it.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=it.isSharedProjectionDirty);const st=!!this.resumingFrom||this!==it;if(!(rt||st&&this.isSharedProjectionDirty||this.isProjectionDirty||(ut=this.parent)!=null&&ut.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:ot,layoutId:ct}=this.options;if(!this.layout||!(ot||ct))return;this.resolvedRelativeTargetAt=frameData.timestamp;const lt=this.getClosestProjectingParent();lt&&this.linkedParentVersion!==lt.layoutVersion&&!lt.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(lt&&lt.layout?this.createRelativeTarget(lt,this.layout.layoutBox,lt.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,lt&&!!lt.resumingFrom==!!this.resumingFrom&&!lt.options.layoutScroll&&lt.target&&this.animationProgress!==1?this.createRelativeTarget(lt,this.target,lt.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(rt,it,st){this.relativeParent=rt,this.linkedParentVersion=rt.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,it,st),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var pt;const rt=this.getLead(),it=!!this.resumingFrom||this!==rt;let st=!0;if((this.isProjectionDirty||(pt=this.parent)!=null&&pt.isProjectionDirty)&&(st=!1),it&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(st=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(st=!1),st)return;const{layout:at,layoutId:ot}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(at||ot))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const ct=this.treeScale.x,lt=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,it),rt.layout&&!rt.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(rt.target=rt.layout.layoutBox,rt.targetWithTransforms=createBox());const{target:ut}=rt;if(!ut){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,ut,this.latestValues),(this.treeScale.x!==ct||this.treeScale.y!==lt||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ut))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(rt=!0){var it;if((it=this.options.visualElement)==null||it.scheduleRender(),rt){const st=this.getStack();st&&st.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(rt,it=!1){const st=this.snapshot,at=st?st.latestValues:{},ot={...this.latestValues},ct=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!it;const lt=createBox(),ut=st?st.source:void 0,pt=this.layout?this.layout.source:void 0,dt=ut!==pt,ht=this.getStack(),ft=!ht||ht.members.length<=1,mt=!!(dt&&!ft&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let gt;this.mixTargetDelta=yt=>{const vt=yt/1e3;mixAxisDelta(ct.x,rt.x,vt),mixAxisDelta(ct.y,rt.y,vt),this.setTargetDelta(ct),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(lt,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,lt,vt),gt&&boxEquals(this.relativeTarget,gt)&&(this.isProjectionDirty=!1),gt||(gt=createBox()),copyBoxInto(gt,this.relativeTarget)),dt&&(this.animationValues=ot,mixValues(ot,at,this.latestValues,vt,mt,ft)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=vt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(rt){var it,st,at;this.notifyListeners("animationStart"),(it=this.currentAnimation)==null||it.stop(),(at=(st=this.resumingFrom)==null?void 0:st.currentAnimation)==null||at.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...rt,velocity:0,isSync:!0,onUpdate:ot=>{this.mixTargetDelta(ot),rt.onUpdate&&rt.onUpdate(ot)},onStop:()=>{},onComplete:()=>{rt.onComplete&&rt.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const rt=this.getStack();rt&&rt.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const rt=this.getLead();let{targetWithTransforms:it,target:st,layout:at,latestValues:ot}=rt;if(!(!it||!st||!at)){if(this!==rt&&this.layout&&at&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,at.layoutBox)){st=this.target||createBox();const ct=calcLength(this.layout.layoutBox.x);st.x.min=rt.target.x.min,st.x.max=st.x.min+ct;const lt=calcLength(this.layout.layoutBox.y);st.y.min=rt.target.y.min,st.y.max=st.y.min+lt}copyBoxInto(it,st),transformBox(it,ot),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,it,ot)}}registerSharedNode(rt,it){this.sharedNodes.has(rt)||this.sharedNodes.set(rt,new NodeStack),this.sharedNodes.get(rt).add(it);const at=it.options.initialPromotionConfig;it.promote({transition:at?at.transition:void 0,preserveFollowOpacity:at&&at.shouldPreserveFollowOpacity?at.shouldPreserveFollowOpacity(it):void 0})}isLead(){const rt=this.getStack();return rt?rt.lead===this:!0}getLead(){var it;const{layoutId:rt}=this.options;return rt?((it=this.getStack())==null?void 0:it.lead)||this:this}getPrevLead(){var it;const{layoutId:rt}=this.options;return rt?(it=this.getStack())==null?void 0:it.prevLead:void 0}getStack(){const{layoutId:rt}=this.options;if(rt)return this.root.sharedNodes.get(rt)}promote({needsReset:rt,transition:it,preserveFollowOpacity:st}={}){const at=this.getStack();at&&at.promote(this,st),rt&&(this.projectionDelta=void 0,this.needsReset=!0),it&&this.setOptions({transition:it})}relegate(){const rt=this.getStack();return rt?rt.relegate(this):!1}resetSkewAndRotation(){const{visualElement:rt}=this.options;if(!rt)return;let it=!1;const{latestValues:st}=rt;if((st.z||st.rotate||st.rotateX||st.rotateY||st.rotateZ||st.skewX||st.skewY)&&(it=!0),!it)return;const at={};st.z&&resetDistortingTransform("z",rt,at,this.animationValues);for(let ot=0;ot<transformAxes.length;ot++)resetDistortingTransform(`rotate${transformAxes[ot]}`,rt,at,this.animationValues),resetDistortingTransform(`skew${transformAxes[ot]}`,rt,at,this.animationValues);rt.render();for(const ot in at)rt.setStaticValue(ot,at[ot]),this.animationValues&&(this.animationValues[ot]=at[ot]);rt.scheduleRender()}applyProjectionStyles(rt,it){if(!this.instance||this.isSVG)return;if(!this.isVisible){rt.visibility="hidden";return}const st=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,rt.visibility="",rt.opacity="",rt.pointerEvents=resolveMotionValue(it==null?void 0:it.pointerEvents)||"",rt.transform=st?st(this.latestValues,""):"none";return}const at=this.getLead();if(!this.projectionDelta||!this.layout||!at.target){this.options.layoutId&&(rt.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,rt.pointerEvents=resolveMotionValue(it==null?void 0:it.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(rt.transform=st?st({},""):"none",this.hasProjected=!1);return}rt.visibility="";const ot=at.animationValues||at.latestValues;this.applyTransformsToTarget();let ct=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,ot);st&&(ct=st(ot,ct)),rt.transform=ct;const{x:lt,y:ut}=this.projectionDelta;rt.transformOrigin=`${lt.origin*100}% ${ut.origin*100}% 0`,at.animationValues?rt.opacity=at===this?ot.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:ot.opacityExit:rt.opacity=at===this?ot.opacity!==void 0?ot.opacity:"":ot.opacityExit!==void 0?ot.opacityExit:0;for(const pt in scaleCorrectors){if(ot[pt]===void 0)continue;const{correct:dt,applyTo:ht,isCSSVariable:ft}=scaleCorrectors[pt],mt=ct==="none"?ot[pt]:dt(ot[pt],at);if(ht){const gt=ht.length;for(let yt=0;yt<gt;yt++)rt[ht[yt]]=mt}else ft?this.options.visualElement.renderState.vars[pt]=mt:rt[pt]=mt}this.options.layoutId&&(rt.pointerEvents=at===this?resolveMotionValue(it==null?void 0:it.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(rt=>{var it;return(it=rt.currentAnimation)==null?void 0:it.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(j){j.updateLayout()}function notifyLayoutUpdate(j){var _e;const $=((_e=j.resumeFrom)==null?void 0:_e.snapshot)||j.snapshot;if(j.isLead()&&j.layout&&$&&j.hasListeners("didUpdate")){const{layoutBox:et,measuredBox:tt}=j.layout,{animationType:nt}=j.options,rt=$.source!==j.layout.source;nt==="size"?eachAxis(ct=>{const lt=rt?$.measuredBox[ct]:$.layoutBox[ct],ut=calcLength(lt);lt.min=et[ct].min,lt.max=lt.min+ut}):shouldAnimatePositionOnly(nt,$.layoutBox,et)&&eachAxis(ct=>{const lt=rt?$.measuredBox[ct]:$.layoutBox[ct],ut=calcLength(et[ct]);lt.max=lt.min+ut,j.relativeTarget&&!j.currentAnimation&&(j.isProjectionDirty=!0,j.relativeTarget[ct].max=j.relativeTarget[ct].min+ut)});const it=createDelta();calcBoxDelta(it,et,$.layoutBox);const st=createDelta();rt?calcBoxDelta(st,j.applyTransform(tt,!0),$.measuredBox):calcBoxDelta(st,et,$.layoutBox);const at=!isDeltaZero(it);let ot=!1;if(!j.resumeFrom){const ct=j.getClosestProjectingParent();if(ct&&!ct.resumeFrom){const{snapshot:lt,layout:ut}=ct;if(lt&&ut){const pt=createBox();calcRelativePosition(pt,$.layoutBox,lt.layoutBox);const dt=createBox();calcRelativePosition(dt,et,ut.layoutBox),boxEqualsRounded(pt,dt)||(ot=!0),ct.options.layoutRoot&&(j.relativeTarget=dt,j.relativeTargetOrigin=pt,j.relativeParent=ct)}}}j.notifyListeners("didUpdate",{layout:et,snapshot:$,delta:st,layoutDelta:it,hasLayoutChanged:at,hasRelativeLayoutChanged:ot})}else if(j.isLead()){const{onExitComplete:et}=j.options;et&&et()}j.options.transition=void 0}function propagateDirtyNodes(j){j.parent&&(j.isProjecting()||(j.isProjectionDirty=j.parent.isProjectionDirty),j.isSharedProjectionDirty||(j.isSharedProjectionDirty=!!(j.isProjectionDirty||j.parent.isProjectionDirty||j.parent.isSharedProjectionDirty)),j.isTransformDirty||(j.isTransformDirty=j.parent.isTransformDirty))}function cleanDirtyNodes(j){j.isProjectionDirty=j.isSharedProjectionDirty=j.isTransformDirty=!1}function clearSnapshot(j){j.clearSnapshot()}function clearMeasurements(j){j.clearMeasurements()}function clearIsLayoutDirty(j){j.isLayoutDirty=!1}function resetTransformStyle(j){const{visualElement:$}=j.options;$&&$.getProps().onBeforeLayoutMeasure&&$.notify("BeforeLayoutMeasure"),j.resetTransform()}function finishAnimation(j){j.finishAnimation(),j.targetDelta=j.relativeTarget=j.target=void 0,j.isProjectionDirty=!0}function resolveTargetDelta(j){j.resolveTargetDelta()}function calcProjection(j){j.calcProjection()}function resetSkewAndRotation(j){j.resetSkewAndRotation()}function removeLeadSnapshots(j){j.removeLeadSnapshot()}function mixAxisDelta(j,$,_e){j.translate=mixNumber$1($.translate,0,_e),j.scale=mixNumber$1($.scale,1,_e),j.origin=$.origin,j.originPoint=$.originPoint}function mixAxis(j,$,_e,et){j.min=mixNumber$1($.min,_e.min,et),j.max=mixNumber$1($.max,_e.max,et)}function mixBox(j,$,_e,et){mixAxis(j.x,$.x,_e.x,et),mixAxis(j.y,$.y,_e.y,et)}function hasOpacityCrossfade(j){return j.animationValues&&j.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=j=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(j),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$4;function roundAxis(j){j.min=roundPoint(j.min),j.max=roundPoint(j.max)}function roundBox(j){roundAxis(j.x),roundAxis(j.y)}function shouldAnimatePositionOnly(j,$,_e){return j==="position"||j==="preserve-aspect"&&!isNear(aspectRatio($),aspectRatio(_e),.2)}function checkNodeWasScrollRoot(j){var $;return j!==j.root&&(($=j.scroll)==null?void 0:$.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(j,$)=>addDomEvent(j,"resize",$),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:j=>({x:j.scrollLeft,y:j.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const j=new DocumentProjectionNode({});j.mount(window),j.setOptions({layoutScroll:!0}),rootProjectionNode.current=j}return rootProjectionNode.current},resetTransform:(j,$)=>{j.style.transform=$!==void 0?$:"none"},checkIsScrollRoot:j=>window.getComputedStyle(j).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(j,$,_e){const{props:et}=j;j.animationState&&et.whileHover&&j.animationState.setActive("whileHover",_e==="Start");const tt="onHover"+_e,nt=et[tt];nt&&frame.postRender(()=>nt($,extractEventInfo($)))}class HoverGesture extends Feature{mount(){const{current:$}=this.node;$&&(this.unmount=hover($,(_e,et)=>(handleHoverEvent(this.node,et,"Start"),tt=>handleHoverEvent(this.node,tt,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let $=!1;try{$=this.node.current.matches(":focus-visible")}catch{$=!0}!$||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(j,$,_e){const{props:et}=j;if(j.current instanceof HTMLButtonElement&&j.current.disabled)return;j.animationState&&et.whileTap&&j.animationState.setActive("whileTap",_e==="Start");const tt="onTap"+(_e==="End"?"":_e),nt=et[tt];nt&&frame.postRender(()=>nt($,extractEventInfo($)))}class PressGesture extends Feature{mount(){const{current:$}=this.node;$&&(this.unmount=press($,(_e,et)=>(handlePressEvent(this.node,et,"Start"),(tt,{success:nt})=>handlePressEvent(this.node,tt,nt?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=j=>{const $=observerCallbacks.get(j.target);$&&$(j)},fireAllObserverCallbacks=j=>{j.forEach(fireObserverCallback)};function initIntersectionObserver({root:j,...$}){const _e=j||document;observers.has(_e)||observers.set(_e,{});const et=observers.get(_e),tt=JSON.stringify($);return et[tt]||(et[tt]=new IntersectionObserver(fireAllObserverCallbacks,{root:j,...$})),et[tt]}function observeIntersection(j,$,_e){const et=initIntersectionObserver($);return observerCallbacks.set(j,_e),et.observe(j),()=>{observerCallbacks.delete(j),et.unobserve(j)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:$={}}=this.node.getProps(),{root:_e,margin:et,amount:tt="some",once:nt}=$,rt={root:_e?_e.current:void 0,rootMargin:et,threshold:typeof tt=="number"?tt:thresholdNames[tt]},it=st=>{const{isIntersecting:at}=st;if(this.isInView===at||(this.isInView=at,nt&&!at&&this.hasEnteredView))return;at&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",at);const{onViewportEnter:ot,onViewportLeave:ct}=this.node.getProps(),lt=at?ot:ct;lt&&lt(st)};return observeIntersection(this.node.current,rt,it)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:$,prevProps:_e}=this.node;["amount","margin","root"].some(hasViewportOptionChanged($,_e))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:j={}},{viewport:$={}}={}){return _e=>j[_e]!==$[_e]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement),loadingStages=[{id:"connecting",message:"Connecting to AI",subMessage:"Establishing secure connection...",icon:jsxRuntimeExports.jsx(Sparkles,{className:"w-6 h-6"}),duration:3e3},{id:"preparing",message:"Preparing Your Practice Partner",subMessage:"Loading avatar and voice systems...",icon:jsxRuntimeExports.jsx(MessageCircle,{className:"w-6 h-6"}),duration:8e3},{id:"finalizing",message:"Almost Ready",subMessage:"Setting up your practice session...",icon:jsxRuntimeExports.jsx(Mic,{className:"w-6 h-6"}),duration:6e3},{id:"ready",message:"Ready to Begin",subMessage:"Your AI practice partner is here!",icon:jsxRuntimeExports.jsx(CheckCircle,{className:"w-6 h-6"}),duration:1e3}];function AvatarLoadingOverlay({isLoading:j,status:$,avatarName:_e,onCancel:et}){const[tt,nt]=reactExports.useState(0),[rt,it]=reactExports.useState(0);reactExports.useEffect(()=>{if(!j){nt(0),it(0);return}let at=0;const ot=setInterval(()=>{at+=100;let ct=0,lt=0;for(let dt=0;dt<loadingStages.length;dt++){if(ct+=loadingStages[dt].duration,at<ct){lt=dt;break}lt=dt}nt(lt);const ut=loadingStages.reduce((dt,ht)=>dt+ht.duration,0),pt=Math.min(at/ut*100,95);it(pt)},100);return()=>clearInterval(ot)},[j]);const st=loadingStages[tt];return jsxRuntimeExports.jsx(AnimatePresence,{children:j&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900","data-testid":"avatar-loading-overlay",children:[jsxRuntimeExports.jsxs("div",{className:"text-center max-w-md px-6",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[jsxRuntimeExports.jsx(motion.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"absolute inset-0 rounded-full border-4 border-transparent border-t-[#04aac4] border-r-[#04aac4]/30"}),jsxRuntimeExports.jsx(motion.div,{animate:{rotate:-360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute inset-2 rounded-full border-4 border-transparent border-b-[#fa6793] border-l-[#fa6793]/30"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:jsxRuntimeExports.jsx(motion.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},className:"text-white",children:st.icon},st.id)})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:_e?`Meeting ${_e}`:"Starting Session"}),jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:jsxRuntimeExports.jsxs(motion.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.3},className:"space-y-1",children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-medium text-[#04aac4]",children:st.message}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-400",children:st.subMessage})]},st.id)})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-xs mx-auto mb-6",children:[jsxRuntimeExports.jsx("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{className:"h-full bg-gradient-to-r from-[#04aac4] to-[#fa6793] rounded-full",initial:{width:0},animate:{width:`${rt}%`},transition:{duration:.3}})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("span",{children:"Initializing"}),jsxRuntimeExports.jsxs("span",{children:[Math.round(rt),"%"]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center gap-2 mb-6",children:loadingStages.slice(0,-1).map((at,ot)=>jsxRuntimeExports.jsx(motion.div,{className:`w-2 h-2 rounded-full ${ot<=tt?"bg-[#04aac4]":"bg-slate-600"}`,animate:{scale:ot===tt?[1,1.3,1]:1},transition:{duration:1,repeat:ot===tt?1/0:0}},at.id))}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-400 text-sm",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-4 h-4 animate-spin"}),jsxRuntimeExports.jsx("span",{children:"This may take up to 30 seconds"})]}),et&&jsxRuntimeExports.jsx("button",{onClick:et,className:"text-sm text-slate-500 hover:text-slate-300 transition-colors underline","data-testid":"button-cancel-loading",children:"Cancel and return to practice"})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:.6},transition:{delay:1},className:"mt-8 flex justify-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),jsxRuntimeExports.jsx("span",{children:"AI Ready"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 rounded-full bg-[#04aac4] animate-pulse"}),jsxRuntimeExports.jsx("span",{children:"Secure Connection"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-8 left-0 right-0 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-600",children:"Powered by A3cend AI Practice"})})]})})}function SessionTimer({sessionId:j,heygenSessionId:$,maxDurationSec:_e=360,onExpired:et,onWarning:tt,className:nt}){const[rt,it]=reactExports.useState(_e),[st,at]=reactExports.useState(!1),[ot,ct]=reactExports.useState(!1),lt=reactExports.useRef(null),ut=reactExports.useRef(null),pt=reactExports.useRef(!1),dt=reactExports.useRef(!1),ht=yt=>{const vt=Math.floor(yt/60),xt=yt%60;return`${vt}:${xt.toString().padStart(2,"0")}`},ft=reactExports.useCallback(async()=>{if(!(!j&&!$))try{const yt=new URLSearchParams;j?yt.set("sessionId",j.toString()):$&&yt.set("heygenSessionId",$);const vt=await fetch(`/api/avatar/session/status?${yt}`);if(!vt.ok)return;const xt=await vt.json();xt.success&&xt.session&&(it(xt.session.remainingSec),xt.session.isExpired&&!pt.current&&(pt.current=!0,ct(!0),et==null||et()))}catch(yt){console.error("Failed to fetch session status:",yt)}},[j,$,et]),mt=reactExports.useCallback(async()=>{if(!(!j&&!$))try{const yt=await fetch("/api/avatar/session/heartbeat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:j,heygenSessionId:$})});if(!yt.ok)return;const vt=await yt.json();vt.success&&(vt.expired||vt.shouldEnd?pt.current||(pt.current=!0,ct(!0),et==null||et()):(it(vt.remainingSec),vt.warningActive&&!dt.current&&(dt.current=!0,at(!0),tt==null||tt(vt.remainingSec))))}catch(yt){console.error("Heartbeat failed:",yt)}},[j,$,et,tt]);reactExports.useEffect(()=>(ft(),lt.current=setInterval(mt,5e3),ut.current=setInterval(()=>{it(yt=>{const vt=Math.max(0,yt-1);return vt<=60&&!dt.current&&(dt.current=!0,at(!0),tt==null||tt(vt)),vt===0&&!pt.current&&(pt.current=!0,ct(!0),et==null||et()),vt})},1e3),()=>{lt.current&&clearInterval(lt.current),ut.current&&clearInterval(ut.current)}),[ft,mt,et,tt]);const gt=rt/_e*100;return jsxRuntimeExports.jsxs("div",{className:cn("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-300",ot?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":st?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 animate-pulse":"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300",nt),"data-testid":"session-timer",children:[st?jsxRuntimeExports.jsx(AlertTriangle,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(Clock,{className:"h-4 w-4"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{"data-testid":"timer-display",children:ht(rt)}),jsxRuntimeExports.jsx("div",{className:"w-16 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden","data-testid":"timer-progress",children:jsxRuntimeExports.jsx("div",{className:cn("h-full transition-all duration-1000 rounded-full",ot?"bg-red-500":st?"bg-amber-500":"bg-green-500"),style:{width:`${gt}%`}})})]}),st&&!ot&&jsxRuntimeExports.jsx("span",{className:"text-xs","data-testid":"timer-warning",children:"Session ending soon!"}),ot&&jsxRuntimeExports.jsx("span",{className:"text-xs font-semibold","data-testid":"timer-expired",children:"Time's up!"})]})}const languageNames$1={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",zh:"Mandarin",ja:"Japanese",ko:"Korean",hi:"Hindi",ar:"Arabic",ru:"Russian",nl:"Dutch",pl:"Polish",tr:"Turkish"};function generateUniqueId(j="tr"){const $=Date.now().toString(36),_e=Math.random().toString(36).substring(2,8);return`${j}_${$}_${_e}`}function getLanguageCode(j){return{en:"en-US",es:"es-ES",fr:"fr-FR",de:"de-DE",it:"it-IT",pt:"pt-PT",zh:"zh-CN",ja:"ja-JP",ko:"ko-KR",hi:"hi-IN",ar:"ar-SA",ru:"ru-RU",nl:"nl-NL",pl:"pl-PL",tr:"tr-TR"}[j]||"en-US"}const defaultSessionId=`unknown-${crypto.randomUUID().replaceAll("-","")}`;function InteractiveAvatar({initialAvatarId:j,initialKnowledgeId:$,scenario:_e}){const[et,tt]=reactExports.useState(!1),[nt,rt]=reactExports.useState(!1),[it,st]=reactExports.useState(),[at,ot]=reactExports.useState("not_started"),[ct,lt]=reactExports.useState(!1),[ut,pt]=reactExports.useState(),[dt,ht]=reactExports.useState("");useRouter();const[ft,mt]=reactExports.useState($),[gt,yt]=reactExports.useState(j),[vt,xt]=reactExports.useState(),[St,Et]=reactExports.useState(""),wt=reactExports.useRef(null),Tt=reactExports.useRef(null),[Ct,Rt]=reactExports.useState("voice_mode"),[jt,Ot]=reactExports.useState(!1),[$t,Kt]=reactExports.useState(!1),[Lt,Nt]=reactExports.useState(null),[Bt,kt]=reactExports.useState(null),[rn,Gt]=reactExports.useState(!1),[_t,sn]=reactExports.useState(null),tn=reactExports.useRef(null),on=reactExports.useRef(!1),{user:It}=useAuth(),Zt=useAvatarSession(),[Ut]=useSearchParams(),Xt=Ut.get("language")||"en",[Ht,Pt]=reactExports.useState(Xt),[Mt,Vt]=reactExports.useState([]),qt=reactExports.useRef([]),[en,fn]=reactExports.useState(null),Cn=useNavigate(),[En,Pn]=reactExports.useState(""),[Rn,Gn]=reactExports.useState(""),xn=reactExports.useRef(!1),_n=reactExports.useRef(null),[Zn,Ft]=reactExports.useState(!1),At=reactExports.useRef(!1),Jt=reactExports.useRef(null),vn=reactExports.useRef(null),bn=reactExports.useRef(null),$n=reactExports.useRef(null),Yn=reactExports.useRef(null),er=reactExports.useRef(Date.now()),{data:gr,isLoading:Dr}=useAvatarById(j);reactExports.useEffect(()=>{const Qt=async()=>{const nn=_n.current||(vt==null?void 0:vt.session_id);if(!(!nn||at!=="started"))try{const gn=await fetch("/api/avatar/keep-alive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:nn})});gn.ok?(console.log("Keep-alive sent successfully"),er.current=Date.now()):console.warn("Keep-alive failed:",await gn.text())}catch(gn){console.error("Keep-alive error:",gn)}};return at==="started"&&(_n.current||vt!=null&&vt.session_id)&&(Yn.current=setInterval(Qt,3e4),console.log("Started keep-alive heartbeat")),()=>{Yn.current&&(clearInterval(Yn.current),Yn.current=null,console.log("Stopped keep-alive heartbeat"))}},[at,vt==null?void 0:vt.session_id]),reactExports.useEffect(()=>{const Qt=()=>{if(document.hidden)console.log("Tab hidden - session may timeout if inactive too long");else{console.log("Tab visible - resuming activity tracking"),er.current=Date.now();const nn=_n.current||(vt==null?void 0:vt.session_id);nn&&at==="started"&&fetch("/api/avatar/keep-alive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:nn})}).catch(console.error)}};return document.addEventListener("visibilitychange",Qt),()=>{document.removeEventListener("visibilitychange",Qt)}},[at,vt==null?void 0:vt.session_id]);const Xn=async Qt=>{try{const nn=Ut.get("scenarioId"),gn=await fetch("/api/avatar/session/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({heygenSessionId:Qt,scenarioId:nn,avatarId:gt,mode:Ct})});if(gn.ok){const un=await gn.json();if(un.success&&un.session)return kt(un.session.id),console.log(`[Session Tracking] Started tracked session ${un.session.id}, expires at ${un.session.expiresAt}`),un.session}else console.warn("Failed to start tracked session:",await gn.text())}catch(nn){console.error("Error starting tracked session:",nn)}return null},br=async(Qt="user_ended")=>{if(Bt)try{const nn=_n.current||(vt==null?void 0:vt.session_id);await fetch("/api/avatar/session/end",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:Bt,heygenSessionId:nn,reason:Qt})}),console.log(`[Session Tracking] Ended tracked session ${Bt}, reason: ${Qt}`)}catch(nn){console.error("Error ending tracked session:",nn)}},hr=async()=>{console.log("[Session Tracking] Session time limit reached, ending session..."),await $o()},au=Qt=>{Gt(!0),console.log(`[Session Tracking] Session ending in ${Qt} seconds`)};reactExports.useEffect(()=>{let Qt=!0;const gn=setTimeout(async()=>{if(!(!Qt||At.current||Zn))try{At.current=!0,Ft(!0),await Ko()}catch(un){console.error("Failed to auto-start session:",un),At.current=!1,Ft(!1)}},200);return()=>{Qt=!1,clearTimeout(gn)}},[]);const Wo=(Qt=null)=>{const gn=(Qt||qt.current).filter(un=>!un.text.includes("Interrupt task")&&!un.text.includes("End session & Save")&&!un.text.includes("View Transcript")&&!un.text.includes("Clear"));Qt||(Vt(gn),qt.current=gn);try{const mn=JSON.parse(localStorage.getItem("transcript")||"[]").filter(Tn=>!Tn.text.includes("Interrupt task")&&!Tn.text.includes("End session & Save")&&!Tn.text.includes("View Transcript")&&!Tn.text.includes("Clear"));localStorage.setItem("transcript",JSON.stringify(mn))}catch(un){console.log(`Error cleaning localStorage transcript: ${un.message}`)}return gn},$o=async()=>{if(console.log({sessionStatus:at,isSessionEnding:ct}),ct){console.log("Session already ending");return}try{ht("Ending session and saving transcript..."),ot("ended"),lt(!0),console.log("Starting endSession..."),on.current=!1,tn.current&&(clearTimeout(tn.current),tn.current=null),await br("user_ended");const Qt=Wo();console.log(`Cleaned transcript length: ${Qt.length}`);const nn=_n.current||(vt==null?void 0:vt.session_id);if(console.log(`Current transcript length: ${Qt.length}`),console.log(`Session ID: ${nn}`),console.log(`Avatar ID: ${gt}`),console.log(`Knowledge ID: ${ft}`),nn){const un={sessionId:nn,avatarId:gt,knowledgeId:ft,startTime:$n.current?new Date($n.current).toISOString():new Date().toISOString(),endTime:new Date().toISOString(),duration:$n.current?Math.floor((Date.now()-$n.current)/1e3):null,userId:(It==null?void 0:It.id)||1};console.log(`Saving streaming session with data: ${JSON.stringify(un)}`);try{const mn=await fetch("/api/avatar/save-streaming-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(un)}),Tn=await mn.text();if(console.log(`Raw session response: ${Tn}`),!mn.ok)console.log(`Failed to save streaming session: ${mn.status} - ${mn.statusText}`),console.log(`Response body: ${Tn}`);else try{const Fn=JSON.parse(Tn);console.log(`Successfully saved streaming session: ${JSON.stringify(Fn)}`)}catch(Fn){console.log(`Error parsing session response: ${Fn.message}`)}}catch(mn){console.log(`Error saving session: ${mn.message}`),console.log(`Error stack: ${mn.stack}`)}}if(Tt.current)try{await Tt.current.stopAvatar(),console.log("Avatar stopped successfully")}catch(un){console.error("Error stopping avatar:",un),console.log(`Error stopping avatar: ${un.message}`)}if(Jt.current)try{Jt.current.stop(),console.log("Speech recognition stopped")}catch(un){console.error("Error stopping speech recognition:",un),console.log(`Error stopping speech recognition: ${un.message}`)}if(vn.current)try{typeof vn.current.cleanup=="function"?vn.current.cleanup():typeof vn.current.disconnect=="function"?vn.current.disconnect():console.log("Observer doesn't have disconnect or cleanup method"),console.log("Mutation observer stopped")}catch(un){console.error("Error cleaning up observer:",un),console.log(`Error cleaning up observer: ${un.message}`)}if(bn.current)try{bn.current.cleanup(),console.log("Audio analyzer cleaned up")}catch(un){console.error("Error cleaning up audio analyzer:",un),console.log(`Error cleaning up audio analyzer: ${un.message}`)}!Qt.some(un=>un.speaker==="Avatar"&&(un.text.includes("Thank you for your time")||un.text.includes("Session ended")))&&at==="ended"&&(lr("Avatar","Session ended. Thank you for your time."),console.log("Added closing message to transcript"));try{console.log("Starting transcript save process...");const un=await ou();if(un){if(console.log(`Transcript saved successfully with ID: ${un}`),ht("Transcript saved successfully! Redirecting..."),Nt(un),localStorage.setItem("last_transcript_id",un),console.log(`Saved transcript ID: ${un}`),nn&&un)try{console.log(`Linking transcript ${un} to session ${nn}`),(await fetch("/api/avatar/save-streaming-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:nn,avatarId:gt,knowledgeId:ft,transcriptId:un})})).ok&&console.log("Successfully linked transcript to session")}catch(Un){console.log(`Error linking transcript to session: ${Un.message}`)}console.log(`Redirecting to session results with ID: ${un}`),ht("Redirecting to results page..."),localStorage.setItem("last_transcript_id",un);const mn=Ut.get("skill"),Tn=Ut.get("scenarioId"),Fn=Ut.get("blueprint"),kn=new URL("/avatar/session-analysis",window.location.origin);kn.searchParams.set("sid",nn),kn.searchParams.set("tid",un),kn.searchParams.set("type","streaming_avatar"),mn&&kn.searchParams.set("skill",mn),Tn&&kn.searchParams.set("scenario",Tn),Fn&&kn.searchParams.set("blueprint",Fn),Cn(kn.pathname+kn.search),st(void 0)}else throw new Error("No transcript ID returned from save function")}catch(un){console.log(`All save attempts failed: ${un.message}`),ht("Transcript save failed. Session ended.");try{localStorage.setItem("finalTranscript",JSON.stringify(qt.current)),console.log("Created backup in localStorage")}catch(mn){console.log(`Error creating localStorage backup: ${mn.message}`)}}st(void 0),console.log("Session ended completely")}catch(Qt){console.log(`Error in endSession: ${Qt.message}`)}finally{setTimeout(()=>lt(!1),3e3)}},ou=async()=>{if(xn.current)return console.log("Save already in progress, skipping duplicate call"),null;const Qt=_n.current||(vt==null?void 0:vt.session_id)||defaultSessionId;try{xn.current=!0,console.log("Starting transcript save process..."),console.log(`Current session ID: ${Qt}`);const nn=qt.current;console.log(`Current transcript length: ${nn.length}`);const gn=Wo(nn);if(gn.length===0)return console.log("Empty transcript, nothing to save"),null;ht("Saving transcript to database..."),console.log("Preparing transcript data for save...");const un=$n.current;let mn=null;un&&(mn=Math.floor((Date.now()-un)/1e3),console.log(`Session duration: ${mn} seconds`));const Tn=generateUniqueId("tr");console.log(`Using transcript ID: ${Tn}`);const Fn=Ut.get("skill"),kn=Ut.get("scenarioId"),Un=Ut.get("customScenarioId"),qn={transcriptId:Tn,sessionId:Qt,avatarId:gt,knowledgeId:ft,context:(_e==null?void 0:_e.context)||"",instructions:(_e==null?void 0:_e.instructions)||"",description:(_e==null?void 0:_e.description)||"",scenario:"",skill:"",messages:gn.map(dn=>({speaker:dn.speaker,text:dn.text,timestamp:dn.timestamp})),duration:mn,userId:(It==null?void 0:It.id)||1,skillId:Fn?parseInt(Fn):null,scenarioId:kn?parseInt(kn):null,customScenarioId:Un?parseInt(Un):null};console.log(`Saving transcript with ${gn.length} messages for session: ${qn.sessionId}`);try{localStorage.setItem("pendingTranscript",JSON.stringify(qn)),console.log("Created local backup of transcript before saving to server")}catch(dn){console.log(`Warning: Could not create local backup: ${dn.message}`)}const Bn=new AbortController,wn=setTimeout(()=>Bn.abort(),1e4);console.log(`Sending transcript data: ${JSON.stringify({sessionId:qn.sessionId,messageCount:qn.messages.length,hasContext:!!qn.context})}`);try{const dn=await fetch("/api/avatar/save-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qn),signal:Bn.signal});clearTimeout(wn),console.log(`Save response status: ${dn.status}`);const yn=await dn.text();if(console.log(`Raw response: ${yn}`),!dn.ok)throw new Error(`Server responded with status: ${dn.status}, message: ${yn}`);const Mn=JSON.parse(yn);if(console.log(`API response: ${JSON.stringify(Mn)}`),Mn.success){console.log(`Transcript saved to database with ID: ${Mn.transcriptId}`),ht("Analyzing conversation...");try{const Vn=await fetch("/api/avatar/analyze-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:{messages:gn,context:_e==null?void 0:_e.context,instructions:_e==null?void 0:_e.instructions,scenario:"",skill:""}})});if(Vn.ok){const xs=await Vn.json();xs.success&&xs.analysis&&(localStorage.setItem("lastAnalysis",xs.analysis),console.log("Analysis saved to localStorage"))}}catch(Vn){console.log(`Error getting analysis: ${Vn.message}`)}return ht("Transcript saved successfully!"),localStorage.removeItem("pendingTranscript"),Mn.transcriptId}else throw new Error(Mn.error||"Database save failed")}catch(dn){console.log(`First save attempt error: ${dn==null?void 0:dn.message}`);const yn=await fetch("/api/avatar/save-transcript",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(qn),keepalive:!0});if(console.log(`Retry API response status: ${yn.status}`),yn.ok){const Mn=await yn.json();if(console.log(`Retry API response: ${JSON.stringify(Mn)}`),Mn.success)return console.log(`Retry successful! Transcript saved with ID: ${Mn.transcriptId}`),ht("Transcript saved on retry!"),Mn.transcriptId;throw new Error(Mn.error||"Retry save failed")}else{const Mn=await yn.text();throw new Error(`Retry failed with status: ${yn.status}, message: ${Mn}`)}}}catch(nn){console.log(`All save attempts failed: ${nn.message}`),ht("Failed to save transcript to database");try{const gn={id:generateUniqueId("tr"),timestamp:new Date().toISOString(),avatarId:gt,knowledgeId:ft,sessionId:Qt,transcript:qt.current};localStorage.setItem("finalTranscript",JSON.stringify(gn));const un=qt.current.map(mn=>`[${mn.timestamp}] ${mn.speaker}: ${mn.text}`).join(`
`);console.log("Created complete local backup with formatted content"),console.log("You can retrieve this transcript from localStorage.getItem('finalTranscript')")}catch(gn){console.log(`Fallback saving also failed: ${gn.message}`)}return null}finally{xn.current=!1}},lr=(Qt,nn)=>{if(!nn||nn.trim()==="")return;const un=new Date().toLocaleTimeString();let mn=nn.trim();mn.length>500&&console.log(`Long message being added to transcript (${Qt}): ${mn.length} characters`);const Tn=200;if(mn.length>Tn){const kn=[];for(let Un=0;Un<mn.length;Un+=Tn)kn.push(mn.substring(Un,Un+Tn));mn=kn.join(`
`)}const Fn={speaker:Qt,text:mn,timestamp:un};Vt(kn=>{const Un=kn.slice(-5);if(Un.some(wn=>wn.speaker===Qt&&wn.text===mn))return console.log(`Skipping exact duplicate message - ${Qt}: "${mn}"`),kn;if(Un.filter(wn=>wn.speaker===Qt&&(mn.includes(wn.text)||wn.text.includes(mn)||Al(mn,wn.text))).length>0){const wn=[...kn],dn=kn.findIndex(yn=>yn.speaker===Qt&&(mn.includes(yn.text)||yn.text.includes(mn)||Al(mn,yn.text)));if(dn>=0)if(mn.length>=wn[dn].text.length){wn[dn]=Fn;try{const yn=JSON.parse(localStorage.getItem("transcript")||"[]");yn[dn]=Fn,localStorage.setItem("transcript",JSON.stringify(yn))}catch(yn){console.log(`Error updating localStorage: ${yn.message}`)}return console.log(`Updated transcript entry - ${Qt}: "${mn}"`),wn}else return console.log(`Keeping longer existing message - ${Qt}`),kn}if(mn.length>20&&Un.some(dn=>dn.text.length>10&&mn.includes(dn.text)||mn.length>10&&dn.text.includes(mn)))return console.log(`Skipping message that contains part of another message - ${Qt}: "${mn}"`),kn;console.log(`Added to transcript - ${Qt}: "${mn}"`);try{const wn=JSON.parse(localStorage.getItem("transcript")||"[]");wn.push(Fn),localStorage.setItem("transcript",JSON.stringify(wn))}catch(wn){console.log(`Error saving to localStorage: ${wn.message}`)}return qt.current=[...qt.current,Fn],[...kn,Fn]})},Al=(Qt,nn)=>{if(Math.abs(Qt.length-nn.length)>Math.min(Qt.length,nn.length)*.3)return!1;const gn=Qt.toLowerCase().split(/\s+/),un=nn.toLowerCase().split(/\s+/);return gn.length<=3||un.length<=3?Qt.toLowerCase().includes(nn.toLowerCase())||nn.toLowerCase().includes(Qt.toLowerCase()):gn.filter(Fn=>un.includes(Fn)).length/Math.max(gn.length,un.length)>.7},cu=()=>{if(!("webkitSpeechRecognition"in window)){console.log("Speech recognition not supported");return}try{const Qt=new window.webkitSpeechRecognition;Qt.continuous=!0,Qt.interimResults=!0,Qt.lang=getLanguageCode(Ht),console.log(`Speech recognition language set to: ${Qt.lang}`),Qt.onresult=nn=>{let gn="",un="";for(let mn=nn.resultIndex;mn<nn.results.length;mn++){const Tn=nn.results[mn][0].transcript;nn.results[mn].isFinal?(un+=Tn+" ",un.trim()&&lr("User",un.trim())):gn+=Tn}},Qt.onerror=nn=>{console.log(`Speech recognition error: ${nn.error}`)},Qt.onend=()=>{it&&Qt.start()},Qt.start(),Jt.current=Qt,console.log("Speech recognition started")}catch(Qt){console.log(`Error starting speech recognition: ${Qt.message}`)}},lu=()=>{var Qt;try{const nn=new Set,gn=new Set;let un=Date.now(),mn="";const Tn=(Bn,wn)=>{if(!Bn||typeof Bn!="string")return;const dn=Bn.trim();if(dn.length<3||dn.includes("Interrupt")||dn.includes("End session")||dn.includes("View Transcript")||dn.includes("{")||dn.includes("isTrusted")||dn.includes("function(")||/^\d+$/.test(dn)||gn.has(dn))return;let yn=!1;gn.forEach(Mn=>{(Mn.includes(dn)||dn.includes(Mn))&&(yn=!0),Fn(Mn,dn)>.8&&(yn=!0)}),!yn&&(console.log(`${wn} found speech: ${dn}`),lr("Avatar",dn),gn.add(dn),un=Date.now())},Fn=(Bn,wn)=>{const dn=Bn.toLowerCase().split(/\s+/),yn=wn.toLowerCase().split(/\s+/);let Mn=0;for(const xs of dn)yn.includes(xs)&&Mn++;const Vn=Math.max(dn.length,yn.length);return Vn>0?Mn/Vn:0},kn=new MutationObserver(Bn=>{Bn.forEach(dn=>{if(dn.addedNodes&&dn.addedNodes.length&&dn.addedNodes.forEach(yn=>{if(yn.nodeType===Node.TEXT_NODE&&yn.textContent)Tn(yn.textContent,"DOM text node");else if(yn.nodeType===Node.ELEMENT_NODE){const Mn=yn.nodeName.toLowerCase();(Mn==="span"||Mn==="div"||Mn==="p")&&Tn(yn.textContent,"DOM element"),yn!=null&&yn.querySelectorAll&&(yn==null||yn.querySelectorAll('.caption-text, .speech-bubble, [aria-label*="caption"], .captions, .subtitles, .transcript-text').forEach(Vn=>{nn.has(Vn)||(Tn(Vn.textContent,"DOM caption element"),nn.add(Vn))}))}}),dn.type==="characterData"&&dn.target.textContent&&Tn(dn.target.textContent,"DOM text change"),dn.type==="attributes"&&dn.target.textContent){const yn=dn.attributeName;(yn==="textContent"||yn==="innerText"||yn==="aria-label")&&Tn(dn.target.textContent,`DOM attribute ${yn}`)}}),document.querySelectorAll('.avatar-speech-bubble, .speech-bubble, .caption-text, [aria-label*="caption"], [aria-label*="speech"], video + div, .transcript-text, .captions, .subtitles, [data-type="captions"]').forEach(dn=>{nn.has(dn)||(Tn(dn.textContent,"DOM query"),nn.add(dn),dn.setAttribute("data-processed","true"))});const wn=document.getElementById("avatarVideo");if(wn&&wn.textTracks&&wn.textTracks.length>0)for(let dn=0;dn<wn.textTracks.length;dn++){const yn=wn.textTracks[dn];if(yn.activeCues&&yn.activeCues.length>0)for(let Mn=0;Mn<yn.activeCues.length;Mn++){const Vn=yn.activeCues[Mn];Vn&&Vn.text&&!nn.has(Vn)&&(Tn(Vn.text,"Video text track"),nn.add(Vn))}}}),Un=(Qt=document.getElementById("avatarVideo"))==null?void 0:Qt.parentElement;Un&&(kn.observe(Un,{childList:!0,subtree:!0,characterData:!0,attributes:!0,attributeFilter:["textContent","innerText","aria-label"]}),console.log("Set up focused mutation observer for avatar speech on video container")),kn.observe(document.body,{childList:!0,subtree:!0,characterData:!0}),console.log("Set up additional mutation observer on document body");const qn=setInterval(()=>{document.querySelectorAll('.caption-text, [aria-label*="caption"], .transcript-line, .captions-container, video + div, .subtitles, .speech-bubble, [data-type="captions"], .avatar-speech').forEach(dn=>{nn.has(dn)||(Tn(dn.textContent,"Periodic check"),nn.add(dn))});const Bn=document.getElementById("avatarVideo");if(Bn){const dn=Bn.getBoundingClientRect(),yn=dn.left+dn.width/2,Mn=dn.top+dn.height*.7;document.elementsFromPoint(yn,Mn).forEach(Vn=>{Vn!==Bn&&!nn.has(Vn)&&Vn.textContent&&(Tn(Vn.textContent,"Video overlay element"),nn.add(Vn))})}const wn=document.getElementById("avatarVideo");if(wn&&wn.textTracks)for(let dn=0;dn<wn.textTracks.length;dn++){const yn=wn.textTracks[dn];yn.mode!=="showing"&&(yn.mode="showing")}if($t&&Date.now()-un>5e3&&Mt.filter(yn=>yn.speaker==="Avatar").length===0){const yn="I'm here to help with this situation. How can I assist you today?";console.log(`Adding default message since no speech detected: ${yn}`),lr("Avatar",yn),un=Date.now()}},500);vn.current={observer:kn,periodicCheck:qn,cleanup:()=>{kn.disconnect(),clearInterval(qn)}}}catch(nn){console.log(`Error setting up avatar speech capture: ${nn.message}`)}},Il=()=>{try{document.querySelectorAll("button").forEach(nn=>{var gn,un;(gn=nn.textContent)!=null&&gn.includes("End session & Save")&&nn.addEventListener("click",mn=>{mn.stopPropagation(),console.log("End session button clicked manually"),$o()}),(un=nn.textContent)!=null&&un.includes("Interrupt task")&&nn.addEventListener("click",mn=>{mn.stopPropagation(),console.log("Interrupt button clicked manually"),Nl()})}),console.log("Button functionality setup complete")}catch(Qt){console.log(`Error setting up button functionality: ${Qt.message}`)}},uu=()=>{var Qt;try{if((Qt=bn.current)!=null&&Qt.cleanup&&(bn.current.cleanup(),bn.current=null),!wt.current||!it){console.log("Media stream not available for audio analysis");return}const nn=new(window.AudioContext||window.webkitAudioContext),gn=nn.createAnalyser(),un=nn.createMediaStreamSource(it);un.connect(gn),gn.fftSize=256;const mn=gn.frequencyBinCount,Tn=new Uint8Array(mn);let Fn=!1,kn=null;const Un=()=>{gn.getByteFrequencyData(Tn);let qn=0;for(let dn=0;dn<mn;dn++)qn+=Tn[dn];qn/mn>30?(Fn||(Fn=!0,console.log("Audio analysis: Speech activity detected")),kn&&(clearTimeout(kn),kn=null)):Fn&&(kn||(kn=setTimeout(()=>{Fn=!1,console.log("Audio analysis: Speech activity ended"),kn=null},500))),requestAnimationFrame(Un)};Un(),console.log("Audio analysis for speech activity detection started"),console.log("Audio context state",nn.state),bn.current={audioCtx:nn,analyser:gn,source:un,cleanup:()=>{try{un.disconnect(),nn&&nn.state!=="closed"&&nn.close()}catch(qn){console.error("Error cleaning up audio analyzer:",qn)}}}}catch(nn){console.log(`Error setting up audio analysis: ${nn.message}`)}};async function du(){try{const Qt=await fetch("/api/avatar/get-access-token",{method:"POST",headers:{"Content-Type":"application/json"}});if(!Qt.ok)throw new Error(`Token fetch failed: ${Qt.status}`);const nn=await Qt.text();if(!nn||nn.trim()==="")throw new Error("Received empty token");return nn.trim()}catch(Qt){throw console.error("Error fetching access token:",Qt),ht(`Error: ${Qt.message}`),Qt}}async function Ko(){var Qt,nn;try{if(At.current&&Zn){console.log("Session already initialized, skipping...");return}console.log("Starting session initialization..."),on.current=!1,tt(!0),ht("Clearing any existing sessions...");try{console.log("Ending any existing HeyGen sessions...");const an=await fetch("/api/avatar/end-sessions",{method:"POST",headers:{"Content-Type":"application/json"}});if(an.ok){const Yt=await an.json();console.log("Existing sessions ended:",Yt)}else console.log("No existing sessions to end or endpoint returned error");await new Promise(Yt=>setTimeout(Yt,1e3))}catch(an){console.log("Error ending existing sessions (non-fatal):",an)}ht("Initializing session...");const gn=Ut.get("persona"),un=Ut.get("tone");let mn="";(_e!=null&&_e.context||_e!=null&&_e.instructions||_e!=null&&_e.description)&&(mn=`
Context: ${(_e==null?void 0:_e.context)||"Not specified"}
Description: ${(_e==null?void 0:_e.description)||"Not specified"}
Instructions: ${(_e==null?void 0:_e.instructions)||"Not specified"}
${_e!=null&&_e.avatarRole?`Role: ${_e.avatarRole}`:""}.
${gn?`Persona: ${gn}`:"Helpful virtual assistant"}
${un?`Tone: ${un}`:"Neutral"}

Please be conversational, helpful, and stay in character based on the provided context.
        `.trim());const Tn=Zt==null?void 0:Zt.consumePreWarmedSession(mn);let Fn=!1;if(Tt.current){try{console.log("Cleaning up existing avatar instance before new session"),await Tt.current.stopAvatar(),console.log("Previous avatar instance stopped successfully")}catch(an){console.log("Error stopping previous avatar (may already be stopped):",an)}Tt.current=null}if(Tn&&Tn.isReady&&Tn.avatarId===gt)console.log("Using pre-warmed session! Skipping token fetch and session creation."),ht("Using pre-warmed session..."),Fn=!0,Tt.current=Tn.avatar,Tn.stream&&(on.current=!0,st(Tn.stream)),Tn.sessionData&&(_n.current=Tn.sessionData.session_id,xt(Tn.sessionData),ot("started"),Tn.sessionData.session_id&&Xn(Tn.sessionData.session_id)),Tt.current.on(StreamingEvents.STREAM_READY,an=>{console.log("Stream is ready (pre-warmed)"),tn.current&&(clearTimeout(tn.current),tn.current=null),on.current=!0,sn(null),st(an.detail)}),Tt.current.on(StreamingEvents.STREAM_DISCONNECTED,an=>{console.log("Stream disconnected (pre-warmed)"),tn.current&&(clearTimeout(tn.current),tn.current=null),sn("Stream connection lost"),ht("Stream disconnected")}),tn.current=setTimeout(()=>{on.current||(console.error("Stream timeout: Pre-warmed stream failed to connect within 15 seconds"),sn("Stream connection timed out. Please try again."),ht("Stream connection failed. Click to retry."),tt(!1))},15e3);else{Tn&&console.log("Pre-warmed session not usable (avatar mismatch or not ready), falling back to normal initialization");const an=await du();if(!an)throw console.error("No token received from fetchAccessToken"),ht("Error: Failed to get access token"),new Error("Failed to get access token");console.log("Access token received successfully"),console.log(`Starting session with token length: ${an.length}`),Tt.current=new StreamingAvatar({token:an,config:{enableLog:!0}});let Yt,pn;const Sn=new Promise((On,In)=>{Yt=On,pn=In});Tt.current.on(StreamingEvents.STREAM_READY,On=>{var Zs;console.log("Stream is ready - STREAM_READY event received"),console.log("STREAM_READY event:",On);const In=(Zs=Tt.current)==null?void 0:Zs.mediaStream;console.log("avatar.mediaStream exists:",!!In);let ur=null;if(In&&In instanceof MediaStream?(console.log(" Using avatar.mediaStream (SDK recommended approach)"),ur=In):On!=null&&On.detail&&On.detail instanceof MediaStream?(console.log("Using event.detail as fallback"),ur=On.detail):On instanceof MediaStream&&(console.log("Event itself is the MediaStream"),ur=On),tn.current&&(clearTimeout(tn.current),tn.current=null),ur){const Er=ur.getVideoTracks(),$r=ur.getAudioTracks();console.log("Stream video tracks:",Er.length,Er.map(ar=>({id:ar.id,enabled:ar.enabled,muted:ar.muted}))),console.log("Stream audio tracks:",$r.length,$r.map(ar=>({id:ar.id,enabled:ar.enabled,muted:ar.muted}))),on.current=!0,sn(null),st(ur),Yt()}else{console.error("STREAM_READY fired but no stream found!"),console.log("Attempting delayed fetch of avatar.mediaStream...");let Er=0;const $r=setInterval(()=>{var Ys;Er++;const ar=(Ys=Tt.current)==null?void 0:Ys.mediaStream;ar&&ar instanceof MediaStream?(clearInterval($r),console.log(` Found avatar.mediaStream after ${Er} poll attempts`),on.current=!0,sn(null),st(ar)):Er>=20&&(clearInterval($r),console.error("Failed to get stream after 20 poll attempts"))},500);Yt()}}),Tt.current.on(StreamingEvents.STREAM_DISCONNECTED,On=>{console.log("Stream disconnected"),tn.current&&(clearTimeout(tn.current),tn.current=null),sn("Stream connection lost"),ht("Stream disconnected"),pn(new Error("Stream connection lost"))}),tn.current=setTimeout(()=>{var On,In;if(!on.current){console.error("Stream timeout: Failed to connect within 30 seconds"),console.log("DEBUG: Checking avatar.mediaStream:",(On=Tt.current)==null?void 0:On.mediaStream),console.log("DEBUG: avatar.current exists:",!!Tt.current);const ur=(In=Tt.current)==null?void 0:In.mediaStream;if(ur){console.log("Stream found on timeout! Using it directly."),on.current=!0,sn(null),st(ur);return}sn("Stream connection timed out. Please try again."),ht("Stream connection failed. Click to retry."),tt(!1),Yt()}},3e4),Tt.current._streamReadyPromise=Sn}Vt([]),localStorage.setItem("transcript","[]"),qt.current=[],$n.current=Date.now(),console.log(`Session started at: ${new Date().toISOString()}`),vn.current&&(vn.current.cleanup(),vn.current=null),bn.current&&(bn.current.cleanup(),bn.current=null),Wo(),Tt.current.on("*",an=>{const Yt=an.type||"unknown";console.log(`DEBUG RAW EVENT (${Yt}):`,an),console.log(`Received event: ${Yt}`)});const kn=an=>{let Yt="";if(typeof an=="string")Yt=an;else if(an&&typeof an=="object")if(typeof an.text=="string")Yt=an.text;else if(an.detail&&typeof an.detail.text=="string")Yt=an.detail.text;else if(an.message)Yt=typeof an.message=="string"?an.message:JSON.stringify(an.message);else if(an.data)Yt=typeof an.data=="string"?an.data:JSON.stringify(an.data);else if(an.content)Yt=typeof an.content=="string"?an.content:JSON.stringify(an.content);else if(an.transcript)Yt=an.transcript;else if(an.detail)typeof an.detail=="string"?Yt=an.detail:an.detail.message?Yt=an.detail.message:an.detail.content?Yt=an.detail.content:an.detail.transcript&&(Yt=an.detail.transcript);else{if(Object.keys(an).length===1&&an.isTrusted!==void 0)return"";try{const pn=JSON.stringify(an);if(pn&&pn.length>10&&pn!=="{}"&&!pn.includes("isTrusted"))try{const Sn=JSON.parse(pn);Sn.text?Yt=Sn.text:Sn.message?Yt=Sn.message:Sn.data?Yt=Sn.data:Sn.transcript?Yt=Sn.transcript:pn.includes("isTrusted")||(Yt=pn)}catch{pn.includes("isTrusted")||(Yt=pn)}}catch{}}return Yt&&typeof Yt=="string"&&Yt.trim().length>2&&!Yt.includes("Interrupt task")&&!Yt.includes("End session & Save")&&!Yt.includes("View Transcript")&&!Yt.includes("isTrusted")?Yt.trim():""};let Un=0,qn=0,Bn="",wn="",dn=!1,yn=!1,Mn=[],Vn=[],xs=null,gu=null;Tt.current.on(StreamingEvents.AVATAR_START_TALKING,an=>{console.log("Avatar started talking (event triggered)"),console.log("Avatar has started talking:",an),Pn(""),Kt(!0),dn=!0,Un=Date.now();const Yt=kn(an);Yt&&(console.log(`Initial avatar speech detected: ${Yt}`),Pn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return Bn=Sn,Sn})),setTimeout(()=>{dn&&Date.now()-Un>900&&document.querySelectorAll('.caption-text, [aria-label*="caption"], .transcript-line, .speech-bubble, .avatar-speech, .captions, [data-type="captions"]').forEach(pn=>{const Sn=pn.textContent;Sn&&Sn.trim()&&Sn.trim().length>3&&!Sn.includes("Interrupt")&&!Sn.includes("End session")&&!Sn.includes("View Transcript")&&(console.log(`Fallback: Found caption text in DOM: ${Sn.trim()}`),Pn(On=>{const In=On?`${On} ${Sn.trim()}`:Sn.trim();return Bn=In,Un=Date.now(),In}))})},1e3)}),Tt.current.on(StreamingEvents.AVATAR_STOP_TALKING,an=>{console.log("Avatar stopped talking (event triggered)"),console.log("Avatar has stopped talking:",an),Kt(!1),dn=!1;const Yt=kn(an);if(Yt&&(console.log(`Final avatar speech detected: ${Yt}`),Pn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return Bn=Sn,Sn})),En||Bn){const pn=En||Bn;!Mt.slice(-3).some(In=>In.speaker==="Avatar"&&In.text===pn)&&pn&&(console.log(`Adding complete avatar sentence to transcript: ${pn}`),lr("Avatar",pn),Pn(""))}}),Tt.current.on(StreamingEvents.AVATAR_TALKING_MESSAGE,an=>{try{console.log("Avatar talking message:",an),Un=Date.now(),dn=!0;const Yt=kn(an);Yt&&(console.log(`Avatar talking message: ${Yt}`),Pn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return Bn=Sn,Sn}))}catch(Yt){console.log(`Error handling avatar talking message: ${Yt.message}`)}}),Tt.current.on(StreamingEvents.AVATAR_END_MESSAGE,an=>{try{console.log("Avatar end message:",an),dn=!1;const Yt=kn(an);if(Yt&&(console.log(`Avatar end message: ${Yt}`),Pn(pn=>pn?`${pn} ${Yt}`:Yt)),En||Bn){const pn=En||Bn;!Mt.slice(-3).some(In=>In.speaker==="Avatar"&&In.text===pn)&&pn&&(console.log(`Adding complete avatar sentence from end message: ${pn}`),lr("Avatar",pn),Pn(""),Bn="")}}catch(Yt){console.log(`Error handling avatar end message: ${Yt.message}`)}}),Tt.current.on(StreamingEvents.USER_START,an=>{console.log("User started talking (event triggered)"),console.log("User has started interaction:",an),Gn(""),Ot(!0),yn=!0,qn=Date.now();const Yt=kn(an);Yt&&(console.log(`Initial user speech detected: ${Yt}`),Gn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return wn=Sn,Sn}))}),Tt.current.on(StreamingEvents.USER_STOP,an=>{console.log("User stopped talking (event triggered)"),console.log("User has stopped interaction:",an),Ot(!1),yn=!1;const Yt=kn(an);if(Yt&&(console.log(`Final user speech detected: ${Yt}`),Gn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return wn=Sn,Sn})),Rn||wn){const pn=Rn||wn;!Mt.slice(-3).some(In=>In.speaker==="User"&&In.text===pn)&&pn&&(console.log(`Adding complete user sentence to transcript: ${pn}`),lr("User",pn),Gn(""))}wn=""}),Tt.current.on(StreamingEvents.USER_TALKING_MESSAGE,an=>{try{console.log("User talking message:",an),qn=Date.now(),yn=!0;const Yt=kn(an);Yt&&(console.log(`User talking message: ${Yt}`),Gn(pn=>{const Sn=pn?`${pn} ${Yt}`:Yt;return wn=Sn,Sn}))}catch(Yt){console.log(`Error handling user talking message: ${Yt.message}`)}}),Tt.current.on(StreamingEvents.USER_END_MESSAGE,an=>{try{console.log("User end message:",an),yn=!1;const Yt=kn(an);if(Yt&&(console.log(`User end message: ${Yt}`),Gn(pn=>pn?`${pn} ${Yt}`:Yt)),Rn||wn){const pn=Rn||wn;!Mt.slice(-3).some(In=>In.speaker==="User"&&In.text===pn)&&pn&&(console.log(`Adding complete user sentence from end message: ${pn}`),lr("User",pn),Gn(""),wn="")}}catch(Yt){console.log(`Error handling user end message: ${Yt.message}`)}}),Tt.current.on(StreamingEvents.USER_SILENCE,an=>{if(console.log("User silence detected (event triggered)"),yn&&(Rn||wn)&&Date.now()-qn>1e3){const Yt=Rn||wn;!Mt.slice(-3).some(On=>On.speaker==="User"&&On.text===Yt)&&Yt&&(console.log(`Adding accumulated user sentence on silence: ${Yt}`),lr("User",Yt),Gn(""),wn="")}}),Tt.current.on(StreamingEvents.STREAM_DISCONNECTED,()=>{console.log("Stream disconnected"),$o()}),Tt.current.on(StreamingEvents.STREAM_READY,an=>{console.log("Stream is ready (duplicate handler)"),on.current=!0,st(an.detail),setTimeout(Il,1e3)}),_e!=null&&_e.context&&console.log(`Using context: ${_e==null?void 0:_e.context}`),_e!=null&&_e.instructions&&console.log(`Using instructions: ${_e==null?void 0:_e.instructions}`),_e!=null&&_e.description&&console.log(`Using description: ${_e==null?void 0:_e.description}`);const Ol=Ut.get("persona"),Dl=Ut.get("tone"),$l=Ut.get("blueprint");let Sr="";if($l)try{const an=JSON.parse(decodeURIComponent($l));Sr=generateAvatarPromptFromBlueprint(an),console.log("Using blueprint-based knowledge base for avatar behavior")}catch(an){console.error("Failed to parse blueprint:",an)}if(!Sr&&(_e!=null&&_e.context||_e!=null&&_e.instructions||_e!=null&&_e.description)?(Sr=`
  Context: ${(_e==null?void 0:_e.context)||"Not specified"}
  Description: ${(_e==null?void 0:_e.description)||"Not specified"}
  Instructions: ${(_e==null?void 0:_e.instructions)||"Not specified"}
  ${_e!=null&&_e.avatarRole?`Role: ${_e.avatarRole}`:""}.
  ${Ol?`Persona: ${Ol}`:"Helpful virtual assistant"}
  ${Dl?`Tone: ${Dl}`:"Neutral"}

  Please be conversational, helpful, and stay in character based on the provided context.
          `.trim(),console.log("Using custom knowledge base with context, description and instructions")):Sr||console.log("No context, description or instructions provided"),Fn)console.log("Skipping createStartAvatar - using pre-warmed session"),on.current||(console.log("Pre-warmed session: waiting for stream to be ready..."),await new Promise((an,Yt)=>{const pn=setInterval(()=>{on.current&&(clearInterval(pn),an())},100);setTimeout(()=>{clearInterval(pn),on.current||Yt(new Error("Pre-warmed stream not ready"))},15e3)}));else{const an="Monica_greeting_public";console.log("Creating avatar session with params:",{quality:AvatarQuality.Low,avatarName:gt||an,hasKnowledgeBase:!!Sr,language:Ht});try{console.log("DEBUG: About to call createStartAvatar with avatarId:",gt||an);const Yt={quality:AvatarQuality.Low,avatarName:gt||an};Sr&&Sr.trim().length>0&&(Yt.knowledgeBase=Sr,console.log("DEBUG: Adding knowledgeBase, length:",Sr.length)),Ht&&(Yt.language=Ht),console.log("DEBUG: Final request params:",JSON.stringify(Yt,null,2));const pn=await Tt.current.createStartAvatar(Yt);console.log("DEBUG: createStartAvatar completed successfully!"),console.log("createStartAvatar response:",pn),console.log("DEBUG: Immediately checking mediaStream:",(Qt=Tt.current)==null?void 0:Qt.mediaStream);const Sn=(nn=Tt.current)==null?void 0:nn.mediaStream;Sn&&(console.log("DEBUG: Stream available immediately after createStartAvatar!"),on.current=!0,st(Sn),tn.current&&(clearTimeout(tn.current),tn.current=null)),_n.current=pn==null?void 0:pn.session_id,console.log("Session started with:",{avatarId:gt||an,hasKnowledgeBase:!!Sr,sessionId:_n.current}),xt(pn),ot("started"),pn!=null&&pn.session_id&&Xn(pn.session_id),console.log("Waiting for STREAM_READY event (with fallback)...");try{await Promise.race([Tt.current._streamReadyPromise,new Promise((On,In)=>{setTimeout(async()=>{var Zs;console.log("STREAM_READY timeout - checking mediaStream directly...");const ur=(Zs=Tt.current)==null?void 0:Zs.mediaStream;if(ur)console.log("Fallback: Found mediaStream directly on SDK instance"),on.current=!0,sn(null),st(ur),tn.current&&(clearTimeout(tn.current),tn.current=null),On();else{let Er=0;const $r=setInterval(()=>{var Ys;Er++;const ar=(Ys=Tt.current)==null?void 0:Ys.mediaStream;ar?(clearInterval($r),console.log(`Fallback: Found mediaStream after ${Er} polls`),on.current=!0,sn(null),st(ar),tn.current&&(clearTimeout(tn.current),tn.current=null),On()):Er>=25&&(clearInterval($r),In(new Error("Stream not available after polling")))},1e3)}},5e3)})])}catch(On){console.error("Stream connection failed:",On.message)}console.log("Stream check complete, streamReadyRef:",on.current)}catch(Yt){console.error("Error in createStartAvatar:",Yt);let pn=Yt.message||"Failed to start avatar session",Sn="";if(Yt.response)try{const In=typeof Yt.response=="string"?JSON.parse(Yt.response):Yt.response;In.message&&(pn=In.message),In.error&&(Sn=In.error)}catch{console.log("Could not parse error response")}if(Yt.responseText)try{const In=JSON.parse(Yt.responseText);In.message&&(pn=In.message)}catch{}console.log("createStartAvatar error details:",{message:pn,details:Sn,status:Yt.status,response:Yt.response,responseText:Yt.responseText,fullError:JSON.stringify(Yt,Object.getOwnPropertyNames(Yt))}),tn.current&&(clearTimeout(tn.current),tn.current=null);const On=Sn?`${pn}: ${Sn}`:pn;sn(On),ht(`Error: ${On}`),tt(!1);return}}cu(),on.current?(await Tt.current.startVoiceChat({useSilencePrompt:!1,voiceChatTransport:VoiceChatTransport.WEBSOCKET}),Rt("voice_mode")):console.warn("Stream not ready, skipping voice chat initialization"),lu(),setTimeout(()=>{Mt.length===0&&(_e!=null&&_e.context&&(_e!=null&&_e.context.includes("Emily"))?lr("Avatar","Hello! I understand we need to discuss Emily's behavior in meetings. I'm here to help you work through this situation."):lr("Avatar","Hello! How can I help you today?"))},1e3)}catch(gn){console.error("Error starting avatar session:",gn),console.log(`Error starting session: ${gn.message}`),ht(gn.responseText?`Error: ${JSON.parse(gn.responseText).message}`:"Error starting session")}finally{tt(!1)}}async function Nl(){if(!Tt.current){console.log("Avatar API not initialized");return}await Tt.current.interrupt().catch(Qt=>{console.log(Qt.message)})}useMemoizedFn(async Qt=>{var nn,gn;Qt!==Ct&&(Qt==="text_mode"?(nn=Tt.current)==null||nn.closeVoiceChat():await((gn=Tt.current)==null?void 0:gn.startVoiceChat({useSilencePrompt:!1,voiceChatTransport:VoiceChatTransport.WEBSOCKET})),Rt(Qt))}),reactExports.useEffect(()=>()=>{var Qt,nn;if(console.log("Component unmounting - performing silent cleanup"),Tt.current&&Tt.current.stopAvatar().catch(console.error),Jt.current)try{Jt.current.stop()}catch(gn){console.error("Error stopping speech recognition:",gn)}(Qt=vn.current)!=null&&Qt.cleanup&&vn.current.cleanup(),(nn=bn.current)!=null&&nn.cleanup&&bn.current.cleanup(),it&&it.getTracks().forEach(gn=>gn.stop())},[]),reactExports.useEffect(()=>{it&&wt.current&&(wt.current.srcObject=it,wt.current.volume=1,wt.current.muted=!1,wt.current.onloadedmetadata=async()=>{try{await wt.current.play(),console.log("Video playing with full volume"),uu(),setTimeout(Il,1e3)}catch(Qt){console.error("Error playing video:",Qt),console.log("Error playing video: "+Qt.message)}},wt.current.addEventListener("addtrack",Qt=>{Qt.track.kind==="audio"&&console.log("Audio track added")}))},[wt,it]),reactExports.useEffect(()=>{if(!(!wt.current||!it))try{if(wt.current.textTracks)for(let Qt=0;Qt<wt.current.textTracks.length;Qt++){const nn=wt.current.textTracks[Qt];nn.mode="showing",nn.addEventListener("cuechange",()=>{if(nn.activeCues&&nn.activeCues.length>0)for(let gn=0;gn<nn.activeCues.length;gn++){const un=nn.activeCues[gn];un&&un.text&&(console.log(`Caption cue: ${un.text}`),Pn(mn=>mn?`${mn} ${un.text}`:un.text))}}),console.log(`Track ${Qt} (${nn.kind}/${nn.label}) set to showing`)}}catch(Qt){console.log(`Error setting up caption tracking: ${Qt.message}`)}},[it,wt.current]),reactExports.useEffect(()=>{if(!$t&&En&&En.trim().length>0){const Qt=setTimeout(()=>{Mt.slice(-3).some(un=>un.speaker==="Avatar"&&un.text===En)||(console.log(`Adding complete avatar sentence from effect: ${En}`),lr("Avatar",En),Pn(""))},500);return()=>clearTimeout(Qt)}},[$t,En]),reactExports.useEffect(()=>{if(!jt&&Rn&&Rn.trim().length>0){const Qt=setTimeout(()=>{Mt.slice(-3).some(un=>un.speaker==="User"&&un.text===Rn)||(console.log(`Adding complete user sentence from effect: ${Rn}`),lr("User",Rn),Gn(""))},500);return()=>clearTimeout(Qt)}},[jt,Rn]),reactExports.useEffect(()=>{qt.current=Mt},[Mt]),reactExports.useEffect(()=>()=>{tn.current&&(clearTimeout(tn.current),tn.current=null)},[]);const pu=!it&&(et||Zn)&&at!=="ended"&&!_t,fu=async()=>{sn(null),At.current=!1,Ft(!1),on.current=!1,tn.current&&(clearTimeout(tn.current),tn.current=null),await Ko()};return console.log("selectedAvatar",gr),jsxRuntimeExports.jsx("div",{className:"w-full h-screen bg-gray-50",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row gap-4 h-[calc(100vh-2rem)] max-w-[1800px] p-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsxs(Card,{className:"h-full shadow-lg",children:[jsxRuntimeExports.jsxs(CardContent,{className:"h-full flex flex-col justify-center items-center bg-white p-0 relative overflow-hidden",children:[jsxRuntimeExports.jsx(AvatarLoadingOverlay,{isLoading:pu,avatarName:gr==null?void 0:gr.name,status:dt,onCancel:()=>{window.location.href="/avatar/practice"}}),_t&&!it&&at!=="ended"&&!ct&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:jsxRuntimeExports.jsxs("div",{className:"text-center max-w-md px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full bg-red-500/20 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Connection Failed"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 mb-6",children:_t}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx(Button,{onClick:fu,className:"bg-[#04aac4] hover:bg-[#04aac4]/80 text-white px-6 py-2 rounded-lg","data-testid":"button-retry-session",children:"Try Again"}),jsxRuntimeExports.jsx("button",{onClick:()=>window.location.href="/avatar/practice",className:"text-sm text-slate-500 hover:text-slate-300 transition-colors underline","data-testid":"button-return-practice",children:"Return to practice selection"})]})]})}),it?jsxRuntimeExports.jsxs("div",{className:"h-full w-full relative bg-white",children:[jsxRuntimeExports.jsx("video",{ref:wt,autoPlay:!0,playsInline:!0,controls:!0,style:{width:"100%",height:"100%",objectFit:"contain"},id:"avatarVideo",className:"bg-white",muted:!1,volume:1,children:jsxRuntimeExports.jsx("track",{kind:"captions"})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2 absolute bottom-3 right-3 controls",children:[jsxRuntimeExports.jsx(Button,{className:"bg-blue-600 text-white rounded-lg hover:bg-blue-700",variant:"ghost",onClick:Nl,id:"interruptButton",disabled:dt.includes("Ending"),children:"Interrupt task"}),jsxRuntimeExports.jsxs(Button,{className:"bg-blue-600 text-white rounded-lg hover:bg-blue-700",variant:"ghost",onClick:$o,id:"endSessionButton",disabled:dt.includes("Ending"),children:["End session & Save",dt.includes("Ending")&&jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm",className:"ml-2"})]}),dt&&jsxRuntimeExports.jsx(Badge,{className:`
                        ${dt.includes("success")?"bg-green-500":dt.includes("Failed")||dt.includes("Error")?"bg-red-500":"bg-blue-500"} 
                        text-white
                      `,children:dt}),en&&jsxRuntimeExports.jsx(Button,{href:en,target:"_blank",rel:"noopener noreferrer",className:"bg-purple-600 text-white rounded-lg hover:bg-purple-700",variant:"ghost",children:"View Transcript"})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-2",children:[Bt&&at==="started"&&jsxRuntimeExports.jsx(SessionTimer,{sessionId:Bt,heygenSessionId:vt==null?void 0:vt.session_id,maxDurationSec:360,onExpired:hr,onWarning:au}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jt&&jsxRuntimeExports.jsxs(Badge,{className:"bg-blue-600",children:[jsxRuntimeExports.jsx("span",{className:"animate-pulse mr-2",children:""})," User speaking"]}),$t&&jsxRuntimeExports.jsxs(Badge,{className:"bg-purple-600",children:[jsxRuntimeExports.jsx("span",{className:"animate-pulse mr-2",children:""})," Avatar speaking"]})]})]}),rn&&jsxRuntimeExports.jsx("div",{className:"absolute top-16 left-1/2 -translate-x-1/2 bg-amber-500 text-white px-4 py-2 rounded-lg shadow-lg animate-pulse","data-testid":"session-warning-banner",children:"Session ending in less than 1 minute!"})]}):jsxRuntimeExports.jsx("div",{className:"h-full justify-center items-center flex",children:at==="ended"&&ct?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("p",{children:"Ending Session"}),jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm"})]}):at==="not_started"&&!Zn?jsxRuntimeExports.jsxs(Button,{variant:"default",onClick:Ko,disabled:et||At.current,children:[et||At.current?"Starting Session":"Start Session",(et||At.current)&&jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm",className:"ml-2"})]}):at==="not_started"&&et?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("p",{children:"Starting Session"}),jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm"})]}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center gap-2",children:jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm"})})})]}),jsxRuntimeExports.jsx(Separator,{}),jt||$t?jsxRuntimeExports.jsx(CardFooter,{className:"flex flex-col gap-3 relative bg-gray-800 text-white",children:jsxRuntimeExports.jsx("div",{className:"w-full text-center",children:jsxRuntimeExports.jsx(Button,{className:`${jt?"bg-blue-600":"bg-purple-600"} text-white hover:opacity-80`,variant:"ghost",children:jt?"Listening to you...":"Avatar speaking..."})})}):null]})}),jsxRuntimeExports.jsx("div",{className:"w-96",children:jsxRuntimeExports.jsx(Card,{className:"h-full w-full bg-white",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between mb-4 items-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-xl text-black",children:"Live Transcript"}),jsxRuntimeExports.jsxs(Badge,{className:"bg-blue-500 text-white",children:[Mt.length," lines"]}),Ht&&Ht!=="en"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full text-xs font-medium","data-testid":"transcript-language-indicator",children:[jsxRuntimeExports.jsx(Globe,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("span",{children:languageNames$1[Ht]||Ht.toUpperCase()})]})]})}),Mt!=null&&Mt.length?jsxRuntimeExports.jsx("div",{className:"flex flex-col h-[calc(100vh-10rem)] max-w-6xl mx-auto bg-white rounded-xl shadow-sm border border-gray-100",children:jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-scroll p-4 space-y-4 bg-white text-black",children:Mt.map((Qt,nn)=>jsxRuntimeExports.jsx("div",{className:`flex ${Qt.speaker==="User"?"justify-end":"justify-start"}`,children:jsxRuntimeExports.jsxs("div",{className:`max-w-[95%] p-2 rounded-lg text-sm ${Qt.speaker==="User"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-2 mb-0.5",children:[jsxRuntimeExports.jsx("span",{className:`text-xs font-medium ${Qt.speaker==="User"?"text-blue-100":"text-gray-600"}`,children:Qt.speaker==="User"?"You":"Avatar"}),jsxRuntimeExports.jsx("span",{className:`text-[10px] ${Qt.speaker==="User"?"text-blue-100":"text-gray-500"}`,children:Qt.timestamp})]}),jsxRuntimeExports.jsx("p",{className:"text-sm leading-snug",children:Qt.text})]})},nn))})}):null]})})})]})})}const languageNames={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",zh:"Mandarin",ja:"Japanese",ko:"Korean",hi:"Hindi",ar:"Arabic",ru:"Russian",nl:"Dutch",pl:"Polish",tr:"Turkish"};function SessionPage(){const{user:j}=useAuth(),[$,_e]=useSearchParams();useNavigate();const[et,tt]=reactExports.useState(null),[nt,rt]=reactExports.useState(""),[it,st]=reactExports.useState(!1),[at,ot]=reactExports.useState(null),[ct,lt]=reactExports.useState(!1),[ut,pt]=reactExports.useState(!0),dt=$.get("autostart")==="true",ht=$.get("scenarioId"),ft=$.get("customScenarioId"),mt=$.get("avatarId"),gt=$.get("language")||"en",yt=$.get("blueprint");reactExports.useEffect(()=>{ht||ft?(async()=>{try{if(pt(!0),ft){const St=await fetch(`/api/avatar/custom-scenarios/${ft}`,{credentials:"include"});if(!St.ok)throw new Error("Failed to fetch custom scenario");const Et=await St.json();if(Et.success&&Et.scenario){const wt=Et.scenario;let Tt=wt.blueprint;if(yt)try{Tt=JSON.parse(decodeURIComponent(yt))}catch{console.warn("Failed to parse blueprint from URL, using stored blueprint")}tt({id:`custom-${wt.id}`,name:wt.title,description:wt.description,context:(Tt==null?void 0:Tt.contextBackground)||wt.description,instructions:(Tt==null?void 0:Tt.conversationGoal)||"Practice this conversation scenario",avatarRole:(Tt==null?void 0:Tt.personaDetails)||"Conversation partner"})}else rt("Custom scenario not found. Please return to practice and try again.")}else if(ht){const Et=await(await fetch(`/api/avatar/get-scenarios?scenarioId=${ht}`)).json();if(Et.scenarios&&Et.scenarios.length>0){if(tt(Et.scenarios[0]),Et.scenarios[0].skillId){const wt=new URLSearchParams($);wt.set("skill",Et.scenarios[0].skillId),_e(wt)}}else rt("Scenario not found. Please return to practice and try again.")}else rt("No scenario specified. Please return to practice and try again.")}catch(St){console.error("Error fetching scenario:",St),rt("Unable to load the practice scenario. Please check your connection and try again.")}finally{pt(!1)}})():pt(!1)},[ht,ft]),reactExports.useEffect(()=>{(ht||ft)&&mt&&it&&(async()=>{try{if(!it)return;const St=ht||(ft?`custom-${ft}`:null),Et=await fetch(`/api/get-transcript-id?scenarioId=${St}&avatarId=${mt}`);if(!Et.ok&&Et.status!==404)throw new Error(`Failed to fetch transcript: ${Et.status}`);if(Et.ok){const wt=await Et.json();wt.transcriptId&&ot(wt.transcriptId)}}catch(St){console.error("Error fetching transcript ID:",St)}})()},[ht,ft,mt,it]);const vt=async()=>{if(!it&&!ct)try{if(lt(!0),!ht&&!ft||!mt)throw new Error("Missing required parameters");st(!0)}catch(xt){console.error("Failed to start session:",xt),rt("Unable to start the practice session. Please try again.")}finally{lt(!1)}};return reactExports.useEffect(()=>{(ht||ft)&&mt&&dt&&et&&!ut&&(console.log("Auto-starting session with:",{scenarioId:ht,customScenarioId:ft,avatarId:mt}),vt())},[ht,ft,mt,dt,et,ut]),!ht&&!ft||!mt?jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center max-w-md",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Session Error"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-6",children:"Invalid session parameters. Please start a new practice session."}),jsxRuntimeExports.jsx(Link,{to:"/avatar/practice",children:jsxRuntimeExports.jsx(Button,{color:"primary",size:"lg",children:" Return to Practice"})})]})})}):ut?jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Preparing Your Session"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Setting up your practice scenario..."})]})})}):jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-white",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-7xl",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx(Link,{to:"/avatar/practice",className:"inline-flex items-center text-blue-600 hover:text-blue-700 mb-4 font-medium",children:" End Practice Session"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:(et==null?void 0:et.name)||"Practice Session"}),gt!=="en"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-sm font-medium","data-testid":"language-indicator",children:[jsxRuntimeExports.jsx(Globe,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:languageNames[gt]||gt.toUpperCase()})]})]})]}),nt&&jsxRuntimeExports.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4 rounded",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),jsxRuntimeExports.jsxs("div",{className:"ml-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700 font-medium",children:nt}),jsxRuntimeExports.jsx("p",{className:"text-sm text-red-600 mt-1",children:jsxRuntimeExports.jsx(Link,{to:"/avatar/practice",className:"underline hover:text-red-500",children:"Return to practice selection"})})]})]})}),ct?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-12",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-pulse mb-4",children:jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto bg-blue-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 6.292 4 4 0 010-6.292zM15 21H3v-1a6 6 0 0112 0v1z"})})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Starting Your Session"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Please wait while we connect you with your practice partner..."})]})}):jsxRuntimeExports.jsx("div",{className:"bg-white",children:jsxRuntimeExports.jsx(InteractiveAvatar,{initialAvatarId:mt,initialKnowledgeId:(et==null?void 0:et.id)||ht||`custom-${ft}`,scenario:et??void 0})})]})})})}const millisecondsInWeek=6048e5,millisecondsInDay=864e5,constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(j,$){return typeof j=="function"?j($):j&&typeof j=="object"&&constructFromSymbol in j?j[constructFromSymbol]($):j instanceof Date?new j.constructor($):new Date($)}function toDate(j,$){return constructFrom($||j,j)}function addDays(j,$,_e){const et=toDate(j,_e==null?void 0:_e.in);return isNaN($)?constructFrom(j,NaN):(et.setDate(et.getDate()+$),et)}let defaultOptions$1={};function getDefaultOptions$1(){return defaultOptions$1}function startOfWeek(j,$){var it,st,at,ot;const _e=getDefaultOptions$1(),et=($==null?void 0:$.weekStartsOn)??((st=(it=$==null?void 0:$.locale)==null?void 0:it.options)==null?void 0:st.weekStartsOn)??_e.weekStartsOn??((ot=(at=_e.locale)==null?void 0:at.options)==null?void 0:ot.weekStartsOn)??0,tt=toDate(j,$==null?void 0:$.in),nt=tt.getDay(),rt=(nt<et?7:0)+nt-et;return tt.setDate(tt.getDate()-rt),tt.setHours(0,0,0,0),tt}function startOfISOWeek(j,$){return startOfWeek(j,{...$,weekStartsOn:1})}function getISOWeekYear(j,$){const _e=toDate(j,$==null?void 0:$.in),et=_e.getFullYear(),tt=constructFrom(_e,0);tt.setFullYear(et+1,0,4),tt.setHours(0,0,0,0);const nt=startOfISOWeek(tt),rt=constructFrom(_e,0);rt.setFullYear(et,0,4),rt.setHours(0,0,0,0);const it=startOfISOWeek(rt);return _e.getTime()>=nt.getTime()?et+1:_e.getTime()>=it.getTime()?et:et-1}function getTimezoneOffsetInMilliseconds(j){const $=toDate(j),_e=new Date(Date.UTC($.getFullYear(),$.getMonth(),$.getDate(),$.getHours(),$.getMinutes(),$.getSeconds(),$.getMilliseconds()));return _e.setUTCFullYear($.getFullYear()),+j-+_e}function normalizeDates(j,...$){const _e=constructFrom.bind(null,$.find(et=>typeof et=="object"));return $.map(_e)}function startOfDay(j,$){const _e=toDate(j,$==null?void 0:$.in);return _e.setHours(0,0,0,0),_e}function differenceInCalendarDays(j,$,_e){const[et,tt]=normalizeDates(_e==null?void 0:_e.in,j,$),nt=startOfDay(et),rt=startOfDay(tt),it=+nt-getTimezoneOffsetInMilliseconds(nt),st=+rt-getTimezoneOffsetInMilliseconds(rt);return Math.round((it-st)/millisecondsInDay)}function startOfISOWeekYear(j,$){const _e=getISOWeekYear(j,$),et=constructFrom(j,0);return et.setFullYear(_e,0,4),et.setHours(0,0,0,0),startOfISOWeek(et)}function constructNow(j){return constructFrom(j,Date.now())}function isSameDay(j,$,_e){const[et,tt]=normalizeDates(_e==null?void 0:_e.in,j,$);return+startOfDay(et)==+startOfDay(tt)}function isDate(j){return j instanceof Date||typeof j=="object"&&Object.prototype.toString.call(j)==="[object Date]"}function isValid$1(j){return!(!isDate(j)&&typeof j!="number"||isNaN(+toDate(j)))}function startOfYear(j,$){const _e=toDate(j,$==null?void 0:$.in);return _e.setFullYear(_e.getFullYear(),0,1),_e.setHours(0,0,0,0),_e}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(j,$,_e)=>{let et;const tt=formatDistanceLocale[j];return typeof tt=="string"?et=tt:$===1?et=tt.one:et=tt.other.replace("{{count}}",$.toString()),_e!=null&&_e.addSuffix?_e.comparison&&_e.comparison>0?"in "+et:et+" ago":et};function buildFormatLongFn(j){return($={})=>{const _e=$.width?String($.width):j.defaultWidth;return j.formats[_e]||j.formats[j.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(j,$,_e,et)=>formatRelativeLocale[j];function buildLocalizeFn(j){return($,_e)=>{const et=_e!=null&&_e.context?String(_e.context):"standalone";let tt;if(et==="formatting"&&j.formattingValues){const rt=j.defaultFormattingWidth||j.defaultWidth,it=_e!=null&&_e.width?String(_e.width):rt;tt=j.formattingValues[it]||j.formattingValues[rt]}else{const rt=j.defaultWidth,it=_e!=null&&_e.width?String(_e.width):j.defaultWidth;tt=j.values[it]||j.values[rt]}const nt=j.argumentCallback?j.argumentCallback($):$;return tt[nt]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(j,$)=>{const _e=Number(j),et=_e%100;if(et>20||et<10)switch(et%10){case 1:return _e+"st";case 2:return _e+"nd";case 3:return _e+"rd"}return _e+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:j=>j-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(j){return($,_e={})=>{const et=_e.width,tt=et&&j.matchPatterns[et]||j.matchPatterns[j.defaultMatchWidth],nt=$.match(tt);if(!nt)return null;const rt=nt[0],it=et&&j.parsePatterns[et]||j.parsePatterns[j.defaultParseWidth],st=Array.isArray(it)?findIndex(it,ct=>ct.test(rt)):findKey(it,ct=>ct.test(rt));let at;at=j.valueCallback?j.valueCallback(st):st,at=_e.valueCallback?_e.valueCallback(at):at;const ot=$.slice(rt.length);return{value:at,rest:ot}}}function findKey(j,$){for(const _e in j)if(Object.prototype.hasOwnProperty.call(j,_e)&&$(j[_e]))return _e}function findIndex(j,$){for(let _e=0;_e<j.length;_e++)if($(j[_e]))return _e}function buildMatchPatternFn(j){return($,_e={})=>{const et=$.match(j.matchPattern);if(!et)return null;const tt=et[0],nt=$.match(j.parsePattern);if(!nt)return null;let rt=j.valueCallback?j.valueCallback(nt[0]):nt[0];rt=_e.valueCallback?_e.valueCallback(rt):rt;const it=$.slice(tt.length);return{value:rt,rest:it}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:j=>parseInt(j,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:j=>j+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(j,$){const _e=toDate(j,$==null?void 0:$.in);return differenceInCalendarDays(_e,startOfYear(_e))+1}function getISOWeek(j,$){const _e=toDate(j,$==null?void 0:$.in),et=+startOfISOWeek(_e)-+startOfISOWeekYear(_e);return Math.round(et/millisecondsInWeek)+1}function getWeekYear(j,$){var ot,ct,lt,ut;const _e=toDate(j,$==null?void 0:$.in),et=_e.getFullYear(),tt=getDefaultOptions$1(),nt=($==null?void 0:$.firstWeekContainsDate)??((ct=(ot=$==null?void 0:$.locale)==null?void 0:ot.options)==null?void 0:ct.firstWeekContainsDate)??tt.firstWeekContainsDate??((ut=(lt=tt.locale)==null?void 0:lt.options)==null?void 0:ut.firstWeekContainsDate)??1,rt=constructFrom(($==null?void 0:$.in)||j,0);rt.setFullYear(et+1,0,nt),rt.setHours(0,0,0,0);const it=startOfWeek(rt,$),st=constructFrom(($==null?void 0:$.in)||j,0);st.setFullYear(et,0,nt),st.setHours(0,0,0,0);const at=startOfWeek(st,$);return+_e>=+it?et+1:+_e>=+at?et:et-1}function startOfWeekYear(j,$){var it,st,at,ot;const _e=getDefaultOptions$1(),et=($==null?void 0:$.firstWeekContainsDate)??((st=(it=$==null?void 0:$.locale)==null?void 0:it.options)==null?void 0:st.firstWeekContainsDate)??_e.firstWeekContainsDate??((ot=(at=_e.locale)==null?void 0:at.options)==null?void 0:ot.firstWeekContainsDate)??1,tt=getWeekYear(j,$),nt=constructFrom(($==null?void 0:$.in)||j,0);return nt.setFullYear(tt,0,et),nt.setHours(0,0,0,0),startOfWeek(nt,$)}function getWeek(j,$){const _e=toDate(j,$==null?void 0:$.in),et=+startOfWeek(_e,$)-+startOfWeekYear(_e,$);return Math.round(et/millisecondsInWeek)+1}function addLeadingZeros(j,$){const _e=j<0?"-":"",et=Math.abs(j).toString().padStart($,"0");return _e+et}const lightFormatters={y(j,$){const _e=j.getFullYear(),et=_e>0?_e:1-_e;return addLeadingZeros($==="yy"?et%100:et,$.length)},M(j,$){const _e=j.getMonth();return $==="M"?String(_e+1):addLeadingZeros(_e+1,2)},d(j,$){return addLeadingZeros(j.getDate(),$.length)},a(j,$){const _e=j.getHours()/12>=1?"pm":"am";switch($){case"a":case"aa":return _e.toUpperCase();case"aaa":return _e;case"aaaaa":return _e[0];case"aaaa":default:return _e==="am"?"a.m.":"p.m."}},h(j,$){return addLeadingZeros(j.getHours()%12||12,$.length)},H(j,$){return addLeadingZeros(j.getHours(),$.length)},m(j,$){return addLeadingZeros(j.getMinutes(),$.length)},s(j,$){return addLeadingZeros(j.getSeconds(),$.length)},S(j,$){const _e=$.length,et=j.getMilliseconds(),tt=Math.trunc(et*Math.pow(10,_e-3));return addLeadingZeros(tt,$.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function(j,$,_e){const et=j.getFullYear()>0?1:0;switch($){case"G":case"GG":case"GGG":return _e.era(et,{width:"abbreviated"});case"GGGGG":return _e.era(et,{width:"narrow"});case"GGGG":default:return _e.era(et,{width:"wide"})}},y:function(j,$,_e){if($==="yo"){const et=j.getFullYear(),tt=et>0?et:1-et;return _e.ordinalNumber(tt,{unit:"year"})}return lightFormatters.y(j,$)},Y:function(j,$,_e,et){const tt=getWeekYear(j,et),nt=tt>0?tt:1-tt;if($==="YY"){const rt=nt%100;return addLeadingZeros(rt,2)}return $==="Yo"?_e.ordinalNumber(nt,{unit:"year"}):addLeadingZeros(nt,$.length)},R:function(j,$){const _e=getISOWeekYear(j);return addLeadingZeros(_e,$.length)},u:function(j,$){const _e=j.getFullYear();return addLeadingZeros(_e,$.length)},Q:function(j,$,_e){const et=Math.ceil((j.getMonth()+1)/3);switch($){case"Q":return String(et);case"QQ":return addLeadingZeros(et,2);case"Qo":return _e.ordinalNumber(et,{unit:"quarter"});case"QQQ":return _e.quarter(et,{width:"abbreviated",context:"formatting"});case"QQQQQ":return _e.quarter(et,{width:"narrow",context:"formatting"});case"QQQQ":default:return _e.quarter(et,{width:"wide",context:"formatting"})}},q:function(j,$,_e){const et=Math.ceil((j.getMonth()+1)/3);switch($){case"q":return String(et);case"qq":return addLeadingZeros(et,2);case"qo":return _e.ordinalNumber(et,{unit:"quarter"});case"qqq":return _e.quarter(et,{width:"abbreviated",context:"standalone"});case"qqqqq":return _e.quarter(et,{width:"narrow",context:"standalone"});case"qqqq":default:return _e.quarter(et,{width:"wide",context:"standalone"})}},M:function(j,$,_e){const et=j.getMonth();switch($){case"M":case"MM":return lightFormatters.M(j,$);case"Mo":return _e.ordinalNumber(et+1,{unit:"month"});case"MMM":return _e.month(et,{width:"abbreviated",context:"formatting"});case"MMMMM":return _e.month(et,{width:"narrow",context:"formatting"});case"MMMM":default:return _e.month(et,{width:"wide",context:"formatting"})}},L:function(j,$,_e){const et=j.getMonth();switch($){case"L":return String(et+1);case"LL":return addLeadingZeros(et+1,2);case"Lo":return _e.ordinalNumber(et+1,{unit:"month"});case"LLL":return _e.month(et,{width:"abbreviated",context:"standalone"});case"LLLLL":return _e.month(et,{width:"narrow",context:"standalone"});case"LLLL":default:return _e.month(et,{width:"wide",context:"standalone"})}},w:function(j,$,_e,et){const tt=getWeek(j,et);return $==="wo"?_e.ordinalNumber(tt,{unit:"week"}):addLeadingZeros(tt,$.length)},I:function(j,$,_e){const et=getISOWeek(j);return $==="Io"?_e.ordinalNumber(et,{unit:"week"}):addLeadingZeros(et,$.length)},d:function(j,$,_e){return $==="do"?_e.ordinalNumber(j.getDate(),{unit:"date"}):lightFormatters.d(j,$)},D:function(j,$,_e){const et=getDayOfYear(j);return $==="Do"?_e.ordinalNumber(et,{unit:"dayOfYear"}):addLeadingZeros(et,$.length)},E:function(j,$,_e){const et=j.getDay();switch($){case"E":case"EE":case"EEE":return _e.day(et,{width:"abbreviated",context:"formatting"});case"EEEEE":return _e.day(et,{width:"narrow",context:"formatting"});case"EEEEEE":return _e.day(et,{width:"short",context:"formatting"});case"EEEE":default:return _e.day(et,{width:"wide",context:"formatting"})}},e:function(j,$,_e,et){const tt=j.getDay(),nt=(tt-et.weekStartsOn+8)%7||7;switch($){case"e":return String(nt);case"ee":return addLeadingZeros(nt,2);case"eo":return _e.ordinalNumber(nt,{unit:"day"});case"eee":return _e.day(tt,{width:"abbreviated",context:"formatting"});case"eeeee":return _e.day(tt,{width:"narrow",context:"formatting"});case"eeeeee":return _e.day(tt,{width:"short",context:"formatting"});case"eeee":default:return _e.day(tt,{width:"wide",context:"formatting"})}},c:function(j,$,_e,et){const tt=j.getDay(),nt=(tt-et.weekStartsOn+8)%7||7;switch($){case"c":return String(nt);case"cc":return addLeadingZeros(nt,$.length);case"co":return _e.ordinalNumber(nt,{unit:"day"});case"ccc":return _e.day(tt,{width:"abbreviated",context:"standalone"});case"ccccc":return _e.day(tt,{width:"narrow",context:"standalone"});case"cccccc":return _e.day(tt,{width:"short",context:"standalone"});case"cccc":default:return _e.day(tt,{width:"wide",context:"standalone"})}},i:function(j,$,_e){const et=j.getDay(),tt=et===0?7:et;switch($){case"i":return String(tt);case"ii":return addLeadingZeros(tt,$.length);case"io":return _e.ordinalNumber(tt,{unit:"day"});case"iii":return _e.day(et,{width:"abbreviated",context:"formatting"});case"iiiii":return _e.day(et,{width:"narrow",context:"formatting"});case"iiiiii":return _e.day(et,{width:"short",context:"formatting"});case"iiii":default:return _e.day(et,{width:"wide",context:"formatting"})}},a:function(j,$,_e){const tt=j.getHours()/12>=1?"pm":"am";switch($){case"a":case"aa":return _e.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"aaa":return _e.dayPeriod(tt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return _e.dayPeriod(tt,{width:"narrow",context:"formatting"});case"aaaa":default:return _e.dayPeriod(tt,{width:"wide",context:"formatting"})}},b:function(j,$,_e){const et=j.getHours();let tt;switch(et===12?tt=dayPeriodEnum.noon:et===0?tt=dayPeriodEnum.midnight:tt=et/12>=1?"pm":"am",$){case"b":case"bb":return _e.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"bbb":return _e.dayPeriod(tt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return _e.dayPeriod(tt,{width:"narrow",context:"formatting"});case"bbbb":default:return _e.dayPeriod(tt,{width:"wide",context:"formatting"})}},B:function(j,$,_e){const et=j.getHours();let tt;switch(et>=17?tt=dayPeriodEnum.evening:et>=12?tt=dayPeriodEnum.afternoon:et>=4?tt=dayPeriodEnum.morning:tt=dayPeriodEnum.night,$){case"B":case"BB":case"BBB":return _e.dayPeriod(tt,{width:"abbreviated",context:"formatting"});case"BBBBB":return _e.dayPeriod(tt,{width:"narrow",context:"formatting"});case"BBBB":default:return _e.dayPeriod(tt,{width:"wide",context:"formatting"})}},h:function(j,$,_e){if($==="ho"){let et=j.getHours()%12;return et===0&&(et=12),_e.ordinalNumber(et,{unit:"hour"})}return lightFormatters.h(j,$)},H:function(j,$,_e){return $==="Ho"?_e.ordinalNumber(j.getHours(),{unit:"hour"}):lightFormatters.H(j,$)},K:function(j,$,_e){const et=j.getHours()%12;return $==="Ko"?_e.ordinalNumber(et,{unit:"hour"}):addLeadingZeros(et,$.length)},k:function(j,$,_e){let et=j.getHours();return et===0&&(et=24),$==="ko"?_e.ordinalNumber(et,{unit:"hour"}):addLeadingZeros(et,$.length)},m:function(j,$,_e){return $==="mo"?_e.ordinalNumber(j.getMinutes(),{unit:"minute"}):lightFormatters.m(j,$)},s:function(j,$,_e){return $==="so"?_e.ordinalNumber(j.getSeconds(),{unit:"second"}):lightFormatters.s(j,$)},S:function(j,$){return lightFormatters.S(j,$)},X:function(j,$,_e){const et=j.getTimezoneOffset();if(et===0)return"Z";switch($){case"X":return formatTimezoneWithOptionalMinutes(et);case"XXXX":case"XX":return formatTimezone(et);case"XXXXX":case"XXX":default:return formatTimezone(et,":")}},x:function(j,$,_e){const et=j.getTimezoneOffset();switch($){case"x":return formatTimezoneWithOptionalMinutes(et);case"xxxx":case"xx":return formatTimezone(et);case"xxxxx":case"xxx":default:return formatTimezone(et,":")}},O:function(j,$,_e){const et=j.getTimezoneOffset();switch($){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(et,":");case"OOOO":default:return"GMT"+formatTimezone(et,":")}},z:function(j,$,_e){const et=j.getTimezoneOffset();switch($){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(et,":");case"zzzz":default:return"GMT"+formatTimezone(et,":")}},t:function(j,$,_e){const et=Math.trunc(+j/1e3);return addLeadingZeros(et,$.length)},T:function(j,$,_e){return addLeadingZeros(+j,$.length)}};function formatTimezoneShort(j,$=""){const _e=j>0?"-":"+",et=Math.abs(j),tt=Math.trunc(et/60),nt=et%60;return nt===0?_e+String(tt):_e+String(tt)+$+addLeadingZeros(nt,2)}function formatTimezoneWithOptionalMinutes(j,$){return j%60===0?(j>0?"-":"+")+addLeadingZeros(Math.abs(j)/60,2):formatTimezone(j,$)}function formatTimezone(j,$=""){const _e=j>0?"-":"+",et=Math.abs(j),tt=addLeadingZeros(Math.trunc(et/60),2),nt=addLeadingZeros(et%60,2);return _e+tt+$+nt}const dateLongFormatter=(j,$)=>{switch(j){case"P":return $.date({width:"short"});case"PP":return $.date({width:"medium"});case"PPP":return $.date({width:"long"});case"PPPP":default:return $.date({width:"full"})}},timeLongFormatter=(j,$)=>{switch(j){case"p":return $.time({width:"short"});case"pp":return $.time({width:"medium"});case"ppp":return $.time({width:"long"});case"pppp":default:return $.time({width:"full"})}},dateTimeLongFormatter=(j,$)=>{const _e=j.match(/(P+)(p+)?/)||[],et=_e[1],tt=_e[2];if(!tt)return dateLongFormatter(j,$);let nt;switch(et){case"P":nt=$.dateTime({width:"short"});break;case"PP":nt=$.dateTime({width:"medium"});break;case"PPP":nt=$.dateTime({width:"long"});break;case"PPPP":default:nt=$.dateTime({width:"full"});break}return nt.replace("{{date}}",dateLongFormatter(et,$)).replace("{{time}}",timeLongFormatter(tt,$))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(j){return dayOfYearTokenRE.test(j)}function isProtectedWeekYearToken(j){return weekYearTokenRE.test(j)}function warnOrThrowProtectedError(j,$,_e){const et=message(j,$,_e);if(console.warn(et),throwTokens.includes(j))throw new RangeError(et)}function message(j,$,_e){const et=j[0]==="Y"?"years":"days of the month";return`Use \`${j.toLowerCase()}\` instead of \`${j}\` (in \`${$}\`) for formatting ${et} to the input \`${_e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format$1(j,$,_e){var ot,ct,lt,ut;const et=getDefaultOptions$1(),tt=et.locale??enUS,nt=et.firstWeekContainsDate??((ct=(ot=et.locale)==null?void 0:ot.options)==null?void 0:ct.firstWeekContainsDate)??1,rt=et.weekStartsOn??((ut=(lt=et.locale)==null?void 0:lt.options)==null?void 0:ut.weekStartsOn)??0,it=toDate(j,_e==null?void 0:_e.in);if(!isValid$1(it))throw new RangeError("Invalid time value");let st=$.match(longFormattingTokensRegExp).map(pt=>{const dt=pt[0];if(dt==="p"||dt==="P"){const ht=longFormatters[dt];return ht(pt,tt.formatLong)}return pt}).join("").match(formattingTokensRegExp).map(pt=>{if(pt==="''")return{isToken:!1,value:"'"};const dt=pt[0];if(dt==="'")return{isToken:!1,value:cleanEscapedString(pt)};if(formatters[dt])return{isToken:!0,value:pt};if(dt.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+dt+"`");return{isToken:!1,value:pt}});tt.localize.preprocessor&&(st=tt.localize.preprocessor(it,st));const at={firstWeekContainsDate:nt,weekStartsOn:rt,locale:tt};return st.map(pt=>{if(!pt.isToken)return pt.value;const dt=pt.value;(isProtectedWeekYearToken(dt)||isProtectedDayOfYearToken(dt))&&warnOrThrowProtectedError(dt,$,String(j));const ht=formatters[dt[0]];return ht(it,dt,tt.localize,at)}).join("")}function cleanEscapedString(j){const $=j.match(escapedStringRegExp);return $?$[1].replace(doubleQuoteRegExp,"'"):j}function isSameWeek(j,$,_e){const[et,tt]=normalizeDates(_e==null?void 0:_e.in,j,$);return+startOfWeek(et,_e)==+startOfWeek(tt,_e)}function isSameMonth(j,$,_e){const[et,tt]=normalizeDates(_e==null?void 0:_e.in,j,$);return et.getFullYear()===tt.getFullYear()&&et.getMonth()===tt.getMonth()}function isThisMonth(j,$){return isSameMonth(constructFrom(j,j),constructNow(j))}function isThisWeek(j,$){return isSameWeek(constructFrom(j,j),constructNow(j),$)}function isToday(j,$){return isSameDay(constructFrom(j,j),constructNow(j))}function subDays(j,$,_e){return addDays(j,-1,_e)}function isYesterday(j,$){return isSameDay(constructFrom(j,j),subDays(constructNow(j)))}const getTimeGroup=j=>{const $=new Date(j);return isToday($)?"Today":isYesterday($)?"Yesterday":isThisWeek($)?"This Week":isThisMonth($)?"This Month":"Older"},formatDuration=j=>{const $=Math.floor(j/60),_e=j%60;return`${$}m ${_e}s`},getSkillGradient=j=>{const $=["from-blue-500 to-cyan-400","from-purple-500 to-pink-400","from-green-500 to-emerald-400","from-orange-500 to-amber-400","from-indigo-500 to-violet-400","from-rose-500 to-red-400","from-teal-500 to-cyan-400","from-fuchsia-500 to-purple-400"];return $[j%$.length]},getScoreColor=j=>j===null?"text-gray-400":j>=4?"text-green-600":j>=2.5?"text-amber-600":"text-red-600",getScoreBg=j=>j===null?"bg-gray-100":j>=4?"bg-green-50":j>=2.5?"bg-amber-50":"bg-red-50";function ResultsPage(){const[j,$]=reactExports.useState(""),[_e,et]=reactExports.useState("all"),[tt,nt]=reactExports.useState("skills"),{user:rt}=useAuth(),it=async()=>{const wt=await(await fetch("/api/avatar/get-transcripts",{credentials:"include"})).json();if(!wt.success)throw new Error("Failed to fetch transcripts");return wt.transcripts},st=async()=>{const wt=await(await fetch("/api/avatar/skill-progress",{credentials:"include"})).json();if(!wt.success)throw new Error("Failed to fetch skill progress");return wt.skillProgress},{isLoading:at,data:ot}=useQuery({queryKey:["/avatar/get-transcripts"],queryFn:it,refetchOnMount:"always",staleTime:0}),{isLoading:ct,data:lt}=useQuery({queryKey:["/avatar/skill-progress"],queryFn:st,refetchOnMount:"always",staleTime:0});if(at||ct)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center min-h-[60vh]",children:[jsxRuntimeExports.jsx(LoadingSpinner,{className:"mr-3"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Loading your results..."})]})});const pt=ot||[],ht=(lt||[]).filter(Et=>Et.sessionCount>0),ft=pt.length,mt=pt.reduce((Et,wt)=>Et+(Number(wt.duration)||0),0);pt.reduce((Et,wt)=>Et+(Number(wt.message_count)||0),0);const gt=ht.length>0?ht.reduce((Et,wt)=>Et+(wt.avgScore||0),0)/ht.length:0,yt=[...new Set(pt.map(Et=>Et.skill_name).filter(Boolean))],vt=pt.filter(Et=>{var Ct,Rt;const wt=!j||((Ct=Et.skill_name)==null?void 0:Ct.toLowerCase().includes(j.toLowerCase()))||((Rt=Et.scenario_name)==null?void 0:Rt.toLowerCase().includes(j.toLowerCase())),Tt=_e==="all"||Et.skill_name===_e;return wt&&Tt}),xt=vt.reduce((Et,wt)=>{const Tt=getTimeGroup(wt.created_at);return Et[Tt]||(Et[Tt]=[]),Et[Tt].push(wt),Et},{}),St=["Today","Yesterday","This Week","This Month","Older"];return pt.length===0?jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"p-8 max-w-4xl mx-auto",children:jsxRuntimeExports.jsxs("div",{className:"text-center py-16",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(Target,{className:"w-10 h-10 text-indigo-500"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Practice Sessions Yet"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:"Start practicing your communication skills to see your results and track your progress over time."}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",children:jsxRuntimeExports.jsxs(Button,{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-3",children:[jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 mr-2"}),"Start Your First Session"]})})]})})}):jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsxs("div",{className:"p-6 lg:p-8 max-w-7xl mx-auto space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 p-8 text-white",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-gradient-to-tr from-cyan-500/10 to-blue-500/10 rounded-full blur-2xl translate-y-1/2 -translate-x-1/2"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Your Practice Results"}),jsxRuntimeExports.jsx("p",{className:"text-white/70 text-lg",children:"Track your skill development and review session insights"})]}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",children:jsxRuntimeExports.jsxs(Button,{className:"bg-white text-slate-800 hover:bg-white/90 px-6 shadow-lg",children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4 mr-2"}),"New Session"]})})]}),jsxRuntimeExports.jsxs("div",{className:"mt-8 grid grid-cols-2 lg:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20",children:jsxRuntimeExports.jsx(BarChart3,{className:"w-5 h-5 text-blue-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-white/60 text-sm",children:"Sessions"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold",children:ft})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-green-500/20",children:jsxRuntimeExports.jsx(Clock,{className:"w-5 h-5 text-green-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-white/60 text-sm",children:"Practice Time"}),jsxRuntimeExports.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(mt/60),"m"]})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20",children:jsxRuntimeExports.jsx(Brain,{className:"w-5 h-5 text-purple-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-white/60 text-sm",children:"Skills Practiced"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold",children:ht.length})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-amber-500/20",children:jsxRuntimeExports.jsx(Award,{className:"w-5 h-5 text-amber-300"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-white/60 text-sm",children:"Avg Score"}),jsxRuntimeExports.jsxs("p",{className:"text-2xl font-bold",children:[gt>0?gt.toFixed(1):"-","/5"]})]})]})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>nt("skills"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${tt==="skills"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[jsxRuntimeExports.jsx(Brain,{className:"w-4 h-4 inline mr-2"}),"Skills Overview"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>nt("sessions"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${tt==="sessions"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[jsxRuntimeExports.jsx(Layers,{className:"w-4 h-4 inline mr-2"}),"All Sessions"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[jsxRuntimeExports.jsxs("div",{className:"relative flex-1 sm:w-64",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),jsxRuntimeExports.jsx(Input,{placeholder:"Search sessions...",value:j,onChange:Et=>$(Et.target.value),className:"pl-10"})]}),jsxRuntimeExports.jsxs("select",{value:_e,onChange:Et=>et(Et.target.value),className:"px-4 py-2 border rounded-lg text-sm bg-white",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Skills"}),yt.map(Et=>jsxRuntimeExports.jsx("option",{value:Et,children:Et},Et))]})]})]}),tt==="skills"&&jsxRuntimeExports.jsx("div",{className:"space-y-6",children:ht.length>0?jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:ht.map((Et,wt)=>{var Rt;const Tt=(Et.avgScore||0)/5*100,Ct=pt.filter(jt=>jt.skill_name===Et.skillName);return jsxRuntimeExports.jsxs(Card,{className:"overflow-hidden border-0 shadow-md hover:shadow-lg transition-shadow",children:[jsxRuntimeExports.jsx("div",{className:`h-2 bg-gradient-to-r ${getSkillGradient(wt)}`}),jsxRuntimeExports.jsxs(CardContent,{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Et.skillName}),Et.frameworkUsed&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-1",children:Et.frameworkUsed})]}),jsxRuntimeExports.jsxs("div",{className:`px-4 py-2 rounded-xl ${getScoreBg(Et.avgScore)}`,children:[jsxRuntimeExports.jsx("span",{className:`text-2xl font-bold ${getScoreColor(Et.avgScore)}`,children:((Rt=Et.avgScore)==null?void 0:Rt.toFixed(1))||"-"}),jsxRuntimeExports.jsx("span",{className:"text-gray-400 text-sm",children:"/5"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[jsxRuntimeExports.jsx("span",{children:"Score Progress"}),jsxRuntimeExports.jsxs("span",{children:[Et.sessionCount," session",Et.sessionCount!==1?"s":""]})]}),jsxRuntimeExports.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`h-full rounded-full bg-gradient-to-r ${getSkillGradient(wt)} transition-all duration-500`,style:{width:`${Tt}%`}})})]}),Et.dimensions.length>0&&jsxRuntimeExports.jsxs("div",{className:"border-t pt-4",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Dimension Breakdown"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-3",children:Et.dimensions.slice(0,4).map(jt=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 truncate mr-2",children:jt.dimension}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-1.5 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`h-full rounded-full ${jt.avgScore>=4?"bg-green-500":jt.avgScore>=2.5?"bg-amber-500":"bg-red-500"}`,style:{width:`${jt.avgScore/5*100}%`}})}),jsxRuntimeExports.jsx("span",{className:`text-sm font-semibold ${getScoreColor(jt.avgScore)}`,children:jt.avgScore.toFixed(1)})]})]},jt.dimension))})]}),Ct.length>0&&jsxRuntimeExports.jsxs("div",{className:"border-t mt-4 pt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Recent Sessions"}),jsxRuntimeExports.jsxs(Link,{to:"#",onClick:()=>{et(Et.skillName),nt("sessions")},className:"text-xs text-indigo-600 hover:text-indigo-700 flex items-center gap-1",children:["View all ",jsxRuntimeExports.jsx(ChevronRight,{className:"w-3 h-3"})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:Ct.slice(0,2).map(jt=>jsxRuntimeExports.jsxs(Link,{to:(rt==null?void 0:rt.userType)==="coach"?`/coach-dashboard?tab=avatar&id=${jt.id}`:`/avatar/session-analysis/?tid=${jt.id}${jt.skill_id?`&skill=${jt.skill_id}`:""}${jt.scenario_id?`&scenario=${jt.scenario_id}`:""}`,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors group",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:jt.scenario_name||"Practice Session"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:format$1(new Date(jt.created_at),"MMM d, h:mm a")})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:formatDuration(jt.duration||0)}),jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-600 transition-colors"})]})]},jt.id))})]})]})]},Et.skillId)})}):jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Brain,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Skill Assessments Yet"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mb-4",children:"Complete practice sessions to see your skill progression"}),jsxRuntimeExports.jsx(Link,{to:"/avatar/start",children:jsxRuntimeExports.jsx(Button,{children:"Start Practicing"})})]})}),tt==="sessions"&&jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[St.map(Et=>{const wt=xt[Et];return wt!=null&&wt.length?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-5 h-5 text-gray-400"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:Et}),jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"text-xs",children:[wt.length," session",wt.length!==1?"s":""]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:wt.map(Tt=>jsxRuntimeExports.jsx(Link,{to:(rt==null?void 0:rt.userType)==="coach"?`/coach-dashboard?tab=avatar&id=${Tt.id}`:`/avatar/session-analysis/?tid=${Tt.id}${Tt.skill_id?`&skill=${Tt.skill_id}`:""}${Tt.scenario_id?`&scenario=${Tt.scenario_id}`:""}`,className:"block",children:jsxRuntimeExports.jsx(Card,{className:"p-4 hover:shadow-md transition-all hover:border-indigo-200 group",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${getSkillGradient(Tt.skill_id||0)} flex items-center justify-center flex-shrink-0`,children:jsxRuntimeExports.jsx(Brain,{className:"w-6 h-6 text-white"})}),jsxRuntimeExports.jsx("div",{className:"flex-1 min-w-0",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 truncate",children:Tt.scenario_name||"Practice Session"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-500",children:[Tt.skill_name&&jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs font-normal",children:Tt.skill_name}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Clock,{className:"w-3 h-3"}),formatDuration(Tt.duration||0)]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(MessageCircle,{className:"w-3 h-3"}),Tt.message_count||0," messages"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-400",children:format$1(new Date(Tt.created_at),"h:mm a")}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-gray-100 group-hover:bg-indigo-100 transition-colors",children:jsxRuntimeExports.jsx(ArrowUpRight,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-600 transition-colors"})})]})]})})]})})},Tt.id))})]},Et):null}),vt.length===0&&jsxRuntimeExports.jsxs(Card,{className:"p-8 text-center",children:[jsxRuntimeExports.jsx(Search,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Sessions Found"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]})]})]})})}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let j=0;j<256;++j)byteToHex.push((j+256).toString(16).slice(1));function unsafeStringify(j,$=0){return byteToHex[j[$+0]]+byteToHex[j[$+1]]+byteToHex[j[$+2]]+byteToHex[j[$+3]]+"-"+byteToHex[j[$+4]]+byteToHex[j[$+5]]+"-"+byteToHex[j[$+6]]+byteToHex[j[$+7]]+"-"+byteToHex[j[$+8]]+byteToHex[j[$+9]]+"-"+byteToHex[j[$+10]]+byteToHex[j[$+11]]+byteToHex[j[$+12]]+byteToHex[j[$+13]]+byteToHex[j[$+14]]+byteToHex[j[$+15]]}const randomUUID$1=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID:randomUUID$1};function v4(j,$,_e){if(native.randomUUID&&!j)return native.randomUUID();j=j||{};const et=j.random||(j.rng||rng)();return et[6]=et[6]&15|64,et[8]=et[8]&63|128,unsafeStringify(et)}const TranscriptContext=reactExports.createContext(void 0);function TranscriptProvider({children:j}){const[$,_e]=reactExports.useState([]),et=reactExports.useCallback((it,st,at,ot=!1)=>{const ct=Date.now(),lt={itemId:it,type:"MESSAGE",role:st,title:at,data:{},expanded:!1,timestamp:new Date(ct).toISOString(),createdAtMs:ct,status:"DONE",isHidden:ot};_e(ut=>[...ut,lt])},[]),tt=reactExports.useCallback((it,st)=>{const at=Date.now(),ot={itemId:crypto.randomUUID(),type:"BREADCRUMB",title:it,data:st||{},expanded:!1,timestamp:new Date(at).toISOString(),createdAtMs:at,status:"DONE",isHidden:!1};_e(ct=>[...ct,ot])},[]),nt=reactExports.useCallback((it,st)=>{_e(at=>at.map(ot=>ot.itemId===it?{...ot,...st}:ot))},[]),rt=reactExports.useCallback(()=>{_e([])},[]);return jsxRuntimeExports.jsx(TranscriptContext.Provider,{value:{transcriptItems:$,addTranscriptMessage:et,addTranscriptBreadcrumb:tt,updateTranscriptItem:nt,clearTranscript:rt},children:j})}function useTranscript(){const j=reactExports.useContext(TranscriptContext);if(j===void 0)throw new Error("useTranscript must be used within a TranscriptProvider");return j}const EventContext=reactExports.createContext(void 0);function EventProvider({children:j}){const $=reactExports.useCallback((et,tt="")=>{const nt=tt||(et==null?void 0:et.type)||"client_event";console.log(`[Client Event] ${nt}:`,et)},[]),_e=reactExports.useCallback((et,tt="")=>{const nt=tt||(et==null?void 0:et.type)||"server_event";console.log(`[Server Event] ${nt}:`,et)},[]);return jsxRuntimeExports.jsx(EventContext.Provider,{value:{logClientEvent:$,logServerEvent:_e},children:j})}function useEvent(){const j=reactExports.useContext(EventContext);if(j===void 0)throw new Error("useEvent must be used within an EventProvider");return j}const METADATA={version:"0.0.10"};function base64ToArrayBuffer(j){const $=atob(j),_e=$.length,et=new Uint8Array(_e);for(let tt=0;tt<_e;tt++)et[tt]=$.charCodeAt(tt);return et.buffer}function arrayBufferToBase64(j){const $=String.fromCharCode(...new Uint8Array(j));return btoa($)}function getLastTextFromAudioOutputMessage(j){if(typeof j>"u"||j===null||typeof j!="object"||!("type"in j)||typeof j.type!="string"||!j.type||j.type!=="message"||!("content"in j)||!Array.isArray(j.content)||j.content.length<1)return;const $=j.content[j.content.length-1];if(!(!("type"in $)||typeof $.type!="string")){if($.type==="text")return typeof $.text=="string"?$.text:void 0;if($.type==="audio")return typeof $.transcript=="string"?$.transcript:void 0}}function diffRealtimeHistory(j,$){const _e=j.filter(nt=>!$.some(rt=>rt.itemId===nt.itemId)),et=$.filter(nt=>!j.some(rt=>rt.itemId===nt.itemId)),tt=$.filter(nt=>j.some(rt=>rt.itemId===nt.itemId&&JSON.stringify(rt)!==JSON.stringify(nt)));return{removals:_e,additions:et,updates:tt}}function hasWebRTCSupport(){return typeof window>"u"?!1:typeof window.RTCPeerConnection<"u"}function removeAudioFromContent(j){return j.role==="system"?j:j.role==="assistant"?{...j,content:j.content.map($=>$.type==="audio"?{...$,audio:null}:$)}:j.role==="user"?{...j,content:j.content.map($=>$.type==="input_audio"?{...$,audio:null}:$)}:j}function updateRealtimeHistory(j,$,_e){const et=!_e&&$.type==="message"?removeAudioFromContent($):$,tt=j.findIndex(nt=>nt.itemId===$.itemId);if(tt!==-1)return j.map((nt,rt)=>rt===tt?et:!_e&&nt.type==="message"?removeAudioFromContent(nt):nt);if($.previousItemId){const nt=j.findIndex(rt=>rt.itemId===$.previousItemId);return nt!==-1?[...j.slice(0,nt+1),et,...j.slice(nt+1)]:[...j,et]}else return[...j,et]}const HEADERS={"User-Agent":`Agents/JavaScript ${METADATA.version}`,"X-OpenAI-Agents-SDK":`openai-agents-sdk.${METADATA.version}`},WEBSOCKET_META=`openai-agents-sdk.${METADATA.version}`;async function safeExecute(j){try{return[null,await j()]}catch($){return[$,null]}}function makeParseableTextFormat(j,$){const _e={...j};return Object.defineProperties(_e,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:$,enumerable:!1}}),_e}const ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use"),defaultOptions={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},getDefaultOptions=j=>typeof j=="string"?{...defaultOptions,basePath:["#"],definitions:{},name:j}:{...defaultOptions,basePath:["#"],definitions:{},...j},zodDef=j=>"_def"in j?j._def:j;function isEmptyObj(j){if(!j)return!0;for(const $ in j)return!1;return!0}const getRefs=j=>{const $=getDefaultOptions(j),_e=$.name!==void 0?[...$.basePath,$.definitionPath,$.name]:$.basePath;return{...$,currentPath:_e,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries($.definitions).map(([et,tt])=>[zodDef(tt),{def:zodDef(tt),path:[...$.basePath,$.definitionPath,et],jsonSchema:void 0}]))}};function addErrorMessage(j,$,_e,et){et!=null&&et.errorMessages&&_e&&(j.errorMessage={...j.errorMessage,[$]:_e})}function setResponseValueAndErrors(j,$,_e,et,tt){j[$]=_e,addErrorMessage(j,$,et,tt)}var ZodFirstPartyTypeKind$1;(function(j){j.ZodString="ZodString",j.ZodNumber="ZodNumber",j.ZodNaN="ZodNaN",j.ZodBigInt="ZodBigInt",j.ZodBoolean="ZodBoolean",j.ZodDate="ZodDate",j.ZodSymbol="ZodSymbol",j.ZodUndefined="ZodUndefined",j.ZodNull="ZodNull",j.ZodAny="ZodAny",j.ZodUnknown="ZodUnknown",j.ZodNever="ZodNever",j.ZodVoid="ZodVoid",j.ZodArray="ZodArray",j.ZodObject="ZodObject",j.ZodUnion="ZodUnion",j.ZodDiscriminatedUnion="ZodDiscriminatedUnion",j.ZodIntersection="ZodIntersection",j.ZodTuple="ZodTuple",j.ZodRecord="ZodRecord",j.ZodMap="ZodMap",j.ZodSet="ZodSet",j.ZodFunction="ZodFunction",j.ZodLazy="ZodLazy",j.ZodLiteral="ZodLiteral",j.ZodEnum="ZodEnum",j.ZodEffects="ZodEffects",j.ZodNativeEnum="ZodNativeEnum",j.ZodOptional="ZodOptional",j.ZodNullable="ZodNullable",j.ZodDefault="ZodDefault",j.ZodCatch="ZodCatch",j.ZodPromise="ZodPromise",j.ZodBranded="ZodBranded",j.ZodPipeline="ZodPipeline",j.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind$1||(ZodFirstPartyTypeKind$1={}));function parseAnyDef(){return{}}function parseArrayDef(j,$){var et,tt;const _e={type:"array"};return((tt=(et=j.type)==null?void 0:et._def)==null?void 0:tt.typeName)!==ZodFirstPartyTypeKind$1.ZodAny&&(_e.items=parseDef(j.type._def,{...$,currentPath:[...$.currentPath,"items"]})),j.minLength&&setResponseValueAndErrors(_e,"minItems",j.minLength.value,j.minLength.message,$),j.maxLength&&setResponseValueAndErrors(_e,"maxItems",j.maxLength.value,j.maxLength.message,$),j.exactLength&&(setResponseValueAndErrors(_e,"minItems",j.exactLength.value,j.exactLength.message,$),setResponseValueAndErrors(_e,"maxItems",j.exactLength.value,j.exactLength.message,$)),_e}function parseBigintDef(j,$){const _e={type:"integer",format:"int64"};if(!j.checks)return _e;for(const et of j.checks)switch(et.kind){case"min":$.target==="jsonSchema7"?et.inclusive?setResponseValueAndErrors(_e,"minimum",et.value,et.message,$):setResponseValueAndErrors(_e,"exclusiveMinimum",et.value,et.message,$):(et.inclusive||(_e.exclusiveMinimum=!0),setResponseValueAndErrors(_e,"minimum",et.value,et.message,$));break;case"max":$.target==="jsonSchema7"?et.inclusive?setResponseValueAndErrors(_e,"maximum",et.value,et.message,$):setResponseValueAndErrors(_e,"exclusiveMaximum",et.value,et.message,$):(et.inclusive||(_e.exclusiveMaximum=!0),setResponseValueAndErrors(_e,"maximum",et.value,et.message,$));break;case"multipleOf":setResponseValueAndErrors(_e,"multipleOf",et.value,et.message,$);break}return _e}function parseBooleanDef(){return{type:"boolean"}}function parseBrandedDef(j,$){return parseDef(j.type._def,$)}const parseCatchDef=(j,$)=>parseDef(j.innerType._def,$);function parseDateDef(j,$,_e){const et=_e??$.dateStrategy;if(Array.isArray(et))return{anyOf:et.map((tt,nt)=>parseDateDef(j,$,tt))};switch(et){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return integerDateParser(j,$)}}const integerDateParser=(j,$)=>{const _e={type:"integer",format:"unix-time"};if($.target==="openApi3")return _e;for(const et of j.checks)switch(et.kind){case"min":setResponseValueAndErrors(_e,"minimum",et.value,et.message,$);break;case"max":setResponseValueAndErrors(_e,"maximum",et.value,et.message,$);break}return _e};function parseDefaultDef(j,$){return{...parseDef(j.innerType._def,$),default:j.defaultValue()}}function parseEffectsDef(j,$,_e){return $.effectStrategy==="input"?parseDef(j.schema._def,$,_e):{}}function parseEnumDef(j){return{type:"string",enum:[...j.values]}}const isJsonSchema7AllOfType=j=>"type"in j&&j.type==="string"?!1:"allOf"in j;function parseIntersectionDef(j,$){const _e=[parseDef(j.left._def,{...$,currentPath:[...$.currentPath,"allOf","0"]}),parseDef(j.right._def,{...$,currentPath:[...$.currentPath,"allOf","1"]})].filter(nt=>!!nt);let et=$.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const tt=[];return _e.forEach(nt=>{if(isJsonSchema7AllOfType(nt))tt.push(...nt.allOf),nt.unevaluatedProperties===void 0&&(et=void 0);else{let rt=nt;if("additionalProperties"in nt&&nt.additionalProperties===!1){const{additionalProperties:it,...st}=nt;rt=st}else et=void 0;tt.push(rt)}}),tt.length?{allOf:tt,...et}:void 0}function parseLiteralDef(j,$){const _e=typeof j.value;return _e!=="bigint"&&_e!=="number"&&_e!=="boolean"&&_e!=="string"?{type:Array.isArray(j.value)?"array":"object"}:$.target==="openApi3"?{type:_e==="bigint"?"integer":_e,enum:[j.value]}:{type:_e==="bigint"?"integer":_e,const:j.value}}let emojiRegex$1;const zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(emojiRegex$1===void 0&&(emojiRegex$1=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),emojiRegex$1),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function parseStringDef(j,$){const _e={type:"string"};function et(tt){return $.patternStrategy==="escape"?escapeNonAlphaNumeric(tt):tt}if(j.checks)for(const tt of j.checks)switch(tt.kind){case"min":setResponseValueAndErrors(_e,"minLength",typeof _e.minLength=="number"?Math.max(_e.minLength,tt.value):tt.value,tt.message,$);break;case"max":setResponseValueAndErrors(_e,"maxLength",typeof _e.maxLength=="number"?Math.min(_e.maxLength,tt.value):tt.value,tt.message,$);break;case"email":switch($.emailStrategy){case"format:email":addFormat(_e,"email",tt.message,$);break;case"format:idn-email":addFormat(_e,"idn-email",tt.message,$);break;case"pattern:zod":addPattern(_e,zodPatterns.email,tt.message,$);break}break;case"url":addFormat(_e,"uri",tt.message,$);break;case"uuid":addFormat(_e,"uuid",tt.message,$);break;case"regex":addPattern(_e,tt.regex,tt.message,$);break;case"cuid":addPattern(_e,zodPatterns.cuid,tt.message,$);break;case"cuid2":addPattern(_e,zodPatterns.cuid2,tt.message,$);break;case"startsWith":addPattern(_e,RegExp(`^${et(tt.value)}`),tt.message,$);break;case"endsWith":addPattern(_e,RegExp(`${et(tt.value)}$`),tt.message,$);break;case"datetime":addFormat(_e,"date-time",tt.message,$);break;case"date":addFormat(_e,"date",tt.message,$);break;case"time":addFormat(_e,"time",tt.message,$);break;case"duration":addFormat(_e,"duration",tt.message,$);break;case"length":setResponseValueAndErrors(_e,"minLength",typeof _e.minLength=="number"?Math.max(_e.minLength,tt.value):tt.value,tt.message,$),setResponseValueAndErrors(_e,"maxLength",typeof _e.maxLength=="number"?Math.min(_e.maxLength,tt.value):tt.value,tt.message,$);break;case"includes":{addPattern(_e,RegExp(et(tt.value)),tt.message,$);break}case"ip":{tt.version!=="v6"&&addFormat(_e,"ipv4",tt.message,$),tt.version!=="v4"&&addFormat(_e,"ipv6",tt.message,$);break}case"emoji":addPattern(_e,zodPatterns.emoji,tt.message,$);break;case"ulid":{addPattern(_e,zodPatterns.ulid,tt.message,$);break}case"base64":{switch($.base64Strategy){case"format:binary":{addFormat(_e,"binary",tt.message,$);break}case"contentEncoding:base64":{setResponseValueAndErrors(_e,"contentEncoding","base64",tt.message,$);break}case"pattern:zod":{addPattern(_e,zodPatterns.base64,tt.message,$);break}}break}case"nanoid":addPattern(_e,zodPatterns.nanoid,tt.message,$)}return _e}const escapeNonAlphaNumeric=j=>Array.from(j).map($=>/[a-zA-Z0-9]/.test($)?$:`\\${$}`).join(""),addFormat=(j,$,_e,et)=>{var tt;j.format||(tt=j.anyOf)!=null&&tt.some(nt=>nt.format)?(j.anyOf||(j.anyOf=[]),j.format&&(j.anyOf.push({format:j.format,...j.errorMessage&&et.errorMessages&&{errorMessage:{format:j.errorMessage.format}}}),delete j.format,j.errorMessage&&(delete j.errorMessage.format,Object.keys(j.errorMessage).length===0&&delete j.errorMessage)),j.anyOf.push({format:$,..._e&&et.errorMessages&&{errorMessage:{format:_e}}})):setResponseValueAndErrors(j,"format",$,_e,et)},addPattern=(j,$,_e,et)=>{var tt;j.pattern||(tt=j.allOf)!=null&&tt.some(nt=>nt.pattern)?(j.allOf||(j.allOf=[]),j.pattern&&(j.allOf.push({pattern:j.pattern,...j.errorMessage&&et.errorMessages&&{errorMessage:{pattern:j.errorMessage.pattern}}}),delete j.pattern,j.errorMessage&&(delete j.errorMessage.pattern,Object.keys(j.errorMessage).length===0&&delete j.errorMessage)),j.allOf.push({pattern:processRegExp($,et),..._e&&et.errorMessages&&{errorMessage:{pattern:_e}}})):setResponseValueAndErrors(j,"pattern",processRegExp($,et),_e,et)},processRegExp=(j,$)=>{var at;const _e=typeof j=="function"?j():j;if(!$.applyRegexFlags||!_e.flags)return _e.source;const et={i:_e.flags.includes("i"),m:_e.flags.includes("m"),s:_e.flags.includes("s")},tt=et.i?_e.source.toLowerCase():_e.source;let nt="",rt=!1,it=!1,st=!1;for(let ot=0;ot<tt.length;ot++){if(rt){nt+=tt[ot],rt=!1;continue}if(et.i){if(it){if(tt[ot].match(/[a-z]/)){st?(nt+=tt[ot],nt+=`${tt[ot-2]}-${tt[ot]}`.toUpperCase(),st=!1):tt[ot+1]==="-"&&((at=tt[ot+2])!=null&&at.match(/[a-z]/))?(nt+=tt[ot],st=!0):nt+=`${tt[ot]}${tt[ot].toUpperCase()}`;continue}}else if(tt[ot].match(/[a-z]/)){nt+=`[${tt[ot]}${tt[ot].toUpperCase()}]`;continue}}if(et.m){if(tt[ot]==="^"){nt+=`(^|(?<=[\r
]))`;continue}else if(tt[ot]==="$"){nt+=`($|(?=[\r
]))`;continue}}if(et.s&&tt[ot]==="."){nt+=it?`${tt[ot]}\r
`:`[${tt[ot]}\r
]`;continue}nt+=tt[ot],tt[ot]==="\\"?rt=!0:it&&tt[ot]==="]"?it=!1:!it&&tt[ot]==="["&&(it=!0)}try{const ot=new RegExp(nt)}catch{return console.warn(`Could not convert regex pattern at ${$.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),_e.source}return nt};function parseRecordDef(j,$){var et,tt,nt,rt;if($.target==="openApi3"&&((et=j.keyType)==null?void 0:et._def.typeName)===ZodFirstPartyTypeKind$1.ZodEnum)return{type:"object",required:j.keyType._def.values,properties:j.keyType._def.values.reduce((it,st)=>({...it,[st]:parseDef(j.valueType._def,{...$,currentPath:[...$.currentPath,"properties",st]})??{}}),{}),additionalProperties:!1};const _e={type:"object",additionalProperties:parseDef(j.valueType._def,{...$,currentPath:[...$.currentPath,"additionalProperties"]})??{}};if($.target==="openApi3")return _e;if(((tt=j.keyType)==null?void 0:tt._def.typeName)===ZodFirstPartyTypeKind$1.ZodString&&((nt=j.keyType._def.checks)!=null&&nt.length)){const it=Object.entries(parseStringDef(j.keyType._def,$)).reduce((st,[at,ot])=>at==="type"?st:{...st,[at]:ot},{});return{..._e,propertyNames:it}}else if(((rt=j.keyType)==null?void 0:rt._def.typeName)===ZodFirstPartyTypeKind$1.ZodEnum)return{..._e,propertyNames:{enum:j.keyType._def.values}};return _e}function parseMapDef(j,$){if($.mapStrategy==="record")return parseRecordDef(j,$);const _e=parseDef(j.keyType._def,{...$,currentPath:[...$.currentPath,"items","items","0"]})||{},et=parseDef(j.valueType._def,{...$,currentPath:[...$.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[_e,et],minItems:2,maxItems:2}}}function parseNativeEnumDef(j){const $=j.values,et=Object.keys(j.values).filter(nt=>typeof $[$[nt]]!="number").map(nt=>$[nt]),tt=Array.from(new Set(et.map(nt=>typeof nt)));return{type:tt.length===1?tt[0]==="string"?"string":"number":["string","number"],enum:et}}function parseNeverDef(){return{not:{}}}function parseNullDef(j){return j.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function parseUnionDef(j,$){if($.target==="openApi3")return asAnyOf(j,$);const _e=j.options instanceof Map?Array.from(j.options.values()):j.options;if(_e.every(et=>et._def.typeName in primitiveMappings&&(!et._def.checks||!et._def.checks.length))){const et=_e.reduce((tt,nt)=>{const rt=primitiveMappings[nt._def.typeName];return rt&&!tt.includes(rt)?[...tt,rt]:tt},[]);return{type:et.length>1?et:et[0]}}else if(_e.every(et=>et._def.typeName==="ZodLiteral"&&!et.description)){const et=_e.reduce((tt,nt)=>{const rt=typeof nt._def.value;switch(rt){case"string":case"number":case"boolean":return[...tt,rt];case"bigint":return[...tt,"integer"];case"object":if(nt._def.value===null)return[...tt,"null"];case"symbol":case"undefined":case"function":default:return tt}},[]);if(et.length===_e.length){const tt=et.filter((nt,rt,it)=>it.indexOf(nt)===rt);return{type:tt.length>1?tt:tt[0],enum:_e.reduce((nt,rt)=>nt.includes(rt._def.value)?nt:[...nt,rt._def.value],[])}}}else if(_e.every(et=>et._def.typeName==="ZodEnum"))return{type:"string",enum:_e.reduce((et,tt)=>[...et,...tt._def.values.filter(nt=>!et.includes(nt))],[])};return asAnyOf(j,$)}const asAnyOf=(j,$)=>{const _e=(j.options instanceof Map?Array.from(j.options.values()):j.options).map((et,tt)=>parseDef(et._def,{...$,currentPath:[...$.currentPath,"anyOf",`${tt}`]})).filter(et=>!!et&&(!$.strictUnions||typeof et=="object"&&Object.keys(et).length>0));return _e.length?{anyOf:_e}:void 0};function parseNullableDef(j,$){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(j.innerType._def.typeName)&&(!j.innerType._def.checks||!j.innerType._def.checks.length))return $.target==="openApi3"||$.nullableStrategy==="property"?{type:primitiveMappings[j.innerType._def.typeName],nullable:!0}:{type:[primitiveMappings[j.innerType._def.typeName],"null"]};if($.target==="openApi3"){const et=parseDef(j.innerType._def,{...$,currentPath:[...$.currentPath]});return et&&"$ref"in et?{allOf:[et],nullable:!0}:et&&{...et,nullable:!0}}const _e=parseDef(j.innerType._def,{...$,currentPath:[...$.currentPath,"anyOf","0"]});return _e&&{anyOf:[_e,{type:"null"}]}}function parseNumberDef(j,$){const _e={type:"number"};if(!j.checks)return _e;for(const et of j.checks)switch(et.kind){case"int":_e.type="integer",addErrorMessage(_e,"type",et.message,$);break;case"min":$.target==="jsonSchema7"?et.inclusive?setResponseValueAndErrors(_e,"minimum",et.value,et.message,$):setResponseValueAndErrors(_e,"exclusiveMinimum",et.value,et.message,$):(et.inclusive||(_e.exclusiveMinimum=!0),setResponseValueAndErrors(_e,"minimum",et.value,et.message,$));break;case"max":$.target==="jsonSchema7"?et.inclusive?setResponseValueAndErrors(_e,"maximum",et.value,et.message,$):setResponseValueAndErrors(_e,"exclusiveMaximum",et.value,et.message,$):(et.inclusive||(_e.exclusiveMaximum=!0),setResponseValueAndErrors(_e,"maximum",et.value,et.message,$));break;case"multipleOf":setResponseValueAndErrors(_e,"multipleOf",et.value,et.message,$);break}return _e}function decideAdditionalProperties(j,$){return $.removeAdditionalStrategy==="strict"?j.catchall._def.typeName==="ZodNever"?j.unknownKeys!=="strict":parseDef(j.catchall._def,{...$,currentPath:[...$.currentPath,"additionalProperties"]})??!0:j.catchall._def.typeName==="ZodNever"?j.unknownKeys==="passthrough":parseDef(j.catchall._def,{...$,currentPath:[...$.currentPath,"additionalProperties"]})??!0}function parseObjectDef(j,$){const _e={type:"object",...Object.entries(j.shape()).reduce((et,[tt,nt])=>{var st;if(nt===void 0||nt._def===void 0)return et;const rt=[...$.currentPath,"properties",tt],it=parseDef(nt._def,{...$,currentPath:rt,propertyPath:rt});if(it===void 0)return et;if($.openaiStrictMode&&nt.isOptional()&&!nt.isNullable()&&typeof((st=nt._def)==null?void 0:st.defaultValue)>"u")throw new Error(`Zod field at \`${rt.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...et.properties,[tt]:it},required:nt.isOptional()&&!$.openaiStrictMode?et.required:[...et.required,tt]}},{properties:{},required:[]}),additionalProperties:decideAdditionalProperties(j,$)};return _e.required.length||delete _e.required,_e}const parseOptionalDef=(j,$)=>{if($.propertyPath&&$.currentPath.slice(0,$.propertyPath.length).toString()===$.propertyPath.toString())return parseDef(j.innerType._def,{...$,currentPath:$.currentPath});const _e=parseDef(j.innerType._def,{...$,currentPath:[...$.currentPath,"anyOf","1"]});return _e?{anyOf:[{not:{}},_e]}:{}},parsePipelineDef=(j,$)=>{if($.pipeStrategy==="input")return parseDef(j.in._def,$);if($.pipeStrategy==="output")return parseDef(j.out._def,$);const _e=parseDef(j.in._def,{...$,currentPath:[...$.currentPath,"allOf","0"]}),et=parseDef(j.out._def,{...$,currentPath:[...$.currentPath,"allOf",_e?"1":"0"]});return{allOf:[_e,et].filter(tt=>tt!==void 0)}};function parsePromiseDef(j,$){return parseDef(j.type._def,$)}function parseSetDef(j,$){const et={type:"array",uniqueItems:!0,items:parseDef(j.valueType._def,{...$,currentPath:[...$.currentPath,"items"]})};return j.minSize&&setResponseValueAndErrors(et,"minItems",j.minSize.value,j.minSize.message,$),j.maxSize&&setResponseValueAndErrors(et,"maxItems",j.maxSize.value,j.maxSize.message,$),et}function parseTupleDef(j,$){return j.rest?{type:"array",minItems:j.items.length,items:j.items.map((_e,et)=>parseDef(_e._def,{...$,currentPath:[...$.currentPath,"items",`${et}`]})).reduce((_e,et)=>et===void 0?_e:[..._e,et],[]),additionalItems:parseDef(j.rest._def,{...$,currentPath:[...$.currentPath,"additionalItems"]})}:{type:"array",minItems:j.items.length,maxItems:j.items.length,items:j.items.map((_e,et)=>parseDef(_e._def,{...$,currentPath:[...$.currentPath,"items",`${et}`]})).reduce((_e,et)=>et===void 0?_e:[..._e,et],[])}}function parseUndefinedDef(){return{not:{}}}function parseUnknownDef(){return{}}const parseReadonlyDef=(j,$)=>parseDef(j.innerType._def,$);function parseDef(j,$,_e=!1){var rt;const et=$.seen.get(j);if($.override){const it=(rt=$.override)==null?void 0:rt.call($,j,$,et,_e);if(it!==ignoreOverride)return it}if(et&&!_e){const it=get$ref(et,$);if(it!==void 0)return"$ref"in it&&$.seenRefs.add(it.$ref),it}const tt={def:j,path:$.currentPath,jsonSchema:void 0};$.seen.set(j,tt);const nt=selectParser(j,j.typeName,$,_e);return nt&&addMeta(j,$,nt),tt.jsonSchema=nt,nt}const get$ref=(j,$)=>{switch($.$refStrategy){case"root":return{$ref:j.path.join("/")};case"extract-to-root":const _e=j.path.slice($.basePath.length+1).join("_");return _e!==$.name&&$.nameStrategy==="duplicate-ref"&&($.definitions[_e]=j.def),{$ref:[...$.basePath,$.definitionPath,_e].join("/")};case"relative":return{$ref:getRelativePath($.currentPath,j.path)};case"none":case"seen":return j.path.length<$.currentPath.length&&j.path.every((et,tt)=>$.currentPath[tt]===et)?(console.warn(`Recursive reference detected at ${$.currentPath.join("/")}! Defaulting to any`),{}):$.$refStrategy==="seen"?{}:void 0}},getRelativePath=(j,$)=>{let _e=0;for(;_e<j.length&&_e<$.length&&j[_e]===$[_e];_e++);return[(j.length-_e).toString(),...$.slice(_e)].join("/")},selectParser=(j,$,_e,et)=>{switch($){case ZodFirstPartyTypeKind$1.ZodString:return parseStringDef(j,_e);case ZodFirstPartyTypeKind$1.ZodNumber:return parseNumberDef(j,_e);case ZodFirstPartyTypeKind$1.ZodObject:return parseObjectDef(j,_e);case ZodFirstPartyTypeKind$1.ZodBigInt:return parseBigintDef(j,_e);case ZodFirstPartyTypeKind$1.ZodBoolean:return parseBooleanDef();case ZodFirstPartyTypeKind$1.ZodDate:return parseDateDef(j,_e);case ZodFirstPartyTypeKind$1.ZodUndefined:return parseUndefinedDef();case ZodFirstPartyTypeKind$1.ZodNull:return parseNullDef(_e);case ZodFirstPartyTypeKind$1.ZodArray:return parseArrayDef(j,_e);case ZodFirstPartyTypeKind$1.ZodUnion:case ZodFirstPartyTypeKind$1.ZodDiscriminatedUnion:return parseUnionDef(j,_e);case ZodFirstPartyTypeKind$1.ZodIntersection:return parseIntersectionDef(j,_e);case ZodFirstPartyTypeKind$1.ZodTuple:return parseTupleDef(j,_e);case ZodFirstPartyTypeKind$1.ZodRecord:return parseRecordDef(j,_e);case ZodFirstPartyTypeKind$1.ZodLiteral:return parseLiteralDef(j,_e);case ZodFirstPartyTypeKind$1.ZodEnum:return parseEnumDef(j);case ZodFirstPartyTypeKind$1.ZodNativeEnum:return parseNativeEnumDef(j);case ZodFirstPartyTypeKind$1.ZodNullable:return parseNullableDef(j,_e);case ZodFirstPartyTypeKind$1.ZodOptional:return parseOptionalDef(j,_e);case ZodFirstPartyTypeKind$1.ZodMap:return parseMapDef(j,_e);case ZodFirstPartyTypeKind$1.ZodSet:return parseSetDef(j,_e);case ZodFirstPartyTypeKind$1.ZodLazy:return parseDef(j.getter()._def,_e);case ZodFirstPartyTypeKind$1.ZodPromise:return parsePromiseDef(j,_e);case ZodFirstPartyTypeKind$1.ZodNaN:case ZodFirstPartyTypeKind$1.ZodNever:return parseNeverDef();case ZodFirstPartyTypeKind$1.ZodEffects:return parseEffectsDef(j,_e,et);case ZodFirstPartyTypeKind$1.ZodAny:return parseAnyDef();case ZodFirstPartyTypeKind$1.ZodUnknown:return parseUnknownDef();case ZodFirstPartyTypeKind$1.ZodDefault:return parseDefaultDef(j,_e);case ZodFirstPartyTypeKind$1.ZodBranded:return parseBrandedDef(j,_e);case ZodFirstPartyTypeKind$1.ZodReadonly:return parseReadonlyDef(j,_e);case ZodFirstPartyTypeKind$1.ZodCatch:return parseCatchDef(j,_e);case ZodFirstPartyTypeKind$1.ZodPipeline:return parsePipelineDef(j,_e);case ZodFirstPartyTypeKind$1.ZodFunction:case ZodFirstPartyTypeKind$1.ZodVoid:case ZodFirstPartyTypeKind$1.ZodSymbol:return;default:return(tt=>{})()}},addMeta=(j,$,_e)=>(j.description&&(_e.description=j.description,$.markdownDescription&&(_e.markdownDescription=j.description)),_e),zodToJsonSchema$1=(j,$)=>{const _e=getRefs($),et=typeof $=="string"?$:($==null?void 0:$.nameStrategy)==="title"||$==null?void 0:$.name,tt=parseDef(j._def,et===void 0?_e:{..._e,currentPath:[..._e.basePath,_e.definitionPath,et]},!1)??{},nt=typeof $=="object"&&$.name!==void 0&&$.nameStrategy==="title"?$.name:void 0;nt!==void 0&&(tt.title=nt);const rt=(()=>{if(isEmptyObj(_e.definitions))return;const st={},at=new Set;for(let ot=0;ot<500;ot++){const ct=Object.entries(_e.definitions).filter(([lt])=>!at.has(lt));if(ct.length===0)break;for(const[lt,ut]of ct)st[lt]=parseDef(zodDef(ut),{..._e,currentPath:[..._e.basePath,_e.definitionPath,lt]},!0)??{},at.add(lt)}return st})(),it=et===void 0?rt?{...tt,[_e.definitionPath]:rt}:tt:_e.nameStrategy==="duplicate-ref"?{...tt,...rt||_e.seenRefs.size?{[_e.definitionPath]:{...rt,..._e.seenRefs.size?{[et]:tt}:void 0}}:void 0}:{$ref:[..._e.$refStrategy==="relative"?[]:_e.basePath,_e.definitionPath,et].join("/"),[_e.definitionPath]:{...rt,[et]:tt}};return _e.target==="jsonSchema7"?it.$schema="http://json-schema.org/draft-07/schema#":_e.target==="jsonSchema2019-09"&&(it.$schema="https://json-schema.org/draft/2019-09/schema#"),it};function makeParseableResponseTool(j,{parser:$,callback:_e}){const et={...j};return Object.defineProperties(et,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:$,enumerable:!1},$callback:{value:_e,enumerable:!1}}),et}function zodToJsonSchema(j,$){return zodToJsonSchema$1(j,{openaiStrictMode:!0,name:$.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function zodTextFormat(j,$,_e){return makeParseableTextFormat({type:"json_schema",..._e,name:$,strict:!0,schema:zodToJsonSchema(j,{name:$})},et=>j.parse(JSON.parse(et)))}function zodResponsesFunction(j){return makeParseableResponseTool({type:"function",name:j.name,parameters:zodToJsonSchema(j.parameters,{name:j.name}),strict:!0},{callback:j.function,parser:$=>j.parameters.parse(JSON.parse($))})}class AgentsError extends Error{constructor(_e,et){super(_e);Wt(this,"state");this.state=et}}class SystemError extends AgentsError{}class MaxTurnsExceededError extends AgentsError{}class ModelBehaviorError extends AgentsError{}class UserError extends AgentsError{}class GuardrailExecutionError extends AgentsError{constructor(_e,et,tt){super(_e,tt);Wt(this,"error");this.error=et}}class ToolCallError extends AgentsError{constructor(_e,et,tt){super(_e,tt);Wt(this,"error");this.error=et}}class InputGuardrailTripwireTriggered extends AgentsError{constructor(_e,et,tt){super(_e,tt);Wt(this,"result");this.result=et}}class OutputGuardrailTripwireTriggered extends AgentsError{constructor(_e,et,tt){super(_e,tt);Wt(this,"result");this.result=et}}function isZodObject(j){return typeof j=="object"&&j!==null&&"_def"in j&&typeof j._def=="object"&&j._def!==null&&"typeName"in j._def&&j._def.typeName==="ZodObject"}function isAgentToolInput(j){return typeof j=="object"&&j!==null&&"input"in j&&typeof j.input=="string"}function toFunctionToolName(j){if(j=j.replace(/\s/g,"_"),j=j.replace(/[^a-zA-Z0-9]/g,"_"),j.length===0)throw new Error("Tool name cannot be empty");return j}function getSchemaAndParserFromInputType(j,$){const _e=et=>JSON.parse(et);if(isZodObject(j)){const et=zodResponsesFunction({name:$,parameters:j,function:()=>{}});return{schema:et.parameters,parser:et.$parseRaw}}else if(typeof j=="object"&&j!==null)return{schema:j,parser:_e};throw new UserError("Input type is not a ZodObject or a valid JSON schema")}function convertAgentOutputTypeToSerializable(j){if(j==="text")return"text";if(isZodObject(j)){const $=zodTextFormat(j,"output");return{type:$.type,name:$.name,strict:$.strict||!1,schema:$.schema}}return j}var browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var j=1e3,$=j*60,_e=$*60,et=_e*24,tt=et*7,nt=et*365.25;ms=function(ot,ct){ct=ct||{};var lt=typeof ot;if(lt==="string"&&ot.length>0)return rt(ot);if(lt==="number"&&isFinite(ot))return ct.long?st(ot):it(ot);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ot))};function rt(ot){if(ot=String(ot),!(ot.length>100)){var ct=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ot);if(ct){var lt=parseFloat(ct[1]),ut=(ct[2]||"ms").toLowerCase();switch(ut){case"years":case"year":case"yrs":case"yr":case"y":return lt*nt;case"weeks":case"week":case"w":return lt*tt;case"days":case"day":case"d":return lt*et;case"hours":case"hour":case"hrs":case"hr":case"h":return lt*_e;case"minutes":case"minute":case"mins":case"min":case"m":return lt*$;case"seconds":case"second":case"secs":case"sec":case"s":return lt*j;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return lt;default:return}}}}function it(ot){var ct=Math.abs(ot);return ct>=et?Math.round(ot/et)+"d":ct>=_e?Math.round(ot/_e)+"h":ct>=$?Math.round(ot/$)+"m":ct>=j?Math.round(ot/j)+"s":ot+"ms"}function st(ot){var ct=Math.abs(ot);return ct>=et?at(ot,ct,et,"day"):ct>=_e?at(ot,ct,_e,"hour"):ct>=$?at(ot,ct,$,"minute"):ct>=j?at(ot,ct,j,"second"):ot+" ms"}function at(ot,ct,lt,ut){var pt=ct>=lt*1.5;return Math.round(ot/lt)+" "+ut+(pt?"s":"")}return ms}function setup(j){_e.debug=_e,_e.default=_e,_e.coerce=st,_e.disable=rt,_e.enable=tt,_e.enabled=it,_e.humanize=requireMs(),_e.destroy=at,Object.keys(j).forEach(ot=>{_e[ot]=j[ot]}),_e.names=[],_e.skips=[],_e.formatters={};function $(ot){let ct=0;for(let lt=0;lt<ot.length;lt++)ct=(ct<<5)-ct+ot.charCodeAt(lt),ct|=0;return _e.colors[Math.abs(ct)%_e.colors.length]}_e.selectColor=$;function _e(ot){let ct,lt=null,ut,pt;function dt(...ht){if(!dt.enabled)return;const ft=dt,mt=Number(new Date),gt=mt-(ct||mt);ft.diff=gt,ft.prev=ct,ft.curr=mt,ct=mt,ht[0]=_e.coerce(ht[0]),typeof ht[0]!="string"&&ht.unshift("%O");let yt=0;ht[0]=ht[0].replace(/%([a-zA-Z%])/g,(xt,St)=>{if(xt==="%%")return"%";yt++;const Et=_e.formatters[St];if(typeof Et=="function"){const wt=ht[yt];xt=Et.call(ft,wt),ht.splice(yt,1),yt--}return xt}),_e.formatArgs.call(ft,ht),(ft.log||_e.log).apply(ft,ht)}return dt.namespace=ot,dt.useColors=_e.useColors(),dt.color=_e.selectColor(ot),dt.extend=et,dt.destroy=_e.destroy,Object.defineProperty(dt,"enabled",{enumerable:!0,configurable:!1,get:()=>lt!==null?lt:(ut!==_e.namespaces&&(ut=_e.namespaces,pt=_e.enabled(ot)),pt),set:ht=>{lt=ht}}),typeof _e.init=="function"&&_e.init(dt),dt}function et(ot,ct){const lt=_e(this.namespace+(typeof ct>"u"?":":ct)+ot);return lt.log=this.log,lt}function tt(ot){_e.save(ot),_e.namespaces=ot,_e.names=[],_e.skips=[];const ct=(typeof ot=="string"?ot:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const lt of ct)lt[0]==="-"?_e.skips.push(lt.slice(1)):_e.names.push(lt)}function nt(ot,ct){let lt=0,ut=0,pt=-1,dt=0;for(;lt<ot.length;)if(ut<ct.length&&(ct[ut]===ot[lt]||ct[ut]==="*"))ct[ut]==="*"?(pt=ut,dt=lt,ut++):(lt++,ut++);else if(pt!==-1)ut=pt+1,dt++,lt=dt;else return!1;for(;ut<ct.length&&ct[ut]==="*";)ut++;return ut===ct.length}function rt(){const ot=[..._e.names,..._e.skips.map(ct=>"-"+ct)].join(",");return _e.enable(""),ot}function it(ot){for(const ct of _e.skips)if(nt(ot,ct))return!1;for(const ct of _e.names)if(nt(ot,ct))return!0;return!1}function st(ot){return ot instanceof Error?ot.stack||ot.message:ot}function at(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return _e.enable(_e.load()),_e}var common=setup;(function(j,$){var _e={};$.formatArgs=tt,$.save=nt,$.load=rt,$.useColors=et,$.storage=it(),$.destroy=(()=>{let at=!1;return()=>{at||(at=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),$.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function et(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let at;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(at=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(at[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function tt(at){if(at[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+at[0]+(this.useColors?"%c ":" ")+"+"+j.exports.humanize(this.diff),!this.useColors)return;const ot="color: "+this.color;at.splice(1,0,ot,"color: inherit");let ct=0,lt=0;at[0].replace(/%[a-zA-Z%]/g,ut=>{ut!=="%%"&&(ct++,ut==="%c"&&(lt=ct))}),at.splice(lt,0,ot)}$.log=console.debug||console.log||(()=>{});function nt(at){try{at?$.storage.setItem("debug",at):$.storage.removeItem("debug")}catch{}}function rt(){let at;try{at=$.storage.getItem("debug")||$.storage.getItem("DEBUG")}catch{}return!at&&typeof process<"u"&&"env"in process&&(at=_e.DEBUG),at}function it(){try{return localStorage}catch{}}j.exports=common($);const{formatters:st}=j.exports;st.j=function(at){try{return JSON.stringify(at)}catch(ot){return"[UnexpectedJSONParseError]: "+ot.message}}})(browser,browser.exports);var browserExports=browser.exports;const debug=getDefaultExportFromCjs$1(browserExports);function loadEnv$1(){return loadEnv()}function isEnabled(j){const $=loadEnv$1();return typeof $<"u"&&($[j]==="true"||$[j]==="1")}const tracing={get disabled(){return!0}},logging={get dontLogModelData(){return isEnabled("OPENAI_AGENTS_DONT_LOG_MODEL_DATA")},get dontLogToolData(){return isEnabled("OPENAI_AGENTS_DONT_LOG_TOOL_DATA")}},dontLogModelData=logging.dontLogModelData,dontLogToolData=logging.dontLogToolData;function getLogger(j="openai-agents"){return{namespace:j,debug:debug(j),error:console.error,warn:console.warn,dontLogModelData,dontLogToolData}}const logger$1=getLogger("openai-agents:core");function toSmartString(j){if(j==null)return String(j);if(typeof j=="string")return j;if(typeof j=="object")try{return JSON.stringify(j)}catch{return"[object with circular references]"}return String(j)}function defaultToolErrorFunction(j,$){return`An error occurred while running the tool. Please try again. Error: ${$ instanceof Error?$.toString():String($)}`}function tool(j){const $=j.name?toFunctionToolName(j.name):toFunctionToolName(j.execute.name),_e=typeof j.errorFunction>"u"?defaultToolErrorFunction:j.errorFunction;if(!$)throw new Error("Tool name cannot be empty. Either name your function or provide a name in the options.");const et=j.strict??!0;if(!et&&isZodObject(j.parameters))throw new UserError("Strict mode is required for Zod parameters");const{parser:tt,schema:nt}=getSchemaAndParserFromInputType(j.parameters,$);async function rt(at,ot){const[ct,lt]=await safeExecute(()=>tt(ot));if(ct!==null)throw logger$1.dontLogToolData?logger$1.debug(`Invalid JSON input for tool ${$}`):logger$1.debug(`Invalid JSON input for tool ${$}: ${ot}`),new ModelBehaviorError("Invalid JSON input for tool");logger$1.dontLogToolData?logger$1.debug(`Invoking tool ${$}`):logger$1.debug(`Invoking tool ${$} with input ${ot}`);const ut=await j.execute(lt,at),pt=toSmartString(ut);return logger$1.dontLogToolData?logger$1.debug(`Tool ${$} completed`):logger$1.debug(`Tool ${$} returned: ${pt}`),ut}async function it(at,ot){return rt(at,ot).catch(ct=>{if(_e){const lt=getCurrentSpan();return lt==null||lt.setError({message:"Error running tool (non-fatal)",data:{tool_name:$,error:ct.toString()}}),_e(at,ct)}throw ct})}const st=typeof j.needsApproval=="function"?j.needsApproval:async()=>typeof j.needsApproval=="boolean"?j.needsApproval:!1;return{type:"function",name:$,description:j.description,parameters:nt,strict:et,invoke:it,needsApproval:st}}var util;(function(j){j.assertEqual=tt=>{};function $(tt){}j.assertIs=$;function _e(tt){throw new Error}j.assertNever=_e,j.arrayToEnum=tt=>{const nt={};for(const rt of tt)nt[rt]=rt;return nt},j.getValidEnumValues=tt=>{const nt=j.objectKeys(tt).filter(it=>typeof tt[tt[it]]!="number"),rt={};for(const it of nt)rt[it]=tt[it];return j.objectValues(rt)},j.objectValues=tt=>j.objectKeys(tt).map(function(nt){return tt[nt]}),j.objectKeys=typeof Object.keys=="function"?tt=>Object.keys(tt):tt=>{const nt=[];for(const rt in tt)Object.prototype.hasOwnProperty.call(tt,rt)&&nt.push(rt);return nt},j.find=(tt,nt)=>{for(const rt of tt)if(nt(rt))return rt},j.isInteger=typeof Number.isInteger=="function"?tt=>Number.isInteger(tt):tt=>typeof tt=="number"&&Number.isFinite(tt)&&Math.floor(tt)===tt;function et(tt,nt=" | "){return tt.map(rt=>typeof rt=="string"?`'${rt}'`:rt).join(nt)}j.joinValues=et,j.jsonStringifyReplacer=(tt,nt)=>typeof nt=="bigint"?nt.toString():nt})(util||(util={}));var objectUtil;(function(j){j.mergeShapes=($,_e)=>({...$,..._e})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=j=>{switch(typeof j){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return Number.isNaN(j)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(j)?ZodParsedType.array:j===null?ZodParsedType.null:j.then&&typeof j.then=="function"&&j.catch&&typeof j.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&j instanceof Map?ZodParsedType.map:typeof Set<"u"&&j instanceof Set?ZodParsedType.set:typeof Date<"u"&&j instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ZodError extends Error{get errors(){return this.issues}constructor($){super(),this.issues=[],this.addIssue=et=>{this.issues=[...this.issues,et]},this.addIssues=(et=[])=>{this.issues=[...this.issues,...et]};const _e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,_e):this.__proto__=_e,this.name="ZodError",this.issues=$}format($){const _e=$||function(nt){return nt.message},et={_errors:[]},tt=nt=>{for(const rt of nt.issues)if(rt.code==="invalid_union")rt.unionErrors.map(tt);else if(rt.code==="invalid_return_type")tt(rt.returnTypeError);else if(rt.code==="invalid_arguments")tt(rt.argumentsError);else if(rt.path.length===0)et._errors.push(_e(rt));else{let it=et,st=0;for(;st<rt.path.length;){const at=rt.path[st];st===rt.path.length-1?(it[at]=it[at]||{_errors:[]},it[at]._errors.push(_e(rt))):it[at]=it[at]||{_errors:[]},it=it[at],st++}}};return tt(this),et}static assert($){if(!($ instanceof ZodError))throw new Error(`Not a ZodError: ${$}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten($=_e=>_e.message){const _e={},et=[];for(const tt of this.issues)if(tt.path.length>0){const nt=tt.path[0];_e[nt]=_e[nt]||[],_e[nt].push($(tt))}else et.push($(tt));return{formErrors:et,fieldErrors:_e}}get formErrors(){return this.flatten()}}ZodError.create=j=>new ZodError(j);const errorMap=(j,$)=>{let _e;switch(j.code){case ZodIssueCode.invalid_type:j.received===ZodParsedType.undefined?_e="Required":_e=`Expected ${j.expected}, received ${j.received}`;break;case ZodIssueCode.invalid_literal:_e=`Invalid literal value, expected ${JSON.stringify(j.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:_e=`Unrecognized key(s) in object: ${util.joinValues(j.keys,", ")}`;break;case ZodIssueCode.invalid_union:_e="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:_e=`Invalid discriminator value. Expected ${util.joinValues(j.options)}`;break;case ZodIssueCode.invalid_enum_value:_e=`Invalid enum value. Expected ${util.joinValues(j.options)}, received '${j.received}'`;break;case ZodIssueCode.invalid_arguments:_e="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:_e="Invalid function return type";break;case ZodIssueCode.invalid_date:_e="Invalid date";break;case ZodIssueCode.invalid_string:typeof j.validation=="object"?"includes"in j.validation?(_e=`Invalid input: must include "${j.validation.includes}"`,typeof j.validation.position=="number"&&(_e=`${_e} at one or more positions greater than or equal to ${j.validation.position}`)):"startsWith"in j.validation?_e=`Invalid input: must start with "${j.validation.startsWith}"`:"endsWith"in j.validation?_e=`Invalid input: must end with "${j.validation.endsWith}"`:util.assertNever(j.validation):j.validation!=="regex"?_e=`Invalid ${j.validation}`:_e="Invalid";break;case ZodIssueCode.too_small:j.type==="array"?_e=`Array must contain ${j.exact?"exactly":j.inclusive?"at least":"more than"} ${j.minimum} element(s)`:j.type==="string"?_e=`String must contain ${j.exact?"exactly":j.inclusive?"at least":"over"} ${j.minimum} character(s)`:j.type==="number"?_e=`Number must be ${j.exact?"exactly equal to ":j.inclusive?"greater than or equal to ":"greater than "}${j.minimum}`:j.type==="bigint"?_e=`Number must be ${j.exact?"exactly equal to ":j.inclusive?"greater than or equal to ":"greater than "}${j.minimum}`:j.type==="date"?_e=`Date must be ${j.exact?"exactly equal to ":j.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(j.minimum))}`:_e="Invalid input";break;case ZodIssueCode.too_big:j.type==="array"?_e=`Array must contain ${j.exact?"exactly":j.inclusive?"at most":"less than"} ${j.maximum} element(s)`:j.type==="string"?_e=`String must contain ${j.exact?"exactly":j.inclusive?"at most":"under"} ${j.maximum} character(s)`:j.type==="number"?_e=`Number must be ${j.exact?"exactly":j.inclusive?"less than or equal to":"less than"} ${j.maximum}`:j.type==="bigint"?_e=`BigInt must be ${j.exact?"exactly":j.inclusive?"less than or equal to":"less than"} ${j.maximum}`:j.type==="date"?_e=`Date must be ${j.exact?"exactly":j.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(j.maximum))}`:_e="Invalid input";break;case ZodIssueCode.custom:_e="Invalid input";break;case ZodIssueCode.invalid_intersection_types:_e="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:_e=`Number must be a multiple of ${j.multipleOf}`;break;case ZodIssueCode.not_finite:_e="Number must be finite";break;default:_e=$.defaultError,util.assertNever(j)}return{message:_e}};let overrideErrorMap=errorMap;function getErrorMap(){return overrideErrorMap}const makeIssue=j=>{const{data:$,path:_e,errorMaps:et,issueData:tt}=j,nt=[..._e,...tt.path||[]],rt={...tt,path:nt};if(tt.message!==void 0)return{...tt,path:nt,message:tt.message};let it="";const st=et.filter(at=>!!at).slice().reverse();for(const at of st)it=at(rt,{data:$,defaultError:it}).message;return{...tt,path:nt,message:it}};function addIssueToContext(j,$){const _e=getErrorMap(),et=makeIssue({issueData:$,data:j.data,path:j.path,errorMaps:[j.common.contextualErrorMap,j.schemaErrorMap,_e,_e===errorMap?void 0:errorMap].filter(tt=>!!tt)});j.common.issues.push(et)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray($,_e){const et=[];for(const tt of _e){if(tt.status==="aborted")return INVALID;tt.status==="dirty"&&$.dirty(),et.push(tt.value)}return{status:$.value,value:et}}static async mergeObjectAsync($,_e){const et=[];for(const tt of _e){const nt=await tt.key,rt=await tt.value;et.push({key:nt,value:rt})}return ParseStatus.mergeObjectSync($,et)}static mergeObjectSync($,_e){const et={};for(const tt of _e){const{key:nt,value:rt}=tt;if(nt.status==="aborted"||rt.status==="aborted")return INVALID;nt.status==="dirty"&&$.dirty(),rt.status==="dirty"&&$.dirty(),nt.value!=="__proto__"&&(typeof rt.value<"u"||tt.alwaysSet)&&(et[nt.value]=rt.value)}return{status:$.value,value:et}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=j=>({status:"dirty",value:j}),OK=j=>({status:"valid",value:j}),isAborted=j=>j.status==="aborted",isDirty=j=>j.status==="dirty",isValid=j=>j.status==="valid",isAsync=j=>typeof Promise<"u"&&j instanceof Promise;var errorUtil;(function(j){j.errToObj=$=>typeof $=="string"?{message:$}:$||{},j.toString=$=>typeof $=="string"?$:$==null?void 0:$.message})(errorUtil||(errorUtil={}));class ParseInputLazyPath{constructor($,_e,et,tt){this._cachedPath=[],this.parent=$,this.data=_e,this._path=et,this._key=tt}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(j,$)=>{if(isValid($))return{success:!0,data:$.value};if(!j.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const _e=new ZodError(j.common.issues);return this._error=_e,this._error}}};function processCreateParams(j){if(!j)return{};const{errorMap:$,invalid_type_error:_e,required_error:et,description:tt}=j;if($&&(_e||et))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return $?{errorMap:$,description:tt}:{errorMap:(rt,it)=>{const{message:st}=j;return rt.code==="invalid_enum_value"?{message:st??it.defaultError}:typeof it.data>"u"?{message:st??et??it.defaultError}:rt.code!=="invalid_type"?{message:it.defaultError}:{message:st??_e??it.defaultError}},description:tt}}class ZodType{get description(){return this._def.description}_getType($){return getParsedType($.data)}_getOrReturnCtx($,_e){return _e||{common:$.parent.common,data:$.data,parsedType:getParsedType($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}_processInputParams($){return{status:new ParseStatus,ctx:{common:$.parent.common,data:$.data,parsedType:getParsedType($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}}_parseSync($){const _e=this._parse($);if(isAsync(_e))throw new Error("Synchronous parse encountered promise.");return _e}_parseAsync($){const _e=this._parse($);return Promise.resolve(_e)}parse($,_e){const et=this.safeParse($,_e);if(et.success)return et.data;throw et.error}safeParse($,_e){const et={common:{issues:[],async:(_e==null?void 0:_e.async)??!1,contextualErrorMap:_e==null?void 0:_e.errorMap},path:(_e==null?void 0:_e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:getParsedType($)},tt=this._parseSync({data:$,path:et.path,parent:et});return handleResult(et,tt)}"~validate"($){var et,tt;const _e={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:getParsedType($)};if(!this["~standard"].async)try{const nt=this._parseSync({data:$,path:[],parent:_e});return isValid(nt)?{value:nt.value}:{issues:_e.common.issues}}catch(nt){(tt=(et=nt==null?void 0:nt.message)==null?void 0:et.toLowerCase())!=null&&tt.includes("encountered")&&(this["~standard"].async=!0),_e.common={issues:[],async:!0}}return this._parseAsync({data:$,path:[],parent:_e}).then(nt=>isValid(nt)?{value:nt.value}:{issues:_e.common.issues})}async parseAsync($,_e){const et=await this.safeParseAsync($,_e);if(et.success)return et.data;throw et.error}async safeParseAsync($,_e){const et={common:{issues:[],contextualErrorMap:_e==null?void 0:_e.errorMap,async:!0},path:(_e==null?void 0:_e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:getParsedType($)},tt=this._parse({data:$,path:et.path,parent:et}),nt=await(isAsync(tt)?tt:Promise.resolve(tt));return handleResult(et,nt)}refine($,_e){const et=tt=>typeof _e=="string"||typeof _e>"u"?{message:_e}:typeof _e=="function"?_e(tt):_e;return this._refinement((tt,nt)=>{const rt=$(tt),it=()=>nt.addIssue({code:ZodIssueCode.custom,...et(tt)});return typeof Promise<"u"&&rt instanceof Promise?rt.then(st=>st?!0:(it(),!1)):rt?!0:(it(),!1)})}refinement($,_e){return this._refinement((et,tt)=>$(et)?!0:(tt.addIssue(typeof _e=="function"?_e(et,tt):_e),!1))}_refinement($){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:$}})}superRefine($){return this._refinement($)}constructor($){this.spa=this.safeParseAsync,this._def=$,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:_e=>this["~validate"](_e)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or($){return ZodUnion.create([this,$],this._def)}and($){return ZodIntersection.create(this,$,this._def)}transform($){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:$}})}default($){const _e=typeof $=="function"?$:()=>$;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:_e,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch($){const _e=typeof $=="function"?$:()=>$;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:_e,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe($){const _e=this.constructor;return new _e({...this._def,description:$})}pipe($){return ZodPipeline.create(this,$)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(j){let $="[0-5]\\d";j.precision?$=`${$}\\.\\d{${j.precision}}`:j.precision==null&&($=`${$}(\\.\\d+)?`);const _e=j.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${$})${_e}`}function timeRegex(j){return new RegExp(`^${timeRegexSource(j)}$`)}function datetimeRegex(j){let $=`${dateRegexSource}T${timeRegexSource(j)}`;const _e=[];return _e.push(j.local?"Z?":"Z"),j.offset&&_e.push("([+-]\\d{2}:?\\d{2})"),$=`${$}(${_e.join("|")})`,new RegExp(`^${$}$`)}function isValidIP(j,$){return!!(($==="v4"||!$)&&ipv4Regex.test(j)||($==="v6"||!$)&&ipv6Regex.test(j))}function isValidJWT(j,$){if(!jwtRegex.test(j))return!1;try{const[_e]=j.split(".");if(!_e)return!1;const et=_e.replace(/-/g,"+").replace(/_/g,"/").padEnd(_e.length+(4-_e.length%4)%4,"="),tt=JSON.parse(atob(et));return!(typeof tt!="object"||tt===null||"typ"in tt&&(tt==null?void 0:tt.typ)!=="JWT"||!tt.alg||$&&tt.alg!==$)}catch{return!1}}function isValidCidr(j,$){return!!(($==="v4"||!$)&&ipv4CidrRegex.test(j)||($==="v6"||!$)&&ipv6CidrRegex.test(j))}class ZodString extends ZodType{_parse($){if(this._def.coerce&&($.data=String($.data)),this._getType($)!==ZodParsedType.string){const nt=this._getOrReturnCtx($);return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:nt.parsedType}),INVALID}const et=new ParseStatus;let tt;for(const nt of this._def.checks)if(nt.kind==="min")$.data.length<nt.value&&(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.too_small,minimum:nt.value,type:"string",inclusive:!0,exact:!1,message:nt.message}),et.dirty());else if(nt.kind==="max")$.data.length>nt.value&&(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.too_big,maximum:nt.value,type:"string",inclusive:!0,exact:!1,message:nt.message}),et.dirty());else if(nt.kind==="length"){const rt=$.data.length>nt.value,it=$.data.length<nt.value;(rt||it)&&(tt=this._getOrReturnCtx($,tt),rt?addIssueToContext(tt,{code:ZodIssueCode.too_big,maximum:nt.value,type:"string",inclusive:!0,exact:!0,message:nt.message}):it&&addIssueToContext(tt,{code:ZodIssueCode.too_small,minimum:nt.value,type:"string",inclusive:!0,exact:!0,message:nt.message}),et.dirty())}else if(nt.kind==="email")emailRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"email",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"emoji",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="uuid")uuidRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"uuid",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="nanoid")nanoidRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="cuid")cuidRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"cuid",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="cuid2")cuid2Regex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="ulid")ulidRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"ulid",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty());else if(nt.kind==="url")try{new URL($.data)}catch{tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"url",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()}else nt.kind==="regex"?(nt.regex.lastIndex=0,nt.regex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"regex",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty())):nt.kind==="trim"?$.data=$.data.trim():nt.kind==="includes"?$.data.includes(nt.value,nt.position)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:{includes:nt.value,position:nt.position},message:nt.message}),et.dirty()):nt.kind==="toLowerCase"?$.data=$.data.toLowerCase():nt.kind==="toUpperCase"?$.data=$.data.toUpperCase():nt.kind==="startsWith"?$.data.startsWith(nt.value)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:{startsWith:nt.value},message:nt.message}),et.dirty()):nt.kind==="endsWith"?$.data.endsWith(nt.value)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:{endsWith:nt.value},message:nt.message}),et.dirty()):nt.kind==="datetime"?datetimeRegex(nt).test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:"datetime",message:nt.message}),et.dirty()):nt.kind==="date"?dateRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:"date",message:nt.message}),et.dirty()):nt.kind==="time"?timeRegex(nt).test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.invalid_string,validation:"time",message:nt.message}),et.dirty()):nt.kind==="duration"?durationRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"duration",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):nt.kind==="ip"?isValidIP($.data,nt.version)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"ip",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):nt.kind==="jwt"?isValidJWT($.data,nt.alg)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"jwt",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):nt.kind==="cidr"?isValidCidr($.data,nt.version)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"cidr",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):nt.kind==="base64"?base64Regex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"base64",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):nt.kind==="base64url"?base64urlRegex.test($.data)||(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{validation:"base64url",code:ZodIssueCode.invalid_string,message:nt.message}),et.dirty()):util.assertNever(nt);return{status:et.value,value:$.data}}_regex($,_e,et){return this.refinement(tt=>$.test(tt),{validation:_e,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(et)})}_addCheck($){return new ZodString({...this._def,checks:[...this._def.checks,$]})}email($){return this._addCheck({kind:"email",...errorUtil.errToObj($)})}url($){return this._addCheck({kind:"url",...errorUtil.errToObj($)})}emoji($){return this._addCheck({kind:"emoji",...errorUtil.errToObj($)})}uuid($){return this._addCheck({kind:"uuid",...errorUtil.errToObj($)})}nanoid($){return this._addCheck({kind:"nanoid",...errorUtil.errToObj($)})}cuid($){return this._addCheck({kind:"cuid",...errorUtil.errToObj($)})}cuid2($){return this._addCheck({kind:"cuid2",...errorUtil.errToObj($)})}ulid($){return this._addCheck({kind:"ulid",...errorUtil.errToObj($)})}base64($){return this._addCheck({kind:"base64",...errorUtil.errToObj($)})}base64url($){return this._addCheck({kind:"base64url",...errorUtil.errToObj($)})}jwt($){return this._addCheck({kind:"jwt",...errorUtil.errToObj($)})}ip($){return this._addCheck({kind:"ip",...errorUtil.errToObj($)})}cidr($){return this._addCheck({kind:"cidr",...errorUtil.errToObj($)})}datetime($){return typeof $=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:$}):this._addCheck({kind:"datetime",precision:typeof($==null?void 0:$.precision)>"u"?null:$==null?void 0:$.precision,offset:($==null?void 0:$.offset)??!1,local:($==null?void 0:$.local)??!1,...errorUtil.errToObj($==null?void 0:$.message)})}date($){return this._addCheck({kind:"date",message:$})}time($){return typeof $=="string"?this._addCheck({kind:"time",precision:null,message:$}):this._addCheck({kind:"time",precision:typeof($==null?void 0:$.precision)>"u"?null:$==null?void 0:$.precision,...errorUtil.errToObj($==null?void 0:$.message)})}duration($){return this._addCheck({kind:"duration",...errorUtil.errToObj($)})}regex($,_e){return this._addCheck({kind:"regex",regex:$,...errorUtil.errToObj(_e)})}includes($,_e){return this._addCheck({kind:"includes",value:$,position:_e==null?void 0:_e.position,...errorUtil.errToObj(_e==null?void 0:_e.message)})}startsWith($,_e){return this._addCheck({kind:"startsWith",value:$,...errorUtil.errToObj(_e)})}endsWith($,_e){return this._addCheck({kind:"endsWith",value:$,...errorUtil.errToObj(_e)})}min($,_e){return this._addCheck({kind:"min",value:$,...errorUtil.errToObj(_e)})}max($,_e){return this._addCheck({kind:"max",value:$,...errorUtil.errToObj(_e)})}length($,_e){return this._addCheck({kind:"length",value:$,...errorUtil.errToObj(_e)})}nonempty($){return this.min(1,errorUtil.errToObj($))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find($=>$.kind==="datetime")}get isDate(){return!!this._def.checks.find($=>$.kind==="date")}get isTime(){return!!this._def.checks.find($=>$.kind==="time")}get isDuration(){return!!this._def.checks.find($=>$.kind==="duration")}get isEmail(){return!!this._def.checks.find($=>$.kind==="email")}get isURL(){return!!this._def.checks.find($=>$.kind==="url")}get isEmoji(){return!!this._def.checks.find($=>$.kind==="emoji")}get isUUID(){return!!this._def.checks.find($=>$.kind==="uuid")}get isNANOID(){return!!this._def.checks.find($=>$.kind==="nanoid")}get isCUID(){return!!this._def.checks.find($=>$.kind==="cuid")}get isCUID2(){return!!this._def.checks.find($=>$.kind==="cuid2")}get isULID(){return!!this._def.checks.find($=>$.kind==="ulid")}get isIP(){return!!this._def.checks.find($=>$.kind==="ip")}get isCIDR(){return!!this._def.checks.find($=>$.kind==="cidr")}get isBase64(){return!!this._def.checks.find($=>$.kind==="base64")}get isBase64url(){return!!this._def.checks.find($=>$.kind==="base64url")}get minLength(){let $=null;for(const _e of this._def.checks)_e.kind==="min"&&($===null||_e.value>$)&&($=_e.value);return $}get maxLength(){let $=null;for(const _e of this._def.checks)_e.kind==="max"&&($===null||_e.value<$)&&($=_e.value);return $}}ZodString.create=j=>new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(j==null?void 0:j.coerce)??!1,...processCreateParams(j)});function floatSafeRemainder(j,$){const _e=(j.toString().split(".")[1]||"").length,et=($.toString().split(".")[1]||"").length,tt=_e>et?_e:et,nt=Number.parseInt(j.toFixed(tt).replace(".","")),rt=Number.parseInt($.toFixed(tt).replace(".",""));return nt%rt/10**tt}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse($){if(this._def.coerce&&($.data=Number($.data)),this._getType($)!==ZodParsedType.number){const nt=this._getOrReturnCtx($);return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:nt.parsedType}),INVALID}let et;const tt=new ParseStatus;for(const nt of this._def.checks)nt.kind==="int"?util.isInteger($.data)||(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:nt.message}),tt.dirty()):nt.kind==="min"?(nt.inclusive?$.data<nt.value:$.data<=nt.value)&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:nt.value,type:"number",inclusive:nt.inclusive,exact:!1,message:nt.message}),tt.dirty()):nt.kind==="max"?(nt.inclusive?$.data>nt.value:$.data>=nt.value)&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:nt.value,type:"number",inclusive:nt.inclusive,exact:!1,message:nt.message}),tt.dirty()):nt.kind==="multipleOf"?floatSafeRemainder($.data,nt.value)!==0&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.not_multiple_of,multipleOf:nt.value,message:nt.message}),tt.dirty()):nt.kind==="finite"?Number.isFinite($.data)||(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.not_finite,message:nt.message}),tt.dirty()):util.assertNever(nt);return{status:tt.value,value:$.data}}gte($,_e){return this.setLimit("min",$,!0,errorUtil.toString(_e))}gt($,_e){return this.setLimit("min",$,!1,errorUtil.toString(_e))}lte($,_e){return this.setLimit("max",$,!0,errorUtil.toString(_e))}lt($,_e){return this.setLimit("max",$,!1,errorUtil.toString(_e))}setLimit($,_e,et,tt){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:$,value:_e,inclusive:et,message:errorUtil.toString(tt)}]})}_addCheck($){return new ZodNumber({...this._def,checks:[...this._def.checks,$]})}int($){return this._addCheck({kind:"int",message:errorUtil.toString($)})}positive($){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString($)})}negative($){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString($)})}multipleOf($,_e){return this._addCheck({kind:"multipleOf",value:$,message:errorUtil.toString(_e)})}finite($){return this._addCheck({kind:"finite",message:errorUtil.toString($)})}safe($){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString($)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString($)})}get minValue(){let $=null;for(const _e of this._def.checks)_e.kind==="min"&&($===null||_e.value>$)&&($=_e.value);return $}get maxValue(){let $=null;for(const _e of this._def.checks)_e.kind==="max"&&($===null||_e.value<$)&&($=_e.value);return $}get isInt(){return!!this._def.checks.find($=>$.kind==="int"||$.kind==="multipleOf"&&util.isInteger($.value))}get isFinite(){let $=null,_e=null;for(const et of this._def.checks){if(et.kind==="finite"||et.kind==="int"||et.kind==="multipleOf")return!0;et.kind==="min"?(_e===null||et.value>_e)&&(_e=et.value):et.kind==="max"&&($===null||et.value<$)&&($=et.value)}return Number.isFinite(_e)&&Number.isFinite($)}}ZodNumber.create=j=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(j==null?void 0:j.coerce)||!1,...processCreateParams(j)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse($){if(this._def.coerce)try{$.data=BigInt($.data)}catch{return this._getInvalidInput($)}if(this._getType($)!==ZodParsedType.bigint)return this._getInvalidInput($);let et;const tt=new ParseStatus;for(const nt of this._def.checks)nt.kind==="min"?(nt.inclusive?$.data<nt.value:$.data<=nt.value)&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.too_small,type:"bigint",minimum:nt.value,inclusive:nt.inclusive,message:nt.message}),tt.dirty()):nt.kind==="max"?(nt.inclusive?$.data>nt.value:$.data>=nt.value)&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.too_big,type:"bigint",maximum:nt.value,inclusive:nt.inclusive,message:nt.message}),tt.dirty()):nt.kind==="multipleOf"?$.data%nt.value!==BigInt(0)&&(et=this._getOrReturnCtx($,et),addIssueToContext(et,{code:ZodIssueCode.not_multiple_of,multipleOf:nt.value,message:nt.message}),tt.dirty()):util.assertNever(nt);return{status:tt.value,value:$.data}}_getInvalidInput($){const _e=this._getOrReturnCtx($);return addIssueToContext(_e,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:_e.parsedType}),INVALID}gte($,_e){return this.setLimit("min",$,!0,errorUtil.toString(_e))}gt($,_e){return this.setLimit("min",$,!1,errorUtil.toString(_e))}lte($,_e){return this.setLimit("max",$,!0,errorUtil.toString(_e))}lt($,_e){return this.setLimit("max",$,!1,errorUtil.toString(_e))}setLimit($,_e,et,tt){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:$,value:_e,inclusive:et,message:errorUtil.toString(tt)}]})}_addCheck($){return new ZodBigInt({...this._def,checks:[...this._def.checks,$]})}positive($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString($)})}negative($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString($)})}multipleOf($,_e){return this._addCheck({kind:"multipleOf",value:$,message:errorUtil.toString(_e)})}get minValue(){let $=null;for(const _e of this._def.checks)_e.kind==="min"&&($===null||_e.value>$)&&($=_e.value);return $}get maxValue(){let $=null;for(const _e of this._def.checks)_e.kind==="max"&&($===null||_e.value<$)&&($=_e.value);return $}}ZodBigInt.create=j=>new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(j==null?void 0:j.coerce)??!1,...processCreateParams(j)});class ZodBoolean extends ZodType{_parse($){if(this._def.coerce&&($.data=!!$.data),this._getType($)!==ZodParsedType.boolean){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:et.parsedType}),INVALID}return OK($.data)}}ZodBoolean.create=j=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(j==null?void 0:j.coerce)||!1,...processCreateParams(j)});class ZodDate extends ZodType{_parse($){if(this._def.coerce&&($.data=new Date($.data)),this._getType($)!==ZodParsedType.date){const nt=this._getOrReturnCtx($);return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:nt.parsedType}),INVALID}if(Number.isNaN($.data.getTime())){const nt=this._getOrReturnCtx($);return addIssueToContext(nt,{code:ZodIssueCode.invalid_date}),INVALID}const et=new ParseStatus;let tt;for(const nt of this._def.checks)nt.kind==="min"?$.data.getTime()<nt.value&&(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.too_small,message:nt.message,inclusive:!0,exact:!1,minimum:nt.value,type:"date"}),et.dirty()):nt.kind==="max"?$.data.getTime()>nt.value&&(tt=this._getOrReturnCtx($,tt),addIssueToContext(tt,{code:ZodIssueCode.too_big,message:nt.message,inclusive:!0,exact:!1,maximum:nt.value,type:"date"}),et.dirty()):util.assertNever(nt);return{status:et.value,value:new Date($.data.getTime())}}_addCheck($){return new ZodDate({...this._def,checks:[...this._def.checks,$]})}min($,_e){return this._addCheck({kind:"min",value:$.getTime(),message:errorUtil.toString(_e)})}max($,_e){return this._addCheck({kind:"max",value:$.getTime(),message:errorUtil.toString(_e)})}get minDate(){let $=null;for(const _e of this._def.checks)_e.kind==="min"&&($===null||_e.value>$)&&($=_e.value);return $!=null?new Date($):null}get maxDate(){let $=null;for(const _e of this._def.checks)_e.kind==="max"&&($===null||_e.value<$)&&($=_e.value);return $!=null?new Date($):null}}ZodDate.create=j=>new ZodDate({checks:[],coerce:(j==null?void 0:j.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(j)});class ZodSymbol extends ZodType{_parse($){if(this._getType($)!==ZodParsedType.symbol){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:et.parsedType}),INVALID}return OK($.data)}}ZodSymbol.create=j=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(j)});class ZodUndefined extends ZodType{_parse($){if(this._getType($)!==ZodParsedType.undefined){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:et.parsedType}),INVALID}return OK($.data)}}ZodUndefined.create=j=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(j)});class ZodNull extends ZodType{_parse($){if(this._getType($)!==ZodParsedType.null){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:et.parsedType}),INVALID}return OK($.data)}}ZodNull.create=j=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(j)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse($){return OK($.data)}}ZodAny.create=j=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(j)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse($){return OK($.data)}}ZodUnknown.create=j=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(j)});class ZodNever extends ZodType{_parse($){const _e=this._getOrReturnCtx($);return addIssueToContext(_e,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:_e.parsedType}),INVALID}}ZodNever.create=j=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(j)});class ZodVoid extends ZodType{_parse($){if(this._getType($)!==ZodParsedType.undefined){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:et.parsedType}),INVALID}return OK($.data)}}ZodVoid.create=j=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(j)});class ZodArray extends ZodType{_parse($){const{ctx:_e,status:et}=this._processInputParams($),tt=this._def;if(_e.parsedType!==ZodParsedType.array)return addIssueToContext(_e,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:_e.parsedType}),INVALID;if(tt.exactLength!==null){const rt=_e.data.length>tt.exactLength.value,it=_e.data.length<tt.exactLength.value;(rt||it)&&(addIssueToContext(_e,{code:rt?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:it?tt.exactLength.value:void 0,maximum:rt?tt.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:tt.exactLength.message}),et.dirty())}if(tt.minLength!==null&&_e.data.length<tt.minLength.value&&(addIssueToContext(_e,{code:ZodIssueCode.too_small,minimum:tt.minLength.value,type:"array",inclusive:!0,exact:!1,message:tt.minLength.message}),et.dirty()),tt.maxLength!==null&&_e.data.length>tt.maxLength.value&&(addIssueToContext(_e,{code:ZodIssueCode.too_big,maximum:tt.maxLength.value,type:"array",inclusive:!0,exact:!1,message:tt.maxLength.message}),et.dirty()),_e.common.async)return Promise.all([..._e.data].map((rt,it)=>tt.type._parseAsync(new ParseInputLazyPath(_e,rt,_e.path,it)))).then(rt=>ParseStatus.mergeArray(et,rt));const nt=[..._e.data].map((rt,it)=>tt.type._parseSync(new ParseInputLazyPath(_e,rt,_e.path,it)));return ParseStatus.mergeArray(et,nt)}get element(){return this._def.type}min($,_e){return new ZodArray({...this._def,minLength:{value:$,message:errorUtil.toString(_e)}})}max($,_e){return new ZodArray({...this._def,maxLength:{value:$,message:errorUtil.toString(_e)}})}length($,_e){return new ZodArray({...this._def,exactLength:{value:$,message:errorUtil.toString(_e)}})}nonempty($){return this.min(1,$)}}ZodArray.create=(j,$)=>new ZodArray({type:j,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams($)});function deepPartialify(j){if(j instanceof ZodObject){const $={};for(const _e in j.shape){const et=j.shape[_e];$[_e]=ZodOptional.create(deepPartialify(et))}return new ZodObject({...j._def,shape:()=>$})}else return j instanceof ZodArray?new ZodArray({...j._def,type:deepPartialify(j.element)}):j instanceof ZodOptional?ZodOptional.create(deepPartialify(j.unwrap())):j instanceof ZodNullable?ZodNullable.create(deepPartialify(j.unwrap())):j instanceof ZodTuple?ZodTuple.create(j.items.map($=>deepPartialify($))):j}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const $=this._def.shape(),_e=util.objectKeys($);return this._cached={shape:$,keys:_e},this._cached}_parse($){if(this._getType($)!==ZodParsedType.object){const at=this._getOrReturnCtx($);return addIssueToContext(at,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:at.parsedType}),INVALID}const{status:et,ctx:tt}=this._processInputParams($),{shape:nt,keys:rt}=this._getCached(),it=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const at in tt.data)rt.includes(at)||it.push(at);const st=[];for(const at of rt){const ot=nt[at],ct=tt.data[at];st.push({key:{status:"valid",value:at},value:ot._parse(new ParseInputLazyPath(tt,ct,tt.path,at)),alwaysSet:at in tt.data})}if(this._def.catchall instanceof ZodNever){const at=this._def.unknownKeys;if(at==="passthrough")for(const ot of it)st.push({key:{status:"valid",value:ot},value:{status:"valid",value:tt.data[ot]}});else if(at==="strict")it.length>0&&(addIssueToContext(tt,{code:ZodIssueCode.unrecognized_keys,keys:it}),et.dirty());else if(at!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const at=this._def.catchall;for(const ot of it){const ct=tt.data[ot];st.push({key:{status:"valid",value:ot},value:at._parse(new ParseInputLazyPath(tt,ct,tt.path,ot)),alwaysSet:ot in tt.data})}}return tt.common.async?Promise.resolve().then(async()=>{const at=[];for(const ot of st){const ct=await ot.key,lt=await ot.value;at.push({key:ct,value:lt,alwaysSet:ot.alwaysSet})}return at}).then(at=>ParseStatus.mergeObjectSync(et,at)):ParseStatus.mergeObjectSync(et,st)}get shape(){return this._def.shape()}strict($){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...$!==void 0?{errorMap:(_e,et)=>{var nt,rt;const tt=((rt=(nt=this._def).errorMap)==null?void 0:rt.call(nt,_e,et).message)??et.defaultError;return _e.code==="unrecognized_keys"?{message:errorUtil.errToObj($).message??tt}:{message:tt}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend($){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...$})})}merge($){return new ZodObject({unknownKeys:$._def.unknownKeys,catchall:$._def.catchall,shape:()=>({...this._def.shape(),...$._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey($,_e){return this.augment({[$]:_e})}catchall($){return new ZodObject({...this._def,catchall:$})}pick($){const _e={};for(const et of util.objectKeys($))$[et]&&this.shape[et]&&(_e[et]=this.shape[et]);return new ZodObject({...this._def,shape:()=>_e})}omit($){const _e={};for(const et of util.objectKeys(this.shape))$[et]||(_e[et]=this.shape[et]);return new ZodObject({...this._def,shape:()=>_e})}deepPartial(){return deepPartialify(this)}partial($){const _e={};for(const et of util.objectKeys(this.shape)){const tt=this.shape[et];$&&!$[et]?_e[et]=tt:_e[et]=tt.optional()}return new ZodObject({...this._def,shape:()=>_e})}required($){const _e={};for(const et of util.objectKeys(this.shape))if($&&!$[et])_e[et]=this.shape[et];else{let nt=this.shape[et];for(;nt instanceof ZodOptional;)nt=nt._def.innerType;_e[et]=nt}return new ZodObject({...this._def,shape:()=>_e})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(j,$)=>new ZodObject({shape:()=>j,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams($)});ZodObject.strictCreate=(j,$)=>new ZodObject({shape:()=>j,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams($)});ZodObject.lazycreate=(j,$)=>new ZodObject({shape:j,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams($)});class ZodUnion extends ZodType{_parse($){const{ctx:_e}=this._processInputParams($),et=this._def.options;function tt(nt){for(const it of nt)if(it.result.status==="valid")return it.result;for(const it of nt)if(it.result.status==="dirty")return _e.common.issues.push(...it.ctx.common.issues),it.result;const rt=nt.map(it=>new ZodError(it.ctx.common.issues));return addIssueToContext(_e,{code:ZodIssueCode.invalid_union,unionErrors:rt}),INVALID}if(_e.common.async)return Promise.all(et.map(async nt=>{const rt={..._e,common:{..._e.common,issues:[]},parent:null};return{result:await nt._parseAsync({data:_e.data,path:_e.path,parent:rt}),ctx:rt}})).then(tt);{let nt;const rt=[];for(const st of et){const at={..._e,common:{..._e.common,issues:[]},parent:null},ot=st._parseSync({data:_e.data,path:_e.path,parent:at});if(ot.status==="valid")return ot;ot.status==="dirty"&&!nt&&(nt={result:ot,ctx:at}),at.common.issues.length&&rt.push(at.common.issues)}if(nt)return _e.common.issues.push(...nt.ctx.common.issues),nt.result;const it=rt.map(st=>new ZodError(st));return addIssueToContext(_e,{code:ZodIssueCode.invalid_union,unionErrors:it}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(j,$)=>new ZodUnion({options:j,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams($)});const getDiscriminator=j=>j instanceof ZodLazy?getDiscriminator(j.schema):j instanceof ZodEffects?getDiscriminator(j.innerType()):j instanceof ZodLiteral?[j.value]:j instanceof ZodEnum?j.options:j instanceof ZodNativeEnum?util.objectValues(j.enum):j instanceof ZodDefault?getDiscriminator(j._def.innerType):j instanceof ZodUndefined?[void 0]:j instanceof ZodNull?[null]:j instanceof ZodOptional?[void 0,...getDiscriminator(j.unwrap())]:j instanceof ZodNullable?[null,...getDiscriminator(j.unwrap())]:j instanceof ZodBranded||j instanceof ZodReadonly?getDiscriminator(j.unwrap()):j instanceof ZodCatch?getDiscriminator(j._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse($){const{ctx:_e}=this._processInputParams($);if(_e.parsedType!==ZodParsedType.object)return addIssueToContext(_e,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:_e.parsedType}),INVALID;const et=this.discriminator,tt=_e.data[et],nt=this.optionsMap.get(tt);return nt?_e.common.async?nt._parseAsync({data:_e.data,path:_e.path,parent:_e}):nt._parseSync({data:_e.data,path:_e.path,parent:_e}):(addIssueToContext(_e,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[et]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create($,_e,et){const tt=new Map;for(const nt of _e){const rt=getDiscriminator(nt.shape[$]);if(!rt.length)throw new Error(`A discriminator value for key \`${$}\` could not be extracted from all schema options`);for(const it of rt){if(tt.has(it))throw new Error(`Discriminator property ${String($)} has duplicate value ${String(it)}`);tt.set(it,nt)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:$,options:_e,optionsMap:tt,...processCreateParams(et)})}}function mergeValues(j,$){const _e=getParsedType(j),et=getParsedType($);if(j===$)return{valid:!0,data:j};if(_e===ZodParsedType.object&&et===ZodParsedType.object){const tt=util.objectKeys($),nt=util.objectKeys(j).filter(it=>tt.indexOf(it)!==-1),rt={...j,...$};for(const it of nt){const st=mergeValues(j[it],$[it]);if(!st.valid)return{valid:!1};rt[it]=st.data}return{valid:!0,data:rt}}else if(_e===ZodParsedType.array&&et===ZodParsedType.array){if(j.length!==$.length)return{valid:!1};const tt=[];for(let nt=0;nt<j.length;nt++){const rt=j[nt],it=$[nt],st=mergeValues(rt,it);if(!st.valid)return{valid:!1};tt.push(st.data)}return{valid:!0,data:tt}}else return _e===ZodParsedType.date&&et===ZodParsedType.date&&+j==+$?{valid:!0,data:j}:{valid:!1}}class ZodIntersection extends ZodType{_parse($){const{status:_e,ctx:et}=this._processInputParams($),tt=(nt,rt)=>{if(isAborted(nt)||isAborted(rt))return INVALID;const it=mergeValues(nt.value,rt.value);return it.valid?((isDirty(nt)||isDirty(rt))&&_e.dirty(),{status:_e.value,value:it.data}):(addIssueToContext(et,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return et.common.async?Promise.all([this._def.left._parseAsync({data:et.data,path:et.path,parent:et}),this._def.right._parseAsync({data:et.data,path:et.path,parent:et})]).then(([nt,rt])=>tt(nt,rt)):tt(this._def.left._parseSync({data:et.data,path:et.path,parent:et}),this._def.right._parseSync({data:et.data,path:et.path,parent:et}))}}ZodIntersection.create=(j,$,_e)=>new ZodIntersection({left:j,right:$,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(_e)});class ZodTuple extends ZodType{_parse($){const{status:_e,ctx:et}=this._processInputParams($);if(et.parsedType!==ZodParsedType.array)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:et.parsedType}),INVALID;if(et.data.length<this._def.items.length)return addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&et.data.length>this._def.items.length&&(addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e.dirty());const nt=[...et.data].map((rt,it)=>{const st=this._def.items[it]||this._def.rest;return st?st._parse(new ParseInputLazyPath(et,rt,et.path,it)):null}).filter(rt=>!!rt);return et.common.async?Promise.all(nt).then(rt=>ParseStatus.mergeArray(_e,rt)):ParseStatus.mergeArray(_e,nt)}get items(){return this._def.items}rest($){return new ZodTuple({...this._def,rest:$})}}ZodTuple.create=(j,$)=>{if(!Array.isArray(j))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:j,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams($)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){const{status:_e,ctx:et}=this._processInputParams($);if(et.parsedType!==ZodParsedType.object)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:et.parsedType}),INVALID;const tt=[],nt=this._def.keyType,rt=this._def.valueType;for(const it in et.data)tt.push({key:nt._parse(new ParseInputLazyPath(et,it,et.path,it)),value:rt._parse(new ParseInputLazyPath(et,et.data[it],et.path,it)),alwaysSet:it in et.data});return et.common.async?ParseStatus.mergeObjectAsync(_e,tt):ParseStatus.mergeObjectSync(_e,tt)}get element(){return this._def.valueType}static create($,_e,et){return _e instanceof ZodType?new ZodRecord({keyType:$,valueType:_e,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(et)}):new ZodRecord({keyType:ZodString.create(),valueType:$,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(_e)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){const{status:_e,ctx:et}=this._processInputParams($);if(et.parsedType!==ZodParsedType.map)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:et.parsedType}),INVALID;const tt=this._def.keyType,nt=this._def.valueType,rt=[...et.data.entries()].map(([it,st],at)=>({key:tt._parse(new ParseInputLazyPath(et,it,et.path,[at,"key"])),value:nt._parse(new ParseInputLazyPath(et,st,et.path,[at,"value"]))}));if(et.common.async){const it=new Map;return Promise.resolve().then(async()=>{for(const st of rt){const at=await st.key,ot=await st.value;if(at.status==="aborted"||ot.status==="aborted")return INVALID;(at.status==="dirty"||ot.status==="dirty")&&_e.dirty(),it.set(at.value,ot.value)}return{status:_e.value,value:it}})}else{const it=new Map;for(const st of rt){const at=st.key,ot=st.value;if(at.status==="aborted"||ot.status==="aborted")return INVALID;(at.status==="dirty"||ot.status==="dirty")&&_e.dirty(),it.set(at.value,ot.value)}return{status:_e.value,value:it}}}}ZodMap.create=(j,$,_e)=>new ZodMap({valueType:$,keyType:j,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(_e)});class ZodSet extends ZodType{_parse($){const{status:_e,ctx:et}=this._processInputParams($);if(et.parsedType!==ZodParsedType.set)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:et.parsedType}),INVALID;const tt=this._def;tt.minSize!==null&&et.data.size<tt.minSize.value&&(addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:tt.minSize.value,type:"set",inclusive:!0,exact:!1,message:tt.minSize.message}),_e.dirty()),tt.maxSize!==null&&et.data.size>tt.maxSize.value&&(addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:tt.maxSize.value,type:"set",inclusive:!0,exact:!1,message:tt.maxSize.message}),_e.dirty());const nt=this._def.valueType;function rt(st){const at=new Set;for(const ot of st){if(ot.status==="aborted")return INVALID;ot.status==="dirty"&&_e.dirty(),at.add(ot.value)}return{status:_e.value,value:at}}const it=[...et.data.values()].map((st,at)=>nt._parse(new ParseInputLazyPath(et,st,et.path,at)));return et.common.async?Promise.all(it).then(st=>rt(st)):rt(it)}min($,_e){return new ZodSet({...this._def,minSize:{value:$,message:errorUtil.toString(_e)}})}max($,_e){return new ZodSet({...this._def,maxSize:{value:$,message:errorUtil.toString(_e)}})}size($,_e){return this.min($,_e).max($,_e)}nonempty($){return this.min(1,$)}}ZodSet.create=(j,$)=>new ZodSet({valueType:j,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams($)});class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse($){const{ctx:_e}=this._processInputParams($);return this._def.getter()._parse({data:_e.data,path:_e.path,parent:_e})}}ZodLazy.create=(j,$)=>new ZodLazy({getter:j,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams($)});class ZodLiteral extends ZodType{_parse($){if($.data!==this._def.value){const _e=this._getOrReturnCtx($);return addIssueToContext(_e,{received:_e.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:$.data}}get value(){return this._def.value}}ZodLiteral.create=(j,$)=>new ZodLiteral({value:j,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams($)});function createZodEnum(j,$){return new ZodEnum({values:j,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams($)})}class ZodEnum extends ZodType{_parse($){if(typeof $.data!="string"){const _e=this._getOrReturnCtx($),et=this._def.values;return addIssueToContext(_e,{expected:util.joinValues(et),received:_e.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has($.data)){const _e=this._getOrReturnCtx($),et=this._def.values;return addIssueToContext(_e,{received:_e.data,code:ZodIssueCode.invalid_enum_value,options:et}),INVALID}return OK($.data)}get options(){return this._def.values}get enum(){const $={};for(const _e of this._def.values)$[_e]=_e;return $}get Values(){const $={};for(const _e of this._def.values)$[_e]=_e;return $}get Enum(){const $={};for(const _e of this._def.values)$[_e]=_e;return $}extract($,_e=this._def){return ZodEnum.create($,{...this._def,..._e})}exclude($,_e=this._def){return ZodEnum.create(this.options.filter(et=>!$.includes(et)),{...this._def,..._e})}}ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{_parse($){const _e=util.getValidEnumValues(this._def.values),et=this._getOrReturnCtx($);if(et.parsedType!==ZodParsedType.string&&et.parsedType!==ZodParsedType.number){const tt=util.objectValues(_e);return addIssueToContext(et,{expected:util.joinValues(tt),received:et.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(this._cache||(this._cache=new Set(util.getValidEnumValues(this._def.values))),!this._cache.has($.data)){const tt=util.objectValues(_e);return addIssueToContext(et,{received:et.data,code:ZodIssueCode.invalid_enum_value,options:tt}),INVALID}return OK($.data)}get enum(){return this._def.values}}ZodNativeEnum.create=(j,$)=>new ZodNativeEnum({values:j,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams($)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse($){const{ctx:_e}=this._processInputParams($);if(_e.parsedType!==ZodParsedType.promise&&_e.common.async===!1)return addIssueToContext(_e,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:_e.parsedType}),INVALID;const et=_e.parsedType===ZodParsedType.promise?_e.data:Promise.resolve(_e.data);return OK(et.then(tt=>this._def.type.parseAsync(tt,{path:_e.path,errorMap:_e.common.contextualErrorMap})))}}ZodPromise.create=(j,$)=>new ZodPromise({type:j,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams($)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse($){const{status:_e,ctx:et}=this._processInputParams($),tt=this._def.effect||null,nt={addIssue:rt=>{addIssueToContext(et,rt),rt.fatal?_e.abort():_e.dirty()},get path(){return et.path}};if(nt.addIssue=nt.addIssue.bind(nt),tt.type==="preprocess"){const rt=tt.transform(et.data,nt);if(et.common.async)return Promise.resolve(rt).then(async it=>{if(_e.value==="aborted")return INVALID;const st=await this._def.schema._parseAsync({data:it,path:et.path,parent:et});return st.status==="aborted"?INVALID:st.status==="dirty"||_e.value==="dirty"?DIRTY(st.value):st});{if(_e.value==="aborted")return INVALID;const it=this._def.schema._parseSync({data:rt,path:et.path,parent:et});return it.status==="aborted"?INVALID:it.status==="dirty"||_e.value==="dirty"?DIRTY(it.value):it}}if(tt.type==="refinement"){const rt=it=>{const st=tt.refinement(it,nt);if(et.common.async)return Promise.resolve(st);if(st instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return it};if(et.common.async===!1){const it=this._def.schema._parseSync({data:et.data,path:et.path,parent:et});return it.status==="aborted"?INVALID:(it.status==="dirty"&&_e.dirty(),rt(it.value),{status:_e.value,value:it.value})}else return this._def.schema._parseAsync({data:et.data,path:et.path,parent:et}).then(it=>it.status==="aborted"?INVALID:(it.status==="dirty"&&_e.dirty(),rt(it.value).then(()=>({status:_e.value,value:it.value}))))}if(tt.type==="transform")if(et.common.async===!1){const rt=this._def.schema._parseSync({data:et.data,path:et.path,parent:et});if(!isValid(rt))return INVALID;const it=tt.transform(rt.value,nt);if(it instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:_e.value,value:it}}else return this._def.schema._parseAsync({data:et.data,path:et.path,parent:et}).then(rt=>isValid(rt)?Promise.resolve(tt.transform(rt.value,nt)).then(it=>({status:_e.value,value:it})):INVALID);util.assertNever(tt)}}ZodEffects.create=(j,$,_e)=>new ZodEffects({schema:j,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:$,...processCreateParams(_e)});ZodEffects.createWithPreprocess=(j,$,_e)=>new ZodEffects({schema:$,effect:{type:"preprocess",transform:j},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(_e)});class ZodOptional extends ZodType{_parse($){return this._getType($)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse($)}unwrap(){return this._def.innerType}}ZodOptional.create=(j,$)=>new ZodOptional({innerType:j,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams($)});class ZodNullable extends ZodType{_parse($){return this._getType($)===ZodParsedType.null?OK(null):this._def.innerType._parse($)}unwrap(){return this._def.innerType}}ZodNullable.create=(j,$)=>new ZodNullable({innerType:j,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams($)});class ZodDefault extends ZodType{_parse($){const{ctx:_e}=this._processInputParams($);let et=_e.data;return _e.parsedType===ZodParsedType.undefined&&(et=this._def.defaultValue()),this._def.innerType._parse({data:et,path:_e.path,parent:_e})}removeDefault(){return this._def.innerType}}ZodDefault.create=(j,$)=>new ZodDefault({innerType:j,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof $.default=="function"?$.default:()=>$.default,...processCreateParams($)});class ZodCatch extends ZodType{_parse($){const{ctx:_e}=this._processInputParams($),et={..._e,common:{..._e.common,issues:[]}},tt=this._def.innerType._parse({data:et.data,path:et.path,parent:{...et}});return isAsync(tt)?tt.then(nt=>({status:"valid",value:nt.status==="valid"?nt.value:this._def.catchValue({get error(){return new ZodError(et.common.issues)},input:et.data})})):{status:"valid",value:tt.status==="valid"?tt.value:this._def.catchValue({get error(){return new ZodError(et.common.issues)},input:et.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(j,$)=>new ZodCatch({innerType:j,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof $.catch=="function"?$.catch:()=>$.catch,...processCreateParams($)});class ZodNaN extends ZodType{_parse($){if(this._getType($)!==ZodParsedType.nan){const et=this._getOrReturnCtx($);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:et.parsedType}),INVALID}return{status:"valid",value:$.data}}}ZodNaN.create=j=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(j)});class ZodBranded extends ZodType{_parse($){const{ctx:_e}=this._processInputParams($),et=_e.data;return this._def.type._parse({data:et,path:_e.path,parent:_e})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse($){const{status:_e,ctx:et}=this._processInputParams($);if(et.common.async)return(async()=>{const nt=await this._def.in._parseAsync({data:et.data,path:et.path,parent:et});return nt.status==="aborted"?INVALID:nt.status==="dirty"?(_e.dirty(),DIRTY(nt.value)):this._def.out._parseAsync({data:nt.value,path:et.path,parent:et})})();{const tt=this._def.in._parseSync({data:et.data,path:et.path,parent:et});return tt.status==="aborted"?INVALID:tt.status==="dirty"?(_e.dirty(),{status:"dirty",value:tt.value}):this._def.out._parseSync({data:tt.value,path:et.path,parent:et})}}static create($,_e){return new ZodPipeline({in:$,out:_e,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse($){const _e=this._def.innerType._parse($),et=tt=>(isValid(tt)&&(tt.value=Object.freeze(tt.value)),tt);return isAsync(_e)?_e.then(tt=>et(tt)):et(_e)}unwrap(){return this._def.innerType}}ZodReadonly.create=(j,$)=>new ZodReadonly({innerType:j,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams($)});var ZodFirstPartyTypeKind;(function(j){j.ZodString="ZodString",j.ZodNumber="ZodNumber",j.ZodNaN="ZodNaN",j.ZodBigInt="ZodBigInt",j.ZodBoolean="ZodBoolean",j.ZodDate="ZodDate",j.ZodSymbol="ZodSymbol",j.ZodUndefined="ZodUndefined",j.ZodNull="ZodNull",j.ZodAny="ZodAny",j.ZodUnknown="ZodUnknown",j.ZodNever="ZodNever",j.ZodVoid="ZodVoid",j.ZodArray="ZodArray",j.ZodObject="ZodObject",j.ZodUnion="ZodUnion",j.ZodDiscriminatedUnion="ZodDiscriminatedUnion",j.ZodIntersection="ZodIntersection",j.ZodTuple="ZodTuple",j.ZodRecord="ZodRecord",j.ZodMap="ZodMap",j.ZodSet="ZodSet",j.ZodFunction="ZodFunction",j.ZodLazy="ZodLazy",j.ZodLiteral="ZodLiteral",j.ZodEnum="ZodEnum",j.ZodEffects="ZodEffects",j.ZodNativeEnum="ZodNativeEnum",j.ZodOptional="ZodOptional",j.ZodNullable="ZodNullable",j.ZodDefault="ZodDefault",j.ZodCatch="ZodCatch",j.ZodPromise="ZodPromise",j.ZodBranded="ZodBranded",j.ZodPipeline="ZodPipeline",j.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const stringType=ZodString.create,numberType=ZodNumber.create,booleanType=ZodBoolean.create,anyType=ZodAny.create;ZodNever.create;const arrayType=ZodArray.create,objectType=ZodObject.create,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create;ZodIntersection.create;ZodTuple.create;const recordType=ZodRecord.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create;ZodPromise.create;ZodOptional.create;ZodNullable.create;objectType({name:stringType(),description:stringType().optional(),inputSchema:objectType({type:literalType("object"),properties:recordType(stringType(),anyType()),required:arrayType(stringType()),additionalProperties:booleanType()})});async function getAllMcpFunctionTools(j,$=!1){const _e=[],et=new Set;for(const tt of j){const nt=await getFunctionToolsFromServer(tt,$),it=[...new Set(nt.map(st=>st.name))].filter(st=>et.has(st));if(it.length>0)throw new UserError(`Duplicate tool names found across MCP servers: ${it.join(", ")}`);for(const st of nt)et.add(st.name),_e.push(st)}return _e}const _cachedTools={};async function getFunctionToolsFromServer(j,$){return j.cacheToolsList&&_cachedTools[j.name]?_cachedTools[j.name]:withMCPListToolsSpan(async _e=>{const et=await j.listTools();_e.spanData.result=et.map(nt=>nt.name);const tt=et.map(nt=>mcpToFunctionTool(nt,j,$));return j.cacheToolsList&&(_cachedTools[j.name]=tt),tt},{data:{server:j.name}})}async function getAllMcpTools(j,$=!1){return getAllMcpFunctionTools(j,$)}function mcpToFunctionTool(j,$,_e){var rt,it,st,at;async function et(ot,ct){let lt={};typeof ot=="string"&&ot?lt=JSON.parse(ot):typeof ot=="object"&&ot!=null&&(lt=ot);const ut=getCurrentSpan();ut&&(ut.spanData.mcp_data={server:$.name});const pt=await $.callTool(j.name,lt);return pt.length===1?pt[0]:pt}const tt={type:((rt=j.inputSchema)==null?void 0:rt.type)??"object",properties:((it=j.inputSchema)==null?void 0:it.properties)??{},required:((st=j.inputSchema)==null?void 0:st.required)??[],additionalProperties:((at=j.inputSchema)==null?void 0:at.additionalProperties)??!1};if(_e||tt.additionalProperties===!0)try{const ot=ensureStrictJsonSchema(tt);return tool({name:j.name,description:j.description||"",parameters:ot,strict:!0,execute:et})}catch(ot){logger$1.warn(`Error converting MCP schema to strict mode: ${ot}`)}const nt={...tt,additionalProperties:!0};return tool({name:j.name,description:j.description||"",parameters:nt,strict:!1,execute:et})}function ensureStrictJsonSchema(j){const $={...j,additionalProperties:!1};return $.required||($.required=[]),$}function loadEnv(){return{}}var Ms;class BrowserEventEmitter{constructor(){zt(this,Ms,new EventTarget)}on($,_e){return bt(this,Ms).addEventListener($,et=>_e(...et.detail??[])),this}off($,_e){return bt(this,Ms).removeEventListener($,et=>_e(...et.detail??[])),this}emit($,..._e){const et=new CustomEvent($,{detail:_e});return bt(this,Ms).dispatchEvent(et)}once($,_e){const et=(...tt)=>{this.off($,et),_e(...tt)};return this.on($,et),this}}Ms=new WeakMap;const randomUUID=crypto.randomUUID.bind(crypto),Readable=class{constructor(){}pipeTo($,_e){}pipeThrough($,_e){}},ReadableStream$1=globalThis.ReadableStream,TransformStream=globalThis.TransformStream;class AsyncLocalStorage{constructor(){Wt(this,"context",null)}run($,_e){return this.context=$,_e()}getStore(){return this.context}enterWith($){this.context=$}}class BrowserTimer{constructor(){}setTimeout($,_e){const et=setTimeout($,_e);return et.ref=typeof et.ref=="function"?et.ref:()=>et,et.unref=typeof et.unref=="function"?et.unref:()=>et,et.hasRef=typeof et.hasRef=="function"?et.hasRef:()=>!0,et.refresh=typeof et.refresh=="function"?et.refresh:()=>et,et}clearTimeout($){window.clearTimeout($)}}const timer=new BrowserTimer;let _contextAsyncLocalStorage;function getContextAsyncLocalStorage(){return _contextAsyncLocalStorage??(_contextAsyncLocalStorage=new AsyncLocalStorage),_contextAsyncLocalStorage}function getCurrentTrace(){const j=getContextAsyncLocalStorage().getStore();return j!=null&&j.trace?j.trace:null}function getCurrentSpan(){const j=getContextAsyncLocalStorage().getStore();return j!=null&&j.span?j.span:null}function _wrapFunctionWithTraceLifecycle(j){return async()=>{const $=getCurrentTrace();if(!$)throw new Error("No trace found");await $.start();const _e=await j($);return await $.end(),_e}}async function withTrace(j,$,_e={}){const et=typeof j=="string"?getGlobalTraceProvider().createTrace({..._e,name:j}):j;return getContextAsyncLocalStorage().run({trace:et},_wrapFunctionWithTraceLifecycle($))}async function getOrCreateTrace(j,$={}){if(getCurrentTrace())return await j();const et=getGlobalTraceProvider().createTrace($);return getContextAsyncLocalStorage().run({trace:et},_wrapFunctionWithTraceLifecycle(j))}function setCurrentSpan(j){const $=getContextAsyncLocalStorage().getStore();if(!$)throw new Error("No existing trace found");$.span&&($.span.previousSpan=$.previousSpan,$.previousSpan=$.span),$.span=j,getContextAsyncLocalStorage().enterWith($)}function resetCurrentSpan(){var $;const j=getContextAsyncLocalStorage().getStore();j&&(j.span=j.previousSpan,j.previousSpan=($=j.previousSpan)==null?void 0:$.previousSpan,getContextAsyncLocalStorage().enterWith(j))}function addErrorToCurrentSpan(j){const $=getCurrentSpan();$&&$.setError(j)}function cloneCurrentContext(j){var $,_e,et;return{trace:($=j.trace)==null?void 0:$.clone(),span:(_e=j.span)==null?void 0:_e.clone(),previousSpan:(et=j.previousSpan)==null?void 0:et.clone()}}function withNewSpanContext(j){const $=getContextAsyncLocalStorage().getStore();if(!$)throw new Error("No existing trace found");const _e=cloneCurrentContext($);return getContextAsyncLocalStorage().run(_e,j)}class ConsoleSpanExporter{async export($){if(tracing.disabled){logger$1.debug("Tracing is disabled. Skipping export");return}for(const _e of $)_e.type==="trace"?console.log(`[Exporter] Export trace traceId=${_e.traceId} name=${_e.name}`):console.log(`[Exporter] Export span: ${JSON.stringify(_e)}`)}}var go,Ls,yo,vo,Fs,nr,Ir,Hr,Gr,Bs,cr,_c,yl,bs;class BatchTraceProcessor{constructor($,{maxQueueSize:_e=1e3,maxBatchSize:et=100,scheduleDelay:tt=5e3,exportTriggerRatio:nt=.8}={}){zt(this,cr);zt(this,go);zt(this,Ls);zt(this,yo);zt(this,vo);zt(this,Fs);zt(this,nr,[]);zt(this,Ir);zt(this,Hr,null);zt(this,Gr,!1);zt(this,Bs,null);Dt(this,go,_e),Dt(this,Ls,et),Dt(this,yo,tt),Dt(this,vo,_e*nt),Dt(this,Fs,$),Dt(this,Ir,timer),logger$1.debug("Automatic trace export loop is not supported in this environment. You need to manually call `getGlobalTraceProvider().forceFlush()` to export traces.")}start(){Dt(this,Bs,new AbortController),hn(this,cr,yl).call(this)}async onTraceStart($){await hn(this,cr,_c).call(this,$)}async onTraceEnd($){}async onSpanStart($){}async onSpanEnd($){await hn(this,cr,_c).call(this,$)}async shutdown($){var _e;for($&&bt(this,Ir).setTimeout(()=>{var et;(et=bt(this,Bs))==null||et.abort()},$),logger$1.debug("Shutting down gracefully");bt(this,nr).length>0;){if(logger$1.debug(`Waiting for buffer to empty. Items left: ${bt(this,nr).length}`),bt(this,Gr)||await hn(this,cr,bs).call(this,!0),(_e=bt(this,Bs))!=null&&_e.signal.aborted){logger$1.debug("Timeout reached, force flushing"),await hn(this,cr,bs).call(this,!0);break}await new Promise(et=>bt(this,Ir).setTimeout(et,500))}logger$1.debug("Buffer empty. Exiting"),bt(this,Ir)&&bt(this,Hr)&&bt(this,Ir).clearTimeout(bt(this,Hr))}async forceFlush(){bt(this,nr).length>0&&await hn(this,cr,bs).call(this,!0)}}go=new WeakMap,Ls=new WeakMap,yo=new WeakMap,vo=new WeakMap,Fs=new WeakMap,nr=new WeakMap,Ir=new WeakMap,Hr=new WeakMap,Gr=new WeakMap,Bs=new WeakMap,cr=new WeakSet,_c=async function($){if(bt(this,nr).length+1>bt(this,go)){logger$1.error("Dropping trace because buffer is full");return}bt(this,nr).push($),bt(this,nr).length>bt(this,vo)&&await hn(this,cr,bs).call(this)},yl=function(){Dt(this,Hr,bt(this,Ir).setTimeout(async()=>{await hn(this,cr,bs).call(this),hn(this,cr,yl).call(this)},bt(this,yo))),typeof bt(this,Hr).unref=="function"&&bt(this,Hr).unref()},bs=async function($=!1){if(bt(this,nr).length!==0){if(logger$1.debug(`Exporting batches. Force: ${$}. Buffer size: ${bt(this,nr).length}`),$||bt(this,nr).length<bt(this,Ls)){const _e=[...bt(this,nr)];Dt(this,nr,[]),Dt(this,Gr,!0),await bt(this,Fs).export(_e),Dt(this,Gr,!1)}else if(bt(this,nr).length>0){const _e=bt(this,nr).splice(0,bt(this,Ls));Dt(this,Gr,!0),await bt(this,Fs).export(_e),Dt(this,Gr,!1)}}};var dr;class MultiTracingProcessor{constructor(){zt(this,dr,[])}start(){for(const $ of bt(this,dr))$.start&&$.start()}addTraceProcessor($){bt(this,dr).push($)}setProcessors($){logger$1.debug("Shutting down old processors");for(const _e of bt(this,dr))_e.shutdown();Dt(this,dr,$)}async onTraceStart($){for(const _e of bt(this,dr))await _e.onTraceStart($)}async onTraceEnd($){for(const _e of bt(this,dr))await _e.onTraceEnd($)}async onSpanStart($){for(const _e of bt(this,dr))await _e.onSpanStart($)}async onSpanEnd($){for(const _e of bt(this,dr))await _e.onSpanEnd($)}async shutdown($){for(const _e of bt(this,dr))await _e.shutdown($)}async forceFlush(){for(const $ of bt(this,dr))await $.forceFlush()}}dr=new WeakMap;let _defaultExporter=null,_defaultProcessor=null;function defaultExporter(){return _defaultExporter||(_defaultExporter=new ConsoleSpanExporter),_defaultExporter}function defaultProcessor(){return _defaultProcessor||(_defaultProcessor=new BatchTraceProcessor(defaultExporter())),_defaultProcessor}function timeIso(){return new Date().toISOString()}function generateTraceId(){return`trace_${randomUUID().replace(/-/g,"")}`}function generateSpanId(){return`span_${randomUUID().replace(/-/g,"").slice(0,24)}`}function removePrivateFields(j){return Object.fromEntries(Object.entries(j).filter(([$])=>!$.startsWith("_")))}var xo,bo,So,Eo,ls,Zr,Yr,us,To;const Rl=class Rl{constructor($,_e){Wt(this,"type","trace.span");zt(this,xo);zt(this,bo);zt(this,So);zt(this,Eo);zt(this,ls);zt(this,Zr);zt(this,Yr);zt(this,us);zt(this,To);Dt(this,bo,$.traceId),Dt(this,So,$.spanId??generateSpanId()),Dt(this,xo,$.data),Dt(this,ls,_e),Dt(this,Eo,$.parentId??null),Dt(this,us,$.error??null),Dt(this,Zr,$.startedAt??null),Dt(this,Yr,$.endedAt??null)}get traceId(){return bt(this,bo)}get spanData(){return bt(this,xo)}get spanId(){return bt(this,So)}get parentId(){return bt(this,Eo)}get previousSpan(){return bt(this,To)}set previousSpan($){Dt(this,To,$)}start(){if(bt(this,Zr)){logger$1.warn("Span already started");return}Dt(this,Zr,timeIso()),bt(this,ls).onSpanStart(this)}end(){if(bt(this,Yr)){logger$1.debug("Span already finished",this.spanData);return}Dt(this,Yr,timeIso()),bt(this,ls).onSpanEnd(this)}setError($){Dt(this,us,$)}get error(){return bt(this,us)}get startedAt(){return bt(this,Zr)}get endedAt(){return bt(this,Yr)}clone(){var _e;const $=new Rl({traceId:this.traceId,spanId:this.spanId,parentId:this.parentId??void 0,data:this.spanData,startedAt:bt(this,Zr)??void 0,endedAt:bt(this,Yr)??void 0,error:bt(this,us)??void 0},bt(this,ls));return $.previousSpan=(_e=this.previousSpan)==null?void 0:_e.clone(),$}toJSON(){return{object:this.type,id:this.spanId,trace_id:this.traceId,parent_id:this.parentId,started_at:this.startedAt,ended_at:this.endedAt,span_data:removePrivateFields(this.spanData),error:this.error}}};xo=new WeakMap,bo=new WeakMap,So=new WeakMap,Eo=new WeakMap,ls=new WeakMap,Zr=new WeakMap,Yr=new WeakMap,us=new WeakMap,To=new WeakMap;let Span=Rl;class NoopSpan extends Span{constructor($,_e){super({traceId:"no-op",spanId:"no-op",data:$},_e)}start(){}end(){}setError(){}toJSON(){return null}}var Us,Nr;const _l=class _l{constructor($,_e){Wt(this,"type","trace");Wt(this,"traceId");Wt(this,"name");Wt(this,"groupId",null);Wt(this,"metadata");zt(this,Us);zt(this,Nr);this.traceId=$.traceId??generateTraceId(),this.name=$.name??"Agent workflow",this.groupId=$.groupId??null,this.metadata=$.metadata??{},Dt(this,Us,_e??defaultProcessor()),Dt(this,Nr,$.started??!1)}async start(){bt(this,Nr)||(Dt(this,Nr,!0),await bt(this,Us).onTraceStart(this))}async end(){bt(this,Nr)&&(Dt(this,Nr,!1),await bt(this,Us).onTraceEnd(this))}clone(){return new _l({traceId:this.traceId,name:this.name,groupId:this.groupId??void 0,metadata:this.metadata,started:bt(this,Nr)})}toJSON(){return{object:this.type,id:this.traceId,workflow_name:this.name,group_id:this.groupId,metadata:this.metadata}}};Us=new WeakMap,Nr=new WeakMap;let Trace=_l;class NoopTrace extends Trace{constructor(){super({})}async start(){}async end(){}toJSON(){return null}}var tr,ds,Vo,eu;class TraceProvider{constructor(){zt(this,Vo);zt(this,tr);zt(this,ds);Dt(this,tr,new MultiTracingProcessor),Dt(this,ds,tracing.disabled),hn(this,Vo,eu).call(this)}registerProcessor($){bt(this,tr).addTraceProcessor($)}setProcessors($){bt(this,tr).setProcessors($)}getCurrentTrace(){return getCurrentTrace()}getCurrentSpan(){return getCurrentSpan()}setDisabled($){Dt(this,ds,$)}startExportLoop(){bt(this,tr).start()}createTrace($){if(bt(this,ds))return logger$1.debug("Tracing is disabled, Not creating trace %o",$),new NoopTrace;const _e=$.traceId??generateTraceId(),et=$.name??"Agent workflow";return logger$1.debug("Creating trace %s with name %s",_e,et),new Trace({...$,name:et,traceId:_e},bt(this,tr))}createSpan($,_e){if(bt(this,ds)||$.disabled)return logger$1.debug("Tracing is disabled, Not creating span %o",$),new NoopSpan($.data,bt(this,tr));let et,tt;if(_e){if(_e instanceof Trace){if(_e instanceof NoopTrace)return logger$1.debug("Parent trace is no-op, returning NoopSpan"),new NoopSpan($.data,bt(this,tr));tt=_e.traceId}else if(_e instanceof Span){if(_e instanceof NoopSpan)return logger$1.debug("Parent span is no-op, returning NoopSpan"),new NoopSpan($.data,bt(this,tr));et=_e.spanId,tt=_e.traceId}}else{const nt=getCurrentTrace(),rt=getCurrentSpan();if(!nt)return logger$1.error("No active trace. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new NoopSpan($.data,bt(this,tr));if(rt instanceof NoopSpan||nt instanceof NoopTrace)return logger$1.debug(`Parent ${rt} or ${nt} is no-op, returning NoopSpan`),new NoopSpan($.data,bt(this,tr));tt=nt.traceId,rt?(logger$1.debug("Using parent span %s",rt.spanId),et=rt.spanId):logger$1.debug("No parent span, using current trace %s",nt.traceId)}return tt?(logger$1.debug(`Creating span ${JSON.stringify($.data)} with id ${$.spanId??tt}`),new Span({...$,traceId:tt,parentId:et},bt(this,tr))):(logger$1.error("No traceId found. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new NoopSpan($.data,bt(this,tr)))}async shutdown($){try{logger$1.debug("Shutting down tracing provider"),await bt(this,tr).shutdown($)}catch(_e){logger$1.error("Error shutting down tracing provider %o",_e)}}async forceFlush(){await bt(this,tr).forceFlush()}}tr=new WeakMap,ds=new WeakMap,Vo=new WeakSet,eu=function(){if(typeof process<"u"&&typeof process.on=="function"){const $=async()=>{const _e=setTimeout(()=>{console.warn("Cleanup timeout, forcing exit"),process.exit(1)},5e3);try{await this.shutdown()}finally{clearTimeout(_e)}};process.on("beforeExit",$),process.on("SIGINT",async()=>{await $(),process.exit(130)}),process.on("SIGTERM",async()=>{await $(),process.exit(0)}),process.on("unhandledRejection",async(_e,et)=>{logger$1.error("Unhandled rejection",_e,et),await $(),process.exit(1)})}};let GLOBAL_TRACE_PROVIDER;function getGlobalTraceProvider(){return GLOBAL_TRACE_PROVIDER||(GLOBAL_TRACE_PROVIDER=new TraceProvider),GLOBAL_TRACE_PROVIDER}function _withSpanFactory(j){return async($,..._e)=>withNewSpanContext(async()=>{const et=j(..._e);setCurrentSpan(et);try{return et.start(),await $(et)}catch(tt){throw et.setError({message:tt.message,data:tt.data}),tt}finally{et.end(),resetCurrentSpan()}})}function createAgentSpan(j,$){var _e;return getGlobalTraceProvider().createSpan({...j,data:{type:"agent",name:((_e=j==null?void 0:j.data)==null?void 0:_e.name)??"Agent",...j==null?void 0:j.data}},$)}function createFunctionSpan(j,$){var _e,et;return getGlobalTraceProvider().createSpan({...j,data:{type:"function",input:((_e=j==null?void 0:j.data)==null?void 0:_e.input)??"",output:((et=j==null?void 0:j.data)==null?void 0:et.output)??"",...j==null?void 0:j.data}},$)}const withFunctionSpan=_withSpanFactory(createFunctionSpan);function createHandoffSpan(j,$){return getGlobalTraceProvider().createSpan({...j,data:{type:"handoff",...j==null?void 0:j.data}},$)}const withHandoffSpan=_withSpanFactory(createHandoffSpan);function createGuardrailSpan(j,$){return getGlobalTraceProvider().createSpan({...j,data:{type:"guardrail",triggered:!1,...j==null?void 0:j.data}},$)}const withGuardrailSpan=_withSpanFactory(createGuardrailSpan);function createMCPListToolsSpan(j,$){return getGlobalTraceProvider().createSpan({...j,data:{type:"mcp_tools",...j==null?void 0:j.data}},$)}const withMCPListToolsSpan=_withSpanFactory(createMCPListToolsSpan);function addTraceProcessor(j){getGlobalTraceProvider().registerProcessor(j)}class EventEmitterDelegate{on($,_e){return this.eventEmitter.on($,_e),this.eventEmitter}off($,_e){return this.eventEmitter.off($,_e),this.eventEmitter}emit($,..._e){return this.eventEmitter.emit($,..._e)}once($,_e){return this.eventEmitter.once($,_e),this.eventEmitter}}class AgentHooks extends EventEmitterDelegate{constructor(){super(...arguments);Wt(this,"eventEmitter",new BrowserEventEmitter)}}class RunHooks extends EventEmitterDelegate{constructor(){super(...arguments);Wt(this,"eventEmitter",new BrowserEventEmitter)}}function defineInputGuardrail({name:j,execute:$}){return{type:"input",name:j,guardrailFunction:$,async run(_e){return{guardrail:{type:"input",name:j},output:await $(_e)}}}}function defineOutputGuardrail({name:j,execute:$}){return{type:"output",name:j,guardrailFunction:$,async run(_e){return{guardrail:{type:"output",name:j},agent:_e.agent,agentOutput:_e.agentOutput,output:await $(_e)}}}}function getTransferMessage(j){return JSON.stringify({assistant:j.name})}function defaultHandoffToolName(j){return`transfer_to_${toFunctionToolName(j.name)}`}function defaultHandoffToolDescription(j){return`Handoff to the ${j.name} agent to handle the request. ${j.handoffDescription??""}`}class Handoff{constructor($,_e){Wt(this,"toolName");Wt(this,"toolDescription");Wt(this,"inputJsonSchema",{type:"object",properties:{},required:[],additionalProperties:!1});Wt(this,"strictJsonSchema",!0);Wt(this,"onInvokeHandoff");Wt(this,"agentName");Wt(this,"inputFilter");Wt(this,"agent");this.agentName=$.name,this.onInvokeHandoff=_e,this.toolName=defaultHandoffToolName($),this.toolDescription=defaultHandoffToolDescription($),this.agent=$}getHandoffAsFunctionTool(){return{type:"function",name:this.toolName,description:this.toolDescription,parameters:this.inputJsonSchema,strict:this.strictJsonSchema}}}function handoff(j,$={}){let _e;const et=!!$.onHandoff,tt=!!$.inputType;if(!(et===tt))throw new UserError("You must provide either both `onHandoff` and `inputType` or neither.");async function rt(st,at){var ot;if(_e){if(!at)throw addErrorToCurrentSpan({message:`Handoff function expected non empty input but got: ${at}`,data:{details:"input is empty"}}),new ModelBehaviorError("Handoff function expected non empty input");try{const ct=await _e(at);$.onHandoff&&await $.onHandoff(st,ct)}catch(ct){throw addErrorToCurrentSpan({message:"Invalid JSON provided",data:{}}),logger$1.dontLogToolData||logger$1.error(`Invalid JSON when parsing: ${at}. Error: ${ct}`),new ModelBehaviorError("Invalid JSON provided")}}else await((ot=$.onHandoff)==null?void 0:ot.call($,st));return j}const it=new Handoff(j,rt);if($.inputType){const st=getSchemaAndParserFromInputType($.inputType,it.toolName);it.inputJsonSchema=st.schema,it.strictJsonSchema=!0,_e=st.parser}return $.toolNameOverride&&(it.toolName=$.toolNameOverride),$.toolDescriptionOverride&&(it.toolDescription=$.toolDescriptionOverride),$.inputFilter&&(it.inputFilter=$.inputFilter),it}function getHandoff(j){return j instanceof Handoff?j:handoff(j)}function getDefaultModelProvider(){throw new Error("No default model provider set. Make sure to set a provider using setDefaultModelProvider before calling getDefaultModelProvider or pass an explicit provider.")}const SharedBase=objectType({providerData:recordType(stringType(),anyType()).optional()}),ItemBase=SharedBase.extend({id:stringType().optional()}),Refusal=SharedBase.extend({type:literalType("refusal"),refusal:stringType()}),OutputText=SharedBase.extend({type:literalType("output_text"),text:stringType()}),InputText=SharedBase.extend({type:literalType("input_text"),text:stringType()}),InputImage=SharedBase.extend({type:literalType("input_image"),image:stringType().or(objectType({id:stringType()})).describe("Could be a URL, base64 or an object with a file ID.")}),InputFile=SharedBase.extend({type:literalType("input_file"),file:stringType().or(objectType({id:stringType()})).describe("Contents of the file or an object with a file ID.")}),AudioContent=SharedBase.extend({type:literalType("audio"),audio:stringType().or(objectType({id:stringType()})).describe("Base64 encoded audio data or file id"),format:stringType().nullable().optional(),transcript:stringType().nullable().optional()}),ImageContent=SharedBase.extend({type:literalType("image"),image:stringType().describe("Base64 encoded image data")}),ToolOutputText=SharedBase.extend({type:literalType("text"),text:stringType()}),ToolOutputImage=SharedBase.extend({type:literalType("image"),data:stringType().describe("Base64 encoded image data"),mediaType:stringType().describe("IANA media type of the image")}),ComputerToolOutput=SharedBase.extend({type:literalType("computer_screenshot"),data:stringType().describe("Base64 encoded image data or URL")}),computerActions=discriminatedUnionType("type",[objectType({type:literalType("screenshot")}),objectType({type:literalType("click"),x:numberType(),y:numberType(),button:enumType(["left","right","wheel","back","forward"])}),objectType({type:literalType("double_click"),x:numberType(),y:numberType()}),objectType({type:literalType("scroll"),x:numberType(),y:numberType(),scroll_x:numberType(),scroll_y:numberType()}),objectType({type:literalType("type"),text:stringType()}),objectType({type:literalType("wait")}),objectType({type:literalType("move"),x:numberType(),y:numberType()}),objectType({type:literalType("keypress"),keys:arrayType(stringType())}),objectType({type:literalType("drag"),path:arrayType(objectType({x:numberType(),y:numberType()}))})]),AssistantContent=discriminatedUnionType("type",[OutputText,Refusal,InputText,AudioContent,ImageContent]),MessageBase=ItemBase.extend({type:literalType("message").optional()}),AssistantMessageItem=MessageBase.extend({role:literalType("assistant"),status:enumType(["in_progress","completed","incomplete"]),content:arrayType(AssistantContent)}),UserContent=discriminatedUnionType("type",[InputText,InputImage,InputFile,AudioContent]),UserMessageItem=MessageBase.extend({role:literalType("user"),content:arrayType(UserContent).or(stringType())}),SystemMessageItem=MessageBase.extend({role:literalType("system"),content:stringType()});discriminatedUnionType("role",[SystemMessageItem,AssistantMessageItem,UserMessageItem]);const HostedToolCallItem=ItemBase.extend({type:literalType("hosted_tool_call"),name:stringType().describe("The name of the hosted tool"),arguments:stringType().describe("The arguments of the hosted tool call").optional(),status:stringType().optional(),output:stringType().optional()}),FunctionCallItem=ItemBase.extend({type:literalType("function_call"),callId:stringType().describe("The ID of the tool call"),name:stringType().describe("The name of the function"),status:enumType(["in_progress","completed","incomplete"]).optional(),arguments:stringType()}),FunctionCallResultItem=ItemBase.extend({type:literalType("function_call_result"),name:stringType().describe("The name of the tool"),callId:stringType().describe("The ID of the tool call"),status:enumType(["in_progress","completed","incomplete"]),output:discriminatedUnionType("type",[ToolOutputText,ToolOutputImage])}),ComputerUseCallItem=ItemBase.extend({type:literalType("computer_call"),callId:stringType().describe("The ID of the computer call"),status:enumType(["in_progress","completed","incomplete"]),action:computerActions}),ComputerCallResultItem=ItemBase.extend({type:literalType("computer_call_result"),callId:stringType().describe("The ID of the computer call"),output:ComputerToolOutput}),ToolCallItem=discriminatedUnionType("type",[ComputerUseCallItem,FunctionCallItem,HostedToolCallItem]),ReasoningItem=SharedBase.extend({id:stringType().optional(),type:literalType("reasoning"),content:arrayType(InputText)}),UnknownItem=ItemBase.extend({type:literalType("unknown")}),OutputModelItem=discriminatedUnionType("type",[AssistantMessageItem,HostedToolCallItem,FunctionCallItem,ComputerUseCallItem,ReasoningItem,UnknownItem]),ModelItem=unionType([UserMessageItem,AssistantMessageItem,SystemMessageItem,HostedToolCallItem,FunctionCallItem,ComputerUseCallItem,FunctionCallResultItem,ComputerCallResultItem,ReasoningItem,UnknownItem]),UsageData=objectType({requests:numberType().optional(),inputTokens:numberType(),outputTokens:numberType(),totalTokens:numberType(),inputTokensDetails:recordType(stringType(),numberType()).optional(),outputTokensDetails:recordType(stringType(),numberType()).optional()}),StreamEventTextStream=SharedBase.extend({type:literalType("output_text_delta"),delta:stringType()}),StreamEventResponseStarted=SharedBase.extend({type:literalType("response_started")}),StreamEventResponseCompleted=SharedBase.extend({type:literalType("response_done"),response:SharedBase.extend({id:stringType(),usage:UsageData,output:arrayType(OutputModelItem)})}),StreamEventGenericItem=SharedBase.extend({type:literalType("model"),event:anyType().describe("The event from the model")});discriminatedUnionType("type",[StreamEventTextStream,StreamEventResponseCompleted,StreamEventResponseStarted,StreamEventGenericItem]);class Usage{constructor($){Wt(this,"requests");Wt(this,"inputTokens");Wt(this,"outputTokens");Wt(this,"totalTokens");Wt(this,"inputTokensDetails",[]);Wt(this,"outputTokensDetails",[]);typeof $>"u"?(this.requests=0,this.inputTokens=0,this.outputTokens=0,this.totalTokens=0,this.inputTokensDetails=[],this.outputTokensDetails=[]):(this.requests=($==null?void 0:$.requests)??1,this.inputTokens=($==null?void 0:$.inputTokens)??0,this.outputTokens=($==null?void 0:$.outputTokens)??0,this.totalTokens=($==null?void 0:$.totalTokens)??0,this.inputTokensDetails=$!=null&&$.inputTokensDetails?[$.inputTokensDetails]:[],this.outputTokensDetails=$!=null&&$.outputTokensDetails?[$.outputTokensDetails]:[])}add($){this.requests+=$.requests,this.inputTokens+=$.inputTokens,this.outputTokens+=$.outputTokens,this.totalTokens+=$.totalTokens,$.inputTokensDetails&&this.inputTokensDetails.push(...$.inputTokensDetails),$.outputTokensDetails&&this.outputTokensDetails.push(...$.outputTokensDetails)}}var pr;class RunContext{constructor($={}){Wt(this,"context");Wt(this,"usage");zt(this,pr);this.context=$,this.usage=new Usage,Dt(this,pr,new Map)}_rebuildApprovals($){Dt(this,pr,new Map(Object.entries($)))}isToolApproved({toolName:$,callId:_e}){const et=bt(this,pr).get($);if((et==null?void 0:et.approved)===!0&&et.rejected===!0)return logger$1.warn("Tool is permanently approved and rejected at the same time. Approval takes precedence"),!0;if((et==null?void 0:et.approved)===!0)return!0;if((et==null?void 0:et.rejected)===!0)return!1;const tt=Array.isArray(et==null?void 0:et.approved)?et.approved.includes(_e):!1,nt=Array.isArray(et==null?void 0:et.rejected)?et.rejected.includes(_e):!1;if(tt&&nt)return logger$1.warn(`Tool call ${_e} is both approved and rejected at the same time. Approval takes precedence`),!0;if(tt)return!0;if(nt)return!1}approveTool($,{alwaysApprove:_e=!1}={}){const et=$.rawItem.name;if(_e){bt(this,pr).set(et,{approved:!0,rejected:[]});return}const tt=bt(this,pr).get(et)??{approved:[],rejected:[]};if(Array.isArray(tt.approved)){const nt="callId"in $.rawItem?$.rawItem.callId:$.rawItem.id;tt.approved.push(nt)}bt(this,pr).set(et,tt)}rejectTool($,{alwaysReject:_e=!1}={}){const et=$.rawItem.name;if(_e){bt(this,pr).set(et,{approved:!1,rejected:!0});return}const tt=bt(this,pr).get(et)??{approved:[],rejected:[]};if(Array.isArray(tt.rejected)){const nt="callId"in $.rawItem?$.rawItem.callId:$.rawItem.id;tt.rejected.push(nt)}bt(this,pr).set(et,tt)}toJSON(){return{context:this.context,usage:this.usage,approvals:Object.fromEntries(bt(this,pr).entries())}}}pr=new WeakMap;class RunResultBase{constructor($){Wt(this,"state");this.state=$}get history(){return getTurnInput(this.input,this.newItems)}get output(){return getTurnInput([],this.newItems)}get input(){return this.state._originalInput}get newItems(){return this.state._generatedItems}get rawResponses(){return this.state._modelResponses}get lastResponseId(){const $=this.rawResponses;return $&&$.length>0?$[$.length-1].responseId:void 0}get lastAgent(){return this.state._currentAgent}get inputGuardrailResults(){return this.state._inputGuardrailResults}get outputGuardrailResults(){return this.state._outputGuardrailResults}get interruptions(){var $;return(($=this.state._currentStep)==null?void 0:$.type)==="next_step_interruption"?this.state._currentStep.data.interruptions:[]}get finalOutput(){var $;if((($=this.state._currentStep)==null?void 0:$.type)==="next_step_final_output")return this.state._currentAgent.processFinalOutput(this.state._currentStep.output);logger$1.warn("Accessed finalOutput before agent run is completed.")}}class RunResult extends RunResultBase{constructor($){super($)}}var wo,Vs,xr,Xr,zs,Co,ko,Ro;class StreamedRunResult extends RunResultBase{constructor(_e={}){super(_e.state);Wt(this,"currentTurn",0);Wt(this,"maxTurns");zt(this,wo,null);zt(this,Vs);zt(this,xr);zt(this,Xr);zt(this,zs);zt(this,Co);zt(this,ko);zt(this,Ro,!1);Dt(this,Vs,_e.signal),bt(this,Vs)&&bt(this,Vs).addEventListener("abort",async()=>{await bt(this,Xr).cancel()}),Dt(this,Xr,new ReadableStream$1({start:et=>{Dt(this,xr,et)},cancel:()=>{Dt(this,Ro,!0)}})),Dt(this,zs,new Promise((et,tt)=>{Dt(this,Co,et),Dt(this,ko,tt)}))}get currentAgent(){return this.lastAgent}_addItem(_e){var et;this.cancelled||(et=bt(this,xr))==null||et.enqueue(_e)}_done(){var _e;!this.cancelled&&bt(this,xr)&&(bt(this,xr).close(),Dt(this,xr,void 0),(_e=bt(this,Co))==null||_e.call(this))}_raiseError(_e){var et;!this.cancelled&&bt(this,xr)&&(bt(this,xr).error(_e),Dt(this,xr,void 0)),Dt(this,wo,_e),(et=bt(this,ko))==null||et.call(this,_e),bt(this,zs).catch(tt=>{logger$1.debug(`Resulted in an error: ${tt}`)})}get cancelled(){return bt(this,Ro)}toStream(){return bt(this,Xr)}get completed(){return bt(this,zs)}get error(){return bt(this,wo)}toTextStream(_e={}){const et=bt(this,Xr).pipeThrough(new TransformStream({transform(tt,nt){if(tt.type==="raw_model_stream_event"&&tt.data.type==="output_text_delta"){const rt=StreamEventTextStream.parse(tt.data);nt.enqueue(rt.delta)}}}));return _e.compatibleWithNodeStreams?Readable.fromWeb(et):et}[Symbol.asyncIterator](){return bt(this,Xr)[Symbol.asyncIterator]()}}wo=new WeakMap,Vs=new WeakMap,xr=new WeakMap,Xr=new WeakMap,zs=new WeakMap,Co=new WeakMap,ko=new WeakMap,Ro=new WeakMap;function serializeTool(j){return j.type==="function"?{type:"function",name:j.name,description:j.description,parameters:j.parameters,strict:j.strict}:j.type==="computer"?{type:"computer",name:j.name,environment:j.computer.environment,dimensions:j.computer.dimensions}:{type:"hosted_tool",name:j.name,providerData:j.providerData}}function serializeHandoff(j){return{toolName:j.toolName,toolDescription:j.toolDescription,inputJsonSchema:j.inputJsonSchema,strictJsonSchema:j.strictJsonSchema}}class RunItemBase{constructor(){Wt(this,"type","base_item");Wt(this,"rawItem")}toJSON(){return{type:this.type,rawItem:this.rawItem}}}class RunMessageOutputItem extends RunItemBase{constructor(_e,et){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"type","message_output_item");this.rawItem=_e,this.agent=et}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}get content(){let _e="";for(const et of this.rawItem.content)et.type==="output_text"&&(_e+=et.text);return _e}}class RunToolCallItem extends RunItemBase{constructor(_e,et){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"type","tool_call_item");this.rawItem=_e,this.agent=et}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class RunToolCallOutputItem extends RunItemBase{constructor(_e,et,tt){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"output");Wt(this,"type","tool_call_output_item");this.rawItem=_e,this.agent=et,this.output=tt}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON(),output:toSmartString(this.output)}}}class RunReasoningItem extends RunItemBase{constructor(_e,et){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"type","reasoning_item");this.rawItem=_e,this.agent=et}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class RunHandoffCallItem extends RunItemBase{constructor(_e,et){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"type","handoff_call_item");this.rawItem=_e,this.agent=et}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class RunHandoffOutputItem extends RunItemBase{constructor(_e,et,tt){super();Wt(this,"rawItem");Wt(this,"sourceAgent");Wt(this,"targetAgent");Wt(this,"type","handoff_output_item");this.rawItem=_e,this.sourceAgent=et,this.targetAgent=tt}toJSON(){return{...super.toJSON(),sourceAgent:this.sourceAgent.toJSON(),targetAgent:this.targetAgent.toJSON()}}}class RunToolApprovalItem extends RunItemBase{constructor(_e,et){super();Wt(this,"rawItem");Wt(this,"agent");Wt(this,"type","tool_approval_item");this.rawItem=_e,this.agent=et}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}function getLastTextFromOutputMessage(j){if(j.type!=="message"||j.role!=="assistant")return;const $=j.content[j.content.length-1];if($.type==="output_text")return $.text}function getOutputText(j){return j.output.length===0?"":getLastTextFromOutputMessage(j.output[j.output.length-1])||""}class RunRawModelStreamEvent{constructor($){Wt(this,"data");Wt(this,"type","raw_model_stream_event");this.data=$}}class RunItemStreamEvent{constructor($,_e){Wt(this,"name");Wt(this,"item");Wt(this,"type","run_item_stream_event");this.name=$,this.item=_e}}class RunAgentUpdatedStreamEvent{constructor($){Wt(this,"agent");Wt(this,"type","agent_updated_stream_event");this.agent=$}}function processModelResponse(j,$,_e,et){var pt;const tt=[],nt=[],rt=[],it=[],st=[],at=[],ot=new Map(et.map(dt=>[dt.toolName,dt])),ct=new Map(_e.filter(dt=>dt.type==="function").map(dt=>[dt.name,dt])),lt=_e.find(dt=>dt.type==="computer"),ut=new Map(_e.filter(dt=>{var ht;return dt.type==="hosted_tool"&&((ht=dt.providerData)==null?void 0:ht.type)==="mcp"}).map(dt=>dt).map(dt=>[dt.providerData.server_label,dt]));for(const dt of j.output){if(dt.type==="message")dt.role==="assistant"&&tt.push(new RunMessageOutputItem(dt,$));else if(dt.type==="hosted_tool_call"){tt.push(new RunToolCallItem(dt,$));const ft=dt.name;if(at.push(ft),((pt=dt.providerData)==null?void 0:pt.type)==="mcp_approval_request"||dt.name==="mcp_approval_request"){const mt=dt.providerData,gt=mt.server_label,yt=ut.get(gt);if(typeof yt>"u"){const xt=`MCP server (${gt}) not found in Agent (${$.name})`;throw addErrorToCurrentSpan({message:xt,data:{mcp_server_label:gt}}),new ModelBehaviorError(xt)}const vt=new RunToolApprovalItem({type:"hosted_tool_call",name:mt.name,id:mt.id,status:"in_progress",providerData:mt},$);st.push({requestItem:vt,mcpTool:yt}),yt.providerData.on_approval||tt.push(vt)}}else if(dt.type==="reasoning")tt.push(new RunReasoningItem(dt,$));else if(dt.type==="computer_call"){if(tt.push(new RunToolCallItem(dt,$)),at.push("computer_use"),!lt)throw addErrorToCurrentSpan({message:"Model produced computer action without a computer tool.",data:{agent_name:$.name}}),new ModelBehaviorError("Model produced computer action without a computer tool.");it.push({toolCall:dt,computer:lt})}if(dt.type!=="function_call")continue;at.push(dt.name);const ht=ot.get(dt.name);if(ht)tt.push(new RunHandoffCallItem(dt,$)),nt.push({toolCall:dt,handoff:ht});else{const ft=ct.get(dt.name);if(!ft)throw addErrorToCurrentSpan({message:`Tool ${dt.name} not found in agent ${$.name}.`,data:{tool_name:dt.name,agent_name:$.name}}),new ModelBehaviorError(`Tool ${dt.name} not found in agent ${$.name}.`);tt.push(new RunToolCallItem(dt,$)),rt.push({toolCall:dt,tool:ft})}}return{newItems:tt,handoffs:nt,functions:rt,computerActions:it,mcpApprovalRequests:st,toolsUsed:at,hasToolsOrApprovalsToRun(){return nt.length>0||rt.length>0||st.length>0||it.length>0}}}const nextStepSchema=discriminatedUnionType("type",[objectType({type:literalType("next_step_handoff"),newAgent:anyType()}),objectType({type:literalType("next_step_final_output"),output:stringType()}),objectType({type:literalType("next_step_run_again")}),objectType({type:literalType("next_step_interruption"),data:recordType(stringType(),anyType())})]);class SingleStepResult{constructor($,_e,et,tt,nt){Wt(this,"originalInput");Wt(this,"modelResponse");Wt(this,"preStepItems");Wt(this,"newStepItems");Wt(this,"nextStep");this.originalInput=$,this.modelResponse=_e,this.preStepItems=et,this.newStepItems=tt,this.nextStep=nt}get generatedItems(){return this.preStepItems.concat(this.newStepItems)}}function maybeResetToolChoice(j,$,_e){return j.resetToolChoice&&$.hasUsedTools(j)?{..._e,toolChoice:void 0}:_e}async function executeInterruptedToolsAndSideEffects(j,$,_e,et,tt,nt,rt){const it=_e.filter(pt=>pt instanceof RunToolApprovalItem&&"callId"in pt.rawItem&&pt.rawItem.type==="function_call").map(pt=>pt.rawItem.callId),st=tt.functions.filter(pt=>it.includes(pt.toolCall.callId)),at=await executeFunctionToolCalls(j,st,nt,rt),ot=at.map(pt=>pt.runItem),ct=tt.mcpApprovalRequests.filter(pt=>{var dt;return pt.requestItem.type==="tool_approval_item"&&pt.requestItem.rawItem.type==="hosted_tool_call"&&((dt=pt.requestItem.rawItem.providerData)==null?void 0:dt.type)==="mcp_approval_request"});for(const pt of ct){const dt=pt.requestItem.rawItem.id,ht=rt._context.isToolApproved({toolName:pt.requestItem.rawItem.name,callId:dt});if(typeof ht<"u"){const ft={approve:ht,approval_request_id:dt,reason:void 0};ot.push(new RunToolCallItem({type:"hosted_tool_call",name:"mcp_approval_response",providerData:ft},j))}}const lt=await checkForFinalOutputFromTools(j,at,rt),ut=_e.filter(pt=>!(pt instanceof RunToolApprovalItem));return lt.isFinalOutput?(nt.emit("agent_end",rt._context,j,lt.finalOutput),j.emit("agent_end",rt._context,lt.finalOutput),new SingleStepResult($,et,ut,ot,{type:"next_step_final_output",output:lt.finalOutput})):lt.isInterrupted?new SingleStepResult($,et,ut,ot,{type:"next_step_interruption",data:{interruptions:lt.interruptions}}):new SingleStepResult($,et,ut,ot,{type:"next_step_run_again"})}async function executeToolsAndSideEffects(j,$,_e,et,tt,nt,rt){const it=_e;let st=tt.newItems;const[at,ot]=await Promise.all([executeFunctionToolCalls(j,tt.functions,nt,rt),executeComputerActions(j,tt.computerActions,nt,rt._context)]);if(st=st.concat(at.map(pt=>pt.runItem)),st=st.concat(ot),tt.mcpApprovalRequests.length>0)for(const pt of tt.mcpApprovalRequests){const dt=pt.mcpTool.providerData,ht=pt.requestItem.rawItem.providerData;if(dt.on_approval){const ft=await dt.on_approval(rt._context,pt.requestItem),mt={approve:ft.approve,approval_request_id:ht.id,reason:ft.reason};st.push(new RunToolCallItem({type:"hosted_tool_call",name:"mcp_approval_response",providerData:mt},j))}else{st.push(pt.requestItem);const ft={type:"hosted_mcp_tool_approval",tool:pt.mcpTool,runItem:new RunToolApprovalItem({type:"hosted_tool_call",name:ht.name,id:ht.id,arguments:ht.arguments,status:"in_progress",providerData:ht},j)};at.push(ft)}}if(tt.handoffs.length>0)return await executeHandoffCalls(j,$,it,st,et,tt.handoffs,nt,rt._context);const ct=await checkForFinalOutputFromTools(j,at,rt);if(ct.isFinalOutput)return nt.emit("agent_end",rt._context,j,ct.finalOutput),j.emit("agent_end",rt._context,ct.finalOutput),new SingleStepResult($,et,it,st,{type:"next_step_final_output",output:ct.finalOutput});if(ct.isInterrupted)return new SingleStepResult($,et,it,st,{type:"next_step_interruption",data:{interruptions:ct.interruptions}});const lt=st.filter(pt=>pt instanceof RunMessageOutputItem),ut=lt.length>0?getLastTextFromOutputMessage(lt[lt.length-1].rawItem):void 0;if(!ut)return new SingleStepResult($,et,it,st,{type:"next_step_run_again"});if(j.outputType==="text"&&!tt.hasToolsOrApprovalsToRun())return new SingleStepResult($,et,it,st,{type:"next_step_final_output",output:ut});if(j.outputType!=="text"&&ut){const{parser:pt}=getSchemaAndParserFromInputType(j.outputType,"final_output"),[dt]=await safeExecute(()=>pt(ut));if(dt)throw addErrorToCurrentSpan({message:"Invalid output type",data:{error:String(dt)}}),new ModelBehaviorError("Invalid output type");return new SingleStepResult($,et,it,st,{type:"next_step_final_output",output:ut})}return new SingleStepResult($,et,it,st,{type:"next_step_run_again"})}function getToolCallOutputItem(j,$){return{type:"function_call_result",name:j.name,callId:j.callId,status:"completed",output:{type:"text",text:toSmartString($)}}}async function executeFunctionToolCalls(j,$,_e,et){async function tt(nt){let rt=nt.toolCall.arguments;if(nt.tool.parameters&&(isZodObject(nt.tool.parameters)?rt=nt.tool.parameters.parse(rt):rt=JSON.parse(rt)),await nt.tool.needsApproval(et._context,rt,nt.toolCall.callId)){const st=et._context.isToolApproved({toolName:nt.tool.name,callId:nt.toolCall.callId});if(st===!1)return withFunctionSpan(async at=>{const ot="Tool execution was not approved.";return at.setError({message:ot,data:{tool_name:nt.tool.name,error:`Tool execution for ${nt.toolCall.callId} was manually rejected by user.`}}),at.spanData.output=ot,{type:"function_output",tool:nt.tool,output:ot,runItem:new RunToolCallOutputItem(getToolCallOutputItem(nt.toolCall,ot),j,ot)}},{data:{name:nt.tool.name}});if(st!==!0)return{type:"function_approval",tool:nt.tool,runItem:new RunToolApprovalItem(nt.toolCall,j)}}return withFunctionSpan(async st=>{_e.config.traceIncludeSensitiveData&&(st.spanData.input=nt.toolCall.arguments);try{_e.emit("agent_tool_start",et._context,j,nt.tool,{toolCall:nt.toolCall}),j.emit("agent_tool_start",et._context,nt.tool,{toolCall:nt.toolCall});const at=await nt.tool.invoke(et._context,nt.toolCall.arguments),ot=toSmartString(at);return _e.emit("agent_tool_end",et._context,j,nt.tool,ot,{toolCall:nt.toolCall}),j.emit("agent_tool_end",et._context,nt.tool,ot,{toolCall:nt.toolCall}),_e.config.traceIncludeSensitiveData&&(st.spanData.output=ot),{type:"function_output",tool:nt.tool,output:at,runItem:new RunToolCallOutputItem(getToolCallOutputItem(nt.toolCall,at),j,at)}}catch(at){throw st.setError({message:"Error running tool",data:{tool_name:nt.tool.name,error:String(at)}}),at}},{data:{name:nt.tool.name}})}try{return await Promise.all($.map(tt))}catch(nt){throw new ToolCallError(`Failed to run function tools: ${nt}`,nt,et)}}async function _runComputerActionAndScreenshot(j,$){const _e=$.action;let et;switch(_e.type){case"click":await j.click(_e.x,_e.y,_e.button);break;case"double_click":await j.doubleClick(_e.x,_e.y);break;case"drag":await j.drag(_e.path.map(tt=>[tt.x,tt.y]));break;case"keypress":await j.keypress(_e.keys);break;case"move":await j.move(_e.x,_e.y);break;case"screenshot":et=await j.screenshot();break;case"scroll":await j.scroll(_e.x,_e.y,_e.scroll_x,_e.scroll_y);break;case"type":await j.type(_e.text);break;case"wait":await j.wait();break}if(typeof et<"u"||typeof j.screenshot=="function"&&(et=await j.screenshot(),typeof et<"u"))return et;throw new Error("Computer does not implement screenshot()")}async function executeComputerActions(j,$,_e,et,tt=void 0){const nt=tt??logger$1,rt=[];for(const it of $){const st=it.computer.computer,at=it.toolCall;_e.emit("agent_tool_start",et,j,it.computer,{toolCall:at}),typeof j.emit=="function"&&j.emit("agent_tool_start",et,it.computer,{toolCall:at});let ot;try{ot=await _runComputerActionAndScreenshot(st,at)}catch(ut){nt.error("Failed to execute computer action:",ut),ot=""}_e.emit("agent_tool_end",et,j,it.computer,ot,{toolCall:at}),typeof j.emit=="function"&&j.emit("agent_tool_end",et,it.computer,ot,{toolCall:at});const ct=ot?`data:image/png;base64,${ot}`:"",lt={type:"computer_call_result",callId:at.callId,output:{type:"computer_screenshot",data:ct}};rt.push(new RunToolCallOutputItem(lt,j,ct))}return rt}async function executeHandoffCalls(j,$,_e,et,tt,nt,rt,it){if(et=[...et],nt.length===0)return logger$1.warn("Incorrectly called executeHandoffCalls with no handoffs. This should not happen. Moving on."),new SingleStepResult($,tt,_e,et,{type:"next_step_run_again"});if(nt.length>1){const at="Multiple handoffs detected, ignorning this one.";for(let ot=1;ot<nt.length;ot++)et.push(new RunToolCallOutputItem(getToolCallOutputItem(nt[ot].toolCall,at),j,at))}const st=nt[0];return withHandoffSpan(async at=>{const ot=st.handoff,ct=await ot.onInvokeHandoff(it,st.toolCall.arguments);if(at.spanData.to_agent=ct.name,nt.length>1){const ut=nt.map(pt=>pt.handoff.agentName);at.setError({message:"Multiple handoffs requested",data:{requested_agents:ut}})}et.push(new RunHandoffOutputItem(getToolCallOutputItem(st.toolCall,getTransferMessage(ct)),j,ct)),rt.emit("agent_handoff",it,j,ct),j.emit("agent_handoff",it,ct);const lt=ot.inputFilter??rt.config.handoffInputFilter;if(lt){logger$1.debug("Filtering inputs for handoff"),typeof lt!="function"&&at.setError({message:"Invalid input filter",data:{details:"not callable"}});const ut={inputHistory:Array.isArray($)?[...$]:$,preHandoffItems:[..._e],newItems:[...et]},pt=lt(ut);$=pt.inputHistory,_e=pt.preHandoffItems,et=pt.newItems}return new SingleStepResult($,tt,_e,et,{type:"next_step_handoff",newAgent:ct})},{data:{from_agent:j.name}})}const NOT_FINAL_OUTPUT={isFinalOutput:!1,isInterrupted:void 0};async function checkForFinalOutputFromTools(j,$,_e){if($.length===0)return NOT_FINAL_OUTPUT;const et=$.filter(rt=>rt.runItem instanceof RunToolApprovalItem).map(rt=>rt.runItem);if(et.length>0)return{isFinalOutput:!1,isInterrupted:!0,interruptions:et};if(j.toolUseBehavior==="run_llm_again")return NOT_FINAL_OUTPUT;const tt=$[0];if(j.toolUseBehavior==="stop_on_first_tool")return(tt==null?void 0:tt.type)==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:toSmartString(tt.output)}:NOT_FINAL_OUTPUT;const nt=j.toolUseBehavior;if(typeof nt=="object"){const rt=$.find(it=>nt.stopAtToolNames.includes(it.tool.name));return(rt==null?void 0:rt.type)==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:toSmartString(rt.output)}:NOT_FINAL_OUTPUT}if(typeof nt=="function")return nt(_e._context,$);throw new UserError(`Invalid toolUseBehavior: ${nt}`,_e)}function addStepToRunResult(j,$){for(const _e of $.newStepItems){let et;if(_e instanceof RunMessageOutputItem)et="message_output_created";else if(_e instanceof RunHandoffCallItem)et="handoff_requested";else if(_e instanceof RunHandoffOutputItem)et="handoff_occurred";else if(_e instanceof RunToolCallItem)et="tool_called";else if(_e instanceof RunToolCallOutputItem)et="tool_output";else if(_e instanceof RunReasoningItem)et="reasoning_item_created";else if(_e instanceof RunToolApprovalItem)et="tool_approval_requested";else{logger$1.warn("Unknown item type: ",_e);continue}j._addItem(new RunItemStreamEvent(et,_e))}}var Ws;class AgentToolUseTracker{constructor(){zt(this,Ws,new Map)}addToolUse($,_e){bt(this,Ws).set($,_e)}hasUsedTools($){return bt(this,Ws).has($)}toJSON(){return Object.fromEntries(Array.from(bt(this,Ws).entries()).map(([$,_e])=>[$.name,_e]))}}Ws=new WeakMap;const CURRENT_SCHEMA_VERSION="1.0",$schemaVersion=literalType(CURRENT_SCHEMA_VERSION),serializedAgentSchema=objectType({name:stringType()}),serializedSpanBase=objectType({object:literalType("trace.span"),id:stringType(),trace_id:stringType(),parent_id:stringType().nullable(),started_at:stringType().nullable(),ended_at:stringType().nullable(),error:objectType({message:stringType(),data:recordType(stringType(),anyType()).optional()}).nullable(),span_data:recordType(stringType(),anyType())}),SerializedSpan=serializedSpanBase.extend({previous_span:lazyType(()=>SerializedSpan).optional()}),usageSchema=objectType({requests:numberType(),inputTokens:numberType(),outputTokens:numberType(),totalTokens:numberType()}),modelResponseSchema=objectType({usage:usageSchema,output:arrayType(OutputModelItem),responseId:stringType().optional(),providerData:recordType(stringType(),anyType()).optional()}),itemSchema=discriminatedUnionType("type",[objectType({type:literalType("message_output_item"),rawItem:AssistantMessageItem,agent:serializedAgentSchema}),objectType({type:literalType("tool_call_item"),rawItem:ToolCallItem.or(HostedToolCallItem),agent:serializedAgentSchema}),objectType({type:literalType("tool_call_output_item"),rawItem:FunctionCallResultItem,agent:serializedAgentSchema,output:stringType()}),objectType({type:literalType("reasoning_item"),rawItem:ReasoningItem,agent:serializedAgentSchema}),objectType({type:literalType("handoff_call_item"),rawItem:FunctionCallItem,agent:serializedAgentSchema}),objectType({type:literalType("handoff_output_item"),rawItem:FunctionCallResultItem,sourceAgent:serializedAgentSchema,targetAgent:serializedAgentSchema}),objectType({type:literalType("tool_approval_item"),rawItem:FunctionCallItem.or(HostedToolCallItem),agent:serializedAgentSchema})]),serializedTraceSchema=objectType({object:literalType("trace"),id:stringType(),workflow_name:stringType(),group_id:stringType().nullable(),metadata:recordType(stringType(),anyType())}),serializedProcessedResponseSchema=objectType({newItems:arrayType(itemSchema),toolsUsed:arrayType(stringType()),handoffs:arrayType(objectType({toolCall:anyType(),handoff:anyType()})),functions:arrayType(objectType({toolCall:anyType(),tool:anyType()})),computerActions:arrayType(objectType({toolCall:anyType(),computer:anyType()})),mcpApprovalRequests:arrayType(objectType({requestItem:objectType({rawItem:objectType({type:literalType("hosted_tool_call"),name:stringType(),arguments:stringType().optional(),status:stringType().optional(),output:stringType().optional()})}),mcpTool:objectType({type:literalType("hosted_tool"),name:literalType("hosted_mcp"),providerData:recordType(stringType(),anyType())})})).optional()}),guardrailFunctionOutputSchema=objectType({tripwireTriggered:booleanType(),outputInfo:anyType()}),inputGuardrailResultSchema=objectType({guardrail:objectType({type:literalType("input"),name:stringType()}),output:guardrailFunctionOutputSchema}),outputGuardrailResultSchema=objectType({guardrail:objectType({type:literalType("output"),name:stringType()}),agentOutput:anyType(),agent:serializedAgentSchema,output:guardrailFunctionOutputSchema}),SerializedRunState=objectType({$schemaVersion,currentTurn:numberType(),currentAgent:serializedAgentSchema,originalInput:stringType().or(arrayType(ModelItem)),modelResponses:arrayType(modelResponseSchema),context:objectType({usage:usageSchema,approvals:recordType(stringType(),objectType({approved:arrayType(stringType()).or(booleanType()),rejected:arrayType(stringType()).or(booleanType())})),context:recordType(stringType(),anyType())}),toolUseTracker:recordType(stringType(),arrayType(stringType())),maxTurns:numberType(),currentAgentSpan:SerializedSpan.nullable().optional(),noActiveAgentRun:booleanType(),inputGuardrailResults:arrayType(inputGuardrailResultSchema),outputGuardrailResults:arrayType(outputGuardrailResultSchema),currentStep:nextStepSchema.optional(),lastModelResponse:modelResponseSchema.optional(),generatedItems:arrayType(itemSchema),lastProcessedResponse:serializedProcessedResponseSchema.optional(),trace:serializedTraceSchema.nullable()});class RunState{constructor($,_e,et,tt){Wt(this,"_currentTurn",0);Wt(this,"_currentAgent");Wt(this,"_originalInput");Wt(this,"_modelResponses");Wt(this,"_currentAgentSpan");Wt(this,"_context");Wt(this,"_toolUseTracker");Wt(this,"_generatedItems");Wt(this,"_maxTurns");Wt(this,"_noActiveAgentRun",!0);Wt(this,"_lastTurnResponse");Wt(this,"_inputGuardrailResults");Wt(this,"_outputGuardrailResults");Wt(this,"_currentStep");Wt(this,"_lastProcessedResponse");Wt(this,"_trace",null);this._context=$,this._originalInput=structuredClone(_e),this._modelResponses=[],this._currentAgentSpan=void 0,this._currentAgent=et,this._toolUseTracker=new AgentToolUseTracker,this._generatedItems=[],this._maxTurns=tt,this._inputGuardrailResults=[],this._outputGuardrailResults=[],this._trace=getCurrentTrace()}getInterruptions(){var $;return(($=this._currentStep)==null?void 0:$.type)!=="next_step_interruption"?[]:this._currentStep.data.interruptions}approve($,_e={alwaysApprove:!1}){this._context.approveTool($,_e)}reject($,_e={alwaysReject:!1}){this._context.rejectTool($,_e)}toJSON(){var et;const $={$schemaVersion:CURRENT_SCHEMA_VERSION,currentTurn:this._currentTurn,currentAgent:{name:this._currentAgent.name},originalInput:this._originalInput,modelResponses:this._modelResponses.map(tt=>({usage:{requests:tt.usage.requests,inputTokens:tt.usage.inputTokens,outputTokens:tt.usage.outputTokens,totalTokens:tt.usage.totalTokens},output:tt.output,responseId:tt.responseId,providerData:tt.providerData})),context:this._context.toJSON(),toolUseTracker:this._toolUseTracker.toJSON(),maxTurns:this._maxTurns,currentAgentSpan:(et=this._currentAgentSpan)==null?void 0:et.toJSON(),noActiveAgentRun:this._noActiveAgentRun,inputGuardrailResults:this._inputGuardrailResults,outputGuardrailResults:this._outputGuardrailResults.map(tt=>({...tt,agent:tt.agent.toJSON()})),currentStep:this._currentStep,lastModelResponse:this._lastTurnResponse,generatedItems:this._generatedItems.map(tt=>tt.toJSON()),lastProcessedResponse:this._lastProcessedResponse,trace:this._trace?this._trace.toJSON():null},_e=SerializedRunState.safeParse($);if(!_e.success)throw new SystemError(`Failed to serialize run state. ${_e.error.message}`);return _e.data}toString(){return JSON.stringify(this.toJSON())}static async fromString($,_e){var ct,lt,ut,pt,dt;const[et,tt]=await safeExecute(()=>JSON.parse(_e));if(et)throw new UserError(`Failed to parse run state. ${et instanceof Error?et.message:String(et)}`);const nt=tt.$schemaVersion;if(!nt)throw new UserError("Run state is missing schema version");if(nt!==CURRENT_SCHEMA_VERSION)throw new UserError(`Run state schema version ${nt} is not supported. Please use version ${CURRENT_SCHEMA_VERSION}`);const rt=SerializedRunState.parse(JSON.parse(_e)),it=buildAgentMap($),st=new RunContext(rt.context.context);st._rebuildApprovals(rt.context.approvals);const at=it.get(rt.currentAgent.name);if(!at)throw new UserError(`Agent ${rt.currentAgent.name} not found`);const ot=new RunState(st,"",at,rt.maxTurns);ot._currentTurn=rt.currentTurn,ot._toolUseTracker=new AgentToolUseTracker;for(const[ht,ft]of Object.entries(rt.toolUseTracker))ot._toolUseTracker.addToolUse(it.get(ht),ft);if(rt.currentAgentSpan){rt.trace||logger$1.warn("Trace is not set, skipping tracing setup");const ht=getGlobalTraceProvider().createTrace({traceId:(ct=rt.trace)==null?void 0:ct.id,name:(lt=rt.trace)==null?void 0:lt.workflow_name,groupId:((ut=rt.trace)==null?void 0:ut.group_id)??void 0,metadata:(pt=rt.trace)==null?void 0:pt.metadata});ot._currentAgentSpan=deserializeSpan(ht,rt.currentAgentSpan),ot._trace=ht}return ot._noActiveAgentRun=rt.noActiveAgentRun,ot._inputGuardrailResults=rt.inputGuardrailResults,ot._outputGuardrailResults=rt.outputGuardrailResults.map(ht=>({...ht,agent:it.get(ht.agent.name)})),ot._currentStep=rt.currentStep,ot._originalInput=rt.originalInput,ot._modelResponses=rt.modelResponses.map(deserializeModelResponse),ot._lastTurnResponse=rt.lastModelResponse?deserializeModelResponse(rt.lastModelResponse):void 0,ot._generatedItems=rt.generatedItems.map(ht=>deserializeItem(ht,it)),ot._lastProcessedResponse=rt.lastProcessedResponse?await deserializeProcessedResponse(it,ot._currentAgent,rt.lastProcessedResponse):void 0,((dt=rt.currentStep)==null?void 0:dt.type)==="next_step_handoff"&&(ot._currentStep={type:"next_step_handoff",newAgent:it.get(rt.currentStep.newAgent.name)}),ot}}function buildAgentMap(j){const $=new Map,_e=[j];for(;_e.length>0;){const et=_e.shift();if(!$.has(et.name)){$.set(et.name,et);for(const tt of et.handoffs)tt instanceof Agent?$.has(tt.name)||_e.push(tt):tt.agent&&($.has(tt.agent.name)||_e.push(tt.agent))}}return $}function deserializeSpan(j,$){const _e=$.span_data,et=$.previous_span?deserializeSpan(j,$.previous_span):void 0,tt=getGlobalTraceProvider().createSpan({spanId:$.id,traceId:$.trace_id,parentId:$.parent_id??void 0,startedAt:$.started_at??void 0,endedAt:$.ended_at??void 0,data:_e},j);return tt.previousSpan=et,tt}function deserializeModelResponse(j){const $=new Usage;return $.requests=j.usage.requests,$.inputTokens=j.usage.inputTokens,$.outputTokens=j.usage.outputTokens,$.totalTokens=j.usage.totalTokens,{usage:$,output:j.output.map(_e=>OutputModelItem.parse(_e)),responseId:j.responseId,providerData:j.providerData}}function deserializeItem(j,$){switch(j.type){case"message_output_item":return new RunMessageOutputItem(j.rawItem,$.get(j.agent.name));case"tool_call_item":return new RunToolCallItem(j.rawItem,$.get(j.agent.name));case"tool_call_output_item":return new RunToolCallOutputItem(j.rawItem,$.get(j.agent.name),j.output);case"reasoning_item":return new RunReasoningItem(j.rawItem,$.get(j.agent.name));case"handoff_call_item":return new RunHandoffCallItem(j.rawItem,$.get(j.agent.name));case"handoff_output_item":return new RunHandoffOutputItem(j.rawItem,$.get(j.sourceAgent.name),$.get(j.targetAgent.name));case"tool_approval_item":return new RunToolApprovalItem(j.rawItem,$.get(j.agent.name))}}async function deserializeProcessedResponse(j,$,_e){const et=await $.getAllTools(),tt=new Map(et.filter(st=>st.type==="function").map(st=>[st.name,st])),nt=new Map(et.filter(st=>st.type==="computer").map(st=>[st.name,st])),rt=new Map($.handoffs.map(st=>st instanceof Agent?[st.name,handoff(st)]:[st.toolName,st])),it={newItems:_e.newItems.map(st=>deserializeItem(st,j)),toolsUsed:_e.toolsUsed,handoffs:_e.handoffs.map(st=>{if(!rt.has(st.handoff.toolName))throw new UserError(`Handoff ${st.handoff.toolName} not found`);return{toolCall:st.toolCall,handoff:rt.get(st.handoff.toolName)}}),functions:await Promise.all(_e.functions.map(async st=>{if(!tt.has(st.tool.name))throw new UserError(`Tool ${st.tool.name} not found`);return{toolCall:st.toolCall,tool:tt.get(st.tool.name)}})),computerActions:_e.computerActions.map(st=>{const at=st.computer.name;if(!nt.has(at))throw new UserError(`Computer tool ${at} not found`);return{toolCall:st.toolCall,computer:nt.get(at)}}),mcpApprovalRequests:(_e.mcpApprovalRequests??[]).map(st=>({requestItem:new RunToolApprovalItem(st.requestItem.rawItem,$),mcpTool:st.mcpTool}))};return{...it,hasToolsOrApprovalsToRun(){return it.handoffs.length>0||it.functions.length>0||it.mcpApprovalRequests.length>0||it.computerActions.length>0}}}const DEFAULT_MAX_TURNS=10;function getTracing(j,$){return j?!1:$?!0:"enabled_without_data"}function getTurnInput(j,$){const _e=$.filter(et=>et.type!=="tool_approval_item").map(et=>et.rawItem);return typeof j=="string"&&(j=[{type:"message",role:"user",content:j}]),[...j,..._e]}var rr,xl,Sl,El,tu,Tl;class Runner extends RunHooks{constructor(_e={}){super();zt(this,rr);Wt(this,"config");Wt(this,"inputGuardrailDefs");Wt(this,"outputGuardrailDefs");this.config={modelProvider:_e.modelProvider??getDefaultModelProvider(),model:_e.model,modelSettings:_e.modelSettings,handoffInputFilter:_e.handoffInputFilter,inputGuardrails:_e.inputGuardrails,outputGuardrails:_e.outputGuardrails,tracingDisabled:_e.tracingDisabled??!1,traceIncludeSensitiveData:_e.traceIncludeSensitiveData??!0,workflowName:_e.workflowName??"Agent workflow",traceId:_e.traceId,groupId:_e.groupId,traceMetadata:_e.traceMetadata},this.inputGuardrailDefs=(_e.inputGuardrails??[]).map(defineInputGuardrail),this.outputGuardrailDefs=(_e.outputGuardrails??[]).map(defineOutputGuardrail)}run(_e,et,tt={stream:!1,context:void 0}){return et instanceof RunState&&et._trace?withTrace(et._trace,async()=>(et._currentAgentSpan&&setCurrentSpan(et._currentAgentSpan),tt!=null&&tt.stream?hn(this,rr,Tl).call(this,_e,et,tt):hn(this,rr,xl).call(this,_e,et,tt))):getOrCreateTrace(async()=>tt!=null&&tt.stream?hn(this,rr,Tl).call(this,_e,et,tt):hn(this,rr,xl).call(this,_e,et,tt),{traceId:this.config.traceId,name:this.config.workflowName,groupId:this.config.groupId,metadata:this.config.traceMetadata})}}rr=new WeakSet,xl=async function(_e,et,tt){return withNewSpanContext(async()=>{var rt,it;const nt=et instanceof RunState?et:new RunState(tt.context instanceof RunContext?tt.context:new RunContext(tt.context),et,_e,tt.maxTurns??DEFAULT_MAX_TURNS);try{for(;;){let st=selectModel(nt._currentAgent.model,this.config.model);if(typeof st=="string"&&(st=await this.config.modelProvider.getModel(st)),nt._currentStep=nt._currentStep??{type:"next_step_run_again"},nt._currentStep.type==="next_step_interruption"){if(logger$1.debug("Continuing from interruption"),!nt._lastTurnResponse||!nt._lastProcessedResponse)throw new UserError("No model response found in previous state",nt);const at=await executeInterruptedToolsAndSideEffects(nt._currentAgent,nt._originalInput,nt._generatedItems,nt._lastTurnResponse,nt._lastProcessedResponse,this,nt);if(nt._toolUseTracker.addToolUse(nt._currentAgent,nt._lastProcessedResponse.toolsUsed),nt._originalInput=at.originalInput,nt._generatedItems=at.generatedItems,nt._currentStep=at.nextStep,at.nextStep.type==="next_step_interruption")return new RunResult(nt);continue}if(nt._currentStep.type==="next_step_run_again"){const at=[];if(nt._currentAgent.handoffs&&at.push(...nt._currentAgent.handoffs.map(getHandoff)),!nt._currentAgentSpan){const ft=at.map(mt=>mt.agentName);nt._currentAgentSpan=createAgentSpan({data:{name:nt._currentAgent.name,handoffs:ft,output_type:nt._currentAgent.outputSchemaName}}),nt._currentAgentSpan.start(),setCurrentSpan(nt._currentAgentSpan)}const ot=await nt._currentAgent.getAllTools(),ct=ot.map(ft=>serializeTool(ft)),lt=at.map(ft=>serializeHandoff(ft));if(nt._currentAgentSpan&&(nt._currentAgentSpan.spanData.tools=ot.map(ft=>ft.name)),nt._currentTurn++,nt._currentTurn>nt._maxTurns)throw(rt=nt._currentAgentSpan)==null||rt.setError({message:"Max turns exceeded",data:{max_turns:nt._maxTurns}}),new MaxTurnsExceededError(`Max turns (${nt._maxTurns}) exceeded`,nt);logger$1.debug(`Running agent ${nt._currentAgent.name} (turn ${nt._currentTurn})`),nt._currentTurn===1&&await hn(this,rr,Sl).call(this,nt);const ut=getTurnInput(nt._originalInput,nt._generatedItems);nt._noActiveAgentRun&&(nt._currentAgent.emit("agent_start",nt._context,nt._currentAgent),this.emit("agent_start",nt._context,nt._currentAgent));let pt={...this.config.modelSettings,...nt._currentAgent.modelSettings};pt=maybeResetToolChoice(nt._currentAgent,nt._toolUseTracker,pt),nt._lastTurnResponse=await st.getResponse({systemInstructions:await nt._currentAgent.getSystemPrompt(nt._context),prompt:await nt._currentAgent.getPrompt(nt._context),input:ut,previousResponseId:tt.previousResponseId,modelSettings:pt,tools:ct,outputType:convertAgentOutputTypeToSerializable(nt._currentAgent.outputType),handoffs:lt,tracing:getTracing(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:tt.signal}),nt._modelResponses.push(nt._lastTurnResponse),nt._context.usage.add(nt._lastTurnResponse.usage),nt._noActiveAgentRun=!1;const dt=processModelResponse(nt._lastTurnResponse,nt._currentAgent,ot,at);nt._lastProcessedResponse=dt;const ht=await executeToolsAndSideEffects(nt._currentAgent,nt._originalInput,nt._generatedItems,nt._lastTurnResponse,nt._lastProcessedResponse,this,nt);nt._toolUseTracker.addToolUse(nt._currentAgent,nt._lastProcessedResponse.toolsUsed),nt._originalInput=ht.originalInput,nt._generatedItems=ht.generatedItems,nt._currentStep=ht.nextStep}if(nt._currentStep&&nt._currentStep.type==="next_step_final_output")return await hn(this,rr,El).call(this,nt,nt._currentStep.output),this.emit("agent_end",nt._context,nt._currentAgent,nt._currentStep.output),nt._currentAgent.emit("agent_end",nt._context,nt._currentStep.output),new RunResult(nt);if(nt._currentStep&&nt._currentStep.type==="next_step_handoff")nt._currentAgent=nt._currentStep.newAgent,nt._currentAgentSpan&&(nt._currentAgentSpan.end(),resetCurrentSpan(),nt._currentAgentSpan=void 0),nt._noActiveAgentRun=!0,nt._currentStep={type:"next_step_run_again"};else{if(nt._currentStep&&nt._currentStep.type==="next_step_interruption")return new RunResult(nt);logger$1.debug("Running next loop")}}}catch(st){throw nt._currentAgentSpan&&nt._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(st)}}),st}finally{nt._currentAgentSpan&&(((it=nt._currentStep)==null?void 0:it.type)!=="next_step_interruption"&&nt._currentAgentSpan.end(),resetCurrentSpan())}})},Sl=async function(_e){const et=this.inputGuardrailDefs.concat(_e._currentAgent.inputGuardrails.map(defineInputGuardrail));if(et.length>0){const tt={agent:_e._currentAgent,input:_e._originalInput,context:_e._context};try{const nt=await Promise.all(et.map(async rt=>withGuardrailSpan(async it=>{const st=await rt.run(tt);return it.spanData.triggered=st.output.tripwireTriggered,st},{data:{name:rt.name}},_e._currentAgentSpan)));for(const rt of nt)if(rt.output.tripwireTriggered)throw _e._currentAgentSpan&&_e._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:rt.guardrail.name}}),new InputGuardrailTripwireTriggered(`Input guardrail triggered: ${JSON.stringify(rt.output.outputInfo)}`,rt,_e)}catch(nt){throw nt instanceof InputGuardrailTripwireTriggered?nt:(_e._currentTurn--,new GuardrailExecutionError(`Input guardrail failed to complete: ${nt}`,nt,_e))}}},El=async function(_e,et){const tt=this.outputGuardrailDefs.concat(_e._currentAgent.outputGuardrails.map(defineOutputGuardrail));if(tt.length>0){const nt=_e._currentAgent.processFinalOutput(et),rt={agent:_e._currentAgent,agentOutput:nt,context:_e._context,details:{modelResponse:_e._lastTurnResponse}};try{const it=await Promise.all(tt.map(async st=>withGuardrailSpan(async at=>{const ot=await st.run(rt);return at.spanData.triggered=ot.output.tripwireTriggered,ot},{data:{name:st.name}},_e._currentAgentSpan)));for(const st of it)if(st.output.tripwireTriggered)throw _e._currentAgentSpan&&_e._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:st.guardrail.name}}),new OutputGuardrailTripwireTriggered(`Output guardrail triggered: ${JSON.stringify(st.output.outputInfo)}`,st,_e)}catch(it){throw it instanceof OutputGuardrailTripwireTriggered?it:new GuardrailExecutionError(`Output guardrail failed to complete: ${it}`,it,_e)}}},tu=async function(_e,et){var tt,nt,rt;try{for(;;){const it=_e.state._currentAgent,st=it.handoffs.map(getHandoff),at=await it.getAllTools(),ot=at.map(lt=>serializeTool(lt)),ct=st.map(lt=>serializeHandoff(lt));if(_e.state._currentStep=_e.state._currentStep??{type:"next_step_run_again"},_e.state._currentStep.type==="next_step_interruption"){if(logger$1.debug("Continuing from interruption"),!_e.state._lastTurnResponse||!_e.state._lastProcessedResponse)throw new UserError("No model response found in previous state",_e.state);const lt=await executeInterruptedToolsAndSideEffects(_e.state._currentAgent,_e.state._originalInput,_e.state._generatedItems,_e.state._lastTurnResponse,_e.state._lastProcessedResponse,this,_e.state);if(addStepToRunResult(_e,lt),_e.state._toolUseTracker.addToolUse(_e.state._currentAgent,_e.state._lastProcessedResponse.toolsUsed),_e.state._originalInput=lt.originalInput,_e.state._generatedItems=lt.generatedItems,_e.state._currentStep=lt.nextStep,lt.nextStep.type==="next_step_interruption")return;continue}if(_e.state._currentStep.type==="next_step_run_again"){if(!_e.state._currentAgentSpan){const mt=st.map(gt=>gt.agentName);_e.state._currentAgentSpan=createAgentSpan({data:{name:it.name,handoffs:mt,tools:at.map(gt=>gt.name),output_type:it.outputSchemaName}}),_e.state._currentAgentSpan.start(),setCurrentSpan(_e.state._currentAgentSpan)}if(_e.state._currentTurn++,_e.state._currentTurn>_e.state._maxTurns)throw(tt=_e.state._currentAgentSpan)==null||tt.setError({message:"Max turns exceeded",data:{max_turns:_e.state._maxTurns}}),new MaxTurnsExceededError(`Max turns (${_e.state._maxTurns}) exceeded`,_e.state);logger$1.debug(`Running agent ${it.name} (turn ${_e.state._currentTurn})`);let lt=selectModel(it.model,this.config.model);typeof lt=="string"&&(lt=await this.config.modelProvider.getModel(lt)),_e.state._currentTurn===1&&await hn(this,rr,Sl).call(this,_e.state);let ut={...this.config.modelSettings,...it.modelSettings};ut=maybeResetToolChoice(it,_e.state._toolUseTracker,ut);const pt=getTurnInput(_e.input,_e.newItems);_e.state._noActiveAgentRun&&(it.emit("agent_start",_e.state._context,it),this.emit("agent_start",_e.state._context,it));let dt;for await(const mt of lt.getStreamedResponse({systemInstructions:await it.getSystemPrompt(_e.state._context),prompt:await it.getPrompt(_e.state._context),input:pt,previousResponseId:et.previousResponseId,modelSettings:ut,tools:ot,handoffs:ct,outputType:convertAgentOutputTypeToSerializable(it.outputType),tracing:getTracing(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:et.signal})){if(mt.type==="response_done"){const gt=StreamEventResponseCompleted.parse(mt);dt={usage:new Usage(gt.response.usage),output:gt.response.output,responseId:gt.response.id}}if(_e.cancelled)return;_e._addItem(new RunRawModelStreamEvent(mt))}if(_e.state._noActiveAgentRun=!1,!dt)throw new ModelBehaviorError("Model did not procude a final response!",_e.state);_e.state._lastTurnResponse=dt,_e.state._modelResponses.push(_e.state._lastTurnResponse);const ht=processModelResponse(_e.state._lastTurnResponse,it,at,st);_e.state._lastProcessedResponse=ht;const ft=await executeToolsAndSideEffects(it,_e.state._originalInput,_e.state._generatedItems,_e.state._lastTurnResponse,_e.state._lastProcessedResponse,this,_e.state);addStepToRunResult(_e,ft),_e.state._toolUseTracker.addToolUse(it,ht.toolsUsed),_e.state._originalInput=ft.originalInput,_e.state._generatedItems=ft.generatedItems,_e.state._currentStep=ft.nextStep}if(_e.state._currentStep.type==="next_step_final_output"){await hn(this,rr,El).call(this,_e.state,_e.state._currentStep.output);return}else{if(_e.state._currentStep.type==="next_step_interruption")return;_e.state._currentStep.type==="next_step_handoff"?(_e.state._currentAgent=(nt=_e.state._currentStep)==null?void 0:nt.newAgent,_e.state._currentAgentSpan&&(_e.state._currentAgentSpan.end(),resetCurrentSpan()),_e.state._currentAgentSpan=void 0,_e._addItem(new RunAgentUpdatedStreamEvent(it)),_e.state._noActiveAgentRun=!0,_e.state._currentStep={type:"next_step_run_again"}):logger$1.debug("Running next loop")}}}catch(it){throw _e.state._currentAgentSpan&&_e.state._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(it)}}),it}finally{_e.state._currentAgentSpan&&(((rt=_e.state._currentStep)==null?void 0:rt.type)!=="next_step_interruption"&&_e.state._currentAgentSpan.end(),resetCurrentSpan())}},Tl=async function(_e,et,tt){return tt=tt??{},withNewSpanContext(async()=>{const nt=et instanceof RunState?et:new RunState(tt.context instanceof RunContext?tt.context:new RunContext(tt.context),et,_e,tt.maxTurns??DEFAULT_MAX_TURNS),rt=new StreamedRunResult({signal:tt.signal,state:nt});return rt.maxTurns=tt.maxTurns??nt._maxTurns,hn(this,rr,tu).call(this,rt,tt).then(()=>{rt._done()},it=>{rt._raiseError(it)}),rt})};function selectModel(j,$){return typeof j=="string"&&j!==Agent.DEFAULT_MODEL_PLACEHOLDER||j?j:$??j??Agent.DEFAULT_MODEL_PLACEHOLDER}const Es=class Es extends AgentHooks{constructor(_e){super();Wt(this,"name");Wt(this,"instructions");Wt(this,"prompt");Wt(this,"handoffDescription");Wt(this,"handoffs");Wt(this,"model");Wt(this,"modelSettings");Wt(this,"tools");Wt(this,"mcpServers");Wt(this,"inputGuardrails");Wt(this,"outputGuardrails");Wt(this,"outputType","text");Wt(this,"toolUseBehavior");Wt(this,"resetToolChoice");if(typeof _e.name!="string"||_e.name.trim()==="")throw new UserError("Agent must have a name.");if(this.name=_e.name,this.instructions=_e.instructions??Es.DEFAULT_MODEL_PLACEHOLDER,this.prompt=_e.prompt,this.handoffDescription=_e.handoffDescription??"",this.handoffs=_e.handoffs??[],this.model=_e.model??"",this.modelSettings=_e.modelSettings??{},this.tools=_e.tools??[],this.mcpServers=_e.mcpServers??[],this.inputGuardrails=_e.inputGuardrails??[],this.outputGuardrails=_e.outputGuardrails??[],_e.outputType&&(this.outputType=_e.outputType),this.toolUseBehavior=_e.toolUseBehavior??"run_llm_again",this.resetToolChoice=_e.resetToolChoice??!0,(_e.handoffOutputTypeWarningEnabled===void 0||_e.handoffOutputTypeWarningEnabled)&&this.handoffs&&this.outputType){const et=new Set([JSON.stringify(this.outputType)]);for(const tt of this.handoffs)"outputType"in tt&&tt.outputType?et.add(JSON.stringify(tt.outputType)):"agent"in tt&&tt.agent.outputType&&et.add(JSON.stringify(tt.agent.outputType));et.size>1&&logger$1.warn(`[Agent] Warning: Handoff agents have different output types: ${Array.from(et).join(", ")}. You can make it type-safe by using Agent.create({ ... }) method instead.`)}}static create(_e){return new Es({..._e,handoffs:_e.handoffs,outputType:_e.outputType,handoffOutputTypeWarningEnabled:!1})}get outputSchemaName(){if(this.outputType==="text")return"text";if(isZodObject(this.outputType))return"ZodOutput";if(typeof this.outputType=="object")return this.outputType.name;throw new Error(`Unknown output type: ${this.outputType}`)}clone(_e){return new Es({...this,..._e})}asTool(_e){const{toolName:et,toolDescription:tt,customOutputExtractor:nt}=_e;return tool({name:et??toFunctionToolName(this.name),description:tt??"",parameters:{type:"object",properties:{input:{type:"string"}},required:["input"],additionalProperties:!1},strict:!0,execute:async(rt,it)=>{if(!isAgentToolInput(rt))throw new ModelBehaviorError("Agent tool called with invalid input");const at=await new Runner().run(this,rt.input,{context:it==null?void 0:it.context});return typeof nt=="function"?nt(at):getOutputText(at.rawResponses[at.rawResponses.length-1])}})}async getSystemPrompt(_e){return typeof this.instructions=="function"?await this.instructions(_e,this):this.instructions}async getPrompt(_e){return typeof this.prompt=="function"?await this.prompt(_e,this):this.prompt}async getMcpTools(){return this.mcpServers.length>0?getAllMcpTools(this.mcpServers):[]}async getAllTools(){return[...await this.getMcpTools(),...this.tools]}processFinalOutput(_e){if(this.outputType==="text")return _e;if(typeof this.outputType=="object"){const et=JSON.parse(_e);return isZodObject(this.outputType)?this.outputType.parse(et):et}throw new Error(`Unknown output type: ${this.outputType}`)}toJSON(){return{name:this.name}}};Wt(Es,"DEFAULT_MODEL_PLACEHOLDER","");let Agent=Es;addTraceProcessor(defaultProcessor());class RealtimeAgent extends Agent{constructor(_e){super(_e);Wt(this,"voice");this.voice=_e.voice??"ash"}}function getRealtimeGuardrailSettings(j){return{debounceTextLength:j.debounceTextLength??100}}function defineRealtimeOutputGuardrail({policyHint:j,...$}){const _e=defineOutputGuardrail($),et=j??_e.name;return{..._e,policyHint:et,run:async tt=>{const nt=await _e.run(tt);return{...nt,guardrail:{...nt.guardrail,policyHint:et}}}}}function getRealtimeGuardrailFeedbackMessage(j){return`
 Your last answer was blocked. 
Failed Guardrail Reason: ${j.guardrail.policyHint}. 
Failure Details: ${JSON.stringify(j.output.outputInfo??{})}. 
Please respond again following policy. Apologize for not being able to answer the question (while avoiding the specific reason) and divert discussion back to an approved topic immediately and not invite more discussion.
`.trim()}const logger=getLogger("openai-agents:realtime");objectType({itemId:stringType()});const realtimeMessageItemSchema=discriminatedUnionType("role",[objectType({itemId:stringType(),previousItemId:stringType().nullable().optional(),type:literalType("message"),role:literalType("system"),content:arrayType(objectType({type:literalType("input_text"),text:stringType()}))}),objectType({itemId:stringType(),previousItemId:stringType().nullable().optional(),type:literalType("message"),role:literalType("user"),status:enumType(["in_progress","completed"]),content:arrayType(objectType({type:literalType("input_text"),text:stringType()}).or(objectType({type:literalType("input_audio"),audio:stringType().nullable().optional(),transcript:stringType().nullable()})))}),objectType({itemId:stringType(),previousItemId:stringType().nullable().optional(),type:literalType("message"),role:literalType("assistant"),status:enumType(["in_progress","completed","incomplete"]),content:arrayType(objectType({type:literalType("text"),text:stringType()}).or(objectType({type:literalType("audio"),audio:stringType().nullable().optional(),transcript:stringType().nullable().optional()})))})]),realtimeToolCallItem=objectType({itemId:stringType(),previousItemId:stringType().nullable().optional(),type:literalType("function_call"),status:enumType(["in_progress","completed"]),arguments:stringType(),name:stringType(),output:stringType().nullable()}),realtimeResponse=objectType({id:stringType().optional().nullable(),conversation_id:stringType().optional().nullable(),max_output_tokens:numberType().or(literalType("inf")).optional().nullable(),metadata:recordType(stringType(),anyType()).optional().nullable(),modalities:arrayType(stringType()).optional().nullable(),object:literalType("realtime.response").optional().nullable(),output:arrayType(anyType()).optional().nullable(),output_audio_format:stringType().optional().nullable(),status:enumType(["completed","incomplete","failed","cancelled","in_progress"]).optional().nullable(),status_details:recordType(stringType(),anyType()).optional().nullable(),usage:objectType({input_tokens:numberType().optional(),input_tokens_details:recordType(stringType(),anyType()).optional().nullable(),output_tokens:numberType().optional(),output_tokens_details:recordType(stringType(),anyType()).optional().nullable()}).optional().nullable(),voice:stringType().optional().nullable()}),conversationItemContentSchema=objectType({id:stringType().optional(),audio:stringType().nullable().optional(),text:stringType().nullable().optional(),transcript:stringType().nullable().optional(),type:unionType([literalType("input_text"),literalType("input_audio"),literalType("item_reference"),literalType("text"),literalType("audio")])}),conversationItemSchema=objectType({id:stringType().optional(),arguments:stringType().optional(),call_id:stringType().optional(),content:arrayType(conversationItemContentSchema).optional(),name:stringType().optional(),object:literalType("realtime.item").optional(),output:stringType().optional(),role:enumType(["user","assistant","system"]).optional(),status:enumType(["completed","incomplete","in_progress"]).optional(),type:enumType(["message","function_call","function_call_output"]).optional()}),conversationCreatedEventSchema=objectType({type:literalType("conversation.created"),event_id:stringType(),conversation:objectType({id:stringType().optional(),object:literalType("realtime.conversation").optional()})}),conversationItemCreatedEventSchema=objectType({type:literalType("conversation.item.created"),event_id:stringType(),item:conversationItemSchema,previous_item_id:stringType().nullable().optional()}),conversationItemDeletedEventSchema=objectType({type:literalType("conversation.item.deleted"),event_id:stringType(),item_id:stringType()}),conversationItemInputAudioTranscriptionCompletedEventSchema=objectType({type:literalType("conversation.item.input_audio_transcription.completed"),event_id:stringType(),item_id:stringType(),content_index:numberType(),transcript:stringType(),logprobs:arrayType(anyType()).nullable().optional()}),conversationItemInputAudioTranscriptionDeltaEventSchema=objectType({type:literalType("conversation.item.input_audio_transcription.delta"),event_id:stringType(),item_id:stringType(),content_index:numberType().optional(),delta:stringType().optional(),logprobs:arrayType(anyType()).nullable().optional()}),conversationItemInputAudioTranscriptionFailedEventSchema=objectType({type:literalType("conversation.item.input_audio_transcription.failed"),event_id:stringType(),item_id:stringType(),content_index:numberType(),error:objectType({code:stringType().optional(),message:stringType().optional(),param:stringType().optional(),type:stringType().optional()})}),conversationItemRetrievedEventSchema=objectType({type:literalType("conversation.item.retrieved"),event_id:stringType(),item:conversationItemSchema}),conversationItemTruncatedEventSchema=objectType({type:literalType("conversation.item.truncated"),event_id:stringType(),item_id:stringType(),audio_end_ms:numberType(),content_index:numberType()}),conversationItemCreateEventSchema=objectType({type:literalType("conversation.item.create"),item:conversationItemSchema,event_id:stringType().optional(),previous_item_id:stringType().nullable().optional()}),conversationItemDeleteEventSchema=objectType({type:literalType("conversation.item.delete"),item_id:stringType(),event_id:stringType().optional()}),conversationItemRetrieveEventSchema=objectType({type:literalType("conversation.item.retrieve"),item_id:stringType(),event_id:stringType().optional()}),conversationItemTruncateEventSchema=objectType({type:literalType("conversation.item.truncate"),item_id:stringType(),audio_end_ms:numberType(),content_index:numberType(),event_id:stringType().optional()}),errorEventSchema=objectType({type:literalType("error"),event_id:stringType().optional(),error:anyType().optional()}),inputAudioBufferClearedEventSchema=objectType({type:literalType("input_audio_buffer.cleared"),event_id:stringType()}),inputAudioBufferAppendEventSchema=objectType({type:literalType("input_audio_buffer.append"),audio:stringType(),event_id:stringType().optional()}),inputAudioBufferClearEventSchema=objectType({type:literalType("input_audio_buffer.clear"),event_id:stringType().optional()}),inputAudioBufferCommitEventSchema=objectType({type:literalType("input_audio_buffer.commit"),event_id:stringType().optional()}),inputAudioBufferCommittedEventSchema=objectType({type:literalType("input_audio_buffer.committed"),event_id:stringType(),item_id:stringType(),previous_item_id:stringType().nullable().optional()}),inputAudioBufferSpeechStartedEventSchema=objectType({type:literalType("input_audio_buffer.speech_started"),event_id:stringType(),item_id:stringType(),audio_start_ms:numberType()}),inputAudioBufferSpeechStoppedEventSchema=objectType({type:literalType("input_audio_buffer.speech_stopped"),event_id:stringType(),item_id:stringType(),audio_end_ms:numberType()}),outputAudioBufferStartedEventSchema=objectType({type:literalType("output_audio_buffer.started"),event_id:stringType()}).passthrough(),outputAudioBufferStoppedEventSchema=objectType({type:literalType("output_audio_buffer.stopped"),event_id:stringType()}).passthrough(),outputAudioBufferClearedEventSchema=objectType({type:literalType("output_audio_buffer.cleared"),event_id:stringType()}),rateLimitsUpdatedEventSchema=objectType({type:literalType("rate_limits.updated"),event_id:stringType(),rate_limits:arrayType(objectType({limit:numberType().optional(),name:enumType(["requests","tokens"]).optional(),remaining:numberType().optional(),reset_seconds:numberType().optional()}))}),responseAudioDeltaEventSchema=objectType({type:literalType("response.audio.delta"),event_id:stringType(),item_id:stringType(),content_index:numberType(),delta:stringType(),output_index:numberType(),response_id:stringType()}),responseAudioDoneEventSchema=objectType({type:literalType("response.audio.done"),event_id:stringType(),item_id:stringType(),content_index:numberType(),output_index:numberType(),response_id:stringType()}),responseAudioTranscriptDeltaEventSchema=objectType({type:literalType("response.audio_transcript.delta"),event_id:stringType(),item_id:stringType(),content_index:numberType(),delta:stringType(),output_index:numberType(),response_id:stringType()}),responseAudioTranscriptDoneEventSchema=objectType({type:literalType("response.audio_transcript.done"),event_id:stringType(),item_id:stringType(),content_index:numberType(),transcript:stringType(),output_index:numberType(),response_id:stringType()}),responseContentPartAddedEventSchema=objectType({type:literalType("response.content_part.added"),event_id:stringType(),item_id:stringType(),content_index:numberType(),output_index:numberType(),response_id:stringType(),part:objectType({audio:stringType().optional(),text:stringType().optional(),transcript:stringType().optional(),type:enumType(["text","audio"]).optional()})}),responseContentPartDoneEventSchema=objectType({type:literalType("response.content_part.done"),event_id:stringType(),item_id:stringType(),content_index:numberType(),output_index:numberType(),response_id:stringType(),part:objectType({audio:stringType().optional(),text:stringType().optional(),transcript:stringType().optional(),type:enumType(["text","audio"]).optional()})}),responseCreatedEventSchema=objectType({type:literalType("response.created"),event_id:stringType(),response:realtimeResponse}),responseDoneEventSchema=objectType({type:literalType("response.done"),event_id:stringType(),response:realtimeResponse}),responseFunctionCallArgumentsDeltaEventSchema=objectType({type:literalType("response.function_call_arguments.delta"),event_id:stringType(),item_id:stringType(),call_id:stringType(),delta:stringType(),output_index:numberType(),response_id:stringType()}),responseFunctionCallArgumentsDoneEventSchema=objectType({type:literalType("response.function_call_arguments.done"),event_id:stringType(),item_id:stringType(),call_id:stringType(),arguments:stringType(),output_index:numberType(),response_id:stringType()}),responseOutputItemAddedEventSchema=objectType({type:literalType("response.output_item.added"),event_id:stringType(),item:conversationItemSchema,output_index:numberType(),response_id:stringType()}),responseOutputItemDoneEventSchema=objectType({type:literalType("response.output_item.done"),event_id:stringType(),item:conversationItemSchema,output_index:numberType(),response_id:stringType()}),responseTextDeltaEventSchema=objectType({type:literalType("response.text.delta"),event_id:stringType(),item_id:stringType(),content_index:numberType(),delta:stringType(),output_index:numberType(),response_id:stringType()}),responseTextDoneEventSchema=objectType({type:literalType("response.text.done"),event_id:stringType(),item_id:stringType(),content_index:numberType(),text:stringType(),output_index:numberType(),response_id:stringType()}),sessionCreatedEventSchema=objectType({type:literalType("session.created"),event_id:stringType(),session:anyType()}),sessionUpdatedEventSchema=objectType({type:literalType("session.updated"),event_id:stringType(),session:anyType()}),responseCancelEventSchema=objectType({type:literalType("response.cancel"),event_id:stringType().optional(),response_id:stringType().optional()}),responseCreateEventSchema=objectType({type:literalType("response.create"),event_id:stringType().optional(),response:anyType().optional()}),sessionUpdateEventSchema=objectType({type:literalType("session.update"),event_id:stringType().optional(),session:anyType()}),transcriptionSessionUpdateEventSchema=objectType({type:literalType("transcription_session.update"),event_id:stringType().optional(),session:anyType()}),transcriptionSessionUpdatedEventSchema=objectType({type:literalType("transcription_session.updated"),event_id:stringType(),session:anyType()}),genericEventSchema=objectType({type:stringType(),event_id:stringType().optional().nullable()}).passthrough(),realtimeServerEventSchema=discriminatedUnionType("type",[conversationCreatedEventSchema,conversationItemCreatedEventSchema,conversationItemDeletedEventSchema,conversationItemInputAudioTranscriptionCompletedEventSchema,conversationItemInputAudioTranscriptionDeltaEventSchema,conversationItemInputAudioTranscriptionFailedEventSchema,conversationItemRetrievedEventSchema,conversationItemTruncatedEventSchema,errorEventSchema,inputAudioBufferClearedEventSchema,inputAudioBufferCommittedEventSchema,inputAudioBufferSpeechStartedEventSchema,inputAudioBufferSpeechStoppedEventSchema,outputAudioBufferStartedEventSchema,outputAudioBufferStoppedEventSchema,outputAudioBufferClearedEventSchema,rateLimitsUpdatedEventSchema,responseAudioDeltaEventSchema,responseAudioDoneEventSchema,responseAudioTranscriptDeltaEventSchema,responseAudioTranscriptDoneEventSchema,responseContentPartAddedEventSchema,responseContentPartDoneEventSchema,responseCreatedEventSchema,responseDoneEventSchema,responseFunctionCallArgumentsDeltaEventSchema,responseFunctionCallArgumentsDoneEventSchema,responseOutputItemAddedEventSchema,responseOutputItemDoneEventSchema,responseTextDeltaEventSchema,responseTextDoneEventSchema,sessionCreatedEventSchema,sessionUpdatedEventSchema,transcriptionSessionUpdatedEventSchema]);discriminatedUnionType("type",[conversationItemCreateEventSchema,conversationItemDeleteEventSchema,conversationItemRetrieveEventSchema,conversationItemTruncateEventSchema,inputAudioBufferAppendEventSchema,inputAudioBufferClearEventSchema,inputAudioBufferCommitEventSchema,responseCancelEventSchema,responseCreateEventSchema,sessionUpdateEventSchema,transcriptionSessionUpdateEventSchema]);function parseRealtimeEvent(j){const $=JSON.parse(j.data.toString()),_e=realtimeServerEventSchema.safeParse($);if(!_e.success){const et=genericEventSchema.safeParse($);return et.success?{data:et.data,isGeneric:!0}:{data:null,isGeneric:!0}}return{data:_e.data,isGeneric:!1}}const DEFAULT_OPENAI_REALTIME_MODEL="gpt-4o-realtime-preview",DEFAULT_OPENAI_REALTIME_SESSION_CONFIG={voice:"ash",modalities:["text","audio"],inputAudioFormat:"pcm16",outputAudioFormat:"pcm16",inputAudioTranscription:{model:"gpt-4o-mini-transcribe"},turnDetection:{type:"semantic_vad"}};var ps,_o,fr;const Pl=class Pl extends EventEmitterDelegate{constructor(_e={}){super();zt(this,ps);zt(this,_o);zt(this,fr,null);Wt(this,"eventEmitter",new BrowserEventEmitter);Dt(this,ps,_e.model??DEFAULT_OPENAI_REALTIME_MODEL),Dt(this,_o,_e.apiKey)}get currentModel(){return bt(this,ps)}set currentModel(_e){Dt(this,ps,_e)}async _getApiKey(_e){const et=_e.apiKey??bt(this,_o);return typeof et=="function"?await et():et}_onMessage(_e){var nt,rt,it,st,at,ot;const{data:et,isGeneric:tt}=parseRealtimeEvent(_e);if(et!==null&&(this.emit("*",et),!tt)){if(et.type==="error"?this.emit("error",{type:"error",error:et}):this.emit(et.type,et),et.type==="response.created"){this.emit("turn_started",{type:"response_started",providerData:{...et}});return}if(et.type==="response.done"){const ct=responseDoneEventSchema.safeParse(et);if(!ct.success){logger.error("Error parsing response done event",ct.error);return}const lt=((nt=ct.data.response.usage)==null?void 0:nt.input_tokens)??0,ut=((rt=ct.data.response.usage)==null?void 0:rt.output_tokens)??0,pt=lt+ut,dt=new Usage({inputTokens:lt,inputTokensDetails:((it=ct.data.response.usage)==null?void 0:it.input_tokens_details)??{},outputTokens:ut,outputTokensDetails:((st=ct.data.response.usage)==null?void 0:st.output_tokens_details)??{},totalTokens:pt});this.emit("usage_update",dt),this.emit("turn_done",{type:"response_done",response:{id:ct.data.response.id??"",output:ct.data.response.output??[],usage:{inputTokens:lt,inputTokensDetails:((at=ct.data.response.usage)==null?void 0:at.input_tokens_details)??{},outputTokens:ut,outputTokensDetails:((ot=ct.data.response.usage)==null?void 0:ot.output_tokens_details)??{},totalTokens:pt}}});return}if(et.type==="response.audio.done"){this.emit("audio_done");return}if(et.type==="conversation.item.deleted"){this.emit("item_deleted",{itemId:et.item_id});return}if(et.type==="conversation.item.input_audio_transcription.completed"||et.type==="conversation.item.truncated"){this.sendEvent({type:"conversation.item.retrieve",item_id:et.item_id});return}if(et.type==="conversation.item.input_audio_transcription.delta"||et.type==="response.text.delta"||et.type==="response.audio_transcript.delta"||et.type==="response.function_call_arguments.delta"){et.type==="response.audio_transcript.delta"&&this.emit("audio_transcript_delta",{type:"transcript_delta",delta:et.delta,itemId:et.item_id,responseId:et.response_id});return}if((et.type==="conversation.item.created"||et.type==="conversation.item.retrieved")&&et.item.type==="message"){const ct=et.type==="conversation.item.created"?et.previous_item_id:null,lt=realtimeMessageItemSchema.parse({itemId:et.item.id,previousItemId:ct,type:et.item.type,role:et.item.role,content:et.item.content,status:et.item.status});this.emit("item_update",lt);return}if(et.type==="response.output_item.done"||et.type==="response.output_item.added"){const ct=et.item;if(ct.type==="function_call"&&ct.status==="completed"){const lt=realtimeToolCallItem.parse({itemId:ct.id,type:ct.type,status:"in_progress",arguments:ct.arguments,name:ct.name,output:null});this.emit("item_update",lt),this.emit("function_call",{id:ct.id,type:"function_call",callId:ct.call_id??"",arguments:ct.arguments??"",name:ct.name??""});return}if(ct.type==="message"){const lt=realtimeMessageItemSchema.parse({itemId:et.item.id,type:et.item.type,role:et.item.role,content:et.item.content,status:"in_progress"});this.emit("item_update",lt);return}}}}_onError(_e){this.emit("error",{type:"error",error:_e})}_onOpen(){this.emit("connected")}_onClose(){this.emit("disconnected")}sendMessage(_e,et){this.sendEvent({type:"conversation.item.create",item:typeof _e=="string"?{type:"message",role:"user",content:[{type:"input_text",text:_e}]}:_e,...et}),this.sendEvent({type:"response.create"})}_getMergedSessionConfig(_e){var tt;return{instructions:_e.instructions,model:_e.model??bt(this,ps)??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.model,voice:_e.voice??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.voice,modalities:_e.modalities??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.modalities,input_audio_format:_e.inputAudioFormat??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.inputAudioFormat,output_audio_format:_e.outputAudioFormat??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.outputAudioFormat,input_audio_transcription:_e.inputAudioTranscription??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.inputAudioTranscription,turn_detection:Pl.buildTurnDetectionConfig(_e.turnDetection)??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.turnDetection,tool_choice:_e.toolChoice??DEFAULT_OPENAI_REALTIME_SESSION_CONFIG.toolChoice,tools:(tt=_e.tools)==null?void 0:tt.map(nt=>({...nt,strict:void 0})),..._e.providerData??{}}}static buildTurnDetectionConfig(_e){if(typeof _e>"u")return;const{type:et,createResponse:tt,create_response:nt,eagerness:rt,interruptResponse:it,interrupt_response:st,prefixPaddingMs:at,prefix_padding_ms:ot,silenceDurationMs:ct,silence_duration_ms:lt,threshold:ut,...pt}=_e,dt={type:et,create_response:tt||nt,eagerness:rt,interrupt_response:it||st,prefix_padding_ms:at||ot,silence_duration_ms:ct||lt,threshold:ut,...pt};return Object.keys(dt).forEach(ht=>{dt[ht]===void 0&&delete dt[ht]}),Object.keys(dt).length>0?dt:void 0}set _tracingConfig(_e){Dt(this,fr,_e)}_updateTracingConfig(_e){var et,tt,nt;if(typeof bt(this,fr)>"u"&&Dt(this,fr,null),_e==="auto"){this.sendEvent({type:"session.update",session:{tracing:"auto"}});return}if(typeof bt(this,fr)!="string"&&typeof _e!="string"){logger.warn("Tracing config is already set, skipping setting it again. This likely happens when you already set a tracing config on session creation.");return}if(_e===null){logger.debug("Disabling tracing for this session. It cannot be turned on for this session from this point on."),this.sendEvent({type:"session.update",session:{tracing:null}});return}if(bt(this,fr)===null||typeof bt(this,fr)=="string"){this.sendEvent({type:"session.update",session:{tracing:_e}});return}if((_e==null?void 0:_e.group_id)!==((et=bt(this,fr))==null?void 0:et.group_id)||(_e==null?void 0:_e.metadata)!==((tt=bt(this,fr))==null?void 0:tt.metadata)||(_e==null?void 0:_e.workflow_name)!==((nt=bt(this,fr))==null?void 0:nt.workflow_name)){logger.warn("Mismatch in tracing config. Ignoring the new tracing config. This likely happens when you already set a tracing config on session creation. Current tracing config: %s, new tracing config: %s",JSON.stringify(bt(this,fr)),JSON.stringify(_e));return}this.sendEvent({type:"session.update",session:{tracing:_e}})}updateSessionConfig(_e){const et=this._getMergedSessionConfig(_e);this.sendEvent({type:"session.update",session:et})}sendFunctionCallOutput(_e,et,tt=!0){this.sendEvent({type:"conversation.item.create",item:{type:"function_call_output",output:et,call_id:_e.callId}});try{const nt=realtimeToolCallItem.parse({itemId:_e.id,previousItemId:_e.previousItemId,type:"function_call",status:"completed",arguments:_e.arguments,name:_e.name,output:et});this.emit("item_update",nt)}catch(nt){logger.error("Error parsing tool call item",nt,_e)}tt&&this.sendEvent({type:"response.create"})}sendAudio(_e,{commit:et=!1}={}){this.sendEvent({type:"input_audio_buffer.append",audio:arrayBufferToBase64(_e)}),et&&this.sendEvent({type:"input_audio_buffer.commit"})}resetHistory(_e,et){const{removals:tt,additions:nt,updates:rt}=diffRealtimeHistory(_e,et),it=new Set(tt.map(at=>at.itemId));for(const at of rt)it.add(at.itemId);if(it.size>0)for(const at of it)this.sendEvent({type:"conversation.item.delete",item_id:at});const st=[...nt,...rt];for(const at of st)if(at.type==="message"){const ot={type:"message",role:at.role,content:at.content,id:at.itemId};at.role!=="system"&&at.status&&(ot.status=at.status),this.sendEvent({type:"conversation.item.create",item:ot})}else at.type==="function_call"&&logger.warn("Function calls cannot be manually added or updated at the moment. Ignoring.")}};ps=new WeakMap,_o=new WeakMap,fr=new WeakMap;let OpenAIRealtimeBase=Pl;var Po,zn,Ao,hs,jo;class OpenAIRealtimeWebRTC extends OpenAIRealtimeBase{constructor(_e={}){if(typeof RTCPeerConnection>"u")throw new Error("WebRTC is not supported in this environment");super(_e);Wt(this,"options");zt(this,Po);zt(this,zn,{status:"disconnected",peerConnection:void 0,dataChannel:void 0});zt(this,Ao);zt(this,hs,!1);zt(this,jo,!1);this.options=_e,Dt(this,Po,_e.baseUrl??"https://api.openai.com/v1/realtime"),Dt(this,Ao,_e.useInsecureApiKey??!1)}get status(){return bt(this,zn).status}get connectionState(){return bt(this,zn)}get muted(){return bt(this,jo)}async connect(_e){if(bt(this,zn).status==="connected")return;bt(this,zn).status==="connecting"&&logger.warn("Realtime connection already in progress. Please await original promise");const et=_e.model??this.currentModel;this.currentModel=et;const tt=_e.url??bt(this,Po),nt=await this._getApiKey(_e),rt=typeof nt=="string"&&nt.startsWith("ek_");if(!bt(this,Ao)&&!rt)throw new UserError("Using the WebRTC connection in a browser environment requires an insecure API key. Please use a WebSocket connection instead or set the useInsecureApiKey option to true.");return new Promise(async(it,st)=>{try{const at={..._e.initialSessionConfig||{},model:this.currentModel},ot=new URL(tt);let ct=new RTCPeerConnection;const lt=ct.createDataChannel("oai-events");Dt(this,zn,{status:"connecting",peerConnection:ct,dataChannel:lt}),this.emit("connection_change",bt(this,zn).status),lt.addEventListener("open",()=>{Dt(this,zn,{status:"connected",peerConnection:ct,dataChannel:lt}),this.updateSessionConfig(at),this.emit("connection_change",bt(this,zn).status),this._onOpen(),it()}),lt.addEventListener("error",yt=>{this.close(),this._onError(yt),st(yt)}),lt.addEventListener("message",yt=>{this._onMessage(yt);const{data:vt,isGeneric:xt}=parseRealtimeEvent(yt);!vt||xt||(vt.type==="response.created"?Dt(this,hs,!0):vt.type==="response.done"&&Dt(this,hs,!1),vt.type==="session.created"&&(this._tracingConfig=vt.session.tracing,this._updateTracingConfig(at.tracing??"auto")))});const ut=this.options.audioElement??document.createElement("audio");ut.autoplay=!0,ct.ontrack=yt=>{ut.srcObject=yt.streams[0]};const pt=this.options.mediaStream??await navigator.mediaDevices.getUserMedia({audio:!0});ct.addTrack(pt.getAudioTracks()[0]),this.options.changePeerConnection&&(ct=await this.options.changePeerConnection(ct),Dt(this,zn,{...bt(this,zn),peerConnection:ct}));const dt=await ct.createOffer();if(await ct.setLocalDescription(dt),!dt.sdp)throw new Error("Failed to create offer");const ht={...this._getMergedSessionConfig(at),model:this.currentModel},ft=new FormData;ft.append("sdp",dt.sdp),ft.append("session",JSON.stringify(ht));const gt={type:"answer",sdp:await(await fetch(ot,{method:"POST",body:ft,headers:{Authorization:`Bearer ${nt}`,"X-OpenAI-Agents-SDK":HEADERS["X-OpenAI-Agents-SDK"]}})).text()};await ct.setRemoteDescription(gt)}catch(at){this.close(),this._onError(at),st(at)}})}sendEvent(_e){if(!bt(this,zn).dataChannel||bt(this,zn).dataChannel.readyState!=="open")throw new Error("WebRTC data channel is not connected. Make sure you call `connect()` before sending events.");bt(this,zn).dataChannel.send(JSON.stringify(_e))}mute(_e){Dt(this,jo,_e),bt(this,zn).peerConnection&&bt(this,zn).peerConnection.getSenders().forEach(tt=>{tt.track&&(tt.track.enabled=!_e)})}close(){if(bt(this,zn).dataChannel&&bt(this,zn).dataChannel.close(),bt(this,zn).peerConnection){const _e=bt(this,zn).peerConnection;_e.getSenders().forEach(et=>{var tt;(tt=et.track)==null||tt.stop()}),_e.close()}bt(this,zn).status!=="disconnected"&&(Dt(this,zn,{status:"disconnected",peerConnection:void 0,dataChannel:void 0}),this.emit("connection_change",bt(this,zn).status),this._onClose())}interrupt(){bt(this,hs)&&(this.sendEvent({type:"response.cancel"}),Dt(this,hs,!1)),this.sendEvent({type:"output_audio_buffer.clear"})}}Po=new WeakMap,zn=new WeakMap,Ao=new WeakMap,hs=new WeakMap,jo=new WeakMap;const WebSocket$1=globalThis.WebSocket;var gs,Ks,Jn,Io,Or,ys,vs,zo,nu;class OpenAIRealtimeWebSocket extends OpenAIRealtimeBase{constructor(_e={}){super(_e);zt(this,zo);zt(this,gs);zt(this,Ks);zt(this,Jn,{status:"disconnected",websocket:void 0});zt(this,Io);zt(this,Or);zt(this,ys);Wt(this,"_firstAudioTimestamp");Wt(this,"_audioLengthMs",0);zt(this,vs,!1);Dt(this,Ks,`wss://api.openai.com/v1/realtime?model=${this.currentModel}`),Dt(this,Io,_e.useInsecureApiKey??!1)}get status(){return bt(this,Jn).status}get connectionState(){return bt(this,Jn)}get muted(){return null}get currentItemId(){return bt(this,Or)}_onAudio(_e){this.emit("audio",_e)}async connect(_e){const et=_e.model??this.currentModel;this.currentModel=et,Dt(this,gs,await this._getApiKey(_e)),Dt(this,Ks,_e.url??`wss://api.openai.com/v1/realtime?model=${this.currentModel}`);const tt={..._e.initialSessionConfig||{},model:this.currentModel};await new Promise((nt,rt)=>{try{hn(this,zo,nu).call(this,nt,rt,tt)}catch(it){rt(it)}}),await this.updateSessionConfig(tt)}sendEvent(_e){if(!bt(this,Jn).websocket)throw new Error("WebSocket is not connected. Make sure you call `connect()` before sending events.");bt(this,Jn).websocket.send(JSON.stringify(_e))}close(){var _e;(_e=bt(this,Jn).websocket)==null||_e.close(),Dt(this,Or,void 0),this._firstAudioTimestamp=void 0,this._audioLengthMs=0,Dt(this,ys,void 0)}mute(_e){throw new Error("Mute is not supported for the WebSocket transport. You have to mute the audio input yourself.")}sendAudio(_e,et={}){bt(this,Jn).status==="connected"&&super.sendAudio(_e,et)}_cancelResponse(){bt(this,vs)&&(this.sendEvent({type:"response.cancel"}),Dt(this,vs,!1))}_interrupt(_e){this.emit("audio_interrupted"),this.sendEvent({type:"conversation.item.truncate",item_id:bt(this,Or),content_index:bt(this,ys),audio_end_ms:_e})}interrupt(){if(!bt(this,Or)||typeof this._firstAudioTimestamp!="number")return;this._cancelResponse();const _e=Date.now()-this._firstAudioTimestamp;_e>=0&&_e<this._audioLengthMs&&this._interrupt(_e),Dt(this,Or,void 0),this._firstAudioTimestamp=void 0,this._audioLengthMs=0,Dt(this,ys,void 0)}}gs=new WeakMap,Ks=new WeakMap,Jn=new WeakMap,Io=new WeakMap,Or=new WeakMap,ys=new WeakMap,vs=new WeakMap,zo=new WeakSet,nu=function(_e,et,tt){if(bt(this,Jn).websocket){_e();return}if(!bt(this,gs))throw new UserError("API key is not set. Please call `connect()` with an API key first.");if(!bt(this,gs).startsWith("ek_")&&!bt(this,Io))throw new UserError("Using the WebSocket connection in a browser environment requires an ephemeral client key. If you have to use a regular API key, set the `useInsecureApiKey` option to true.");const nt=["realtime","openai-insecure-api-key."+bt(this,gs),"openai-beta.realtime-v1",WEBSOCKET_META],rt=new WebSocket$1(bt(this,Ks),nt);Dt(this,Jn,{status:"connecting",websocket:rt}),this.emit("connection_change",bt(this,Jn).status),rt.addEventListener("open",()=>{Dt(this,Jn,{status:"connected",websocket:rt}),this.emit("connection_change",bt(this,Jn).status),this._onOpen(),_e()}),rt.addEventListener("error",it=>{this._onError(it),Dt(this,Jn,{status:"disconnected",websocket:void 0}),this.emit("connection_change",bt(this,Jn).status),et(it)}),rt.addEventListener("message",it=>{this._onMessage(it);const{data:st,isGeneric:at}=parseRealtimeEvent(it);if(!(!st||at))if(st.type==="response.audio.delta"){Dt(this,ys,st.content_index),Dt(this,Or,st.item_id),this._firstAudioTimestamp===void 0&&(this._firstAudioTimestamp=Date.now(),this._audioLengthMs=0);const ot=base64ToArrayBuffer(st.delta);this._audioLengthMs+=ot.byteLength/24/2;const ct={type:"audio",data:ot,responseId:st.response_id};this._onAudio(ct)}else st.type==="input_audio_buffer.speech_started"?this.interrupt():st.type==="response.created"?Dt(this,vs,!0):st.type==="response.done"?Dt(this,vs,!1):st.type==="session.created"&&(this._tracingConfig=st.session.tracing,this._updateTracingConfig(tt.tracing??"auto"))}),rt.addEventListener("close",()=>{Dt(this,Jn,{status:"disconnected",websocket:void 0}),this.emit("connection_change",bt(this,Jn).status),this._onClose()})};var Dn,jn,No,An,qs,Hs,Oo,Hn,Do,Gs,Wn,Lo,Fo,ru,Bo,iu,wl,su;class RealtimeSession extends BrowserEventEmitter{constructor(_e,et={}){super();zt(this,Wn);Wt(this,"initialAgent");Wt(this,"options");zt(this,Dn);zt(this,jn);zt(this,No,[]);zt(this,An);zt(this,qs,[]);zt(this,Hs);zt(this,Oo,{});zt(this,Hn,[]);zt(this,Do);zt(this,Gs,{});this.initialAgent=_e,this.options=et,typeof et.transport>"u"&&hasWebRTCSupport()||et.transport==="webrtc"?Dt(this,Dn,new OpenAIRealtimeWebRTC):et.transport==="websocket"||typeof et.transport>"u"?Dt(this,Dn,new OpenAIRealtimeWebSocket):Dt(this,Dn,et.transport),Dt(this,jn,_e),Dt(this,An,new RunContext({...et.context??{},history:bt(this,Hn)})),Dt(this,qs,(et.outputGuardrails??[]).map(defineRealtimeOutputGuardrail)),Dt(this,Hs,getRealtimeGuardrailSettings(et.outputGuardrailSettings??{})),Dt(this,Do,et.historyStoreAudio??!1)}get transport(){return bt(this,Dn)}get currentAgent(){return bt(this,jn)}get usage(){return bt(this,An).usage}get context(){return bt(this,An)}get muted(){return bt(this,Dn).muted}get history(){return bt(this,Hn)}async updateAgent(_e){return bt(this,jn).emit("agent_handoff",bt(this,An),_e),this.emit("agent_handoff",bt(this,An),bt(this,jn),_e),await hn(this,Wn,Lo).call(this,_e),await bt(this,Dn).updateSessionConfig(await hn(this,Wn,Fo).call(this)),_e}async connect(_e){await hn(this,Wn,Lo).call(this,this.initialAgent),hn(this,Wn,su).call(this),await bt(this,Dn).connect({apiKey:_e.apiKey??this.options.apiKey,model:this.options.model,initialSessionConfig:await hn(this,Wn,Fo).call(this,this.options.config)}),Dt(this,Hn,[]),this.emit("history_updated",bt(this,Hn))}updateHistory(_e){let et;typeof _e=="function"?et=_e(bt(this,Hn)):et=_e,bt(this,Dn).resetHistory(bt(this,Hn),et)}sendMessage(_e,et={}){bt(this,Dn).sendMessage(_e,et)}mute(_e){bt(this,Dn).mute(_e)}close(){Dt(this,Gs,{}),bt(this,Dn).close()}sendAudio(_e,et={}){bt(this,Dn).sendAudio(_e,et)}interrupt(){bt(this,Dn).interrupt()}async approve(_e,et={alwaysApprove:!1}){bt(this,An).approveTool(_e,et);const tt=bt(this,jn).tools.find(nt=>nt.name===_e.rawItem.name);if(tt&&tt.type==="function"&&_e.rawItem.type==="function_call")await hn(this,Wn,Bo).call(this,_e.rawItem,tt);else throw new ModelBehaviorError(`Tool ${_e.rawItem.name} not found`)}async reject(_e,et={alwaysReject:!1}){bt(this,An).rejectTool(_e,et);const tt=bt(this,jn).tools.find(nt=>nt.name===_e.rawItem.name);if(tt&&tt.type==="function"&&_e.rawItem.type==="function_call")await hn(this,Wn,Bo).call(this,_e.rawItem,tt);else throw new ModelBehaviorError(`Tool ${_e.rawItem.name} not found`)}}Dn=new WeakMap,jn=new WeakMap,No=new WeakMap,An=new WeakMap,qs=new WeakMap,Hs=new WeakMap,Oo=new WeakMap,Hn=new WeakMap,Do=new WeakMap,Gs=new WeakMap,Wn=new WeakSet,Lo=async function(_e){Dt(this,jn,_e);const tt=bt(this,jn).handoffs.map(getHandoff).map(nt=>nt.getHandoffAsFunctionTool());Dt(this,No,[...(await bt(this,jn).getAllTools()).filter(nt=>nt.type==="function"),...tt])},Fo=async function(_e={}){const et=await bt(this,jn).getSystemPrompt(bt(this,An)),tt=this.options.tracingDisabled?null:this.options.workflowName?{workflow_name:this.options.workflowName}:"auto";return tt!==null&&tt!=="auto"?(this.options.groupId&&(tt.group_id=this.options.groupId),this.options.traceMetadata&&(tt.metadata=this.options.traceMetadata)):(this.options.groupId||this.options.traceMetadata)&&logger.warn("In order to set traceMetadata or a groupId you need to specify a workflowName."),{instructions:et,voice:bt(this,jn).voice,model:this.options.model,tools:bt(this,No),tracing:tt,..._e}},ru=async function(_e,et){const tt=await et.onInvokeHandoff(bt(this,An),_e.arguments);bt(this,jn).emit("agent_handoff",bt(this,An),tt),this.emit("agent_handoff",bt(this,An),bt(this,jn),tt),await hn(this,Wn,Lo).call(this,tt),await bt(this,Dn).updateSessionConfig(await hn(this,Wn,Fo).call(this));const nt=getTransferMessage(tt);return bt(this,Dn).sendFunctionCallOutput(_e,nt,!0),tt},Bo=async function(_e,et){bt(this,An).context.history=JSON.parse(JSON.stringify(bt(this,Hn)));let tt=_e.arguments;if(et.parameters&&(isZodObject(et.parameters)?tt=et.parameters.parse(tt):tt=JSON.parse(tt)),await et.needsApproval(bt(this,An),tt,_e.callId)){const st=this.context.isToolApproved({toolName:et.name,callId:_e.callId});if(st===!1){this.emit("agent_tool_start",bt(this,An),bt(this,jn),et,{toolCall:_e}),bt(this,jn).emit("agent_tool_start",bt(this,An),et,{toolCall:_e});const at="Tool execution was not approved.";bt(this,Dn).sendFunctionCallOutput(_e,at,!0),this.emit("agent_tool_end",bt(this,An),bt(this,jn),et,at,{toolCall:_e}),bt(this,jn).emit("agent_tool_end",bt(this,An),et,at,{toolCall:_e});return}else if(typeof st>"u"){this.emit("tool_approval_requested",bt(this,An),bt(this,jn),{type:"function_approval",tool:et,approvalItem:new RunToolApprovalItem(_e,bt(this,jn))});return}}this.emit("agent_tool_start",bt(this,An),bt(this,jn),et,{toolCall:_e}),bt(this,jn).emit("agent_tool_start",bt(this,An),et,{toolCall:_e}),bt(this,An).context.history=JSON.parse(JSON.stringify(bt(this,Hn)));const rt=await et.invoke(bt(this,An),_e.arguments),it=toSmartString(rt);bt(this,Dn).sendFunctionCallOutput(_e,it,!0),this.emit("agent_tool_end",bt(this,An),bt(this,jn),et,it,{toolCall:_e}),bt(this,jn).emit("agent_tool_end",bt(this,An),et,it,{toolCall:_e})},iu=async function(_e){const et=new Map(bt(this,jn).handoffs.map(getHandoff).map(rt=>[rt.toolName,rt])),tt=new Map((await bt(this,jn).getAllTools()).map(rt=>[rt.name,rt])),nt=et.get(_e.name);if(nt)await hn(this,Wn,ru).call(this,_e,nt);else{const rt=tt.get(_e.name);if(rt&&rt.type==="function")await hn(this,Wn,Bo).call(this,_e,rt);else throw new ModelBehaviorError(`Tool ${_e.name} not found`)}},wl=async function(_e,et,tt){if(bt(this,qs).length===0)return;const nt={agent:bt(this,jn),agentOutput:_e,context:bt(this,An)},it=(await Promise.all(bt(this,qs).map(st=>st.run(nt)))).find(st=>st.output.tripwireTriggered);if(it){if(bt(this,Gs)[et])return;bt(this,Gs)[et]=!0;const st=new OutputGuardrailTripwireTriggered(`Output guardrail triggered: ${JSON.stringify(it.output.outputInfo)}`,it);this.emit("guardrail_tripped",bt(this,An),bt(this,jn),st,{itemId:tt}),this.interrupt();const at=getRealtimeGuardrailFeedbackMessage(it);this.sendMessage(at);return}},su=function(){bt(this,Dn).on("*",tt=>{this.emit("transport_event",tt)}),bt(this,Dn).on("audio",tt=>{this.emit("audio",tt)}),bt(this,Dn).on("turn_started",()=>{this.emit("agent_start",bt(this,An),bt(this,jn)),bt(this,jn).emit("agent_start",bt(this,An),bt(this,jn))}),bt(this,Dn).on("turn_done",tt=>{const nt=tt.response.output[tt.response.output.length-1],rt=getLastTextFromAudioOutputMessage(nt)??"",it=(nt==null?void 0:nt.id)??"";this.emit("agent_end",bt(this,An),bt(this,jn),rt),bt(this,jn).emit("agent_end",bt(this,An),rt),hn(this,Wn,wl).call(this,rt,tt.response.id,it)}),bt(this,Dn).on("audio_done",()=>{this.emit("audio_stopped",bt(this,An),bt(this,jn))});let _e=0,et;bt(this,Dn).on("audio_transcript_delta",tt=>{try{const nt=tt.delta,rt=tt.itemId,it=tt.responseId;et!==rt&&(et=rt,_e=0);const at=(bt(this,Oo)[rt]??"")+nt;if(bt(this,Oo)[rt]=at,bt(this,Hs).debounceTextLength<0)return;const ot=Math.floor(at.length/bt(this,Hs).debounceTextLength);ot>_e&&(_e=ot,hn(this,Wn,wl).call(this,at,it,rt))}catch(nt){this.emit("error",{type:"error",error:nt})}}),bt(this,Dn).on("item_update",tt=>{try{const nt=!bt(this,Hn).some(rt=>rt.itemId===tt.itemId);if(Dt(this,Hn,updateRealtimeHistory(bt(this,Hn),tt,bt(this,Do))),bt(this,An).context.history=bt(this,Hn),nt){const rt=bt(this,Hn).find(it=>it.itemId===tt.itemId);rt&&this.emit("history_added",rt)}this.emit("history_updated",bt(this,Hn))}catch(nt){this.emit("error",{type:"error",error:nt})}}),bt(this,Dn).on("item_deleted",tt=>{try{Dt(this,Hn,bt(this,Hn).filter(nt=>nt.itemId!==tt.itemId)),bt(this,An).context.history=bt(this,Hn),this.emit("history_updated",bt(this,Hn))}catch(nt){this.emit("error",{type:"error",error:nt})}}),bt(this,Dn).on("function_call",async tt=>{try{await hn(this,Wn,iu).call(this,tt)}catch(nt){logger.error("Error handling function call",nt),this.emit("error",{type:"error",error:nt})}}),bt(this,Dn).on("usage_update",tt=>{bt(this,An).usage.add(tt)}),bt(this,Dn).on("audio_interrupted",()=>{this.emit("audio_interrupted",bt(this,An),bt(this,jn))}),bt(this,Dn).on("error",tt=>{this.emit("error",tt)})};function audioFormatForCodec(j){switch(j.toLowerCase()){case"pcmu":case"pcma":return"g711_ulaw";case"opus":default:return"pcm16"}}function applyCodecPreferences(j,$){var et,tt,nt;const _e=j.getTransceivers();for(const rt of _e)if(((et=rt.sender.track)==null?void 0:et.kind)==="audio"||((tt=rt.receiver.track)==null?void 0:tt.kind)==="audio"){const it=((nt=RTCRtpReceiver.getCapabilities("audio"))==null?void 0:nt.codecs)||[];let st;switch($.toLowerCase()){case"pcmu":st=it.find(at=>at.mimeType==="audio/PCMU");break;case"pcma":st=it.find(at=>at.mimeType==="audio/PCMA");break;case"opus":default:st=it.find(at=>at.mimeType==="audio/opus");break}if(st){const at=[st,...it.filter(ot=>ot!==st)];try{rt.setCodecPreferences(at)}catch(ot){console.warn("Failed to set codec preferences:",ot)}}}}function extractContentText(j){return j?typeof j=="string"?j:Array.isArray(j)?j.map($=>extractContentPartText($)).filter(Boolean).join(""):extractContentPartText(j):""}function extractContentPartText(j){return j?typeof j=="string"?j:j.text?typeof j.text=="string"?j.text:j.text.value?j.text.value:extractContentText(j.text):j.transcript?typeof j.transcript=="string"?j.transcript:extractContentText(j.transcript):j.content?extractContentText(j.content):j.audio_transcript?j.audio_transcript:j.input_text?j.input_text:j.output_text?j.output_text:"":""}function useHandleSessionHistory(){const{addTranscriptMessage:j,addTranscriptBreadcrumb:$,updateTranscriptItem:_e}=useTranscript(),et=reactExports.useRef(new Map),tt=reactExports.useRef(new Set),nt=reactExports.useCallback(ut=>{var ht;const pt=ut.item_id||ut.event_id;if(!pt||tt.current.has(pt))return;const dt=ut.transcript||"";if(dt){tt.current.add(pt);const ft=(ht=ut.type)!=null&&ht.includes("input")?"user":"assistant";j(pt,ft,dt,!1)}},[j]),rt=reactExports.useCallback(ut=>{const pt=ut.item_id||ut.event_id,dt=ut.delta||"";if(pt&&dt){const ht=et.current.get(pt)||"";et.current.set(pt,ht+dt)}},[]),it=reactExports.useCallback(ut=>{const pt=(ut==null?void 0:ut.name)||"tool";$(`Tool started: ${pt}`,{item:ut})},[$]),st=reactExports.useCallback(ut=>{const pt=(ut==null?void 0:ut.name)||"tool";$(`Tool completed: ${pt}`,{item:ut})},[$]),at=reactExports.useCallback(ut=>{if(ut!=null&&ut.id){const pt=extractContentText(ut.content)||ut.title||"";_e(ut.id,{status:ut.status||"DONE",title:pt})}},[_e]),ot=reactExports.useCallback(ut=>{if(!ut)return;const pt=ut.id||crypto.randomUUID(),dt=ut.role,ht=extractContentText(ut.content);!dt||!ht||(tt.current.has(pt)?_e(pt,{title:ht,status:"DONE"}):(tt.current.add(pt),j(pt,dt,ht,!1)))},[j,_e]),ct=reactExports.useCallback(ut=>{$(`Guardrail tripped: ${(ut==null?void 0:ut.reason)||"content filtered"}`,{guardrailResult:ut})},[$]),lt={handleTranscriptionCompleted:nt,handleTranscriptionDelta:rt,handleAgentToolStart:it,handleAgentToolEnd:st,handleHistoryUpdated:at,handleHistoryAdded:ot,handleGuardrailTripped:ct};return reactExports.useRef(lt)}function useRealtimeSession(j={}){const $=reactExports.useRef(null),[_e,et]=reactExports.useState("DISCONNECTED"),{logClientEvent:tt}=useEvent(),nt=reactExports.useCallback(vt=>{var xt;et(vt),(xt=j.onConnectionChange)==null||xt.call(j,vt),tt({},vt)},[j]),{logServerEvent:rt}=useEvent(),it=useHandleSessionHistory().current;function st(vt){switch(vt.type){case"conversation.item.input_audio_transcription.completed":{it.handleTranscriptionCompleted(vt);break}case"response.audio_transcript.done":{it.handleTranscriptionCompleted(vt);break}case"response.audio_transcript.delta":{it.handleTranscriptionDelta(vt);break}default:{rt(vt);break}}}const at=reactExports.useRef((typeof window<"u"?new URLSearchParams(window.location.search).get("codec")??"opus":"opus").toLowerCase()),ot=reactExports.useCallback(vt=>applyCodecPreferences(vt,at.current),[]),ct=vt=>{var wt;const xt=vt.context.history,Et=xt[xt.length-1].name.split("transfer_to_")[1];(wt=j.onAgentHandoff)==null||wt.call(j,Et)};reactExports.useEffect(()=>{$.current&&($.current.on("error",(...vt)=>{rt({type:"error",message:vt[0]})}),$.current.on("agent_handoff",ct),$.current.on("agent_tool_start",it.handleAgentToolStart),$.current.on("agent_tool_end",it.handleAgentToolEnd),$.current.on("history_updated",it.handleHistoryUpdated),$.current.on("history_added",it.handleHistoryAdded),$.current.on("guardrail_tripped",it.handleGuardrailTripped),$.current.on("transport_event",st))},[$.current]);const lt=reactExports.useCallback(async({getEphemeralKey:vt,initialAgents:xt,audioElement:St,extraContext:Et,outputGuardrails:wt})=>{if($.current)return;nt("CONNECTING");const Tt=await vt(),Ct=xt[0],Rt=at.current,jt=audioFormatForCodec(Rt);$.current=new RealtimeSession(Ct,{transport:new OpenAIRealtimeWebRTC({audioElement:St,changePeerConnection:async Ot=>(ot(Ot),Ot)}),model:"gpt-4o-realtime-preview-2025-06-03",config:{inputAudioFormat:jt,outputAudioFormat:jt,inputAudioTranscription:{model:"gpt-4o-mini-transcribe",language:"en"}},outputGuardrails:wt??[],context:Et??{}}),await $.current.connect({apiKey:Tt}),nt("CONNECTED")},[j,nt]),ut=reactExports.useCallback(()=>{var vt;(vt=$.current)==null||vt.close(),$.current=null,nt("DISCONNECTED")},[nt]),pt=()=>{if(!$.current)throw new Error("RealtimeSession not connected")},dt=reactExports.useCallback(()=>{var vt;(vt=$.current)==null||vt.interrupt()},[]),ht=reactExports.useCallback(vt=>{pt(),$.current.sendMessage(vt)},[]),ft=reactExports.useCallback(vt=>{var xt;(xt=$.current)==null||xt.transport.sendEvent(vt)},[]),mt=reactExports.useCallback(vt=>{var xt;(xt=$.current)==null||xt.mute(vt)},[]),gt=reactExports.useCallback(()=>{$.current&&$.current.transport.sendEvent({type:"input_audio_buffer.clear"})},[]),yt=reactExports.useCallback(()=>{$.current&&($.current.transport.sendEvent({type:"input_audio_buffer.commit"}),$.current.transport.sendEvent({type:"response.create"}))},[]);return{status:_e,connect:lt,disconnect:ut,sendUserText:ht,sendEvent:ft,mute:mt,pushToTalkStart:gt,pushToTalkStop:yt,interrupt:dt}}const CULTURAL_STYLE_PRESETS=[{id:"direct_task_focused",name:"Direct & Task-Focused",userFacingDescription:"Clear, explicit, outcome-oriented communication",globeSmartProfile:{directness:"high",taskVsRelationship:"task_focused",hierarchy:"low",expressiveness:"medium",riskTolerance:"medium",timeOrientation:"fixed"},behaviorRules:{turnTaking:["Opens quickly with minimal small talk","Interrupts politely if user rambles","Expects concise responses"],toneAndPacing:["Brisk, efficient pace","Gets to the point quickly","Values directness over diplomacy"],disagreementStyle:["States opinions explicitly","Challenges vague or hedged language","Pushes for decisions and next steps"],emotionalExpression:["Moderate emotional display","Responds positively to confidence","Shows mild impatience with indirectness"],openingBehavior:["Brief greeting, then straight to business","May skip pleasantries entirely","Sets agenda immediately"],closingBehavior:["Summarizes action items","Confirms next steps explicitly","Ends when objectives are met"]},typicalUserLearnings:["Lead with recommendation","Be concise and structured","Avoid over-explaining"],accentGuidance:{pacing:"fast",intonation:"moderate",sentenceLength:"short"},isDefault:!1},{id:"indirect_relationship_focused",name:"Indirect & Relationship-Focused",userFacingDescription:"Subtle, context-rich, harmony-preserving communication",globeSmartProfile:{directness:"low",taskVsRelationship:"relationship_focused",hierarchy:"high",expressiveness:"low",riskTolerance:"low",timeOrientation:"flexible"},behaviorRules:{turnTaking:["Allows longer pauses between exchanges","Does not interrupt","Waits for natural conversation flow"],toneAndPacing:["Gentle, measured pacing","Soft-spoken delivery","Values harmony in tone"],disagreementStyle:["Uses implication rather than direct statements","Avoids blunt disagreement ('That might be challenging...')","Responds better to softened language"],emotionalExpression:["Subdued emotional display","Reacts negatively to abrupt pushback","Values intent and respect signals"],openingBehavior:["Extended greeting and relationship building","Asks about wellbeing before business","Establishes rapport first"],closingBehavior:["Gradual wind-down","May leave some things unsaid","Emphasizes relationship continuity"]},typicalUserLearnings:["Read between the lines","Soften disagreement","Signal intent before content"],accentGuidance:{pacing:"slow",intonation:"flat",sentenceLength:"long"},isDefault:!1},{id:"hierarchical_formal",name:"Hierarchical & Formal",userFacingDescription:"Role-aware, respect-driven communication",globeSmartProfile:{directness:"medium",taskVsRelationship:"balanced",hierarchy:"very_high",expressiveness:"low",riskTolerance:"low",timeOrientation:"fixed"},behaviorRules:{turnTaking:["Expects role acknowledgment","May defer or assert based on perceived status","Formal turn structure"],toneAndPacing:["Formal language and pacing","Measured, deliberate speech","Authority is subtly asserted"],disagreementStyle:["Disagreement must be framed through alignment","Challenges framed as suggestions","Respects chain of command in arguments"],emotionalExpression:["Reserved emotional display","Reacts poorly to casual tone or interruption","Maintains professional composure"],openingBehavior:["Formal greeting with appropriate titles","Acknowledges seniority or position","Sets formal tone immediately"],closingBehavior:["Defers to senior party for closure","Formal sign-off","Confirms understanding of hierarchy"]},typicalUserLearnings:["Balance confidence with deference","Frame disagreement carefully","Respect power dynamics without submission"],accentGuidance:{pacing:"moderate",intonation:"flat",sentenceLength:"medium"},isDefault:!1},{id:"expressive_persuasive",name:"Expressive & Persuasive",userFacingDescription:"Energetic, emotion-forward, influence-driven communication",globeSmartProfile:{directness:"medium_high",taskVsRelationship:"relationship_focused",hierarchy:"low",expressiveness:"very_high",riskTolerance:"high",timeOrientation:"flexible"},behaviorRules:{turnTaking:["Interrupts enthusiastically","Overlapping speech is normal","Conversational back-and-forth is rapid"],toneAndPacing:["Varied tone with emotional emphasis","Animated delivery","Energy levels fluctuate with topic"],disagreementStyle:["Passionate disagreement is acceptable","Uses emotional appeals","Responds strongly to conviction and passion"],emotionalExpression:["High emotional display","Engages emotionally with user arguments","Less patient with over-analysis"],openingBehavior:["Warm, enthusiastic greeting","Personal connection before business","Sets energetic tone"],closingBehavior:["May continue conversation past agenda","Emotional sign-off","Relationship affirmation"]},typicalUserLearnings:["Match energy without losing structure","Use emotion strategically","Anchor ideas clearly in high-energy exchanges"],accentGuidance:{pacing:"varied",intonation:"very_expressive",sentenceLength:"varied"},isDefault:!1},{id:"analytical_reserved",name:"Analytical & Reserved",userFacingDescription:"Precise, logic-driven, low-emotion communication",globeSmartProfile:{directness:"high",taskVsRelationship:"task_focused",hierarchy:"low",expressiveness:"very_low",riskTolerance:"low",timeOrientation:"fixed"},behaviorRules:{turnTaking:["Waits for complete thoughts","Does not interrupt","Structured, linear exchanges"],toneAndPacing:["Calm, steady pacing","Monotone delivery","Deliberate speech patterns"],disagreementStyle:["Asks clarifying, data-driven questions","Avoids emotional language","Responds poorly to vague or subjective claims"],emotionalExpression:["Minimal emotional display","Facts over feelings","May seem cold or distant"],openingBehavior:["Brief, functional greeting","Moves to agenda immediately","No small talk"],closingBehavior:["Summarizes key points","Confirms data and facts","Ends efficiently"]},typicalUserLearnings:["Prepare evidence","Structure arguments logically","Minimize emotional overreach"],accentGuidance:{pacing:"moderate",intonation:"flat",sentenceLength:"medium"},isDefault:!1},{id:"global_professional_adaptive",name:"Global Professional (Adaptive)",userFacingDescription:"Balanced, adaptive, globally fluent communication",globeSmartProfile:{directness:"medium",taskVsRelationship:"balanced",hierarchy:"medium",expressiveness:"medium",riskTolerance:"medium",timeOrientation:"mixed"},behaviorRules:{turnTaking:["Adapts to user's turn-taking style","Flexible interruption patterns","Mirrors user's pace"],toneAndPacing:["Balanced tone","Adjusts based on user cues","Professional but warm"],disagreementStyle:["Accepts clarity and empathy equally","Constructive disagreement","Subtly tests adaptability"],emotionalExpression:["Moderate emotional display","Responds to user's emotional level","Professionally appropriate range"],openingBehavior:["Flexible greeting style","Reads user cues for formality level","Balances rapport with efficiency"],closingBehavior:["Adapts closure style to conversation","Balances summary with relationship","Flexible end timing"]},typicalUserLearnings:["Read the room","Adjust consciously","Balance efficiency with connection"],accentGuidance:{pacing:"moderate",intonation:"moderate",sentenceLength:"medium"},isDefault:!0}];function getCulturalPresetById(j){return CULTURAL_STYLE_PRESETS.find($=>$.id===j)}function generateCulturalBehaviorPrompt(j){const{behaviorRules:$,globeSmartProfile:_e,accentGuidance:et}=j;return`
## Cultural Communication Style: ${j.name}

${j.userFacingDescription}

### Turn-Taking & Pacing
${$.turnTaking.map(tt=>`- ${tt}`).join(`
`)}

### Tone & Delivery
${$.toneAndPacing.map(tt=>`- ${tt}`).join(`
`)}
- Speech pacing: ${et.pacing}
- Intonation: ${et.intonation}
- Sentence length preference: ${et.sentenceLength}

### Disagreement & Challenge Style
${$.disagreementStyle.map(tt=>`- ${tt}`).join(`
`)}

### Emotional Expression
${$.emotionalExpression.map(tt=>`- ${tt}`).join(`
`)}

### Opening Behavior
${$.openingBehavior.map(tt=>`- ${tt}`).join(`
`)}

### Closing Behavior
${$.closingBehavior.map(tt=>`- ${tt}`).join(`
`)}

### Key Behavioral Dimensions
- Directness: ${_e.directness.replace(/_/g," ")}
- Task vs Relationship Focus: ${_e.taskVsRelationship.replace(/_/g," ")}
- Hierarchy Sensitivity: ${_e.hierarchy.replace(/_/g," ")}
- Expressiveness: ${_e.expressiveness.replace(/_/g," ")}
- Risk Tolerance: ${_e.riskTolerance.replace(/_/g," ")}
- Time Orientation: ${_e.timeOrientation}

IMPORTANT: Apply these cultural communication patterns consistently throughout the conversation. 
This affects HOW you communicate, not WHAT your character's objectives are.
Do not explicitly mention or label these cultural patterns to the user.
`.trim()}const getPrompt=(j,$,_e,et,tt,nt="en",rt,it)=>{const at={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",zh:"Mandarin Chinese",ja:"Japanese",ko:"Korean",hi:"Hindi",ar:"Arabic",ru:"Russian",nl:"Dutch",pl:"Polish",tr:"Turkish"}[nt]||"English",ot=nt!=="en"?`

## LANGUAGE REQUIREMENT
You MUST speak ONLY in ${at}. All your responses must be in ${at}. The user will also speak to you in ${at}.
`:"",ct=nt==="en"&&it?`

## ACCENT
${getAccentInstruction(it)}
`:"",lt=rt?`

${generateCulturalBehaviorPrompt(rt)}
`:"";return`# CRITICAL ROLE ASSIGNMENT${ot}${ct}
You ARE ${et}, a ${_e}. You are NOT a coach, teacher, or assistant.
The person talking to you is a professional practicing their communication skills - they are playing the manager/professional role.
You must stay in character as ${et} (the ${_e}) at all times.

## Your Identity
- Name: ${et}
- Role: ${_e}
- You are the one being approached/managed by the user
- React authentically as someone in the ${_e} position would

## Scenario
${j||"A professional interaction scenario"}

## Context & Character Instructions
${$}
${lt}
## Role-Play Guidelines
1. NEVER break character - you are ${et}, not an AI assistant
2. NEVER coach, teach, or give meta-feedback during the conversation
3. NEVER say things like "Great question!" or "That's a good approach!"
4. DO react naturally with emotions appropriate to your character
5. DO challenge the user when your character would push back
6. DO express concerns, frustrations, or reservations as defined in your character
7. Use a ${tt} tone consistently throughout

## Conversation Behavior

### Opening
Begin the conversation AS your character would initiate it:
- Set the emotional tone (frustrated, concerned, hopeful, skeptical, etc.)
- Reference the situation naturally
- DO NOT welcome them to any platform or mention practice/learning

Examples for different roles:
- Customer (disappointed): "I've been thinking about our renewal, and honestly, I'm not sure we should continue..."
- Team Member (anxious): "You wanted to see me about the deadline? I know it didn't go well..."
- Executive (impatient): "Let's cut to the chase - the numbers this quarter aren't acceptable."

### During Conversation
- Respond authentically to what the user says
- Reveal deeper concerns gradually, as your character instructions indicate
- Push back or soften based on how the user communicates
- Stay emotionally consistent with your character's mindset

### Closing
End as your character naturally would:
- Agree to next steps if satisfied
- Leave tension unresolved if not convinced
- Express conditional acceptance if partly persuaded
- NEVER summarize learnings or give feedback
`},createRealtimeAgent=(j="",$="",_e="sage",et="stakeholder",tt="the stakeholder",nt="realistic",rt="en",it,st)=>{let at=null;it&&(at=getCulturalPresetById(it),at||console.warn(`[Cultural Preset] Invalid preset ID "${it}" - no cultural overlay will be applied`));const ot=getPrompt(j,$,et,tt,nt,rt,at,st);return console.log({systemPrompt:ot,culturalPreset:(at==null?void 0:at.id)||"none",accent:st||"default"}),new RealtimeAgent({name:"chatAgent",voice:_e,instructions:ot,tools:[]})},chatPlatformName="A3cend",getBlueprintPrompt=(j,$="en",_e,et)=>{const nt={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",zh:"Mandarin Chinese",ja:"Japanese",ko:"Korean",hi:"Hindi",ar:"Arabic",ru:"Russian",nl:"Dutch",pl:"Polish",tr:"Turkish"}[$]||"English",rt=$!=="en"?`

## LANGUAGE REQUIREMENT
You MUST speak ONLY in ${nt}. All your responses must be in ${nt}. The user will also speak to you in ${nt}.
`:"",it=$==="en"&&et?`

## ACCENT
${getAccentInstruction(et)}
`:"",st=_e?`

${generateCulturalBehaviorPrompt(_e)}
`:"",at=generateAvatarPromptFromBlueprint(j),ot=getModeById(j.conversationMode);return`# CRITICAL ROLE ASSIGNMENT${rt}${it}

${at}
${st}
## Role-Play Guidelines
1. NEVER break character - stay in your assigned role throughout
2. NEVER coach, teach, or give meta-feedback during the conversation
3. NEVER say things like "Great question!" or "That's a good approach!"
4. DO react naturally with emotions appropriate to your character
5. DO challenge the user when your character would push back
6. DO express concerns, frustrations, or reservations authentically

## Conversation Pacing
Your pacing should be: ${(ot==null?void 0:ot.pacing)||"natural"}
${(ot==null?void 0:ot.pacing)==="intense"?"- Push back more frequently, don't give ground easily":""}
${(ot==null?void 0:ot.pacing)==="relaxed"?"- Take time to explore ideas, ask follow-up questions":""}
${(ot==null?void 0:ot.pacing)==="focused"?"- Drive toward decisions and next steps":""}
${(ot==null?void 0:ot.pacing)==="slow"?"- Allow pauses, ask deepening questions, mirror back thoughts":""}

## Opening
Begin the conversation AS your character would initiate it:
- Set the emotional tone based on your character's trigger and pressure response
- Reference the situation naturally
- DO NOT welcome them to any platform or mention practice/learning

## During Conversation
- Respond authentically to what the user says
- Apply resistance appropriate to the user's objective (they may be trying to influence, set boundaries, resolve issues, etc.)
- Push back or soften based on how the user communicates
- Stay emotionally consistent with your character's mindset

## Closing
End as your character naturally would:
- Agree to next steps if satisfied
- Leave tension unresolved if not convinced
- Express conditional acceptance if partly persuaded
- NEVER summarize learnings or give feedback
`},createRealtimeAgentFromBlueprint=(j,$="sage",_e="en",et,tt)=>{let nt=null;et&&(nt=getCulturalPresetById(et),nt||console.warn(`[Cultural Preset] Invalid preset ID "${et}" - no cultural overlay will be applied`));const rt=getBlueprintPrompt(j,_e,nt,tt);return console.log({systemPrompt:rt,blueprint:j,culturalPreset:(nt==null?void 0:nt.id)||"none",accent:tt||"default"}),new RealtimeAgent({name:"chatAgent",voice:$,instructions:rt,tools:[]})};function ok$1(){}function unreachable(){}function stringify$1(j,$){const _e={};return(j[j.length-1]===""?[...j,""]:j).join((_e.padRight?" ":"")+","+(_e.padLeft===!1?"":" ")).trim()}const nameRe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nameReJsx=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,emptyOptions$2={};function name(j,$){return(emptyOptions$2.jsx?nameReJsx:nameRe).test(j)}const re$1=/[ \t\n\f\r]/g;function whitespace(j){return typeof j=="object"?j.type==="text"?empty$1(j.value):!1:empty$1(j)}function empty$1(j){return j.replace(re$1,"")===""}class Schema{constructor($,_e,et){this.normal=_e,this.property=$,et&&(this.space=et)}}Schema.prototype.normal={};Schema.prototype.property={};Schema.prototype.space=void 0;function merge(j,$){const _e={},et={};for(const tt of j)Object.assign(_e,tt.property),Object.assign(et,tt.normal);return new Schema(_e,et,$)}function normalize$2(j){return j.toLowerCase()}class Info{constructor($,_e){this.attribute=_e,this.property=$}}Info.prototype.attribute="";Info.prototype.booleanish=!1;Info.prototype.boolean=!1;Info.prototype.commaOrSpaceSeparated=!1;Info.prototype.commaSeparated=!1;Info.prototype.defined=!1;Info.prototype.mustUseProperty=!1;Info.prototype.number=!1;Info.prototype.overloadedBoolean=!1;Info.prototype.property="";Info.prototype.spaceSeparated=!1;Info.prototype.space=void 0;let powers=0;const boolean=increment(),booleanish=increment(),overloadedBoolean=increment(),number$3=increment(),spaceSeparated=increment(),commaSeparated=increment(),commaOrSpaceSeparated=increment();function increment(){return 2**++powers}const types=Object.freeze(Object.defineProperty({__proto__:null,boolean,booleanish,commaOrSpaceSeparated,commaSeparated,number:number$3,overloadedBoolean,spaceSeparated},Symbol.toStringTag,{value:"Module"})),checks=Object.keys(types);class DefinedInfo extends Info{constructor($,_e,et,tt){let nt=-1;if(super($,_e),mark(this,"space",tt),typeof et=="number")for(;++nt<checks.length;){const rt=checks[nt];mark(this,checks[nt],(et&types[rt])===types[rt])}}}DefinedInfo.prototype.defined=!0;function mark(j,$,_e){_e&&(j[$]=_e)}function create(j){const $={},_e={};for(const[et,tt]of Object.entries(j.properties)){const nt=new DefinedInfo(et,j.transform(j.attributes||{},et),tt,j.space);j.mustUseProperty&&j.mustUseProperty.includes(et)&&(nt.mustUseProperty=!0),$[et]=nt,_e[normalize$2(et)]=et,_e[normalize$2(nt.attribute)]=et}return new Schema($,_e,j.space)}const aria=create({properties:{ariaActiveDescendant:null,ariaAtomic:booleanish,ariaAutoComplete:null,ariaBusy:booleanish,ariaChecked:booleanish,ariaColCount:number$3,ariaColIndex:number$3,ariaColSpan:number$3,ariaControls:spaceSeparated,ariaCurrent:null,ariaDescribedBy:spaceSeparated,ariaDetails:null,ariaDisabled:booleanish,ariaDropEffect:spaceSeparated,ariaErrorMessage:null,ariaExpanded:booleanish,ariaFlowTo:spaceSeparated,ariaGrabbed:booleanish,ariaHasPopup:null,ariaHidden:booleanish,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated,ariaLevel:number$3,ariaLive:null,ariaModal:booleanish,ariaMultiLine:booleanish,ariaMultiSelectable:booleanish,ariaOrientation:null,ariaOwns:spaceSeparated,ariaPlaceholder:null,ariaPosInSet:number$3,ariaPressed:booleanish,ariaReadOnly:booleanish,ariaRelevant:null,ariaRequired:booleanish,ariaRoleDescription:spaceSeparated,ariaRowCount:number$3,ariaRowIndex:number$3,ariaRowSpan:number$3,ariaSelected:booleanish,ariaSetSize:number$3,ariaSort:null,ariaValueMax:number$3,ariaValueMin:number$3,ariaValueNow:number$3,ariaValueText:null,role:null},transform(j,$){return $==="role"?$:"aria-"+$.slice(4).toLowerCase()}});function caseSensitiveTransform(j,$){return $ in j?j[$]:$}function caseInsensitiveTransform(j,$){return caseSensitiveTransform(j,$.toLowerCase())}const html$2=create({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated,acceptCharset:spaceSeparated,accessKey:spaceSeparated,action:null,allow:null,allowFullScreen:boolean,allowPaymentRequest:boolean,allowUserMedia:boolean,alt:null,as:null,async:boolean,autoCapitalize:null,autoComplete:spaceSeparated,autoFocus:boolean,autoPlay:boolean,blocking:spaceSeparated,capture:null,charSet:null,checked:boolean,cite:null,className:spaceSeparated,cols:number$3,colSpan:null,content:null,contentEditable:booleanish,controls:boolean,controlsList:spaceSeparated,coords:number$3|commaSeparated,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean,defer:boolean,dir:null,dirName:null,disabled:boolean,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean,formTarget:null,headers:spaceSeparated,height:number$3,hidden:overloadedBoolean,high:number$3,href:null,hrefLang:null,htmlFor:spaceSeparated,httpEquiv:spaceSeparated,id:null,imageSizes:null,imageSrcSet:null,inert:boolean,inputMode:null,integrity:null,is:null,isMap:boolean,itemId:null,itemProp:spaceSeparated,itemRef:spaceSeparated,itemScope:boolean,itemType:spaceSeparated,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean,low:number$3,manifest:null,max:null,maxLength:number$3,media:null,method:null,min:null,minLength:number$3,multiple:boolean,muted:boolean,name:null,nonce:null,noModule:boolean,noValidate:boolean,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean,optimum:number$3,pattern:null,ping:spaceSeparated,placeholder:null,playsInline:boolean,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean,referrerPolicy:null,rel:spaceSeparated,required:boolean,reversed:boolean,rows:number$3,rowSpan:number$3,sandbox:spaceSeparated,scope:null,scoped:boolean,seamless:boolean,selected:boolean,shadowRootClonable:boolean,shadowRootDelegatesFocus:boolean,shadowRootMode:null,shape:null,size:number$3,sizes:null,slot:null,span:number$3,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$3,step:null,style:null,tabIndex:number$3,target:null,title:null,translate:null,type:null,typeMustMatch:boolean,useMap:null,value:booleanish,width:number$3,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated,axis:null,background:null,bgColor:null,border:number$3,borderColor:null,bottomMargin:number$3,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean,declare:boolean,event:null,face:null,frame:null,frameBorder:null,hSpace:number$3,leftMargin:number$3,link:null,longDesc:null,lowSrc:null,marginHeight:number$3,marginWidth:number$3,noResize:boolean,noHref:boolean,noShade:boolean,noWrap:boolean,object:null,profile:null,prompt:null,rev:null,rightMargin:number$3,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number$3,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$3,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean,disableRemotePlayback:boolean,prefix:null,property:null,results:number$3,security:null,unselectable:null},space:"html",transform:caseInsensitiveTransform}),svg$1=create({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:commaOrSpaceSeparated,accentHeight:number$3,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$3,amplitude:number$3,arabicForm:null,ascent:number$3,attributeName:null,attributeType:null,azimuth:number$3,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$3,by:null,calcMode:null,capHeight:number$3,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$3,diffuseConstant:number$3,direction:null,display:null,dur:null,divisor:number$3,dominantBaseline:null,download:boolean,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$3,enableBackground:null,end:null,event:null,exponent:number$3,externalResourcesRequired:null,fill:null,fillOpacity:number$3,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$3,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$3,horizOriginX:number$3,horizOriginY:number$3,id:null,ideographic:number$3,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$3,k:number$3,k1:number$3,k2:number$3,k3:number$3,k4:number$3,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$3,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$3,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$3,overlineThickness:number$3,paintOrder:null,panose1:null,path:null,pathLength:number$3,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$3,pointsAtY:number$3,pointsAtZ:number$3,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$3,specularExponent:number$3,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$3,strikethroughThickness:number$3,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$3,strokeOpacity:number$3,strokeWidth:null,style:null,surfaceScale:number$3,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number$3,tableValues:null,target:null,targetX:number$3,targetY:number$3,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$3,underlineThickness:number$3,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$3,values:null,vAlphabetic:number$3,vMathematical:number$3,vectorEffect:null,vHanging:number$3,vIdeographic:number$3,version:null,vertAdvY:number$3,vertOriginX:number$3,vertOriginY:number$3,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$3,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:caseSensitiveTransform}),xlink=create({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(j,$){return"xlink:"+$.slice(5).toLowerCase()}}),xmlns=create({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:caseInsensitiveTransform}),xml=create({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(j,$){return"xml:"+$.slice(3).toLowerCase()}}),hastToReact={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},cap$1=/[A-Z]/g,dash=/-[a-z]/g,valid=/^data[-\w.:]+$/i;function find(j,$){const _e=normalize$2($);let et=$,tt=Info;if(_e in j.normal)return j.property[j.normal[_e]];if(_e.length>4&&_e.slice(0,4)==="data"&&valid.test($)){if($.charAt(4)==="-"){const nt=$.slice(5).replace(dash,camelcase);et="data"+nt.charAt(0).toUpperCase()+nt.slice(1)}else{const nt=$.slice(4);if(!dash.test(nt)){let rt=nt.replace(cap$1,kebab);rt.charAt(0)!=="-"&&(rt="-"+rt),$="data"+rt}}tt=DefinedInfo}return new tt(et,$)}function kebab(j){return"-"+j.toLowerCase()}function camelcase(j){return j.charAt(1).toUpperCase()}const html$1=merge([aria,html$2,xlink,xmlns,xml],"html"),svg=merge([aria,svg$1,xlink,xmlns,xml],"svg");function stringify(j){return j.join(" ").trim()}var cjs$2={},COMMENT_REGEX=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,NEWLINE_REGEX=/\n/g,WHITESPACE_REGEX=/^\s*/,PROPERTY_REGEX=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,COLON_REGEX=/^:\s*/,VALUE_REGEX=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,SEMICOLON_REGEX=/^[;\s]*/,TRIM_REGEX=/^\s+|\s+$/g,NEWLINE=`
`,FORWARD_SLASH="/",ASTERISK="*",EMPTY_STRING="",TYPE_COMMENT="comment",TYPE_DECLARATION="declaration";function index$1(j,$){if(typeof j!="string")throw new TypeError("First argument must be a string");if(!j)return[];$=$||{};var _e=1,et=1;function tt(pt){var dt=pt.match(NEWLINE_REGEX);dt&&(_e+=dt.length);var ht=pt.lastIndexOf(NEWLINE);et=~ht?pt.length-ht:et+pt.length}function nt(){var pt={line:_e,column:et};return function(dt){return dt.position=new rt(pt),at(),dt}}function rt(pt){this.start=pt,this.end={line:_e,column:et},this.source=$.source}rt.prototype.content=j;function it(pt){var dt=new Error($.source+":"+_e+":"+et+": "+pt);if(dt.reason=pt,dt.filename=$.source,dt.line=_e,dt.column=et,dt.source=j,!$.silent)throw dt}function st(pt){var dt=pt.exec(j);if(dt){var ht=dt[0];return tt(ht),j=j.slice(ht.length),dt}}function at(){st(WHITESPACE_REGEX)}function ot(pt){var dt;for(pt=pt||[];dt=ct();)dt!==!1&&pt.push(dt);return pt}function ct(){var pt=nt();if(!(FORWARD_SLASH!=j.charAt(0)||ASTERISK!=j.charAt(1))){for(var dt=2;EMPTY_STRING!=j.charAt(dt)&&(ASTERISK!=j.charAt(dt)||FORWARD_SLASH!=j.charAt(dt+1));)++dt;if(dt+=2,EMPTY_STRING===j.charAt(dt-1))return it("End of comment missing");var ht=j.slice(2,dt-2);return et+=2,tt(ht),j=j.slice(dt),et+=2,pt({type:TYPE_COMMENT,comment:ht})}}function lt(){var pt=nt(),dt=st(PROPERTY_REGEX);if(dt){if(ct(),!st(COLON_REGEX))return it("property missing ':'");var ht=st(VALUE_REGEX),ft=pt({type:TYPE_DECLARATION,property:trim(dt[0].replace(COMMENT_REGEX,EMPTY_STRING)),value:ht?trim(ht[0].replace(COMMENT_REGEX,EMPTY_STRING)):EMPTY_STRING});return st(SEMICOLON_REGEX),ft}}function ut(){var pt=[];ot(pt);for(var dt;dt=lt();)dt!==!1&&(pt.push(dt),ot(pt));return pt}return at(),ut()}function trim(j){return j?j.replace(TRIM_REGEX,EMPTY_STRING):EMPTY_STRING}var cjs$1=index$1,__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(cjs$2,"__esModule",{value:!0});cjs$2.default=StyleToObject;const inline_style_parser_1=__importDefault$1(cjs$1);function StyleToObject(j,$){let _e=null;if(!j||typeof j!="string")return _e;const et=(0,inline_style_parser_1.default)(j),tt=typeof $=="function";return et.forEach(nt=>{if(nt.type!=="declaration")return;const{property:rt,value:it}=nt;tt?$(rt,it,nt):it&&(_e=_e||{},_e[rt]=it)}),_e}var utilities={};Object.defineProperty(utilities,"__esModule",{value:!0});utilities.camelCase=void 0;var CUSTOM_PROPERTY_REGEX=/^--[a-zA-Z0-9_-]+$/,HYPHEN_REGEX=/-([a-z])/g,NO_HYPHEN_REGEX=/^[^-]+$/,VENDOR_PREFIX_REGEX=/^-(webkit|moz|ms|o|khtml)-/,MS_VENDOR_PREFIX_REGEX=/^-(ms)-/,skipCamelCase=function(j){return!j||NO_HYPHEN_REGEX.test(j)||CUSTOM_PROPERTY_REGEX.test(j)},capitalize=function(j,$){return $.toUpperCase()},trimHyphen=function(j,$){return"".concat($,"-")},camelCase=function(j,$){return $===void 0&&($={}),skipCamelCase(j)?j:(j=j.toLowerCase(),$.reactCompat?j=j.replace(MS_VENDOR_PREFIX_REGEX,trimHyphen):j=j.replace(VENDOR_PREFIX_REGEX,trimHyphen),j.replace(HYPHEN_REGEX,capitalize))};utilities.camelCase=camelCase;var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(j){return j&&j.__esModule?j:{default:j}},style_to_object_1=__importDefault(cjs$2),utilities_1=utilities;function StyleToJS(j,$){var _e={};return!j||typeof j!="string"||(0,style_to_object_1.default)(j,function(et,tt){et&&tt&&(_e[(0,utilities_1.camelCase)(et,$)]=tt)}),_e}StyleToJS.default=StyleToJS;var cjs=StyleToJS;const styleToJs=getDefaultExportFromCjs$1(cjs),pointEnd=point$5("end"),pointStart=point$5("start");function point$5(j){return $;function $(_e){const et=_e&&_e.position&&_e.position[j]||{};if(typeof et.line=="number"&&et.line>0&&typeof et.column=="number"&&et.column>0)return{line:et.line,column:et.column,offset:typeof et.offset=="number"&&et.offset>-1?et.offset:void 0}}}function position$1(j){const $=pointStart(j),_e=pointEnd(j);if($&&_e)return{start:$,end:_e}}function stringifyPosition(j){return!j||typeof j!="object"?"":"position"in j||"type"in j?position(j.position):"start"in j||"end"in j?position(j):"line"in j||"column"in j?point$4(j):""}function point$4(j){return index(j&&j.line)+":"+index(j&&j.column)}function position(j){return point$4(j&&j.start)+"-"+point$4(j&&j.end)}function index(j){return j&&typeof j=="number"?j:1}class VFileMessage extends Error{constructor($,_e,et){super(),typeof _e=="string"&&(et=_e,_e=void 0);let tt="",nt={},rt=!1;if(_e&&("line"in _e&&"column"in _e?nt={place:_e}:"start"in _e&&"end"in _e?nt={place:_e}:"type"in _e?nt={ancestors:[_e],place:_e.position}:nt={..._e}),typeof $=="string"?tt=$:!nt.cause&&$&&(rt=!0,tt=$.message,nt.cause=$),!nt.ruleId&&!nt.source&&typeof et=="string"){const st=et.indexOf(":");st===-1?nt.ruleId=et:(nt.source=et.slice(0,st),nt.ruleId=et.slice(st+1))}if(!nt.place&&nt.ancestors&&nt.ancestors){const st=nt.ancestors[nt.ancestors.length-1];st&&(nt.place=st.position)}const it=nt.place&&"start"in nt.place?nt.place.start:nt.place;this.ancestors=nt.ancestors||void 0,this.cause=nt.cause||void 0,this.column=it?it.column:void 0,this.fatal=void 0,this.file="",this.message=tt,this.line=it?it.line:void 0,this.name=stringifyPosition(nt.place)||"1:1",this.place=nt.place||void 0,this.reason=this.message,this.ruleId=nt.ruleId||void 0,this.source=nt.source||void 0,this.stack=rt&&nt.cause&&typeof nt.cause.stack=="string"?nt.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}VFileMessage.prototype.file="";VFileMessage.prototype.name="";VFileMessage.prototype.reason="";VFileMessage.prototype.message="";VFileMessage.prototype.stack="";VFileMessage.prototype.column=void 0;VFileMessage.prototype.line=void 0;VFileMessage.prototype.ancestors=void 0;VFileMessage.prototype.cause=void 0;VFileMessage.prototype.fatal=void 0;VFileMessage.prototype.place=void 0;VFileMessage.prototype.ruleId=void 0;VFileMessage.prototype.source=void 0;const own$3={}.hasOwnProperty,emptyMap=new Map,cap=/[A-Z]/g,tableElements=new Set(["table","tbody","thead","tfoot","tr"]),tableCellElement=new Set(["td","th"]),docs="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function toJsxRuntime(j,$){if(!$||$.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const _e=$.filePath||void 0;let et;if($.development){if(typeof $.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");et=developmentCreate(_e,$.jsxDEV)}else{if(typeof $.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof $.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");et=productionCreate(_e,$.jsx,$.jsxs)}const tt={Fragment:$.Fragment,ancestors:[],components:$.components||{},create:et,elementAttributeNameCase:$.elementAttributeNameCase||"react",evaluater:$.createEvaluater?$.createEvaluater():void 0,filePath:_e,ignoreInvalidStyle:$.ignoreInvalidStyle||!1,passKeys:$.passKeys!==!1,passNode:$.passNode||!1,schema:$.space==="svg"?svg:html$1,stylePropertyNameCase:$.stylePropertyNameCase||"dom",tableCellAlignToStyle:$.tableCellAlignToStyle!==!1},nt=one$2(tt,j,void 0);return nt&&typeof nt!="string"?nt:tt.create(j,tt.Fragment,{children:nt||void 0},void 0)}function one$2(j,$,_e){if($.type==="element")return element$1(j,$,_e);if($.type==="mdxFlowExpression"||$.type==="mdxTextExpression")return mdxExpression(j,$);if($.type==="mdxJsxFlowElement"||$.type==="mdxJsxTextElement")return mdxJsxElement(j,$,_e);if($.type==="mdxjsEsm")return mdxEsm(j,$);if($.type==="root")return root$1(j,$,_e);if($.type==="text")return text$3(j,$)}function element$1(j,$,_e){const et=j.schema;let tt=et;$.tagName.toLowerCase()==="svg"&&et.space==="html"&&(tt=svg,j.schema=tt),j.ancestors.push($);const nt=findComponentFromName(j,$.tagName,!1),rt=createElementProps(j,$);let it=createChildren(j,$);return tableElements.has($.tagName)&&(it=it.filter(function(st){return typeof st=="string"?!whitespace(st):!0})),addNode(j,rt,nt,$),addChildren(rt,it),j.ancestors.pop(),j.schema=et,j.create($,nt,rt,_e)}function mdxExpression(j,$){if($.data&&$.data.estree&&j.evaluater){const et=$.data.estree.body[0];return et.type,j.evaluater.evaluateExpression(et.expression)}crashEstree(j,$.position)}function mdxEsm(j,$){if($.data&&$.data.estree&&j.evaluater)return j.evaluater.evaluateProgram($.data.estree);crashEstree(j,$.position)}function mdxJsxElement(j,$,_e){const et=j.schema;let tt=et;$.name==="svg"&&et.space==="html"&&(tt=svg,j.schema=tt),j.ancestors.push($);const nt=$.name===null?j.Fragment:findComponentFromName(j,$.name,!0),rt=createJsxElementProps(j,$),it=createChildren(j,$);return addNode(j,rt,nt,$),addChildren(rt,it),j.ancestors.pop(),j.schema=et,j.create($,nt,rt,_e)}function root$1(j,$,_e){const et={};return addChildren(et,createChildren(j,$)),j.create($,j.Fragment,et,_e)}function text$3(j,$){return $.value}function addNode(j,$,_e,et){typeof _e!="string"&&_e!==j.Fragment&&j.passNode&&($.node=et)}function addChildren(j,$){if($.length>0){const _e=$.length>1?$:$[0];_e&&(j.children=_e)}}function productionCreate(j,$,_e){return et;function et(tt,nt,rt,it){const at=Array.isArray(rt.children)?_e:$;return it?at(nt,rt,it):at(nt,rt)}}function developmentCreate(j,$){return _e;function _e(et,tt,nt,rt){const it=Array.isArray(nt.children),st=pointStart(et);return $(tt,nt,rt,it,{columnNumber:st?st.column-1:void 0,fileName:j,lineNumber:st?st.line:void 0},void 0)}}function createElementProps(j,$){const _e={};let et,tt;for(tt in $.properties)if(tt!=="children"&&own$3.call($.properties,tt)){const nt=createProperty(j,tt,$.properties[tt]);if(nt){const[rt,it]=nt;j.tableCellAlignToStyle&&rt==="align"&&typeof it=="string"&&tableCellElement.has($.tagName)?et=it:_e[rt]=it}}if(et){const nt=_e.style||(_e.style={});nt[j.stylePropertyNameCase==="css"?"text-align":"textAlign"]=et}return _e}function createJsxElementProps(j,$){const _e={};for(const et of $.attributes)if(et.type==="mdxJsxExpressionAttribute")if(et.data&&et.data.estree&&j.evaluater){const nt=et.data.estree.body[0];nt.type;const rt=nt.expression;rt.type;const it=rt.properties[0];it.type,Object.assign(_e,j.evaluater.evaluateExpression(it.argument))}else crashEstree(j,$.position);else{const tt=et.name;let nt;if(et.value&&typeof et.value=="object")if(et.value.data&&et.value.data.estree&&j.evaluater){const it=et.value.data.estree.body[0];it.type,nt=j.evaluater.evaluateExpression(it.expression)}else crashEstree(j,$.position);else nt=et.value===null?!0:et.value;_e[tt]=nt}return _e}function createChildren(j,$){const _e=[];let et=-1;const tt=j.passKeys?new Map:emptyMap;for(;++et<$.children.length;){const nt=$.children[et];let rt;if(j.passKeys){const st=nt.type==="element"?nt.tagName:nt.type==="mdxJsxFlowElement"||nt.type==="mdxJsxTextElement"?nt.name:void 0;if(st){const at=tt.get(st)||0;rt=st+"-"+at,tt.set(st,at+1)}}const it=one$2(j,nt,rt);it!==void 0&&_e.push(it)}return _e}function createProperty(j,$,_e){const et=find(j.schema,$);if(!(_e==null||typeof _e=="number"&&Number.isNaN(_e))){if(Array.isArray(_e)&&(_e=et.commaSeparated?stringify$1(_e):stringify(_e)),et.property==="style"){let tt=typeof _e=="object"?_e:parseStyle(j,String(_e));return j.stylePropertyNameCase==="css"&&(tt=transformStylesToCssCasing(tt)),["style",tt]}return[j.elementAttributeNameCase==="react"&&et.space?hastToReact[et.property]||et.property:et.attribute,_e]}}function parseStyle(j,$){try{return styleToJs($,{reactCompat:!0})}catch(_e){if(j.ignoreInvalidStyle)return{};const et=_e,tt=new VFileMessage("Cannot parse `style` attribute",{ancestors:j.ancestors,cause:et,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw tt.file=j.filePath||void 0,tt.url=docs+"#cannot-parse-style-attribute",tt}}function findComponentFromName(j,$,_e){let et;if(!_e)et={type:"Literal",value:$};else if($.includes(".")){const tt=$.split(".");let nt=-1,rt;for(;++nt<tt.length;){const it=name(tt[nt])?{type:"Identifier",name:tt[nt]}:{type:"Literal",value:tt[nt]};rt=rt?{type:"MemberExpression",object:rt,property:it,computed:!!(nt&&it.type==="Literal"),optional:!1}:it}et=rt}else et=name($)&&!/^[a-z]/.test($)?{type:"Identifier",name:$}:{type:"Literal",value:$};if(et.type==="Literal"){const tt=et.value;return own$3.call(j.components,tt)?j.components[tt]:tt}if(j.evaluater)return j.evaluater.evaluateExpression(et);crashEstree(j)}function crashEstree(j,$){const _e=new VFileMessage("Cannot handle MDX estrees without `createEvaluater`",{ancestors:j.ancestors,place:$,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw _e.file=j.filePath||void 0,_e.url=docs+"#cannot-handle-mdx-estrees-without-createevaluater",_e}function transformStylesToCssCasing(j){const $={};let _e;for(_e in j)own$3.call(j,_e)&&($[transformStyleToCssCasing(_e)]=j[_e]);return $}function transformStyleToCssCasing(j){let $=j.replace(cap,toDash);return $.slice(0,3)==="ms-"&&($="-"+$),$}function toDash(j){return"-"+j.toLowerCase()}const urlAttributes={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},emptyOptions$1={};function toString$3(j,$){const _e=emptyOptions$1,et=typeof _e.includeImageAlt=="boolean"?_e.includeImageAlt:!0,tt=typeof _e.includeHtml=="boolean"?_e.includeHtml:!0;return one$1(j,et,tt)}function one$1(j,$,_e){if(node(j)){if("value"in j)return j.type==="html"&&!_e?"":j.value;if($&&"alt"in j&&j.alt)return j.alt;if("children"in j)return all(j.children,$,_e)}return Array.isArray(j)?all(j,$,_e):""}function all(j,$,_e){const et=[];let tt=-1;for(;++tt<j.length;)et[tt]=one$1(j[tt],$,_e);return et.join("")}function node(j){return!!(j&&typeof j=="object")}const element=document.createElement("i");function decodeNamedCharacterReference(j){const $="&"+j+";";element.innerHTML=$;const _e=element.textContent;return _e.charCodeAt(_e.length-1)===59&&j!=="semi"||_e===$?!1:_e}function splice(j,$,_e,et){const tt=j.length;let nt=0,rt;if($<0?$=-$>tt?0:tt+$:$=$>tt?tt:$,_e=_e>0?_e:0,et.length<1e4)rt=Array.from(et),rt.unshift($,_e),j.splice(...rt);else for(_e&&j.splice($,_e);nt<et.length;)rt=et.slice(nt,nt+1e4),rt.unshift($,0),j.splice(...rt),nt+=1e4,$+=1e4}function push(j,$){return j.length>0?(splice(j,j.length,0,$),j):$}const hasOwnProperty={}.hasOwnProperty;function combineExtensions(j){const $={};let _e=-1;for(;++_e<j.length;)syntaxExtension($,j[_e]);return $}function syntaxExtension(j,$){let _e;for(_e in $){const tt=(hasOwnProperty.call(j,_e)?j[_e]:void 0)||(j[_e]={}),nt=$[_e];let rt;if(nt)for(rt in nt){hasOwnProperty.call(tt,rt)||(tt[rt]=[]);const it=nt[rt];constructs(tt[rt],Array.isArray(it)?it:it?[it]:[])}}}function constructs(j,$){let _e=-1;const et=[];for(;++_e<$.length;)($[_e].add==="after"?j:et).push($[_e]);splice(j,0,0,et)}function decodeNumericCharacterReference(j,$){const _e=Number.parseInt(j,$);return _e<9||_e===11||_e>13&&_e<32||_e>126&&_e<160||_e>55295&&_e<57344||_e>64975&&_e<65008||(_e&65535)===65535||(_e&65535)===65534||_e>1114111?"":String.fromCodePoint(_e)}function normalizeIdentifier(j){return j.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const asciiAlpha=regexCheck(/[A-Za-z]/),asciiAlphanumeric=regexCheck(/[\dA-Za-z]/),asciiAtext=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(j){return j!==null&&(j<32||j===127)}const asciiDigit=regexCheck(/\d/),asciiHexDigit=regexCheck(/[\dA-Fa-f]/),asciiPunctuation=regexCheck(/[!-/:-@[-`{-~]/);function markdownLineEnding(j){return j!==null&&j<-2}function markdownLineEndingOrSpace(j){return j!==null&&(j<0||j===32)}function markdownSpace(j){return j===-2||j===-1||j===32}const unicodePunctuation=regexCheck(new RegExp("\\p{P}|\\p{S}","u")),unicodeWhitespace=regexCheck(/\s/);function regexCheck(j){return $;function $(_e){return _e!==null&&_e>-1&&j.test(String.fromCharCode(_e))}}function normalizeUri(j){const $=[];let _e=-1,et=0,tt=0;for(;++_e<j.length;){const nt=j.charCodeAt(_e);let rt="";if(nt===37&&asciiAlphanumeric(j.charCodeAt(_e+1))&&asciiAlphanumeric(j.charCodeAt(_e+2)))tt=2;else if(nt<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(nt))||(rt=String.fromCharCode(nt));else if(nt>55295&&nt<57344){const it=j.charCodeAt(_e+1);nt<56320&&it>56319&&it<57344?(rt=String.fromCharCode(nt,it),tt=1):rt=""}else rt=String.fromCharCode(nt);rt&&($.push(j.slice(et,_e),encodeURIComponent(rt)),et=_e+tt+1,rt=""),tt&&(_e+=tt,tt=0)}return $.join("")+j.slice(et)}function factorySpace(j,$,_e,et){const tt=et?et-1:Number.POSITIVE_INFINITY;let nt=0;return rt;function rt(st){return markdownSpace(st)?(j.enter(_e),it(st)):$(st)}function it(st){return markdownSpace(st)&&nt++<tt?(j.consume(st),it):(j.exit(_e),$(st))}}const content$1={tokenize:initializeContent};function initializeContent(j){const $=j.attempt(this.parser.constructs.contentInitial,et,tt);let _e;return $;function et(it){if(it===null){j.consume(it);return}return j.enter("lineEnding"),j.consume(it),j.exit("lineEnding"),factorySpace(j,$,"linePrefix")}function tt(it){return j.enter("paragraph"),nt(it)}function nt(it){const st=j.enter("chunkText",{contentType:"text",previous:_e});return _e&&(_e.next=st),_e=st,rt(it)}function rt(it){if(it===null){j.exit("chunkText"),j.exit("paragraph"),j.consume(it);return}return markdownLineEnding(it)?(j.consume(it),j.exit("chunkText"),nt):(j.consume(it),rt)}}const document$2={tokenize:initializeDocument},containerConstruct={tokenize:tokenizeContainer};function initializeDocument(j){const $=this,_e=[];let et=0,tt,nt,rt;return it;function it(gt){if(et<_e.length){const yt=_e[et];return $.containerState=yt[1],j.attempt(yt[0].continuation,st,at)(gt)}return at(gt)}function st(gt){if(et++,$.containerState._closeFlow){$.containerState._closeFlow=void 0,tt&&mt();const yt=$.events.length;let vt=yt,xt;for(;vt--;)if($.events[vt][0]==="exit"&&$.events[vt][1].type==="chunkFlow"){xt=$.events[vt][1].end;break}ft(et);let St=yt;for(;St<$.events.length;)$.events[St][1].end={...xt},St++;return splice($.events,vt+1,0,$.events.slice(yt)),$.events.length=St,at(gt)}return it(gt)}function at(gt){if(et===_e.length){if(!tt)return lt(gt);if(tt.currentConstruct&&tt.currentConstruct.concrete)return pt(gt);$.interrupt=!!(tt.currentConstruct&&!tt._gfmTableDynamicInterruptHack)}return $.containerState={},j.check(containerConstruct,ot,ct)(gt)}function ot(gt){return tt&&mt(),ft(et),lt(gt)}function ct(gt){return $.parser.lazy[$.now().line]=et!==_e.length,rt=$.now().offset,pt(gt)}function lt(gt){return $.containerState={},j.attempt(containerConstruct,ut,pt)(gt)}function ut(gt){return et++,_e.push([$.currentConstruct,$.containerState]),lt(gt)}function pt(gt){if(gt===null){tt&&mt(),ft(0),j.consume(gt);return}return tt=tt||$.parser.flow($.now()),j.enter("chunkFlow",{_tokenizer:tt,contentType:"flow",previous:nt}),dt(gt)}function dt(gt){if(gt===null){ht(j.exit("chunkFlow"),!0),ft(0),j.consume(gt);return}return markdownLineEnding(gt)?(j.consume(gt),ht(j.exit("chunkFlow")),et=0,$.interrupt=void 0,it):(j.consume(gt),dt)}function ht(gt,yt){const vt=$.sliceStream(gt);if(yt&&vt.push(null),gt.previous=nt,nt&&(nt.next=gt),nt=gt,tt.defineSkip(gt.start),tt.write(vt),$.parser.lazy[gt.start.line]){let xt=tt.events.length;for(;xt--;)if(tt.events[xt][1].start.offset<rt&&(!tt.events[xt][1].end||tt.events[xt][1].end.offset>rt))return;const St=$.events.length;let Et=St,wt,Tt;for(;Et--;)if($.events[Et][0]==="exit"&&$.events[Et][1].type==="chunkFlow"){if(wt){Tt=$.events[Et][1].end;break}wt=!0}for(ft(et),xt=St;xt<$.events.length;)$.events[xt][1].end={...Tt},xt++;splice($.events,Et+1,0,$.events.slice(St)),$.events.length=xt}}function ft(gt){let yt=_e.length;for(;yt-- >gt;){const vt=_e[yt];$.containerState=vt[1],vt[0].exit.call($,j)}_e.length=gt}function mt(){tt.write([null]),nt=void 0,tt=void 0,$.containerState._closeFlow=void 0}}function tokenizeContainer(j,$,_e){return factorySpace(j,j.attempt(this.parser.constructs.document,$,_e),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function classifyCharacter(j){if(j===null||markdownLineEndingOrSpace(j)||unicodeWhitespace(j))return 1;if(unicodePunctuation(j))return 2}function resolveAll(j,$,_e){const et=[];let tt=-1;for(;++tt<j.length;){const nt=j[tt].resolveAll;nt&&!et.includes(nt)&&($=nt($,_e),et.push(nt))}return $}const attention={name:"attention",resolveAll:resolveAllAttention,tokenize:tokenizeAttention};function resolveAllAttention(j,$){let _e=-1,et,tt,nt,rt,it,st,at,ot;for(;++_e<j.length;)if(j[_e][0]==="enter"&&j[_e][1].type==="attentionSequence"&&j[_e][1]._close){for(et=_e;et--;)if(j[et][0]==="exit"&&j[et][1].type==="attentionSequence"&&j[et][1]._open&&$.sliceSerialize(j[et][1]).charCodeAt(0)===$.sliceSerialize(j[_e][1]).charCodeAt(0)){if((j[et][1]._close||j[_e][1]._open)&&(j[_e][1].end.offset-j[_e][1].start.offset)%3&&!((j[et][1].end.offset-j[et][1].start.offset+j[_e][1].end.offset-j[_e][1].start.offset)%3))continue;st=j[et][1].end.offset-j[et][1].start.offset>1&&j[_e][1].end.offset-j[_e][1].start.offset>1?2:1;const ct={...j[et][1].end},lt={...j[_e][1].start};movePoint(ct,-st),movePoint(lt,st),rt={type:st>1?"strongSequence":"emphasisSequence",start:ct,end:{...j[et][1].end}},it={type:st>1?"strongSequence":"emphasisSequence",start:{...j[_e][1].start},end:lt},nt={type:st>1?"strongText":"emphasisText",start:{...j[et][1].end},end:{...j[_e][1].start}},tt={type:st>1?"strong":"emphasis",start:{...rt.start},end:{...it.end}},j[et][1].end={...rt.start},j[_e][1].start={...it.end},at=[],j[et][1].end.offset-j[et][1].start.offset&&(at=push(at,[["enter",j[et][1],$],["exit",j[et][1],$]])),at=push(at,[["enter",tt,$],["enter",rt,$],["exit",rt,$],["enter",nt,$]]),at=push(at,resolveAll($.parser.constructs.insideSpan.null,j.slice(et+1,_e),$)),at=push(at,[["exit",nt,$],["enter",it,$],["exit",it,$],["exit",tt,$]]),j[_e][1].end.offset-j[_e][1].start.offset?(ot=2,at=push(at,[["enter",j[_e][1],$],["exit",j[_e][1],$]])):ot=0,splice(j,et-1,_e-et+3,at),_e=et+at.length-ot-2;break}}for(_e=-1;++_e<j.length;)j[_e][1].type==="attentionSequence"&&(j[_e][1].type="data");return j}function tokenizeAttention(j,$){const _e=this.parser.constructs.attentionMarkers.null,et=this.previous,tt=classifyCharacter(et);let nt;return rt;function rt(st){return nt=st,j.enter("attentionSequence"),it(st)}function it(st){if(st===nt)return j.consume(st),it;const at=j.exit("attentionSequence"),ot=classifyCharacter(st),ct=!ot||ot===2&&tt||_e.includes(st),lt=!tt||tt===2&&ot||_e.includes(et);return at._open=!!(nt===42?ct:ct&&(tt||!lt)),at._close=!!(nt===42?lt:lt&&(ot||!ct)),$(st)}}function movePoint(j,$){j.column+=$,j.offset+=$,j._bufferIndex+=$}const autolink={name:"autolink",tokenize:tokenizeAutolink};function tokenizeAutolink(j,$,_e){let et=0;return tt;function tt(ut){return j.enter("autolink"),j.enter("autolinkMarker"),j.consume(ut),j.exit("autolinkMarker"),j.enter("autolinkProtocol"),nt}function nt(ut){return asciiAlpha(ut)?(j.consume(ut),rt):ut===64?_e(ut):at(ut)}function rt(ut){return ut===43||ut===45||ut===46||asciiAlphanumeric(ut)?(et=1,it(ut)):at(ut)}function it(ut){return ut===58?(j.consume(ut),et=0,st):(ut===43||ut===45||ut===46||asciiAlphanumeric(ut))&&et++<32?(j.consume(ut),it):(et=0,at(ut))}function st(ut){return ut===62?(j.exit("autolinkProtocol"),j.enter("autolinkMarker"),j.consume(ut),j.exit("autolinkMarker"),j.exit("autolink"),$):ut===null||ut===32||ut===60||asciiControl(ut)?_e(ut):(j.consume(ut),st)}function at(ut){return ut===64?(j.consume(ut),ot):asciiAtext(ut)?(j.consume(ut),at):_e(ut)}function ot(ut){return asciiAlphanumeric(ut)?ct(ut):_e(ut)}function ct(ut){return ut===46?(j.consume(ut),et=0,ot):ut===62?(j.exit("autolinkProtocol").type="autolinkEmail",j.enter("autolinkMarker"),j.consume(ut),j.exit("autolinkMarker"),j.exit("autolink"),$):lt(ut)}function lt(ut){if((ut===45||asciiAlphanumeric(ut))&&et++<63){const pt=ut===45?lt:ct;return j.consume(ut),pt}return _e(ut)}}const blankLine={partial:!0,tokenize:tokenizeBlankLine};function tokenizeBlankLine(j,$,_e){return et;function et(nt){return markdownSpace(nt)?factorySpace(j,tt,"linePrefix")(nt):tt(nt)}function tt(nt){return nt===null||markdownLineEnding(nt)?$(nt):_e(nt)}}const blockQuote={continuation:{tokenize:tokenizeBlockQuoteContinuation},exit,name:"blockQuote",tokenize:tokenizeBlockQuoteStart};function tokenizeBlockQuoteStart(j,$,_e){const et=this;return tt;function tt(rt){if(rt===62){const it=et.containerState;return it.open||(j.enter("blockQuote",{_container:!0}),it.open=!0),j.enter("blockQuotePrefix"),j.enter("blockQuoteMarker"),j.consume(rt),j.exit("blockQuoteMarker"),nt}return _e(rt)}function nt(rt){return markdownSpace(rt)?(j.enter("blockQuotePrefixWhitespace"),j.consume(rt),j.exit("blockQuotePrefixWhitespace"),j.exit("blockQuotePrefix"),$):(j.exit("blockQuotePrefix"),$(rt))}}function tokenizeBlockQuoteContinuation(j,$,_e){const et=this;return tt;function tt(rt){return markdownSpace(rt)?factorySpace(j,nt,"linePrefix",et.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(rt):nt(rt)}function nt(rt){return j.attempt(blockQuote,$,_e)(rt)}}function exit(j){j.exit("blockQuote")}const characterEscape={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(j,$,_e){return et;function et(nt){return j.enter("characterEscape"),j.enter("escapeMarker"),j.consume(nt),j.exit("escapeMarker"),tt}function tt(nt){return asciiPunctuation(nt)?(j.enter("characterEscapeValue"),j.consume(nt),j.exit("characterEscapeValue"),j.exit("characterEscape"),$):_e(nt)}}const characterReference={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(j,$,_e){const et=this;let tt=0,nt,rt;return it;function it(ct){return j.enter("characterReference"),j.enter("characterReferenceMarker"),j.consume(ct),j.exit("characterReferenceMarker"),st}function st(ct){return ct===35?(j.enter("characterReferenceMarkerNumeric"),j.consume(ct),j.exit("characterReferenceMarkerNumeric"),at):(j.enter("characterReferenceValue"),nt=31,rt=asciiAlphanumeric,ot(ct))}function at(ct){return ct===88||ct===120?(j.enter("characterReferenceMarkerHexadecimal"),j.consume(ct),j.exit("characterReferenceMarkerHexadecimal"),j.enter("characterReferenceValue"),nt=6,rt=asciiHexDigit,ot):(j.enter("characterReferenceValue"),nt=7,rt=asciiDigit,ot(ct))}function ot(ct){if(ct===59&&tt){const lt=j.exit("characterReferenceValue");return rt===asciiAlphanumeric&&!decodeNamedCharacterReference(et.sliceSerialize(lt))?_e(ct):(j.enter("characterReferenceMarker"),j.consume(ct),j.exit("characterReferenceMarker"),j.exit("characterReference"),$)}return rt(ct)&&tt++<nt?(j.consume(ct),ot):_e(ct)}}const nonLazyContinuation={partial:!0,tokenize:tokenizeNonLazyContinuation},codeFenced={concrete:!0,name:"codeFenced",tokenize:tokenizeCodeFenced};function tokenizeCodeFenced(j,$,_e){const et=this,tt={partial:!0,tokenize:vt};let nt=0,rt=0,it;return st;function st(xt){return at(xt)}function at(xt){const St=et.events[et.events.length-1];return nt=St&&St[1].type==="linePrefix"?St[2].sliceSerialize(St[1],!0).length:0,it=xt,j.enter("codeFenced"),j.enter("codeFencedFence"),j.enter("codeFencedFenceSequence"),ot(xt)}function ot(xt){return xt===it?(rt++,j.consume(xt),ot):rt<3?_e(xt):(j.exit("codeFencedFenceSequence"),markdownSpace(xt)?factorySpace(j,ct,"whitespace")(xt):ct(xt))}function ct(xt){return xt===null||markdownLineEnding(xt)?(j.exit("codeFencedFence"),et.interrupt?$(xt):j.check(nonLazyContinuation,dt,yt)(xt)):(j.enter("codeFencedFenceInfo"),j.enter("chunkString",{contentType:"string"}),lt(xt))}function lt(xt){return xt===null||markdownLineEnding(xt)?(j.exit("chunkString"),j.exit("codeFencedFenceInfo"),ct(xt)):markdownSpace(xt)?(j.exit("chunkString"),j.exit("codeFencedFenceInfo"),factorySpace(j,ut,"whitespace")(xt)):xt===96&&xt===it?_e(xt):(j.consume(xt),lt)}function ut(xt){return xt===null||markdownLineEnding(xt)?ct(xt):(j.enter("codeFencedFenceMeta"),j.enter("chunkString",{contentType:"string"}),pt(xt))}function pt(xt){return xt===null||markdownLineEnding(xt)?(j.exit("chunkString"),j.exit("codeFencedFenceMeta"),ct(xt)):xt===96&&xt===it?_e(xt):(j.consume(xt),pt)}function dt(xt){return j.attempt(tt,yt,ht)(xt)}function ht(xt){return j.enter("lineEnding"),j.consume(xt),j.exit("lineEnding"),ft}function ft(xt){return nt>0&&markdownSpace(xt)?factorySpace(j,mt,"linePrefix",nt+1)(xt):mt(xt)}function mt(xt){return xt===null||markdownLineEnding(xt)?j.check(nonLazyContinuation,dt,yt)(xt):(j.enter("codeFlowValue"),gt(xt))}function gt(xt){return xt===null||markdownLineEnding(xt)?(j.exit("codeFlowValue"),mt(xt)):(j.consume(xt),gt)}function yt(xt){return j.exit("codeFenced"),$(xt)}function vt(xt,St,Et){let wt=0;return Tt;function Tt($t){return xt.enter("lineEnding"),xt.consume($t),xt.exit("lineEnding"),Ct}function Ct($t){return xt.enter("codeFencedFence"),markdownSpace($t)?factorySpace(xt,Rt,"linePrefix",et.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($t):Rt($t)}function Rt($t){return $t===it?(xt.enter("codeFencedFenceSequence"),jt($t)):Et($t)}function jt($t){return $t===it?(wt++,xt.consume($t),jt):wt>=rt?(xt.exit("codeFencedFenceSequence"),markdownSpace($t)?factorySpace(xt,Ot,"whitespace")($t):Ot($t)):Et($t)}function Ot($t){return $t===null||markdownLineEnding($t)?(xt.exit("codeFencedFence"),St($t)):Et($t)}}}function tokenizeNonLazyContinuation(j,$,_e){const et=this;return tt;function tt(rt){return rt===null?_e(rt):(j.enter("lineEnding"),j.consume(rt),j.exit("lineEnding"),nt)}function nt(rt){return et.parser.lazy[et.now().line]?_e(rt):$(rt)}}const codeIndented={name:"codeIndented",tokenize:tokenizeCodeIndented},furtherStart={partial:!0,tokenize:tokenizeFurtherStart};function tokenizeCodeIndented(j,$,_e){const et=this;return tt;function tt(at){return j.enter("codeIndented"),factorySpace(j,nt,"linePrefix",5)(at)}function nt(at){const ot=et.events[et.events.length-1];return ot&&ot[1].type==="linePrefix"&&ot[2].sliceSerialize(ot[1],!0).length>=4?rt(at):_e(at)}function rt(at){return at===null?st(at):markdownLineEnding(at)?j.attempt(furtherStart,rt,st)(at):(j.enter("codeFlowValue"),it(at))}function it(at){return at===null||markdownLineEnding(at)?(j.exit("codeFlowValue"),rt(at)):(j.consume(at),it)}function st(at){return j.exit("codeIndented"),$(at)}}function tokenizeFurtherStart(j,$,_e){const et=this;return tt;function tt(rt){return et.parser.lazy[et.now().line]?_e(rt):markdownLineEnding(rt)?(j.enter("lineEnding"),j.consume(rt),j.exit("lineEnding"),tt):factorySpace(j,nt,"linePrefix",5)(rt)}function nt(rt){const it=et.events[et.events.length-1];return it&&it[1].type==="linePrefix"&&it[2].sliceSerialize(it[1],!0).length>=4?$(rt):markdownLineEnding(rt)?tt(rt):_e(rt)}}const codeText={name:"codeText",previous,resolve:resolveCodeText,tokenize:tokenizeCodeText};function resolveCodeText(j){let $=j.length-4,_e=3,et,tt;if((j[_e][1].type==="lineEnding"||j[_e][1].type==="space")&&(j[$][1].type==="lineEnding"||j[$][1].type==="space")){for(et=_e;++et<$;)if(j[et][1].type==="codeTextData"){j[_e][1].type="codeTextPadding",j[$][1].type="codeTextPadding",_e+=2,$-=2;break}}for(et=_e-1,$++;++et<=$;)tt===void 0?et!==$&&j[et][1].type!=="lineEnding"&&(tt=et):(et===$||j[et][1].type==="lineEnding")&&(j[tt][1].type="codeTextData",et!==tt+2&&(j[tt][1].end=j[et-1][1].end,j.splice(tt+2,et-tt-2),$-=et-tt-2,et=tt+2),tt=void 0);return j}function previous(j){return j!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tokenizeCodeText(j,$,_e){let et=0,tt,nt;return rt;function rt(ct){return j.enter("codeText"),j.enter("codeTextSequence"),it(ct)}function it(ct){return ct===96?(j.consume(ct),et++,it):(j.exit("codeTextSequence"),st(ct))}function st(ct){return ct===null?_e(ct):ct===32?(j.enter("space"),j.consume(ct),j.exit("space"),st):ct===96?(nt=j.enter("codeTextSequence"),tt=0,ot(ct)):markdownLineEnding(ct)?(j.enter("lineEnding"),j.consume(ct),j.exit("lineEnding"),st):(j.enter("codeTextData"),at(ct))}function at(ct){return ct===null||ct===32||ct===96||markdownLineEnding(ct)?(j.exit("codeTextData"),st(ct)):(j.consume(ct),at)}function ot(ct){return ct===96?(j.consume(ct),tt++,ot):tt===et?(j.exit("codeTextSequence"),j.exit("codeText"),$(ct)):(nt.type="codeTextData",at(ct))}}class SpliceBuffer{constructor($){this.left=$?[...$]:[],this.right=[]}get($){if($<0||$>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+$+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return $<this.left.length?this.left[$]:this.right[this.right.length-$+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice($,_e){const et=_e??Number.POSITIVE_INFINITY;return et<this.left.length?this.left.slice($,et):$>this.left.length?this.right.slice(this.right.length-et+this.left.length,this.right.length-$+this.left.length).reverse():this.left.slice($).concat(this.right.slice(this.right.length-et+this.left.length).reverse())}splice($,_e,et){const tt=_e||0;this.setCursor(Math.trunc($));const nt=this.right.splice(this.right.length-tt,Number.POSITIVE_INFINITY);return et&&chunkedPush(this.left,et),nt.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push($){this.setCursor(Number.POSITIVE_INFINITY),this.left.push($)}pushMany($){this.setCursor(Number.POSITIVE_INFINITY),chunkedPush(this.left,$)}unshift($){this.setCursor(0),this.right.push($)}unshiftMany($){this.setCursor(0),chunkedPush(this.right,$.reverse())}setCursor($){if(!($===this.left.length||$>this.left.length&&this.right.length===0||$<0&&this.left.length===0))if($<this.left.length){const _e=this.left.splice($,Number.POSITIVE_INFINITY);chunkedPush(this.right,_e.reverse())}else{const _e=this.right.splice(this.left.length+this.right.length-$,Number.POSITIVE_INFINITY);chunkedPush(this.left,_e.reverse())}}}function chunkedPush(j,$){let _e=0;if($.length<1e4)j.push(...$);else for(;_e<$.length;)j.push(...$.slice(_e,_e+1e4)),_e+=1e4}function subtokenize(j){const $={};let _e=-1,et,tt,nt,rt,it,st,at;const ot=new SpliceBuffer(j);for(;++_e<ot.length;){for(;_e in $;)_e=$[_e];if(et=ot.get(_e),_e&&et[1].type==="chunkFlow"&&ot.get(_e-1)[1].type==="listItemPrefix"&&(st=et[1]._tokenizer.events,nt=0,nt<st.length&&st[nt][1].type==="lineEndingBlank"&&(nt+=2),nt<st.length&&st[nt][1].type==="content"))for(;++nt<st.length&&st[nt][1].type!=="content";)st[nt][1].type==="chunkText"&&(st[nt][1]._isInFirstContentOfListItem=!0,nt++);if(et[0]==="enter")et[1].contentType&&(Object.assign($,subcontent(ot,_e)),_e=$[_e],at=!0);else if(et[1]._container){for(nt=_e,tt=void 0;nt--;)if(rt=ot.get(nt),rt[1].type==="lineEnding"||rt[1].type==="lineEndingBlank")rt[0]==="enter"&&(tt&&(ot.get(tt)[1].type="lineEndingBlank"),rt[1].type="lineEnding",tt=nt);else if(!(rt[1].type==="linePrefix"||rt[1].type==="listItemIndent"))break;tt&&(et[1].end={...ot.get(tt)[1].start},it=ot.slice(tt,_e),it.unshift(et),ot.splice(tt,_e-tt+1,it))}}return splice(j,0,Number.POSITIVE_INFINITY,ot.slice(0)),!at}function subcontent(j,$){const _e=j.get($)[1],et=j.get($)[2];let tt=$-1;const nt=[];let rt=_e._tokenizer;rt||(rt=et.parser[_e.contentType](_e.start),_e._contentTypeTextTrailing&&(rt._contentTypeTextTrailing=!0));const it=rt.events,st=[],at={};let ot,ct,lt=-1,ut=_e,pt=0,dt=0;const ht=[dt];for(;ut;){for(;j.get(++tt)[1]!==ut;);nt.push(tt),ut._tokenizer||(ot=et.sliceStream(ut),ut.next||ot.push(null),ct&&rt.defineSkip(ut.start),ut._isInFirstContentOfListItem&&(rt._gfmTasklistFirstContentOfListItem=!0),rt.write(ot),ut._isInFirstContentOfListItem&&(rt._gfmTasklistFirstContentOfListItem=void 0)),ct=ut,ut=ut.next}for(ut=_e;++lt<it.length;)it[lt][0]==="exit"&&it[lt-1][0]==="enter"&&it[lt][1].type===it[lt-1][1].type&&it[lt][1].start.line!==it[lt][1].end.line&&(dt=lt+1,ht.push(dt),ut._tokenizer=void 0,ut.previous=void 0,ut=ut.next);for(rt.events=[],ut?(ut._tokenizer=void 0,ut.previous=void 0):ht.pop(),lt=ht.length;lt--;){const ft=it.slice(ht[lt],ht[lt+1]),mt=nt.pop();st.push([mt,mt+ft.length-1]),j.splice(mt,2,ft)}for(st.reverse(),lt=-1;++lt<st.length;)at[pt+st[lt][0]]=pt+st[lt][1],pt+=st[lt][1]-st[lt][0]-1;return at}const content={resolve:resolveContent,tokenize:tokenizeContent},continuationConstruct={partial:!0,tokenize:tokenizeContinuation};function resolveContent(j){return subtokenize(j),j}function tokenizeContent(j,$){let _e;return et;function et(it){return j.enter("content"),_e=j.enter("chunkContent",{contentType:"content"}),tt(it)}function tt(it){return it===null?nt(it):markdownLineEnding(it)?j.check(continuationConstruct,rt,nt)(it):(j.consume(it),tt)}function nt(it){return j.exit("chunkContent"),j.exit("content"),$(it)}function rt(it){return j.consume(it),j.exit("chunkContent"),_e.next=j.enter("chunkContent",{contentType:"content",previous:_e}),_e=_e.next,tt}}function tokenizeContinuation(j,$,_e){const et=this;return tt;function tt(rt){return j.exit("chunkContent"),j.enter("lineEnding"),j.consume(rt),j.exit("lineEnding"),factorySpace(j,nt,"linePrefix")}function nt(rt){if(rt===null||markdownLineEnding(rt))return _e(rt);const it=et.events[et.events.length-1];return!et.parser.constructs.disable.null.includes("codeIndented")&&it&&it[1].type==="linePrefix"&&it[2].sliceSerialize(it[1],!0).length>=4?$(rt):j.interrupt(et.parser.constructs.flow,_e,$)(rt)}}function factoryDestination(j,$,_e,et,tt,nt,rt,it,st){const at=st||Number.POSITIVE_INFINITY;let ot=0;return ct;function ct(ft){return ft===60?(j.enter(et),j.enter(tt),j.enter(nt),j.consume(ft),j.exit(nt),lt):ft===null||ft===32||ft===41||asciiControl(ft)?_e(ft):(j.enter(et),j.enter(rt),j.enter(it),j.enter("chunkString",{contentType:"string"}),dt(ft))}function lt(ft){return ft===62?(j.enter(nt),j.consume(ft),j.exit(nt),j.exit(tt),j.exit(et),$):(j.enter(it),j.enter("chunkString",{contentType:"string"}),ut(ft))}function ut(ft){return ft===62?(j.exit("chunkString"),j.exit(it),lt(ft)):ft===null||ft===60||markdownLineEnding(ft)?_e(ft):(j.consume(ft),ft===92?pt:ut)}function pt(ft){return ft===60||ft===62||ft===92?(j.consume(ft),ut):ut(ft)}function dt(ft){return!ot&&(ft===null||ft===41||markdownLineEndingOrSpace(ft))?(j.exit("chunkString"),j.exit(it),j.exit(rt),j.exit(et),$(ft)):ot<at&&ft===40?(j.consume(ft),ot++,dt):ft===41?(j.consume(ft),ot--,dt):ft===null||ft===32||ft===40||asciiControl(ft)?_e(ft):(j.consume(ft),ft===92?ht:dt)}function ht(ft){return ft===40||ft===41||ft===92?(j.consume(ft),dt):dt(ft)}}function factoryLabel(j,$,_e,et,tt,nt){const rt=this;let it=0,st;return at;function at(ut){return j.enter(et),j.enter(tt),j.consume(ut),j.exit(tt),j.enter(nt),ot}function ot(ut){return it>999||ut===null||ut===91||ut===93&&!st||ut===94&&!it&&"_hiddenFootnoteSupport"in rt.parser.constructs?_e(ut):ut===93?(j.exit(nt),j.enter(tt),j.consume(ut),j.exit(tt),j.exit(et),$):markdownLineEnding(ut)?(j.enter("lineEnding"),j.consume(ut),j.exit("lineEnding"),ot):(j.enter("chunkString",{contentType:"string"}),ct(ut))}function ct(ut){return ut===null||ut===91||ut===93||markdownLineEnding(ut)||it++>999?(j.exit("chunkString"),ot(ut)):(j.consume(ut),st||(st=!markdownSpace(ut)),ut===92?lt:ct)}function lt(ut){return ut===91||ut===92||ut===93?(j.consume(ut),it++,ct):ct(ut)}}function factoryTitle(j,$,_e,et,tt,nt){let rt;return it;function it(lt){return lt===34||lt===39||lt===40?(j.enter(et),j.enter(tt),j.consume(lt),j.exit(tt),rt=lt===40?41:lt,st):_e(lt)}function st(lt){return lt===rt?(j.enter(tt),j.consume(lt),j.exit(tt),j.exit(et),$):(j.enter(nt),at(lt))}function at(lt){return lt===rt?(j.exit(nt),st(rt)):lt===null?_e(lt):markdownLineEnding(lt)?(j.enter("lineEnding"),j.consume(lt),j.exit("lineEnding"),factorySpace(j,at,"linePrefix")):(j.enter("chunkString",{contentType:"string"}),ot(lt))}function ot(lt){return lt===rt||lt===null||markdownLineEnding(lt)?(j.exit("chunkString"),at(lt)):(j.consume(lt),lt===92?ct:ot)}function ct(lt){return lt===rt||lt===92?(j.consume(lt),ot):ot(lt)}}function factoryWhitespace(j,$){let _e;return et;function et(tt){return markdownLineEnding(tt)?(j.enter("lineEnding"),j.consume(tt),j.exit("lineEnding"),_e=!0,et):markdownSpace(tt)?factorySpace(j,et,_e?"linePrefix":"lineSuffix")(tt):$(tt)}}const definition={name:"definition",tokenize:tokenizeDefinition},titleBefore={partial:!0,tokenize:tokenizeTitleBefore};function tokenizeDefinition(j,$,_e){const et=this;let tt;return nt;function nt(ut){return j.enter("definition"),rt(ut)}function rt(ut){return factoryLabel.call(et,j,it,_e,"definitionLabel","definitionLabelMarker","definitionLabelString")(ut)}function it(ut){return tt=normalizeIdentifier(et.sliceSerialize(et.events[et.events.length-1][1]).slice(1,-1)),ut===58?(j.enter("definitionMarker"),j.consume(ut),j.exit("definitionMarker"),st):_e(ut)}function st(ut){return markdownLineEndingOrSpace(ut)?factoryWhitespace(j,at)(ut):at(ut)}function at(ut){return factoryDestination(j,ot,_e,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(ut)}function ot(ut){return j.attempt(titleBefore,ct,ct)(ut)}function ct(ut){return markdownSpace(ut)?factorySpace(j,lt,"whitespace")(ut):lt(ut)}function lt(ut){return ut===null||markdownLineEnding(ut)?(j.exit("definition"),et.parser.defined.push(tt),$(ut)):_e(ut)}}function tokenizeTitleBefore(j,$,_e){return et;function et(it){return markdownLineEndingOrSpace(it)?factoryWhitespace(j,tt)(it):_e(it)}function tt(it){return factoryTitle(j,nt,_e,"definitionTitle","definitionTitleMarker","definitionTitleString")(it)}function nt(it){return markdownSpace(it)?factorySpace(j,rt,"whitespace")(it):rt(it)}function rt(it){return it===null||markdownLineEnding(it)?$(it):_e(it)}}const hardBreakEscape={name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape};function tokenizeHardBreakEscape(j,$,_e){return et;function et(nt){return j.enter("hardBreakEscape"),j.consume(nt),tt}function tt(nt){return markdownLineEnding(nt)?(j.exit("hardBreakEscape"),$(nt)):_e(nt)}}const headingAtx={name:"headingAtx",resolve:resolveHeadingAtx,tokenize:tokenizeHeadingAtx};function resolveHeadingAtx(j,$){let _e=j.length-2,et=3,tt,nt;return j[et][1].type==="whitespace"&&(et+=2),_e-2>et&&j[_e][1].type==="whitespace"&&(_e-=2),j[_e][1].type==="atxHeadingSequence"&&(et===_e-1||_e-4>et&&j[_e-2][1].type==="whitespace")&&(_e-=et+1===_e?2:4),_e>et&&(tt={type:"atxHeadingText",start:j[et][1].start,end:j[_e][1].end},nt={type:"chunkText",start:j[et][1].start,end:j[_e][1].end,contentType:"text"},splice(j,et,_e-et+1,[["enter",tt,$],["enter",nt,$],["exit",nt,$],["exit",tt,$]])),j}function tokenizeHeadingAtx(j,$,_e){let et=0;return tt;function tt(ot){return j.enter("atxHeading"),nt(ot)}function nt(ot){return j.enter("atxHeadingSequence"),rt(ot)}function rt(ot){return ot===35&&et++<6?(j.consume(ot),rt):ot===null||markdownLineEndingOrSpace(ot)?(j.exit("atxHeadingSequence"),it(ot)):_e(ot)}function it(ot){return ot===35?(j.enter("atxHeadingSequence"),st(ot)):ot===null||markdownLineEnding(ot)?(j.exit("atxHeading"),$(ot)):markdownSpace(ot)?factorySpace(j,it,"whitespace")(ot):(j.enter("atxHeadingText"),at(ot))}function st(ot){return ot===35?(j.consume(ot),st):(j.exit("atxHeadingSequence"),it(ot))}function at(ot){return ot===null||ot===35||markdownLineEndingOrSpace(ot)?(j.exit("atxHeadingText"),it(ot)):(j.consume(ot),at)}}const htmlBlockNames=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlRawNames=["pre","script","style","textarea"],htmlFlow={concrete:!0,name:"htmlFlow",resolveTo:resolveToHtmlFlow,tokenize:tokenizeHtmlFlow},blankLineBefore={partial:!0,tokenize:tokenizeBlankLineBefore},nonLazyContinuationStart={partial:!0,tokenize:tokenizeNonLazyContinuationStart};function resolveToHtmlFlow(j){let $=j.length;for(;$--&&!(j[$][0]==="enter"&&j[$][1].type==="htmlFlow"););return $>1&&j[$-2][1].type==="linePrefix"&&(j[$][1].start=j[$-2][1].start,j[$+1][1].start=j[$-2][1].start,j.splice($-2,2)),j}function tokenizeHtmlFlow(j,$,_e){const et=this;let tt,nt,rt,it,st;return at;function at(_t){return ot(_t)}function ot(_t){return j.enter("htmlFlow"),j.enter("htmlFlowData"),j.consume(_t),ct}function ct(_t){return _t===33?(j.consume(_t),lt):_t===47?(j.consume(_t),nt=!0,dt):_t===63?(j.consume(_t),tt=3,et.interrupt?$:kt):asciiAlpha(_t)?(j.consume(_t),rt=String.fromCharCode(_t),ht):_e(_t)}function lt(_t){return _t===45?(j.consume(_t),tt=2,ut):_t===91?(j.consume(_t),tt=5,it=0,pt):asciiAlpha(_t)?(j.consume(_t),tt=4,et.interrupt?$:kt):_e(_t)}function ut(_t){return _t===45?(j.consume(_t),et.interrupt?$:kt):_e(_t)}function pt(_t){const sn="CDATA[";return _t===sn.charCodeAt(it++)?(j.consume(_t),it===sn.length?et.interrupt?$:Rt:pt):_e(_t)}function dt(_t){return asciiAlpha(_t)?(j.consume(_t),rt=String.fromCharCode(_t),ht):_e(_t)}function ht(_t){if(_t===null||_t===47||_t===62||markdownLineEndingOrSpace(_t)){const sn=_t===47,tn=rt.toLowerCase();return!sn&&!nt&&htmlRawNames.includes(tn)?(tt=1,et.interrupt?$(_t):Rt(_t)):htmlBlockNames.includes(rt.toLowerCase())?(tt=6,sn?(j.consume(_t),ft):et.interrupt?$(_t):Rt(_t)):(tt=7,et.interrupt&&!et.parser.lazy[et.now().line]?_e(_t):nt?mt(_t):gt(_t))}return _t===45||asciiAlphanumeric(_t)?(j.consume(_t),rt+=String.fromCharCode(_t),ht):_e(_t)}function ft(_t){return _t===62?(j.consume(_t),et.interrupt?$:Rt):_e(_t)}function mt(_t){return markdownSpace(_t)?(j.consume(_t),mt):Tt(_t)}function gt(_t){return _t===47?(j.consume(_t),Tt):_t===58||_t===95||asciiAlpha(_t)?(j.consume(_t),yt):markdownSpace(_t)?(j.consume(_t),gt):Tt(_t)}function yt(_t){return _t===45||_t===46||_t===58||_t===95||asciiAlphanumeric(_t)?(j.consume(_t),yt):vt(_t)}function vt(_t){return _t===61?(j.consume(_t),xt):markdownSpace(_t)?(j.consume(_t),vt):gt(_t)}function xt(_t){return _t===null||_t===60||_t===61||_t===62||_t===96?_e(_t):_t===34||_t===39?(j.consume(_t),st=_t,St):markdownSpace(_t)?(j.consume(_t),xt):Et(_t)}function St(_t){return _t===st?(j.consume(_t),st=null,wt):_t===null||markdownLineEnding(_t)?_e(_t):(j.consume(_t),St)}function Et(_t){return _t===null||_t===34||_t===39||_t===47||_t===60||_t===61||_t===62||_t===96||markdownLineEndingOrSpace(_t)?vt(_t):(j.consume(_t),Et)}function wt(_t){return _t===47||_t===62||markdownSpace(_t)?gt(_t):_e(_t)}function Tt(_t){return _t===62?(j.consume(_t),Ct):_e(_t)}function Ct(_t){return _t===null||markdownLineEnding(_t)?Rt(_t):markdownSpace(_t)?(j.consume(_t),Ct):_e(_t)}function Rt(_t){return _t===45&&tt===2?(j.consume(_t),Kt):_t===60&&tt===1?(j.consume(_t),Lt):_t===62&&tt===4?(j.consume(_t),rn):_t===63&&tt===3?(j.consume(_t),kt):_t===93&&tt===5?(j.consume(_t),Bt):markdownLineEnding(_t)&&(tt===6||tt===7)?(j.exit("htmlFlowData"),j.check(blankLineBefore,Gt,jt)(_t)):_t===null||markdownLineEnding(_t)?(j.exit("htmlFlowData"),jt(_t)):(j.consume(_t),Rt)}function jt(_t){return j.check(nonLazyContinuationStart,Ot,Gt)(_t)}function Ot(_t){return j.enter("lineEnding"),j.consume(_t),j.exit("lineEnding"),$t}function $t(_t){return _t===null||markdownLineEnding(_t)?jt(_t):(j.enter("htmlFlowData"),Rt(_t))}function Kt(_t){return _t===45?(j.consume(_t),kt):Rt(_t)}function Lt(_t){return _t===47?(j.consume(_t),rt="",Nt):Rt(_t)}function Nt(_t){if(_t===62){const sn=rt.toLowerCase();return htmlRawNames.includes(sn)?(j.consume(_t),rn):Rt(_t)}return asciiAlpha(_t)&&rt.length<8?(j.consume(_t),rt+=String.fromCharCode(_t),Nt):Rt(_t)}function Bt(_t){return _t===93?(j.consume(_t),kt):Rt(_t)}function kt(_t){return _t===62?(j.consume(_t),rn):_t===45&&tt===2?(j.consume(_t),kt):Rt(_t)}function rn(_t){return _t===null||markdownLineEnding(_t)?(j.exit("htmlFlowData"),Gt(_t)):(j.consume(_t),rn)}function Gt(_t){return j.exit("htmlFlow"),$(_t)}}function tokenizeNonLazyContinuationStart(j,$,_e){const et=this;return tt;function tt(rt){return markdownLineEnding(rt)?(j.enter("lineEnding"),j.consume(rt),j.exit("lineEnding"),nt):_e(rt)}function nt(rt){return et.parser.lazy[et.now().line]?_e(rt):$(rt)}}function tokenizeBlankLineBefore(j,$,_e){return et;function et(tt){return j.enter("lineEnding"),j.consume(tt),j.exit("lineEnding"),j.attempt(blankLine,$,_e)}}const htmlText={name:"htmlText",tokenize:tokenizeHtmlText};function tokenizeHtmlText(j,$,_e){const et=this;let tt,nt,rt;return it;function it(kt){return j.enter("htmlText"),j.enter("htmlTextData"),j.consume(kt),st}function st(kt){return kt===33?(j.consume(kt),at):kt===47?(j.consume(kt),vt):kt===63?(j.consume(kt),gt):asciiAlpha(kt)?(j.consume(kt),Et):_e(kt)}function at(kt){return kt===45?(j.consume(kt),ot):kt===91?(j.consume(kt),nt=0,pt):asciiAlpha(kt)?(j.consume(kt),mt):_e(kt)}function ot(kt){return kt===45?(j.consume(kt),ut):_e(kt)}function ct(kt){return kt===null?_e(kt):kt===45?(j.consume(kt),lt):markdownLineEnding(kt)?(rt=ct,Lt(kt)):(j.consume(kt),ct)}function lt(kt){return kt===45?(j.consume(kt),ut):ct(kt)}function ut(kt){return kt===62?Kt(kt):kt===45?lt(kt):ct(kt)}function pt(kt){const rn="CDATA[";return kt===rn.charCodeAt(nt++)?(j.consume(kt),nt===rn.length?dt:pt):_e(kt)}function dt(kt){return kt===null?_e(kt):kt===93?(j.consume(kt),ht):markdownLineEnding(kt)?(rt=dt,Lt(kt)):(j.consume(kt),dt)}function ht(kt){return kt===93?(j.consume(kt),ft):dt(kt)}function ft(kt){return kt===62?Kt(kt):kt===93?(j.consume(kt),ft):dt(kt)}function mt(kt){return kt===null||kt===62?Kt(kt):markdownLineEnding(kt)?(rt=mt,Lt(kt)):(j.consume(kt),mt)}function gt(kt){return kt===null?_e(kt):kt===63?(j.consume(kt),yt):markdownLineEnding(kt)?(rt=gt,Lt(kt)):(j.consume(kt),gt)}function yt(kt){return kt===62?Kt(kt):gt(kt)}function vt(kt){return asciiAlpha(kt)?(j.consume(kt),xt):_e(kt)}function xt(kt){return kt===45||asciiAlphanumeric(kt)?(j.consume(kt),xt):St(kt)}function St(kt){return markdownLineEnding(kt)?(rt=St,Lt(kt)):markdownSpace(kt)?(j.consume(kt),St):Kt(kt)}function Et(kt){return kt===45||asciiAlphanumeric(kt)?(j.consume(kt),Et):kt===47||kt===62||markdownLineEndingOrSpace(kt)?wt(kt):_e(kt)}function wt(kt){return kt===47?(j.consume(kt),Kt):kt===58||kt===95||asciiAlpha(kt)?(j.consume(kt),Tt):markdownLineEnding(kt)?(rt=wt,Lt(kt)):markdownSpace(kt)?(j.consume(kt),wt):Kt(kt)}function Tt(kt){return kt===45||kt===46||kt===58||kt===95||asciiAlphanumeric(kt)?(j.consume(kt),Tt):Ct(kt)}function Ct(kt){return kt===61?(j.consume(kt),Rt):markdownLineEnding(kt)?(rt=Ct,Lt(kt)):markdownSpace(kt)?(j.consume(kt),Ct):wt(kt)}function Rt(kt){return kt===null||kt===60||kt===61||kt===62||kt===96?_e(kt):kt===34||kt===39?(j.consume(kt),tt=kt,jt):markdownLineEnding(kt)?(rt=Rt,Lt(kt)):markdownSpace(kt)?(j.consume(kt),Rt):(j.consume(kt),Ot)}function jt(kt){return kt===tt?(j.consume(kt),tt=void 0,$t):kt===null?_e(kt):markdownLineEnding(kt)?(rt=jt,Lt(kt)):(j.consume(kt),jt)}function Ot(kt){return kt===null||kt===34||kt===39||kt===60||kt===61||kt===96?_e(kt):kt===47||kt===62||markdownLineEndingOrSpace(kt)?wt(kt):(j.consume(kt),Ot)}function $t(kt){return kt===47||kt===62||markdownLineEndingOrSpace(kt)?wt(kt):_e(kt)}function Kt(kt){return kt===62?(j.consume(kt),j.exit("htmlTextData"),j.exit("htmlText"),$):_e(kt)}function Lt(kt){return j.exit("htmlTextData"),j.enter("lineEnding"),j.consume(kt),j.exit("lineEnding"),Nt}function Nt(kt){return markdownSpace(kt)?factorySpace(j,Bt,"linePrefix",et.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(kt):Bt(kt)}function Bt(kt){return j.enter("htmlTextData"),rt(kt)}}const labelEnd={name:"labelEnd",resolveAll:resolveAllLabelEnd,resolveTo:resolveToLabelEnd,tokenize:tokenizeLabelEnd},resourceConstruct={tokenize:tokenizeResource},referenceFullConstruct={tokenize:tokenizeReferenceFull},referenceCollapsedConstruct={tokenize:tokenizeReferenceCollapsed};function resolveAllLabelEnd(j){let $=-1;const _e=[];for(;++$<j.length;){const et=j[$][1];if(_e.push(j[$]),et.type==="labelImage"||et.type==="labelLink"||et.type==="labelEnd"){const tt=et.type==="labelImage"?4:2;et.type="data",$+=tt}}return j.length!==_e.length&&splice(j,0,j.length,_e),j}function resolveToLabelEnd(j,$){let _e=j.length,et=0,tt,nt,rt,it;for(;_e--;)if(tt=j[_e][1],nt){if(tt.type==="link"||tt.type==="labelLink"&&tt._inactive)break;j[_e][0]==="enter"&&tt.type==="labelLink"&&(tt._inactive=!0)}else if(rt){if(j[_e][0]==="enter"&&(tt.type==="labelImage"||tt.type==="labelLink")&&!tt._balanced&&(nt=_e,tt.type!=="labelLink")){et=2;break}}else tt.type==="labelEnd"&&(rt=_e);const st={type:j[nt][1].type==="labelLink"?"link":"image",start:{...j[nt][1].start},end:{...j[j.length-1][1].end}},at={type:"label",start:{...j[nt][1].start},end:{...j[rt][1].end}},ot={type:"labelText",start:{...j[nt+et+2][1].end},end:{...j[rt-2][1].start}};return it=[["enter",st,$],["enter",at,$]],it=push(it,j.slice(nt+1,nt+et+3)),it=push(it,[["enter",ot,$]]),it=push(it,resolveAll($.parser.constructs.insideSpan.null,j.slice(nt+et+4,rt-3),$)),it=push(it,[["exit",ot,$],j[rt-2],j[rt-1],["exit",at,$]]),it=push(it,j.slice(rt+1)),it=push(it,[["exit",st,$]]),splice(j,nt,j.length,it),j}function tokenizeLabelEnd(j,$,_e){const et=this;let tt=et.events.length,nt,rt;for(;tt--;)if((et.events[tt][1].type==="labelImage"||et.events[tt][1].type==="labelLink")&&!et.events[tt][1]._balanced){nt=et.events[tt][1];break}return it;function it(lt){return nt?nt._inactive?ct(lt):(rt=et.parser.defined.includes(normalizeIdentifier(et.sliceSerialize({start:nt.end,end:et.now()}))),j.enter("labelEnd"),j.enter("labelMarker"),j.consume(lt),j.exit("labelMarker"),j.exit("labelEnd"),st):_e(lt)}function st(lt){return lt===40?j.attempt(resourceConstruct,ot,rt?ot:ct)(lt):lt===91?j.attempt(referenceFullConstruct,ot,rt?at:ct)(lt):rt?ot(lt):ct(lt)}function at(lt){return j.attempt(referenceCollapsedConstruct,ot,ct)(lt)}function ot(lt){return $(lt)}function ct(lt){return nt._balanced=!0,_e(lt)}}function tokenizeResource(j,$,_e){return et;function et(ct){return j.enter("resource"),j.enter("resourceMarker"),j.consume(ct),j.exit("resourceMarker"),tt}function tt(ct){return markdownLineEndingOrSpace(ct)?factoryWhitespace(j,nt)(ct):nt(ct)}function nt(ct){return ct===41?ot(ct):factoryDestination(j,rt,it,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(ct)}function rt(ct){return markdownLineEndingOrSpace(ct)?factoryWhitespace(j,st)(ct):ot(ct)}function it(ct){return _e(ct)}function st(ct){return ct===34||ct===39||ct===40?factoryTitle(j,at,_e,"resourceTitle","resourceTitleMarker","resourceTitleString")(ct):ot(ct)}function at(ct){return markdownLineEndingOrSpace(ct)?factoryWhitespace(j,ot)(ct):ot(ct)}function ot(ct){return ct===41?(j.enter("resourceMarker"),j.consume(ct),j.exit("resourceMarker"),j.exit("resource"),$):_e(ct)}}function tokenizeReferenceFull(j,$,_e){const et=this;return tt;function tt(it){return factoryLabel.call(et,j,nt,rt,"reference","referenceMarker","referenceString")(it)}function nt(it){return et.parser.defined.includes(normalizeIdentifier(et.sliceSerialize(et.events[et.events.length-1][1]).slice(1,-1)))?$(it):_e(it)}function rt(it){return _e(it)}}function tokenizeReferenceCollapsed(j,$,_e){return et;function et(nt){return j.enter("reference"),j.enter("referenceMarker"),j.consume(nt),j.exit("referenceMarker"),tt}function tt(nt){return nt===93?(j.enter("referenceMarker"),j.consume(nt),j.exit("referenceMarker"),j.exit("reference"),$):_e(nt)}}const labelStartImage={name:"labelStartImage",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartImage};function tokenizeLabelStartImage(j,$,_e){const et=this;return tt;function tt(it){return j.enter("labelImage"),j.enter("labelImageMarker"),j.consume(it),j.exit("labelImageMarker"),nt}function nt(it){return it===91?(j.enter("labelMarker"),j.consume(it),j.exit("labelMarker"),j.exit("labelImage"),rt):_e(it)}function rt(it){return it===94&&"_hiddenFootnoteSupport"in et.parser.constructs?_e(it):$(it)}}const labelStartLink={name:"labelStartLink",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartLink};function tokenizeLabelStartLink(j,$,_e){const et=this;return tt;function tt(rt){return j.enter("labelLink"),j.enter("labelMarker"),j.consume(rt),j.exit("labelMarker"),j.exit("labelLink"),nt}function nt(rt){return rt===94&&"_hiddenFootnoteSupport"in et.parser.constructs?_e(rt):$(rt)}}const lineEnding={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(j,$){return _e;function _e(et){return j.enter("lineEnding"),j.consume(et),j.exit("lineEnding"),factorySpace(j,$,"linePrefix")}}const thematicBreak$1={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(j,$,_e){let et=0,tt;return nt;function nt(at){return j.enter("thematicBreak"),rt(at)}function rt(at){return tt=at,it(at)}function it(at){return at===tt?(j.enter("thematicBreakSequence"),st(at)):et>=3&&(at===null||markdownLineEnding(at))?(j.exit("thematicBreak"),$(at)):_e(at)}function st(at){return at===tt?(j.consume(at),et++,st):(j.exit("thematicBreakSequence"),markdownSpace(at)?factorySpace(j,it,"whitespace")(at):it(at))}}const list$1={continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd,name:"list",tokenize:tokenizeListStart},listItemPrefixWhitespaceConstruct={partial:!0,tokenize:tokenizeListItemPrefixWhitespace},indentConstruct={partial:!0,tokenize:tokenizeIndent};function tokenizeListStart(j,$,_e){const et=this,tt=et.events[et.events.length-1];let nt=tt&&tt[1].type==="linePrefix"?tt[2].sliceSerialize(tt[1],!0).length:0,rt=0;return it;function it(ut){const pt=et.containerState.type||(ut===42||ut===43||ut===45?"listUnordered":"listOrdered");if(pt==="listUnordered"?!et.containerState.marker||ut===et.containerState.marker:asciiDigit(ut)){if(et.containerState.type||(et.containerState.type=pt,j.enter(pt,{_container:!0})),pt==="listUnordered")return j.enter("listItemPrefix"),ut===42||ut===45?j.check(thematicBreak$1,_e,at)(ut):at(ut);if(!et.interrupt||ut===49)return j.enter("listItemPrefix"),j.enter("listItemValue"),st(ut)}return _e(ut)}function st(ut){return asciiDigit(ut)&&++rt<10?(j.consume(ut),st):(!et.interrupt||rt<2)&&(et.containerState.marker?ut===et.containerState.marker:ut===41||ut===46)?(j.exit("listItemValue"),at(ut)):_e(ut)}function at(ut){return j.enter("listItemMarker"),j.consume(ut),j.exit("listItemMarker"),et.containerState.marker=et.containerState.marker||ut,j.check(blankLine,et.interrupt?_e:ot,j.attempt(listItemPrefixWhitespaceConstruct,lt,ct))}function ot(ut){return et.containerState.initialBlankLine=!0,nt++,lt(ut)}function ct(ut){return markdownSpace(ut)?(j.enter("listItemPrefixWhitespace"),j.consume(ut),j.exit("listItemPrefixWhitespace"),lt):_e(ut)}function lt(ut){return et.containerState.size=nt+et.sliceSerialize(j.exit("listItemPrefix"),!0).length,$(ut)}}function tokenizeListContinuation(j,$,_e){const et=this;return et.containerState._closeFlow=void 0,j.check(blankLine,tt,nt);function tt(it){return et.containerState.furtherBlankLines=et.containerState.furtherBlankLines||et.containerState.initialBlankLine,factorySpace(j,$,"listItemIndent",et.containerState.size+1)(it)}function nt(it){return et.containerState.furtherBlankLines||!markdownSpace(it)?(et.containerState.furtherBlankLines=void 0,et.containerState.initialBlankLine=void 0,rt(it)):(et.containerState.furtherBlankLines=void 0,et.containerState.initialBlankLine=void 0,j.attempt(indentConstruct,$,rt)(it))}function rt(it){return et.containerState._closeFlow=!0,et.interrupt=void 0,factorySpace(j,j.attempt(list$1,$,_e),"linePrefix",et.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(it)}}function tokenizeIndent(j,$,_e){const et=this;return factorySpace(j,tt,"listItemIndent",et.containerState.size+1);function tt(nt){const rt=et.events[et.events.length-1];return rt&&rt[1].type==="listItemIndent"&&rt[2].sliceSerialize(rt[1],!0).length===et.containerState.size?$(nt):_e(nt)}}function tokenizeListEnd(j){j.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(j,$,_e){const et=this;return factorySpace(j,tt,"listItemPrefixWhitespace",et.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function tt(nt){const rt=et.events[et.events.length-1];return!markdownSpace(nt)&&rt&&rt[1].type==="listItemPrefixWhitespace"?$(nt):_e(nt)}}const setextUnderline={name:"setextUnderline",resolveTo:resolveToSetextUnderline,tokenize:tokenizeSetextUnderline};function resolveToSetextUnderline(j,$){let _e=j.length,et,tt,nt;for(;_e--;)if(j[_e][0]==="enter"){if(j[_e][1].type==="content"){et=_e;break}j[_e][1].type==="paragraph"&&(tt=_e)}else j[_e][1].type==="content"&&j.splice(_e,1),!nt&&j[_e][1].type==="definition"&&(nt=_e);const rt={type:"setextHeading",start:{...j[et][1].start},end:{...j[j.length-1][1].end}};return j[tt][1].type="setextHeadingText",nt?(j.splice(tt,0,["enter",rt,$]),j.splice(nt+1,0,["exit",j[et][1],$]),j[et][1].end={...j[nt][1].end}):j[et][1]=rt,j.push(["exit",rt,$]),j}function tokenizeSetextUnderline(j,$,_e){const et=this;let tt;return nt;function nt(at){let ot=et.events.length,ct;for(;ot--;)if(et.events[ot][1].type!=="lineEnding"&&et.events[ot][1].type!=="linePrefix"&&et.events[ot][1].type!=="content"){ct=et.events[ot][1].type==="paragraph";break}return!et.parser.lazy[et.now().line]&&(et.interrupt||ct)?(j.enter("setextHeadingLine"),tt=at,rt(at)):_e(at)}function rt(at){return j.enter("setextHeadingLineSequence"),it(at)}function it(at){return at===tt?(j.consume(at),it):(j.exit("setextHeadingLineSequence"),markdownSpace(at)?factorySpace(j,st,"lineSuffix")(at):st(at))}function st(at){return at===null||markdownLineEnding(at)?(j.exit("setextHeadingLine"),$(at)):_e(at)}}const flow$1={tokenize:initializeFlow};function initializeFlow(j){const $=this,_e=j.attempt(blankLine,et,j.attempt(this.parser.constructs.flowInitial,tt,factorySpace(j,j.attempt(this.parser.constructs.flow,tt,j.attempt(content,tt)),"linePrefix")));return _e;function et(nt){if(nt===null){j.consume(nt);return}return j.enter("lineEndingBlank"),j.consume(nt),j.exit("lineEndingBlank"),$.currentConstruct=void 0,_e}function tt(nt){if(nt===null){j.consume(nt);return}return j.enter("lineEnding"),j.consume(nt),j.exit("lineEnding"),$.currentConstruct=void 0,_e}}const resolver={resolveAll:createResolver()},string$2=initializeFactory("string"),text$2=initializeFactory("text");function initializeFactory(j){return{resolveAll:createResolver(j==="text"?resolveAllLineSuffixes:void 0),tokenize:$};function $(_e){const et=this,tt=this.parser.constructs[j],nt=_e.attempt(tt,rt,it);return rt;function rt(ot){return at(ot)?nt(ot):it(ot)}function it(ot){if(ot===null){_e.consume(ot);return}return _e.enter("data"),_e.consume(ot),st}function st(ot){return at(ot)?(_e.exit("data"),nt(ot)):(_e.consume(ot),st)}function at(ot){if(ot===null)return!0;const ct=tt[ot];let lt=-1;if(ct)for(;++lt<ct.length;){const ut=ct[lt];if(!ut.previous||ut.previous.call(et,et.previous))return!0}return!1}}}function createResolver(j){return $;function $(_e,et){let tt=-1,nt;for(;++tt<=_e.length;)nt===void 0?_e[tt]&&_e[tt][1].type==="data"&&(nt=tt,tt++):(!_e[tt]||_e[tt][1].type!=="data")&&(tt!==nt+2&&(_e[nt][1].end=_e[tt-1][1].end,_e.splice(nt+2,tt-nt-2),tt=nt+2),nt=void 0);return j?j(_e,et):_e}}function resolveAllLineSuffixes(j,$){let _e=0;for(;++_e<=j.length;)if((_e===j.length||j[_e][1].type==="lineEnding")&&j[_e-1][1].type==="data"){const et=j[_e-1][1],tt=$.sliceStream(et);let nt=tt.length,rt=-1,it=0,st;for(;nt--;){const at=tt[nt];if(typeof at=="string"){for(rt=at.length;at.charCodeAt(rt-1)===32;)it++,rt--;if(rt)break;rt=-1}else if(at===-2)st=!0,it++;else if(at!==-1){nt++;break}}if($._contentTypeTextTrailing&&_e===j.length&&(it=0),it){const at={type:_e===j.length||st||it<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:nt?rt:et.start._bufferIndex+rt,_index:et.start._index+nt,line:et.end.line,column:et.end.column-it,offset:et.end.offset-it},end:{...et.end}};et.end={...at.start},et.start.offset===et.end.offset?Object.assign(et,at):(j.splice(_e,0,["enter",at,$],["exit",at,$]),_e+=2)}_e++}return j}const document$1={42:list$1,43:list$1,45:list$1,48:list$1,49:list$1,50:list$1,51:list$1,52:list$1,53:list$1,54:list$1,55:list$1,56:list$1,57:list$1,62:blockQuote},contentInitial={91:definition},flowInitial={[-2]:codeIndented,[-1]:codeIndented,32:codeIndented},flow={35:headingAtx,42:thematicBreak$1,45:[setextUnderline,thematicBreak$1],60:htmlFlow,61:setextUnderline,95:thematicBreak$1,96:codeFenced,126:codeFenced},string$1={38:characterReference,92:characterEscape},text$1={[-5]:lineEnding,[-4]:lineEnding,[-3]:lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,resolver]},attentionMarkers={null:[42,95]},disable={null:[]},defaultConstructs=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers,contentInitial,disable,document:document$1,flow,flowInitial,insideSpan,string:string$1,text:text$1},Symbol.toStringTag,{value:"Module"}));function createTokenizer(j,$,_e){let et={_bufferIndex:-1,_index:0,line:_e&&_e.line||1,column:_e&&_e.column||1,offset:_e&&_e.offset||0};const tt={},nt=[];let rt=[],it=[];const st={attempt:St(vt),check:St(xt),consume:mt,enter:gt,exit:yt,interrupt:St(xt,{interrupt:!0})},at={code:null,containerState:{},defineSkip:dt,events:[],now:pt,parser:j,previous:null,sliceSerialize:lt,sliceStream:ut,write:ct};let ot=$.tokenize.call(at,st);return $.resolveAll&&nt.push($),at;function ct(Ct){return rt=push(rt,Ct),ht(),rt[rt.length-1]!==null?[]:(Et($,0),at.events=resolveAll(nt,at.events,at),at.events)}function lt(Ct,Rt){return serializeChunks(ut(Ct),Rt)}function ut(Ct){return sliceChunks(rt,Ct)}function pt(){const{_bufferIndex:Ct,_index:Rt,line:jt,column:Ot,offset:$t}=et;return{_bufferIndex:Ct,_index:Rt,line:jt,column:Ot,offset:$t}}function dt(Ct){tt[Ct.line]=Ct.column,Tt()}function ht(){let Ct;for(;et._index<rt.length;){const Rt=rt[et._index];if(typeof Rt=="string")for(Ct=et._index,et._bufferIndex<0&&(et._bufferIndex=0);et._index===Ct&&et._bufferIndex<Rt.length;)ft(Rt.charCodeAt(et._bufferIndex));else ft(Rt)}}function ft(Ct){ot=ot(Ct)}function mt(Ct){markdownLineEnding(Ct)?(et.line++,et.column=1,et.offset+=Ct===-3?2:1,Tt()):Ct!==-1&&(et.column++,et.offset++),et._bufferIndex<0?et._index++:(et._bufferIndex++,et._bufferIndex===rt[et._index].length&&(et._bufferIndex=-1,et._index++)),at.previous=Ct}function gt(Ct,Rt){const jt=Rt||{};return jt.type=Ct,jt.start=pt(),at.events.push(["enter",jt,at]),it.push(jt),jt}function yt(Ct){const Rt=it.pop();return Rt.end=pt(),at.events.push(["exit",Rt,at]),Rt}function vt(Ct,Rt){Et(Ct,Rt.from)}function xt(Ct,Rt){Rt.restore()}function St(Ct,Rt){return jt;function jt(Ot,$t,Kt){let Lt,Nt,Bt,kt;return Array.isArray(Ot)?Gt(Ot):"tokenize"in Ot?Gt([Ot]):rn(Ot);function rn(on){return It;function It(Zt){const Ut=Zt!==null&&on[Zt],Xt=Zt!==null&&on.null,Ht=[...Array.isArray(Ut)?Ut:Ut?[Ut]:[],...Array.isArray(Xt)?Xt:Xt?[Xt]:[]];return Gt(Ht)(Zt)}}function Gt(on){return Lt=on,Nt=0,on.length===0?Kt:_t(on[Nt])}function _t(on){return It;function It(Zt){return kt=wt(),Bt=on,on.partial||(at.currentConstruct=on),on.name&&at.parser.constructs.disable.null.includes(on.name)?tn():on.tokenize.call(Rt?Object.assign(Object.create(at),Rt):at,st,sn,tn)(Zt)}}function sn(on){return Ct(Bt,kt),$t}function tn(on){return kt.restore(),++Nt<Lt.length?_t(Lt[Nt]):Kt}}}function Et(Ct,Rt){Ct.resolveAll&&!nt.includes(Ct)&&nt.push(Ct),Ct.resolve&&splice(at.events,Rt,at.events.length-Rt,Ct.resolve(at.events.slice(Rt),at)),Ct.resolveTo&&(at.events=Ct.resolveTo(at.events,at))}function wt(){const Ct=pt(),Rt=at.previous,jt=at.currentConstruct,Ot=at.events.length,$t=Array.from(it);return{from:Ot,restore:Kt};function Kt(){et=Ct,at.previous=Rt,at.currentConstruct=jt,at.events.length=Ot,it=$t,Tt()}}function Tt(){et.line in tt&&et.column<2&&(et.column=tt[et.line],et.offset+=tt[et.line]-1)}}function sliceChunks(j,$){const _e=$.start._index,et=$.start._bufferIndex,tt=$.end._index,nt=$.end._bufferIndex;let rt;if(_e===tt)rt=[j[_e].slice(et,nt)];else{if(rt=j.slice(_e,tt),et>-1){const it=rt[0];typeof it=="string"?rt[0]=it.slice(et):rt.shift()}nt>0&&rt.push(j[tt].slice(0,nt))}return rt}function serializeChunks(j,$){let _e=-1;const et=[];let tt;for(;++_e<j.length;){const nt=j[_e];let rt;if(typeof nt=="string")rt=nt;else switch(nt){case-5:{rt="\r";break}case-4:{rt=`
`;break}case-3:{rt=`\r
`;break}case-2:{rt=$?" ":"	";break}case-1:{if(!$&&tt)continue;rt=" ";break}default:rt=String.fromCharCode(nt)}tt=nt===-2,et.push(rt)}return et.join("")}function parse(j){const et={constructs:combineExtensions([defaultConstructs,...(j||{}).extensions||[]]),content:tt(content$1),defined:[],document:tt(document$2),flow:tt(flow$1),lazy:{},string:tt(string$2),text:tt(text$2)};return et;function tt(nt){return rt;function rt(it){return createTokenizer(et,nt,it)}}}function postprocess(j){for(;!subtokenize(j););return j}const search=/[\0\t\n\r]/g;function preprocess(){let j=1,$="",_e=!0,et;return tt;function tt(nt,rt,it){const st=[];let at,ot,ct,lt,ut;for(nt=$+(typeof nt=="string"?nt.toString():new TextDecoder(rt||void 0).decode(nt)),ct=0,$="",_e&&(nt.charCodeAt(0)===65279&&ct++,_e=void 0);ct<nt.length;){if(search.lastIndex=ct,at=search.exec(nt),lt=at&&at.index!==void 0?at.index:nt.length,ut=nt.charCodeAt(lt),!at){$=nt.slice(ct);break}if(ut===10&&ct===lt&&et)st.push(-3),et=void 0;else switch(et&&(st.push(-5),et=void 0),ct<lt&&(st.push(nt.slice(ct,lt)),j+=lt-ct),ut){case 0:{st.push(65533),j++;break}case 9:{for(ot=Math.ceil(j/4)*4,st.push(-2);j++<ot;)st.push(-1);break}case 10:{st.push(-4),j=1;break}default:et=!0,j=1}ct=lt+1}return it&&(et&&st.push(-5),$&&st.push($),st.push(null)),st}}const characterEscapeOrReference=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(j){return j.replace(characterEscapeOrReference,decode)}function decode(j,$,_e){if($)return $;if(_e.charCodeAt(0)===35){const tt=_e.charCodeAt(1),nt=tt===120||tt===88;return decodeNumericCharacterReference(_e.slice(nt?2:1),nt?16:10)}return decodeNamedCharacterReference(_e)||j}const own$2={}.hasOwnProperty;function fromMarkdown(j,$,_e){return typeof $!="string"&&(_e=$,$=void 0),compiler(_e)(postprocess(parse(_e).document().write(preprocess()(j,$,!0))))}function compiler(j){const $={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:nt(En),autolinkProtocol:wt,autolinkEmail:wt,atxHeading:nt(qt),blockQuote:nt(Xt),characterEscape:wt,characterReference:wt,codeFenced:nt(Ht),codeFencedFenceInfo:rt,codeFencedFenceMeta:rt,codeIndented:nt(Ht,rt),codeText:nt(Pt,rt),codeTextData:wt,data:wt,codeFlowValue:wt,definition:nt(Mt),definitionDestinationString:rt,definitionLabelString:rt,definitionTitleString:rt,emphasis:nt(Vt),hardBreakEscape:nt(en),hardBreakTrailing:nt(en),htmlFlow:nt(fn,rt),htmlFlowData:wt,htmlText:nt(fn,rt),htmlTextData:wt,image:nt(Cn),label:rt,link:nt(En),listItem:nt(Rn),listItemValue:lt,listOrdered:nt(Pn,ct),listUnordered:nt(Pn),paragraph:nt(Gn),reference:_t,referenceString:rt,resourceDestinationString:rt,resourceTitleString:rt,setextHeading:nt(qt),strong:nt(xn),thematicBreak:nt(Zn)},exit:{atxHeading:st(),atxHeadingSequence:vt,autolink:st(),autolinkEmail:Ut,autolinkProtocol:Zt,blockQuote:st(),characterEscapeValue:Tt,characterReferenceMarkerHexadecimal:tn,characterReferenceMarkerNumeric:tn,characterReferenceValue:on,characterReference:It,codeFenced:st(ht),codeFencedFence:dt,codeFencedFenceInfo:ut,codeFencedFenceMeta:pt,codeFlowValue:Tt,codeIndented:st(ft),codeText:st($t),codeTextData:Tt,data:Tt,definition:st(),definitionDestinationString:yt,definitionLabelString:mt,definitionTitleString:gt,emphasis:st(),hardBreakEscape:st(Rt),hardBreakTrailing:st(Rt),htmlFlow:st(jt),htmlFlowData:Tt,htmlText:st(Ot),htmlTextData:Tt,image:st(Lt),label:Bt,labelText:Nt,lineEnding:Ct,link:st(Kt),listItem:st(),listOrdered:st(),listUnordered:st(),paragraph:st(),referenceString:sn,resourceDestinationString:kt,resourceTitleString:rn,resource:Gt,setextHeading:st(Et),setextHeadingLineSequence:St,setextHeadingText:xt,strong:st(),thematicBreak:st()}};configure($,(j||{}).mdastExtensions||[]);const _e={};return et;function et(Ft){let At={type:"root",children:[]};const Jt={stack:[At],tokenStack:[],config:$,enter:it,exit:at,buffer:rt,resume:ot,data:_e},vn=[];let bn=-1;for(;++bn<Ft.length;)if(Ft[bn][1].type==="listOrdered"||Ft[bn][1].type==="listUnordered")if(Ft[bn][0]==="enter")vn.push(bn);else{const $n=vn.pop();bn=tt(Ft,$n,bn)}for(bn=-1;++bn<Ft.length;){const $n=$[Ft[bn][0]];own$2.call($n,Ft[bn][1].type)&&$n[Ft[bn][1].type].call(Object.assign({sliceSerialize:Ft[bn][2].sliceSerialize},Jt),Ft[bn][1])}if(Jt.tokenStack.length>0){const $n=Jt.tokenStack[Jt.tokenStack.length-1];($n[1]||defaultOnError).call(Jt,void 0,$n[0])}for(At.position={start:point$3(Ft.length>0?Ft[0][1].start:{line:1,column:1,offset:0}),end:point$3(Ft.length>0?Ft[Ft.length-2][1].end:{line:1,column:1,offset:0})},bn=-1;++bn<$.transforms.length;)At=$.transforms[bn](At)||At;return At}function tt(Ft,At,Jt){let vn=At-1,bn=-1,$n=!1,Yn,er,gr,Dr;for(;++vn<=Jt;){const Xn=Ft[vn];switch(Xn[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Xn[0]==="enter"?bn++:bn--,Dr=void 0;break}case"lineEndingBlank":{Xn[0]==="enter"&&(Yn&&!Dr&&!bn&&!gr&&(gr=vn),Dr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Dr=void 0}if(!bn&&Xn[0]==="enter"&&Xn[1].type==="listItemPrefix"||bn===-1&&Xn[0]==="exit"&&(Xn[1].type==="listUnordered"||Xn[1].type==="listOrdered")){if(Yn){let br=vn;for(er=void 0;br--;){const hr=Ft[br];if(hr[1].type==="lineEnding"||hr[1].type==="lineEndingBlank"){if(hr[0]==="exit")continue;er&&(Ft[er][1].type="lineEndingBlank",$n=!0),hr[1].type="lineEnding",er=br}else if(!(hr[1].type==="linePrefix"||hr[1].type==="blockQuotePrefix"||hr[1].type==="blockQuotePrefixWhitespace"||hr[1].type==="blockQuoteMarker"||hr[1].type==="listItemIndent"))break}gr&&(!er||gr<er)&&(Yn._spread=!0),Yn.end=Object.assign({},er?Ft[er][1].start:Xn[1].end),Ft.splice(er||vn,0,["exit",Yn,Xn[2]]),vn++,Jt++}if(Xn[1].type==="listItemPrefix"){const br={type:"listItem",_spread:!1,start:Object.assign({},Xn[1].start),end:void 0};Yn=br,Ft.splice(vn,0,["enter",br,Xn[2]]),vn++,Jt++,gr=void 0,Dr=!0}}}return Ft[At][1]._spread=$n,Jt}function nt(Ft,At){return Jt;function Jt(vn){it.call(this,Ft(vn),vn),At&&At.call(this,vn)}}function rt(){this.stack.push({type:"fragment",children:[]})}function it(Ft,At,Jt){this.stack[this.stack.length-1].children.push(Ft),this.stack.push(Ft),this.tokenStack.push([At,Jt||void 0]),Ft.position={start:point$3(At.start),end:void 0}}function st(Ft){return At;function At(Jt){Ft&&Ft.call(this,Jt),at.call(this,Jt)}}function at(Ft,At){const Jt=this.stack.pop(),vn=this.tokenStack.pop();if(vn)vn[0].type!==Ft.type&&(At?At.call(this,Ft,vn[0]):(vn[1]||defaultOnError).call(this,Ft,vn[0]));else throw new Error("Cannot close `"+Ft.type+"` ("+stringifyPosition({start:Ft.start,end:Ft.end})+"): its not open");Jt.position.end=point$3(Ft.end)}function ot(){return toString$3(this.stack.pop())}function ct(){this.data.expectingFirstListItemValue=!0}function lt(Ft){if(this.data.expectingFirstListItemValue){const At=this.stack[this.stack.length-2];At.start=Number.parseInt(this.sliceSerialize(Ft),10),this.data.expectingFirstListItemValue=void 0}}function ut(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.lang=Ft}function pt(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.meta=Ft}function dt(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function ht(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.value=Ft.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function ft(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.value=Ft.replace(/(\r?\n|\r)$/g,"")}function mt(Ft){const At=this.resume(),Jt=this.stack[this.stack.length-1];Jt.label=At,Jt.identifier=normalizeIdentifier(this.sliceSerialize(Ft)).toLowerCase()}function gt(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.title=Ft}function yt(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.url=Ft}function vt(Ft){const At=this.stack[this.stack.length-1];if(!At.depth){const Jt=this.sliceSerialize(Ft).length;At.depth=Jt}}function xt(){this.data.setextHeadingSlurpLineEnding=!0}function St(Ft){const At=this.stack[this.stack.length-1];At.depth=this.sliceSerialize(Ft).codePointAt(0)===61?1:2}function Et(){this.data.setextHeadingSlurpLineEnding=void 0}function wt(Ft){const Jt=this.stack[this.stack.length-1].children;let vn=Jt[Jt.length-1];(!vn||vn.type!=="text")&&(vn=_n(),vn.position={start:point$3(Ft.start),end:void 0},Jt.push(vn)),this.stack.push(vn)}function Tt(Ft){const At=this.stack.pop();At.value+=this.sliceSerialize(Ft),At.position.end=point$3(Ft.end)}function Ct(Ft){const At=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Jt=At.children[At.children.length-1];Jt.position.end=point$3(Ft.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&$.canContainEols.includes(At.type)&&(wt.call(this,Ft),Tt.call(this,Ft))}function Rt(){this.data.atHardBreak=!0}function jt(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.value=Ft}function Ot(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.value=Ft}function $t(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.value=Ft}function Kt(){const Ft=this.stack[this.stack.length-1];if(this.data.inReference){const At=this.data.referenceType||"shortcut";Ft.type+="Reference",Ft.referenceType=At,delete Ft.url,delete Ft.title}else delete Ft.identifier,delete Ft.label;this.data.referenceType=void 0}function Lt(){const Ft=this.stack[this.stack.length-1];if(this.data.inReference){const At=this.data.referenceType||"shortcut";Ft.type+="Reference",Ft.referenceType=At,delete Ft.url,delete Ft.title}else delete Ft.identifier,delete Ft.label;this.data.referenceType=void 0}function Nt(Ft){const At=this.sliceSerialize(Ft),Jt=this.stack[this.stack.length-2];Jt.label=decodeString(At),Jt.identifier=normalizeIdentifier(At).toLowerCase()}function Bt(){const Ft=this.stack[this.stack.length-1],At=this.resume(),Jt=this.stack[this.stack.length-1];if(this.data.inReference=!0,Jt.type==="link"){const vn=Ft.children;Jt.children=vn}else Jt.alt=At}function kt(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.url=Ft}function rn(){const Ft=this.resume(),At=this.stack[this.stack.length-1];At.title=Ft}function Gt(){this.data.inReference=void 0}function _t(){this.data.referenceType="collapsed"}function sn(Ft){const At=this.resume(),Jt=this.stack[this.stack.length-1];Jt.label=At,Jt.identifier=normalizeIdentifier(this.sliceSerialize(Ft)).toLowerCase(),this.data.referenceType="full"}function tn(Ft){this.data.characterReferenceType=Ft.type}function on(Ft){const At=this.sliceSerialize(Ft),Jt=this.data.characterReferenceType;let vn;Jt?(vn=decodeNumericCharacterReference(At,Jt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):vn=decodeNamedCharacterReference(At);const bn=this.stack[this.stack.length-1];bn.value+=vn}function It(Ft){const At=this.stack.pop();At.position.end=point$3(Ft.end)}function Zt(Ft){Tt.call(this,Ft);const At=this.stack[this.stack.length-1];At.url=this.sliceSerialize(Ft)}function Ut(Ft){Tt.call(this,Ft);const At=this.stack[this.stack.length-1];At.url="mailto:"+this.sliceSerialize(Ft)}function Xt(){return{type:"blockquote",children:[]}}function Ht(){return{type:"code",lang:null,meta:null,value:""}}function Pt(){return{type:"inlineCode",value:""}}function Mt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Vt(){return{type:"emphasis",children:[]}}function qt(){return{type:"heading",depth:0,children:[]}}function en(){return{type:"break"}}function fn(){return{type:"html",value:""}}function Cn(){return{type:"image",title:null,url:"",alt:null}}function En(){return{type:"link",title:null,url:"",children:[]}}function Pn(Ft){return{type:"list",ordered:Ft.type==="listOrdered",start:null,spread:Ft._spread,children:[]}}function Rn(Ft){return{type:"listItem",spread:Ft._spread,checked:null,children:[]}}function Gn(){return{type:"paragraph",children:[]}}function xn(){return{type:"strong",children:[]}}function _n(){return{type:"text",value:""}}function Zn(){return{type:"thematicBreak"}}}function point$3(j){return{line:j.line,column:j.column,offset:j.offset}}function configure(j,$){let _e=-1;for(;++_e<$.length;){const et=$[_e];Array.isArray(et)?configure(j,et):extension(j,et)}}function extension(j,$){let _e;for(_e in $)if(own$2.call($,_e))switch(_e){case"canContainEols":{const et=$[_e];et&&j[_e].push(...et);break}case"transforms":{const et=$[_e];et&&j[_e].push(...et);break}case"enter":case"exit":{const et=$[_e];et&&Object.assign(j[_e],et);break}}}function defaultOnError(j,$){throw j?new Error("Cannot close `"+j.type+"` ("+stringifyPosition({start:j.start,end:j.end})+"): a different token (`"+$.type+"`, "+stringifyPosition({start:$.start,end:$.end})+") is open"):new Error("Cannot close document, a token (`"+$.type+"`, "+stringifyPosition({start:$.start,end:$.end})+") is still open")}function remarkParse(j){const $=this;$.parser=_e;function _e(et){return fromMarkdown(et,{...$.data("settings"),...j,extensions:$.data("micromarkExtensions")||[],mdastExtensions:$.data("fromMarkdownExtensions")||[]})}}function blockquote(j,$){const _e={type:"element",tagName:"blockquote",properties:{},children:j.wrap(j.all($),!0)};return j.patch($,_e),j.applyData($,_e)}function hardBreak(j,$){const _e={type:"element",tagName:"br",properties:{},children:[]};return j.patch($,_e),[j.applyData($,_e),{type:"text",value:`
`}]}function code(j,$){const _e=$.value?$.value+`
`:"",et={},tt=$.lang?$.lang.split(/\s+/):[];tt.length>0&&(et.className=["language-"+tt[0]]);let nt={type:"element",tagName:"code",properties:et,children:[{type:"text",value:_e}]};return $.meta&&(nt.data={meta:$.meta}),j.patch($,nt),nt=j.applyData($,nt),nt={type:"element",tagName:"pre",properties:{},children:[nt]},j.patch($,nt),nt}function strikethrough(j,$){const _e={type:"element",tagName:"del",properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}function emphasis(j,$){const _e={type:"element",tagName:"em",properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}function footnoteReference(j,$){const _e=typeof j.options.clobberPrefix=="string"?j.options.clobberPrefix:"user-content-",et=String($.identifier).toUpperCase(),tt=normalizeUri(et.toLowerCase()),nt=j.footnoteOrder.indexOf(et);let rt,it=j.footnoteCounts.get(et);it===void 0?(it=0,j.footnoteOrder.push(et),rt=j.footnoteOrder.length):rt=nt+1,it+=1,j.footnoteCounts.set(et,it);const st={type:"element",tagName:"a",properties:{href:"#"+_e+"fn-"+tt,id:_e+"fnref-"+tt+(it>1?"-"+it:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(rt)}]};j.patch($,st);const at={type:"element",tagName:"sup",properties:{},children:[st]};return j.patch($,at),j.applyData($,at)}function heading(j,$){const _e={type:"element",tagName:"h"+$.depth,properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}function html(j,$){if(j.options.allowDangerousHtml){const _e={type:"raw",value:$.value};return j.patch($,_e),j.applyData($,_e)}}function revert(j,$){const _e=$.referenceType;let et="]";if(_e==="collapsed"?et+="[]":_e==="full"&&(et+="["+($.label||$.identifier)+"]"),$.type==="imageReference")return[{type:"text",value:"!["+$.alt+et}];const tt=j.all($),nt=tt[0];nt&&nt.type==="text"?nt.value="["+nt.value:tt.unshift({type:"text",value:"["});const rt=tt[tt.length-1];return rt&&rt.type==="text"?rt.value+=et:tt.push({type:"text",value:et}),tt}function imageReference(j,$){const _e=String($.identifier).toUpperCase(),et=j.definitionById.get(_e);if(!et)return revert(j,$);const tt={src:normalizeUri(et.url||""),alt:$.alt};et.title!==null&&et.title!==void 0&&(tt.title=et.title);const nt={type:"element",tagName:"img",properties:tt,children:[]};return j.patch($,nt),j.applyData($,nt)}function image(j,$){const _e={src:normalizeUri($.url)};$.alt!==null&&$.alt!==void 0&&(_e.alt=$.alt),$.title!==null&&$.title!==void 0&&(_e.title=$.title);const et={type:"element",tagName:"img",properties:_e,children:[]};return j.patch($,et),j.applyData($,et)}function inlineCode(j,$){const _e={type:"text",value:$.value.replace(/\r?\n|\r/g," ")};j.patch($,_e);const et={type:"element",tagName:"code",properties:{},children:[_e]};return j.patch($,et),j.applyData($,et)}function linkReference(j,$){const _e=String($.identifier).toUpperCase(),et=j.definitionById.get(_e);if(!et)return revert(j,$);const tt={href:normalizeUri(et.url||"")};et.title!==null&&et.title!==void 0&&(tt.title=et.title);const nt={type:"element",tagName:"a",properties:tt,children:j.all($)};return j.patch($,nt),j.applyData($,nt)}function link(j,$){const _e={href:normalizeUri($.url)};$.title!==null&&$.title!==void 0&&(_e.title=$.title);const et={type:"element",tagName:"a",properties:_e,children:j.all($)};return j.patch($,et),j.applyData($,et)}function listItem(j,$,_e){const et=j.all($),tt=_e?listLoose(_e):listItemLoose($),nt={},rt=[];if(typeof $.checked=="boolean"){const ot=et[0];let ct;ot&&ot.type==="element"&&ot.tagName==="p"?ct=ot:(ct={type:"element",tagName:"p",properties:{},children:[]},et.unshift(ct)),ct.children.length>0&&ct.children.unshift({type:"text",value:" "}),ct.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:$.checked,disabled:!0},children:[]}),nt.className=["task-list-item"]}let it=-1;for(;++it<et.length;){const ot=et[it];(tt||it!==0||ot.type!=="element"||ot.tagName!=="p")&&rt.push({type:"text",value:`
`}),ot.type==="element"&&ot.tagName==="p"&&!tt?rt.push(...ot.children):rt.push(ot)}const st=et[et.length-1];st&&(tt||st.type!=="element"||st.tagName!=="p")&&rt.push({type:"text",value:`
`});const at={type:"element",tagName:"li",properties:nt,children:rt};return j.patch($,at),j.applyData($,at)}function listLoose(j){let $=!1;if(j.type==="list"){$=j.spread||!1;const _e=j.children;let et=-1;for(;!$&&++et<_e.length;)$=listItemLoose(_e[et])}return $}function listItemLoose(j){const $=j.spread;return $??j.children.length>1}function list(j,$){const _e={},et=j.all($);let tt=-1;for(typeof $.start=="number"&&$.start!==1&&(_e.start=$.start);++tt<et.length;){const rt=et[tt];if(rt.type==="element"&&rt.tagName==="li"&&rt.properties&&Array.isArray(rt.properties.className)&&rt.properties.className.includes("task-list-item")){_e.className=["contains-task-list"];break}}const nt={type:"element",tagName:$.ordered?"ol":"ul",properties:_e,children:j.wrap(et,!0)};return j.patch($,nt),j.applyData($,nt)}function paragraph(j,$){const _e={type:"element",tagName:"p",properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}function root(j,$){const _e={type:"root",children:j.wrap(j.all($))};return j.patch($,_e),j.applyData($,_e)}function strong(j,$){const _e={type:"element",tagName:"strong",properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}function table(j,$){const _e=j.all($),et=_e.shift(),tt=[];if(et){const rt={type:"element",tagName:"thead",properties:{},children:j.wrap([et],!0)};j.patch($.children[0],rt),tt.push(rt)}if(_e.length>0){const rt={type:"element",tagName:"tbody",properties:{},children:j.wrap(_e,!0)},it=pointStart($.children[1]),st=pointEnd($.children[$.children.length-1]);it&&st&&(rt.position={start:it,end:st}),tt.push(rt)}const nt={type:"element",tagName:"table",properties:{},children:j.wrap(tt,!0)};return j.patch($,nt),j.applyData($,nt)}function tableRow(j,$,_e){const et=_e?_e.children:void 0,nt=(et?et.indexOf($):1)===0?"th":"td",rt=_e&&_e.type==="table"?_e.align:void 0,it=rt?rt.length:$.children.length;let st=-1;const at=[];for(;++st<it;){const ct=$.children[st],lt={},ut=rt?rt[st]:void 0;ut&&(lt.align=ut);let pt={type:"element",tagName:nt,properties:lt,children:[]};ct&&(pt.children=j.all(ct),j.patch(ct,pt),pt=j.applyData(ct,pt)),at.push(pt)}const ot={type:"element",tagName:"tr",properties:{},children:j.wrap(at,!0)};return j.patch($,ot),j.applyData($,ot)}function tableCell(j,$){const _e={type:"element",tagName:"td",properties:{},children:j.all($)};return j.patch($,_e),j.applyData($,_e)}const tab=9,space=32;function trimLines(j){const $=String(j),_e=/\r?\n|\r/g;let et=_e.exec($),tt=0;const nt=[];for(;et;)nt.push(trimLine($.slice(tt,et.index),tt>0,!0),et[0]),tt=et.index+et[0].length,et=_e.exec($);return nt.push(trimLine($.slice(tt),tt>0,!1)),nt.join("")}function trimLine(j,$,_e){let et=0,tt=j.length;if($){let nt=j.codePointAt(et);for(;nt===tab||nt===space;)et++,nt=j.codePointAt(et)}if(_e){let nt=j.codePointAt(tt-1);for(;nt===tab||nt===space;)tt--,nt=j.codePointAt(tt-1)}return tt>et?j.slice(et,tt):""}function text(j,$){const _e={type:"text",value:trimLines(String($.value))};return j.patch($,_e),j.applyData($,_e)}function thematicBreak(j,$){const _e={type:"element",tagName:"hr",properties:{},children:[]};return j.patch($,_e),j.applyData($,_e)}const handlers={blockquote,break:hardBreak,code,delete:strikethrough,emphasis,footnoteReference,heading,html,imageReference,image,inlineCode,linkReference,link,listItem,list,paragraph,root,strong,table,tableCell,tableRow,text,thematicBreak,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){}const VOID=-1,PRIMITIVE=0,ARRAY=1,OBJECT=2,DATE=3,REGEXP=4,MAP=5,SET=6,ERROR=7,BIGINT=8,env=typeof self=="object"?self:globalThis,deserializer=(j,$)=>{const _e=(tt,nt)=>(j.set(nt,tt),tt),et=tt=>{if(j.has(tt))return j.get(tt);const[nt,rt]=$[tt];switch(nt){case PRIMITIVE:case VOID:return _e(rt,tt);case ARRAY:{const it=_e([],tt);for(const st of rt)it.push(et(st));return it}case OBJECT:{const it=_e({},tt);for(const[st,at]of rt)it[et(st)]=et(at);return it}case DATE:return _e(new Date(rt),tt);case REGEXP:{const{source:it,flags:st}=rt;return _e(new RegExp(it,st),tt)}case MAP:{const it=_e(new Map,tt);for(const[st,at]of rt)it.set(et(st),et(at));return it}case SET:{const it=_e(new Set,tt);for(const st of rt)it.add(et(st));return it}case ERROR:{const{name:it,message:st}=rt;return _e(new env[it](st),tt)}case BIGINT:return _e(BigInt(rt),tt);case"BigInt":return _e(Object(BigInt(rt)),tt);case"ArrayBuffer":return _e(new Uint8Array(rt).buffer,rt);case"DataView":{const{buffer:it}=new Uint8Array(rt);return _e(new DataView(it),rt)}}return _e(new env[nt](rt),tt)};return et},deserialize=j=>deserializer(new Map,j)(0),EMPTY="",{toString:toString$2}={},{keys}=Object,typeOf$1=j=>{const $=typeof j;if($!=="object"||!j)return[PRIMITIVE,$];const _e=toString$2.call(j).slice(8,-1);switch(_e){case"Array":return[ARRAY,EMPTY];case"Object":return[OBJECT,EMPTY];case"Date":return[DATE,EMPTY];case"RegExp":return[REGEXP,EMPTY];case"Map":return[MAP,EMPTY];case"Set":return[SET,EMPTY];case"DataView":return[ARRAY,_e]}return _e.includes("Array")?[ARRAY,_e]:_e.includes("Error")?[ERROR,_e]:[OBJECT,_e]},shouldSkip=([j,$])=>j===PRIMITIVE&&($==="function"||$==="symbol"),serializer=(j,$,_e,et)=>{const tt=(rt,it)=>{const st=et.push(rt)-1;return _e.set(it,st),st},nt=rt=>{if(_e.has(rt))return _e.get(rt);let[it,st]=typeOf$1(rt);switch(it){case PRIMITIVE:{let ot=rt;switch(st){case"bigint":it=BIGINT,ot=rt.toString();break;case"function":case"symbol":if(j)throw new TypeError("unable to serialize "+st);ot=null;break;case"undefined":return tt([VOID],rt)}return tt([it,ot],rt)}case ARRAY:{if(st){let lt=rt;return st==="DataView"?lt=new Uint8Array(rt.buffer):st==="ArrayBuffer"&&(lt=new Uint8Array(rt)),tt([st,[...lt]],rt)}const ot=[],ct=tt([it,ot],rt);for(const lt of rt)ot.push(nt(lt));return ct}case OBJECT:{if(st)switch(st){case"BigInt":return tt([st,rt.toString()],rt);case"Boolean":case"Number":case"String":return tt([st,rt.valueOf()],rt)}if($&&"toJSON"in rt)return nt(rt.toJSON());const ot=[],ct=tt([it,ot],rt);for(const lt of keys(rt))(j||!shouldSkip(typeOf$1(rt[lt])))&&ot.push([nt(lt),nt(rt[lt])]);return ct}case DATE:return tt([it,rt.toISOString()],rt);case REGEXP:{const{source:ot,flags:ct}=rt;return tt([it,{source:ot,flags:ct}],rt)}case MAP:{const ot=[],ct=tt([it,ot],rt);for(const[lt,ut]of rt)(j||!(shouldSkip(typeOf$1(lt))||shouldSkip(typeOf$1(ut))))&&ot.push([nt(lt),nt(ut)]);return ct}case SET:{const ot=[],ct=tt([it,ot],rt);for(const lt of rt)(j||!shouldSkip(typeOf$1(lt)))&&ot.push(nt(lt));return ct}}const{message:at}=rt;return tt([it,{name:st,message:at}],rt)};return nt},serialize=(j,{json:$,lossy:_e}={})=>{const et=[];return serializer(!($||_e),!!$,new Map,et)(j),et},structuredClone$1=typeof structuredClone=="function"?(j,$)=>$&&("json"in $||"lossy"in $)?deserialize(serialize(j,$)):structuredClone(j):(j,$)=>deserialize(serialize(j,$));function defaultFootnoteBackContent(j,$){const _e=[{type:"text",value:""}];return $>1&&_e.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String($)}]}),_e}function defaultFootnoteBackLabel(j,$){return"Back to reference "+(j+1)+($>1?"-"+$:"")}function footer(j){const $=typeof j.options.clobberPrefix=="string"?j.options.clobberPrefix:"user-content-",_e=j.options.footnoteBackContent||defaultFootnoteBackContent,et=j.options.footnoteBackLabel||defaultFootnoteBackLabel,tt=j.options.footnoteLabel||"Footnotes",nt=j.options.footnoteLabelTagName||"h2",rt=j.options.footnoteLabelProperties||{className:["sr-only"]},it=[];let st=-1;for(;++st<j.footnoteOrder.length;){const at=j.footnoteById.get(j.footnoteOrder[st]);if(!at)continue;const ot=j.all(at),ct=String(at.identifier).toUpperCase(),lt=normalizeUri(ct.toLowerCase());let ut=0;const pt=[],dt=j.footnoteCounts.get(ct);for(;dt!==void 0&&++ut<=dt;){pt.length>0&&pt.push({type:"text",value:" "});let mt=typeof _e=="string"?_e:_e(st,ut);typeof mt=="string"&&(mt={type:"text",value:mt}),pt.push({type:"element",tagName:"a",properties:{href:"#"+$+"fnref-"+lt+(ut>1?"-"+ut:""),dataFootnoteBackref:"",ariaLabel:typeof et=="string"?et:et(st,ut),className:["data-footnote-backref"]},children:Array.isArray(mt)?mt:[mt]})}const ht=ot[ot.length-1];if(ht&&ht.type==="element"&&ht.tagName==="p"){const mt=ht.children[ht.children.length-1];mt&&mt.type==="text"?mt.value+=" ":ht.children.push({type:"text",value:" "}),ht.children.push(...pt)}else ot.push(...pt);const ft={type:"element",tagName:"li",properties:{id:$+"fn-"+lt},children:j.wrap(ot,!0)};j.patch(at,ft),it.push(ft)}if(it.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:nt,properties:{...structuredClone$1(rt),id:"footnote-label"},children:[{type:"text",value:tt}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:j.wrap(it,!0)},{type:"text",value:`
`}]}}const convert=function(j){if(j==null)return ok;if(typeof j=="function")return castFactory(j);if(typeof j=="object")return Array.isArray(j)?anyFactory(j):propertiesFactory(j);if(typeof j=="string")return typeFactory(j);throw new Error("Expected function, string, or object as test")};function anyFactory(j){const $=[];let _e=-1;for(;++_e<j.length;)$[_e]=convert(j[_e]);return castFactory(et);function et(...tt){let nt=-1;for(;++nt<$.length;)if($[nt].apply(this,tt))return!0;return!1}}function propertiesFactory(j){const $=j;return castFactory(_e);function _e(et){const tt=et;let nt;for(nt in j)if(tt[nt]!==$[nt])return!1;return!0}}function typeFactory(j){return castFactory($);function $(_e){return _e&&_e.type===j}}function castFactory(j){return $;function $(_e,et,tt){return!!(looksLikeANode(_e)&&j.call(this,_e,typeof et=="number"?et:void 0,tt||void 0))}}function ok(){return!0}function looksLikeANode(j){return j!==null&&typeof j=="object"&&"type"in j}function color$1(j){return j}const empty=[],CONTINUE=!0,EXIT=!1,SKIP="skip";function visitParents(j,$,_e,et){let tt;typeof $=="function"&&typeof _e!="function"?(et=_e,_e=$):tt=$;const nt=convert(tt),rt=et?-1:1;it(j,void 0,[])();function it(st,at,ot){const ct=st&&typeof st=="object"?st:{};if(typeof ct.type=="string"){const ut=typeof ct.tagName=="string"?ct.tagName:typeof ct.name=="string"?ct.name:void 0;Object.defineProperty(lt,"name",{value:"node ("+(st.type+(ut?"<"+ut+">":""))+")"})}return lt;function lt(){let ut=empty,pt,dt,ht;if((!$||nt(st,at,ot[ot.length-1]||void 0))&&(ut=toResult(_e(st,ot)),ut[0]===EXIT))return ut;if("children"in st&&st.children){const ft=st;if(ft.children&&ut[0]!==SKIP)for(dt=(et?ft.children.length:-1)+rt,ht=ot.concat(ft);dt>-1&&dt<ft.children.length;){const mt=ft.children[dt];if(pt=it(mt,dt,ht)(),pt[0]===EXIT)return pt;dt=typeof pt[1]=="number"?pt[1]:dt+rt}}return ut}}}function toResult(j){return Array.isArray(j)?j:typeof j=="number"?[CONTINUE,j]:j==null?empty:[j]}function visit(j,$,_e,et){let tt,nt,rt;typeof $=="function"&&typeof _e!="function"?(nt=void 0,rt=$,tt=_e):(nt=$,rt=_e,tt=et),visitParents(j,nt,it,tt);function it(st,at){const ot=at[at.length-1],ct=ot?ot.children.indexOf(st):void 0;return rt(st,ct,ot)}}const own$1={}.hasOwnProperty,emptyOptions={};function createState(j,$){const _e=$||emptyOptions,et=new Map,tt=new Map,nt=new Map,rt={...handlers,..._e.handlers},it={all:at,applyData,definitionById:et,footnoteById:tt,footnoteCounts:nt,footnoteOrder:[],handlers:rt,one:st,options:_e,patch,wrap:wrap$1};return visit(j,function(ot){if(ot.type==="definition"||ot.type==="footnoteDefinition"){const ct=ot.type==="definition"?et:tt,lt=String(ot.identifier).toUpperCase();ct.has(lt)||ct.set(lt,ot)}}),it;function st(ot,ct){const lt=ot.type,ut=it.handlers[lt];if(own$1.call(it.handlers,lt)&&ut)return ut(it,ot,ct);if(it.options.passThrough&&it.options.passThrough.includes(lt)){if("children"in ot){const{children:dt,...ht}=ot,ft=structuredClone$1(ht);return ft.children=it.all(ot),ft}return structuredClone$1(ot)}return(it.options.unknownHandler||defaultUnknownHandler)(it,ot,ct)}function at(ot){const ct=[];if("children"in ot){const lt=ot.children;let ut=-1;for(;++ut<lt.length;){const pt=it.one(lt[ut],ot);if(pt){if(ut&&lt[ut-1].type==="break"&&(!Array.isArray(pt)&&pt.type==="text"&&(pt.value=trimMarkdownSpaceStart(pt.value)),!Array.isArray(pt)&&pt.type==="element")){const dt=pt.children[0];dt&&dt.type==="text"&&(dt.value=trimMarkdownSpaceStart(dt.value))}Array.isArray(pt)?ct.push(...pt):ct.push(pt)}}}return ct}}function patch(j,$){j.position&&($.position=position$1(j))}function applyData(j,$){let _e=$;if(j&&j.data){const et=j.data.hName,tt=j.data.hChildren,nt=j.data.hProperties;if(typeof et=="string")if(_e.type==="element")_e.tagName=et;else{const rt="children"in _e?_e.children:[_e];_e={type:"element",tagName:et,properties:{},children:rt}}_e.type==="element"&&nt&&Object.assign(_e.properties,structuredClone$1(nt)),"children"in _e&&_e.children&&tt!==null&&tt!==void 0&&(_e.children=tt)}return _e}function defaultUnknownHandler(j,$){const _e=$.data||{},et="value"in $&&!(own$1.call(_e,"hProperties")||own$1.call(_e,"hChildren"))?{type:"text",value:$.value}:{type:"element",tagName:"div",properties:{},children:j.all($)};return j.patch($,et),j.applyData($,et)}function wrap$1(j,$){const _e=[];let et=-1;for($&&_e.push({type:"text",value:`
`});++et<j.length;)et&&_e.push({type:"text",value:`
`}),_e.push(j[et]);return $&&j.length>0&&_e.push({type:"text",value:`
`}),_e}function trimMarkdownSpaceStart(j){let $=0,_e=j.charCodeAt($);for(;_e===9||_e===32;)$++,_e=j.charCodeAt($);return j.slice($)}function toHast(j,$){const _e=createState(j,$),et=_e.one(j,void 0),tt=footer(_e),nt=Array.isArray(et)?{type:"root",children:et}:et||{type:"root",children:[]};return tt&&nt.children.push({type:"text",value:`
`},tt),nt}function remarkRehype(j,$){return j&&"run"in j?async function(_e,et){const tt=toHast(_e,{file:et,...$});await j.run(tt,et)}:function(_e,et){return toHast(_e,{file:et,...j||$})}}function bail(j){if(j)throw j}var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray$1=function j($){return typeof Array.isArray=="function"?Array.isArray($):toStr.call($)==="[object Array]"},isPlainObject$7=function j($){if(!$||toStr.call($)!=="[object Object]")return!1;var _e=hasOwn.call($,"constructor"),et=$.constructor&&$.constructor.prototype&&hasOwn.call($.constructor.prototype,"isPrototypeOf");if($.constructor&&!_e&&!et)return!1;var tt;for(tt in $);return typeof tt>"u"||hasOwn.call($,tt)},setProperty=function j($,_e){defineProperty&&_e.name==="__proto__"?defineProperty($,_e.name,{enumerable:!0,configurable:!0,value:_e.newValue,writable:!0}):$[_e.name]=_e.newValue},getProperty=function j($,_e){if(_e==="__proto__")if(hasOwn.call($,_e)){if(gOPD)return gOPD($,_e).value}else return;return $[_e]},extend$1=function j(){var $,_e,et,tt,nt,rt,it=arguments[0],st=1,at=arguments.length,ot=!1;for(typeof it=="boolean"&&(ot=it,it=arguments[1]||{},st=2),(it==null||typeof it!="object"&&typeof it!="function")&&(it={});st<at;++st)if($=arguments[st],$!=null)for(_e in $)et=getProperty(it,_e),tt=getProperty($,_e),it!==tt&&(ot&&tt&&(isPlainObject$7(tt)||(nt=isArray$1(tt)))?(nt?(nt=!1,rt=et&&isArray$1(et)?et:[]):rt=et&&isPlainObject$7(et)?et:{},setProperty(it,{name:_e,newValue:j(ot,rt,tt)})):typeof tt<"u"&&setProperty(it,{name:_e,newValue:tt}));return it};const extend$2=getDefaultExportFromCjs$1(extend$1);function isPlainObject$6(j){if(typeof j!="object"||j===null)return!1;const $=Object.getPrototypeOf(j);return($===null||$===Object.prototype||Object.getPrototypeOf($)===null)&&!(Symbol.toStringTag in j)&&!(Symbol.iterator in j)}function trough(){const j=[],$={run:_e,use:et};return $;function _e(...tt){let nt=-1;const rt=tt.pop();if(typeof rt!="function")throw new TypeError("Expected function as last argument, not "+rt);it(null,...tt);function it(st,...at){const ot=j[++nt];let ct=-1;if(st){rt(st);return}for(;++ct<tt.length;)(at[ct]===null||at[ct]===void 0)&&(at[ct]=tt[ct]);tt=at,ot?wrap(ot,it)(...at):rt(null,...at)}}function et(tt){if(typeof tt!="function")throw new TypeError("Expected `middelware` to be a function, not "+tt);return j.push(tt),$}}function wrap(j,$){let _e;return et;function et(...rt){const it=j.length>rt.length;let st;it&&rt.push(tt);try{st=j.apply(this,rt)}catch(at){const ot=at;if(it&&_e)throw ot;return tt(ot)}it||(st&&st.then&&typeof st.then=="function"?st.then(nt,tt):st instanceof Error?tt(st):nt(st))}function tt(rt,...it){_e||(_e=!0,$(rt,...it))}function nt(rt){tt(null,rt)}}const minpath={basename,dirname,extname,join,sep:"/"};function basename(j,$){if($!==void 0&&typeof $!="string")throw new TypeError('"ext" argument must be a string');assertPath$1(j);let _e=0,et=-1,tt=j.length,nt;if($===void 0||$.length===0||$.length>j.length){for(;tt--;)if(j.codePointAt(tt)===47){if(nt){_e=tt+1;break}}else et<0&&(nt=!0,et=tt+1);return et<0?"":j.slice(_e,et)}if($===j)return"";let rt=-1,it=$.length-1;for(;tt--;)if(j.codePointAt(tt)===47){if(nt){_e=tt+1;break}}else rt<0&&(nt=!0,rt=tt+1),it>-1&&(j.codePointAt(tt)===$.codePointAt(it--)?it<0&&(et=tt):(it=-1,et=rt));return _e===et?et=rt:et<0&&(et=j.length),j.slice(_e,et)}function dirname(j){if(assertPath$1(j),j.length===0)return".";let $=-1,_e=j.length,et;for(;--_e;)if(j.codePointAt(_e)===47){if(et){$=_e;break}}else et||(et=!0);return $<0?j.codePointAt(0)===47?"/":".":$===1&&j.codePointAt(0)===47?"//":j.slice(0,$)}function extname(j){assertPath$1(j);let $=j.length,_e=-1,et=0,tt=-1,nt=0,rt;for(;$--;){const it=j.codePointAt($);if(it===47){if(rt){et=$+1;break}continue}_e<0&&(rt=!0,_e=$+1),it===46?tt<0?tt=$:nt!==1&&(nt=1):tt>-1&&(nt=-1)}return tt<0||_e<0||nt===0||nt===1&&tt===_e-1&&tt===et+1?"":j.slice(tt,_e)}function join(...j){let $=-1,_e;for(;++$<j.length;)assertPath$1(j[$]),j[$]&&(_e=_e===void 0?j[$]:_e+"/"+j[$]);return _e===void 0?".":normalize$1(_e)}function normalize$1(j){assertPath$1(j);const $=j.codePointAt(0)===47;let _e=normalizeString(j,!$);return _e.length===0&&!$&&(_e="."),_e.length>0&&j.codePointAt(j.length-1)===47&&(_e+="/"),$?"/"+_e:_e}function normalizeString(j,$){let _e="",et=0,tt=-1,nt=0,rt=-1,it,st;for(;++rt<=j.length;){if(rt<j.length)it=j.codePointAt(rt);else{if(it===47)break;it=47}if(it===47){if(!(tt===rt-1||nt===1))if(tt!==rt-1&&nt===2){if(_e.length<2||et!==2||_e.codePointAt(_e.length-1)!==46||_e.codePointAt(_e.length-2)!==46){if(_e.length>2){if(st=_e.lastIndexOf("/"),st!==_e.length-1){st<0?(_e="",et=0):(_e=_e.slice(0,st),et=_e.length-1-_e.lastIndexOf("/")),tt=rt,nt=0;continue}}else if(_e.length>0){_e="",et=0,tt=rt,nt=0;continue}}$&&(_e=_e.length>0?_e+"/..":"..",et=2)}else _e.length>0?_e+="/"+j.slice(tt+1,rt):_e=j.slice(tt+1,rt),et=rt-tt-1;tt=rt,nt=0}else it===46&&nt>-1?nt++:nt=-1}return _e}function assertPath$1(j){if(typeof j!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(j))}const minproc={cwd};function cwd(){return"/"}function isUrl(j){return!!(j!==null&&typeof j=="object"&&"href"in j&&j.href&&"protocol"in j&&j.protocol&&j.auth===void 0)}function urlToPath(j){if(typeof j=="string")j=new URL(j);else if(!isUrl(j)){const $=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+j+"`");throw $.code="ERR_INVALID_ARG_TYPE",$}if(j.protocol!=="file:"){const $=new TypeError("The URL must be of scheme file");throw $.code="ERR_INVALID_URL_SCHEME",$}return getPathFromURLPosix(j)}function getPathFromURLPosix(j){if(j.hostname!==""){const et=new TypeError('File URL host must be "localhost" or empty on darwin');throw et.code="ERR_INVALID_FILE_URL_HOST",et}const $=j.pathname;let _e=-1;for(;++_e<$.length;)if($.codePointAt(_e)===37&&$.codePointAt(_e+1)===50){const et=$.codePointAt(_e+2);if(et===70||et===102){const tt=new TypeError("File URL path must not include encoded / characters");throw tt.code="ERR_INVALID_FILE_URL_PATH",tt}}return decodeURIComponent($)}const order=["history","path","basename","stem","extname","dirname"];class VFile{constructor($){let _e;$?isUrl($)?_e={path:$}:typeof $=="string"||isUint8Array$1($)?_e={value:$}:_e=$:_e={},this.cwd="cwd"in _e?"":minproc.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let et=-1;for(;++et<order.length;){const nt=order[et];nt in _e&&_e[nt]!==void 0&&_e[nt]!==null&&(this[nt]=nt==="history"?[..._e[nt]]:_e[nt])}let tt;for(tt in _e)order.includes(tt)||(this[tt]=_e[tt])}get basename(){return typeof this.path=="string"?minpath.basename(this.path):void 0}set basename($){assertNonEmpty($,"basename"),assertPart($,"basename"),this.path=minpath.join(this.dirname||"",$)}get dirname(){return typeof this.path=="string"?minpath.dirname(this.path):void 0}set dirname($){assertPath(this.basename,"dirname"),this.path=minpath.join($||"",this.basename)}get extname(){return typeof this.path=="string"?minpath.extname(this.path):void 0}set extname($){if(assertPart($,"extname"),assertPath(this.dirname,"extname"),$){if($.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if($.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=minpath.join(this.dirname,this.stem+($||""))}get path(){return this.history[this.history.length-1]}set path($){isUrl($)&&($=urlToPath($)),assertNonEmpty($,"path"),this.path!==$&&this.history.push($)}get stem(){return typeof this.path=="string"?minpath.basename(this.path,this.extname):void 0}set stem($){assertNonEmpty($,"stem"),assertPart($,"stem"),this.path=minpath.join(this.dirname||"",$+(this.extname||""))}fail($,_e,et){const tt=this.message($,_e,et);throw tt.fatal=!0,tt}info($,_e,et){const tt=this.message($,_e,et);return tt.fatal=void 0,tt}message($,_e,et){const tt=new VFileMessage($,_e,et);return this.path&&(tt.name=this.path+":"+tt.name,tt.file=this.path),tt.fatal=!1,this.messages.push(tt),tt}toString($){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder($||void 0).decode(this.value)}}function assertPart(j,$){if(j&&j.includes(minpath.sep))throw new Error("`"+$+"` cannot be a path: did not expect `"+minpath.sep+"`")}function assertNonEmpty(j,$){if(!j)throw new Error("`"+$+"` cannot be empty")}function assertPath(j,$){if(!j)throw new Error("Setting `"+$+"` requires `path` to be set too")}function isUint8Array$1(j){return!!(j&&typeof j=="object"&&"byteLength"in j&&"byteOffset"in j)}const CallableInstance=function(j){const et=this.constructor.prototype,tt=et[j],nt=function(){return tt.apply(nt,arguments)};return Object.setPrototypeOf(nt,et),nt},own={}.hasOwnProperty;class Processor extends CallableInstance{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=trough()}copy(){const $=new Processor;let _e=-1;for(;++_e<this.attachers.length;){const et=this.attachers[_e];$.use(...et)}return $.data(extend$2(!0,{},this.namespace)),$}data($,_e){return typeof $=="string"?arguments.length===2?(assertUnfrozen("data",this.frozen),this.namespace[$]=_e,this):own.call(this.namespace,$)&&this.namespace[$]||void 0:$?(assertUnfrozen("data",this.frozen),this.namespace=$,this):this.namespace}freeze(){if(this.frozen)return this;const $=this;for(;++this.freezeIndex<this.attachers.length;){const[_e,...et]=this.attachers[this.freezeIndex];if(et[0]===!1)continue;et[0]===!0&&(et[0]=void 0);const tt=_e.call($,...et);typeof tt=="function"&&this.transformers.use(tt)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse($){this.freeze();const _e=vfile($),et=this.parser||this.Parser;return assertParser("parse",et),et(String(_e),_e)}process($,_e){const et=this;return this.freeze(),assertParser("process",this.parser||this.Parser),assertCompiler("process",this.compiler||this.Compiler),_e?tt(void 0,_e):new Promise(tt);function tt(nt,rt){const it=vfile($),st=et.parse(it);et.run(st,it,function(ot,ct,lt){if(ot||!ct||!lt)return at(ot);const ut=ct,pt=et.stringify(ut,lt);looksLikeAValue(pt)?lt.value=pt:lt.result=pt,at(ot,lt)});function at(ot,ct){ot||!ct?rt(ot):nt?nt(ct):_e(void 0,ct)}}}processSync($){let _e=!1,et;return this.freeze(),assertParser("processSync",this.parser||this.Parser),assertCompiler("processSync",this.compiler||this.Compiler),this.process($,tt),assertDone("processSync","process",_e),et;function tt(nt,rt){_e=!0,bail(nt),et=rt}}run($,_e,et){assertNode($),this.freeze();const tt=this.transformers;return!et&&typeof _e=="function"&&(et=_e,_e=void 0),et?nt(void 0,et):new Promise(nt);function nt(rt,it){const st=vfile(_e);tt.run($,st,at);function at(ot,ct,lt){const ut=ct||$;ot?it(ot):rt?rt(ut):et(void 0,ut,lt)}}}runSync($,_e){let et=!1,tt;return this.run($,_e,nt),assertDone("runSync","run",et),tt;function nt(rt,it){bail(rt),tt=it,et=!0}}stringify($,_e){this.freeze();const et=vfile(_e),tt=this.compiler||this.Compiler;return assertCompiler("stringify",tt),assertNode($),tt($,et)}use($,..._e){const et=this.attachers,tt=this.namespace;if(assertUnfrozen("use",this.frozen),$!=null)if(typeof $=="function")st($,_e);else if(typeof $=="object")Array.isArray($)?it($):rt($);else throw new TypeError("Expected usable value, not `"+$+"`");return this;function nt(at){if(typeof at=="function")st(at,[]);else if(typeof at=="object")if(Array.isArray(at)){const[ot,...ct]=at;st(ot,ct)}else rt(at);else throw new TypeError("Expected usable value, not `"+at+"`")}function rt(at){if(!("plugins"in at)&&!("settings"in at))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");it(at.plugins),at.settings&&(tt.settings=extend$2(!0,tt.settings,at.settings))}function it(at){let ot=-1;if(at!=null)if(Array.isArray(at))for(;++ot<at.length;){const ct=at[ot];nt(ct)}else throw new TypeError("Expected a list of plugins, not `"+at+"`")}function st(at,ot){let ct=-1,lt=-1;for(;++ct<et.length;)if(et[ct][0]===at){lt=ct;break}if(lt===-1)et.push([at,...ot]);else if(ot.length>0){let[ut,...pt]=ot;const dt=et[lt][1];isPlainObject$6(dt)&&isPlainObject$6(ut)&&(ut=extend$2(!0,dt,ut)),et[lt]=[at,ut,...pt]}}}}const unified=new Processor().freeze();function assertParser(j,$){if(typeof $!="function")throw new TypeError("Cannot `"+j+"` without `parser`")}function assertCompiler(j,$){if(typeof $!="function")throw new TypeError("Cannot `"+j+"` without `compiler`")}function assertUnfrozen(j,$){if($)throw new Error("Cannot call `"+j+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(j){if(!isPlainObject$6(j)||typeof j.type!="string")throw new TypeError("Expected node, got `"+j+"`")}function assertDone(j,$,_e){if(!_e)throw new Error("`"+j+"` finished async. Use `"+$+"` instead")}function vfile(j){return looksLikeAVFile(j)?j:new VFile(j)}function looksLikeAVFile(j){return!!(j&&typeof j=="object"&&"message"in j&&"messages"in j)}function looksLikeAValue(j){return typeof j=="string"||isUint8Array(j)}function isUint8Array(j){return!!(j&&typeof j=="object"&&"byteLength"in j&&"byteOffset"in j)}const changelog="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",emptyPlugins=[],emptyRemarkRehypeOptions={allowDangerousHtml:!0},safeProtocol=/^(https?|ircs?|mailto|xmpp)$/i,deprecations=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Markdown(j){const $=createProcessor(j),_e=createFile(j);return post($.runSync($.parse(_e),_e),j)}function createProcessor(j){const $=j.rehypePlugins||emptyPlugins,_e=j.remarkPlugins||emptyPlugins,et=j.remarkRehypeOptions?{...j.remarkRehypeOptions,...emptyRemarkRehypeOptions}:emptyRemarkRehypeOptions;return unified().use(remarkParse).use(_e).use(remarkRehype,et).use($)}function createFile(j){const $=j.children||"",_e=new VFile;return typeof $=="string"&&(_e.value=$),_e}function post(j,$){const _e=$.allowedElements,et=$.allowElement,tt=$.components,nt=$.disallowedElements,rt=$.skipHtml,it=$.unwrapDisallowed,st=$.urlTransform||defaultUrlTransform;for(const ot of deprecations)Object.hasOwn($,ot.from)&&(""+ot.from+(ot.to?"use `"+ot.to+"` instead":"remove it")+changelog+ot.id,void 0);return visit(j,at),toJsxRuntime(j,{Fragment:jsxRuntimeExports.Fragment,components:tt,ignoreInvalidStyle:!0,jsx:jsxRuntimeExports.jsx,jsxs:jsxRuntimeExports.jsxs,passKeys:!0,passNode:!0});function at(ot,ct,lt){if(ot.type==="raw"&&lt&&typeof ct=="number")return rt?lt.children.splice(ct,1):lt.children[ct]={type:"text",value:ot.value},ct;if(ot.type==="element"){let ut;for(ut in urlAttributes)if(Object.hasOwn(urlAttributes,ut)&&Object.hasOwn(ot.properties,ut)){const pt=ot.properties[ut],dt=urlAttributes[ut];(dt===null||dt.includes(ot.tagName))&&(ot.properties[ut]=st(String(pt||""),ut,ot))}}if(ot.type==="element"){let ut=_e?!_e.includes(ot.tagName):nt?nt.includes(ot.tagName):!1;if(!ut&&et&&typeof ct=="number"&&(ut=!et(ot,ct,lt)),ut&&lt&&typeof ct=="number")return it&&ot.children?lt.children.splice(ct,1,...ot.children):lt.children.splice(ct,1),ct}}}function defaultUrlTransform(j){const $=j.indexOf(":"),_e=j.indexOf("?"),et=j.indexOf("#"),tt=j.indexOf("/");return $===-1||tt!==-1&&$>tt||_e!==-1&&$>_e||et!==-1&&$>et||safeProtocol.test(j.slice(0,$))?j:""}async function convertWebMBlobToWav(j){const $=new AudioContext,_e=await j.arrayBuffer(),et=await $.decodeAudioData(_e),tt=et.numberOfChannels,nt=et.sampleRate,rt=et.length,it=new ArrayBuffer(44+rt*tt*2),st=new DataView(it),at=(ct,lt)=>{for(let ut=0;ut<lt.length;ut++)st.setUint8(ct+ut,lt.charCodeAt(ut))};at(0,"RIFF"),st.setUint32(4,36+rt*tt*2,!0),at(8,"WAVE"),at(12,"fmt "),st.setUint32(16,16,!0),st.setUint16(20,1,!0),st.setUint16(22,tt,!0),st.setUint32(24,nt,!0),st.setUint32(28,nt*tt*2,!0),st.setUint16(32,tt*2,!0),st.setUint16(34,16,!0),at(36,"data"),st.setUint32(40,rt*tt*2,!0);let ot=44;for(let ct=0;ct<rt;ct++)for(let lt=0;lt<tt;lt++){const ut=Math.max(-1,Math.min(1,et.getChannelData(lt)[ct]));st.setInt16(ot,ut<0?ut*32768:ut*32767,!0),ot+=2}return new Blob([it],{type:"audio/wav"})}function useAudioDownload(){const j=reactExports.useRef(null),$=reactExports.useRef([]),_e=reactExports.useRef(null),et=reactExports.useRef(null),tt=reactExports.useRef(null),[nt,rt]=reactExports.useState(null),it=async pt=>{at();let dt;try{dt=await navigator.mediaDevices.getUserMedia({audio:!0}),et.current=dt}catch(gt){console.error("Error getting microphone stream:",gt),dt=new MediaStream,et.current=dt}const ht=new AudioContext;_e.current=ht;const ft=ht.createMediaStreamDestination();tt.current=ft.stream;try{ht.createMediaStreamSource(pt).connect(ft)}catch(gt){console.error("Error connecting remote stream to the audio context:",gt)}try{ht.createMediaStreamSource(dt).connect(ft)}catch(gt){console.error("Error connecting microphone stream to the audio context:",gt)}const mt={mimeType:"audio/webm"};try{const gt=new MediaRecorder(ft.stream,mt);gt.ondataavailable=yt=>{yt.data&&yt.data.size>0&&$.current.push(yt.data)},gt.onstop=()=>{console.log("MediaRecorder stopped")},gt.onerror=yt=>{console.error("MediaRecorder error:",yt)},gt.start(),j.current=gt,console.log("Recording started successfully")}catch(gt){console.error("Error starting MediaRecorder with combined stream:",gt),st()}},st=()=>{console.log("Cleaning up audio resources..."),et.current&&(et.current.getTracks().forEach(pt=>{pt.stop(),console.log("Stopped mic track:",pt.kind)}),et.current=null),tt.current&&(tt.current.getTracks().forEach(pt=>{pt.stop(),console.log("Stopped combined track:",pt.kind)}),tt.current=null),_e.current&&(_e.current.state!=="closed"&&_e.current.close().catch(pt=>{console.error("Error closing AudioContext:",pt)}),_e.current=null),console.log("Audio cleanup completed")},at=()=>{if(console.log("Stopping recording..."),j.current){const pt=j.current.state;console.log("MediaRecorder state:",pt),pt==="recording"&&(j.current.requestData(),j.current.stop()),j.current=null}st()};return{startRecording:it,stopRecording:at,downloadRecording:async()=>{if(!j.current&&$.current.length===0){console.warn("No recorded chunks found to download.");return}if(j.current&&j.current.state==="recording"&&await new Promise(dt=>{const ht=j.current,ft=mt=>{mt.data&&mt.data.size>0&&$.current.push(mt.data),ht.removeEventListener("dataavailable",ft),dt()};ht.addEventListener("dataavailable",ft),ht.requestData()}),$.current.length===0){console.warn("No recorded chunks found to download.");return}const pt=new Blob($.current,{type:"audio/webm"});try{const dt=await convertWebMBlobToWav(pt),ht=URL.createObjectURL(dt),ft=new Date().toISOString().replace(/[:.]/g,"-"),mt=document.createElement("a");mt.style.display="none",mt.href=ht,mt.download=`ai_roleplay_${ft}.wav`,document.body.appendChild(mt),mt.click(),document.body.removeChild(mt),setTimeout(()=>URL.revokeObjectURL(ht),100)}catch(dt){console.error("Error converting recording to WAV:",dt)}},generatePlaybackUrl:async()=>{var dt;if(((dt=j.current)==null?void 0:dt.state)==="recording"&&(j.current.requestData(),await new Promise(ht=>setTimeout(ht,100))),$.current.length===0){console.warn("No recorded chunks found to play.");return}const pt=new Blob($.current,{type:"audio/webm"});try{const ht=await convertWebMBlobToWav(pt),ft=URL.createObjectURL(ht);rt(ft)}catch(ht){console.error("Error creating playback URL:",ht)}},generateBlob:async()=>{var dt;if(!j.current&&$.current.length===0||(((dt=j.current)==null?void 0:dt.state)==="recording"&&await new Promise(ht=>{const ft=j.current,mt=gt=>{gt.data&&gt.data.size>0&&$.current.push(gt.data),ft.removeEventListener("dataavailable",mt),ht()};ft.addEventListener("dataavailable",mt),ft.requestData()}),$.current.length===0))return console.warn("No recorded chunks found."),null;const pt=new Blob($.current,{type:"audio/webm"});try{return await convertWebMBlobToWav(pt)}catch{return pt}},resetRecording:()=>{$.current=[],nt&&(URL.revokeObjectURL(nt),rt(null))},cleanup:st,audioUrl:nt}}let toastCount=0;function generateId(){return toastCount=(toastCount+1)%Number.MAX_SAFE_INTEGER,toastCount.toString()}const toastListeners=new Set;let memoryState={toasts:[]};function dispatch(j){memoryState={toasts:[...memoryState.toasts,j].slice(-5)},toastListeners.forEach($=>$(memoryState.toasts))}function dismiss(j){memoryState={toasts:j?memoryState.toasts.filter($=>$.id!==j):[]},toastListeners.forEach($=>$(memoryState.toasts))}function toast({title:j,description:$,variant:_e="default"}){const et=generateId();return dispatch({id:et,title:j,description:$,variant:_e}),setTimeout(()=>{dismiss(et)},5e3),{id:et,dismiss:()=>dismiss(et)}}function useToast(){const[j,$]=reactExports.useState(memoryState.toasts),_e=reactExports.useCallback(et=>(toastListeners.add(et),()=>{toastListeners.delete(et)}),[]);return reactExports.useState(()=>_e($)),{toasts:j,toast,dismiss}}function AssessmentRoleplaySessionPage(){return jsxRuntimeExports.jsx(TranscriptProvider,{children:jsxRuntimeExports.jsx(EventProvider,{children:jsxRuntimeExports.jsx(AvatarRoleplayPractice,{})})})}const AvatarRoleplayPractice=()=>{const{user:j}=useAuth(),$=useLocation(),[_e]=useSearchParams();useNavigate();const[et,tt]=reactExports.useState(null),[nt,rt]=reactExports.useState(""),it=_e.get("avatarId"),{data:st,isLoading:at}=useAvatarById(it);_e.get("codec");const{transcriptItems:ot,addTranscriptMessage:ct,addTranscriptBreadcrumb:lt}=useTranscript(),{logClientEvent:ut,logServerEvent:pt}=useEvent(),[dt,ht]=reactExports.useState(!0),[ft,mt]=reactExports.useState("chatRoleplay"),gt=reactExports.useRef(null),yt=React$4.useMemo(()=>{if(typeof window>"u")return;const Ft=document.createElement("audio");return Ft.autoplay=!0,Ft.style.display="none",document.body.appendChild(Ft),Ft},[]),vt=_e.get("scenarioId");reactExports.useEffect(()=>{if(et)return;vt?(async()=>{try{ht(!0);const Jt=await(await fetch(`/api/avatar/get-scenarios?scenarioId=${vt}`)).json();Jt.scenarios&&Jt.scenarios.length>0?(tt(Jt.scenarios[0]),console.log("scenario",Jt.scenarios[0])):rt("Scenario not found. Please return to practice and try again.")}catch(At){console.error("Error fetching scenario:",At),rt("Unable to load the practice scenario. Please check your connection and try again.")}finally{ht(!1)}})():ht(!1)},[vt]),reactExports.useEffect(()=>{yt&&!gt.current&&(gt.current=yt)},[yt]);const{connect:xt,disconnect:St,sendEvent:Et,mute:wt}=useRealtimeSession({onConnectionChange:Ft=>Ct(Ft)}),[Tt,Ct]=reactExports.useState("DISCONNECTED"),[Rt,jt]=reactExports.useState(!1),[Ot,$t]=reactExports.useState(""),[Kt,Lt]=reactExports.useState(!1),[Nt,Bt]=reactExports.useState(!1),[kt,rn]=reactExports.useState(!0),{startRecording:Gt,stopRecording:_t,downloadRecording:sn,generateBlob:tn}=useAudioDownload(),on=(Ft,At="")=>{try{Et(Ft),ut(Ft,At)}catch(Jt){console.error("Failed to send via SDK",Jt)}};useHandleSessionHistory();const It=_e.get("autostart")==="true";reactExports.useEffect(()=>{dt||It&&ft&&Tt==="DISCONNECTED"&&En()},[ft,dt,It]),reactExports.useEffect(()=>{Tt==="CONNECTED"&&Gn(!(ot!=null&&ot.length))},[Kt,dt,Tt]);const Zt=async()=>{var Jt;ut({url:"/session"},"fetch_session_token_request");const At=await(await fetch("/api/avatar/session")).json();return pt(At,"fetch_session_token_response"),(Jt=At.client_secret)!=null&&Jt.value?At.client_secret.value:(ut(At,"error.no_ephemeral_key"),console.error("No ephemeral key provided by the server"),Ct("DISCONNECTED"),null)},Ut={male:"ballad",female:"sage"};function Xt(Ft){return Ft&&Ut[Ft.toLowerCase()]||"sage"}const Ht=_e.get("tone")||"",Pt=_e.get("language")||"en",Mt=_e.get("culturalPreset")||null,Vt=_e.get("accent")||null,qt=_e.get("blueprint"),en=React$4.useMemo(()=>{if(!qt)return null;try{return JSON.parse(decodeURIComponent(qt))}catch(Ft){return console.error("Failed to parse blueprint:",Ft),null}},[qt]);function fn(Ft,At){return`
## IMPORTANT: Role Assignment
- YOU are playing: ${(At==null?void 0:At.avatarName)||"the stakeholder"} (${(At==null?void 0:At.avatarRole)||"stakeholder"})
- The USER is playing: ${Ft||"the manager/professional"} who is practicing their skills
- Stay in character as ${(At==null?void 0:At.avatarName)||"the stakeholder"} throughout the conversation
- The user is the one practicing - they should lead and you should respond as ${(At==null?void 0:At.avatarName)||"your character"}

${At!=null&&At.name?`## Scenario: ${At.name}`:""}
${At!=null&&At.description?`## Situation Overview
${At.description}`:""}
${At!=null&&At.context?`## Your Character's Mindset & Behavior
${At.context}`:""}
${At!=null&&At.instructions?`## How to Play Your Character
${At.instructions}`:""}
    `.trim()}const Cn=()=>{const Ft=ot==null?void 0:ot.filter(Jt=>Jt.status==="DONE"&&!Jt.isHidden);return!Ft||Ft.length===0?"":(Ft.length>6?Ft.slice(-6):Ft).map(Jt=>`${Jt.role==="user"?"Learner":"Coach"}: ${Jt.title}`).join(`
`)};console.log("avatar Data",st);const En=async()=>{if(Tt==="DISCONNECTED"){Ct("CONNECTING"),console.log("isInitializing in connect",dt);try{if(dt)return;const Ft=await Zt();if(!Ft)return;const At=st,Jt=(et==null?void 0:et.name)||"",vn=fn((j==null?void 0:j.displayName)||"",et||{}),bn=Cn();console.log({isInitializing:dt},"notes scenario",vn),console.log("selectedAvatar",At);const $n=Xt((At==null?void 0:At.gender)||"");console.log("voice",$n);let Yn;if(en)console.log("Using blueprint for agent creation:",en,"cultural preset:",Mt,"accent:",Vt),Yn=createRealtimeAgentFromBlueprint(en,$n,Pt,Mt,Vt);else{const Dr=bn?`${vn}

# Previous Conversation
${bn}`:vn,Xn=(et==null?void 0:et.avatarRole)||"stakeholder",br=(et==null?void 0:et.avatarName)||"the stakeholder";Yn=createRealtimeAgent(Jt,Dr,$n,Xn,br,Ht||"realistic",Pt,Mt,Vt)}const er=[Yn],gr=chatPlatformName;await xt({getEphemeralKey:async()=>Ft,initialAgents:er,audioElement:yt})}catch(Ft){console.error("Error connecting via SDK:",Ft),Ct("DISCONNECTED")}}},Pn=()=>{St(),Ct("DISCONNECTED"),Bt(!1)},Rn=Ft=>{const At=v4().slice(0,32);ct(At,"user",Ft,!0),on({type:"conversation.item.create",item:{id:At,type:"message",role:"user",content:[{type:"input_text",text:Ft}]}}),on({type:"response.create"},"(simulated user text message)")},Gn=(Ft=!1)=>{Et({type:"session.update",session:{turn_detection:Kt?null:{type:"server_vad",threshold:.9,prefix_padding_ms:300,silence_duration_ms:500,create_response:!0}}}),Ft&&Rn("hi")},xn=()=>{Tt==="CONNECTED"||Tt==="CONNECTING"?(Pn(),Ct("DISCONNECTED")):En()};reactExports.useEffect(()=>{const Ft=localStorage.getItem("pushToTalkUI");Ft&&Lt(Ft==="true");const At=localStorage.getItem("logsExpanded");At&&jt(At==="true")},[]),reactExports.useEffect(()=>{localStorage.setItem("pushToTalkUI",Kt.toString())},[Kt]),reactExports.useEffect(()=>{localStorage.setItem("logsExpanded",Rt.toString())},[Rt]),reactExports.useEffect(()=>{localStorage.setItem("audioPlaybackEnabled",kt.toString())},[kt]),reactExports.useEffect(()=>{gt.current&&(kt?(gt.current.muted=!1,gt.current.play().catch(Ft=>{console.warn("Autoplay may be blocked by browser:",Ft)})):(gt.current.muted=!0,gt.current.pause()));try{wt(!kt)}catch(Ft){console.warn("Failed to toggle SDK mute",Ft)}},[kt]),reactExports.useEffect(()=>{if(Tt==="CONNECTED")try{wt(!kt)}catch(Ft){console.warn("mute sync after connect failed",Ft)}},[Tt,kt]),reactExports.useEffect(()=>{var Ft;if(Tt==="CONNECTED"&&((Ft=gt.current)!=null&&Ft.srcObject)){const At=gt.current.srcObject;Gt(At)}return()=>{_t()}},[Tt]);const _n=reactExports.useRef(!0),Zn=reactExports.useRef($.pathname);return reactExports.useEffect(()=>(_n.current=!0,()=>{_n.current=!1}),[]),reactExports.useEffect(()=>{if(Zn.current!==$.pathname){console.log("Path changed from",Zn.current,"to",$.pathname),Zn.current=$.pathname;try{St(),_t(),Ct("DISCONNECTED"),Bt(!1)}catch(Ft){console.error("Error during navigation cleanup:",Ft)}}},[$.pathname]),dt||at?jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessments",children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Preparing Your Session..."})]})})}):(console.log(et),jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessments",children:jsxRuntimeExports.jsx("div",{className:"h-[calc(100vh-80px)] flex flex-col bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 -m-6 p-6",children:jsxRuntimeExports.jsx(Transcript,{avatar:st,sessionStatus:Tt,onToggleConnection:xn,scenario:et,downloadRecording:sn,generateBlob:tn,isAudioMuted:!kt,onToggleAudioMute:()=>rn(Ft=>!Ft)})})}))};function Transcript({avatar:j,sessionStatus:$,onToggleConnection:_e,scenario:et,downloadRecording:tt,generateBlob:nt,isAudioMuted:rt,onToggleAudioMute:it}){const{user:st}=useAuth(),{toast:at}=useToast(),{transcriptItems:ot}=useTranscript(),[ct]=useSearchParams();ct.get("avatarId");const lt=ct.get("assignmentId"),ut=reactExports.useRef(null),[pt,dt]=reactExports.useState(!1),[ht,ft]=reactExports.useState([]),[mt,gt]=reactExports.useState(!1),[yt,vt]=reactExports.useState(!1),xt=et!=null&&et.duration?parseInt(String(et.duration),10):5,[St,Et]=reactExports.useState(isNaN(xt)?5:xt),[wt,Tt]=reactExports.useState(St*60),[Ct,Rt]=reactExports.useState(!1),jt=reactExports.useRef(null),Ot=$==="CONNECTED",$t=$==="CONNECTING",Kt=useNavigate();reactExports.useEffect(()=>(Ct&&wt>0?jt.current=setTimeout(()=>{Tt(It=>It-1)},1e3):wt===0&&Ct&&(Rt(!1),at({title:"Session Ended",description:"Your 5-minute session has completed automatically."}),rn()),()=>{jt.current&&clearTimeout(jt.current)}),[Ct,wt]),reactExports.useEffect(()=>{Ot&&!Ct?(Rt(!0),Tt(St*60)):Ot||(Rt(!1),jt.current&&clearTimeout(jt.current))},[Ot,St]),reactExports.useEffect(()=>{Ot&&vt(!0)},[Ot]),reactExports.useEffect(()=>{if(et!=null&&et.duration){const It=parseInt(String(et.duration),10);!isNaN(It)&&It>0&&(Et(It),Ct||Tt(It*60))}},[et==null?void 0:et.duration]);const Lt=It=>{const Zt=Math.floor(It/60),Ut=It%60;return`${Zt}:${Ut.toString().padStart(2,"0")}`},Nt=()=>{ut.current&&(ut.current.scrollTop=ut.current.scrollHeight)},Bt=async It=>{try{const Zt=new FormData;Zt.append("file",It,`ai_roleplay_${Date.now()}.wav`),Zt.append("type","audio"),Zt.append("avatarId",j==null?void 0:j.id);const Xt=await(await fetch("/api/avatar/upload-recording",{method:"POST",body:Zt})).json();return console.log("Upload response:",Xt),Xt.success?(console.log("Recording uploaded to:",Xt.fileUrl),Xt.fileUrl):(console.error("Upload error:",Xt.error),null)}catch(Zt){return console.error("Error uploading recording:",Zt),null}},kt=async()=>{const It=await nt();if(console.log({blob:It}),!!It)return await Bt(It)},rn=async()=>{var It,Zt,Ut;try{dt(!0),Rt(!1),Ot&&_e();const Xt=await kt();console.log({audioUrl:Xt});const Ht=ot||[],Pt=((It=Ht[0])==null?void 0:It.createdAtMs)||0,Mt=((Zt=Ht[Ht.length-1])==null?void 0:Zt.createdAtMs)||0,Vt=Mt&&Pt?Math.ceil((Mt-Pt)/1e3):0,qt=generateUniqueId("tr"),fn=await(await fetch("/api/avatar/save-roleplay-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:st==null?void 0:st.id,transcriptId:qt,avatarId:j==null?void 0:j.id,duration:Vt,startTime:Pt,endTime:Mt,audioUrl:Xt})})).json();console.log(" Session saved successfully:",fn);const Cn=(Ut=fn==null?void 0:fn.session)==null?void 0:Ut.id;if(!Cn){console.log(" Session save failed:",fn),at({title:"Failed to save session",description:"Please try again later."});return}const En=Ht.slice(1).map(Rn=>({speaker:(Rn==null?void 0:Rn.role)||"unknown",timestamp:((Rn==null?void 0:Rn.timestamp)||"").substring(0,8),createdAt:(Rn==null?void 0:Rn.createdAtMs)||0,text:(Rn==null?void 0:Rn.title)||""}));if((await fetch("/api/avatar/save-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:st==null?void 0:st.id,sessionId:Cn,transcriptId:qt,scenarioId:et==null?void 0:et.id,avatarId:j==null?void 0:j.id,duration:Vt,context:et==null?void 0:et.context,instructions:et==null?void 0:et.instructions,messages:En,sessionType:"audio_roleplay"})})).ok){console.log("Transcript saved successfully");try{fetch("/api/avatar/recommended-scenario",{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({scenarioId:et==null?void 0:et.id,userId:st==null?void 0:st.id,assignmentId:lt,isScenarioCompleted:!0,transcriptId:qt,sessionId:Cn})})}catch(Rn){console.log("Failed to update recommended scenario",Rn)}Kt(`/micro-assessment-session-analysis?sid=${Cn}&tid=${qt}&assignmentId=${lt}&type=audio_roleplay`)}else at({title:"Failed to save session",description:"Please try again later."}),console.log("Failed to save transcript")}catch(Xt){console.log("error saving",Xt),at({title:"Failed to save session",description:"Please try again later."})}finally{dt(!1)}};reactExports.useEffect(()=>{const It=ot.length>ht.length,Zt=ot.some((Ut,Xt)=>{const Ht=ht[Xt];return Ht&&(Ut.title!==Ht.title||Ut.data!==Ht.data)});(It||Zt)&&Nt(),ft(ot)},[ot]);const Gt=async()=>{if(ut.current)try{await navigator.clipboard.writeText(ut.current.innerText),gt(!0),setTimeout(()=>gt(!1),1500)}catch(It){console.error("Failed to copy transcript:",It)}},[_t,sn]=reactExports.useState(!1),tn=()=>wt<=60?"text-red-400":wt<=180?"text-orange-400":"text-white/80",on=(ot||[]).filter(It=>It.type==="MESSAGE"&&It.role!=="user").slice(-1)[0];return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 right-4 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-white/60 text-sm",children:(et==null?void 0:et.name)||"Practice Session"}),(et==null?void 0:et.avatarRole)&&jsxRuntimeExports.jsxs("p",{className:"text-white/40 text-xs mt-1",children:["Speaking with: ",et.avatarRole]})]}),jsxRuntimeExports.jsxs("div",{className:"relative mb-6",children:[Ot&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 rounded-full bg-green-500/20 animate-ping",style:{animationDuration:"2s"}}),jsxRuntimeExports.jsx("div",{className:"absolute -inset-4 rounded-full bg-green-500/10 animate-pulse",style:{animationDuration:"1.5s"}})]}),$t&&jsxRuntimeExports.jsx("div",{className:"absolute -inset-4 rounded-full bg-blue-500/20 animate-pulse"}),jsxRuntimeExports.jsx("div",{className:cn("relative w-32 h-32 rounded-full overflow-hidden ring-4 transition-all duration-300",Ot?"ring-green-500 shadow-lg shadow-green-500/30":$t?"ring-blue-500 shadow-lg shadow-blue-500/30":"ring-white/20"),children:j!=null&&j.imageUrl?jsxRuntimeExports.jsx("img",{src:j.imageUrl,alt:j.name||"Avatar",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsx("div",{className:"w-full h-full bg-slate-700 flex items-center justify-center",children:jsxRuntimeExports.jsx(User,{className:"w-16 h-16 text-white/40"})})})]}),jsxRuntimeExports.jsx("h2",{className:"text-white text-2xl font-semibold mb-2",children:(j==null?void 0:j.name)||"AI Assistant"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"text-blue-400 text-sm",children:"Connecting..."})]}),Ot&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"text-green-400 text-sm",children:"Connected"})]}),!Ot&&!$t&&!yt&&jsxRuntimeExports.jsx("span",{className:"text-white/50 text-sm",children:"Ready to connect"}),!Ot&&!$t&&yt&&jsxRuntimeExports.jsx("span",{className:"text-white/50 text-sm",children:"Call ended"})]}),Ct&&jsxRuntimeExports.jsx("div",{className:cn("text-3xl font-mono mb-4",tn()),children:Lt(wt)}),Ot&&(on==null?void 0:on.title)&&jsxRuntimeExports.jsx("div",{className:"max-w-md mx-auto px-6 py-3 bg-black/30 rounded-xl backdrop-blur-sm",children:jsxRuntimeExports.jsxs("p",{className:"text-white/80 text-center text-sm leading-relaxed",children:['"',on.title.length>150?on.title.slice(-150)+"...":on.title,'"']})})]}),jsxRuntimeExports.jsxs("div",{className:cn("bg-slate-800/90 backdrop-blur-sm rounded-t-2xl transition-all duration-300 ease-in-out",_t?"h-[40vh]":"h-16"),children:[jsxRuntimeExports.jsxs("button",{onClick:()=>sn(!_t),className:"w-full px-4 py-3 flex items-center justify-between text-white/80 hover:bg-slate-700/50 rounded-t-2xl transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(MessageSquare,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Transcript"}),jsxRuntimeExports.jsxs("span",{className:"text-white/40 text-sm",children:["(",ot.filter(It=>It.type==="MESSAGE").length," messages)"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[yt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:It=>{It.stopPropagation(),Gt()},className:"p-2 hover:bg-slate-600/50 rounded-lg transition-colors",title:"Copy transcript",children:jsxRuntimeExports.jsx(Clipboard,{className:"w-4 h-4"})}),jsxRuntimeExports.jsx("button",{onClick:It=>{It.stopPropagation(),tt()},className:"p-2 hover:bg-slate-600/50 rounded-lg transition-colors",title:"Download audio",children:jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"})})]}),_t?jsxRuntimeExports.jsx(ChevronDown,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(ChevronUp,{className:"w-5 h-5"})]})]}),_t&&jsxRuntimeExports.jsx("div",{ref:ut,className:"overflow-auto px-4 pb-4 h-[calc(40vh-4rem)]",children:ot.length===0?jsxRuntimeExports.jsx("p",{className:"text-white/40 text-center py-8 text-sm",children:"Conversation will appear here..."}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:(ot||[]).slice().sort((It,Zt)=>((It==null?void 0:It.createdAtMs)||0)-((Zt==null?void 0:Zt.createdAtMs)||0)).map(It=>{var Ht,Pt;if(!It||It.isHidden||It.type!=="MESSAGE")return null;const Zt=It.role==="user",Ut=((Ht=It.title)==null?void 0:Ht.startsWith("["))&&((Pt=It.title)==null?void 0:Pt.endsWith("]")),Xt=Ut?(It.title||"").slice(1,-1):It.title||"";return jsxRuntimeExports.jsxs("div",{className:cn("flex gap-2",Zt?"justify-end":"justify-start"),children:[!Zt&&(j==null?void 0:j.imageUrl)&&jsxRuntimeExports.jsx("img",{src:j.imageUrl,alt:j.name||"avatar",className:"w-8 h-8 rounded-full object-cover flex-shrink-0"}),jsxRuntimeExports.jsx("div",{className:cn("max-w-[70%] px-3 py-2 rounded-2xl text-sm",Zt?"bg-blue-600 text-white rounded-br-sm":"bg-slate-700 text-white/90 rounded-bl-sm",Ut&&"italic text-white/60"),children:jsxRuntimeExports.jsx(Markdown,{children:Xt})})]},It.itemId)})})})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-900/80 backdrop-blur-sm px-6 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-4",children:[!Ot&&!$t&&!yt&&jsxRuntimeExports.jsxs("button",{onClick:_e,disabled:pt,className:"flex items-center gap-2 px-8 py-3 rounded-full font-medium bg-green-600 hover:bg-green-500 text-white shadow-lg shadow-green-600/30 transition-all",children:[jsxRuntimeExports.jsx(Phone,{className:"w-5 h-5"}),"Start Call"]}),$t&&jsxRuntimeExports.jsxs("button",{disabled:!0,className:"flex items-center gap-2 px-8 py-3 rounded-full font-medium bg-blue-600 text-white cursor-not-allowed",children:[jsxRuntimeExports.jsx(Phone,{className:"w-5 h-5 animate-pulse"}),"Connecting..."]}),Ot&&jsxRuntimeExports.jsx("button",{onClick:it,className:cn("flex items-center justify-center w-12 h-12 rounded-full transition-all",rt?"bg-yellow-600 hover:bg-yellow-500 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),title:rt?"Unmute speaker":"Mute speaker",children:rt?jsxRuntimeExports.jsx(VolumeX,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Volume2,{className:"w-5 h-5"})}),Ot&&jsxRuntimeExports.jsxs("button",{onClick:_e,disabled:pt,className:"flex items-center gap-2 px-8 py-3 rounded-full font-medium bg-red-600 hover:bg-red-500 text-white shadow-lg shadow-red-600/30 transition-all",children:[jsxRuntimeExports.jsx(PhoneOff,{className:"w-5 h-5"}),"End Call"]}),!Ot&&!$t&&yt&&jsxRuntimeExports.jsxs("button",{onClick:_e,disabled:pt,className:"flex items-center gap-2 px-6 py-3 rounded-full font-medium bg-slate-700 hover:bg-slate-600 text-white transition-all",children:[jsxRuntimeExports.jsx(Phone,{className:"w-5 h-5"}),"Reconnect"]}),yt&&!pt&&jsxRuntimeExports.jsx(Button,{onClick:rn,disabled:pt,className:"flex items-center gap-2 px-8 py-3 rounded-full font-medium bg-blue-600 hover:bg-blue-500 text-white",children:"Save & View Analysis"}),pt&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-white/60",children:[jsxRuntimeExports.jsx(LoadingSpinner,{size:"sm"}),jsxRuntimeExports.jsx("span",{children:"Saving your session..."})]})]}),yt&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:Gt,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-700/50 hover:bg-slate-600/50 text-white/80 text-sm transition-colors",children:[jsxRuntimeExports.jsx(Clipboard,{className:"w-4 h-4"}),mt?"Copied!":"Copy Transcript"]}),jsxRuntimeExports.jsxs("button",{onClick:tt,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-700/50 hover:bg-slate-600/50 text-white/80 text-sm transition-colors",children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4"}),"Download Audio"]})]})]})})]})}function r(j){var $,_e,et="";if(typeof j=="string"||typeof j=="number")et+=j;else if(typeof j=="object")if(Array.isArray(j)){var tt=j.length;for($=0;$<tt;$++)j[$]&&(_e=r(j[$]))&&(et&&(et+=" "),et+=_e)}else for(_e in j)j[_e]&&(et&&(et+=" "),et+=_e);return et}function clsx(){for(var j,$,_e=0,et="",tt=arguments.length;_e<tt;_e++)(j=arguments[_e])&&($=r(j))&&(et&&(et+=" "),et+=$);return et}var EventKeys=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function isEventKey(j){if(typeof j!="string")return!1;var $=EventKeys;return $.includes(j)}var SVGElementPropKeys=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],SVGElementPropKeySet=new Set(SVGElementPropKeys);function isSvgElementPropKey(j){return typeof j!="string"?!1:SVGElementPropKeySet.has(j)}function isDataAttribute(j){return typeof j=="string"&&j.startsWith("data-")}function svgPropertiesNoEvents(j){if(typeof j!="object"||j===null)return{};var $={};for(var _e in j)Object.prototype.hasOwnProperty.call(j,_e)&&(isSvgElementPropKey(_e)||isDataAttribute(_e))&&($[_e]=j[_e]);return $}function svgPropertiesNoEventsFromUnknown(j){if(j==null)return null;if(reactExports.isValidElement(j)&&typeof j.props=="object"&&j.props!==null){var $=j.props;return svgPropertiesNoEvents($)}return typeof j=="object"&&!Array.isArray(j)?svgPropertiesNoEvents(j):null}function svgPropertiesAndEvents(j){var $={};for(var _e in j)Object.prototype.hasOwnProperty.call(j,_e)&&(isSvgElementPropKey(_e)||isDataAttribute(_e)||isEventKey(_e))&&($[_e]=j[_e]);return $}function svgPropertiesAndEventsFromUnknown(j){return j==null?null:reactExports.isValidElement(j)?svgPropertiesAndEvents(j.props):typeof j=="object"&&!Array.isArray(j)?svgPropertiesAndEvents(j):null}var _excluded$k=["children","width","height","viewBox","className","style","title","desc"];function _extends$o(){return _extends$o=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$o.apply(null,arguments)}function _objectWithoutProperties$k(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$k(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$k(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var Surface=reactExports.forwardRef((j,$)=>{var{children:_e,width:et,height:tt,viewBox:nt,className:rt,style:it,title:st,desc:at}=j,ot=_objectWithoutProperties$k(j,_excluded$k),ct=nt||{width:et,height:tt,x:0,y:0},lt=clsx("recharts-surface",rt);return reactExports.createElement("svg",_extends$o({},svgPropertiesAndEvents(ot),{className:lt,width:et,height:tt,style:it,viewBox:"".concat(ct.x," ").concat(ct.y," ").concat(ct.width," ").concat(ct.height),ref:$}),reactExports.createElement("title",null,st),reactExports.createElement("desc",null,at),_e)}),_excluded$j=["children","className"];function _extends$n(){return _extends$n=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$n.apply(null,arguments)}function _objectWithoutProperties$j(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$j(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$j(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var Layer=reactExports.forwardRef((j,$)=>{var{children:_e,className:et}=j,tt=_objectWithoutProperties$j(j,_excluded$j),nt=clsx("recharts-layer",et);return reactExports.createElement("g",_extends$n({className:nt},svgPropertiesAndEvents(tt),{ref:$}),_e)}),LegendPortalContext=reactExports.createContext(null);function constant$1(j){return function(){return j}}const cos=Math.cos,sin=Math.sin,sqrt$1=Math.sqrt,pi$1=Math.PI,tau$1=2*pi$1,pi=Math.PI,tau=2*pi,epsilon=1e-6,tauEpsilon=tau-epsilon;function append(j){this._+=j[0];for(let $=1,_e=j.length;$<_e;++$)this._+=arguments[$]+j[$]}function appendRound(j){let $=Math.floor(j);if(!($>=0))throw new Error(`invalid digits: ${j}`);if($>15)return append;const _e=10**$;return function(et){this._+=et[0];for(let tt=1,nt=et.length;tt<nt;++tt)this._+=Math.round(arguments[tt]*_e)/_e+et[tt]}}class Path{constructor($){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=$==null?append:appendRound($)}moveTo($,_e){this._append`M${this._x0=this._x1=+$},${this._y0=this._y1=+_e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo($,_e){this._append`L${this._x1=+$},${this._y1=+_e}`}quadraticCurveTo($,_e,et,tt){this._append`Q${+$},${+_e},${this._x1=+et},${this._y1=+tt}`}bezierCurveTo($,_e,et,tt,nt,rt){this._append`C${+$},${+_e},${+et},${+tt},${this._x1=+nt},${this._y1=+rt}`}arcTo($,_e,et,tt,nt){if($=+$,_e=+_e,et=+et,tt=+tt,nt=+nt,nt<0)throw new Error(`negative radius: ${nt}`);let rt=this._x1,it=this._y1,st=et-$,at=tt-_e,ot=rt-$,ct=it-_e,lt=ot*ot+ct*ct;if(this._x1===null)this._append`M${this._x1=$},${this._y1=_e}`;else if(lt>epsilon)if(!(Math.abs(ct*st-at*ot)>epsilon)||!nt)this._append`L${this._x1=$},${this._y1=_e}`;else{let ut=et-rt,pt=tt-it,dt=st*st+at*at,ht=ut*ut+pt*pt,ft=Math.sqrt(dt),mt=Math.sqrt(lt),gt=nt*Math.tan((pi-Math.acos((dt+lt-ht)/(2*ft*mt)))/2),yt=gt/mt,vt=gt/ft;Math.abs(yt-1)>epsilon&&this._append`L${$+yt*ot},${_e+yt*ct}`,this._append`A${nt},${nt},0,0,${+(ct*ut>ot*pt)},${this._x1=$+vt*st},${this._y1=_e+vt*at}`}}arc($,_e,et,tt,nt,rt){if($=+$,_e=+_e,et=+et,rt=!!rt,et<0)throw new Error(`negative radius: ${et}`);let it=et*Math.cos(tt),st=et*Math.sin(tt),at=$+it,ot=_e+st,ct=1^rt,lt=rt?tt-nt:nt-tt;this._x1===null?this._append`M${at},${ot}`:(Math.abs(this._x1-at)>epsilon||Math.abs(this._y1-ot)>epsilon)&&this._append`L${at},${ot}`,et&&(lt<0&&(lt=lt%tau+tau),lt>tauEpsilon?this._append`A${et},${et},0,1,${ct},${$-it},${_e-st}A${et},${et},0,1,${ct},${this._x1=at},${this._y1=ot}`:lt>epsilon&&this._append`A${et},${et},0,${+(lt>=pi)},${ct},${this._x1=$+et*Math.cos(nt)},${this._y1=_e+et*Math.sin(nt)}`)}rect($,_e,et,tt){this._append`M${this._x0=this._x1=+$},${this._y0=this._y1=+_e}h${et=+et}v${+tt}h${-et}Z`}toString(){return this._}}function withPath(j){let $=3;return j.digits=function(_e){if(!arguments.length)return $;if(_e==null)$=null;else{const et=Math.floor(_e);if(!(et>=0))throw new RangeError(`invalid digits: ${_e}`);$=et}return j},()=>new Path($)}function array(j){return typeof j=="object"&&"length"in j?j:Array.from(j)}function Linear(j){this._context=j}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(j,$){switch(j=+j,$=+$,this._point){case 0:this._point=1,this._line?this._context.lineTo(j,$):this._context.moveTo(j,$);break;case 1:this._point=2;default:this._context.lineTo(j,$);break}}};function curveLinear(j){return new Linear(j)}function x(j){return j[0]}function y(j){return j[1]}function shapeLine(j,$){var _e=constant$1(!0),et=null,tt=curveLinear,nt=null,rt=withPath(it);j=typeof j=="function"?j:j===void 0?x:constant$1(j),$=typeof $=="function"?$:$===void 0?y:constant$1($);function it(st){var at,ot=(st=array(st)).length,ct,lt=!1,ut;for(et==null&&(nt=tt(ut=rt())),at=0;at<=ot;++at)!(at<ot&&_e(ct=st[at],at,st))===lt&&((lt=!lt)?nt.lineStart():nt.lineEnd()),lt&&nt.point(+j(ct,at,st),+$(ct,at,st));if(ut)return nt=null,ut+""||null}return it.x=function(st){return arguments.length?(j=typeof st=="function"?st:constant$1(+st),it):j},it.y=function(st){return arguments.length?($=typeof st=="function"?st:constant$1(+st),it):$},it.defined=function(st){return arguments.length?(_e=typeof st=="function"?st:constant$1(!!st),it):_e},it.curve=function(st){return arguments.length?(tt=st,et!=null&&(nt=tt(et)),it):tt},it.context=function(st){return arguments.length?(st==null?et=nt=null:nt=tt(et=st),it):et},it}function shapeArea(j,$,_e){var et=null,tt=constant$1(!0),nt=null,rt=curveLinear,it=null,st=withPath(at);j=typeof j=="function"?j:j===void 0?x:constant$1(+j),$=typeof $=="function"?$:constant$1($===void 0?0:+$),_e=typeof _e=="function"?_e:_e===void 0?y:constant$1(+_e);function at(ct){var lt,ut,pt,dt=(ct=array(ct)).length,ht,ft=!1,mt,gt=new Array(dt),yt=new Array(dt);for(nt==null&&(it=rt(mt=st())),lt=0;lt<=dt;++lt){if(!(lt<dt&&tt(ht=ct[lt],lt,ct))===ft)if(ft=!ft)ut=lt,it.areaStart(),it.lineStart();else{for(it.lineEnd(),it.lineStart(),pt=lt-1;pt>=ut;--pt)it.point(gt[pt],yt[pt]);it.lineEnd(),it.areaEnd()}ft&&(gt[lt]=+j(ht,lt,ct),yt[lt]=+$(ht,lt,ct),it.point(et?+et(ht,lt,ct):gt[lt],_e?+_e(ht,lt,ct):yt[lt]))}if(mt)return it=null,mt+""||null}function ot(){return shapeLine().defined(tt).curve(rt).context(nt)}return at.x=function(ct){return arguments.length?(j=typeof ct=="function"?ct:constant$1(+ct),et=null,at):j},at.x0=function(ct){return arguments.length?(j=typeof ct=="function"?ct:constant$1(+ct),at):j},at.x1=function(ct){return arguments.length?(et=ct==null?null:typeof ct=="function"?ct:constant$1(+ct),at):et},at.y=function(ct){return arguments.length?($=typeof ct=="function"?ct:constant$1(+ct),_e=null,at):$},at.y0=function(ct){return arguments.length?($=typeof ct=="function"?ct:constant$1(+ct),at):$},at.y1=function(ct){return arguments.length?(_e=ct==null?null:typeof ct=="function"?ct:constant$1(+ct),at):_e},at.lineX0=at.lineY0=function(){return ot().x(j).y($)},at.lineY1=function(){return ot().x(j).y(_e)},at.lineX1=function(){return ot().x(et).y($)},at.defined=function(ct){return arguments.length?(tt=typeof ct=="function"?ct:constant$1(!!ct),at):tt},at.curve=function(ct){return arguments.length?(rt=ct,nt!=null&&(it=rt(nt)),at):rt},at.context=function(ct){return arguments.length?(ct==null?nt=it=null:it=rt(nt=ct),at):nt},at}class Bump{constructor($,_e){this._context=$,this._x=_e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point($,_e){switch($=+$,_e=+_e,this._point){case 0:{this._point=1,this._line?this._context.lineTo($,_e):this._context.moveTo($,_e);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+$)/2,this._y0,this._x0,_e,$,_e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+_e)/2,$,this._y0,$,_e);break}}this._x0=$,this._y0=_e}}function bumpX(j){return new Bump(j,!0)}function bumpY(j){return new Bump(j,!1)}const symbolCircle={draw(j,$){const _e=sqrt$1($/pi$1);j.moveTo(_e,0),j.arc(0,0,_e,0,tau$1)}},symbolCross={draw(j,$){const _e=sqrt$1($/5)/2;j.moveTo(-3*_e,-_e),j.lineTo(-_e,-_e),j.lineTo(-_e,-3*_e),j.lineTo(_e,-3*_e),j.lineTo(_e,-_e),j.lineTo(3*_e,-_e),j.lineTo(3*_e,_e),j.lineTo(_e,_e),j.lineTo(_e,3*_e),j.lineTo(-_e,3*_e),j.lineTo(-_e,_e),j.lineTo(-3*_e,_e),j.closePath()}},tan30=sqrt$1(1/3),tan30_2=tan30*2,symbolDiamond={draw(j,$){const _e=sqrt$1($/tan30_2),et=_e*tan30;j.moveTo(0,-_e),j.lineTo(et,0),j.lineTo(0,_e),j.lineTo(-et,0),j.closePath()}},symbolSquare={draw(j,$){const _e=sqrt$1($),et=-_e/2;j.rect(et,et,_e,_e)}},ka=.8908130915292852,kr=sin(pi$1/10)/sin(7*pi$1/10),kx=sin(tau$1/10)*kr,ky=-cos(tau$1/10)*kr,symbolStar={draw(j,$){const _e=sqrt$1($*ka),et=kx*_e,tt=ky*_e;j.moveTo(0,-_e),j.lineTo(et,tt);for(let nt=1;nt<5;++nt){const rt=tau$1*nt/5,it=cos(rt),st=sin(rt);j.lineTo(st*_e,-it*_e),j.lineTo(it*et-st*tt,st*et+it*tt)}j.closePath()}},sqrt3=sqrt$1(3),symbolTriangle={draw(j,$){const _e=-sqrt$1($/(sqrt3*3));j.moveTo(0,_e*2),j.lineTo(-sqrt3*_e,-_e),j.lineTo(sqrt3*_e,-_e),j.closePath()}},c=-.5,s=sqrt$1(3)/2,k=1/sqrt$1(12),a=(k/2+1)*3,symbolWye={draw(j,$){const _e=sqrt$1($/a),et=_e/2,tt=_e*k,nt=et,rt=_e*k+_e,it=-nt,st=rt;j.moveTo(et,tt),j.lineTo(nt,rt),j.lineTo(it,st),j.lineTo(c*et-s*tt,s*et+c*tt),j.lineTo(c*nt-s*rt,s*nt+c*rt),j.lineTo(c*it-s*st,s*it+c*st),j.lineTo(c*et+s*tt,c*tt-s*et),j.lineTo(c*nt+s*rt,c*rt-s*nt),j.lineTo(c*it+s*st,c*st-s*it),j.closePath()}};function Symbol$1(j,$){let _e=null,et=withPath(tt);j=typeof j=="function"?j:constant$1(j||symbolCircle),$=typeof $=="function"?$:constant$1($===void 0?64:+$);function tt(){let nt;if(_e||(_e=nt=et()),j.apply(this,arguments).draw(_e,+$.apply(this,arguments)),nt)return _e=null,nt+""||null}return tt.type=function(nt){return arguments.length?(j=typeof nt=="function"?nt:constant$1(nt),tt):j},tt.size=function(nt){return arguments.length?($=typeof nt=="function"?nt:constant$1(+nt),tt):$},tt.context=function(nt){return arguments.length?(_e=nt??null,tt):_e},tt}function noop$3(){}function point$2(j,$,_e){j._context.bezierCurveTo((2*j._x0+j._x1)/3,(2*j._y0+j._y1)/3,(j._x0+2*j._x1)/3,(j._y0+2*j._y1)/3,(j._x0+4*j._x1+$)/6,(j._y0+4*j._y1+_e)/6)}function Basis(j){this._context=j}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(j,$){switch(j=+j,$=+$,this._point){case 0:this._point=1,this._line?this._context.lineTo(j,$):this._context.moveTo(j,$);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$2(this,j,$);break}this._x0=this._x1,this._x1=j,this._y0=this._y1,this._y1=$}};function curveBasis(j){return new Basis(j)}function BasisClosed(j){this._context=j}BasisClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(j,$){switch(j=+j,$=+$,this._point){case 0:this._point=1,this._x2=j,this._y2=$;break;case 1:this._point=2,this._x3=j,this._y3=$;break;case 2:this._point=3,this._x4=j,this._y4=$,this._context.moveTo((this._x0+4*this._x1+j)/6,(this._y0+4*this._y1+$)/6);break;default:point$2(this,j,$);break}this._x0=this._x1,this._x1=j,this._y0=this._y1,this._y1=$}};function curveBasisClosed(j){return new BasisClosed(j)}function BasisOpen(j){this._context=j}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(j,$){switch(j=+j,$=+$,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var _e=(this._x0+4*this._x1+j)/6,et=(this._y0+4*this._y1+$)/6;this._line?this._context.lineTo(_e,et):this._context.moveTo(_e,et);break;case 3:this._point=4;default:point$2(this,j,$);break}this._x0=this._x1,this._x1=j,this._y0=this._y1,this._y1=$}};function curveBasisOpen(j){return new BasisOpen(j)}function LinearClosed(j){this._context=j}LinearClosed.prototype={areaStart:noop$3,areaEnd:noop$3,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(j,$){j=+j,$=+$,this._point?this._context.lineTo(j,$):(this._point=1,this._context.moveTo(j,$))}};function curveLinearClosed(j){return new LinearClosed(j)}function sign(j){return j<0?-1:1}function slope3(j,$,_e){var et=j._x1-j._x0,tt=$-j._x1,nt=(j._y1-j._y0)/(et||tt<0&&-0),rt=(_e-j._y1)/(tt||et<0&&-0),it=(nt*tt+rt*et)/(et+tt);return(sign(nt)+sign(rt))*Math.min(Math.abs(nt),Math.abs(rt),.5*Math.abs(it))||0}function slope2(j,$){var _e=j._x1-j._x0;return _e?(3*(j._y1-j._y0)/_e-$)/2:$}function point$1(j,$,_e){var et=j._x0,tt=j._y0,nt=j._x1,rt=j._y1,it=(nt-et)/3;j._context.bezierCurveTo(et+it,tt+it*$,nt-it,rt-it*_e,nt,rt)}function MonotoneX(j){this._context=j}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$1(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(j,$){var _e=NaN;if(j=+j,$=+$,!(j===this._x1&&$===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(j,$):this._context.moveTo(j,$);break;case 1:this._point=2;break;case 2:this._point=3,point$1(this,slope2(this,_e=slope3(this,j,$)),_e);break;default:point$1(this,this._t0,_e=slope3(this,j,$));break}this._x0=this._x1,this._x1=j,this._y0=this._y1,this._y1=$,this._t0=_e}}};function MonotoneY(j){this._context=new ReflectContext(j)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(j,$){MonotoneX.prototype.point.call(this,$,j)};function ReflectContext(j){this._context=j}ReflectContext.prototype={moveTo:function(j,$){this._context.moveTo($,j)},closePath:function(){this._context.closePath()},lineTo:function(j,$){this._context.lineTo($,j)},bezierCurveTo:function(j,$,_e,et,tt,nt){this._context.bezierCurveTo($,j,et,_e,nt,tt)}};function monotoneX(j){return new MonotoneX(j)}function monotoneY(j){return new MonotoneY(j)}function Natural(j){this._context=j}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var j=this._x,$=this._y,_e=j.length;if(_e)if(this._line?this._context.lineTo(j[0],$[0]):this._context.moveTo(j[0],$[0]),_e===2)this._context.lineTo(j[1],$[1]);else for(var et=controlPoints(j),tt=controlPoints($),nt=0,rt=1;rt<_e;++nt,++rt)this._context.bezierCurveTo(et[0][nt],tt[0][nt],et[1][nt],tt[1][nt],j[rt],$[rt]);(this._line||this._line!==0&&_e===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(j,$){this._x.push(+j),this._y.push(+$)}};function controlPoints(j){var $,_e=j.length-1,et,tt=new Array(_e),nt=new Array(_e),rt=new Array(_e);for(tt[0]=0,nt[0]=2,rt[0]=j[0]+2*j[1],$=1;$<_e-1;++$)tt[$]=1,nt[$]=4,rt[$]=4*j[$]+2*j[$+1];for(tt[_e-1]=2,nt[_e-1]=7,rt[_e-1]=8*j[_e-1]+j[_e],$=1;$<_e;++$)et=tt[$]/nt[$-1],nt[$]-=et,rt[$]-=et*rt[$-1];for(tt[_e-1]=rt[_e-1]/nt[_e-1],$=_e-2;$>=0;--$)tt[$]=(rt[$]-tt[$+1])/nt[$];for(nt[_e-1]=(j[_e]+tt[_e-1])/2,$=0;$<_e-1;++$)nt[$]=2*j[$+1]-tt[$+1];return[tt,nt]}function curveNatural(j){return new Natural(j)}function Step(j,$){this._context=j,this._t=$}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(j,$){switch(j=+j,$=+$,this._point){case 0:this._point=1,this._line?this._context.lineTo(j,$):this._context.moveTo(j,$);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,$),this._context.lineTo(j,$);else{var _e=this._x*(1-this._t)+j*this._t;this._context.lineTo(_e,this._y),this._context.lineTo(_e,$)}break}}this._x=j,this._y=$}};function curveStep(j){return new Step(j,.5)}function stepBefore(j){return new Step(j,0)}function stepAfter(j){return new Step(j,1)}function stackOffsetNone(j,$){if((rt=j.length)>1)for(var _e=1,et,tt,nt=j[$[0]],rt,it=nt.length;_e<rt;++_e)for(tt=nt,nt=j[$[_e]],et=0;et<it;++et)nt[et][1]+=nt[et][0]=isNaN(tt[et][1])?tt[et][0]:tt[et][1]}function stackOrderNone(j){for(var $=j.length,_e=new Array($);--$>=0;)_e[$]=$;return _e}function stackValue(j,$){return j[$]}function stackSeries(j){const $=[];return $.key=j,$}function shapeStack(){var j=constant$1([]),$=stackOrderNone,_e=stackOffsetNone,et=stackValue;function tt(nt){var rt=Array.from(j.apply(this,arguments),stackSeries),it,st=rt.length,at=-1,ot;for(const ct of nt)for(it=0,++at;it<st;++it)(rt[it][at]=[0,+et(ct,rt[it].key,at,nt)]).data=ct;for(it=0,ot=array($(rt));it<st;++it)rt[ot[it]].index=it;return _e(rt,ot),rt}return tt.keys=function(nt){return arguments.length?(j=typeof nt=="function"?nt:constant$1(Array.from(nt)),tt):j},tt.value=function(nt){return arguments.length?(et=typeof nt=="function"?nt:constant$1(+nt),tt):et},tt.order=function(nt){return arguments.length?($=nt==null?stackOrderNone:typeof nt=="function"?nt:constant$1(Array.from(nt)),tt):$},tt.offset=function(nt){return arguments.length?(_e=nt??stackOffsetNone,tt):_e},tt}function stackOffsetExpand(j,$){if((et=j.length)>0){for(var _e,et,tt=0,nt=j[0].length,rt;tt<nt;++tt){for(rt=_e=0;_e<et;++_e)rt+=j[_e][tt][1]||0;if(rt)for(_e=0;_e<et;++_e)j[_e][tt][1]/=rt}stackOffsetNone(j,$)}}function stackOffsetSilhouette(j,$){if((tt=j.length)>0){for(var _e=0,et=j[$[0]],tt,nt=et.length;_e<nt;++_e){for(var rt=0,it=0;rt<tt;++rt)it+=j[rt][_e][1]||0;et[_e][1]+=et[_e][0]=-it/2}stackOffsetNone(j,$)}}function stackOffsetWiggle(j,$){if(!(!((rt=j.length)>0)||!((nt=(tt=j[$[0]]).length)>0))){for(var _e=0,et=1,tt,nt,rt;et<nt;++et){for(var it=0,st=0,at=0;it<rt;++it){for(var ot=j[$[it]],ct=ot[et][1]||0,lt=ot[et-1][1]||0,ut=(ct-lt)/2,pt=0;pt<it;++pt){var dt=j[$[pt]],ht=dt[et][1]||0,ft=dt[et-1][1]||0;ut+=ht-ft}st+=ct,at+=ut*ct}tt[et-1][1]+=tt[et-1][0]=_e,st&&(_e-=at/st)}tt[et-1][1]+=tt[et-1][0]=_e,stackOffsetNone(j,$)}}var get$3={},isUnsafeProperty={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e==="__proto__"}j.isUnsafeProperty=$})(isUnsafeProperty);var isDeepKey={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){switch(typeof _e){case"number":case"symbol":return!1;case"string":return _e.includes(".")||_e.includes("[")||_e.includes("]")}}j.isDeepKey=$})(isDeepKey);var toKey={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){var et;return typeof _e=="string"||typeof _e=="symbol"?_e:Object.is((et=_e==null?void 0:_e.valueOf)==null?void 0:et.call(_e),-0)?"-0":String(_e)}j.toKey=$})(toKey);var toPath={},toString$1={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){if(_e==null)return"";if(typeof _e=="string")return _e;if(Array.isArray(_e))return _e.map($).join(",");const et=String(_e);return et==="0"&&Object.is(Number(_e),-0)?"-0":et}j.toString=$})(toString$1);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=toString$1,_e=toKey;function et(tt){if(Array.isArray(tt))return tt.map(_e.toKey);if(typeof tt=="symbol")return[tt];tt=$.toString(tt);const nt=[],rt=tt.length;if(rt===0)return nt;let it=0,st="",at="",ot=!1;for(tt.charCodeAt(0)===46&&(nt.push(""),it++);it<rt;){const ct=tt[it];at?ct==="\\"&&it+1<rt?(it++,st+=tt[it]):ct===at?at="":st+=ct:ot?ct==='"'||ct==="'"?at=ct:ct==="]"?(ot=!1,nt.push(st),st=""):st+=ct:ct==="["?(ot=!0,st&&(nt.push(st),st="")):ct==="."?st&&(nt.push(st),st=""):st+=ct,it++}return st&&nt.push(st),nt}j.toPath=et})(toPath);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isUnsafeProperty,_e=isDeepKey,et=toKey,tt=toPath;function nt(it,st,at){if(it==null)return at;switch(typeof st){case"string":{if($.isUnsafeProperty(st))return at;const ot=it[st];return ot===void 0?_e.isDeepKey(st)?nt(it,tt.toPath(st),at):at:ot}case"number":case"symbol":{typeof st=="number"&&(st=et.toKey(st));const ot=it[st];return ot===void 0?at:ot}default:{if(Array.isArray(st))return rt(it,st,at);if(Object.is(st==null?void 0:st.valueOf(),-0)?st="-0":st=String(st),$.isUnsafeProperty(st))return at;const ot=it[st];return ot===void 0?at:ot}}}function rt(it,st,at){if(st.length===0)return at;let ot=it;for(let ct=0;ct<st.length;ct++){if(ot==null||$.isUnsafeProperty(st[ct]))return at;ot=ot[st[ct]]}return ot===void 0?at:ot}j.get=nt})(get$3);var get$1=get$3.get;const get$2=getDefaultExportFromCjs$1(get$1);var mathSign=j=>j===0?0:j>0?1:-1,isNan=j=>typeof j=="number"&&j!=+j,isPercent=j=>typeof j=="string"&&j.indexOf("%")===j.length-1,isNumber=j=>(typeof j=="number"||j instanceof Number)&&!isNan(j),isNumOrStr=j=>isNumber(j)||typeof j=="string",idCounter=0,uniqueId=j=>{var $=++idCounter;return"".concat(j||"").concat($)},getPercentValue=function j($,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!isNumber($)&&typeof $!="string")return et;var nt;if(isPercent($)){if(_e==null)return et;var rt=$.indexOf("%");nt=_e*parseFloat($.slice(0,rt))/100}else nt=+$;return isNan(nt)&&(nt=et),tt&&_e!=null&&nt>_e&&(nt=_e),nt},hasDuplicate=j=>{if(!Array.isArray(j))return!1;for(var $=j.length,_e={},et=0;et<$;et++)if(!_e[j[et]])_e[j[et]]=!0;else return!0;return!1};function interpolate$1(j,$,_e){return isNumber(j)&&isNumber($)?j+_e*($-j):$}function findEntryInArray(j,$,_e){if(!(!j||!j.length))return j.find(et=>et&&(typeof $=="function"?$(et):get$2(et,$))===_e)}var isNullish=j=>j===null||typeof j>"u",upperFirst=j=>isNullish(j)?j:"".concat(j.charAt(0).toUpperCase()).concat(j.slice(1));function isNotNil(j){return j!=null}function noop$2(){}var _excluded$i=["type","size","sizeType"];function _extends$m(){return _extends$m=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$m.apply(null,arguments)}function ownKeys$z(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$z(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$z(Object(_e),!0).forEach(function(et){_defineProperty$B(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$z(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$B(j,$,_e){return($=_toPropertyKey$B($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$B(j){var $=_toPrimitive$B(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$B(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _objectWithoutProperties$i(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$i(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$i(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var symbolFactories={symbolCircle,symbolCross,symbolDiamond,symbolSquare,symbolStar,symbolTriangle,symbolWye},RADIAN$1=Math.PI/180,getSymbolFactory=j=>{var $="symbol".concat(upperFirst(j));return symbolFactories[$]||symbolCircle},calculateAreaSize=(j,$,_e)=>{if($==="area")return j;switch(_e){case"cross":return 5*j*j/9;case"diamond":return .5*j*j/Math.sqrt(3);case"square":return j*j;case"star":{var et=18*RADIAN$1;return 1.25*j*j*(Math.tan(et)-Math.tan(et*2)*Math.tan(et)**2)}case"triangle":return Math.sqrt(3)*j*j/4;case"wye":return(21-10*Math.sqrt(3))*j*j/8;default:return Math.PI*j*j/4}},registerSymbol=(j,$)=>{symbolFactories["symbol".concat(upperFirst(j))]=$},Symbols=j=>{var{type:$="circle",size:_e=64,sizeType:et="area"}=j,tt=_objectWithoutProperties$i(j,_excluded$i),nt=_objectSpread$z(_objectSpread$z({},tt),{},{type:$,size:_e,sizeType:et}),rt="circle";typeof $=="string"&&(rt=$);var it=()=>{var lt=getSymbolFactory(rt),ut=Symbol$1().type(lt).size(calculateAreaSize(_e,et,rt)),pt=ut();if(pt!==null)return pt},{className:st,cx:at,cy:ot}=nt,ct=svgPropertiesAndEvents(nt);return isNumber(at)&&isNumber(ot)&&isNumber(_e)?reactExports.createElement("path",_extends$m({},ct,{className:clsx("recharts-symbols",st),transform:"translate(".concat(at,", ").concat(ot,")"),d:it()})):null};Symbols.registerSymbol=registerSymbol;var isPolarCoordinate=j=>"radius"in j&&"startAngle"in j&&"endAngle"in j,adaptEventHandlers=(j,$)=>{if(!j||typeof j=="function"||typeof j=="boolean")return null;var _e=j;if(reactExports.isValidElement(j)&&(_e=j.props),typeof _e!="object"&&typeof _e!="function")return null;var et={};return Object.keys(_e).forEach(tt=>{isEventKey(tt)&&(et[tt]=nt=>_e[tt](_e,nt))}),et},getEventHandlerOfChild=(j,$,_e)=>et=>(j($,_e,et),null),adaptEventsOfChild=(j,$,_e)=>{if(j===null||typeof j!="object"&&typeof j!="function")return null;var et=null;return Object.keys(j).forEach(tt=>{var nt=j[tt];isEventKey(tt)&&typeof nt=="function"&&(et||(et={}),et[tt]=getEventHandlerOfChild(nt,$,_e))}),et};function ownKeys$y(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$y(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$y(Object(_e),!0).forEach(function(et){_defineProperty$A(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$y(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$A(j,$,_e){return($=_toPropertyKey$A($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$A(j){var $=_toPrimitive$A(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$A(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function resolveDefaultProps(j,$){var _e=_objectSpread$y({},j),et=$,tt=Object.keys($),nt=tt.reduce((rt,it)=>(rt[it]===void 0&&et[it]!==void 0&&(rt[it]=et[it]),rt),_e);return nt}var uniqBy$3={},uniqBy$2={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e,et){const tt=new Map;for(let nt=0;nt<_e.length;nt++){const rt=_e[nt],it=et(rt);tt.has(it)||tt.set(it,rt)}return Array.from(tt.values())}j.uniqBy=$})(uniqBy$2);var identity$4={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e}j.identity=$})(identity$4);var isArrayLikeObject={},isArrayLike={},isLength={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return Number.isSafeInteger(_e)&&_e>=0}j.isLength=$})(isLength);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isLength;function _e(et){return et!=null&&typeof et!="function"&&$.isLength(et.length)}j.isArrayLike=_e})(isArrayLike);var isObjectLike={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return typeof _e=="object"&&_e!==null}j.isObjectLike=$})(isObjectLike);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isArrayLike,_e=isObjectLike;function et(tt){return _e.isObjectLike(tt)&&$.isArrayLike(tt)}j.isArrayLikeObject=et})(isArrayLikeObject);var iteratee={},property={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=get$3;function _e(et){return function(tt){return $.get(tt,et)}}j.property=_e})(property);var matches={},isMatch={},isMatchWith={},isObject={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e!==null&&(typeof _e=="object"||typeof _e=="function")}j.isObject=$})(isObject);var isPrimitive={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e==null||typeof _e!="object"&&typeof _e!="function"}j.isPrimitive=$})(isPrimitive);var eq={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e,et){return _e===et||Number.isNaN(_e)&&Number.isNaN(et)}j.eq=$})(eq);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isObject,_e=isPrimitive,et=eq;function tt(ot,ct,lt){return typeof lt!="function"?tt(ot,ct,()=>{}):nt(ot,ct,function ut(pt,dt,ht,ft,mt,gt){const yt=lt(pt,dt,ht,ft,mt,gt);return yt!==void 0?!!yt:nt(pt,dt,ut,gt)},new Map)}function nt(ot,ct,lt,ut){if(ct===ot)return!0;switch(typeof ct){case"object":return rt(ot,ct,lt,ut);case"function":return Object.keys(ct).length>0?nt(ot,{...ct},lt,ut):et.eq(ot,ct);default:return $.isObject(ot)?typeof ct=="string"?ct==="":!0:et.eq(ot,ct)}}function rt(ot,ct,lt,ut){if(ct==null)return!0;if(Array.isArray(ct))return st(ot,ct,lt,ut);if(ct instanceof Map)return it(ot,ct,lt,ut);if(ct instanceof Set)return at(ot,ct,lt,ut);const pt=Object.keys(ct);if(ot==null||_e.isPrimitive(ot))return pt.length===0;if(pt.length===0)return!0;if(ut!=null&&ut.has(ct))return ut.get(ct)===ot;ut==null||ut.set(ct,ot);try{for(let dt=0;dt<pt.length;dt++){const ht=pt[dt];if(!_e.isPrimitive(ot)&&!(ht in ot)||ct[ht]===void 0&&ot[ht]!==void 0||ct[ht]===null&&ot[ht]!==null||!lt(ot[ht],ct[ht],ht,ot,ct,ut))return!1}return!0}finally{ut==null||ut.delete(ct)}}function it(ot,ct,lt,ut){if(ct.size===0)return!0;if(!(ot instanceof Map))return!1;for(const[pt,dt]of ct.entries()){const ht=ot.get(pt);if(lt(ht,dt,pt,ot,ct,ut)===!1)return!1}return!0}function st(ot,ct,lt,ut){if(ct.length===0)return!0;if(!Array.isArray(ot))return!1;const pt=new Set;for(let dt=0;dt<ct.length;dt++){const ht=ct[dt];let ft=!1;for(let mt=0;mt<ot.length;mt++){if(pt.has(mt))continue;const gt=ot[mt];let yt=!1;if(lt(gt,ht,dt,ot,ct,ut)&&(yt=!0),yt){pt.add(mt),ft=!0;break}}if(!ft)return!1}return!0}function at(ot,ct,lt,ut){return ct.size===0?!0:ot instanceof Set?st([...ot],[...ct],lt,ut):!1}j.isMatchWith=tt,j.isSetMatch=at})(isMatchWith);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isMatchWith;function _e(et,tt){return $.isMatchWith(et,tt,()=>{})}j.isMatch=_e})(isMatch);var cloneDeep$1={},cloneDeepWith$1={},getSymbols={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return Object.getOwnPropertySymbols(_e).filter(et=>Object.prototype.propertyIsEnumerable.call(_e,et))}j.getSymbols=$})(getSymbols);var getTag={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e==null?_e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(_e)}j.getTag=$})(getTag);var tags={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $="[object RegExp]",_e="[object String]",et="[object Number]",tt="[object Boolean]",nt="[object Arguments]",rt="[object Symbol]",it="[object Date]",st="[object Map]",at="[object Set]",ot="[object Array]",ct="[object Function]",lt="[object ArrayBuffer]",ut="[object Object]",pt="[object Error]",dt="[object DataView]",ht="[object Uint8Array]",ft="[object Uint8ClampedArray]",mt="[object Uint16Array]",gt="[object Uint32Array]",yt="[object BigUint64Array]",vt="[object Int8Array]",xt="[object Int16Array]",St="[object Int32Array]",Et="[object BigInt64Array]",wt="[object Float32Array]",Tt="[object Float64Array]";j.argumentsTag=nt,j.arrayBufferTag=lt,j.arrayTag=ot,j.bigInt64ArrayTag=Et,j.bigUint64ArrayTag=yt,j.booleanTag=tt,j.dataViewTag=dt,j.dateTag=it,j.errorTag=pt,j.float32ArrayTag=wt,j.float64ArrayTag=Tt,j.functionTag=ct,j.int16ArrayTag=xt,j.int32ArrayTag=St,j.int8ArrayTag=vt,j.mapTag=st,j.numberTag=et,j.objectTag=ut,j.regexpTag=$,j.setTag=at,j.stringTag=_e,j.symbolTag=rt,j.uint16ArrayTag=mt,j.uint32ArrayTag=gt,j.uint8ArrayTag=ht,j.uint8ClampedArrayTag=ft})(tags);var isTypedArray={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return ArrayBuffer.isView(_e)&&!(_e instanceof DataView)}j.isTypedArray=$})(isTypedArray);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=getSymbols,_e=getTag,et=tags,tt=isPrimitive,nt=isTypedArray;function rt(ot,ct){return it(ot,void 0,ot,new Map,ct)}function it(ot,ct,lt,ut=new Map,pt=void 0){const dt=pt==null?void 0:pt(ot,ct,lt,ut);if(dt!==void 0)return dt;if(tt.isPrimitive(ot))return ot;if(ut.has(ot))return ut.get(ot);if(Array.isArray(ot)){const ht=new Array(ot.length);ut.set(ot,ht);for(let ft=0;ft<ot.length;ft++)ht[ft]=it(ot[ft],ft,lt,ut,pt);return Object.hasOwn(ot,"index")&&(ht.index=ot.index),Object.hasOwn(ot,"input")&&(ht.input=ot.input),ht}if(ot instanceof Date)return new Date(ot.getTime());if(ot instanceof RegExp){const ht=new RegExp(ot.source,ot.flags);return ht.lastIndex=ot.lastIndex,ht}if(ot instanceof Map){const ht=new Map;ut.set(ot,ht);for(const[ft,mt]of ot)ht.set(ft,it(mt,ft,lt,ut,pt));return ht}if(ot instanceof Set){const ht=new Set;ut.set(ot,ht);for(const ft of ot)ht.add(it(ft,void 0,lt,ut,pt));return ht}if(typeof Buffer<"u"&&Buffer.isBuffer(ot))return ot.subarray();if(nt.isTypedArray(ot)){const ht=new(Object.getPrototypeOf(ot)).constructor(ot.length);ut.set(ot,ht);for(let ft=0;ft<ot.length;ft++)ht[ft]=it(ot[ft],ft,lt,ut,pt);return ht}if(ot instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&ot instanceof SharedArrayBuffer)return ot.slice(0);if(ot instanceof DataView){const ht=new DataView(ot.buffer.slice(0),ot.byteOffset,ot.byteLength);return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(typeof File<"u"&&ot instanceof File){const ht=new File([ot],ot.name,{type:ot.type});return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(typeof Blob<"u"&&ot instanceof Blob){const ht=new Blob([ot],{type:ot.type});return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(ot instanceof Error){const ht=new ot.constructor;return ut.set(ot,ht),ht.message=ot.message,ht.name=ot.name,ht.stack=ot.stack,ht.cause=ot.cause,st(ht,ot,lt,ut,pt),ht}if(ot instanceof Boolean){const ht=new Boolean(ot.valueOf());return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(ot instanceof Number){const ht=new Number(ot.valueOf());return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(ot instanceof String){const ht=new String(ot.valueOf());return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}if(typeof ot=="object"&&at(ot)){const ht=Object.create(Object.getPrototypeOf(ot));return ut.set(ot,ht),st(ht,ot,lt,ut,pt),ht}return ot}function st(ot,ct,lt=ot,ut,pt){const dt=[...Object.keys(ct),...$.getSymbols(ct)];for(let ht=0;ht<dt.length;ht++){const ft=dt[ht],mt=Object.getOwnPropertyDescriptor(ot,ft);(mt==null||mt.writable)&&(ot[ft]=it(ct[ft],ft,lt,ut,pt))}}function at(ot){switch(_e.getTag(ot)){case et.argumentsTag:case et.arrayTag:case et.arrayBufferTag:case et.dataViewTag:case et.booleanTag:case et.dateTag:case et.float32ArrayTag:case et.float64ArrayTag:case et.int8ArrayTag:case et.int16ArrayTag:case et.int32ArrayTag:case et.mapTag:case et.numberTag:case et.objectTag:case et.regexpTag:case et.setTag:case et.stringTag:case et.symbolTag:case et.uint8ArrayTag:case et.uint8ClampedArrayTag:case et.uint16ArrayTag:case et.uint32ArrayTag:return!0;default:return!1}}j.cloneDeepWith=rt,j.cloneDeepWithImpl=it,j.copyProperties=st})(cloneDeepWith$1);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=cloneDeepWith$1;function _e(et){return $.cloneDeepWithImpl(et,void 0,et,new Map,void 0)}j.cloneDeep=_e})(cloneDeep$1);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isMatch,_e=cloneDeep$1;function et(tt){return tt=_e.cloneDeep(tt),nt=>$.isMatch(nt,tt)}j.matches=et})(matches);var matchesProperty={},cloneDeep={},cloneDeepWith={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=cloneDeepWith$1,_e=tags;function et(tt,nt){return $.cloneDeepWith(tt,(rt,it,st,at)=>{const ot=nt==null?void 0:nt(rt,it,st,at);if(ot!==void 0)return ot;if(typeof tt=="object")switch(Object.prototype.toString.call(tt)){case _e.numberTag:case _e.stringTag:case _e.booleanTag:{const ct=new tt.constructor(tt==null?void 0:tt.valueOf());return $.copyProperties(ct,tt),ct}case _e.argumentsTag:{const ct={};return $.copyProperties(ct,tt),ct.length=tt.length,ct[Symbol.iterator]=tt[Symbol.iterator],ct}default:return}})}j.cloneDeepWith=et})(cloneDeepWith);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=cloneDeepWith;function _e(et){return $.cloneDeepWith(et)}j.cloneDeep=_e})(cloneDeep);var has$2={},isIndex={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=/^(?:0|[1-9]\d*)$/;function _e(et,tt=Number.MAX_SAFE_INTEGER){switch(typeof et){case"number":return Number.isInteger(et)&&et>=0&&et<tt;case"symbol":return!1;case"string":return $.test(et)}}j.isIndex=_e})(isIndex);var isArguments={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=getTag;function _e(et){return et!==null&&typeof et=="object"&&$.getTag(et)==="[object Arguments]"}j.isArguments=_e})(isArguments);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isDeepKey,_e=isIndex,et=isArguments,tt=toPath;function nt(rt,it){let st;if(Array.isArray(it)?st=it:typeof it=="string"&&$.isDeepKey(it)&&(rt==null?void 0:rt[it])==null?st=tt.toPath(it):st=[it],st.length===0)return!1;let at=rt;for(let ot=0;ot<st.length;ot++){const ct=st[ot];if((at==null||!Object.hasOwn(at,ct))&&!((Array.isArray(at)||et.isArguments(at))&&_e.isIndex(ct)&&ct<at.length))return!1;at=at[ct]}return!0}j.has=nt})(has$2);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isMatch,_e=toKey,et=cloneDeep,tt=get$3,nt=has$2;function rt(it,st){switch(typeof it){case"object":{Object.is(it==null?void 0:it.valueOf(),-0)&&(it="-0");break}case"number":{it=_e.toKey(it);break}}return st=et.cloneDeep(st),function(at){const ot=tt.get(at,it);return ot===void 0?nt.has(at,it):st===void 0?ot===void 0:$.isMatch(ot,st)}}j.matchesProperty=rt})(matchesProperty);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=identity$4,_e=property,et=matches,tt=matchesProperty;function nt(rt){if(rt==null)return $.identity;switch(typeof rt){case"function":return rt;case"object":return Array.isArray(rt)&&rt.length===2?tt.matchesProperty(rt[0],rt[1]):et.matches(rt);case"string":case"symbol":case"number":return _e.property(rt)}}j.iteratee=nt})(iteratee);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=uniqBy$2,_e=identity$4,et=isArrayLikeObject,tt=iteratee;function nt(rt,it=_e.identity){return et.isArrayLikeObject(rt)?$.uniqBy(Array.from(rt),tt.iteratee(it)):[]}j.uniqBy=nt})(uniqBy$3);var uniqBy=uniqBy$3.uniqBy;const uniqBy$1=getDefaultExportFromCjs$1(uniqBy);function getUniqPayload(j,$,_e){return $===!0?uniqBy$1(j,_e):typeof $=="function"?uniqBy$1(j,$):j}var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$2=reactExports;function is$5(j,$){return j===$&&(j!==0||1/j===1/$)||j!==j&&$!==$}var objectIs$2=typeof Object.is=="function"?Object.is:is$5,useState=React$2.useState,useEffect$2=React$2.useEffect,useLayoutEffect=React$2.useLayoutEffect,useDebugValue$2=React$2.useDebugValue;function useSyncExternalStore$2(j,$){var _e=$(),et=useState({inst:{value:_e,getSnapshot:$}}),tt=et[0].inst,nt=et[1];return useLayoutEffect(function(){tt.value=_e,tt.getSnapshot=$,checkIfSnapshotChanged(tt)&&nt({inst:tt})},[j,_e,$]),useEffect$2(function(){return checkIfSnapshotChanged(tt)&&nt({inst:tt}),j(function(){checkIfSnapshotChanged(tt)&&nt({inst:tt})})},[j]),useDebugValue$2(_e),_e}function checkIfSnapshotChanged(j){var $=j.getSnapshot;j=j.value;try{var _e=$();return!objectIs$2(j,_e)}catch{return!0}}function useSyncExternalStore$1$1(j,$){return $()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$2.useSyncExternalStore!==void 0?React$2.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports,shim=shimExports;function is$4(j,$){return j===$&&(j!==0||1/j===1/$)||j!==j&&$!==$}var objectIs$1=typeof Object.is=="function"?Object.is:is$4,useSyncExternalStore$1=shim.useSyncExternalStore,useRef$1=React$1.useRef,useEffect$1=React$1.useEffect,useMemo$1=React$1.useMemo,useDebugValue$1=React$1.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(j,$,_e,et,tt){var nt=useRef$1(null);if(nt.current===null){var rt={hasValue:!1,value:null};nt.current=rt}else rt=nt.current;nt=useMemo$1(function(){function st(ut){if(!at){if(at=!0,ot=ut,ut=et(ut),tt!==void 0&&rt.hasValue){var pt=rt.value;if(tt(pt,ut))return ct=pt}return ct=ut}if(pt=ct,objectIs$1(ot,ut))return pt;var dt=et(ut);return tt!==void 0&&tt(pt,dt)?(ot=ut,pt):(ot=ut,ct=dt)}var at=!1,ot,ct,lt=_e===void 0?null:_e;return[function(){return st($())},lt===null?void 0:function(){return st(lt())}]},[$,_e,et,tt]);var it=useSyncExternalStore$1(j,nt[0],nt[1]);return useEffect$1(function(){rt.hasValue=!0,rt.value=it},[it]),useDebugValue$1(it),it};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports,RechartsReduxContext=reactExports.createContext(null),noopDispatch=j=>j,useAppDispatch=()=>{var j=reactExports.useContext(RechartsReduxContext);return j?j.store.dispatch:noopDispatch},noop$1=()=>{},addNestedSubNoop=()=>noop$1,refEquality=(j,$)=>j===$;function useAppSelector(j){var $=reactExports.useContext(RechartsReduxContext);return withSelectorExports.useSyncExternalStoreWithSelector($?$.subscription.addNestedSub:addNestedSubNoop,$?$.store.getState:noop$1,$?$.store.getState:noop$1,$?j:noop$1,refEquality)}function assertIsFunction(j,$=`expected a function, instead received ${typeof j}`){if(typeof j!="function")throw new TypeError($)}function assertIsObject(j,$=`expected an object, instead received ${typeof j}`){if(typeof j!="object")throw new TypeError($)}function assertIsArrayOfFunctions(j,$="expected all items to be functions, instead received the following types: "){if(!j.every(_e=>typeof _e=="function")){const _e=j.map(et=>typeof et=="function"?`function ${et.name||"unnamed"}()`:typeof et).join(", ");throw new TypeError(`${$}[${_e}]`)}}var ensureIsArray=j=>Array.isArray(j)?j:[j];function getDependencies(j){const $=Array.isArray(j[0])?j[0]:j;return assertIsArrayOfFunctions($,"createSelector expects all input-selectors to be functions, but received the following types: "),$}function collectInputSelectorResults(j,$){const _e=[],{length:et}=j;for(let tt=0;tt<et;tt++)_e.push(j[tt].apply(null,$));return _e}var StrongRef=class{constructor(j){this.value=j}deref(){return this.value}},Ref=typeof WeakRef<"u"?WeakRef:StrongRef,UNTERMINATED=0,TERMINATED=1;function createCacheNode(){return{s:UNTERMINATED,v:void 0,o:null,p:null}}function weakMapMemoize(j,$={}){let _e=createCacheNode();const{resultEqualityCheck:et}=$;let tt,nt=0;function rt(){var ct;let it=_e;const{length:st}=arguments;for(let lt=0,ut=st;lt<ut;lt++){const pt=arguments[lt];if(typeof pt=="function"||typeof pt=="object"&&pt!==null){let dt=it.o;dt===null&&(it.o=dt=new WeakMap);const ht=dt.get(pt);ht===void 0?(it=createCacheNode(),dt.set(pt,it)):it=ht}else{let dt=it.p;dt===null&&(it.p=dt=new Map);const ht=dt.get(pt);ht===void 0?(it=createCacheNode(),dt.set(pt,it)):it=ht}}const at=it;let ot;if(it.s===TERMINATED)ot=it.v;else if(ot=j.apply(null,arguments),nt++,et){const lt=((ct=tt==null?void 0:tt.deref)==null?void 0:ct.call(tt))??tt;lt!=null&&et(lt,ot)&&(ot=lt,nt!==0&&nt--),tt=typeof ot=="object"&&ot!==null||typeof ot=="function"?new Ref(ot):ot}return at.s=TERMINATED,at.v=ot,ot}return rt.clearCache=()=>{_e=createCacheNode(),rt.resetResultsCount()},rt.resultsCount=()=>nt,rt.resetResultsCount=()=>{nt=0},rt}function createSelectorCreator(j,...$){const _e=typeof j=="function"?{memoize:j,memoizeOptions:$}:j,et=(...tt)=>{let nt=0,rt=0,it,st={},at=tt.pop();typeof at=="object"&&(st=at,at=tt.pop()),assertIsFunction(at,`createSelector expects an output function after the inputs, but received: [${typeof at}]`);const ot={..._e,...st},{memoize:ct,memoizeOptions:lt=[],argsMemoize:ut=weakMapMemoize,argsMemoizeOptions:pt=[]}=ot,dt=ensureIsArray(lt),ht=ensureIsArray(pt),ft=getDependencies(tt),mt=ct(function(){return nt++,at.apply(null,arguments)},...dt),gt=ut(function(){rt++;const vt=collectInputSelectorResults(ft,arguments);return it=mt.apply(null,vt),it},...ht);return Object.assign(gt,{resultFunc:at,memoizedResultFunc:mt,dependencies:ft,dependencyRecomputations:()=>rt,resetDependencyRecomputations:()=>{rt=0},lastResult:()=>it,recomputations:()=>nt,resetRecomputations:()=>{nt=0},memoize:ct,argsMemoize:ut})};return Object.assign(et,{withTypes:()=>et}),et}var createSelector=createSelectorCreator(weakMapMemoize),createStructuredSelector=Object.assign((j,$=createSelector)=>{assertIsObject(j,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof j}`);const _e=Object.keys(j),et=_e.map(nt=>j[nt]);return $(et,(...nt)=>nt.reduce((rt,it,st)=>(rt[_e[st]]=it,rt),{}))},{withTypes:()=>createStructuredSelector}),sortBy$2={},orderBy={},compareValues={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(et){return typeof et=="symbol"?1:et===null?2:et===void 0?3:et!==et?4:0}const _e=(et,tt,nt)=>{if(et!==tt){const rt=$(et),it=$(tt);if(rt===it&&rt===0){if(et<tt)return nt==="desc"?1:-1;if(et>tt)return nt==="desc"?-1:1}return nt==="desc"?it-rt:rt-it}return 0};j.compareValues=_e})(compareValues);var isKey={},isSymbol={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return typeof _e=="symbol"||_e instanceof Symbol}j.isSymbol=$})(isSymbol);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isSymbol,_e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,et=/^\w*$/;function tt(nt,rt){return Array.isArray(nt)?!1:typeof nt=="number"||typeof nt=="boolean"||nt==null||$.isSymbol(nt)?!0:typeof nt=="string"&&(et.test(nt)||!_e.test(nt))||rt!=null&&Object.hasOwn(rt,nt)}j.isKey=tt})(isKey);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=compareValues,_e=isKey,et=toPath;function tt(nt,rt,it,st){if(nt==null)return[];it=st?void 0:it,Array.isArray(nt)||(nt=Object.values(nt)),Array.isArray(rt)||(rt=rt==null?[null]:[rt]),rt.length===0&&(rt=[null]),Array.isArray(it)||(it=it==null?[]:[it]),it=it.map(ut=>String(ut));const at=(ut,pt)=>{let dt=ut;for(let ht=0;ht<pt.length&&dt!=null;++ht)dt=dt[pt[ht]];return dt},ot=(ut,pt)=>pt==null||ut==null?pt:typeof ut=="object"&&"key"in ut?Object.hasOwn(pt,ut.key)?pt[ut.key]:at(pt,ut.path):typeof ut=="function"?ut(pt):Array.isArray(ut)?at(pt,ut):typeof pt=="object"?pt[ut]:pt,ct=rt.map(ut=>(Array.isArray(ut)&&ut.length===1&&(ut=ut[0]),ut==null||typeof ut=="function"||Array.isArray(ut)||_e.isKey(ut)?ut:{key:ut,path:et.toPath(ut)}));return nt.map(ut=>({original:ut,criteria:ct.map(pt=>ot(pt,ut))})).slice().sort((ut,pt)=>{for(let dt=0;dt<ct.length;dt++){const ht=$.compareValues(ut.criteria[dt],pt.criteria[dt],it[dt]);if(ht!==0)return ht}return 0}).map(ut=>ut.original)}j.orderBy=tt})(orderBy);var flatten={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e,et=1){const tt=[],nt=Math.floor(et),rt=(it,st)=>{for(let at=0;at<it.length;at++){const ot=it[at];Array.isArray(ot)&&st<nt?rt(ot,st+1):tt.push(ot)}};return rt(_e,0),tt}j.flatten=$})(flatten);var isIterateeCall={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isIndex,_e=isArrayLike,et=isObject,tt=eq;function nt(rt,it,st){return et.isObject(st)&&(typeof it=="number"&&_e.isArrayLike(st)&&$.isIndex(it)&&it<st.length||typeof it=="string"&&it in st)?tt.eq(st[it],rt):!1}j.isIterateeCall=nt})(isIterateeCall);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=orderBy,_e=flatten,et=isIterateeCall;function tt(nt,...rt){const it=rt.length;return it>1&&et.isIterateeCall(nt,rt[0],rt[1])?rt=[]:it>2&&et.isIterateeCall(rt[0],rt[1],rt[2])&&(rt=[rt[0]]),$.orderBy(nt,_e.flatten(rt),["asc"])}j.sortBy=tt})(sortBy$2);var sortBy=sortBy$2.sortBy;const sortBy$1=getDefaultExportFromCjs$1(sortBy);var selectLegendSettings=j=>j.legend.settings,selectLegendSize=j=>j.legend.size,selectAllLegendPayload2DArray=j=>j.legend.payload;createSelector([selectAllLegendPayload2DArray,selectLegendSettings],(j,$)=>{var{itemSorter:_e}=$,et=j.flat(1);return _e?sortBy$1(et,_e):et});var EPS$1=1;function useElementOffset(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[$,_e]=reactExports.useState({height:0,left:0,top:0,width:0}),et=reactExports.useCallback(tt=>{if(tt!=null){var nt=tt.getBoundingClientRect(),rt={height:nt.height,left:nt.left,top:nt.top,width:nt.width};(Math.abs(rt.height-$.height)>EPS$1||Math.abs(rt.left-$.left)>EPS$1||Math.abs(rt.top-$.top)>EPS$1||Math.abs(rt.width-$.width)>EPS$1)&&_e({height:rt.height,left:rt.left,top:rt.top,width:rt.width})}},[$.width,$.height,$.top,$.left,...j]);return[$,et]}function formatProdErrorMessage$1(j){return`Minified Redux error #${j}; visit https://redux.js.org/Errors?code=${j} for the full message or use the non-minified dev environment for full errors. `}var $$observable=typeof Symbol=="function"&&Symbol.observable||"@@observable",symbol_observable_default=$$observable,randomString=()=>Math.random().toString(36).substring(7).split("").join("."),ActionTypes={INIT:`@@redux/INIT${randomString()}`,REPLACE:`@@redux/REPLACE${randomString()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${randomString()}`},actionTypes_default=ActionTypes;function isPlainObject$5(j){if(typeof j!="object"||j===null)return!1;let $=j;for(;Object.getPrototypeOf($)!==null;)$=Object.getPrototypeOf($);return Object.getPrototypeOf(j)===$||Object.getPrototypeOf(j)===null}function createStore(j,$,_e){if(typeof j!="function")throw new Error(formatProdErrorMessage$1(2));if(typeof $=="function"&&typeof _e=="function"||typeof _e=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage$1(0));if(typeof $=="function"&&typeof _e>"u"&&(_e=$,$=void 0),typeof _e<"u"){if(typeof _e!="function")throw new Error(formatProdErrorMessage$1(1));return _e(createStore)(j,$)}let et=j,tt=$,nt=new Map,rt=nt,it=0,st=!1;function at(){rt===nt&&(rt=new Map,nt.forEach((ht,ft)=>{rt.set(ft,ht)}))}function ot(){if(st)throw new Error(formatProdErrorMessage$1(3));return tt}function ct(ht){if(typeof ht!="function")throw new Error(formatProdErrorMessage$1(4));if(st)throw new Error(formatProdErrorMessage$1(5));let ft=!0;at();const mt=it++;return rt.set(mt,ht),function(){if(ft){if(st)throw new Error(formatProdErrorMessage$1(6));ft=!1,at(),rt.delete(mt),nt=null}}}function lt(ht){if(!isPlainObject$5(ht))throw new Error(formatProdErrorMessage$1(7));if(typeof ht.type>"u")throw new Error(formatProdErrorMessage$1(8));if(typeof ht.type!="string")throw new Error(formatProdErrorMessage$1(17));if(st)throw new Error(formatProdErrorMessage$1(9));try{st=!0,tt=et(tt,ht)}finally{st=!1}return(nt=rt).forEach(mt=>{mt()}),ht}function ut(ht){if(typeof ht!="function")throw new Error(formatProdErrorMessage$1(10));et=ht,lt({type:actionTypes_default.REPLACE})}function pt(){const ht=ct;return{subscribe(ft){if(typeof ft!="object"||ft===null)throw new Error(formatProdErrorMessage$1(11));function mt(){const yt=ft;yt.next&&yt.next(ot())}return mt(),{unsubscribe:ht(mt)}},[symbol_observable_default](){return this}}}return lt({type:actionTypes_default.INIT}),{dispatch:lt,subscribe:ct,getState:ot,replaceReducer:ut,[symbol_observable_default]:pt}}function assertReducerShape(j){Object.keys(j).forEach($=>{const _e=j[$];if(typeof _e(void 0,{type:actionTypes_default.INIT})>"u")throw new Error(formatProdErrorMessage$1(12));if(typeof _e(void 0,{type:actionTypes_default.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(formatProdErrorMessage$1(13))})}function combineReducers(j){const $=Object.keys(j),_e={};for(let nt=0;nt<$.length;nt++){const rt=$[nt];typeof j[rt]=="function"&&(_e[rt]=j[rt])}const et=Object.keys(_e);let tt;try{assertReducerShape(_e)}catch(nt){tt=nt}return function(rt={},it){if(tt)throw tt;let st=!1;const at={};for(let ot=0;ot<et.length;ot++){const ct=et[ot],lt=_e[ct],ut=rt[ct],pt=lt(ut,it);if(typeof pt>"u")throw it&&it.type,new Error(formatProdErrorMessage$1(14));at[ct]=pt,st=st||pt!==ut}return st=st||et.length!==Object.keys(rt).length,st?at:rt}}function compose$1(...j){return j.length===0?$=>$:j.length===1?j[0]:j.reduce(($,_e)=>(...et)=>$(_e(...et)))}function applyMiddleware(...j){return $=>(_e,et)=>{const tt=$(_e,et);let nt=()=>{throw new Error(formatProdErrorMessage$1(15))};const rt={getState:tt.getState,dispatch:(st,...at)=>nt(st,...at)},it=j.map(st=>st(rt));return nt=compose$1(...it)(tt.dispatch),{...tt,dispatch:nt}}}function isAction(j){return isPlainObject$5(j)&&"type"in j&&typeof j.type=="string"}var NOTHING$1=Symbol.for("immer-nothing"),DRAFTABLE$1=Symbol.for("immer-draftable"),DRAFT_STATE$1=Symbol.for("immer-state");function die$1(j,...$){throw new Error(`[Immer] minified error nr: ${j}. Full error at: https://bit.ly/3cXEKWf`)}var O=Object,getPrototypeOf$1=O.getPrototypeOf,CONSTRUCTOR="constructor",PROTOTYPE="prototype",CONFIGURABLE="configurable",ENUMERABLE="enumerable",WRITABLE="writable",VALUE="value",isDraft$1=j=>!!j&&!!j[DRAFT_STATE$1];function isDraftable$1(j){var $;return j?isPlainObject$4(j)||isArray(j)||!!j[DRAFTABLE$1]||!!(($=j[CONSTRUCTOR])!=null&&$[DRAFTABLE$1])||isMap$1(j)||isSet$1(j):!1}var objectCtorString$1=O[PROTOTYPE][CONSTRUCTOR].toString(),cachedCtorStrings$1=new WeakMap;function isPlainObject$4(j){if(!j||!isObjectish(j))return!1;const $=getPrototypeOf$1(j);if($===null||$===O[PROTOTYPE])return!0;const _e=O.hasOwnProperty.call($,CONSTRUCTOR)&&$[CONSTRUCTOR];if(_e===Object)return!0;if(!isFunction$1(_e))return!1;let et=cachedCtorStrings$1.get(_e);return et===void 0&&(et=Function.toString.call(_e),cachedCtorStrings$1.set(_e,et)),et===objectCtorString$1}function each$1(j,$,_e=!0){getArchtype$1(j)===0?(_e?Reflect.ownKeys(j):O.keys(j)).forEach(tt=>{$(tt,j[tt],j)}):j.forEach((et,tt)=>$(tt,et,j))}function getArchtype$1(j){const $=j[DRAFT_STATE$1];return $?$.type_:isArray(j)?1:isMap$1(j)?2:isSet$1(j)?3:0}var has$1=(j,$,_e=getArchtype$1(j))=>_e===2?j.has($):O[PROTOTYPE].hasOwnProperty.call(j,$),get=(j,$,_e=getArchtype$1(j))=>_e===2?j.get($):j[$],set$1=(j,$,_e,et=getArchtype$1(j))=>{et===2?j.set($,_e):et===3?j.add(_e):j[$]=_e};function is$3(j,$){return j===$?j!==0||1/j===1/$:j!==j&&$!==$}var isArray=Array.isArray,isMap$1=j=>j instanceof Map,isSet$1=j=>j instanceof Set,isObjectish=j=>typeof j=="object",isFunction$1=j=>typeof j=="function",isBoolean$1=j=>typeof j=="boolean",latest$1=j=>j.copy_||j.base_,getFinalValue=j=>j.modified_?j.copy_:j.base_;function shallowCopy$1(j,$){if(isMap$1(j))return new Map(j);if(isSet$1(j))return new Set(j);if(isArray(j))return Array[PROTOTYPE].slice.call(j);const _e=isPlainObject$4(j);if($===!0||$==="class_only"&&!_e){const et=O.getOwnPropertyDescriptors(j);delete et[DRAFT_STATE$1];let tt=Reflect.ownKeys(et);for(let nt=0;nt<tt.length;nt++){const rt=tt[nt],it=et[rt];it[WRITABLE]===!1&&(it[WRITABLE]=!0,it[CONFIGURABLE]=!0),(it.get||it.set)&&(et[rt]={[CONFIGURABLE]:!0,[WRITABLE]:!0,[ENUMERABLE]:it[ENUMERABLE],[VALUE]:j[rt]})}return O.create(getPrototypeOf$1(j),et)}else{const et=getPrototypeOf$1(j);if(et!==null&&_e)return{...j};const tt=O.create(et);return O.assign(tt,j)}}function freeze$1(j,$=!1){return isFrozen$1(j)||isDraft$1(j)||!isDraftable$1(j)||(getArchtype$1(j)>1&&O.defineProperties(j,{set:dontMutateMethodOverride$1,add:dontMutateMethodOverride$1,clear:dontMutateMethodOverride$1,delete:dontMutateMethodOverride$1}),O.freeze(j),$&&each$1(j,(_e,et)=>{freeze$1(et,!0)},!1)),j}function dontMutateFrozenCollections$1(){die$1(2)}var dontMutateMethodOverride$1={[VALUE]:dontMutateFrozenCollections$1};function isFrozen$1(j){return j===null||!isObjectish(j)?!0:O.isFrozen(j)}var PluginMapSet="MapSet",PluginPatches="Patches",plugins$1={};function getPlugin$1(j){const $=plugins$1[j];return $||die$1(0,j),$}var isPluginLoaded=j=>!!plugins$1[j],currentScope$1,getCurrentScope$1=()=>currentScope$1,createScope$1=(j,$)=>({drafts_:[],parent_:j,immer_:$,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:isPluginLoaded(PluginMapSet)?getPlugin$1(PluginMapSet):void 0});function usePatchesInScope$1(j,$){$&&(j.patchPlugin_=getPlugin$1(PluginPatches),j.patches_=[],j.inversePatches_=[],j.patchListener_=$)}function revokeScope$1(j){leaveScope$1(j),j.drafts_.forEach(revokeDraft$1),j.drafts_=null}function leaveScope$1(j){j===currentScope$1&&(currentScope$1=j.parent_)}var enterScope$1=j=>currentScope$1=createScope$1(currentScope$1,j);function revokeDraft$1(j){const $=j[DRAFT_STATE$1];$.type_===0||$.type_===1?$.revoke_():$.revoked_=!0}function processResult$1(j,$){$.unfinalizedDrafts_=$.drafts_.length;const _e=$.drafts_[0];if(j!==void 0&&j!==_e){_e[DRAFT_STATE$1].modified_&&(revokeScope$1($),die$1(4)),isDraftable$1(j)&&(j=finalize$1($,j));const{patchPlugin_:tt}=$;tt&&tt.generateReplacementPatches_(_e[DRAFT_STATE$1].base_,j,$)}else j=finalize$1($,_e);return maybeFreeze$1($,j,!0),revokeScope$1($),$.patches_&&$.patchListener_($.patches_,$.inversePatches_),j!==NOTHING$1?j:void 0}function finalize$1(j,$){if(isFrozen$1($))return $;const _e=$[DRAFT_STATE$1];if(!_e)return handleValue($,j.handledSet_,j);if(!isSameScope(_e,j))return $;if(!_e.modified_)return _e.base_;if(!_e.finalized_){const{callbacks_:et}=_e;if(et)for(;et.length>0;)et.pop()(j);generatePatchesAndFinalize(_e,j)}return _e.copy_}function maybeFreeze$1(j,$,_e=!1){!j.parent_&&j.immer_.autoFreeze_&&j.canAutoFreeze_&&freeze$1($,_e)}function markStateFinalized(j){j.finalized_=!0,j.scope_.unfinalizedDrafts_--}var isSameScope=(j,$)=>j.scope_===$,EMPTY_LOCATIONS_RESULT=[];function updateDraftInParent(j,$,_e,et){const tt=latest$1(j),nt=j.type_;if(et!==void 0&&get(tt,et,nt)===$){set$1(tt,et,_e,nt);return}if(!j.draftLocations_){const it=j.draftLocations_=new Map;each$1(tt,(st,at)=>{if(isDraft$1(at)){const ot=it.get(at)||[];ot.push(st),it.set(at,ot)}})}const rt=j.draftLocations_.get($)??EMPTY_LOCATIONS_RESULT;for(const it of rt)set$1(tt,it,_e,nt)}function registerChildFinalizationCallback(j,$,_e){j.callbacks_.push(function(tt){var it;const nt=$;if(!nt||!isSameScope(nt,tt))return;(it=tt.mapSetPlugin_)==null||it.fixSetContents(nt);const rt=getFinalValue(nt);updateDraftInParent(j,nt.draft_??nt,rt,_e),generatePatchesAndFinalize(nt,tt)})}function generatePatchesAndFinalize(j,$){var et;if(j.modified_&&!j.finalized_&&(j.type_===3||(((et=j.assigned_)==null?void 0:et.size)??0)>0)){const{patchPlugin_:tt}=$;if(tt){const nt=tt.getPath(j);nt&&tt.generatePatches_(j,nt,$)}markStateFinalized(j)}}function handleCrossReference(j,$,_e){const{scope_:et}=j;if(isDraft$1(_e)){const tt=_e[DRAFT_STATE$1];isSameScope(tt,et)&&tt.callbacks_.push(function(){prepareCopy$1(j);const rt=getFinalValue(tt);updateDraftInParent(j,_e,rt,$)})}else isDraftable$1(_e)&&j.callbacks_.push(function(){const nt=latest$1(j);get(nt,$,j.type_)===_e&&et.drafts_.length>1&&(j.assigned_.get($)??!1)===!0&&j.copy_&&handleValue(get(j.copy_,$,j.type_),et.handledSet_,et)})}function handleValue(j,$,_e){return!_e.immer_.autoFreeze_&&_e.unfinalizedDrafts_<1||isDraft$1(j)||$.has(j)||!isDraftable$1(j)||isFrozen$1(j)||($.add(j),each$1(j,(et,tt)=>{if(isDraft$1(tt)){const nt=tt[DRAFT_STATE$1];if(isSameScope(nt,_e)){const rt=getFinalValue(nt);set$1(j,et,rt,j.type_),markStateFinalized(nt)}}else isDraftable$1(tt)&&handleValue(tt,$,_e)})),j}function createProxyProxy$1(j,$){const _e=isArray(j),et={type_:_e?1:0,scope_:$?$.scope_:getCurrentScope$1(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:$,base_:j,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let tt=et,nt=objectTraps$1;_e&&(tt=[et],nt=arrayTraps$1);const{revoke:rt,proxy:it}=Proxy.revocable(tt,nt);return et.draft_=it,et.revoke_=rt,[it,et]}var objectTraps$1={get(j,$){if($===DRAFT_STATE$1)return j;const _e=latest$1(j);if(!has$1(_e,$,j.type_))return readPropFromProto$1(j,_e,$);const et=_e[$];if(j.finalized_||!isDraftable$1(et))return et;if(et===peek$1(j.base_,$)){prepareCopy$1(j);const tt=j.type_===1?+$:$,nt=createProxy$1(j.scope_,et,j,tt);return j.copy_[tt]=nt}return et},has(j,$){return $ in latest$1(j)},ownKeys(j){return Reflect.ownKeys(latest$1(j))},set(j,$,_e){const et=getDescriptorFromProto$1(latest$1(j),$);if(et!=null&&et.set)return et.set.call(j.draft_,_e),!0;if(!j.modified_){const tt=peek$1(latest$1(j),$),nt=tt==null?void 0:tt[DRAFT_STATE$1];if(nt&&nt.base_===_e)return j.copy_[$]=_e,j.assigned_.set($,!1),!0;if(is$3(_e,tt)&&(_e!==void 0||has$1(j.base_,$,j.type_)))return!0;prepareCopy$1(j),markChanged$1(j)}return j.copy_[$]===_e&&(_e!==void 0||$ in j.copy_)||Number.isNaN(_e)&&Number.isNaN(j.copy_[$])||(j.copy_[$]=_e,j.assigned_.set($,!0),handleCrossReference(j,$,_e)),!0},deleteProperty(j,$){return prepareCopy$1(j),peek$1(j.base_,$)!==void 0||$ in j.base_?(j.assigned_.set($,!1),markChanged$1(j)):j.assigned_.delete($),j.copy_&&delete j.copy_[$],!0},getOwnPropertyDescriptor(j,$){const _e=latest$1(j),et=Reflect.getOwnPropertyDescriptor(_e,$);return et&&{[WRITABLE]:!0,[CONFIGURABLE]:j.type_!==1||$!=="length",[ENUMERABLE]:et[ENUMERABLE],[VALUE]:_e[$]}},defineProperty(){die$1(11)},getPrototypeOf(j){return getPrototypeOf$1(j.base_)},setPrototypeOf(){die$1(12)}},arrayTraps$1={};each$1(objectTraps$1,(j,$)=>{arrayTraps$1[j]=function(){const _e=arguments;return _e[0]=_e[0][0],$.apply(this,_e)}});arrayTraps$1.deleteProperty=function(j,$){return arrayTraps$1.set.call(this,j,$,void 0)};arrayTraps$1.set=function(j,$,_e){return objectTraps$1.set.call(this,j[0],$,_e,j[0])};function peek$1(j,$){const _e=j[DRAFT_STATE$1];return(_e?latest$1(_e):j)[$]}function readPropFromProto$1(j,$,_e){var tt;const et=getDescriptorFromProto$1($,_e);return et?VALUE in et?et[VALUE]:(tt=et.get)==null?void 0:tt.call(j.draft_):void 0}function getDescriptorFromProto$1(j,$){if(!($ in j))return;let _e=getPrototypeOf$1(j);for(;_e;){const et=Object.getOwnPropertyDescriptor(_e,$);if(et)return et;_e=getPrototypeOf$1(_e)}}function markChanged$1(j){j.modified_||(j.modified_=!0,j.parent_&&markChanged$1(j.parent_))}function prepareCopy$1(j){j.copy_||(j.assigned_=new Map,j.copy_=shallowCopy$1(j.base_,j.scope_.immer_.useStrictShallowCopy_))}var Immer2$1=class{constructor($){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(_e,et,tt)=>{if(isFunction$1(_e)&&!isFunction$1(et)){const rt=et;et=_e;const it=this;return function(at=rt,...ot){return it.produce(at,ct=>et.call(this,ct,...ot))}}isFunction$1(et)||die$1(6),tt!==void 0&&!isFunction$1(tt)&&die$1(7);let nt;if(isDraftable$1(_e)){const rt=enterScope$1(this),it=createProxy$1(rt,_e,void 0);let st=!0;try{nt=et(it),st=!1}finally{st?revokeScope$1(rt):leaveScope$1(rt)}return usePatchesInScope$1(rt,tt),processResult$1(nt,rt)}else if(!_e||!isObjectish(_e)){if(nt=et(_e),nt===void 0&&(nt=_e),nt===NOTHING$1&&(nt=void 0),this.autoFreeze_&&freeze$1(nt,!0),tt){const rt=[],it=[];getPlugin$1(PluginPatches).generateReplacementPatches_(_e,nt,{patches_:rt,inversePatches_:it}),tt(rt,it)}return nt}else die$1(1,_e)},this.produceWithPatches=(_e,et)=>{if(isFunction$1(_e))return(it,...st)=>this.produceWithPatches(it,at=>_e(at,...st));let tt,nt;return[this.produce(_e,et,(it,st)=>{tt=it,nt=st}),tt,nt]},isBoolean$1($==null?void 0:$.autoFreeze)&&this.setAutoFreeze($.autoFreeze),isBoolean$1($==null?void 0:$.useStrictShallowCopy)&&this.setUseStrictShallowCopy($.useStrictShallowCopy),isBoolean$1($==null?void 0:$.useStrictIteration)&&this.setUseStrictIteration($.useStrictIteration)}createDraft($){isDraftable$1($)||die$1(8),isDraft$1($)&&($=current$1($));const _e=enterScope$1(this),et=createProxy$1(_e,$,void 0);return et[DRAFT_STATE$1].isManual_=!0,leaveScope$1(_e),et}finishDraft($,_e){const et=$&&$[DRAFT_STATE$1];(!et||!et.isManual_)&&die$1(9);const{scope_:tt}=et;return usePatchesInScope$1(tt,_e),processResult$1(void 0,tt)}setAutoFreeze($){this.autoFreeze_=$}setUseStrictShallowCopy($){this.useStrictShallowCopy_=$}setUseStrictIteration($){this.useStrictIteration_=$}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches($,_e){let et;for(et=_e.length-1;et>=0;et--){const nt=_e[et];if(nt.path.length===0&&nt.op==="replace"){$=nt.value;break}}et>-1&&(_e=_e.slice(et+1));const tt=getPlugin$1(PluginPatches).applyPatches_;return isDraft$1($)?tt($,_e):this.produce($,nt=>tt(nt,_e))}};function createProxy$1(j,$,_e,et){const[tt,nt]=isMap$1($)?getPlugin$1(PluginMapSet).proxyMap_($,_e):isSet$1($)?getPlugin$1(PluginMapSet).proxySet_($,_e):createProxyProxy$1($,_e);return((_e==null?void 0:_e.scope_)??getCurrentScope$1()).drafts_.push(tt),nt.callbacks_=(_e==null?void 0:_e.callbacks_)??[],nt.key_=et,_e&&et!==void 0?registerChildFinalizationCallback(_e,nt,et):nt.callbacks_.push(function(st){var ot;(ot=st.mapSetPlugin_)==null||ot.fixSetContents(nt);const{patchPlugin_:at}=st;nt.modified_&&at&&at.generatePatches_(nt,[],st)}),tt}function current$1(j){return isDraft$1(j)||die$1(10,j),currentImpl$1(j)}function currentImpl$1(j){if(!isDraftable$1(j)||isFrozen$1(j))return j;const $=j[DRAFT_STATE$1];let _e,et=!0;if($){if(!$.modified_)return $.base_;$.finalized_=!0,_e=shallowCopy$1(j,$.scope_.immer_.useStrictShallowCopy_),et=$.scope_.immer_.shouldUseStrictIteration()}else _e=shallowCopy$1(j,!0);return each$1(_e,(tt,nt)=>{set$1(_e,tt,currentImpl$1(nt))},et),$&&($.finalized_=!1),_e}var immer$1=new Immer2$1,produce=immer$1.produce;function createThunkMiddleware(j){return({dispatch:_e,getState:et})=>tt=>nt=>typeof nt=="function"?nt(_e,et,j):tt(nt)}var thunk=createThunkMiddleware(),withExtraArgument=createThunkMiddleware,composeWithDevTools=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?compose$1:compose$1.apply(null,arguments)};function createAction(j,$){function _e(...et){if($){let tt=$(...et);if(!tt)throw new Error(formatProdErrorMessage(0));return{type:j,payload:tt.payload,..."meta"in tt&&{meta:tt.meta},..."error"in tt&&{error:tt.error}}}return{type:j,payload:et[0]}}return _e.toString=()=>`${j}`,_e.type=j,_e.match=et=>isAction(et)&&et.type===j,_e}var Tuple=class Qs extends Array{constructor(...$){super(...$),Object.setPrototypeOf(this,Qs.prototype)}static get[Symbol.species](){return Qs}concat(...$){return super.concat.apply(this,$)}prepend(...$){return $.length===1&&Array.isArray($[0])?new Qs(...$[0].concat(this)):new Qs(...$.concat(this))}};function freezeDraftable(j){return isDraftable$1(j)?produce(j,()=>{}):j}function getOrInsertComputed(j,$,_e){return j.has($)?j.get($):j.set($,_e($)).get($)}function isBoolean(j){return typeof j=="boolean"}var buildGetDefaultMiddleware=()=>function($){const{thunk:_e=!0,immutableCheck:et=!0,serializableCheck:tt=!0,actionCreatorCheck:nt=!0}=$??{};let rt=new Tuple;return _e&&(isBoolean(_e)?rt.push(thunk):rt.push(withExtraArgument(_e.extraArgument))),rt},SHOULD_AUTOBATCH="RTK_autoBatch",prepareAutoBatched=()=>j=>({payload:j,meta:{[SHOULD_AUTOBATCH]:!0}}),createQueueWithTimer=j=>$=>{setTimeout($,j)},autoBatchEnhancer=(j={type:"raf"})=>$=>(..._e)=>{const et=$(..._e);let tt=!0,nt=!1,rt=!1;const it=new Set,st=j.type==="tick"?queueMicrotask:j.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:createQueueWithTimer(10):j.type==="callback"?j.queueNotification:createQueueWithTimer(j.timeout),at=()=>{rt=!1,nt&&(nt=!1,it.forEach(ot=>ot()))};return Object.assign({},et,{subscribe(ot){const ct=()=>tt&&ot(),lt=et.subscribe(ct);return it.add(ot),()=>{lt(),it.delete(ot)}},dispatch(ot){var ct;try{return tt=!((ct=ot==null?void 0:ot.meta)!=null&&ct[SHOULD_AUTOBATCH]),nt=!tt,nt&&(rt||(rt=!0,st(at))),et.dispatch(ot)}finally{tt=!0}}})},buildGetDefaultEnhancers=j=>function(_e){const{autoBatch:et=!0}=_e??{};let tt=new Tuple(j);return et&&tt.push(autoBatchEnhancer(typeof et=="object"?et:void 0)),tt};function configureStore(j){const $=buildGetDefaultMiddleware(),{reducer:_e=void 0,middleware:et,devTools:tt=!0,preloadedState:nt=void 0,enhancers:rt=void 0}=j||{};let it;if(typeof _e=="function")it=_e;else if(isPlainObject$5(_e))it=combineReducers(_e);else throw new Error(formatProdErrorMessage(1));let st;typeof et=="function"?st=et($):st=$();let at=compose$1;tt&&(at=composeWithDevTools({trace:!1,...typeof tt=="object"&&tt}));const ot=applyMiddleware(...st),ct=buildGetDefaultEnhancers(ot);let lt=typeof rt=="function"?rt(ct):ct();const ut=at(...lt);return createStore(it,nt,ut)}function executeReducerBuilderCallback(j){const $={},_e=[];let et;const tt={addCase(nt,rt){const it=typeof nt=="string"?nt:nt.type;if(!it)throw new Error(formatProdErrorMessage(28));if(it in $)throw new Error(formatProdErrorMessage(29));return $[it]=rt,tt},addAsyncThunk(nt,rt){return rt.pending&&($[nt.pending.type]=rt.pending),rt.rejected&&($[nt.rejected.type]=rt.rejected),rt.fulfilled&&($[nt.fulfilled.type]=rt.fulfilled),rt.settled&&_e.push({matcher:nt.settled,reducer:rt.settled}),tt},addMatcher(nt,rt){return _e.push({matcher:nt,reducer:rt}),tt},addDefaultCase(nt){return et=nt,tt}};return j(tt),[$,_e,et]}function isStateFunction(j){return typeof j=="function"}function createReducer(j,$){let[_e,et,tt]=executeReducerBuilderCallback($),nt;if(isStateFunction(j))nt=()=>freezeDraftable(j());else{const it=freezeDraftable(j);nt=()=>it}function rt(it=nt(),st){let at=[_e[st.type],...et.filter(({matcher:ot})=>ot(st)).map(({reducer:ot})=>ot)];return at.filter(ot=>!!ot).length===0&&(at=[tt]),at.reduce((ot,ct)=>{if(ct)if(isDraft$1(ot)){const ut=ct(ot,st);return ut===void 0?ot:ut}else{if(isDraftable$1(ot))return produce(ot,lt=>ct(lt,st));{const lt=ct(ot,st);if(lt===void 0){if(ot===null)return ot;throw Error("A case reducer on a non-draftable value must not return undefined")}return lt}}return ot},it)}return rt.getInitialState=nt,rt}var urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",nanoid=(j=21)=>{let $="",_e=j;for(;_e--;)$+=urlAlphabet[Math.random()*64|0];return $},asyncThunkSymbol=Symbol.for("rtk-slice-createasyncthunk");function getType(j,$){return`${j}/${$}`}function buildCreateSlice({creators:j}={}){var _e;const $=(_e=j==null?void 0:j.asyncThunk)==null?void 0:_e[asyncThunkSymbol];return function(tt){const{name:nt,reducerPath:rt=nt}=tt;if(!nt)throw new Error(formatProdErrorMessage(11));const it=(typeof tt.reducers=="function"?tt.reducers(buildReducerCreators()):tt.reducers)||{},st=Object.keys(it),at={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},ot={addCase(yt,vt){const xt=typeof yt=="string"?yt:yt.type;if(!xt)throw new Error(formatProdErrorMessage(12));if(xt in at.sliceCaseReducersByType)throw new Error(formatProdErrorMessage(13));return at.sliceCaseReducersByType[xt]=vt,ot},addMatcher(yt,vt){return at.sliceMatchers.push({matcher:yt,reducer:vt}),ot},exposeAction(yt,vt){return at.actionCreators[yt]=vt,ot},exposeCaseReducer(yt,vt){return at.sliceCaseReducersByName[yt]=vt,ot}};st.forEach(yt=>{const vt=it[yt],xt={reducerName:yt,type:getType(nt,yt),createNotation:typeof tt.reducers=="function"};isAsyncThunkSliceReducerDefinition(vt)?handleThunkCaseReducerDefinition(xt,vt,ot,$):handleNormalReducerDefinition(xt,vt,ot)});function ct(){const[yt={},vt=[],xt=void 0]=typeof tt.extraReducers=="function"?executeReducerBuilderCallback(tt.extraReducers):[tt.extraReducers],St={...yt,...at.sliceCaseReducersByType};return createReducer(tt.initialState,Et=>{for(let wt in St)Et.addCase(wt,St[wt]);for(let wt of at.sliceMatchers)Et.addMatcher(wt.matcher,wt.reducer);for(let wt of vt)Et.addMatcher(wt.matcher,wt.reducer);xt&&Et.addDefaultCase(xt)})}const lt=yt=>yt,ut=new Map,pt=new WeakMap;let dt;function ht(yt,vt){return dt||(dt=ct()),dt(yt,vt)}function ft(){return dt||(dt=ct()),dt.getInitialState()}function mt(yt,vt=!1){function xt(Et){let wt=Et[yt];return typeof wt>"u"&&vt&&(wt=getOrInsertComputed(pt,xt,ft)),wt}function St(Et=lt){const wt=getOrInsertComputed(ut,vt,()=>new WeakMap);return getOrInsertComputed(wt,Et,()=>{const Tt={};for(const[Ct,Rt]of Object.entries(tt.selectors??{}))Tt[Ct]=wrapSelector(Rt,Et,()=>getOrInsertComputed(pt,Et,ft),vt);return Tt})}return{reducerPath:yt,getSelectors:St,get selectors(){return St(xt)},selectSlice:xt}}const gt={name:nt,reducer:ht,actions:at.actionCreators,caseReducers:at.sliceCaseReducersByName,getInitialState:ft,...mt(rt),injectInto(yt,{reducerPath:vt,...xt}={}){const St=vt??rt;return yt.inject({reducerPath:St,reducer:ht},xt),{...gt,...mt(St,!0)}}};return gt}}function wrapSelector(j,$,_e,et){function tt(nt,...rt){let it=$(nt);return typeof it>"u"&&et&&(it=_e()),j(it,...rt)}return tt.unwrapped=j,tt}var createSlice=buildCreateSlice();function buildReducerCreators(){function j($,_e){return{_reducerDefinitionType:"asyncThunk",payloadCreator:$,..._e}}return j.withTypes=()=>j,{reducer($){return Object.assign({[$.name](..._e){return $(..._e)}}[$.name],{_reducerDefinitionType:"reducer"})},preparedReducer($,_e){return{_reducerDefinitionType:"reducerWithPrepare",prepare:$,reducer:_e}},asyncThunk:j}}function handleNormalReducerDefinition({type:j,reducerName:$,createNotation:_e},et,tt){let nt,rt;if("reducer"in et){if(_e&&!isCaseReducerWithPrepareDefinition(et))throw new Error(formatProdErrorMessage(17));nt=et.reducer,rt=et.prepare}else nt=et;tt.addCase(j,nt).exposeCaseReducer($,nt).exposeAction($,rt?createAction(j,rt):createAction(j))}function isAsyncThunkSliceReducerDefinition(j){return j._reducerDefinitionType==="asyncThunk"}function isCaseReducerWithPrepareDefinition(j){return j._reducerDefinitionType==="reducerWithPrepare"}function handleThunkCaseReducerDefinition({type:j,reducerName:$},_e,et,tt){if(!tt)throw new Error(formatProdErrorMessage(18));const{payloadCreator:nt,fulfilled:rt,pending:it,rejected:st,settled:at,options:ot}=_e,ct=tt(j,nt,ot);et.exposeAction($,ct),rt&&et.addCase(ct.fulfilled,rt),it&&et.addCase(ct.pending,it),st&&et.addCase(ct.rejected,st),at&&et.addMatcher(ct.settled,at),et.exposeCaseReducer($,{fulfilled:rt||noop,pending:it||noop,rejected:st||noop,settled:at||noop})}function noop(){}var task="task",listener="listener",completed="completed",cancelled="cancelled",taskCancelled=`task-${cancelled}`,taskCompleted=`task-${completed}`,listenerCancelled=`${listener}-${cancelled}`,listenerCompleted=`${listener}-${completed}`,TaskAbortError=class{constructor(j){Wt(this,"name","TaskAbortError");Wt(this,"message");this.code=j,this.message=`${task} ${cancelled} (reason: ${j})`}},assertFunction=(j,$)=>{if(typeof j!="function")throw new TypeError(formatProdErrorMessage(32))},noop2=()=>{},catchRejection=(j,$=noop2)=>(j.catch($),j),addAbortSignalListener=(j,$)=>(j.addEventListener("abort",$,{once:!0}),()=>j.removeEventListener("abort",$)),validateActive=j=>{if(j.aborted)throw new TaskAbortError(j.reason)};function raceWithSignal(j,$){let _e=noop2;return new Promise((et,tt)=>{const nt=()=>tt(new TaskAbortError(j.reason));if(j.aborted){nt();return}_e=addAbortSignalListener(j,nt),$.finally(()=>_e()).then(et,tt)}).finally(()=>{_e=noop2})}var runTask=async(j,$)=>{try{return await Promise.resolve(),{status:"ok",value:await j()}}catch(_e){return{status:_e instanceof TaskAbortError?"cancelled":"rejected",error:_e}}finally{$==null||$()}},createPause=j=>$=>catchRejection(raceWithSignal(j,$).then(_e=>(validateActive(j),_e))),createDelay=j=>{const $=createPause(j);return _e=>$(new Promise(et=>setTimeout(et,_e)))},{assign}=Object,INTERNAL_NIL_TOKEN={},alm="listenerMiddleware",createFork=(j,$)=>{const _e=et=>addAbortSignalListener(j,()=>et.abort(j.reason));return(et,tt)=>{assertFunction(et);const nt=new AbortController;_e(nt);const rt=runTask(async()=>{validateActive(j),validateActive(nt.signal);const it=await et({pause:createPause(nt.signal),delay:createDelay(nt.signal),signal:nt.signal});return validateActive(nt.signal),it},()=>nt.abort(taskCompleted));return tt!=null&&tt.autoJoin&&$.push(rt.catch(noop2)),{result:createPause(j)(rt),cancel(){nt.abort(taskCancelled)}}}},createTakePattern=(j,$)=>{const _e=async(et,tt)=>{validateActive($);let nt=()=>{};const it=[new Promise((st,at)=>{let ot=j({predicate:et,effect:(ct,lt)=>{lt.unsubscribe(),st([ct,lt.getState(),lt.getOriginalState()])}});nt=()=>{ot(),at()}})];tt!=null&&it.push(new Promise(st=>setTimeout(st,tt,null)));try{const st=await raceWithSignal($,Promise.race(it));return validateActive($),st}finally{nt()}};return(et,tt)=>catchRejection(_e(et,tt))},getListenerEntryPropsFrom=j=>{let{type:$,actionCreator:_e,matcher:et,predicate:tt,effect:nt}=j;if($)tt=createAction($).match;else if(_e)$=_e.type,tt=_e.match;else if(et)tt=et;else if(!tt)throw new Error(formatProdErrorMessage(21));return assertFunction(nt),{predicate:tt,type:$,effect:nt}},createListenerEntry=assign(j=>{const{type:$,predicate:_e,effect:et}=getListenerEntryPropsFrom(j);return{id:nanoid(),effect:et,type:$,predicate:_e,pending:new Set,unsubscribe:()=>{throw new Error(formatProdErrorMessage(22))}}},{withTypes:()=>createListenerEntry}),findListenerEntry=(j,$)=>{const{type:_e,effect:et,predicate:tt}=getListenerEntryPropsFrom($);return Array.from(j.values()).find(nt=>(typeof _e=="string"?nt.type===_e:nt.predicate===tt)&&nt.effect===et)},cancelActiveListeners=j=>{j.pending.forEach($=>{$.abort(listenerCancelled)})},createClearListenerMiddleware=(j,$)=>()=>{for(const _e of $.keys())cancelActiveListeners(_e);j.clear()},safelyNotifyError=(j,$,_e)=>{try{j($,_e)}catch(et){setTimeout(()=>{throw et},0)}},addListener=assign(createAction(`${alm}/add`),{withTypes:()=>addListener}),clearAllListeners=createAction(`${alm}/removeAll`),removeListener=assign(createAction(`${alm}/remove`),{withTypes:()=>removeListener}),defaultErrorHandler=(...j)=>{console.error(`${alm}/error`,...j)},createListenerMiddleware=(j={})=>{const $=new Map,_e=new Map,et=ut=>{const pt=_e.get(ut)??0;_e.set(ut,pt+1)},tt=ut=>{const pt=_e.get(ut)??1;pt===1?_e.delete(ut):_e.set(ut,pt-1)},{extra:nt,onError:rt=defaultErrorHandler}=j;assertFunction(rt);const it=ut=>(ut.unsubscribe=()=>$.delete(ut.id),$.set(ut.id,ut),pt=>{ut.unsubscribe(),pt!=null&&pt.cancelActive&&cancelActiveListeners(ut)}),st=ut=>{const pt=findListenerEntry($,ut)??createListenerEntry(ut);return it(pt)};assign(st,{withTypes:()=>st});const at=ut=>{const pt=findListenerEntry($,ut);return pt&&(pt.unsubscribe(),ut.cancelActive&&cancelActiveListeners(pt)),!!pt};assign(at,{withTypes:()=>at});const ot=async(ut,pt,dt,ht)=>{const ft=new AbortController,mt=createTakePattern(st,ft.signal),gt=[];try{ut.pending.add(ft),et(ut),await Promise.resolve(ut.effect(pt,assign({},dt,{getOriginalState:ht,condition:(yt,vt)=>mt(yt,vt).then(Boolean),take:mt,delay:createDelay(ft.signal),pause:createPause(ft.signal),extra:nt,signal:ft.signal,fork:createFork(ft.signal,gt),unsubscribe:ut.unsubscribe,subscribe:()=>{$.set(ut.id,ut)},cancelActiveListeners:()=>{ut.pending.forEach((yt,vt,xt)=>{yt!==ft&&(yt.abort(listenerCancelled),xt.delete(yt))})},cancel:()=>{ft.abort(listenerCancelled),ut.pending.delete(ft)},throwIfCancelled:()=>{validateActive(ft.signal)}})))}catch(yt){yt instanceof TaskAbortError||safelyNotifyError(rt,yt,{raisedBy:"effect"})}finally{await Promise.all(gt),ft.abort(listenerCompleted),tt(ut),ut.pending.delete(ft)}},ct=createClearListenerMiddleware($,_e);return{middleware:ut=>pt=>dt=>{if(!isAction(dt))return pt(dt);if(addListener.match(dt))return st(dt.payload);if(clearAllListeners.match(dt)){ct();return}if(removeListener.match(dt))return at(dt.payload);let ht=ut.getState();const ft=()=>{if(ht===INTERNAL_NIL_TOKEN)throw new Error(formatProdErrorMessage(23));return ht};let mt;try{if(mt=pt(dt),$.size>0){const gt=ut.getState(),yt=Array.from($.values());for(const vt of yt){let xt=!1;try{xt=vt.predicate(dt,gt,ht)}catch(St){xt=!1,safelyNotifyError(rt,St,{raisedBy:"predicate"})}xt&&ot(vt,dt,ut,ft)}}}finally{ht=INTERNAL_NIL_TOKEN}return mt},startListening:st,stopListening:at,clearListeners:ct}};function formatProdErrorMessage(j){return`Minified Redux Toolkit error #${j}; visit https://redux-toolkit.js.org/Errors?code=${j} for the full message or use the non-minified dev environment for full errors. `}var initialState$b={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},chartLayoutSlice=createSlice({name:"chartLayout",initialState:initialState$b,reducers:{setLayout(j,$){j.layoutType=$.payload},setChartSize(j,$){j.width=$.payload.width,j.height=$.payload.height},setMargin(j,$){var _e,et,tt,nt;j.margin.top=(_e=$.payload.top)!==null&&_e!==void 0?_e:0,j.margin.right=(et=$.payload.right)!==null&&et!==void 0?et:0,j.margin.bottom=(tt=$.payload.bottom)!==null&&tt!==void 0?tt:0,j.margin.left=(nt=$.payload.left)!==null&&nt!==void 0?nt:0},setScale(j,$){j.scale=$.payload}}}),{setMargin,setLayout,setChartSize,setScale}=chartLayoutSlice.actions,chartLayoutReducer=chartLayoutSlice.reducer;function getSliced(j,$,_e){return Array.isArray(j)&&j&&$+_e!==0?j.slice($,_e+1):j}function ownKeys$x(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$x(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$x(Object(_e),!0).forEach(function(et){_defineProperty$z(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$x(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$z(j,$,_e){return($=_toPropertyKey$z($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$z(j){var $=_toPrimitive$z(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$z(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function getValueByDataKey(j,$,_e){return isNullish(j)||isNullish($)?_e:isNumOrStr($)?get$2(j,$,_e):typeof $=="function"?$(j):_e}var appendOffsetOfLegend=(j,$,_e)=>{if($&&_e){var{width:et,height:tt}=_e,{align:nt,verticalAlign:rt,layout:it}=$;if((it==="vertical"||it==="horizontal"&&rt==="middle")&&nt!=="center"&&isNumber(j[nt]))return _objectSpread$x(_objectSpread$x({},j),{},{[nt]:j[nt]+(et||0)});if((it==="horizontal"||it==="vertical"&&nt==="center")&&rt!=="middle"&&isNumber(j[rt]))return _objectSpread$x(_objectSpread$x({},j),{},{[rt]:j[rt]+(tt||0)})}return j},isCategoricalAxis=(j,$)=>j==="horizontal"&&$==="xAxis"||j==="vertical"&&$==="yAxis"||j==="centric"&&$==="angleAxis"||j==="radial"&&$==="radiusAxis",EPS=1e-4,checkDomainOfScale=j=>{var $=j.domain();if(!(!$||$.length<=2)){var _e=$.length,et=j.range(),tt=Math.min(et[0],et[1])-EPS,nt=Math.max(et[0],et[1])+EPS,rt=j($[0]),it=j($[_e-1]);(rt<tt||rt>nt||it<tt||it>nt)&&j.domain([$[0],$[_e-1]])}},offsetSign=j=>{var $=j.length;if(!($<=0))for(var _e=0,et=j[0].length;_e<et;++_e)for(var tt=0,nt=0,rt=0;rt<$;++rt){var it=isNan(j[rt][_e][1])?j[rt][_e][0]:j[rt][_e][1];it>=0?(j[rt][_e][0]=tt,j[rt][_e][1]=tt+it,tt=j[rt][_e][1]):(j[rt][_e][0]=nt,j[rt][_e][1]=nt+it,nt=j[rt][_e][1])}},offsetPositive=j=>{var $=j.length;if(!($<=0))for(var _e=0,et=j[0].length;_e<et;++_e)for(var tt=0,nt=0;nt<$;++nt){var rt=isNan(j[nt][_e][1])?j[nt][_e][0]:j[nt][_e][1];rt>=0?(j[nt][_e][0]=tt,j[nt][_e][1]=tt+rt,tt=j[nt][_e][1]):(j[nt][_e][0]=0,j[nt][_e][1]=0)}},STACK_OFFSET_MAP={sign:offsetSign,expand:stackOffsetExpand,none:stackOffsetNone,silhouette:stackOffsetSilhouette,wiggle:stackOffsetWiggle,positive:offsetPositive},getStackedData=(j,$,_e)=>{var et=STACK_OFFSET_MAP[_e],tt=shapeStack().keys($).value((nt,rt)=>Number(getValueByDataKey(nt,rt,0))).order(stackOrderNone).offset(et);return tt(j)};function getCateCoordinateOfLine(j){var{axis:$,ticks:_e,bandSize:et,entry:tt,index:nt,dataKey:rt}=j;if($.type==="category"){if(!$.allowDuplicatedCategory&&$.dataKey&&!isNullish(tt[$.dataKey])){var it=findEntryInArray(_e,"value",tt[$.dataKey]);if(it)return it.coordinate+et/2}return _e[nt]?_e[nt].coordinate+et/2:null}var st=getValueByDataKey(tt,isNullish(rt)?$.dataKey:rt);return isNullish(st)?null:$.scale(st)}var getDomainOfSingle=j=>{var $=j.flat(2).filter(isNumber);return[Math.min(...$),Math.max(...$)]},makeDomainFinite=j=>[j[0]===1/0?0:j[0],j[1]===-1/0?0:j[1]],getDomainOfStackGroups=(j,$,_e)=>{if(j!=null)return makeDomainFinite(Object.keys(j).reduce((et,tt)=>{var nt=j[tt],{stackedData:rt}=nt,it=rt.reduce((st,at)=>{var ot=getSliced(at,$,_e),ct=getDomainOfSingle(ot);return[Math.min(st[0],ct[0]),Math.max(st[1],ct[1])]},[1/0,-1/0]);return[Math.min(it[0],et[0]),Math.max(it[1],et[1])]},[1/0,-1/0]))},MIN_VALUE_REG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MAX_VALUE_REG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,getBandSizeOfAxis=(j,$,_e)=>{if(j&&j.scale&&j.scale.bandwidth){var et=j.scale.bandwidth();if(!_e||et>0)return et}if(j&&$&&$.length>=2){for(var tt=sortBy$1($,ot=>ot.coordinate),nt=1/0,rt=1,it=tt.length;rt<it;rt++){var st=tt[rt],at=tt[rt-1];nt=Math.min((st.coordinate||0)-(at.coordinate||0),nt)}return nt===1/0?0:nt}return _e?void 0:0};function getTooltipEntry(j){var{tooltipEntrySettings:$,dataKey:_e,payload:et,value:tt,name:nt}=j;return _objectSpread$x(_objectSpread$x({},$),{},{dataKey:_e,payload:et,value:tt,name:nt})}function getTooltipNameProp(j,$){if(j)return String(j);if(typeof $=="string")return $}var calculateCartesianTooltipPos=(j,$)=>{if($==="horizontal")return j.chartX;if($==="vertical")return j.chartY},calculatePolarTooltipPos=(j,$)=>$==="centric"?j.angle:j.radius,selectChartWidth=j=>j.layout.width,selectChartHeight=j=>j.layout.height,selectContainerScale=j=>j.layout.scale,selectMargin=j=>j.layout.margin,selectAllXAxes=createSelector(j=>j.cartesianAxis.xAxis,j=>Object.values(j)),selectAllYAxes=createSelector(j=>j.cartesianAxis.yAxis,j=>Object.values(j)),DATA_ITEM_INDEX_ATTRIBUTE_NAME="data-recharts-item-index",DATA_ITEM_DATAKEY_ATTRIBUTE_NAME="data-recharts-item-data-key",DEFAULT_Y_AXIS_WIDTH=60;function ownKeys$w(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$w(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$w(Object(_e),!0).forEach(function(et){_defineProperty$y(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$w(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$y(j,$,_e){return($=_toPropertyKey$y($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$y(j){var $=_toPrimitive$y(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$y(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var selectBrushHeight=j=>j.brush.height;function selectLeftAxesOffset(j){var $=selectAllYAxes(j);return $.reduce((_e,et)=>{if(et.orientation==="left"&&!et.mirror&&!et.hide){var tt=typeof et.width=="number"?et.width:DEFAULT_Y_AXIS_WIDTH;return _e+tt}return _e},0)}function selectRightAxesOffset(j){var $=selectAllYAxes(j);return $.reduce((_e,et)=>{if(et.orientation==="right"&&!et.mirror&&!et.hide){var tt=typeof et.width=="number"?et.width:DEFAULT_Y_AXIS_WIDTH;return _e+tt}return _e},0)}function selectTopAxesOffset(j){var $=selectAllXAxes(j);return $.reduce((_e,et)=>et.orientation==="top"&&!et.mirror&&!et.hide?_e+et.height:_e,0)}function selectBottomAxesOffset(j){var $=selectAllXAxes(j);return $.reduce((_e,et)=>et.orientation==="bottom"&&!et.mirror&&!et.hide?_e+et.height:_e,0)}var selectChartOffsetInternal=createSelector([selectChartWidth,selectChartHeight,selectMargin,selectBrushHeight,selectLeftAxesOffset,selectRightAxesOffset,selectTopAxesOffset,selectBottomAxesOffset,selectLegendSettings,selectLegendSize],(j,$,_e,et,tt,nt,rt,it,st,at)=>{var ot={left:(_e.left||0)+tt,right:(_e.right||0)+nt},ct={top:(_e.top||0)+rt,bottom:(_e.bottom||0)+it},lt=_objectSpread$w(_objectSpread$w({},ct),ot),ut=lt.bottom;lt.bottom+=et,lt=appendOffsetOfLegend(lt,st,at);var pt=j-lt.left-lt.right,dt=$-lt.top-lt.bottom;return _objectSpread$w(_objectSpread$w({brushBottom:ut},lt),{},{width:Math.max(pt,0),height:Math.max(dt,0)})}),selectChartViewBox=createSelector(selectChartOffsetInternal,j=>({x:j.left,y:j.top,width:j.width,height:j.height})),selectAxisViewBox=createSelector(selectChartWidth,selectChartHeight,(j,$)=>({x:0,y:0,width:j,height:$})),PanoramaContext=reactExports.createContext(null),useIsPanorama=()=>reactExports.useContext(PanoramaContext)!=null,selectBrushSettings=j=>j.brush,selectBrushDimensions=createSelector([selectBrushSettings,selectChartOffsetInternal,selectMargin],(j,$,_e)=>({height:j.height,x:isNumber(j.x)?j.x:$.left,y:isNumber(j.y)?j.y:$.top+$.height+$.brushBottom-((_e==null?void 0:_e.bottom)||0),width:isNumber(j.width)?j.width:$.width})),throttle$2={},debounce$1={},debounce={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e,et,{signal:tt,edges:nt}={}){let rt,it=null;const st=nt!=null&&nt.includes("leading"),at=nt==null||nt.includes("trailing"),ot=()=>{it!==null&&(_e.apply(rt,it),rt=void 0,it=null)},ct=()=>{at&&ot(),dt()};let lt=null;const ut=()=>{lt!=null&&clearTimeout(lt),lt=setTimeout(()=>{lt=null,ct()},et)},pt=()=>{lt!==null&&(clearTimeout(lt),lt=null)},dt=()=>{pt(),rt=void 0,it=null},ht=()=>{ot()},ft=function(...mt){if(tt!=null&&tt.aborted)return;rt=this,it=mt;const gt=lt==null;ut(),st&&gt&&ot()};return ft.schedule=ut,ft.cancel=dt,ft.flush=ht,tt==null||tt.addEventListener("abort",dt,{once:!0}),ft}j.debounce=$})(debounce);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=debounce;function _e(et,tt=0,nt={}){typeof nt!="object"&&(nt={});const{leading:rt=!1,trailing:it=!0,maxWait:st}=nt,at=Array(2);rt&&(at[0]="leading"),it&&(at[1]="trailing");let ot,ct=null;const lt=$.debounce(function(...dt){ot=et.apply(this,dt),ct=null},tt,{edges:at}),ut=function(...dt){return st!=null&&(ct===null&&(ct=Date.now()),Date.now()-ct>=st)?(ot=et.apply(this,dt),ct=Date.now(),lt.cancel(),lt.schedule(),ot):(lt.apply(this,dt),ot)},pt=()=>(lt.flush(),ot);return ut.cancel=lt.cancel,ut.flush=pt,ut}j.debounce=_e})(debounce$1);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=debounce$1;function _e(et,tt=0,nt={}){const{leading:rt=!0,trailing:it=!0}=nt;return $.debounce(et,tt,{leading:rt,maxWait:tt,trailing:it})}j.throttle=_e})(throttle$2);var throttle=throttle$2.throttle;const throttle$1=getDefaultExportFromCjs$1(throttle);var warn=function j($,_e){for(var et=arguments.length,tt=new Array(et>2?et-2:0),nt=2;nt<et;nt++)tt[nt-2]=arguments[nt];if(typeof console<"u"&&console.warn&&(_e===void 0&&console.warn("LogUtils requires an error message argument"),!$))if(_e===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var rt=0;console.warn(_e.replace(/%s/g,()=>tt[rt++]))}},calculateChartDimensions=(j,$,_e)=>{var{width:et="100%",height:tt="100%",aspect:nt,maxHeight:rt}=_e,it=isPercent(et)?j:Number(et),st=isPercent(tt)?$:Number(tt);return nt&&nt>0&&(it?st=it/nt:st&&(it=st*nt),rt&&st!=null&&st>rt&&(st=rt)),{calculatedWidth:it,calculatedHeight:st}},bothOverflow={width:0,height:0,overflow:"visible"},overflowX={width:0,overflowX:"visible"},overflowY={height:0,overflowY:"visible"},noStyle={},getInnerDivStyle=j=>{var{width:$,height:_e}=j,et=isPercent($),tt=isPercent(_e);return et&&tt?bothOverflow:et?overflowX:tt?overflowY:noStyle};function getDefaultWidthAndHeight(j){var{width:$,height:_e,aspect:et}=j,tt=$,nt=_e;return tt===void 0&&nt===void 0?(tt="100%",nt="100%"):tt===void 0?tt=et&&et>0?void 0:"100%":nt===void 0&&(nt=et&&et>0?void 0:"100%"),{width:tt,height:nt}}function isWellBehavedNumber(j){return Number.isFinite(j)}function isPositiveNumber(j){return typeof j=="number"&&j>0&&Number.isFinite(j)}function _extends$l(){return _extends$l=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$l.apply(null,arguments)}function ownKeys$v(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$v(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$v(Object(_e),!0).forEach(function(et){_defineProperty$x(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$v(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$x(j,$,_e){return($=_toPropertyKey$x($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$x(j){var $=_toPrimitive$x(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$x(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var ResponsiveContainerContext=reactExports.createContext({width:-1,height:-1});function isAcceptableSize(j){return isPositiveNumber(j.width)&&isPositiveNumber(j.height)}function ResponsiveContainerContextProvider(j){var{children:$,width:_e,height:et}=j,tt=reactExports.useMemo(()=>({width:_e,height:et}),[_e,et]);return isAcceptableSize(tt)?reactExports.createElement(ResponsiveContainerContext.Provider,{value:tt},$):null}var useResponsiveContainerContext=()=>reactExports.useContext(ResponsiveContainerContext),SizeDetectorContainer=reactExports.forwardRef((j,$)=>{var{aspect:_e,initialDimension:et={width:-1,height:-1},width:tt,height:nt,minWidth:rt=0,minHeight:it,maxHeight:st,children:at,debounce:ot=0,id:ct,className:lt,onResize:ut,style:pt={}}=j,dt=reactExports.useRef(null),ht=reactExports.useRef();ht.current=ut,reactExports.useImperativeHandle($,()=>dt.current);var[ft,mt]=reactExports.useState({containerWidth:et.width,containerHeight:et.height}),gt=reactExports.useCallback((Et,wt)=>{mt(Tt=>{var Ct=Math.round(Et),Rt=Math.round(wt);return Tt.containerWidth===Ct&&Tt.containerHeight===Rt?Tt:{containerWidth:Ct,containerHeight:Rt}})},[]);reactExports.useEffect(()=>{if(dt.current==null||typeof ResizeObserver>"u")return noop$2;var Et=Rt=>{var jt,{width:Ot,height:$t}=Rt[0].contentRect;gt(Ot,$t),(jt=ht.current)===null||jt===void 0||jt.call(ht,Ot,$t)};ot>0&&(Et=throttle$1(Et,ot,{trailing:!0,leading:!1}));var wt=new ResizeObserver(Et),{width:Tt,height:Ct}=dt.current.getBoundingClientRect();return gt(Tt,Ct),wt.observe(dt.current),()=>{wt.disconnect()}},[gt,ot]);var{containerWidth:yt,containerHeight:vt}=ft;warn(!_e||_e>0,"The aspect(%s) must be greater than zero.",_e);var{calculatedWidth:xt,calculatedHeight:St}=calculateChartDimensions(yt,vt,{width:tt,height:nt,aspect:_e,maxHeight:st});return warn(xt!=null&&xt>0||St!=null&&St>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,xt,St,tt,nt,rt,it,_e),reactExports.createElement("div",{id:ct?"".concat(ct):void 0,className:clsx("recharts-responsive-container",lt),style:_objectSpread$v(_objectSpread$v({},pt),{},{width:tt,height:nt,minWidth:rt,minHeight:it,maxHeight:st}),ref:dt},reactExports.createElement("div",{style:getInnerDivStyle({width:tt,height:nt})},reactExports.createElement(ResponsiveContainerContextProvider,{width:xt,height:St},at)))}),ResponsiveContainer=reactExports.forwardRef((j,$)=>{var _e=useResponsiveContainerContext();if(isPositiveNumber(_e.width)&&isPositiveNumber(_e.height))return j.children;var{width:et,height:tt}=getDefaultWidthAndHeight({width:j.width,height:j.height,aspect:j.aspect}),{calculatedWidth:nt,calculatedHeight:rt}=calculateChartDimensions(void 0,void 0,{width:et,height:tt,aspect:j.aspect,maxHeight:j.maxHeight});return isNumber(nt)&&isNumber(rt)?reactExports.createElement(ResponsiveContainerContextProvider,{width:nt,height:rt},j.children):reactExports.createElement(SizeDetectorContainer,_extends$l({},j,{width:et,height:tt,ref:$}))});function cartesianViewBoxToTrapezoid(j){if(j)return{x:j.x,y:j.y,upperWidth:"upperWidth"in j?j.upperWidth:j.width,lowerWidth:"lowerWidth"in j?j.lowerWidth:j.width,width:j.width,height:j.height}}var useViewBox=()=>{var j,$=useIsPanorama(),_e=useAppSelector(selectChartViewBox),et=useAppSelector(selectBrushDimensions),tt=(j=useAppSelector(selectBrushSettings))===null||j===void 0?void 0:j.padding;return!$||!et||!tt?_e:{width:et.width-tt.left-tt.right,height:et.height-tt.top-tt.bottom,x:tt.left,y:tt.top}},manyComponentsThrowErrorsIfOffsetIsUndefined={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},useOffsetInternal=()=>{var j;return(j=useAppSelector(selectChartOffsetInternal))!==null&&j!==void 0?j:manyComponentsThrowErrorsIfOffsetIsUndefined},useChartWidth=()=>useAppSelector(selectChartWidth),useChartHeight=()=>useAppSelector(selectChartHeight),selectChartLayout=j=>j.layout.layoutType,useChartLayout=()=>useAppSelector(selectChartLayout),useIsInChartContext=()=>{var j=useChartLayout();return j!==void 0},ReportChartSize=j=>{var $=useAppDispatch(),_e=useIsPanorama(),{width:et,height:tt}=j,nt=useResponsiveContainerContext(),rt=et,it=tt;return nt&&(rt=nt.width>0?nt.width:et,it=nt.height>0?nt.height:tt),reactExports.useEffect(()=>{!_e&&isPositiveNumber(rt)&&isPositiveNumber(it)&&$(setChartSize({width:rt,height:it}))},[$,_e,rt,it]),null},NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(j,...$){throw new Error(`[Immer] minified error nr: ${j}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(j){return!!j&&!!j[DRAFT_STATE]}function isDraftable(j){var $;return j?isPlainObject$3(j)||Array.isArray(j)||!!j[DRAFTABLE]||!!(($=j.constructor)!=null&&$[DRAFTABLE])||isMap(j)||isSet(j):!1}var objectCtorString=Object.prototype.constructor.toString(),cachedCtorStrings=new WeakMap;function isPlainObject$3(j){if(!j||typeof j!="object")return!1;const $=Object.getPrototypeOf(j);if($===null||$===Object.prototype)return!0;const _e=Object.hasOwnProperty.call($,"constructor")&&$.constructor;if(_e===Object)return!0;if(typeof _e!="function")return!1;let et=cachedCtorStrings.get(_e);return et===void 0&&(et=Function.toString.call(_e),cachedCtorStrings.set(_e,et)),et===objectCtorString}function each(j,$,_e=!0){getArchtype(j)===0?(_e?Reflect.ownKeys(j):Object.keys(j)).forEach(tt=>{$(tt,j[tt],j)}):j.forEach((et,tt)=>$(tt,et,j))}function getArchtype(j){const $=j[DRAFT_STATE];return $?$.type_:Array.isArray(j)?1:isMap(j)?2:isSet(j)?3:0}function has(j,$){return getArchtype(j)===2?j.has($):Object.prototype.hasOwnProperty.call(j,$)}function set(j,$,_e){const et=getArchtype(j);et===2?j.set($,_e):et===3?j.add(_e):j[$]=_e}function is$2(j,$){return j===$?j!==0||1/j===1/$:j!==j&&$!==$}function isMap(j){return j instanceof Map}function isSet(j){return j instanceof Set}function latest(j){return j.copy_||j.base_}function shallowCopy(j,$){if(isMap(j))return new Map(j);if(isSet(j))return new Set(j);if(Array.isArray(j))return Array.prototype.slice.call(j);const _e=isPlainObject$3(j);if($===!0||$==="class_only"&&!_e){const et=Object.getOwnPropertyDescriptors(j);delete et[DRAFT_STATE];let tt=Reflect.ownKeys(et);for(let nt=0;nt<tt.length;nt++){const rt=tt[nt],it=et[rt];it.writable===!1&&(it.writable=!0,it.configurable=!0),(it.get||it.set)&&(et[rt]={configurable:!0,writable:!0,enumerable:it.enumerable,value:j[rt]})}return Object.create(getPrototypeOf(j),et)}else{const et=getPrototypeOf(j);if(et!==null&&_e)return{...j};const tt=Object.create(et);return Object.assign(tt,j)}}function freeze(j,$=!1){return isFrozen(j)||isDraft(j)||!isDraftable(j)||(getArchtype(j)>1&&Object.defineProperties(j,{set:dontMutateMethodOverride,add:dontMutateMethodOverride,clear:dontMutateMethodOverride,delete:dontMutateMethodOverride}),Object.freeze(j),$&&Object.values(j).forEach(_e=>freeze(_e,!0))),j}function dontMutateFrozenCollections(){die(2)}var dontMutateMethodOverride={value:dontMutateFrozenCollections};function isFrozen(j){return j===null||typeof j!="object"?!0:Object.isFrozen(j)}var plugins={};function getPlugin(j){const $=plugins[j];return $||die(0,j),$}var currentScope;function getCurrentScope(){return currentScope}function createScope(j,$){return{drafts_:[],parent_:j,immer_:$,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(j,$){$&&(getPlugin("Patches"),j.patches_=[],j.inversePatches_=[],j.patchListener_=$)}function revokeScope(j){leaveScope(j),j.drafts_.forEach(revokeDraft),j.drafts_=null}function leaveScope(j){j===currentScope&&(currentScope=j.parent_)}function enterScope(j){return currentScope=createScope(currentScope,j)}function revokeDraft(j){const $=j[DRAFT_STATE];$.type_===0||$.type_===1?$.revoke_():$.revoked_=!0}function processResult(j,$){$.unfinalizedDrafts_=$.drafts_.length;const _e=$.drafts_[0];return j!==void 0&&j!==_e?(_e[DRAFT_STATE].modified_&&(revokeScope($),die(4)),isDraftable(j)&&(j=finalize($,j),$.parent_||maybeFreeze($,j)),$.patches_&&getPlugin("Patches").generateReplacementPatches_(_e[DRAFT_STATE].base_,j,$.patches_,$.inversePatches_)):j=finalize($,_e,[]),revokeScope($),$.patches_&&$.patchListener_($.patches_,$.inversePatches_),j!==NOTHING?j:void 0}function finalize(j,$,_e){if(isFrozen($))return $;const et=j.immer_.shouldUseStrictIteration(),tt=$[DRAFT_STATE];if(!tt)return each($,(nt,rt)=>finalizeProperty(j,tt,$,nt,rt,_e),et),$;if(tt.scope_!==j)return $;if(!tt.modified_)return maybeFreeze(j,tt.base_,!0),tt.base_;if(!tt.finalized_){tt.finalized_=!0,tt.scope_.unfinalizedDrafts_--;const nt=tt.copy_;let rt=nt,it=!1;tt.type_===3&&(rt=new Set(nt),nt.clear(),it=!0),each(rt,(st,at)=>finalizeProperty(j,tt,nt,st,at,_e,it),et),maybeFreeze(j,nt,!1),_e&&j.patches_&&getPlugin("Patches").generatePatches_(tt,_e,j.patches_,j.inversePatches_)}return tt.copy_}function finalizeProperty(j,$,_e,et,tt,nt,rt){if(tt==null||typeof tt!="object"&&!rt)return;const it=isFrozen(tt);if(!(it&&!rt)){if(isDraft(tt)){const st=nt&&$&&$.type_!==3&&!has($.assigned_,et)?nt.concat(et):void 0,at=finalize(j,tt,st);if(set(_e,et,at),isDraft(at))j.canAutoFreeze_=!1;else return}else rt&&_e.add(tt);if(isDraftable(tt)&&!it){if(!j.immer_.autoFreeze_&&j.unfinalizedDrafts_<1||$&&$.base_&&$.base_[et]===tt&&it)return;finalize(j,tt),(!$||!$.scope_.parent_)&&typeof et!="symbol"&&(isMap(_e)?_e.has(et):Object.prototype.propertyIsEnumerable.call(_e,et))&&maybeFreeze(j,tt)}}}function maybeFreeze(j,$,_e=!1){!j.parent_&&j.immer_.autoFreeze_&&j.canAutoFreeze_&&freeze($,_e)}function createProxyProxy(j,$){const _e=Array.isArray(j),et={type_:_e?1:0,scope_:$?$.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:$,base_:j,draft_:null,copy_:null,revoke_:null,isManual_:!1};let tt=et,nt=objectTraps;_e&&(tt=[et],nt=arrayTraps);const{revoke:rt,proxy:it}=Proxy.revocable(tt,nt);return et.draft_=it,et.revoke_=rt,it}var objectTraps={get(j,$){if($===DRAFT_STATE)return j;const _e=latest(j);if(!has(_e,$))return readPropFromProto(j,_e,$);const et=_e[$];return j.finalized_||!isDraftable(et)?et:et===peek(j.base_,$)?(prepareCopy(j),j.copy_[$]=createProxy(et,j)):et},has(j,$){return $ in latest(j)},ownKeys(j){return Reflect.ownKeys(latest(j))},set(j,$,_e){const et=getDescriptorFromProto(latest(j),$);if(et!=null&&et.set)return et.set.call(j.draft_,_e),!0;if(!j.modified_){const tt=peek(latest(j),$),nt=tt==null?void 0:tt[DRAFT_STATE];if(nt&&nt.base_===_e)return j.copy_[$]=_e,j.assigned_[$]=!1,!0;if(is$2(_e,tt)&&(_e!==void 0||has(j.base_,$)))return!0;prepareCopy(j),markChanged(j)}return j.copy_[$]===_e&&(_e!==void 0||$ in j.copy_)||Number.isNaN(_e)&&Number.isNaN(j.copy_[$])||(j.copy_[$]=_e,j.assigned_[$]=!0),!0},deleteProperty(j,$){return peek(j.base_,$)!==void 0||$ in j.base_?(j.assigned_[$]=!1,prepareCopy(j),markChanged(j)):delete j.assigned_[$],j.copy_&&delete j.copy_[$],!0},getOwnPropertyDescriptor(j,$){const _e=latest(j),et=Reflect.getOwnPropertyDescriptor(_e,$);return et&&{writable:!0,configurable:j.type_!==1||$!=="length",enumerable:et.enumerable,value:_e[$]}},defineProperty(){die(11)},getPrototypeOf(j){return getPrototypeOf(j.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each(objectTraps,(j,$)=>{arrayTraps[j]=function(){return arguments[0]=arguments[0][0],$.apply(this,arguments)}});arrayTraps.deleteProperty=function(j,$){return arrayTraps.set.call(this,j,$,void 0)};arrayTraps.set=function(j,$,_e){return objectTraps.set.call(this,j[0],$,_e,j[0])};function peek(j,$){const _e=j[DRAFT_STATE];return(_e?latest(_e):j)[$]}function readPropFromProto(j,$,_e){var tt;const et=getDescriptorFromProto($,_e);return et?"value"in et?et.value:(tt=et.get)==null?void 0:tt.call(j.draft_):void 0}function getDescriptorFromProto(j,$){if(!($ in j))return;let _e=getPrototypeOf(j);for(;_e;){const et=Object.getOwnPropertyDescriptor(_e,$);if(et)return et;_e=getPrototypeOf(_e)}}function markChanged(j){j.modified_||(j.modified_=!0,j.parent_&&markChanged(j.parent_))}function prepareCopy(j){j.copy_||(j.copy_=shallowCopy(j.base_,j.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(j){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=($,_e,et)=>{if(typeof $=="function"&&typeof _e!="function"){const nt=_e;_e=$;const rt=this;return function(st=nt,...at){return rt.produce(st,ot=>_e.call(this,ot,...at))}}typeof _e!="function"&&die(6),et!==void 0&&typeof et!="function"&&die(7);let tt;if(isDraftable($)){const nt=enterScope(this),rt=createProxy($,void 0);let it=!0;try{tt=_e(rt),it=!1}finally{it?revokeScope(nt):leaveScope(nt)}return usePatchesInScope(nt,et),processResult(tt,nt)}else if(!$||typeof $!="object"){if(tt=_e($),tt===void 0&&(tt=$),tt===NOTHING&&(tt=void 0),this.autoFreeze_&&freeze(tt,!0),et){const nt=[],rt=[];getPlugin("Patches").generateReplacementPatches_($,tt,nt,rt),et(nt,rt)}return tt}else die(1,$)},this.produceWithPatches=($,_e)=>{if(typeof $=="function")return(rt,...it)=>this.produceWithPatches(rt,st=>$(st,...it));let et,tt;return[this.produce($,_e,(rt,it)=>{et=rt,tt=it}),et,tt]},typeof(j==null?void 0:j.autoFreeze)=="boolean"&&this.setAutoFreeze(j.autoFreeze),typeof(j==null?void 0:j.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(j.useStrictShallowCopy),typeof(j==null?void 0:j.useStrictIteration)=="boolean"&&this.setUseStrictIteration(j.useStrictIteration)}createDraft(j){isDraftable(j)||die(8),isDraft(j)&&(j=current(j));const $=enterScope(this),_e=createProxy(j,void 0);return _e[DRAFT_STATE].isManual_=!0,leaveScope($),_e}finishDraft(j,$){const _e=j&&j[DRAFT_STATE];(!_e||!_e.isManual_)&&die(9);const{scope_:et}=_e;return usePatchesInScope(et,$),processResult(void 0,et)}setAutoFreeze(j){this.autoFreeze_=j}setUseStrictShallowCopy(j){this.useStrictShallowCopy_=j}setUseStrictIteration(j){this.useStrictIteration_=j}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(j,$){let _e;for(_e=$.length-1;_e>=0;_e--){const tt=$[_e];if(tt.path.length===0&&tt.op==="replace"){j=tt.value;break}}_e>-1&&($=$.slice(_e+1));const et=getPlugin("Patches").applyPatches_;return isDraft(j)?et(j,$):this.produce(j,tt=>et(tt,$))}};function createProxy(j,$){const _e=isMap(j)?getPlugin("MapSet").proxyMap_(j,$):isSet(j)?getPlugin("MapSet").proxySet_(j,$):createProxyProxy(j,$);return($?$.scope_:getCurrentScope()).drafts_.push(_e),_e}function current(j){return isDraft(j)||die(10,j),currentImpl(j)}function currentImpl(j){if(!isDraftable(j)||isFrozen(j))return j;const $=j[DRAFT_STATE];let _e,et=!0;if($){if(!$.modified_)return $.base_;$.finalized_=!0,_e=shallowCopy(j,$.scope_.immer_.useStrictShallowCopy_),et=$.scope_.immer_.shouldUseStrictIteration()}else _e=shallowCopy(j,!0);return each(_e,(tt,nt)=>{set(_e,tt,currentImpl(nt))},et),$&&($.finalized_=!1),_e}var immer=new Immer2;immer.produce;function castDraft(j){return j}var initialState$a={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},legendSlice=createSlice({name:"legend",initialState:initialState$a,reducers:{setLegendSize(j,$){j.size.width=$.payload.width,j.size.height=$.payload.height},setLegendSettings(j,$){j.settings.align=$.payload.align,j.settings.layout=$.payload.layout,j.settings.verticalAlign=$.payload.verticalAlign,j.settings.itemSorter=$.payload.itemSorter},addLegendPayload:{reducer(j,$){j.payload.push($.payload)},prepare:prepareAutoBatched()},replaceLegendPayload:{reducer(j,$){var{prev:_e,next:et}=$.payload,tt=current$1(j).payload.indexOf(_e);tt>-1&&(j.payload[tt]=et)},prepare:prepareAutoBatched()},removeLegendPayload:{reducer(j,$){var _e=current$1(j).payload.indexOf($.payload);_e>-1&&j.payload.splice(_e,1)},prepare:prepareAutoBatched()}}}),{setLegendSize,setLegendSettings,addLegendPayload,replaceLegendPayload,removeLegendPayload}=legendSlice.actions,legendReducer=legendSlice.reducer;function _extends$k(){return _extends$k=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$k.apply(null,arguments)}function ownKeys$u(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$u(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$u(Object(_e),!0).forEach(function(et){_defineProperty$w(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$u(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$w(j,$,_e){return($=_toPropertyKey$w($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$w(j){var $=_toPrimitive$w(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$w(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function defaultFormatter(j){return Array.isArray(j)&&isNumOrStr(j[0])&&isNumOrStr(j[1])?j.join(" ~ "):j}var DefaultTooltipContent=j=>{var{separator:$=" : ",contentStyle:_e={},itemStyle:et={},labelStyle:tt={},payload:nt,formatter:rt,itemSorter:it,wrapperClassName:st,labelClassName:at,label:ot,labelFormatter:ct,accessibilityLayer:lt=!1}=j,ut=()=>{if(nt&&nt.length){var vt={padding:0,margin:0},xt=(it?sortBy$1(nt,it):nt).map((St,Et)=>{if(St.type==="none")return null;var wt=St.formatter||rt||defaultFormatter,{value:Tt,name:Ct}=St,Rt=Tt,jt=Ct;if(wt){var Ot=wt(Tt,Ct,St,Et,nt);if(Array.isArray(Ot))[Rt,jt]=Ot;else if(Ot!=null)Rt=Ot;else return null}var $t=_objectSpread$u({display:"block",paddingTop:4,paddingBottom:4,color:St.color||"#000"},et);return reactExports.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Et),style:$t},isNumOrStr(jt)?reactExports.createElement("span",{className:"recharts-tooltip-item-name"},jt):null,isNumOrStr(jt)?reactExports.createElement("span",{className:"recharts-tooltip-item-separator"},$):null,reactExports.createElement("span",{className:"recharts-tooltip-item-value"},Rt),reactExports.createElement("span",{className:"recharts-tooltip-item-unit"},St.unit||""))});return reactExports.createElement("ul",{className:"recharts-tooltip-item-list",style:vt},xt)}return null},pt=_objectSpread$u({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},_e),dt=_objectSpread$u({margin:0},tt),ht=!isNullish(ot),ft=ht?ot:"",mt=clsx("recharts-default-tooltip",st),gt=clsx("recharts-tooltip-label",at);ht&&ct&&nt!==void 0&&nt!==null&&(ft=ct(ot,nt));var yt=lt?{role:"status","aria-live":"assertive"}:{};return reactExports.createElement("div",_extends$k({className:mt,style:pt},yt),reactExports.createElement("p",{className:gt,style:dt},reactExports.isValidElement(ft)?ft:"".concat(ft)),ut())},CSS_CLASS_PREFIX="recharts-tooltip-wrapper",TOOLTIP_HIDDEN={visibility:"hidden"};function getTooltipCSSClassName(j){var{coordinate:$,translateX:_e,translateY:et}=j;return clsx(CSS_CLASS_PREFIX,{["".concat(CSS_CLASS_PREFIX,"-right")]:isNumber(_e)&&$&&isNumber($.x)&&_e>=$.x,["".concat(CSS_CLASS_PREFIX,"-left")]:isNumber(_e)&&$&&isNumber($.x)&&_e<$.x,["".concat(CSS_CLASS_PREFIX,"-bottom")]:isNumber(et)&&$&&isNumber($.y)&&et>=$.y,["".concat(CSS_CLASS_PREFIX,"-top")]:isNumber(et)&&$&&isNumber($.y)&&et<$.y})}function getTooltipTranslateXY(j){var{allowEscapeViewBox:$,coordinate:_e,key:et,offsetTopLeft:tt,position:nt,reverseDirection:rt,tooltipDimension:it,viewBox:st,viewBoxDimension:at}=j;if(nt&&isNumber(nt[et]))return nt[et];var ot=_e[et]-it-(tt>0?tt:0),ct=_e[et]+tt;if($[et])return rt[et]?ot:ct;var lt=st[et];if(lt==null)return 0;if(rt[et]){var ut=ot,pt=lt;return ut<pt?Math.max(ct,lt):Math.max(ot,lt)}if(at==null)return 0;var dt=ct+it,ht=lt+at;return dt>ht?Math.max(ot,lt):Math.max(ct,lt)}function getTransformStyle(j){var{translateX:$,translateY:_e,useTranslate3d:et}=j;return{transform:et?"translate3d(".concat($,"px, ").concat(_e,"px, 0)"):"translate(".concat($,"px, ").concat(_e,"px)")}}function getTooltipTranslate(j){var{allowEscapeViewBox:$,coordinate:_e,offsetTopLeft:et,position:tt,reverseDirection:nt,tooltipBox:rt,useTranslate3d:it,viewBox:st}=j,at,ot,ct;return rt.height>0&&rt.width>0&&_e?(ot=getTooltipTranslateXY({allowEscapeViewBox:$,coordinate:_e,key:"x",offsetTopLeft:et,position:tt,reverseDirection:nt,tooltipDimension:rt.width,viewBox:st,viewBoxDimension:st.width}),ct=getTooltipTranslateXY({allowEscapeViewBox:$,coordinate:_e,key:"y",offsetTopLeft:et,position:tt,reverseDirection:nt,tooltipDimension:rt.height,viewBox:st,viewBoxDimension:st.height}),at=getTransformStyle({translateX:ot,translateY:ct,useTranslate3d:it})):at=TOOLTIP_HIDDEN,{cssProperties:at,cssClasses:getTooltipCSSClassName({translateX:ot,translateY:ct,coordinate:_e})}}function ownKeys$t(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$t(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$t(Object(_e),!0).forEach(function(et){_defineProperty$v(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$t(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$v(j,$,_e){return($=_toPropertyKey$v($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$v(j){var $=_toPrimitive$v(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$v(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}class TooltipBoundingBox extends reactExports.PureComponent{constructor(){super(...arguments),_defineProperty$v(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),_defineProperty$v(this,"handleKeyDown",$=>{if($.key==="Escape"){var _e,et,tt,nt;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(_e=(et=this.props.coordinate)===null||et===void 0?void 0:et.x)!==null&&_e!==void 0?_e:0,y:(tt=(nt=this.props.coordinate)===null||nt===void 0?void 0:nt.y)!==null&&tt!==void 0?tt:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var $,_e;this.state.dismissed&&((($=this.props.coordinate)===null||$===void 0?void 0:$.x)!==this.state.dismissedAtCoordinate.x||((_e=this.props.coordinate)===null||_e===void 0?void 0:_e.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:$,allowEscapeViewBox:_e,animationDuration:et,animationEasing:tt,children:nt,coordinate:rt,hasPayload:it,isAnimationActive:st,offset:at,position:ot,reverseDirection:ct,useTranslate3d:lt,viewBox:ut,wrapperStyle:pt,lastBoundingBox:dt,innerRef:ht,hasPortalFromProps:ft}=this.props,{cssClasses:mt,cssProperties:gt}=getTooltipTranslate({allowEscapeViewBox:_e,coordinate:rt,offsetTopLeft:at,position:ot,reverseDirection:ct,tooltipBox:{height:dt.height,width:dt.width},useTranslate3d:lt,viewBox:ut}),yt=ft?{}:_objectSpread$t(_objectSpread$t({transition:st&&$?"transform ".concat(et,"ms ").concat(tt):void 0},gt),{},{pointerEvents:"none",visibility:!this.state.dismissed&&$&&it?"visible":"hidden",position:"absolute",top:0,left:0}),vt=_objectSpread$t(_objectSpread$t({},yt),{},{visibility:!this.state.dismissed&&$&&it?"visible":"hidden"},pt);return reactExports.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:mt,style:vt,ref:ht},nt)}}var useAccessibilityLayer=()=>{var j;return(j=useAppSelector($=>$.rootProps.accessibilityLayer))!==null&&j!==void 0?j:!0};function _extends$j(){return _extends$j=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$j.apply(null,arguments)}function ownKeys$s(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$s(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$s(Object(_e),!0).forEach(function(et){_defineProperty$u(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$s(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$u(j,$,_e){return($=_toPropertyKey$u($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$u(j){var $=_toPrimitive$u(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$u(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var CURVE_FACTORIES={curveBasisClosed,curveBasisOpen,curveBasis,curveBumpX:bumpX,curveBumpY:bumpY,curveLinearClosed,curveLinear,curveMonotoneX:monotoneX,curveMonotoneY:monotoneY,curveNatural,curveStep,curveStepAfter:stepAfter,curveStepBefore:stepBefore},defined=j=>isWellBehavedNumber(j.x)&&isWellBehavedNumber(j.y),areaDefined=j=>j.base!=null&&defined(j.base)&&defined(j),getX=j=>j.x,getY=j=>j.y,getCurveFactory=(j,$)=>{if(typeof j=="function")return j;var _e="curve".concat(upperFirst(j));return(_e==="curveMonotone"||_e==="curveBump")&&$?CURVE_FACTORIES["".concat(_e).concat($==="vertical"?"Y":"X")]:CURVE_FACTORIES[_e]||curveLinear},getPath$1=j=>{var{type:$="linear",points:_e=[],baseLine:et,layout:tt,connectNulls:nt=!1}=j,rt=getCurveFactory($,tt),it=nt?_e.filter(defined):_e,st;if(Array.isArray(et)){var at=_e.map((ut,pt)=>_objectSpread$s(_objectSpread$s({},ut),{},{base:et[pt]}));tt==="vertical"?st=shapeArea().y(getY).x1(getX).x0(ut=>ut.base.x):st=shapeArea().x(getX).y1(getY).y0(ut=>ut.base.y);var ot=st.defined(areaDefined).curve(rt),ct=nt?at.filter(areaDefined):at;return ot(ct)}tt==="vertical"&&isNumber(et)?st=shapeArea().y(getY).x1(getX).x0(et):isNumber(et)?st=shapeArea().x(getX).y1(getY).y0(et):st=shapeLine().x(getX).y(getY);var lt=st.defined(defined).curve(rt);return lt(it)},Curve=j=>{var{className:$,points:_e,path:et,pathRef:tt}=j;if((!_e||!_e.length)&&!et)return null;var nt=_e&&_e.length?getPath$1(j):et;return reactExports.createElement("path",_extends$j({},svgPropertiesNoEvents(j),adaptEventHandlers(j),{className:clsx("recharts-curve",$),d:nt===null?void 0:nt,ref:tt}))},_excluded$h=["x","y","top","left","width","height","className"];function _extends$i(){return _extends$i=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$i.apply(null,arguments)}function ownKeys$r(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$r(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$r(Object(_e),!0).forEach(function(et){_defineProperty$t(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$r(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$t(j,$,_e){return($=_toPropertyKey$t($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$t(j){var $=_toPrimitive$t(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$t(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _objectWithoutProperties$h(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$h(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$h(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var getPath=(j,$,_e,et,tt,nt)=>"M".concat(j,",").concat(tt,"v").concat(et,"M").concat(nt,",").concat($,"h").concat(_e),Cross=j=>{var{x:$=0,y:_e=0,top:et=0,left:tt=0,width:nt=0,height:rt=0,className:it}=j,st=_objectWithoutProperties$h(j,_excluded$h),at=_objectSpread$r({x:$,y:_e,top:et,left:tt,width:nt,height:rt},st);return!isNumber($)||!isNumber(_e)||!isNumber(nt)||!isNumber(rt)||!isNumber(et)||!isNumber(tt)?null:reactExports.createElement("path",_extends$i({},svgPropertiesAndEvents(at),{className:clsx("recharts-cross",it),d:getPath($,_e,nt,rt,et,tt)}))};function getCursorRectangle(j,$,_e,et){var tt=et/2;return{stroke:"none",fill:"#ccc",x:j==="horizontal"?$.x-tt:_e.left+.5,y:j==="horizontal"?_e.top+.5:$.y-tt,width:j==="horizontal"?et:_e.width-1,height:j==="horizontal"?_e.height-1:et}}function ownKeys$q(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$q(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$q(Object(_e),!0).forEach(function(et){_defineProperty$s(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$q(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$s(j,$,_e){return($=_toPropertyKey$s($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$s(j){var $=_toPrimitive$s(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$s(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var getDashCase=j=>j.replace(/([A-Z])/g,$=>"-".concat($.toLowerCase())),getTransitionVal=(j,$,_e)=>j.map(et=>"".concat(getDashCase(et)," ").concat($,"ms ").concat(_e)).join(","),getIntersectionKeys=(j,$)=>[Object.keys(j),Object.keys($)].reduce((_e,et)=>_e.filter(tt=>et.includes(tt))),mapObject=(j,$)=>Object.keys($).reduce((_e,et)=>_objectSpread$q(_objectSpread$q({},_e),{},{[et]:j(et,$[et])}),{});function ownKeys$p(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$p(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$p(Object(_e),!0).forEach(function(et){_defineProperty$r(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$p(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$r(j,$,_e){return($=_toPropertyKey$r($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$r(j){var $=_toPrimitive$r(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$r(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var alpha=(j,$,_e)=>j+($-j)*_e,needContinue=j=>{var{from:$,to:_e}=j;return $!==_e},calStepperVals=(j,$,_e)=>{var et=mapObject((tt,nt)=>{if(needContinue(nt)){var[rt,it]=j(nt.from,nt.to,nt.velocity);return _objectSpread$p(_objectSpread$p({},nt),{},{from:rt,velocity:it})}return nt},$);return _e<1?mapObject((tt,nt)=>needContinue(nt)?_objectSpread$p(_objectSpread$p({},nt),{},{velocity:alpha(nt.velocity,et[tt].velocity,_e),from:alpha(nt.from,et[tt].from,_e)}):nt,$):calStepperVals(j,et,_e-1)};function createStepperUpdate(j,$,_e,et,tt,nt){var rt,it=et.reduce((lt,ut)=>_objectSpread$p(_objectSpread$p({},lt),{},{[ut]:{from:j[ut],velocity:0,to:$[ut]}}),{}),st=()=>mapObject((lt,ut)=>ut.from,it),at=()=>!Object.values(it).filter(needContinue).length,ot=null,ct=lt=>{rt||(rt=lt);var ut=lt-rt,pt=ut/_e.dt;it=calStepperVals(_e,it,pt),tt(_objectSpread$p(_objectSpread$p(_objectSpread$p({},j),$),st())),rt=lt,at()||(ot=nt.setTimeout(ct))};return()=>(ot=nt.setTimeout(ct),()=>{var lt;(lt=ot)===null||lt===void 0||lt()})}function createTimingUpdate(j,$,_e,et,tt,nt,rt){var it=null,st=tt.reduce((ct,lt)=>_objectSpread$p(_objectSpread$p({},ct),{},{[lt]:[j[lt],$[lt]]}),{}),at,ot=ct=>{at||(at=ct);var lt=(ct-at)/et,ut=mapObject((dt,ht)=>alpha(...ht,_e(lt)),st);if(nt(_objectSpread$p(_objectSpread$p(_objectSpread$p({},j),$),ut)),lt<1)it=rt.setTimeout(ot);else{var pt=mapObject((dt,ht)=>alpha(...ht,_e(1)),st);nt(_objectSpread$p(_objectSpread$p(_objectSpread$p({},j),$),pt))}};return()=>(it=rt.setTimeout(ot),()=>{var ct;(ct=it)===null||ct===void 0||ct()})}const configUpdate=(j,$,_e,et,tt,nt)=>{var rt=getIntersectionKeys(j,$);return _e==null?()=>(tt(_objectSpread$p(_objectSpread$p({},j),$)),()=>{}):_e.isStepper===!0?createStepperUpdate(j,$,_e,rt,tt,nt):createTimingUpdate(j,$,_e,et,rt,tt,nt)};var ACCURACY=1e-4,cubicBezierFactor=(j,$)=>[0,3*j,3*$-6*j,3*j-3*$+1],evaluatePolynomial=(j,$)=>j.map((_e,et)=>_e*$**et).reduce((_e,et)=>_e+et),cubicBezier=(j,$)=>_e=>{var et=cubicBezierFactor(j,$);return evaluatePolynomial(et,_e)},derivativeCubicBezier=(j,$)=>_e=>{var et=cubicBezierFactor(j,$),tt=[...et.map((nt,rt)=>nt*rt).slice(1),0];return evaluatePolynomial(tt,_e)},getBezierCoordinates=function j(){for(var $=arguments.length,_e=new Array($),et=0;et<$;et++)_e[et]=arguments[et];if(_e.length===1)switch(_e[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var tt,nt=_e[0].split("(");if(nt[0]==="cubic-bezier"&&((tt=nt[1])===null||tt===void 0?void 0:tt.split(")")[0].split(",").length)===4){var rt=nt[1].split(")")[0].split(",").map(it=>parseFloat(it));return[rt[0],rt[1],rt[2],rt[3]]}}}return _e.length===4?_e:[0,0,1,1]},createBezierEasing=(j,$,_e,et)=>{var tt=cubicBezier(j,_e),nt=cubicBezier($,et),rt=derivativeCubicBezier(j,_e),it=at=>at>1?1:at<0?0:at,st=at=>{for(var ot=at>1?1:at,ct=ot,lt=0;lt<8;++lt){var ut=tt(ct)-ot,pt=rt(ct);if(Math.abs(ut-ot)<ACCURACY||pt<ACCURACY)return nt(ct);ct=it(ct-ut/pt)}return nt(ct)};return st.isStepper=!1,st},configBezier=function j(){return createBezierEasing(...getBezierCoordinates(...arguments))},configSpring=function j(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:_e=100,damping:et=8,dt:tt=17}=$,nt=(rt,it,st)=>{var at=-(rt-it)*_e,ot=st*et,ct=st+(at-ot)*tt/1e3,lt=st*tt/1e3+rt;return Math.abs(lt-it)<ACCURACY&&Math.abs(ct)<ACCURACY?[it,0]:[lt,ct]};return nt.isStepper=!0,nt.dt=tt,nt},configEasing=j=>{if(typeof j=="string")switch(j){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return configBezier(j);case"spring":return configSpring();default:if(j.split("(")[0]==="cubic-bezier")return configBezier(j)}return typeof j=="function"?j:null};function createAnimateManager(j){var $,_e=()=>null,et=!1,tt=null,nt=rt=>{if(!et){if(Array.isArray(rt)){if(!rt.length)return;var it=rt,[st,...at]=it;if(typeof st=="number"){tt=j.setTimeout(nt.bind(null,at),st);return}nt(st),tt=j.setTimeout(nt.bind(null,at));return}typeof rt=="string"&&($=rt,_e($)),typeof rt=="object"&&($=rt,_e($)),typeof rt=="function"&&rt()}};return{stop:()=>{et=!0},start:rt=>{et=!1,tt&&(tt(),tt=null),nt(rt)},subscribe:rt=>(_e=rt,()=>{_e=()=>null}),getTimeoutController:()=>j}}class RequestAnimationFrameTimeoutController{setTimeout($){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,et=performance.now(),tt=null,nt=rt=>{rt-et>=_e?$(rt):typeof requestAnimationFrame=="function"&&(tt=requestAnimationFrame(nt))};return tt=requestAnimationFrame(nt),()=>{tt!=null&&cancelAnimationFrame(tt)}}}function createDefaultAnimationManager(){return createAnimateManager(new RequestAnimationFrameTimeoutController)}var AnimationManagerContext=reactExports.createContext(createDefaultAnimationManager);function useAnimationManager(j,$){var _e=reactExports.useContext(AnimationManagerContext);return reactExports.useMemo(()=>$??_e(j),[j,$,_e])}var parseIsSsrByDefault=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Global={devToolsEnabled:!1,isSsr:parseIsSsrByDefault()},defaultJavascriptAnimateProps={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},from={t:0},to={t:1};function JavascriptAnimate(j){var $=resolveDefaultProps(j,defaultJavascriptAnimateProps),{isActive:_e,canBegin:et,duration:tt,easing:nt,begin:rt,onAnimationEnd:it,onAnimationStart:st,children:at}=$,ot=_e==="auto"?!Global.isSsr:_e,ct=useAnimationManager($.animationId,$.animationManager),[lt,ut]=reactExports.useState(ot?from:to),pt=reactExports.useRef(null);return reactExports.useEffect(()=>{ot||ut(to)},[ot]),reactExports.useEffect(()=>{if(!ot||!et)return noop$2;var dt=configUpdate(from,to,configEasing(nt),tt,ut,ct.getTimeoutController()),ht=()=>{pt.current=dt()};return ct.start([st,rt,ht,tt,it]),()=>{ct.stop(),pt.current&&pt.current(),it()}},[ot,et,tt,nt,rt,st,it,ct]),at(lt.t)}function useAnimationId(j){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",_e=reactExports.useRef(uniqueId($)),et=reactExports.useRef(j);return et.current!==j&&(_e.current=uniqueId($),et.current=j),_e.current}var _excluded$g=["radius"],_excluded2$7=["radius"];function ownKeys$o(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$o(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$o(Object(_e),!0).forEach(function(et){_defineProperty$q(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$o(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$q(j,$,_e){return($=_toPropertyKey$q($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$q(j){var $=_toPrimitive$q(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$q(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$h(){return _extends$h=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$h.apply(null,arguments)}function _objectWithoutProperties$g(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$g(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$g(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var getRectanglePath=(j,$,_e,et,tt)=>{var nt=Math.min(Math.abs(_e)/2,Math.abs(et)/2),rt=et>=0?1:-1,it=_e>=0?1:-1,st=et>=0&&_e>=0||et<0&&_e<0?1:0,at;if(nt>0&&tt instanceof Array){for(var ot=[0,0,0,0],ct=0,lt=4;ct<lt;ct++)ot[ct]=tt[ct]>nt?nt:tt[ct];at="M".concat(j,",").concat($+rt*ot[0]),ot[0]>0&&(at+="A ".concat(ot[0],",").concat(ot[0],",0,0,").concat(st,",").concat(j+it*ot[0],",").concat($)),at+="L ".concat(j+_e-it*ot[1],",").concat($),ot[1]>0&&(at+="A ".concat(ot[1],",").concat(ot[1],",0,0,").concat(st,`,
        `).concat(j+_e,",").concat($+rt*ot[1])),at+="L ".concat(j+_e,",").concat($+et-rt*ot[2]),ot[2]>0&&(at+="A ".concat(ot[2],",").concat(ot[2],",0,0,").concat(st,`,
        `).concat(j+_e-it*ot[2],",").concat($+et)),at+="L ".concat(j+it*ot[3],",").concat($+et),ot[3]>0&&(at+="A ".concat(ot[3],",").concat(ot[3],",0,0,").concat(st,`,
        `).concat(j,",").concat($+et-rt*ot[3])),at+="Z"}else if(nt>0&&tt===+tt&&tt>0){var ut=Math.min(nt,tt);at="M ".concat(j,",").concat($+rt*ut,`
            A `).concat(ut,",").concat(ut,",0,0,").concat(st,",").concat(j+it*ut,",").concat($,`
            L `).concat(j+_e-it*ut,",").concat($,`
            A `).concat(ut,",").concat(ut,",0,0,").concat(st,",").concat(j+_e,",").concat($+rt*ut,`
            L `).concat(j+_e,",").concat($+et-rt*ut,`
            A `).concat(ut,",").concat(ut,",0,0,").concat(st,",").concat(j+_e-it*ut,",").concat($+et,`
            L `).concat(j+it*ut,",").concat($+et,`
            A `).concat(ut,",").concat(ut,",0,0,").concat(st,",").concat(j,",").concat($+et-rt*ut," Z")}else at="M ".concat(j,",").concat($," h ").concat(_e," v ").concat(et," h ").concat(-_e," Z");return at},defaultRectangleProps={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rectangle=j=>{var $=resolveDefaultProps(j,defaultRectangleProps),_e=reactExports.useRef(null),[et,tt]=reactExports.useState(-1);reactExports.useEffect(()=>{if(_e.current&&_e.current.getTotalLength)try{var Lt=_e.current.getTotalLength();Lt&&tt(Lt)}catch{}},[]);var{x:nt,y:rt,width:it,height:st,radius:at,className:ot}=$,{animationEasing:ct,animationDuration:lt,animationBegin:ut,isAnimationActive:pt,isUpdateAnimationActive:dt}=$,ht=reactExports.useRef(it),ft=reactExports.useRef(st),mt=reactExports.useRef(nt),gt=reactExports.useRef(rt),yt=reactExports.useMemo(()=>({x:nt,y:rt,width:it,height:st,radius:at}),[nt,rt,it,st,at]),vt=useAnimationId(yt,"rectangle-");if(nt!==+nt||rt!==+rt||it!==+it||st!==+st||it===0||st===0)return null;var xt=clsx("recharts-rectangle",ot);if(!dt){var St=svgPropertiesAndEvents($),{radius:Et}=St,wt=_objectWithoutProperties$g(St,_excluded$g);return reactExports.createElement("path",_extends$h({},wt,{radius:typeof at=="number"?at:void 0,className:xt,d:getRectanglePath(nt,rt,it,st,at)}))}var Tt=ht.current,Ct=ft.current,Rt=mt.current,jt=gt.current,Ot="0px ".concat(et===-1?1:et,"px"),$t="".concat(et,"px 0px"),Kt=getTransitionVal(["strokeDasharray"],lt,typeof ct=="string"?ct:defaultRectangleProps.animationEasing);return reactExports.createElement(JavascriptAnimate,{animationId:vt,key:vt,canBegin:et>0,duration:lt,easing:ct,isActive:dt,begin:ut},Lt=>{var Nt=interpolate$1(Tt,it,Lt),Bt=interpolate$1(Ct,st,Lt),kt=interpolate$1(Rt,nt,Lt),rn=interpolate$1(jt,rt,Lt);_e.current&&(ht.current=Nt,ft.current=Bt,mt.current=kt,gt.current=rn);var Gt;pt?Lt>0?Gt={transition:Kt,strokeDasharray:$t}:Gt={strokeDasharray:Ot}:Gt={strokeDasharray:$t};var _t=svgPropertiesAndEvents($),{radius:sn}=_t,tn=_objectWithoutProperties$g(_t,_excluded2$7);return reactExports.createElement("path",_extends$h({},tn,{radius:typeof at=="number"?at:void 0,className:xt,d:getRectanglePath(kt,rn,Nt,Bt,at),ref:_e,style:_objectSpread$o(_objectSpread$o({},Gt),$.style)}))})};function ownKeys$n(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$n(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$n(Object(_e),!0).forEach(function(et){_defineProperty$p(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$n(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$p(j,$,_e){return($=_toPropertyKey$p($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$p(j){var $=_toPrimitive$p(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$p(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var RADIAN=Math.PI/180,radianToDegree=j=>j*180/Math.PI,polarToCartesian=(j,$,_e,et)=>({x:j+Math.cos(-RADIAN*et)*_e,y:$+Math.sin(-RADIAN*et)*_e}),getMaxRadius=function j($,_e){var et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs($-(et.left||0)-(et.right||0)),Math.abs(_e-(et.top||0)-(et.bottom||0)))/2},distanceBetweenPoints=(j,$)=>{var{x:_e,y:et}=j,{x:tt,y:nt}=$;return Math.sqrt((_e-tt)**2+(et-nt)**2)},getAngleOfPoint=(j,$)=>{var{x:_e,y:et}=j,{cx:tt,cy:nt}=$,rt=distanceBetweenPoints({x:_e,y:et},{x:tt,y:nt});if(rt<=0)return{radius:rt,angle:0};var it=(_e-tt)/rt,st=Math.acos(it);return et>nt&&(st=2*Math.PI-st),{radius:rt,angle:radianToDegree(st),angleInRadian:st}},formatAngleOfSector=j=>{var{startAngle:$,endAngle:_e}=j,et=Math.floor($/360),tt=Math.floor(_e/360),nt=Math.min(et,tt);return{startAngle:$-nt*360,endAngle:_e-nt*360}},reverseFormatAngleOfSector=(j,$)=>{var{startAngle:_e,endAngle:et}=$,tt=Math.floor(_e/360),nt=Math.floor(et/360),rt=Math.min(tt,nt);return j+rt*360},inRangeOfSector=(j,$)=>{var{chartX:_e,chartY:et}=j,{radius:tt,angle:nt}=getAngleOfPoint({x:_e,y:et},$),{innerRadius:rt,outerRadius:it}=$;if(tt<rt||tt>it||tt===0)return null;var{startAngle:st,endAngle:at}=formatAngleOfSector($),ot=nt,ct;if(st<=at){for(;ot>at;)ot-=360;for(;ot<st;)ot+=360;ct=ot>=st&&ot<=at}else{for(;ot>st;)ot-=360;for(;ot<at;)ot+=360;ct=ot>=at&&ot<=st}return ct?_objectSpread$n(_objectSpread$n({},$),{},{radius:tt,angle:reverseFormatAngleOfSector(ot,$)}):null};function getRadialCursorPoints(j){var{cx:$,cy:_e,radius:et,startAngle:tt,endAngle:nt}=j,rt=polarToCartesian($,_e,et,tt),it=polarToCartesian($,_e,et,nt);return{points:[rt,it],cx:$,cy:_e,radius:et,startAngle:tt,endAngle:nt}}function _extends$g(){return _extends$g=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$g.apply(null,arguments)}var getDeltaAngle$1=(j,$)=>{var _e=mathSign($-j),et=Math.min(Math.abs($-j),359.999);return _e*et},getTangentCircle=j=>{var{cx:$,cy:_e,radius:et,angle:tt,sign:nt,isExternal:rt,cornerRadius:it,cornerIsExternal:st}=j,at=it*(rt?1:-1)+et,ot=Math.asin(it/at)/RADIAN,ct=st?tt:tt+nt*ot,lt=polarToCartesian($,_e,at,ct),ut=polarToCartesian($,_e,et,ct),pt=st?tt-nt*ot:tt,dt=polarToCartesian($,_e,at*Math.cos(ot*RADIAN),pt);return{center:lt,circleTangency:ut,lineTangency:dt,theta:ot}},getSectorPath=j=>{var{cx:$,cy:_e,innerRadius:et,outerRadius:tt,startAngle:nt,endAngle:rt}=j,it=getDeltaAngle$1(nt,rt),st=nt+it,at=polarToCartesian($,_e,tt,nt),ot=polarToCartesian($,_e,tt,st),ct="M ".concat(at.x,",").concat(at.y,`
    A `).concat(tt,",").concat(tt,`,0,
    `).concat(+(Math.abs(it)>180),",").concat(+(nt>st),`,
    `).concat(ot.x,",").concat(ot.y,`
  `);if(et>0){var lt=polarToCartesian($,_e,et,nt),ut=polarToCartesian($,_e,et,st);ct+="L ".concat(ut.x,",").concat(ut.y,`
            A `).concat(et,",").concat(et,`,0,
            `).concat(+(Math.abs(it)>180),",").concat(+(nt<=st),`,
            `).concat(lt.x,",").concat(lt.y," Z")}else ct+="L ".concat($,",").concat(_e," Z");return ct},getSectorWithCorner=j=>{var{cx:$,cy:_e,innerRadius:et,outerRadius:tt,cornerRadius:nt,forceCornerRadius:rt,cornerIsExternal:it,startAngle:st,endAngle:at}=j,ot=mathSign(at-st),{circleTangency:ct,lineTangency:lt,theta:ut}=getTangentCircle({cx:$,cy:_e,radius:tt,angle:st,sign:ot,cornerRadius:nt,cornerIsExternal:it}),{circleTangency:pt,lineTangency:dt,theta:ht}=getTangentCircle({cx:$,cy:_e,radius:tt,angle:at,sign:-ot,cornerRadius:nt,cornerIsExternal:it}),ft=it?Math.abs(st-at):Math.abs(st-at)-ut-ht;if(ft<0)return rt?"M ".concat(lt.x,",").concat(lt.y,`
        a`).concat(nt,",").concat(nt,",0,0,1,").concat(nt*2,`,0
        a`).concat(nt,",").concat(nt,",0,0,1,").concat(-nt*2,`,0
      `):getSectorPath({cx:$,cy:_e,innerRadius:et,outerRadius:tt,startAngle:st,endAngle:at});var mt="M ".concat(lt.x,",").concat(lt.y,`
    A`).concat(nt,",").concat(nt,",0,0,").concat(+(ot<0),",").concat(ct.x,",").concat(ct.y,`
    A`).concat(tt,",").concat(tt,",0,").concat(+(ft>180),",").concat(+(ot<0),",").concat(pt.x,",").concat(pt.y,`
    A`).concat(nt,",").concat(nt,",0,0,").concat(+(ot<0),",").concat(dt.x,",").concat(dt.y,`
  `);if(et>0){var{circleTangency:gt,lineTangency:yt,theta:vt}=getTangentCircle({cx:$,cy:_e,radius:et,angle:st,sign:ot,isExternal:!0,cornerRadius:nt,cornerIsExternal:it}),{circleTangency:xt,lineTangency:St,theta:Et}=getTangentCircle({cx:$,cy:_e,radius:et,angle:at,sign:-ot,isExternal:!0,cornerRadius:nt,cornerIsExternal:it}),wt=it?Math.abs(st-at):Math.abs(st-at)-vt-Et;if(wt<0&&nt===0)return"".concat(mt,"L").concat($,",").concat(_e,"Z");mt+="L".concat(St.x,",").concat(St.y,`
      A`).concat(nt,",").concat(nt,",0,0,").concat(+(ot<0),",").concat(xt.x,",").concat(xt.y,`
      A`).concat(et,",").concat(et,",0,").concat(+(wt>180),",").concat(+(ot>0),",").concat(gt.x,",").concat(gt.y,`
      A`).concat(nt,",").concat(nt,",0,0,").concat(+(ot<0),",").concat(yt.x,",").concat(yt.y,"Z")}else mt+="L".concat($,",").concat(_e,"Z");return mt},defaultSectorProps={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Sector=j=>{var $=resolveDefaultProps(j,defaultSectorProps),{cx:_e,cy:et,innerRadius:tt,outerRadius:nt,cornerRadius:rt,forceCornerRadius:it,cornerIsExternal:st,startAngle:at,endAngle:ot,className:ct}=$;if(nt<tt||at===ot)return null;var lt=clsx("recharts-sector",ct),ut=nt-tt,pt=getPercentValue(rt,ut,0,!0),dt;return pt>0&&Math.abs(at-ot)<360?dt=getSectorWithCorner({cx:_e,cy:et,innerRadius:tt,outerRadius:nt,cornerRadius:Math.min(pt,ut/2),forceCornerRadius:it,cornerIsExternal:st,startAngle:at,endAngle:ot}):dt=getSectorPath({cx:_e,cy:et,innerRadius:tt,outerRadius:nt,startAngle:at,endAngle:ot}),reactExports.createElement("path",_extends$g({},svgPropertiesAndEvents($),{className:lt,d:dt}))};function getCursorPoints(j,$,_e){if(j==="horizontal")return[{x:$.x,y:_e.top},{x:$.x,y:_e.top+_e.height}];if(j==="vertical")return[{x:_e.left,y:$.y},{x:_e.left+_e.width,y:$.y}];if(isPolarCoordinate($)){if(j==="centric"){var{cx:et,cy:tt,innerRadius:nt,outerRadius:rt,angle:it}=$,st=polarToCartesian(et,tt,nt,it),at=polarToCartesian(et,tt,rt,it);return[{x:st.x,y:st.y},{x:at.x,y:at.y}]}return getRadialCursorPoints($)}}var range$4={},toFinite={},toNumber={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isSymbol;function _e(et){return $.isSymbol(et)?NaN:Number(et)}j.toNumber=_e})(toNumber);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=toNumber;function _e(et){return et?(et=$.toNumber(et),et===1/0||et===-1/0?(et<0?-1:1)*Number.MAX_VALUE:et===et?et:0):et===0?et:0}j.toFinite=_e})(toFinite);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=isIterateeCall,_e=toFinite;function et(tt,nt,rt){rt&&typeof rt!="number"&&$.isIterateeCall(tt,nt,rt)&&(nt=rt=void 0),tt=_e.toFinite(tt),nt===void 0?(nt=tt,tt=0):nt=_e.toFinite(nt),rt=rt===void 0?tt<nt?1:-1:_e.toFinite(rt);const it=Math.max(Math.ceil((nt-tt)/(rt||1)),0),st=new Array(it);for(let at=0;at<it;at++)st[at]=tt,tt+=rt;return st}j.range=et})(range$4);var range$2=range$4.range;const range$3=getDefaultExportFromCjs$1(range$2);function ascending(j,$){return j==null||$==null?NaN:j<$?-1:j>$?1:j>=$?0:NaN}function descending(j,$){return j==null||$==null?NaN:$<j?-1:$>j?1:$>=j?0:NaN}function bisector(j){let $,_e,et;j.length!==2?($=ascending,_e=(it,st)=>ascending(j(it),st),et=(it,st)=>j(it)-st):($=j===ascending||j===descending?j:zero$1,_e=j,et=j);function tt(it,st,at=0,ot=it.length){if(at<ot){if($(st,st)!==0)return ot;do{const ct=at+ot>>>1;_e(it[ct],st)<0?at=ct+1:ot=ct}while(at<ot)}return at}function nt(it,st,at=0,ot=it.length){if(at<ot){if($(st,st)!==0)return ot;do{const ct=at+ot>>>1;_e(it[ct],st)<=0?at=ct+1:ot=ct}while(at<ot)}return at}function rt(it,st,at=0,ot=it.length){const ct=tt(it,st,at,ot-1);return ct>at&&et(it[ct-1],st)>-et(it[ct],st)?ct-1:ct}return{left:tt,center:rt,right:nt}}function zero$1(){return 0}function number$2(j){return j===null?NaN:+j}function*numbers(j,$){for(let _e of j)_e!=null&&(_e=+_e)>=_e&&(yield _e)}const ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right;bisector(number$2).center;class InternMap extends Map{constructor($,_e=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:_e}}),$!=null)for(const[et,tt]of $)this.set(et,tt)}get($){return super.get(intern_get(this,$))}has($){return super.has(intern_get(this,$))}set($,_e){return super.set(intern_set(this,$),_e)}delete($){return super.delete(intern_delete(this,$))}}function intern_get({_intern:j,_key:$},_e){const et=$(_e);return j.has(et)?j.get(et):_e}function intern_set({_intern:j,_key:$},_e){const et=$(_e);return j.has(et)?j.get(et):(j.set(et,_e),_e)}function intern_delete({_intern:j,_key:$},_e){const et=$(_e);return j.has(et)&&(_e=j.get(et),j.delete(et)),_e}function keyof(j){return j!==null&&typeof j=="object"?j.valueOf():j}function compareDefined(j=ascending){if(j===ascending)return ascendingDefined;if(typeof j!="function")throw new TypeError("compare is not a function");return($,_e)=>{const et=j($,_e);return et||et===0?et:(j(_e,_e)===0)-(j($,$)===0)}}function ascendingDefined(j,$){return(j==null||!(j>=j))-($==null||!($>=$))||(j<$?-1:j>$?1:0)}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(j,$,_e){const et=($-j)/Math.max(0,_e),tt=Math.floor(Math.log10(et)),nt=et/Math.pow(10,tt),rt=nt>=e10?10:nt>=e5?5:nt>=e2?2:1;let it,st,at;return tt<0?(at=Math.pow(10,-tt)/rt,it=Math.round(j*at),st=Math.round($*at),it/at<j&&++it,st/at>$&&--st,at=-at):(at=Math.pow(10,tt)*rt,it=Math.round(j/at),st=Math.round($/at),it*at<j&&++it,st*at>$&&--st),st<it&&.5<=_e&&_e<2?tickSpec(j,$,_e*2):[it,st,at]}function ticks(j,$,_e){if($=+$,j=+j,_e=+_e,!(_e>0))return[];if(j===$)return[j];const et=$<j,[tt,nt,rt]=et?tickSpec($,j,_e):tickSpec(j,$,_e);if(!(nt>=tt))return[];const it=nt-tt+1,st=new Array(it);if(et)if(rt<0)for(let at=0;at<it;++at)st[at]=(nt-at)/-rt;else for(let at=0;at<it;++at)st[at]=(nt-at)*rt;else if(rt<0)for(let at=0;at<it;++at)st[at]=(tt+at)/-rt;else for(let at=0;at<it;++at)st[at]=(tt+at)*rt;return st}function tickIncrement(j,$,_e){return $=+$,j=+j,_e=+_e,tickSpec(j,$,_e)[2]}function tickStep(j,$,_e){$=+$,j=+j,_e=+_e;const et=$<j,tt=et?tickIncrement($,j,_e):tickIncrement(j,$,_e);return(et?-1:1)*(tt<0?1/-tt:tt)}function max(j,$){let _e;for(const et of j)et!=null&&(_e<et||_e===void 0&&et>=et)&&(_e=et);return _e}function min(j,$){let _e;for(const et of j)et!=null&&(_e>et||_e===void 0&&et>=et)&&(_e=et);return _e}function quickselect(j,$,_e=0,et=1/0,tt){if($=Math.floor($),_e=Math.floor(Math.max(0,_e)),et=Math.floor(Math.min(j.length-1,et)),!(_e<=$&&$<=et))return j;for(tt=tt===void 0?ascendingDefined:compareDefined(tt);et>_e;){if(et-_e>600){const st=et-_e+1,at=$-_e+1,ot=Math.log(st),ct=.5*Math.exp(2*ot/3),lt=.5*Math.sqrt(ot*ct*(st-ct)/st)*(at-st/2<0?-1:1),ut=Math.max(_e,Math.floor($-at*ct/st+lt)),pt=Math.min(et,Math.floor($+(st-at)*ct/st+lt));quickselect(j,$,ut,pt,tt)}const nt=j[$];let rt=_e,it=et;for(swap(j,_e,$),tt(j[et],nt)>0&&swap(j,_e,et);rt<it;){for(swap(j,rt,it),++rt,--it;tt(j[rt],nt)<0;)++rt;for(;tt(j[it],nt)>0;)--it}tt(j[_e],nt)===0?swap(j,_e,it):(++it,swap(j,it,et)),it<=$&&(_e=it+1),$<=it&&(et=it-1)}return j}function swap(j,$,_e){const et=j[$];j[$]=j[_e],j[_e]=et}function quantile$1(j,$,_e){if(j=Float64Array.from(numbers(j)),!(!(et=j.length)||isNaN($=+$))){if($<=0||et<2)return min(j);if($>=1)return max(j);var et,tt=(et-1)*$,nt=Math.floor(tt),rt=max(quickselect(j,nt).subarray(0,nt+1)),it=min(j.subarray(nt+1));return rt+(it-rt)*(tt-nt)}}function quantileSorted(j,$,_e=number$2){if(!(!(et=j.length)||isNaN($=+$))){if($<=0||et<2)return+_e(j[0],0,j);if($>=1)return+_e(j[et-1],et-1,j);var et,tt=(et-1)*$,nt=Math.floor(tt),rt=+_e(j[nt],nt,j),it=+_e(j[nt+1],nt+1,j);return rt+(it-rt)*(tt-nt)}}function range$1(j,$,_e){j=+j,$=+$,_e=(tt=arguments.length)<2?($=j,j=0,1):tt<3?1:+_e;for(var et=-1,tt=Math.max(0,Math.ceil(($-j)/_e))|0,nt=new Array(tt);++et<tt;)nt[et]=j+et*_e;return nt}function initRange(j,$){switch(arguments.length){case 0:break;case 1:this.range(j);break;default:this.range($).domain(j);break}return this}function initInterpolator(j,$){switch(arguments.length){case 0:break;case 1:{typeof j=="function"?this.interpolator(j):this.range(j);break}default:{this.domain(j),typeof $=="function"?this.interpolator($):this.range($);break}}return this}const implicit=Symbol("implicit");function ordinal(){var j=new InternMap,$=[],_e=[],et=implicit;function tt(nt){let rt=j.get(nt);if(rt===void 0){if(et!==implicit)return et;j.set(nt,rt=$.push(nt)-1)}return _e[rt%_e.length]}return tt.domain=function(nt){if(!arguments.length)return $.slice();$=[],j=new InternMap;for(const rt of nt)j.has(rt)||j.set(rt,$.push(rt)-1);return tt},tt.range=function(nt){return arguments.length?(_e=Array.from(nt),tt):_e.slice()},tt.unknown=function(nt){return arguments.length?(et=nt,tt):et},tt.copy=function(){return ordinal($,_e).unknown(et)},initRange.apply(tt,arguments),tt}function band(){var j=ordinal().unknown(void 0),$=j.domain,_e=j.range,et=0,tt=1,nt,rt,it=!1,st=0,at=0,ot=.5;delete j.unknown;function ct(){var lt=$().length,ut=tt<et,pt=ut?tt:et,dt=ut?et:tt;nt=(dt-pt)/Math.max(1,lt-st+at*2),it&&(nt=Math.floor(nt)),pt+=(dt-pt-nt*(lt-st))*ot,rt=nt*(1-st),it&&(pt=Math.round(pt),rt=Math.round(rt));var ht=range$1(lt).map(function(ft){return pt+nt*ft});return _e(ut?ht.reverse():ht)}return j.domain=function(lt){return arguments.length?($(lt),ct()):$()},j.range=function(lt){return arguments.length?([et,tt]=lt,et=+et,tt=+tt,ct()):[et,tt]},j.rangeRound=function(lt){return[et,tt]=lt,et=+et,tt=+tt,it=!0,ct()},j.bandwidth=function(){return rt},j.step=function(){return nt},j.round=function(lt){return arguments.length?(it=!!lt,ct()):it},j.padding=function(lt){return arguments.length?(st=Math.min(1,at=+lt),ct()):st},j.paddingInner=function(lt){return arguments.length?(st=Math.min(1,lt),ct()):st},j.paddingOuter=function(lt){return arguments.length?(at=+lt,ct()):at},j.align=function(lt){return arguments.length?(ot=Math.max(0,Math.min(1,lt)),ct()):ot},j.copy=function(){return band($(),[et,tt]).round(it).paddingInner(st).paddingOuter(at).align(ot)},initRange.apply(ct(),arguments)}function pointish(j){var $=j.copy;return j.padding=j.paddingOuter,delete j.paddingInner,delete j.paddingOuter,j.copy=function(){return pointish($())},j}function point(){return pointish(band.apply(null,arguments).paddingInner(1))}function define(j,$,_e){j.prototype=$.prototype=_e,_e.constructor=j}function extend(j,$){var _e=Object.create(j.prototype);for(var et in $)_e[et]=$[et];return _e}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(j){return Object.assign(new this.constructor,this,j)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(j){var $,_e;return j=(j+"").trim().toLowerCase(),($=reHex.exec(j))?(_e=$[1].length,$=parseInt($[1],16),_e===6?rgbn($):_e===3?new Rgb($>>8&15|$>>4&240,$>>4&15|$&240,($&15)<<4|$&15,1):_e===8?rgba($>>24&255,$>>16&255,$>>8&255,($&255)/255):_e===4?rgba($>>12&15|$>>8&240,$>>8&15|$>>4&240,$>>4&15|$&240,(($&15)<<4|$&15)/255):null):($=reRgbInteger.exec(j))?new Rgb($[1],$[2],$[3],1):($=reRgbPercent.exec(j))?new Rgb($[1]*255/100,$[2]*255/100,$[3]*255/100,1):($=reRgbaInteger.exec(j))?rgba($[1],$[2],$[3],$[4]):($=reRgbaPercent.exec(j))?rgba($[1]*255/100,$[2]*255/100,$[3]*255/100,$[4]):($=reHslPercent.exec(j))?hsla($[1],$[2]/100,$[3]/100,1):($=reHslaPercent.exec(j))?hsla($[1],$[2]/100,$[3]/100,$[4]):named.hasOwnProperty(j)?rgbn(named[j]):j==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(j){return new Rgb(j>>16&255,j>>8&255,j&255,1)}function rgba(j,$,_e,et){return et<=0&&(j=$=_e=NaN),new Rgb(j,$,_e,et)}function rgbConvert(j){return j instanceof Color||(j=color(j)),j?(j=j.rgb(),new Rgb(j.r,j.g,j.b,j.opacity)):new Rgb}function rgb$1(j,$,_e,et){return arguments.length===1?rgbConvert(j):new Rgb(j,$,_e,et??1)}function Rgb(j,$,_e,et){this.r=+j,this.g=+$,this.b=+_e,this.opacity=+et}define(Rgb,rgb$1,extend(Color,{brighter(j){return j=j==null?brighter:Math.pow(brighter,j),new Rgb(this.r*j,this.g*j,this.b*j,this.opacity)},darker(j){return j=j==null?darker:Math.pow(darker,j),new Rgb(this.r*j,this.g*j,this.b*j,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const j=clampa(this.opacity);return`${j===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${j===1?")":`, ${j})`}`}function clampa(j){return isNaN(j)?1:Math.max(0,Math.min(1,j))}function clampi(j){return Math.max(0,Math.min(255,Math.round(j)||0))}function hex(j){return j=clampi(j),(j<16?"0":"")+j.toString(16)}function hsla(j,$,_e,et){return et<=0?j=$=_e=NaN:_e<=0||_e>=1?j=$=NaN:$<=0&&(j=NaN),new Hsl(j,$,_e,et)}function hslConvert(j){if(j instanceof Hsl)return new Hsl(j.h,j.s,j.l,j.opacity);if(j instanceof Color||(j=color(j)),!j)return new Hsl;if(j instanceof Hsl)return j;j=j.rgb();var $=j.r/255,_e=j.g/255,et=j.b/255,tt=Math.min($,_e,et),nt=Math.max($,_e,et),rt=NaN,it=nt-tt,st=(nt+tt)/2;return it?($===nt?rt=(_e-et)/it+(_e<et)*6:_e===nt?rt=(et-$)/it+2:rt=($-_e)/it+4,it/=st<.5?nt+tt:2-nt-tt,rt*=60):it=st>0&&st<1?0:rt,new Hsl(rt,it,st,j.opacity)}function hsl(j,$,_e,et){return arguments.length===1?hslConvert(j):new Hsl(j,$,_e,et??1)}function Hsl(j,$,_e,et){this.h=+j,this.s=+$,this.l=+_e,this.opacity=+et}define(Hsl,hsl,extend(Color,{brighter(j){return j=j==null?brighter:Math.pow(brighter,j),new Hsl(this.h,this.s,this.l*j,this.opacity)},darker(j){return j=j==null?darker:Math.pow(darker,j),new Hsl(this.h,this.s,this.l*j,this.opacity)},rgb(){var j=this.h%360+(this.h<0)*360,$=isNaN(j)||isNaN(this.s)?0:this.s,_e=this.l,et=_e+(_e<.5?_e:1-_e)*$,tt=2*_e-et;return new Rgb(hsl2rgb(j>=240?j-240:j+120,tt,et),hsl2rgb(j,tt,et),hsl2rgb(j<120?j+240:j-120,tt,et),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const j=clampa(this.opacity);return`${j===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${j===1?")":`, ${j})`}`}}));function clamph(j){return j=(j||0)%360,j<0?j+360:j}function clampt(j){return Math.max(0,Math.min(1,j||0))}function hsl2rgb(j,$,_e){return(j<60?$+(_e-$)*j/60:j<180?_e:j<240?$+(_e-$)*(240-j)/60:$)*255}const constant=j=>()=>j;function linear$1(j,$){return function(_e){return j+_e*$}}function exponential(j,$,_e){return j=Math.pow(j,_e),$=Math.pow($,_e)-j,_e=1/_e,function(et){return Math.pow(j+et*$,_e)}}function gamma(j){return(j=+j)==1?nogamma:function($,_e){return _e-$?exponential($,_e,j):constant(isNaN($)?_e:$)}}function nogamma(j,$){var _e=$-j;return _e?linear$1(j,_e):constant(isNaN(j)?$:j)}const rgb=function j($){var _e=gamma($);function et(tt,nt){var rt=_e((tt=rgb$1(tt)).r,(nt=rgb$1(nt)).r),it=_e(tt.g,nt.g),st=_e(tt.b,nt.b),at=nogamma(tt.opacity,nt.opacity);return function(ot){return tt.r=rt(ot),tt.g=it(ot),tt.b=st(ot),tt.opacity=at(ot),tt+""}}return et.gamma=j,et}(1);function numberArray(j,$){$||($=[]);var _e=j?Math.min($.length,j.length):0,et=$.slice(),tt;return function(nt){for(tt=0;tt<_e;++tt)et[tt]=j[tt]*(1-nt)+$[tt]*nt;return et}}function isNumberArray(j){return ArrayBuffer.isView(j)&&!(j instanceof DataView)}function genericArray(j,$){var _e=$?$.length:0,et=j?Math.min(_e,j.length):0,tt=new Array(et),nt=new Array(_e),rt;for(rt=0;rt<et;++rt)tt[rt]=interpolate(j[rt],$[rt]);for(;rt<_e;++rt)nt[rt]=$[rt];return function(it){for(rt=0;rt<et;++rt)nt[rt]=tt[rt](it);return nt}}function date$1(j,$){var _e=new Date;return j=+j,$=+$,function(et){return _e.setTime(j*(1-et)+$*et),_e}}function interpolateNumber(j,$){return j=+j,$=+$,function(_e){return j*(1-_e)+$*_e}}function object(j,$){var _e={},et={},tt;(j===null||typeof j!="object")&&(j={}),($===null||typeof $!="object")&&($={});for(tt in $)tt in j?_e[tt]=interpolate(j[tt],$[tt]):et[tt]=$[tt];return function(nt){for(tt in _e)et[tt]=_e[tt](nt);return et}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(j){return function(){return j}}function one(j){return function($){return j($)+""}}function string(j,$){var _e=reA.lastIndex=reB.lastIndex=0,et,tt,nt,rt=-1,it=[],st=[];for(j=j+"",$=$+"";(et=reA.exec(j))&&(tt=reB.exec($));)(nt=tt.index)>_e&&(nt=$.slice(_e,nt),it[rt]?it[rt]+=nt:it[++rt]=nt),(et=et[0])===(tt=tt[0])?it[rt]?it[rt]+=tt:it[++rt]=tt:(it[++rt]=null,st.push({i:rt,x:interpolateNumber(et,tt)})),_e=reB.lastIndex;return _e<$.length&&(nt=$.slice(_e),it[rt]?it[rt]+=nt:it[++rt]=nt),it.length<2?st[0]?one(st[0].x):zero($):($=st.length,function(at){for(var ot=0,ct;ot<$;++ot)it[(ct=st[ot]).i]=ct.x(at);return it.join("")})}function interpolate(j,$){var _e=typeof $,et;return $==null||_e==="boolean"?constant($):(_e==="number"?interpolateNumber:_e==="string"?(et=color($))?($=et,rgb):string:$ instanceof color?rgb:$ instanceof Date?date$1:isNumberArray($)?numberArray:Array.isArray($)?genericArray:typeof $.valueOf!="function"&&typeof $.toString!="function"||isNaN($)?object:interpolateNumber)(j,$)}function interpolateRound(j,$){return j=+j,$=+$,function(_e){return Math.round(j*(1-_e)+$*_e)}}function piecewise(j,$){$===void 0&&($=j,j=interpolate);for(var _e=0,et=$.length-1,tt=$[0],nt=new Array(et<0?0:et);_e<et;)nt[_e]=j(tt,tt=$[++_e]);return function(rt){var it=Math.max(0,Math.min(et-1,Math.floor(rt*=et)));return nt[it](rt-it)}}function constants(j){return function(){return j}}function number$1(j){return+j}var unit=[0,1];function identity$3(j){return j}function normalize(j,$){return($-=j=+j)?function(_e){return(_e-j)/$}:constants(isNaN($)?NaN:.5)}function clamper(j,$){var _e;return j>$&&(_e=j,j=$,$=_e),function(et){return Math.max(j,Math.min($,et))}}function bimap(j,$,_e){var et=j[0],tt=j[1],nt=$[0],rt=$[1];return tt<et?(et=normalize(tt,et),nt=_e(rt,nt)):(et=normalize(et,tt),nt=_e(nt,rt)),function(it){return nt(et(it))}}function polymap(j,$,_e){var et=Math.min(j.length,$.length)-1,tt=new Array(et),nt=new Array(et),rt=-1;for(j[et]<j[0]&&(j=j.slice().reverse(),$=$.slice().reverse());++rt<et;)tt[rt]=normalize(j[rt],j[rt+1]),nt[rt]=_e($[rt],$[rt+1]);return function(it){var st=bisectRight(j,it,1,et)-1;return nt[st](tt[st](it))}}function copy$1(j,$){return $.domain(j.domain()).range(j.range()).interpolate(j.interpolate()).clamp(j.clamp()).unknown(j.unknown())}function transformer$2(){var j=unit,$=unit,_e=interpolate,et,tt,nt,rt=identity$3,it,st,at;function ot(){var lt=Math.min(j.length,$.length);return rt!==identity$3&&(rt=clamper(j[0],j[lt-1])),it=lt>2?polymap:bimap,st=at=null,ct}function ct(lt){return lt==null||isNaN(lt=+lt)?nt:(st||(st=it(j.map(et),$,_e)))(et(rt(lt)))}return ct.invert=function(lt){return rt(tt((at||(at=it($,j.map(et),interpolateNumber)))(lt)))},ct.domain=function(lt){return arguments.length?(j=Array.from(lt,number$1),ot()):j.slice()},ct.range=function(lt){return arguments.length?($=Array.from(lt),ot()):$.slice()},ct.rangeRound=function(lt){return $=Array.from(lt),_e=interpolateRound,ot()},ct.clamp=function(lt){return arguments.length?(rt=lt?!0:identity$3,ot()):rt!==identity$3},ct.interpolate=function(lt){return arguments.length?(_e=lt,ot()):_e},ct.unknown=function(lt){return arguments.length?(nt=lt,ct):nt},function(lt,ut){return et=lt,tt=ut,ot()}}function continuous(){return transformer$2()(identity$3,identity$3)}function formatDecimal(j){return Math.abs(j=Math.round(j))>=1e21?j.toLocaleString("en").replace(/,/g,""):j.toString(10)}function formatDecimalParts(j,$){if((_e=(j=$?j.toExponential($-1):j.toExponential()).indexOf("e"))<0)return null;var _e,et=j.slice(0,_e);return[et.length>1?et[0]+et.slice(2):et,+j.slice(_e+1)]}function exponent(j){return j=formatDecimalParts(Math.abs(j)),j?j[1]:NaN}function formatGroup(j,$){return function(_e,et){for(var tt=_e.length,nt=[],rt=0,it=j[0],st=0;tt>0&&it>0&&(st+it+1>et&&(it=Math.max(1,et-st)),nt.push(_e.substring(tt-=it,tt+it)),!((st+=it+1)>et));)it=j[rt=(rt+1)%j.length];return nt.reverse().join($)}}function formatNumerals(j){return function($){return $.replace(/[0-9]/g,function(_e){return j[+_e]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(j){if(!($=re.exec(j)))throw new Error("invalid format: "+j);var $;return new FormatSpecifier({fill:$[1],align:$[2],sign:$[3],symbol:$[4],zero:$[5],width:$[6],comma:$[7],precision:$[8]&&$[8].slice(1),trim:$[9],type:$[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(j){this.fill=j.fill===void 0?" ":j.fill+"",this.align=j.align===void 0?">":j.align+"",this.sign=j.sign===void 0?"-":j.sign+"",this.symbol=j.symbol===void 0?"":j.symbol+"",this.zero=!!j.zero,this.width=j.width===void 0?void 0:+j.width,this.comma=!!j.comma,this.precision=j.precision===void 0?void 0:+j.precision,this.trim=!!j.trim,this.type=j.type===void 0?"":j.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(j){e:for(var $=j.length,_e=1,et=-1,tt;_e<$;++_e)switch(j[_e]){case".":et=tt=_e;break;case"0":et===0&&(et=_e),tt=_e;break;default:if(!+j[_e])break e;et>0&&(et=0);break}return et>0?j.slice(0,et)+j.slice(tt+1):j}var prefixExponent;function formatPrefixAuto(j,$){var _e=formatDecimalParts(j,$);if(!_e)return j+"";var et=_e[0],tt=_e[1],nt=tt-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(tt/3)))*3)+1,rt=et.length;return nt===rt?et:nt>rt?et+new Array(nt-rt+1).join("0"):nt>0?et.slice(0,nt)+"."+et.slice(nt):"0."+new Array(1-nt).join("0")+formatDecimalParts(j,Math.max(0,$+nt-1))[0]}function formatRounded(j,$){var _e=formatDecimalParts(j,$);if(!_e)return j+"";var et=_e[0],tt=_e[1];return tt<0?"0."+new Array(-tt).join("0")+et:et.length>tt+1?et.slice(0,tt+1)+"."+et.slice(tt+1):et+new Array(tt-et.length+2).join("0")}const formatTypes={"%":(j,$)=>(j*100).toFixed($),b:j=>Math.round(j).toString(2),c:j=>j+"",d:formatDecimal,e:(j,$)=>j.toExponential($),f:(j,$)=>j.toFixed($),g:(j,$)=>j.toPrecision($),o:j=>Math.round(j).toString(8),p:(j,$)=>formatRounded(j*100,$),r:formatRounded,s:formatPrefixAuto,X:j=>Math.round(j).toString(16).toUpperCase(),x:j=>Math.round(j).toString(16)};function identity$2(j){return j}var map$1=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(j){var $=j.grouping===void 0||j.thousands===void 0?identity$2:formatGroup(map$1.call(j.grouping,Number),j.thousands+""),_e=j.currency===void 0?"":j.currency[0]+"",et=j.currency===void 0?"":j.currency[1]+"",tt=j.decimal===void 0?".":j.decimal+"",nt=j.numerals===void 0?identity$2:formatNumerals(map$1.call(j.numerals,String)),rt=j.percent===void 0?"%":j.percent+"",it=j.minus===void 0?"":j.minus+"",st=j.nan===void 0?"NaN":j.nan+"";function at(ct){ct=formatSpecifier(ct);var lt=ct.fill,ut=ct.align,pt=ct.sign,dt=ct.symbol,ht=ct.zero,ft=ct.width,mt=ct.comma,gt=ct.precision,yt=ct.trim,vt=ct.type;vt==="n"?(mt=!0,vt="g"):formatTypes[vt]||(gt===void 0&&(gt=12),yt=!0,vt="g"),(ht||lt==="0"&&ut==="=")&&(ht=!0,lt="0",ut="=");var xt=dt==="$"?_e:dt==="#"&&/[boxX]/.test(vt)?"0"+vt.toLowerCase():"",St=dt==="$"?et:/[%p]/.test(vt)?rt:"",Et=formatTypes[vt],wt=/[defgprs%]/.test(vt);gt=gt===void 0?6:/[gprs]/.test(vt)?Math.max(1,Math.min(21,gt)):Math.max(0,Math.min(20,gt));function Tt(Ct){var Rt=xt,jt=St,Ot,$t,Kt;if(vt==="c")jt=Et(Ct)+jt,Ct="";else{Ct=+Ct;var Lt=Ct<0||1/Ct<0;if(Ct=isNaN(Ct)?st:Et(Math.abs(Ct),gt),yt&&(Ct=formatTrim(Ct)),Lt&&+Ct==0&&pt!=="+"&&(Lt=!1),Rt=(Lt?pt==="("?pt:it:pt==="-"||pt==="("?"":pt)+Rt,jt=(vt==="s"?prefixes[8+prefixExponent/3]:"")+jt+(Lt&&pt==="("?")":""),wt){for(Ot=-1,$t=Ct.length;++Ot<$t;)if(Kt=Ct.charCodeAt(Ot),48>Kt||Kt>57){jt=(Kt===46?tt+Ct.slice(Ot+1):Ct.slice(Ot))+jt,Ct=Ct.slice(0,Ot);break}}}mt&&!ht&&(Ct=$(Ct,1/0));var Nt=Rt.length+Ct.length+jt.length,Bt=Nt<ft?new Array(ft-Nt+1).join(lt):"";switch(mt&&ht&&(Ct=$(Bt+Ct,Bt.length?ft-jt.length:1/0),Bt=""),ut){case"<":Ct=Rt+Ct+jt+Bt;break;case"=":Ct=Rt+Bt+Ct+jt;break;case"^":Ct=Bt.slice(0,Nt=Bt.length>>1)+Rt+Ct+jt+Bt.slice(Nt);break;default:Ct=Bt+Rt+Ct+jt;break}return nt(Ct)}return Tt.toString=function(){return ct+""},Tt}function ot(ct,lt){var ut=at((ct=formatSpecifier(ct),ct.type="f",ct)),pt=Math.max(-8,Math.min(8,Math.floor(exponent(lt)/3)))*3,dt=Math.pow(10,-pt),ht=prefixes[8+pt/3];return function(ft){return ut(dt*ft)+ht}}return{format:at,formatPrefix:ot}}var locale$1,format,formatPrefix;defaultLocale$1({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$1(j){return locale$1=formatLocale$1(j),format=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(j){return Math.max(0,-exponent(Math.abs(j)))}function precisionPrefix(j,$){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent($)/3)))*3-exponent(Math.abs(j)))}function precisionRound(j,$){return j=Math.abs(j),$=Math.abs($)-j,Math.max(0,exponent($)-exponent(j))+1}function tickFormat(j,$,_e,et){var tt=tickStep(j,$,_e),nt;switch(et=formatSpecifier(et??",f"),et.type){case"s":{var rt=Math.max(Math.abs(j),Math.abs($));return et.precision==null&&!isNaN(nt=precisionPrefix(tt,rt))&&(et.precision=nt),formatPrefix(et,rt)}case"":case"e":case"g":case"p":case"r":{et.precision==null&&!isNaN(nt=precisionRound(tt,Math.max(Math.abs(j),Math.abs($))))&&(et.precision=nt-(et.type==="e"));break}case"f":case"%":{et.precision==null&&!isNaN(nt=precisionFixed(tt))&&(et.precision=nt-(et.type==="%")*2);break}}return format(et)}function linearish(j){var $=j.domain;return j.ticks=function(_e){var et=$();return ticks(et[0],et[et.length-1],_e??10)},j.tickFormat=function(_e,et){var tt=$();return tickFormat(tt[0],tt[tt.length-1],_e??10,et)},j.nice=function(_e){_e==null&&(_e=10);var et=$(),tt=0,nt=et.length-1,rt=et[tt],it=et[nt],st,at,ot=10;for(it<rt&&(at=rt,rt=it,it=at,at=tt,tt=nt,nt=at);ot-- >0;){if(at=tickIncrement(rt,it,_e),at===st)return et[tt]=rt,et[nt]=it,$(et);if(at>0)rt=Math.floor(rt/at)*at,it=Math.ceil(it/at)*at;else if(at<0)rt=Math.ceil(rt*at)/at,it=Math.floor(it*at)/at;else break;st=at}return j},j}function linear(){var j=continuous();return j.copy=function(){return copy$1(j,linear())},initRange.apply(j,arguments),linearish(j)}function identity$1(j){var $;function _e(et){return et==null||isNaN(et=+et)?$:et}return _e.invert=_e,_e.domain=_e.range=function(et){return arguments.length?(j=Array.from(et,number$1),_e):j.slice()},_e.unknown=function(et){return arguments.length?($=et,_e):$},_e.copy=function(){return identity$1(j).unknown($)},j=arguments.length?Array.from(j,number$1):[0,1],linearish(_e)}function nice(j,$){j=j.slice();var _e=0,et=j.length-1,tt=j[_e],nt=j[et],rt;return nt<tt&&(rt=_e,_e=et,et=rt,rt=tt,tt=nt,nt=rt),j[_e]=$.floor(tt),j[et]=$.ceil(nt),j}function transformLog(j){return Math.log(j)}function transformExp(j){return Math.exp(j)}function transformLogn(j){return-Math.log(-j)}function transformExpn(j){return-Math.exp(-j)}function pow10(j){return isFinite(j)?+("1e"+j):j<0?0:j}function powp(j){return j===10?pow10:j===Math.E?Math.exp:$=>Math.pow(j,$)}function logp(j){return j===Math.E?Math.log:j===10&&Math.log10||j===2&&Math.log2||(j=Math.log(j),$=>Math.log($)/j)}function reflect(j){return($,_e)=>-j(-$,_e)}function loggish(j){const $=j(transformLog,transformExp),_e=$.domain;let et=10,tt,nt;function rt(){return tt=logp(et),nt=powp(et),_e()[0]<0?(tt=reflect(tt),nt=reflect(nt),j(transformLogn,transformExpn)):j(transformLog,transformExp),$}return $.base=function(it){return arguments.length?(et=+it,rt()):et},$.domain=function(it){return arguments.length?(_e(it),rt()):_e()},$.ticks=it=>{const st=_e();let at=st[0],ot=st[st.length-1];const ct=ot<at;ct&&([at,ot]=[ot,at]);let lt=tt(at),ut=tt(ot),pt,dt;const ht=it==null?10:+it;let ft=[];if(!(et%1)&&ut-lt<ht){if(lt=Math.floor(lt),ut=Math.ceil(ut),at>0){for(;lt<=ut;++lt)for(pt=1;pt<et;++pt)if(dt=lt<0?pt/nt(-lt):pt*nt(lt),!(dt<at)){if(dt>ot)break;ft.push(dt)}}else for(;lt<=ut;++lt)for(pt=et-1;pt>=1;--pt)if(dt=lt>0?pt/nt(-lt):pt*nt(lt),!(dt<at)){if(dt>ot)break;ft.push(dt)}ft.length*2<ht&&(ft=ticks(at,ot,ht))}else ft=ticks(lt,ut,Math.min(ut-lt,ht)).map(nt);return ct?ft.reverse():ft},$.tickFormat=(it,st)=>{if(it==null&&(it=10),st==null&&(st=et===10?"s":","),typeof st!="function"&&(!(et%1)&&(st=formatSpecifier(st)).precision==null&&(st.trim=!0),st=format(st)),it===1/0)return st;const at=Math.max(1,et*it/$.ticks().length);return ot=>{let ct=ot/nt(Math.round(tt(ot)));return ct*et<et-.5&&(ct*=et),ct<=at?st(ot):""}},$.nice=()=>_e(nice(_e(),{floor:it=>nt(Math.floor(tt(it))),ceil:it=>nt(Math.ceil(tt(it)))})),$}function log(){const j=loggish(transformer$2()).domain([1,10]);return j.copy=()=>copy$1(j,log()).base(j.base()),initRange.apply(j,arguments),j}function transformSymlog(j){return function($){return Math.sign($)*Math.log1p(Math.abs($/j))}}function transformSymexp(j){return function($){return Math.sign($)*Math.expm1(Math.abs($))*j}}function symlogish(j){var $=1,_e=j(transformSymlog($),transformSymexp($));return _e.constant=function(et){return arguments.length?j(transformSymlog($=+et),transformSymexp($)):$},linearish(_e)}function symlog(){var j=symlogish(transformer$2());return j.copy=function(){return copy$1(j,symlog()).constant(j.constant())},initRange.apply(j,arguments)}function transformPow(j){return function($){return $<0?-Math.pow(-$,j):Math.pow($,j)}}function transformSqrt(j){return j<0?-Math.sqrt(-j):Math.sqrt(j)}function transformSquare(j){return j<0?-j*j:j*j}function powish(j){var $=j(identity$3,identity$3),_e=1;function et(){return _e===1?j(identity$3,identity$3):_e===.5?j(transformSqrt,transformSquare):j(transformPow(_e),transformPow(1/_e))}return $.exponent=function(tt){return arguments.length?(_e=+tt,et()):_e},linearish($)}function pow(){var j=powish(transformer$2());return j.copy=function(){return copy$1(j,pow()).exponent(j.exponent())},initRange.apply(j,arguments),j}function sqrt(){return pow.apply(null,arguments).exponent(.5)}function square(j){return Math.sign(j)*j*j}function unsquare(j){return Math.sign(j)*Math.sqrt(Math.abs(j))}function radial(){var j=continuous(),$=[0,1],_e=!1,et;function tt(nt){var rt=unsquare(j(nt));return isNaN(rt)?et:_e?Math.round(rt):rt}return tt.invert=function(nt){return j.invert(square(nt))},tt.domain=function(nt){return arguments.length?(j.domain(nt),tt):j.domain()},tt.range=function(nt){return arguments.length?(j.range(($=Array.from(nt,number$1)).map(square)),tt):$.slice()},tt.rangeRound=function(nt){return tt.range(nt).round(!0)},tt.round=function(nt){return arguments.length?(_e=!!nt,tt):_e},tt.clamp=function(nt){return arguments.length?(j.clamp(nt),tt):j.clamp()},tt.unknown=function(nt){return arguments.length?(et=nt,tt):et},tt.copy=function(){return radial(j.domain(),$).round(_e).clamp(j.clamp()).unknown(et)},initRange.apply(tt,arguments),linearish(tt)}function quantile(){var j=[],$=[],_e=[],et;function tt(){var rt=0,it=Math.max(1,$.length);for(_e=new Array(it-1);++rt<it;)_e[rt-1]=quantileSorted(j,rt/it);return nt}function nt(rt){return rt==null||isNaN(rt=+rt)?et:$[bisectRight(_e,rt)]}return nt.invertExtent=function(rt){var it=$.indexOf(rt);return it<0?[NaN,NaN]:[it>0?_e[it-1]:j[0],it<_e.length?_e[it]:j[j.length-1]]},nt.domain=function(rt){if(!arguments.length)return j.slice();j=[];for(let it of rt)it!=null&&!isNaN(it=+it)&&j.push(it);return j.sort(ascending),tt()},nt.range=function(rt){return arguments.length?($=Array.from(rt),tt()):$.slice()},nt.unknown=function(rt){return arguments.length?(et=rt,nt):et},nt.quantiles=function(){return _e.slice()},nt.copy=function(){return quantile().domain(j).range($).unknown(et)},initRange.apply(nt,arguments)}function quantize(){var j=0,$=1,_e=1,et=[.5],tt=[0,1],nt;function rt(st){return st!=null&&st<=st?tt[bisectRight(et,st,0,_e)]:nt}function it(){var st=-1;for(et=new Array(_e);++st<_e;)et[st]=((st+1)*$-(st-_e)*j)/(_e+1);return rt}return rt.domain=function(st){return arguments.length?([j,$]=st,j=+j,$=+$,it()):[j,$]},rt.range=function(st){return arguments.length?(_e=(tt=Array.from(st)).length-1,it()):tt.slice()},rt.invertExtent=function(st){var at=tt.indexOf(st);return at<0?[NaN,NaN]:at<1?[j,et[0]]:at>=_e?[et[_e-1],$]:[et[at-1],et[at]]},rt.unknown=function(st){return arguments.length&&(nt=st),rt},rt.thresholds=function(){return et.slice()},rt.copy=function(){return quantize().domain([j,$]).range(tt).unknown(nt)},initRange.apply(linearish(rt),arguments)}function threshold(){var j=[.5],$=[0,1],_e,et=1;function tt(nt){return nt!=null&&nt<=nt?$[bisectRight(j,nt,0,et)]:_e}return tt.domain=function(nt){return arguments.length?(j=Array.from(nt),et=Math.min(j.length,$.length-1),tt):j.slice()},tt.range=function(nt){return arguments.length?($=Array.from(nt),et=Math.min(j.length,$.length-1),tt):$.slice()},tt.invertExtent=function(nt){var rt=$.indexOf(nt);return[j[rt-1],j[rt]]},tt.unknown=function(nt){return arguments.length?(_e=nt,tt):_e},tt.copy=function(){return threshold().domain(j).range($).unknown(_e)},initRange.apply(tt,arguments)}const t0=new Date,t1=new Date;function timeInterval(j,$,_e,et){function tt(nt){return j(nt=arguments.length===0?new Date:new Date(+nt)),nt}return tt.floor=nt=>(j(nt=new Date(+nt)),nt),tt.ceil=nt=>(j(nt=new Date(nt-1)),$(nt,1),j(nt),nt),tt.round=nt=>{const rt=tt(nt),it=tt.ceil(nt);return nt-rt<it-nt?rt:it},tt.offset=(nt,rt)=>($(nt=new Date(+nt),rt==null?1:Math.floor(rt)),nt),tt.range=(nt,rt,it)=>{const st=[];if(nt=tt.ceil(nt),it=it==null?1:Math.floor(it),!(nt<rt)||!(it>0))return st;let at;do st.push(at=new Date(+nt)),$(nt,it),j(nt);while(at<nt&&nt<rt);return st},tt.filter=nt=>timeInterval(rt=>{if(rt>=rt)for(;j(rt),!nt(rt);)rt.setTime(rt-1)},(rt,it)=>{if(rt>=rt)if(it<0)for(;++it<=0;)for(;$(rt,-1),!nt(rt););else for(;--it>=0;)for(;$(rt,1),!nt(rt););}),_e&&(tt.count=(nt,rt)=>(t0.setTime(+nt),t1.setTime(+rt),j(t0),j(t1),Math.floor(_e(t0,t1))),tt.every=nt=>(nt=Math.floor(nt),!isFinite(nt)||!(nt>0)?null:nt>1?tt.filter(et?rt=>et(rt)%nt===0:rt=>tt.count(0,rt)%nt===0):tt)),tt}const millisecond=timeInterval(()=>{},(j,$)=>{j.setTime(+j+$)},(j,$)=>$-j);millisecond.every=j=>(j=Math.floor(j),!isFinite(j)||!(j>0)?null:j>1?timeInterval($=>{$.setTime(Math.floor($/j)*j)},($,_e)=>{$.setTime(+$+_e*j)},($,_e)=>(_e-$)/j):millisecond);millisecond.range;const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(j=>{j.setTime(j-j.getMilliseconds())},(j,$)=>{j.setTime(+j+$*durationSecond)},(j,$)=>($-j)/durationSecond,j=>j.getUTCSeconds());second.range;const timeMinute=timeInterval(j=>{j.setTime(j-j.getMilliseconds()-j.getSeconds()*durationSecond)},(j,$)=>{j.setTime(+j+$*durationMinute)},(j,$)=>($-j)/durationMinute,j=>j.getMinutes());timeMinute.range;const utcMinute=timeInterval(j=>{j.setUTCSeconds(0,0)},(j,$)=>{j.setTime(+j+$*durationMinute)},(j,$)=>($-j)/durationMinute,j=>j.getUTCMinutes());utcMinute.range;const timeHour=timeInterval(j=>{j.setTime(j-j.getMilliseconds()-j.getSeconds()*durationSecond-j.getMinutes()*durationMinute)},(j,$)=>{j.setTime(+j+$*durationHour)},(j,$)=>($-j)/durationHour,j=>j.getHours());timeHour.range;const utcHour=timeInterval(j=>{j.setUTCMinutes(0,0,0)},(j,$)=>{j.setTime(+j+$*durationHour)},(j,$)=>($-j)/durationHour,j=>j.getUTCHours());utcHour.range;const timeDay=timeInterval(j=>j.setHours(0,0,0,0),(j,$)=>j.setDate(j.getDate()+$),(j,$)=>($-j-($.getTimezoneOffset()-j.getTimezoneOffset())*durationMinute)/durationDay,j=>j.getDate()-1);timeDay.range;const utcDay=timeInterval(j=>{j.setUTCHours(0,0,0,0)},(j,$)=>{j.setUTCDate(j.getUTCDate()+$)},(j,$)=>($-j)/durationDay,j=>j.getUTCDate()-1);utcDay.range;const unixDay=timeInterval(j=>{j.setUTCHours(0,0,0,0)},(j,$)=>{j.setUTCDate(j.getUTCDate()+$)},(j,$)=>($-j)/durationDay,j=>Math.floor(j/durationDay));unixDay.range;function timeWeekday(j){return timeInterval($=>{$.setDate($.getDate()-($.getDay()+7-j)%7),$.setHours(0,0,0,0)},($,_e)=>{$.setDate($.getDate()+_e*7)},($,_e)=>(_e-$-(_e.getTimezoneOffset()-$.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(j){return timeInterval($=>{$.setUTCDate($.getUTCDate()-($.getUTCDay()+7-j)%7),$.setUTCHours(0,0,0,0)},($,_e)=>{$.setUTCDate($.getUTCDate()+_e*7)},($,_e)=>(_e-$)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval(j=>{j.setDate(1),j.setHours(0,0,0,0)},(j,$)=>{j.setMonth(j.getMonth()+$)},(j,$)=>$.getMonth()-j.getMonth()+($.getFullYear()-j.getFullYear())*12,j=>j.getMonth());timeMonth.range;const utcMonth=timeInterval(j=>{j.setUTCDate(1),j.setUTCHours(0,0,0,0)},(j,$)=>{j.setUTCMonth(j.getUTCMonth()+$)},(j,$)=>$.getUTCMonth()-j.getUTCMonth()+($.getUTCFullYear()-j.getUTCFullYear())*12,j=>j.getUTCMonth());utcMonth.range;const timeYear=timeInterval(j=>{j.setMonth(0,1),j.setHours(0,0,0,0)},(j,$)=>{j.setFullYear(j.getFullYear()+$)},(j,$)=>$.getFullYear()-j.getFullYear(),j=>j.getFullYear());timeYear.every=j=>!isFinite(j=Math.floor(j))||!(j>0)?null:timeInterval($=>{$.setFullYear(Math.floor($.getFullYear()/j)*j),$.setMonth(0,1),$.setHours(0,0,0,0)},($,_e)=>{$.setFullYear($.getFullYear()+_e*j)});timeYear.range;const utcYear=timeInterval(j=>{j.setUTCMonth(0,1),j.setUTCHours(0,0,0,0)},(j,$)=>{j.setUTCFullYear(j.getUTCFullYear()+$)},(j,$)=>$.getUTCFullYear()-j.getUTCFullYear(),j=>j.getUTCFullYear());utcYear.every=j=>!isFinite(j=Math.floor(j))||!(j>0)?null:timeInterval($=>{$.setUTCFullYear(Math.floor($.getUTCFullYear()/j)*j),$.setUTCMonth(0,1),$.setUTCHours(0,0,0,0)},($,_e)=>{$.setUTCFullYear($.getUTCFullYear()+_e*j)});utcYear.range;function ticker(j,$,_e,et,tt,nt){const rt=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[nt,1,durationMinute],[nt,5,5*durationMinute],[nt,15,15*durationMinute],[nt,30,30*durationMinute],[tt,1,durationHour],[tt,3,3*durationHour],[tt,6,6*durationHour],[tt,12,12*durationHour],[et,1,durationDay],[et,2,2*durationDay],[_e,1,durationWeek],[$,1,durationMonth],[$,3,3*durationMonth],[j,1,durationYear]];function it(at,ot,ct){const lt=ot<at;lt&&([at,ot]=[ot,at]);const ut=ct&&typeof ct.range=="function"?ct:st(at,ot,ct),pt=ut?ut.range(at,+ot+1):[];return lt?pt.reverse():pt}function st(at,ot,ct){const lt=Math.abs(ot-at)/ct,ut=bisector(([,,ht])=>ht).right(rt,lt);if(ut===rt.length)return j.every(tickStep(at/durationYear,ot/durationYear,ct));if(ut===0)return millisecond.every(Math.max(tickStep(at,ot,ct),1));const[pt,dt]=rt[lt/rt[ut-1][2]<rt[ut][2]/lt?ut-1:ut];return pt.every(dt)}return[it,st]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(j){if(0<=j.y&&j.y<100){var $=new Date(-1,j.m,j.d,j.H,j.M,j.S,j.L);return $.setFullYear(j.y),$}return new Date(j.y,j.m,j.d,j.H,j.M,j.S,j.L)}function utcDate(j){if(0<=j.y&&j.y<100){var $=new Date(Date.UTC(-1,j.m,j.d,j.H,j.M,j.S,j.L));return $.setUTCFullYear(j.y),$}return new Date(Date.UTC(j.y,j.m,j.d,j.H,j.M,j.S,j.L))}function newDate(j,$,_e){return{y:j,m:$,d:_e,H:0,M:0,S:0,L:0}}function formatLocale(j){var $=j.dateTime,_e=j.date,et=j.time,tt=j.periods,nt=j.days,rt=j.shortDays,it=j.months,st=j.shortMonths,at=formatRe(tt),ot=formatLookup(tt),ct=formatRe(nt),lt=formatLookup(nt),ut=formatRe(rt),pt=formatLookup(rt),dt=formatRe(it),ht=formatLookup(it),ft=formatRe(st),mt=formatLookup(st),gt={a:Lt,A:Nt,b:Bt,B:kt,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:rn,q:Gt,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},yt={a:_t,A:sn,b:tn,B:on,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:It,q:Zt,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},vt={a:Tt,A:Ct,b:Rt,B:jt,c:Ot,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:wt,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:$t,X:Kt,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};gt.x=xt(_e,gt),gt.X=xt(et,gt),gt.c=xt($,gt),yt.x=xt(_e,yt),yt.X=xt(et,yt),yt.c=xt($,yt);function xt(Ut,Xt){return function(Ht){var Pt=[],Mt=-1,Vt=0,qt=Ut.length,en,fn,Cn;for(Ht instanceof Date||(Ht=new Date(+Ht));++Mt<qt;)Ut.charCodeAt(Mt)===37&&(Pt.push(Ut.slice(Vt,Mt)),(fn=pads[en=Ut.charAt(++Mt)])!=null?en=Ut.charAt(++Mt):fn=en==="e"?" ":"0",(Cn=Xt[en])&&(en=Cn(Ht,fn)),Pt.push(en),Vt=Mt+1);return Pt.push(Ut.slice(Vt,Mt)),Pt.join("")}}function St(Ut,Xt){return function(Ht){var Pt=newDate(1900,void 0,1),Mt=Et(Pt,Ut,Ht+="",0),Vt,qt;if(Mt!=Ht.length)return null;if("Q"in Pt)return new Date(Pt.Q);if("s"in Pt)return new Date(Pt.s*1e3+("L"in Pt?Pt.L:0));if(Xt&&!("Z"in Pt)&&(Pt.Z=0),"p"in Pt&&(Pt.H=Pt.H%12+Pt.p*12),Pt.m===void 0&&(Pt.m="q"in Pt?Pt.q:0),"V"in Pt){if(Pt.V<1||Pt.V>53)return null;"w"in Pt||(Pt.w=1),"Z"in Pt?(Vt=utcDate(newDate(Pt.y,0,1)),qt=Vt.getUTCDay(),Vt=qt>4||qt===0?utcMonday.ceil(Vt):utcMonday(Vt),Vt=utcDay.offset(Vt,(Pt.V-1)*7),Pt.y=Vt.getUTCFullYear(),Pt.m=Vt.getUTCMonth(),Pt.d=Vt.getUTCDate()+(Pt.w+6)%7):(Vt=localDate(newDate(Pt.y,0,1)),qt=Vt.getDay(),Vt=qt>4||qt===0?timeMonday.ceil(Vt):timeMonday(Vt),Vt=timeDay.offset(Vt,(Pt.V-1)*7),Pt.y=Vt.getFullYear(),Pt.m=Vt.getMonth(),Pt.d=Vt.getDate()+(Pt.w+6)%7)}else("W"in Pt||"U"in Pt)&&("w"in Pt||(Pt.w="u"in Pt?Pt.u%7:"W"in Pt?1:0),qt="Z"in Pt?utcDate(newDate(Pt.y,0,1)).getUTCDay():localDate(newDate(Pt.y,0,1)).getDay(),Pt.m=0,Pt.d="W"in Pt?(Pt.w+6)%7+Pt.W*7-(qt+5)%7:Pt.w+Pt.U*7-(qt+6)%7);return"Z"in Pt?(Pt.H+=Pt.Z/100|0,Pt.M+=Pt.Z%100,utcDate(Pt)):localDate(Pt)}}function Et(Ut,Xt,Ht,Pt){for(var Mt=0,Vt=Xt.length,qt=Ht.length,en,fn;Mt<Vt;){if(Pt>=qt)return-1;if(en=Xt.charCodeAt(Mt++),en===37){if(en=Xt.charAt(Mt++),fn=vt[en in pads?Xt.charAt(Mt++):en],!fn||(Pt=fn(Ut,Ht,Pt))<0)return-1}else if(en!=Ht.charCodeAt(Pt++))return-1}return Pt}function wt(Ut,Xt,Ht){var Pt=at.exec(Xt.slice(Ht));return Pt?(Ut.p=ot.get(Pt[0].toLowerCase()),Ht+Pt[0].length):-1}function Tt(Ut,Xt,Ht){var Pt=ut.exec(Xt.slice(Ht));return Pt?(Ut.w=pt.get(Pt[0].toLowerCase()),Ht+Pt[0].length):-1}function Ct(Ut,Xt,Ht){var Pt=ct.exec(Xt.slice(Ht));return Pt?(Ut.w=lt.get(Pt[0].toLowerCase()),Ht+Pt[0].length):-1}function Rt(Ut,Xt,Ht){var Pt=ft.exec(Xt.slice(Ht));return Pt?(Ut.m=mt.get(Pt[0].toLowerCase()),Ht+Pt[0].length):-1}function jt(Ut,Xt,Ht){var Pt=dt.exec(Xt.slice(Ht));return Pt?(Ut.m=ht.get(Pt[0].toLowerCase()),Ht+Pt[0].length):-1}function Ot(Ut,Xt,Ht){return Et(Ut,$,Xt,Ht)}function $t(Ut,Xt,Ht){return Et(Ut,_e,Xt,Ht)}function Kt(Ut,Xt,Ht){return Et(Ut,et,Xt,Ht)}function Lt(Ut){return rt[Ut.getDay()]}function Nt(Ut){return nt[Ut.getDay()]}function Bt(Ut){return st[Ut.getMonth()]}function kt(Ut){return it[Ut.getMonth()]}function rn(Ut){return tt[+(Ut.getHours()>=12)]}function Gt(Ut){return 1+~~(Ut.getMonth()/3)}function _t(Ut){return rt[Ut.getUTCDay()]}function sn(Ut){return nt[Ut.getUTCDay()]}function tn(Ut){return st[Ut.getUTCMonth()]}function on(Ut){return it[Ut.getUTCMonth()]}function It(Ut){return tt[+(Ut.getUTCHours()>=12)]}function Zt(Ut){return 1+~~(Ut.getUTCMonth()/3)}return{format:function(Ut){var Xt=xt(Ut+="",gt);return Xt.toString=function(){return Ut},Xt},parse:function(Ut){var Xt=St(Ut+="",!1);return Xt.toString=function(){return Ut},Xt},utcFormat:function(Ut){var Xt=xt(Ut+="",yt);return Xt.toString=function(){return Ut},Xt},utcParse:function(Ut){var Xt=St(Ut+="",!0);return Xt.toString=function(){return Ut},Xt}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(j,$,_e){var et=j<0?"-":"",tt=(et?-j:j)+"",nt=tt.length;return et+(nt<_e?new Array(_e-nt+1).join($)+tt:tt)}function requote(j){return j.replace(requoteRe,"\\$&")}function formatRe(j){return new RegExp("^(?:"+j.map(requote).join("|")+")","i")}function formatLookup(j){return new Map(j.map(($,_e)=>[$.toLowerCase(),_e]))}function parseWeekdayNumberSunday(j,$,_e){var et=numberRe.exec($.slice(_e,_e+1));return et?(j.w=+et[0],_e+et[0].length):-1}function parseWeekdayNumberMonday(j,$,_e){var et=numberRe.exec($.slice(_e,_e+1));return et?(j.u=+et[0],_e+et[0].length):-1}function parseWeekNumberSunday(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.U=+et[0],_e+et[0].length):-1}function parseWeekNumberISO(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.V=+et[0],_e+et[0].length):-1}function parseWeekNumberMonday(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.W=+et[0],_e+et[0].length):-1}function parseFullYear(j,$,_e){var et=numberRe.exec($.slice(_e,_e+4));return et?(j.y=+et[0],_e+et[0].length):-1}function parseYear(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.y=+et[0]+(+et[0]>68?1900:2e3),_e+et[0].length):-1}function parseZone(j,$,_e){var et=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec($.slice(_e,_e+6));return et?(j.Z=et[1]?0:-(et[2]+(et[3]||"00")),_e+et[0].length):-1}function parseQuarter(j,$,_e){var et=numberRe.exec($.slice(_e,_e+1));return et?(j.q=et[0]*3-3,_e+et[0].length):-1}function parseMonthNumber(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.m=et[0]-1,_e+et[0].length):-1}function parseDayOfMonth(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.d=+et[0],_e+et[0].length):-1}function parseDayOfYear(j,$,_e){var et=numberRe.exec($.slice(_e,_e+3));return et?(j.m=0,j.d=+et[0],_e+et[0].length):-1}function parseHour24(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.H=+et[0],_e+et[0].length):-1}function parseMinutes(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.M=+et[0],_e+et[0].length):-1}function parseSeconds(j,$,_e){var et=numberRe.exec($.slice(_e,_e+2));return et?(j.S=+et[0],_e+et[0].length):-1}function parseMilliseconds(j,$,_e){var et=numberRe.exec($.slice(_e,_e+3));return et?(j.L=+et[0],_e+et[0].length):-1}function parseMicroseconds(j,$,_e){var et=numberRe.exec($.slice(_e,_e+6));return et?(j.L=Math.floor(et[0]/1e3),_e+et[0].length):-1}function parseLiteralPercent(j,$,_e){var et=percentRe.exec($.slice(_e,_e+1));return et?_e+et[0].length:-1}function parseUnixTimestamp(j,$,_e){var et=numberRe.exec($.slice(_e));return et?(j.Q=+et[0],_e+et[0].length):-1}function parseUnixTimestampSeconds(j,$,_e){var et=numberRe.exec($.slice(_e));return et?(j.s=+et[0],_e+et[0].length):-1}function formatDayOfMonth(j,$){return pad(j.getDate(),$,2)}function formatHour24(j,$){return pad(j.getHours(),$,2)}function formatHour12(j,$){return pad(j.getHours()%12||12,$,2)}function formatDayOfYear(j,$){return pad(1+timeDay.count(timeYear(j),j),$,3)}function formatMilliseconds(j,$){return pad(j.getMilliseconds(),$,3)}function formatMicroseconds(j,$){return formatMilliseconds(j,$)+"000"}function formatMonthNumber(j,$){return pad(j.getMonth()+1,$,2)}function formatMinutes(j,$){return pad(j.getMinutes(),$,2)}function formatSeconds(j,$){return pad(j.getSeconds(),$,2)}function formatWeekdayNumberMonday(j){var $=j.getDay();return $===0?7:$}function formatWeekNumberSunday(j,$){return pad(timeSunday.count(timeYear(j)-1,j),$,2)}function dISO(j){var $=j.getDay();return $>=4||$===0?timeThursday(j):timeThursday.ceil(j)}function formatWeekNumberISO(j,$){return j=dISO(j),pad(timeThursday.count(timeYear(j),j)+(timeYear(j).getDay()===4),$,2)}function formatWeekdayNumberSunday(j){return j.getDay()}function formatWeekNumberMonday(j,$){return pad(timeMonday.count(timeYear(j)-1,j),$,2)}function formatYear(j,$){return pad(j.getFullYear()%100,$,2)}function formatYearISO(j,$){return j=dISO(j),pad(j.getFullYear()%100,$,2)}function formatFullYear(j,$){return pad(j.getFullYear()%1e4,$,4)}function formatFullYearISO(j,$){var _e=j.getDay();return j=_e>=4||_e===0?timeThursday(j):timeThursday.ceil(j),pad(j.getFullYear()%1e4,$,4)}function formatZone(j){var $=j.getTimezoneOffset();return($>0?"-":($*=-1,"+"))+pad($/60|0,"0",2)+pad($%60,"0",2)}function formatUTCDayOfMonth(j,$){return pad(j.getUTCDate(),$,2)}function formatUTCHour24(j,$){return pad(j.getUTCHours(),$,2)}function formatUTCHour12(j,$){return pad(j.getUTCHours()%12||12,$,2)}function formatUTCDayOfYear(j,$){return pad(1+utcDay.count(utcYear(j),j),$,3)}function formatUTCMilliseconds(j,$){return pad(j.getUTCMilliseconds(),$,3)}function formatUTCMicroseconds(j,$){return formatUTCMilliseconds(j,$)+"000"}function formatUTCMonthNumber(j,$){return pad(j.getUTCMonth()+1,$,2)}function formatUTCMinutes(j,$){return pad(j.getUTCMinutes(),$,2)}function formatUTCSeconds(j,$){return pad(j.getUTCSeconds(),$,2)}function formatUTCWeekdayNumberMonday(j){var $=j.getUTCDay();return $===0?7:$}function formatUTCWeekNumberSunday(j,$){return pad(utcSunday.count(utcYear(j)-1,j),$,2)}function UTCdISO(j){var $=j.getUTCDay();return $>=4||$===0?utcThursday(j):utcThursday.ceil(j)}function formatUTCWeekNumberISO(j,$){return j=UTCdISO(j),pad(utcThursday.count(utcYear(j),j)+(utcYear(j).getUTCDay()===4),$,2)}function formatUTCWeekdayNumberSunday(j){return j.getUTCDay()}function formatUTCWeekNumberMonday(j,$){return pad(utcMonday.count(utcYear(j)-1,j),$,2)}function formatUTCYear(j,$){return pad(j.getUTCFullYear()%100,$,2)}function formatUTCYearISO(j,$){return j=UTCdISO(j),pad(j.getUTCFullYear()%100,$,2)}function formatUTCFullYear(j,$){return pad(j.getUTCFullYear()%1e4,$,4)}function formatUTCFullYearISO(j,$){var _e=j.getUTCDay();return j=_e>=4||_e===0?utcThursday(j):utcThursday.ceil(j),pad(j.getUTCFullYear()%1e4,$,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(j){return+j}function formatUnixTimestampSeconds(j){return Math.floor(+j/1e3)}var locale,timeFormat,utcFormat;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(j){return locale=formatLocale(j),timeFormat=locale.format,locale.parse,utcFormat=locale.utcFormat,locale.utcParse,locale}function date(j){return new Date(j)}function number(j){return j instanceof Date?+j:+new Date(+j)}function calendar(j,$,_e,et,tt,nt,rt,it,st,at){var ot=continuous(),ct=ot.invert,lt=ot.domain,ut=at(".%L"),pt=at(":%S"),dt=at("%I:%M"),ht=at("%I %p"),ft=at("%a %d"),mt=at("%b %d"),gt=at("%B"),yt=at("%Y");function vt(xt){return(st(xt)<xt?ut:it(xt)<xt?pt:rt(xt)<xt?dt:nt(xt)<xt?ht:et(xt)<xt?tt(xt)<xt?ft:mt:_e(xt)<xt?gt:yt)(xt)}return ot.invert=function(xt){return new Date(ct(xt))},ot.domain=function(xt){return arguments.length?lt(Array.from(xt,number)):lt().map(date)},ot.ticks=function(xt){var St=lt();return j(St[0],St[St.length-1],xt??10)},ot.tickFormat=function(xt,St){return St==null?vt:at(St)},ot.nice=function(xt){var St=lt();return(!xt||typeof xt.range!="function")&&(xt=$(St[0],St[St.length-1],xt??10)),xt?lt(nice(St,xt)):ot},ot.copy=function(){return copy$1(ot,calendar(j,$,_e,et,tt,nt,rt,it,st,at))},ot}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$1(){var j=0,$=1,_e,et,tt,nt,rt=identity$3,it=!1,st;function at(ct){return ct==null||isNaN(ct=+ct)?st:rt(tt===0?.5:(ct=(nt(ct)-_e)*tt,it?Math.max(0,Math.min(1,ct)):ct))}at.domain=function(ct){return arguments.length?([j,$]=ct,_e=nt(j=+j),et=nt($=+$),tt=_e===et?0:1/(et-_e),at):[j,$]},at.clamp=function(ct){return arguments.length?(it=!!ct,at):it},at.interpolator=function(ct){return arguments.length?(rt=ct,at):rt};function ot(ct){return function(lt){var ut,pt;return arguments.length?([ut,pt]=lt,rt=ct(ut,pt),at):[rt(0),rt(1)]}}return at.range=ot(interpolate),at.rangeRound=ot(interpolateRound),at.unknown=function(ct){return arguments.length?(st=ct,at):st},function(ct){return nt=ct,_e=ct(j),et=ct($),tt=_e===et?0:1/(et-_e),at}}function copy(j,$){return $.domain(j.domain()).interpolator(j.interpolator()).clamp(j.clamp()).unknown(j.unknown())}function sequential(){var j=linearish(transformer$1()(identity$3));return j.copy=function(){return copy(j,sequential())},initInterpolator.apply(j,arguments)}function sequentialLog(){var j=loggish(transformer$1()).domain([1,10]);return j.copy=function(){return copy(j,sequentialLog()).base(j.base())},initInterpolator.apply(j,arguments)}function sequentialSymlog(){var j=symlogish(transformer$1());return j.copy=function(){return copy(j,sequentialSymlog()).constant(j.constant())},initInterpolator.apply(j,arguments)}function sequentialPow(){var j=powish(transformer$1());return j.copy=function(){return copy(j,sequentialPow()).exponent(j.exponent())},initInterpolator.apply(j,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function sequentialQuantile(){var j=[],$=identity$3;function _e(et){if(et!=null&&!isNaN(et=+et))return $((bisectRight(j,et,1)-1)/(j.length-1))}return _e.domain=function(et){if(!arguments.length)return j.slice();j=[];for(let tt of et)tt!=null&&!isNaN(tt=+tt)&&j.push(tt);return j.sort(ascending),_e},_e.interpolator=function(et){return arguments.length?($=et,_e):$},_e.range=function(){return j.map((et,tt)=>$(tt/(j.length-1)))},_e.quantiles=function(et){return Array.from({length:et+1},(tt,nt)=>quantile$1(j,nt/et))},_e.copy=function(){return sequentialQuantile($).domain(j)},initInterpolator.apply(_e,arguments)}function transformer(){var j=0,$=.5,_e=1,et=1,tt,nt,rt,it,st,at=identity$3,ot,ct=!1,lt;function ut(dt){return isNaN(dt=+dt)?lt:(dt=.5+((dt=+ot(dt))-nt)*(et*dt<et*nt?it:st),at(ct?Math.max(0,Math.min(1,dt)):dt))}ut.domain=function(dt){return arguments.length?([j,$,_e]=dt,tt=ot(j=+j),nt=ot($=+$),rt=ot(_e=+_e),it=tt===nt?0:.5/(nt-tt),st=nt===rt?0:.5/(rt-nt),et=nt<tt?-1:1,ut):[j,$,_e]},ut.clamp=function(dt){return arguments.length?(ct=!!dt,ut):ct},ut.interpolator=function(dt){return arguments.length?(at=dt,ut):at};function pt(dt){return function(ht){var ft,mt,gt;return arguments.length?([ft,mt,gt]=ht,at=piecewise(dt,[ft,mt,gt]),ut):[at(0),at(.5),at(1)]}}return ut.range=pt(interpolate),ut.rangeRound=pt(interpolateRound),ut.unknown=function(dt){return arguments.length?(lt=dt,ut):lt},function(dt){return ot=dt,tt=dt(j),nt=dt($),rt=dt(_e),it=tt===nt?0:.5/(nt-tt),st=nt===rt?0:.5/(rt-nt),et=nt<tt?-1:1,ut}}function diverging(){var j=linearish(transformer()(identity$3));return j.copy=function(){return copy(j,diverging())},initInterpolator.apply(j,arguments)}function divergingLog(){var j=loggish(transformer()).domain([.1,1,10]);return j.copy=function(){return copy(j,divergingLog()).base(j.base())},initInterpolator.apply(j,arguments)}function divergingSymlog(){var j=symlogish(transformer());return j.copy=function(){return copy(j,divergingSymlog()).constant(j.constant())},initInterpolator.apply(j,arguments)}function divergingPow(){var j=powish(transformer());return j.copy=function(){return copy(j,divergingPow()).exponent(j.exponent())},initInterpolator.apply(j,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}const d3Scales=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:band,scaleDiverging:diverging,scaleDivergingLog:divergingLog,scaleDivergingPow:divergingPow,scaleDivergingSqrt:divergingSqrt,scaleDivergingSymlog:divergingSymlog,scaleIdentity:identity$1,scaleImplicit:implicit,scaleLinear:linear,scaleLog:log,scaleOrdinal:ordinal,scalePoint:point,scalePow:pow,scaleQuantile:quantile,scaleQuantize:quantize,scaleRadial:radial,scaleSequential:sequential,scaleSequentialLog:sequentialLog,scaleSequentialPow:sequentialPow,scaleSequentialQuantile:sequentialQuantile,scaleSequentialSqrt:sequentialSqrt,scaleSequentialSymlog:sequentialSymlog,scaleSqrt:sqrt,scaleSymlog:symlog,scaleThreshold:threshold,scaleTime:time,scaleUtc:utcTime,tickFormat},Symbol.toStringTag,{value:"Module"}));var selectChartDataWithIndexes=j=>j.chartData,selectChartDataAndAlwaysIgnoreIndexes=createSelector([selectChartDataWithIndexes],j=>{var $=j.chartData!=null?j.chartData.length-1:0;return{chartData:j.chartData,computedData:j.computedData,dataEndIndex:$,dataStartIndex:0}}),selectChartDataWithIndexesIfNotInPanorama=(j,$,_e,et)=>et?selectChartDataAndAlwaysIgnoreIndexes(j):selectChartDataWithIndexes(j);function isWellFormedNumberDomain(j){if(Array.isArray(j)&&j.length===2){var[$,_e]=j;if(isWellBehavedNumber($)&&isWellBehavedNumber(_e))return!0}return!1}function extendDomain(j,$,_e){return _e?j:[Math.min(j[0],$[0]),Math.max(j[1],$[1])]}function numericalDomainSpecifiedWithoutRequiringData(j,$){if($&&typeof j!="function"&&Array.isArray(j)&&j.length===2){var[_e,et]=j,tt,nt;if(isWellBehavedNumber(_e))tt=_e;else if(typeof _e=="function")return;if(isWellBehavedNumber(et))nt=et;else if(typeof et=="function")return;var rt=[tt,nt];if(isWellFormedNumberDomain(rt))return rt}}function parseNumericalUserDomain(j,$,_e){if(!(!_e&&$==null)){if(typeof j=="function"&&$!=null)try{var et=j($,_e);if(isWellFormedNumberDomain(et))return extendDomain(et,$,_e)}catch{}if(Array.isArray(j)&&j.length===2){var[tt,nt]=j,rt,it;if(tt==="auto")$!=null&&(rt=Math.min(...$));else if(isNumber(tt))rt=tt;else if(typeof tt=="function")try{$!=null&&(rt=tt($==null?void 0:$[0]))}catch{}else if(typeof tt=="string"&&MIN_VALUE_REG.test(tt)){var st=MIN_VALUE_REG.exec(tt);if(st==null||$==null)rt=void 0;else{var at=+st[1];rt=$[0]-at}}else rt=$==null?void 0:$[0];if(nt==="auto")$!=null&&(it=Math.max(...$));else if(isNumber(nt))it=nt;else if(typeof nt=="function")try{$!=null&&(it=nt($==null?void 0:$[1]))}catch{}else if(typeof nt=="string"&&MAX_VALUE_REG.test(nt)){var ot=MAX_VALUE_REG.exec(nt);if(ot==null||$==null)it=void 0;else{var ct=+ot[1];it=$[1]+ct}}else it=$==null?void 0:$[1];var lt=[rt,it];if(isWellFormedNumberDomain(lt))return $==null?lt:extendDomain(lt,$,_e)}}}var MAX_DIGITS=1e9,defaults={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Decimal,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",exponentOutOfRange=decimalError+"Exponent out of range: ",mathfloor=Math.floor,mathpow=Math.pow,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ONE,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,MAX_E=mathfloor(MAX_SAFE_INTEGER/LOG_BASE),P={};P.absoluteValue=P.abs=function(){var j=new this.constructor(this);return j.s&&(j.s=1),j};P.comparedTo=P.cmp=function(j){var $,_e,et,tt,nt=this;if(j=new nt.constructor(j),nt.s!==j.s)return nt.s||-j.s;if(nt.e!==j.e)return nt.e>j.e^nt.s<0?1:-1;for(et=nt.d.length,tt=j.d.length,$=0,_e=et<tt?et:tt;$<_e;++$)if(nt.d[$]!==j.d[$])return nt.d[$]>j.d[$]^nt.s<0?1:-1;return et===tt?0:et>tt^nt.s<0?1:-1};P.decimalPlaces=P.dp=function(){var j=this,$=j.d.length-1,_e=($-j.e)*LOG_BASE;if($=j.d[$],$)for(;$%10==0;$/=10)_e--;return _e<0?0:_e};P.dividedBy=P.div=function(j){return divide(this,new this.constructor(j))};P.dividedToIntegerBy=P.idiv=function(j){var $=this,_e=$.constructor;return round(divide($,new _e(j),0,1),_e.precision)};P.equals=P.eq=function(j){return!this.cmp(j)};P.exponent=function(){return getBase10Exponent(this)};P.greaterThan=P.gt=function(j){return this.cmp(j)>0};P.greaterThanOrEqualTo=P.gte=function(j){return this.cmp(j)>=0};P.isInteger=P.isint=function(){return this.e>this.d.length-2};P.isNegative=P.isneg=function(){return this.s<0};P.isPositive=P.ispos=function(){return this.s>0};P.isZero=function(){return this.s===0};P.lessThan=P.lt=function(j){return this.cmp(j)<0};P.lessThanOrEqualTo=P.lte=function(j){return this.cmp(j)<1};P.logarithm=P.log=function(j){var $,_e=this,et=_e.constructor,tt=et.precision,nt=tt+5;if(j===void 0)j=new et(10);else if(j=new et(j),j.s<1||j.eq(ONE))throw Error(decimalError+"NaN");if(_e.s<1)throw Error(decimalError+(_e.s?"NaN":"-Infinity"));return _e.eq(ONE)?new et(0):(external=!1,$=divide(ln(_e,nt),ln(j,nt),nt),external=!0,round($,tt))};P.minus=P.sub=function(j){var $=this;return j=new $.constructor(j),$.s==j.s?subtract($,j):add($,(j.s=-j.s,j))};P.modulo=P.mod=function(j){var $,_e=this,et=_e.constructor,tt=et.precision;if(j=new et(j),!j.s)throw Error(decimalError+"NaN");return _e.s?(external=!1,$=divide(_e,j,0,1).times(j),external=!0,_e.minus($)):round(new et(_e),tt)};P.naturalExponential=P.exp=function(){return exp(this)};P.naturalLogarithm=P.ln=function(){return ln(this)};P.negated=P.neg=function(){var j=new this.constructor(this);return j.s=-j.s||0,j};P.plus=P.add=function(j){var $=this;return j=new $.constructor(j),$.s==j.s?add($,j):subtract($,(j.s=-j.s,j))};P.precision=P.sd=function(j){var $,_e,et,tt=this;if(j!==void 0&&j!==!!j&&j!==1&&j!==0)throw Error(invalidArgument+j);if($=getBase10Exponent(tt)+1,et=tt.d.length-1,_e=et*LOG_BASE+1,et=tt.d[et],et){for(;et%10==0;et/=10)_e--;for(et=tt.d[0];et>=10;et/=10)_e++}return j&&$>_e?$:_e};P.squareRoot=P.sqrt=function(){var j,$,_e,et,tt,nt,rt,it=this,st=it.constructor;if(it.s<1){if(!it.s)return new st(0);throw Error(decimalError+"NaN")}for(j=getBase10Exponent(it),external=!1,tt=Math.sqrt(+it),tt==0||tt==1/0?($=digitsToString(it.d),($.length+j)%2==0&&($+="0"),tt=Math.sqrt($),j=mathfloor((j+1)/2)-(j<0||j%2),tt==1/0?$="5e"+j:($=tt.toExponential(),$=$.slice(0,$.indexOf("e")+1)+j),et=new st($)):et=new st(tt.toString()),_e=st.precision,tt=rt=_e+3;;)if(nt=et,et=nt.plus(divide(it,nt,rt+2)).times(.5),digitsToString(nt.d).slice(0,rt)===($=digitsToString(et.d)).slice(0,rt)){if($=$.slice(rt-3,rt+1),tt==rt&&$=="4999"){if(round(nt,_e+1,0),nt.times(nt).eq(it)){et=nt;break}}else if($!="9999")break;rt+=4}return external=!0,round(et,_e)};P.times=P.mul=function(j){var $,_e,et,tt,nt,rt,it,st,at,ot=this,ct=ot.constructor,lt=ot.d,ut=(j=new ct(j)).d;if(!ot.s||!j.s)return new ct(0);for(j.s*=ot.s,_e=ot.e+j.e,st=lt.length,at=ut.length,st<at&&(nt=lt,lt=ut,ut=nt,rt=st,st=at,at=rt),nt=[],rt=st+at,et=rt;et--;)nt.push(0);for(et=at;--et>=0;){for($=0,tt=st+et;tt>et;)it=nt[tt]+ut[et]*lt[tt-et-1]+$,nt[tt--]=it%BASE|0,$=it/BASE|0;nt[tt]=(nt[tt]+$)%BASE|0}for(;!nt[--rt];)nt.pop();return $?++_e:nt.shift(),j.d=nt,j.e=_e,external?round(j,ct.precision):j};P.toDecimalPlaces=P.todp=function(j,$){var _e=this,et=_e.constructor;return _e=new et(_e),j===void 0?_e:(checkInt32(j,0,MAX_DIGITS),$===void 0?$=et.rounding:checkInt32($,0,8),round(_e,j+getBase10Exponent(_e)+1,$))};P.toExponential=function(j,$){var _e,et=this,tt=et.constructor;return j===void 0?_e=toString(et,!0):(checkInt32(j,0,MAX_DIGITS),$===void 0?$=tt.rounding:checkInt32($,0,8),et=round(new tt(et),j+1,$),_e=toString(et,!0,j+1)),_e};P.toFixed=function(j,$){var _e,et,tt=this,nt=tt.constructor;return j===void 0?toString(tt):(checkInt32(j,0,MAX_DIGITS),$===void 0?$=nt.rounding:checkInt32($,0,8),et=round(new nt(tt),j+getBase10Exponent(tt)+1,$),_e=toString(et.abs(),!1,j+getBase10Exponent(et)+1),tt.isneg()&&!tt.isZero()?"-"+_e:_e)};P.toInteger=P.toint=function(){var j=this,$=j.constructor;return round(new $(j),getBase10Exponent(j)+1,$.rounding)};P.toNumber=function(){return+this};P.toPower=P.pow=function(j){var $,_e,et,tt,nt,rt,it=this,st=it.constructor,at=12,ot=+(j=new st(j));if(!j.s)return new st(ONE);if(it=new st(it),!it.s){if(j.s<1)throw Error(decimalError+"Infinity");return it}if(it.eq(ONE))return it;if(et=st.precision,j.eq(ONE))return round(it,et);if($=j.e,_e=j.d.length-1,rt=$>=_e,nt=it.s,rt){if((_e=ot<0?-ot:ot)<=MAX_SAFE_INTEGER){for(tt=new st(ONE),$=Math.ceil(et/LOG_BASE+4),external=!1;_e%2&&(tt=tt.times(it),truncate(tt.d,$)),_e=mathfloor(_e/2),_e!==0;)it=it.times(it),truncate(it.d,$);return external=!0,j.s<0?new st(ONE).div(tt):round(tt,et)}}else if(nt<0)throw Error(decimalError+"NaN");return nt=nt<0&&j.d[Math.max($,_e)]&1?-1:1,it.s=1,external=!1,tt=j.times(ln(it,et+at)),external=!0,tt=exp(tt),tt.s=nt,tt};P.toPrecision=function(j,$){var _e,et,tt=this,nt=tt.constructor;return j===void 0?(_e=getBase10Exponent(tt),et=toString(tt,_e<=nt.toExpNeg||_e>=nt.toExpPos)):(checkInt32(j,1,MAX_DIGITS),$===void 0?$=nt.rounding:checkInt32($,0,8),tt=round(new nt(tt),j,$),_e=getBase10Exponent(tt),et=toString(tt,j<=_e||_e<=nt.toExpNeg,j)),et};P.toSignificantDigits=P.tosd=function(j,$){var _e=this,et=_e.constructor;return j===void 0?(j=et.precision,$=et.rounding):(checkInt32(j,1,MAX_DIGITS),$===void 0?$=et.rounding:checkInt32($,0,8)),round(new et(_e),j,$)};P.toString=P.valueOf=P.val=P.toJSON=P[Symbol.for("nodejs.util.inspect.custom")]=function(){var j=this,$=getBase10Exponent(j),_e=j.constructor;return toString(j,$<=_e.toExpNeg||$>=_e.toExpPos)};function add(j,$){var _e,et,tt,nt,rt,it,st,at,ot=j.constructor,ct=ot.precision;if(!j.s||!$.s)return $.s||($=new ot(j)),external?round($,ct):$;if(st=j.d,at=$.d,rt=j.e,tt=$.e,st=st.slice(),nt=rt-tt,nt){for(nt<0?(et=st,nt=-nt,it=at.length):(et=at,tt=rt,it=st.length),rt=Math.ceil(ct/LOG_BASE),it=rt>it?rt+1:it+1,nt>it&&(nt=it,et.length=1),et.reverse();nt--;)et.push(0);et.reverse()}for(it=st.length,nt=at.length,it-nt<0&&(nt=it,et=at,at=st,st=et),_e=0;nt;)_e=(st[--nt]=st[nt]+at[nt]+_e)/BASE|0,st[nt]%=BASE;for(_e&&(st.unshift(_e),++tt),it=st.length;st[--it]==0;)st.pop();return $.d=st,$.e=tt,external?round($,ct):$}function checkInt32(j,$,_e){if(j!==~~j||j<$||j>_e)throw Error(invalidArgument+j)}function digitsToString(j){var $,_e,et,tt=j.length-1,nt="",rt=j[0];if(tt>0){for(nt+=rt,$=1;$<tt;$++)et=j[$]+"",_e=LOG_BASE-et.length,_e&&(nt+=getZeroString(_e)),nt+=et;rt=j[$],et=rt+"",_e=LOG_BASE-et.length,_e&&(nt+=getZeroString(_e))}else if(rt===0)return"0";for(;rt%10===0;)rt/=10;return nt+rt}var divide=function(){function j(et,tt){var nt,rt=0,it=et.length;for(et=et.slice();it--;)nt=et[it]*tt+rt,et[it]=nt%BASE|0,rt=nt/BASE|0;return rt&&et.unshift(rt),et}function $(et,tt,nt,rt){var it,st;if(nt!=rt)st=nt>rt?1:-1;else for(it=st=0;it<nt;it++)if(et[it]!=tt[it]){st=et[it]>tt[it]?1:-1;break}return st}function _e(et,tt,nt){for(var rt=0;nt--;)et[nt]-=rt,rt=et[nt]<tt[nt]?1:0,et[nt]=rt*BASE+et[nt]-tt[nt];for(;!et[0]&&et.length>1;)et.shift()}return function(et,tt,nt,rt){var it,st,at,ot,ct,lt,ut,pt,dt,ht,ft,mt,gt,yt,vt,xt,St,Et,wt=et.constructor,Tt=et.s==tt.s?1:-1,Ct=et.d,Rt=tt.d;if(!et.s)return new wt(et);if(!tt.s)throw Error(decimalError+"Division by zero");for(st=et.e-tt.e,St=Rt.length,vt=Ct.length,ut=new wt(Tt),pt=ut.d=[],at=0;Rt[at]==(Ct[at]||0);)++at;if(Rt[at]>(Ct[at]||0)&&--st,nt==null?mt=nt=wt.precision:rt?mt=nt+(getBase10Exponent(et)-getBase10Exponent(tt))+1:mt=nt,mt<0)return new wt(0);if(mt=mt/LOG_BASE+2|0,at=0,St==1)for(ot=0,Rt=Rt[0],mt++;(at<vt||ot)&&mt--;at++)gt=ot*BASE+(Ct[at]||0),pt[at]=gt/Rt|0,ot=gt%Rt|0;else{for(ot=BASE/(Rt[0]+1)|0,ot>1&&(Rt=j(Rt,ot),Ct=j(Ct,ot),St=Rt.length,vt=Ct.length),yt=St,dt=Ct.slice(0,St),ht=dt.length;ht<St;)dt[ht++]=0;Et=Rt.slice(),Et.unshift(0),xt=Rt[0],Rt[1]>=BASE/2&&++xt;do ot=0,it=$(Rt,dt,St,ht),it<0?(ft=dt[0],St!=ht&&(ft=ft*BASE+(dt[1]||0)),ot=ft/xt|0,ot>1?(ot>=BASE&&(ot=BASE-1),ct=j(Rt,ot),lt=ct.length,ht=dt.length,it=$(ct,dt,lt,ht),it==1&&(ot--,_e(ct,St<lt?Et:Rt,lt))):(ot==0&&(it=ot=1),ct=Rt.slice()),lt=ct.length,lt<ht&&ct.unshift(0),_e(dt,ct,ht),it==-1&&(ht=dt.length,it=$(Rt,dt,St,ht),it<1&&(ot++,_e(dt,St<ht?Et:Rt,ht))),ht=dt.length):it===0&&(ot++,dt=[0]),pt[at++]=ot,it&&dt[0]?dt[ht++]=Ct[yt]||0:(dt=[Ct[yt]],ht=1);while((yt++<vt||dt[0]!==void 0)&&mt--)}return pt[0]||pt.shift(),ut.e=st,round(ut,rt?nt+getBase10Exponent(ut)+1:nt)}}();function exp(j,$){var _e,et,tt,nt,rt,it,st=0,at=0,ot=j.constructor,ct=ot.precision;if(getBase10Exponent(j)>16)throw Error(exponentOutOfRange+getBase10Exponent(j));if(!j.s)return new ot(ONE);for(external=!1,it=ct,rt=new ot(.03125);j.abs().gte(.1);)j=j.times(rt),at+=5;for(et=Math.log(mathpow(2,at))/Math.LN10*2+5|0,it+=et,_e=tt=nt=new ot(ONE),ot.precision=it;;){if(tt=round(tt.times(j),it),_e=_e.times(++st),rt=nt.plus(divide(tt,_e,it)),digitsToString(rt.d).slice(0,it)===digitsToString(nt.d).slice(0,it)){for(;at--;)nt=round(nt.times(nt),it);return ot.precision=ct,$==null?(external=!0,round(nt,ct)):nt}nt=rt}}function getBase10Exponent(j){for(var $=j.e*LOG_BASE,_e=j.d[0];_e>=10;_e/=10)$++;return $}function getLn10(j,$,_e){if($>j.LN10.sd())throw external=!0,_e&&(j.precision=_e),Error(decimalError+"LN10 precision limit exceeded");return round(new j(j.LN10),$)}function getZeroString(j){for(var $="";j--;)$+="0";return $}function ln(j,$){var _e,et,tt,nt,rt,it,st,at,ot,ct=1,lt=10,ut=j,pt=ut.d,dt=ut.constructor,ht=dt.precision;if(ut.s<1)throw Error(decimalError+(ut.s?"NaN":"-Infinity"));if(ut.eq(ONE))return new dt(0);if($==null?(external=!1,at=ht):at=$,ut.eq(10))return $==null&&(external=!0),getLn10(dt,at);if(at+=lt,dt.precision=at,_e=digitsToString(pt),et=_e.charAt(0),nt=getBase10Exponent(ut),Math.abs(nt)<15e14){for(;et<7&&et!=1||et==1&&_e.charAt(1)>3;)ut=ut.times(j),_e=digitsToString(ut.d),et=_e.charAt(0),ct++;nt=getBase10Exponent(ut),et>1?(ut=new dt("0."+_e),nt++):ut=new dt(et+"."+_e.slice(1))}else return st=getLn10(dt,at+2,ht).times(nt+""),ut=ln(new dt(et+"."+_e.slice(1)),at-lt).plus(st),dt.precision=ht,$==null?(external=!0,round(ut,ht)):ut;for(it=rt=ut=divide(ut.minus(ONE),ut.plus(ONE),at),ot=round(ut.times(ut),at),tt=3;;){if(rt=round(rt.times(ot),at),st=it.plus(divide(rt,new dt(tt),at)),digitsToString(st.d).slice(0,at)===digitsToString(it.d).slice(0,at))return it=it.times(2),nt!==0&&(it=it.plus(getLn10(dt,at+2,ht).times(nt+""))),it=divide(it,new dt(ct),at),dt.precision=ht,$==null?(external=!0,round(it,ht)):it;it=st,tt+=2}}function parseDecimal(j,$){var _e,et,tt;for((_e=$.indexOf("."))>-1&&($=$.replace(".","")),(et=$.search(/e/i))>0?(_e<0&&(_e=et),_e+=+$.slice(et+1),$=$.substring(0,et)):_e<0&&(_e=$.length),et=0;$.charCodeAt(et)===48;)++et;for(tt=$.length;$.charCodeAt(tt-1)===48;)--tt;if($=$.slice(et,tt),$){if(tt-=et,_e=_e-et-1,j.e=mathfloor(_e/LOG_BASE),j.d=[],et=(_e+1)%LOG_BASE,_e<0&&(et+=LOG_BASE),et<tt){for(et&&j.d.push(+$.slice(0,et)),tt-=LOG_BASE;et<tt;)j.d.push(+$.slice(et,et+=LOG_BASE));$=$.slice(et),et=LOG_BASE-$.length}else et-=tt;for(;et--;)$+="0";if(j.d.push(+$),external&&(j.e>MAX_E||j.e<-MAX_E))throw Error(exponentOutOfRange+_e)}else j.s=0,j.e=0,j.d=[0];return j}function round(j,$,_e){var et,tt,nt,rt,it,st,at,ot,ct=j.d;for(rt=1,nt=ct[0];nt>=10;nt/=10)rt++;if(et=$-rt,et<0)et+=LOG_BASE,tt=$,at=ct[ot=0];else{if(ot=Math.ceil((et+1)/LOG_BASE),nt=ct.length,ot>=nt)return j;for(at=nt=ct[ot],rt=1;nt>=10;nt/=10)rt++;et%=LOG_BASE,tt=et-LOG_BASE+rt}if(_e!==void 0&&(nt=mathpow(10,rt-tt-1),it=at/nt%10|0,st=$<0||ct[ot+1]!==void 0||at%nt,st=_e<4?(it||st)&&(_e==0||_e==(j.s<0?3:2)):it>5||it==5&&(_e==4||st||_e==6&&(et>0?tt>0?at/mathpow(10,rt-tt):0:ct[ot-1])%10&1||_e==(j.s<0?8:7))),$<1||!ct[0])return st?(nt=getBase10Exponent(j),ct.length=1,$=$-nt-1,ct[0]=mathpow(10,(LOG_BASE-$%LOG_BASE)%LOG_BASE),j.e=mathfloor(-$/LOG_BASE)||0):(ct.length=1,ct[0]=j.e=j.s=0),j;if(et==0?(ct.length=ot,nt=1,ot--):(ct.length=ot+1,nt=mathpow(10,LOG_BASE-et),ct[ot]=tt>0?(at/mathpow(10,rt-tt)%mathpow(10,tt)|0)*nt:0),st)for(;;)if(ot==0){(ct[0]+=nt)==BASE&&(ct[0]=1,++j.e);break}else{if(ct[ot]+=nt,ct[ot]!=BASE)break;ct[ot--]=0,nt=1}for(et=ct.length;ct[--et]===0;)ct.pop();if(external&&(j.e>MAX_E||j.e<-MAX_E))throw Error(exponentOutOfRange+getBase10Exponent(j));return j}function subtract(j,$){var _e,et,tt,nt,rt,it,st,at,ot,ct,lt=j.constructor,ut=lt.precision;if(!j.s||!$.s)return $.s?$.s=-$.s:$=new lt(j),external?round($,ut):$;if(st=j.d,ct=$.d,et=$.e,at=j.e,st=st.slice(),rt=at-et,rt){for(ot=rt<0,ot?(_e=st,rt=-rt,it=ct.length):(_e=ct,et=at,it=st.length),tt=Math.max(Math.ceil(ut/LOG_BASE),it)+2,rt>tt&&(rt=tt,_e.length=1),_e.reverse(),tt=rt;tt--;)_e.push(0);_e.reverse()}else{for(tt=st.length,it=ct.length,ot=tt<it,ot&&(it=tt),tt=0;tt<it;tt++)if(st[tt]!=ct[tt]){ot=st[tt]<ct[tt];break}rt=0}for(ot&&(_e=st,st=ct,ct=_e,$.s=-$.s),it=st.length,tt=ct.length-it;tt>0;--tt)st[it++]=0;for(tt=ct.length;tt>rt;){if(st[--tt]<ct[tt]){for(nt=tt;nt&&st[--nt]===0;)st[nt]=BASE-1;--st[nt],st[tt]+=BASE}st[tt]-=ct[tt]}for(;st[--it]===0;)st.pop();for(;st[0]===0;st.shift())--et;return st[0]?($.d=st,$.e=et,external?round($,ut):$):new lt(0)}function toString(j,$,_e){var et,tt=getBase10Exponent(j),nt=digitsToString(j.d),rt=nt.length;return $?(_e&&(et=_e-rt)>0?nt=nt.charAt(0)+"."+nt.slice(1)+getZeroString(et):rt>1&&(nt=nt.charAt(0)+"."+nt.slice(1)),nt=nt+(tt<0?"e":"e+")+tt):tt<0?(nt="0."+getZeroString(-tt-1)+nt,_e&&(et=_e-rt)>0&&(nt+=getZeroString(et))):tt>=rt?(nt+=getZeroString(tt+1-rt),_e&&(et=_e-tt-1)>0&&(nt=nt+"."+getZeroString(et))):((et=tt+1)<rt&&(nt=nt.slice(0,et)+"."+nt.slice(et)),_e&&(et=_e-rt)>0&&(tt+1===rt&&(nt+="."),nt+=getZeroString(et))),j.s<0?"-"+nt:nt}function truncate(j,$){if(j.length>$)return j.length=$,!0}function clone(j){var $,_e,et;function tt(nt){var rt=this;if(!(rt instanceof tt))return new tt(nt);if(rt.constructor=tt,nt instanceof tt){rt.s=nt.s,rt.e=nt.e,rt.d=(nt=nt.d)?nt.slice():nt;return}if(typeof nt=="number"){if(nt*0!==0)throw Error(invalidArgument+nt);if(nt>0)rt.s=1;else if(nt<0)nt=-nt,rt.s=-1;else{rt.s=0,rt.e=0,rt.d=[0];return}if(nt===~~nt&&nt<1e7){rt.e=0,rt.d=[nt];return}return parseDecimal(rt,nt.toString())}else if(typeof nt!="string")throw Error(invalidArgument+nt);if(nt.charCodeAt(0)===45?(nt=nt.slice(1),rt.s=-1):rt.s=1,isDecimal.test(nt))parseDecimal(rt,nt);else throw Error(invalidArgument+nt)}if(tt.prototype=P,tt.ROUND_UP=0,tt.ROUND_DOWN=1,tt.ROUND_CEIL=2,tt.ROUND_FLOOR=3,tt.ROUND_HALF_UP=4,tt.ROUND_HALF_DOWN=5,tt.ROUND_HALF_EVEN=6,tt.ROUND_HALF_CEIL=7,tt.ROUND_HALF_FLOOR=8,tt.clone=clone,tt.config=tt.set=config,j===void 0&&(j={}),j)for(et=["precision","rounding","toExpNeg","toExpPos","LN10"],$=0;$<et.length;)j.hasOwnProperty(_e=et[$++])||(j[_e]=this[_e]);return tt.config(j),tt}function config(j){if(!j||typeof j!="object")throw Error(decimalError+"Object expected");var $,_e,et,tt=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for($=0;$<tt.length;$+=3)if((et=j[_e=tt[$]])!==void 0)if(mathfloor(et)===et&&et>=tt[$+1]&&et<=tt[$+2])this[_e]=et;else throw Error(invalidArgument+_e+": "+et);if((et=j[_e="LN10"])!==void 0)if(et==Math.LN10)this[_e]=new this(et);else throw Error(invalidArgument+_e+": "+et);return this}var Decimal=clone(defaults);ONE=new Decimal(1);const Decimal$1=Decimal;var identity=j=>j,PLACE_HOLDER={},isPlaceHolder=j=>j===PLACE_HOLDER,curry0=j=>function $(){return arguments.length===0||arguments.length===1&&isPlaceHolder(arguments.length<=0?void 0:arguments[0])?$:j(...arguments)},curryN=(j,$)=>j===1?$:curry0(function(){for(var _e=arguments.length,et=new Array(_e),tt=0;tt<_e;tt++)et[tt]=arguments[tt];var nt=et.filter(rt=>rt!==PLACE_HOLDER).length;return nt>=j?$(...et):curryN(j-nt,curry0(function(){for(var rt=arguments.length,it=new Array(rt),st=0;st<rt;st++)it[st]=arguments[st];var at=et.map(ot=>isPlaceHolder(ot)?it.shift():ot);return $(...at,...it)}))}),curry=j=>curryN(j.length,j),range=(j,$)=>{for(var _e=[],et=j;et<$;++et)_e[et-j]=et;return _e},map=curry((j,$)=>Array.isArray($)?$.map(j):Object.keys($).map(_e=>$[_e]).map(j)),compose=function j(){for(var $=arguments.length,_e=new Array($),et=0;et<$;et++)_e[et]=arguments[et];if(!_e.length)return identity;var tt=_e.reverse(),nt=tt[0],rt=tt.slice(1);return function(){return rt.reduce((it,st)=>st(it),nt(...arguments))}},reverse=j=>Array.isArray(j)?j.reverse():j.split("").reverse().join("");function getDigitCount(j){var $;return j===0?$=1:$=Math.floor(new Decimal$1(j).abs().log(10).toNumber())+1,$}function rangeStep(j,$,_e){for(var et=new Decimal$1(j),tt=0,nt=[];et.lt($)&&tt<1e5;)nt.push(et.toNumber()),et=et.add(_e),tt++;return nt}var getValidInterval=j=>{var[$,_e]=j,[et,tt]=[$,_e];return $>_e&&([et,tt]=[_e,$]),[et,tt]},getFormatStep=(j,$,_e)=>{if(j.lte(0))return new Decimal$1(0);var et=getDigitCount(j.toNumber()),tt=new Decimal$1(10).pow(et),nt=j.div(tt),rt=et!==1?.05:.1,it=new Decimal$1(Math.ceil(nt.div(rt).toNumber())).add(_e).mul(rt),st=it.mul(tt);return $?new Decimal$1(st.toNumber()):new Decimal$1(Math.ceil(st.toNumber()))},getTickOfSingleValue=(j,$,_e)=>{var et=new Decimal$1(1),tt=new Decimal$1(j);if(!tt.isint()&&_e){var nt=Math.abs(j);nt<1?(et=new Decimal$1(10).pow(getDigitCount(j)-1),tt=new Decimal$1(Math.floor(tt.div(et).toNumber())).mul(et)):nt>1&&(tt=new Decimal$1(Math.floor(j)))}else j===0?tt=new Decimal$1(Math.floor(($-1)/2)):_e||(tt=new Decimal$1(Math.floor(j)));var rt=Math.floor(($-1)/2),it=compose(map(st=>tt.add(new Decimal$1(st-rt).mul(et)).toNumber()),range);return it(0,$)},_calculateStep=function j($,_e,et,tt){var nt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((_e-$)/(et-1)))return{step:new Decimal$1(0),tickMin:new Decimal$1(0),tickMax:new Decimal$1(0)};var rt=getFormatStep(new Decimal$1(_e).sub($).div(et-1),tt,nt),it;$<=0&&_e>=0?it=new Decimal$1(0):(it=new Decimal$1($).add(_e).div(2),it=it.sub(new Decimal$1(it).mod(rt)));var st=Math.ceil(it.sub($).div(rt).toNumber()),at=Math.ceil(new Decimal$1(_e).sub(it).div(rt).toNumber()),ot=st+at+1;return ot>et?_calculateStep($,_e,et,tt,nt+1):(ot<et&&(at=_e>0?at+(et-ot):at,st=_e>0?st:st+(et-ot)),{step:rt,tickMin:it.sub(new Decimal$1(st).mul(rt)),tickMax:it.add(new Decimal$1(at).mul(rt))})},getNiceTickValues=function j($){var[_e,et]=$,tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,nt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,rt=Math.max(tt,2),[it,st]=getValidInterval([_e,et]);if(it===-1/0||st===1/0){var at=st===1/0?[it,...range(0,tt-1).map(()=>1/0)]:[...range(0,tt-1).map(()=>-1/0),st];return _e>et?reverse(at):at}if(it===st)return getTickOfSingleValue(it,tt,nt);var{step:ot,tickMin:ct,tickMax:lt}=_calculateStep(it,st,rt,nt,0),ut=rangeStep(ct,lt.add(new Decimal$1(.1).mul(ot)),ot);return _e>et?reverse(ut):ut},getTickValuesFixedDomain=function j($,_e){var[et,tt]=$,nt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[rt,it]=getValidInterval([et,tt]);if(rt===-1/0||it===1/0)return[et,tt];if(rt===it)return[rt];var st=Math.max(_e,2),at=getFormatStep(new Decimal$1(it).sub(rt).div(st-1),nt,0),ot=[...rangeStep(new Decimal$1(rt),new Decimal$1(it),at),it];return nt===!1&&(ot=ot.map(ct=>Math.round(ct))),et>tt?reverse(ot):ot},selectBarCategoryGap=j=>j.rootProps.barCategoryGap,selectStackOffsetType=j=>j.rootProps.stackOffset,selectReverseStackOrder=j=>j.rootProps.reverseStackOrder,selectChartName=j=>j.options.chartName,selectSyncId=j=>j.rootProps.syncId,selectSyncMethod=j=>j.rootProps.syncMethod,selectEventEmitter=j=>j.options.eventEmitter,DefaultZIndexes={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},defaultPolarAngleAxisProps={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},defaultPolarRadiusAxisProps={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},combineAxisRangeWithReverse=(j,$)=>{if(!(!j||!$))return j!=null&&j.reversed?[$[1],$[0]]:$},implicitAngleAxis={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:defaultPolarAngleAxisProps.angleAxisId,includeHidden:!1,name:void 0,reversed:defaultPolarAngleAxisProps.reversed,scale:defaultPolarAngleAxisProps.scale,tick:defaultPolarAngleAxisProps.tick,tickCount:void 0,ticks:void 0,type:defaultPolarAngleAxisProps.type,unit:void 0},implicitRadiusAxis={allowDataOverflow:defaultPolarRadiusAxisProps.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:defaultPolarRadiusAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarRadiusAxisProps.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarRadiusAxisProps.scale,tick:defaultPolarRadiusAxisProps.tick,tickCount:defaultPolarRadiusAxisProps.tickCount,ticks:void 0,type:defaultPolarRadiusAxisProps.type,unit:void 0},implicitRadialBarAngleAxis={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:defaultPolarAngleAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarAngleAxisProps.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarAngleAxisProps.scale,tick:defaultPolarAngleAxisProps.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},implicitRadialBarRadiusAxis={allowDataOverflow:defaultPolarRadiusAxisProps.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:defaultPolarRadiusAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarRadiusAxisProps.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarRadiusAxisProps.scale,tick:defaultPolarRadiusAxisProps.tick,tickCount:defaultPolarRadiusAxisProps.tickCount,ticks:void 0,type:"category",unit:void 0},selectAngleAxis=(j,$)=>j.polarAxis.angleAxis[$]!=null?j.polarAxis.angleAxis[$]:j.layout.layoutType==="radial"?implicitRadialBarAngleAxis:implicitAngleAxis,selectRadiusAxis=(j,$)=>j.polarAxis.radiusAxis[$]!=null?j.polarAxis.radiusAxis[$]:j.layout.layoutType==="radial"?implicitRadialBarRadiusAxis:implicitRadiusAxis,selectPolarOptions=j=>j.polarOptions,selectMaxRadius=createSelector([selectChartWidth,selectChartHeight,selectChartOffsetInternal],getMaxRadius),selectInnerRadius=createSelector([selectPolarOptions,selectMaxRadius],(j,$)=>{if(j!=null)return getPercentValue(j.innerRadius,$,0)}),selectOuterRadius=createSelector([selectPolarOptions,selectMaxRadius],(j,$)=>{if(j!=null)return getPercentValue(j.outerRadius,$,$*.8)}),combineAngleAxisRange=j=>{if(j==null)return[0,0];var{startAngle:$,endAngle:_e}=j;return[$,_e]},selectAngleAxisRange=createSelector([selectPolarOptions],combineAngleAxisRange);createSelector([selectAngleAxis,selectAngleAxisRange],combineAxisRangeWithReverse);var selectRadiusAxisRange=createSelector([selectMaxRadius,selectInnerRadius,selectOuterRadius],(j,$,_e)=>{if(!(j==null||$==null||_e==null))return[$,_e]});createSelector([selectRadiusAxis,selectRadiusAxisRange],combineAxisRangeWithReverse);var selectPolarViewBox=createSelector([selectChartLayout,selectPolarOptions,selectInnerRadius,selectOuterRadius,selectChartWidth,selectChartHeight],(j,$,_e,et,tt,nt)=>{if(!(j!=="centric"&&j!=="radial"||$==null||_e==null||et==null)){var{cx:rt,cy:it,startAngle:st,endAngle:at}=$;return{cx:getPercentValue(rt,tt,tt/2),cy:getPercentValue(it,nt,nt/2),innerRadius:_e,outerRadius:et,startAngle:st,endAngle:at,clockWise:!1}}}),pickAxisType=(j,$)=>$,pickAxisId=(j,$,_e)=>_e;function getStackSeriesIdentifier(j){return j==null?void 0:j.id}function combineDisplayedStackedData(j,$,_e){var{chartData:et=[]}=$,{allowDuplicatedCategory:tt,dataKey:nt}=_e,rt=new Map;return j.forEach(it=>{var st,at=(st=it.data)!==null&&st!==void 0?st:et;if(!(at==null||at.length===0)){var ot=getStackSeriesIdentifier(it);at.forEach((ct,lt)=>{var ut=nt==null||tt?lt:String(getValueByDataKey(ct,nt,null)),pt=getValueByDataKey(ct,it.dataKey,0),dt;rt.has(ut)?dt=rt.get(ut):dt={},Object.assign(dt,{[ot]:pt}),rt.set(ut,dt)})}}),Array.from(rt.values())}function isStacked(j){return j.stackId!=null&&j.dataKey!=null}var numberDomainEqualityCheck=(j,$)=>j===$?!0:j==null||$==null?!1:j[0]===$[0]&&j[1]===$[1];function emptyArraysAreEqualCheck(j,$){return Array.isArray(j)&&Array.isArray($)&&j.length===0&&$.length===0?!0:j===$}function arrayContentsAreEqualCheck(j,$){if(j.length===$.length){for(var _e=0;_e<j.length;_e++)if(j[_e]!==$[_e])return!1;return!0}return!1}var selectTooltipAxisType=j=>{var $=selectChartLayout(j);return $==="horizontal"?"xAxis":$==="vertical"?"yAxis":$==="centric"?"angleAxis":"radiusAxis"},selectTooltipAxisId=j=>j.tooltip.settings.axisId;function ownKeys$m(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$m(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$m(Object(_e),!0).forEach(function(et){_defineProperty$o(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$m(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$o(j,$,_e){return($=_toPropertyKey$o($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$o(j){var $=_toPrimitive$o(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$o(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var defaultNumericDomain=[0,"auto"],implicitXAxis={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},selectXAxisSettingsNoDefaults=(j,$)=>j.cartesianAxis.xAxis[$],selectXAxisSettings=(j,$)=>{var _e=selectXAxisSettingsNoDefaults(j,$);return _e??implicitXAxis},implicitYAxis={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:defaultNumericDomain,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:DEFAULT_Y_AXIS_WIDTH},selectYAxisSettingsNoDefaults=(j,$)=>j.cartesianAxis.yAxis[$],selectYAxisSettings=(j,$)=>{var _e=selectYAxisSettingsNoDefaults(j,$);return _e??implicitYAxis},implicitZAxis={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},selectZAxisSettings=(j,$)=>{var _e=j.cartesianAxis.zAxis[$];return _e??implicitZAxis},selectBaseAxis=(j,$,_e)=>{switch($){case"xAxis":return selectXAxisSettings(j,_e);case"yAxis":return selectYAxisSettings(j,_e);case"zAxis":return selectZAxisSettings(j,_e);case"angleAxis":return selectAngleAxis(j,_e);case"radiusAxis":return selectRadiusAxis(j,_e);default:throw new Error("Unexpected axis type: ".concat($))}},selectCartesianAxisSettings=(j,$,_e)=>{switch($){case"xAxis":return selectXAxisSettings(j,_e);case"yAxis":return selectYAxisSettings(j,_e);default:throw new Error("Unexpected axis type: ".concat($))}},selectAxisSettings=(j,$,_e)=>{switch($){case"xAxis":return selectXAxisSettings(j,_e);case"yAxis":return selectYAxisSettings(j,_e);case"angleAxis":return selectAngleAxis(j,_e);case"radiusAxis":return selectRadiusAxis(j,_e);default:throw new Error("Unexpected axis type: ".concat($))}},selectHasBar=j=>j.graphicalItems.cartesianItems.some($=>$.type==="bar")||j.graphicalItems.polarItems.some($=>$.type==="radialBar");function itemAxisPredicate(j,$){return _e=>{switch(j){case"xAxis":return"xAxisId"in _e&&_e.xAxisId===$;case"yAxis":return"yAxisId"in _e&&_e.yAxisId===$;case"zAxis":return"zAxisId"in _e&&_e.zAxisId===$;case"angleAxis":return"angleAxisId"in _e&&_e.angleAxisId===$;case"radiusAxis":return"radiusAxisId"in _e&&_e.radiusAxisId===$;default:return!1}}}var selectUnfilteredCartesianItems=j=>j.graphicalItems.cartesianItems,selectAxisPredicate$1=createSelector([pickAxisType,pickAxisId],itemAxisPredicate),combineGraphicalItemsSettings=(j,$,_e)=>j.filter(_e).filter(et=>($==null?void 0:$.includeHidden)===!0?!0:!et.hide),selectCartesianItemsSettings=createSelector([selectUnfilteredCartesianItems,selectBaseAxis,selectAxisPredicate$1],combineGraphicalItemsSettings,{memoizeOptions:{resultEqualityCheck:emptyArraysAreEqualCheck}}),selectStackedCartesianItemsSettings=createSelector([selectCartesianItemsSettings],j=>j.filter($=>$.type==="area"||$.type==="bar").filter(isStacked)),filterGraphicalNotStackedItems=j=>j.filter($=>!("stackId"in $)||$.stackId===void 0),selectCartesianItemsSettingsExceptStacked=createSelector([selectCartesianItemsSettings],filterGraphicalNotStackedItems),combineGraphicalItemsData=j=>j.map($=>$.data).filter(Boolean).flat(1),selectCartesianGraphicalItemsData=createSelector([selectCartesianItemsSettings],combineGraphicalItemsData,{memoizeOptions:{resultEqualityCheck:emptyArraysAreEqualCheck}}),combineDisplayedData=(j,$)=>{var{chartData:_e=[],dataStartIndex:et,dataEndIndex:tt}=$;return j.length>0?j:_e.slice(et,tt+1)},selectDisplayedData$1=createSelector([selectCartesianGraphicalItemsData,selectChartDataWithIndexesIfNotInPanorama],combineDisplayedData),combineAppliedValues=(j,$,_e)=>($==null?void 0:$.dataKey)!=null?j.map(et=>({value:getValueByDataKey(et,$.dataKey)})):_e.length>0?_e.map(et=>et.dataKey).flatMap(et=>j.map(tt=>({value:getValueByDataKey(tt,et)}))):j.map(et=>({value:et})),selectAllAppliedValues=createSelector([selectDisplayedData$1,selectBaseAxis,selectCartesianItemsSettings],combineAppliedValues);function isErrorBarRelevantForAxisType(j,$){switch(j){case"xAxis":return $.direction==="x";case"yAxis":return $.direction==="y";default:return!1}}function makeNumber(j){if(isNumOrStr(j)||j instanceof Date){var $=Number(j);if(isWellBehavedNumber($))return $}}function makeDomain(j){if(Array.isArray(j)){var $=[makeNumber(j[0]),makeNumber(j[1])];return isWellFormedNumberDomain($)?$:void 0}var _e=makeNumber(j);if(_e!=null)return[_e,_e]}function onlyAllowNumbers(j){return j.map(makeNumber).filter(isNotNil)}function getErrorDomainByDataKey(j,$,_e){return!_e||typeof $!="number"||isNan($)?[]:_e.length?onlyAllowNumbers(_e.flatMap(et=>{var tt=getValueByDataKey(j,et.dataKey),nt,rt;if(Array.isArray(tt)?[nt,rt]=tt:nt=rt=tt,!(!isWellBehavedNumber(nt)||!isWellBehavedNumber(rt)))return[$-nt,$+rt]})):[]}var selectTooltipAxis=j=>{var $=selectTooltipAxisType(j),_e=selectTooltipAxisId(j);return selectAxisSettings(j,$,_e)},selectTooltipAxisDataKey=createSelector([selectTooltipAxis],j=>j==null?void 0:j.dataKey),selectDisplayedStackedData=createSelector([selectStackedCartesianItemsSettings,selectChartDataWithIndexesIfNotInPanorama,selectTooltipAxis],combineDisplayedStackedData),combineStackGroups=(j,$,_e,et)=>{var tt={},nt=$.reduce((rt,it)=>(it.stackId==null||(rt[it.stackId]==null&&(rt[it.stackId]=[]),rt[it.stackId].push(it)),rt),tt);return Object.fromEntries(Object.entries(nt).map(rt=>{var[it,st]=rt,at=et?[...st].reverse():st,ot=at.map(getStackSeriesIdentifier);return[it,{stackedData:getStackedData(j,ot,_e),graphicalItems:at}]}))},selectStackGroups=createSelector([selectDisplayedStackedData,selectStackedCartesianItemsSettings,selectStackOffsetType,selectReverseStackOrder],combineStackGroups),combineDomainOfStackGroups=(j,$,_e,et)=>{var{dataStartIndex:tt,dataEndIndex:nt}=$;if(et==null&&_e!=="zAxis"){var rt=getDomainOfStackGroups(j,tt,nt);if(!(rt!=null&&rt[0]===0&&rt[1]===0))return rt}},selectAllowsDataOverflow=createSelector([selectBaseAxis],j=>j.allowDataOverflow),getDomainDefinition=j=>{var $;if(j==null||!("domain"in j))return defaultNumericDomain;if(j.domain!=null)return j.domain;if(j.ticks!=null){if(j.type==="number"){var _e=onlyAllowNumbers(j.ticks);return[Math.min(..._e),Math.max(..._e)]}if(j.type==="category")return j.ticks.map(String)}return($=j==null?void 0:j.domain)!==null&&$!==void 0?$:defaultNumericDomain},selectDomainDefinition=createSelector([selectBaseAxis],getDomainDefinition),selectDomainFromUserPreference=createSelector([selectDomainDefinition,selectAllowsDataOverflow],numericalDomainSpecifiedWithoutRequiringData),selectDomainOfStackGroups=createSelector([selectStackGroups,selectChartDataWithIndexes,pickAxisType,selectDomainFromUserPreference],combineDomainOfStackGroups,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),selectAllErrorBarSettings=j=>j.errorBars,combineRelevantErrorBarSettings=(j,$,_e)=>j.flatMap(et=>$[et.id]).filter(Boolean).filter(et=>isErrorBarRelevantForAxisType(_e,et)),mergeDomains=function j(){for(var $=arguments.length,_e=new Array($),et=0;et<$;et++)_e[et]=arguments[et];var tt=_e.filter(Boolean);if(tt.length!==0){var nt=tt.flat(),rt=Math.min(...nt),it=Math.max(...nt);return[rt,it]}},combineDomainOfAllAppliedNumericalValuesIncludingErrorValues=(j,$,_e,et,tt)=>{var nt,rt;if(_e.length>0&&j.forEach(it=>{_e.forEach(st=>{var at,ot,ct=(at=et[st.id])===null||at===void 0?void 0:at.filter(ft=>isErrorBarRelevantForAxisType(tt,ft)),lt=getValueByDataKey(it,(ot=$.dataKey)!==null&&ot!==void 0?ot:st.dataKey),ut=getErrorDomainByDataKey(it,lt,ct);if(ut.length>=2){var pt=Math.min(...ut),dt=Math.max(...ut);(nt==null||pt<nt)&&(nt=pt),(rt==null||dt>rt)&&(rt=dt)}var ht=makeDomain(lt);ht!=null&&(nt=nt==null?ht[0]:Math.min(nt,ht[0]),rt=rt==null?ht[1]:Math.max(rt,ht[1]))})}),($==null?void 0:$.dataKey)!=null&&j.forEach(it=>{var st=makeDomain(getValueByDataKey(it,$.dataKey));st!=null&&(nt=nt==null?st[0]:Math.min(nt,st[0]),rt=rt==null?st[1]:Math.max(rt,st[1]))}),isWellBehavedNumber(nt)&&isWellBehavedNumber(rt))return[nt,rt]},selectDomainOfAllAppliedNumericalValuesIncludingErrorValues$1=createSelector([selectDisplayedData$1,selectBaseAxis,selectCartesianItemsSettingsExceptStacked,selectAllErrorBarSettings,pickAxisType],combineDomainOfAllAppliedNumericalValuesIncludingErrorValues,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}});function onlyAllowNumbersAndStringsAndDates(j){var{value:$}=j;if(isNumOrStr($)||$ instanceof Date)return $}var computeDomainOfTypeCategory=(j,$,_e)=>{var et=j.map(onlyAllowNumbersAndStringsAndDates).filter(tt=>tt!=null);return _e&&($.dataKey==null||$.allowDuplicatedCategory&&hasDuplicate(et))?range$3(0,j.length):$.allowDuplicatedCategory?et:Array.from(new Set(et))},selectReferenceDots=j=>j.referenceElements.dots,filterReferenceElements=(j,$,_e)=>j.filter(et=>et.ifOverflow==="extendDomain").filter(et=>$==="xAxis"?et.xAxisId===_e:et.yAxisId===_e),selectReferenceDotsByAxis=createSelector([selectReferenceDots,pickAxisType,pickAxisId],filterReferenceElements),selectReferenceAreas=j=>j.referenceElements.areas,selectReferenceAreasByAxis=createSelector([selectReferenceAreas,pickAxisType,pickAxisId],filterReferenceElements),selectReferenceLines=j=>j.referenceElements.lines,selectReferenceLinesByAxis=createSelector([selectReferenceLines,pickAxisType,pickAxisId],filterReferenceElements),combineDotsDomain=(j,$)=>{var _e=onlyAllowNumbers(j.map(et=>$==="xAxis"?et.x:et.y));if(_e.length!==0)return[Math.min(..._e),Math.max(..._e)]},selectReferenceDotsDomain=createSelector(selectReferenceDotsByAxis,pickAxisType,combineDotsDomain),combineAreasDomain=(j,$)=>{var _e=onlyAllowNumbers(j.flatMap(et=>[$==="xAxis"?et.x1:et.y1,$==="xAxis"?et.x2:et.y2]));if(_e.length!==0)return[Math.min(..._e),Math.max(..._e)]},selectReferenceAreasDomain=createSelector([selectReferenceAreasByAxis,pickAxisType],combineAreasDomain);function extractXCoordinates(j){var $;if(j.x!=null)return onlyAllowNumbers([j.x]);var _e=($=j.segment)===null||$===void 0?void 0:$.map(et=>et.x);return _e==null||_e.length===0?[]:onlyAllowNumbers(_e)}function extractYCoordinates(j){var $;if(j.y!=null)return onlyAllowNumbers([j.y]);var _e=($=j.segment)===null||$===void 0?void 0:$.map(et=>et.y);return _e==null||_e.length===0?[]:onlyAllowNumbers(_e)}var combineLinesDomain=(j,$)=>{var _e=j.flatMap(et=>$==="xAxis"?extractXCoordinates(et):extractYCoordinates(et));if(_e.length!==0)return[Math.min(..._e),Math.max(..._e)]},selectReferenceLinesDomain=createSelector([selectReferenceLinesByAxis,pickAxisType],combineLinesDomain),selectReferenceElementsDomain=createSelector(selectReferenceDotsDomain,selectReferenceLinesDomain,selectReferenceAreasDomain,(j,$,_e)=>mergeDomains(j,_e,$)),combineNumericalDomain=(j,$,_e,et,tt,nt,rt,it)=>{if(_e!=null)return _e;var st=rt==="vertical"&&it==="xAxis"||rt==="horizontal"&&it==="yAxis",at=st?mergeDomains(et,nt,tt):mergeDomains(nt,tt);return parseNumericalUserDomain($,at,j.allowDataOverflow)},selectNumericalDomain=createSelector([selectBaseAxis,selectDomainDefinition,selectDomainFromUserPreference,selectDomainOfStackGroups,selectDomainOfAllAppliedNumericalValuesIncludingErrorValues$1,selectReferenceElementsDomain,selectChartLayout,pickAxisType],combineNumericalDomain,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),expandDomain=[0,1],combineAxisDomain=(j,$,_e,et,tt,nt,rt)=>{if(!((j==null||_e==null||_e.length===0)&&rt===void 0)){var{dataKey:it,type:st}=j,at=isCategoricalAxis($,nt);if(at&&it==null){var ot;return range$3(0,(ot=_e==null?void 0:_e.length)!==null&&ot!==void 0?ot:0)}return st==="category"?computeDomainOfTypeCategory(et,j,at):tt==="expand"?expandDomain:rt}},selectAxisDomain=createSelector([selectBaseAxis,selectChartLayout,selectDisplayedData$1,selectAllAppliedValues,selectStackOffsetType,pickAxisType,selectNumericalDomain],combineAxisDomain),combineRealScaleType=(j,$,_e,et,tt)=>{if(j!=null){var{scale:nt,type:rt}=j;if(nt==="auto")return $==="radial"&&tt==="radiusAxis"?"band":$==="radial"&&tt==="angleAxis"?"linear":rt==="category"&&et&&(et.indexOf("LineChart")>=0||et.indexOf("AreaChart")>=0||et.indexOf("ComposedChart")>=0&&!_e)?"point":rt==="category"?"band":"linear";if(typeof nt=="string"){var it="scale".concat(upperFirst(nt));return it in d3Scales?it:"point"}}},selectRealScaleType=createSelector([selectBaseAxis,selectChartLayout,selectHasBar,selectChartName,pickAxisType],combineRealScaleType);function getD3ScaleFromType(j){if(j!=null){if(j in d3Scales)return d3Scales[j]();var $="scale".concat(upperFirst(j));if($ in d3Scales)return d3Scales[$]()}}function combineScaleFunction(j,$,_e,et){if(!(_e==null||et==null)){if(typeof j.scale=="function")return j.scale.copy().domain(_e).range(et);var tt=getD3ScaleFromType($);if(tt!=null){var nt=tt.domain(_e).range(et);return checkDomainOfScale(nt),nt}}}var combineNiceTicks=(j,$,_e)=>{var et=getDomainDefinition($);if(!(_e!=="auto"&&_e!=="linear")){if($!=null&&$.tickCount&&Array.isArray(et)&&(et[0]==="auto"||et[1]==="auto")&&isWellFormedNumberDomain(j))return getNiceTickValues(j,$.tickCount,$.allowDecimals);if($!=null&&$.tickCount&&$.type==="number"&&isWellFormedNumberDomain(j))return getTickValuesFixedDomain(j,$.tickCount,$.allowDecimals)}},selectNiceTicks=createSelector([selectAxisDomain,selectAxisSettings,selectRealScaleType],combineNiceTicks),combineAxisDomainWithNiceTicks=(j,$,_e,et)=>{if(et!=="angleAxis"&&(j==null?void 0:j.type)==="number"&&isWellFormedNumberDomain($)&&Array.isArray(_e)&&_e.length>0){var tt=$[0],nt=_e[0],rt=$[1],it=_e[_e.length-1];return[Math.min(tt,nt),Math.max(rt,it)]}return $},selectAxisDomainIncludingNiceTicks=createSelector([selectBaseAxis,selectAxisDomain,selectNiceTicks,pickAxisType],combineAxisDomainWithNiceTicks),selectSmallestDistanceBetweenValues=createSelector(selectAllAppliedValues,selectBaseAxis,(j,$)=>{if(!(!$||$.type!=="number")){var _e=1/0,et=Array.from(onlyAllowNumbers(j.map(it=>it.value))).sort((it,st)=>it-st);if(et.length<2)return 1/0;var tt=et[et.length-1]-et[0];if(tt===0)return 1/0;for(var nt=0;nt<et.length-1;nt++){var rt=et[nt+1]-et[nt];_e=Math.min(_e,rt)}return _e/tt}}),selectCalculatedPadding=createSelector(selectSmallestDistanceBetweenValues,selectChartLayout,selectBarCategoryGap,selectChartOffsetInternal,(j,$,_e,et)=>et,(j,$,_e,et,tt)=>{if(!isWellBehavedNumber(j))return 0;var nt=$==="vertical"?et.height:et.width;if(tt==="gap")return j*nt/2;if(tt==="no-gap"){var rt=getPercentValue(_e,j*nt),it=j*nt/2;return it-rt-(it-rt)/nt*rt}return 0}),selectCalculatedXAxisPadding=(j,$)=>{var _e=selectXAxisSettings(j,$);return _e==null||typeof _e.padding!="string"?0:selectCalculatedPadding(j,"xAxis",$,_e.padding)},selectCalculatedYAxisPadding=(j,$)=>{var _e=selectYAxisSettings(j,$);return _e==null||typeof _e.padding!="string"?0:selectCalculatedPadding(j,"yAxis",$,_e.padding)},selectXAxisPadding=createSelector(selectXAxisSettings,selectCalculatedXAxisPadding,(j,$)=>{var _e,et;if(j==null)return{left:0,right:0};var{padding:tt}=j;return typeof tt=="string"?{left:$,right:$}:{left:((_e=tt.left)!==null&&_e!==void 0?_e:0)+$,right:((et=tt.right)!==null&&et!==void 0?et:0)+$}}),selectYAxisPadding=createSelector(selectYAxisSettings,selectCalculatedYAxisPadding,(j,$)=>{var _e,et;if(j==null)return{top:0,bottom:0};var{padding:tt}=j;return typeof tt=="string"?{top:$,bottom:$}:{top:((_e=tt.top)!==null&&_e!==void 0?_e:0)+$,bottom:((et=tt.bottom)!==null&&et!==void 0?et:0)+$}}),combineXAxisRange=createSelector([selectChartOffsetInternal,selectXAxisPadding,selectBrushDimensions,selectBrushSettings,(j,$,_e)=>_e],(j,$,_e,et,tt)=>{var{padding:nt}=et;return tt?[nt.left,_e.width-nt.right]:[j.left+$.left,j.left+j.width-$.right]}),combineYAxisRange=createSelector([selectChartOffsetInternal,selectChartLayout,selectYAxisPadding,selectBrushDimensions,selectBrushSettings,(j,$,_e)=>_e],(j,$,_e,et,tt,nt)=>{var{padding:rt}=tt;return nt?[et.height-rt.bottom,rt.top]:$==="horizontal"?[j.top+j.height-_e.bottom,j.top+_e.top]:[j.top+_e.top,j.top+j.height-_e.bottom]}),selectAxisRange=(j,$,_e,et)=>{var tt;switch($){case"xAxis":return combineXAxisRange(j,_e,et);case"yAxis":return combineYAxisRange(j,_e,et);case"zAxis":return(tt=selectZAxisSettings(j,_e))===null||tt===void 0?void 0:tt.range;case"angleAxis":return selectAngleAxisRange(j);case"radiusAxis":return selectRadiusAxisRange(j,_e);default:return}},selectAxisRangeWithReverse=createSelector([selectBaseAxis,selectAxisRange],combineAxisRangeWithReverse),selectAxisScale=createSelector([selectBaseAxis,selectRealScaleType,selectAxisDomainIncludingNiceTicks,selectAxisRangeWithReverse],combineScaleFunction);createSelector([selectCartesianItemsSettings,selectAllErrorBarSettings,pickAxisType],combineRelevantErrorBarSettings);function compareIds(j,$){return j.id<$.id?-1:j.id>$.id?1:0}var pickAxisOrientation=(j,$)=>$,pickMirror=(j,$,_e)=>_e,selectAllXAxesWithOffsetType=createSelector(selectAllXAxes,pickAxisOrientation,pickMirror,(j,$,_e)=>j.filter(et=>et.orientation===$).filter(et=>et.mirror===_e).sort(compareIds)),selectAllYAxesWithOffsetType=createSelector(selectAllYAxes,pickAxisOrientation,pickMirror,(j,$,_e)=>j.filter(et=>et.orientation===$).filter(et=>et.mirror===_e).sort(compareIds)),getXAxisSize=(j,$)=>({width:j.width,height:$.height}),getYAxisSize=(j,$)=>{var _e=typeof $.width=="number"?$.width:DEFAULT_Y_AXIS_WIDTH;return{width:_e,height:j.height}},selectXAxisSize=createSelector(selectChartOffsetInternal,selectXAxisSettings,getXAxisSize),combineXAxisPositionStartingPoint=(j,$,_e)=>{switch($){case"top":return j.top;case"bottom":return _e-j.bottom;default:return 0}},combineYAxisPositionStartingPoint=(j,$,_e)=>{switch($){case"left":return j.left;case"right":return _e-j.right;default:return 0}},selectAllXAxesOffsetSteps=createSelector(selectChartHeight,selectChartOffsetInternal,selectAllXAxesWithOffsetType,pickAxisOrientation,pickMirror,(j,$,_e,et,tt)=>{var nt={},rt;return _e.forEach(it=>{var st=getXAxisSize($,it);rt==null&&(rt=combineXAxisPositionStartingPoint($,et,j));var at=et==="top"&&!tt||et==="bottom"&&tt;nt[it.id]=rt-Number(at)*st.height,rt+=(at?-1:1)*st.height}),nt}),selectAllYAxesOffsetSteps=createSelector(selectChartWidth,selectChartOffsetInternal,selectAllYAxesWithOffsetType,pickAxisOrientation,pickMirror,(j,$,_e,et,tt)=>{var nt={},rt;return _e.forEach(it=>{var st=getYAxisSize($,it);rt==null&&(rt=combineYAxisPositionStartingPoint($,et,j));var at=et==="left"&&!tt||et==="right"&&tt;nt[it.id]=rt-Number(at)*st.width,rt+=(at?-1:1)*st.width}),nt}),selectXAxisOffsetSteps=(j,$)=>{var _e=selectXAxisSettings(j,$);if(_e!=null)return selectAllXAxesOffsetSteps(j,_e.orientation,_e.mirror)},selectXAxisPosition=createSelector([selectChartOffsetInternal,selectXAxisSettings,selectXAxisOffsetSteps,(j,$)=>$],(j,$,_e,et)=>{if($!=null){var tt=_e==null?void 0:_e[et];return tt==null?{x:j.left,y:0}:{x:j.left,y:tt}}}),selectYAxisOffsetSteps=(j,$)=>{var _e=selectYAxisSettings(j,$);if(_e!=null)return selectAllYAxesOffsetSteps(j,_e.orientation,_e.mirror)},selectYAxisPosition=createSelector([selectChartOffsetInternal,selectYAxisSettings,selectYAxisOffsetSteps,(j,$)=>$],(j,$,_e,et)=>{if($!=null){var tt=_e==null?void 0:_e[et];return tt==null?{x:0,y:j.top}:{x:tt,y:j.top}}}),selectYAxisSize=createSelector(selectChartOffsetInternal,selectYAxisSettings,(j,$)=>{var _e=typeof $.width=="number"?$.width:DEFAULT_Y_AXIS_WIDTH;return{width:_e,height:j.height}}),combineDuplicateDomain=(j,$,_e,et)=>{if(_e!=null){var{allowDuplicatedCategory:tt,type:nt,dataKey:rt}=_e,it=isCategoricalAxis(j,et),st=$.map(at=>at.value);if(rt&&it&&nt==="category"&&tt&&hasDuplicate(st))return st}},selectDuplicateDomain=createSelector([selectChartLayout,selectAllAppliedValues,selectBaseAxis,pickAxisType],combineDuplicateDomain),combineCategoricalDomain=(j,$,_e,et)=>{if(!(_e==null||_e.dataKey==null)){var{type:tt,scale:nt}=_e,rt=isCategoricalAxis(j,et);if(rt&&(tt==="number"||nt!=="auto"))return $.map(it=>it.value)}},selectCategoricalDomain=createSelector([selectChartLayout,selectAllAppliedValues,selectAxisSettings,pickAxisType],combineCategoricalDomain);createSelector([selectChartLayout,selectCartesianAxisSettings,selectRealScaleType,selectAxisScale,selectDuplicateDomain,selectCategoricalDomain,selectAxisRange,selectNiceTicks,pickAxisType],(j,$,_e,et,tt,nt,rt,it,st)=>{if($!=null){var at=isCategoricalAxis(j,st);return{angle:$.angle,interval:$.interval,minTickGap:$.minTickGap,orientation:$.orientation,tick:$.tick,tickCount:$.tickCount,tickFormatter:$.tickFormatter,ticks:$.ticks,type:$.type,unit:$.unit,axisType:st,categoricalDomain:nt,duplicateDomain:tt,isCategorical:at,niceTicks:it,range:rt,realScaleType:_e,scale:et}}});var combineAxisTicks=(j,$,_e,et,tt,nt,rt,it,st)=>{if(!($==null||et==null)){var at=isCategoricalAxis(j,st),{type:ot,ticks:ct,tickCount:lt}=$,ut=_e==="scaleBand"&&typeof et.bandwidth=="function"?et.bandwidth()/2:2,pt=ot==="category"&&et.bandwidth?et.bandwidth()/ut:0;pt=st==="angleAxis"&&nt!=null&&nt.length>=2?mathSign(nt[0]-nt[1])*2*pt:pt;var dt=ct||tt;if(dt){var ht=dt.map((ft,mt)=>{var gt=rt?rt.indexOf(ft):ft;return{index:mt,coordinate:et(gt)+pt,value:ft,offset:pt}});return ht.filter(ft=>isWellBehavedNumber(ft.coordinate))}return at&&it?it.map((ft,mt)=>({coordinate:et(ft)+pt,value:ft,index:mt,offset:pt})).filter(ft=>isWellBehavedNumber(ft.coordinate)):et.ticks?et.ticks(lt).map(ft=>({coordinate:et(ft)+pt,value:ft,offset:pt})):et.domain().map((ft,mt)=>({coordinate:et(ft)+pt,value:rt?rt[ft]:ft,index:mt,offset:pt}))}},selectTicksOfAxis=createSelector([selectChartLayout,selectAxisSettings,selectRealScaleType,selectAxisScale,selectNiceTicks,selectAxisRange,selectDuplicateDomain,selectCategoricalDomain,pickAxisType],combineAxisTicks),combineGraphicalItemTicks=(j,$,_e,et,tt,nt,rt)=>{if(!($==null||_e==null||et==null||et[0]===et[1])){var it=isCategoricalAxis(j,rt),{tickCount:st}=$,at=0;return at=rt==="angleAxis"&&(et==null?void 0:et.length)>=2?mathSign(et[0]-et[1])*2*at:at,it&&nt?nt.map((ot,ct)=>({coordinate:_e(ot)+at,value:ot,index:ct,offset:at})):_e.ticks?_e.ticks(st).map(ot=>({coordinate:_e(ot)+at,value:ot,offset:at})):_e.domain().map((ot,ct)=>({coordinate:_e(ot)+at,value:tt?tt[ot]:ot,index:ct,offset:at}))}},selectTicksOfGraphicalItem=createSelector([selectChartLayout,selectAxisSettings,selectAxisScale,selectAxisRange,selectDuplicateDomain,selectCategoricalDomain,pickAxisType],combineGraphicalItemTicks),selectAxisWithScale=createSelector(selectBaseAxis,selectAxisScale,(j,$)=>{if(!(j==null||$==null))return _objectSpread$m(_objectSpread$m({},j),{},{scale:$})}),selectZAxisScale=createSelector([selectBaseAxis,selectRealScaleType,selectAxisDomain,selectAxisRangeWithReverse],combineScaleFunction);createSelector((j,$,_e)=>selectZAxisSettings(j,_e),selectZAxisScale,(j,$)=>{if(!(j==null||$==null))return _objectSpread$m(_objectSpread$m({},j),{},{scale:$})});var selectChartDirection=createSelector([selectChartLayout,selectAllXAxes,selectAllYAxes],(j,$,_e)=>{switch(j){case"horizontal":return $.some(et=>et.reversed)?"right-to-left":"left-to-right";case"vertical":return _e.some(et=>et.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),selectDefaultTooltipEventType=j=>j.options.defaultTooltipEventType,selectValidateTooltipEventTypes=j=>j.options.validateTooltipEventTypes;function combineTooltipEventType(j,$,_e){if(j==null)return $;var et=j?"axis":"item";return _e==null?$:_e.includes(et)?et:$}function selectTooltipEventType$1(j,$){var _e=selectDefaultTooltipEventType(j),et=selectValidateTooltipEventTypes(j);return combineTooltipEventType($,_e,et)}function useTooltipEventType(j){return useAppSelector($=>selectTooltipEventType$1($,j))}var combineActiveLabel=(j,$)=>{var _e,et=Number($);if(!(isNan(et)||$==null))return et>=0?j==null||(_e=j[et])===null||_e===void 0?void 0:_e.value:void 0},selectTooltipSettings=j=>j.tooltip.settings,noInteraction={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},initialState$9={itemInteraction:{click:noInteraction,hover:noInteraction},axisInteraction:{click:noInteraction,hover:noInteraction},keyboardInteraction:noInteraction,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},tooltipSlice=createSlice({name:"tooltip",initialState:initialState$9,reducers:{addTooltipEntrySettings:{reducer(j,$){j.tooltipItemPayloads.push($.payload)},prepare:prepareAutoBatched()},replaceTooltipEntrySettings:{reducer(j,$){var{prev:_e,next:et}=$.payload,tt=current$1(j).tooltipItemPayloads.indexOf(_e);tt>-1&&(j.tooltipItemPayloads[tt]=et)},prepare:prepareAutoBatched()},removeTooltipEntrySettings:{reducer(j,$){var _e=current$1(j).tooltipItemPayloads.indexOf($.payload);_e>-1&&j.tooltipItemPayloads.splice(_e,1)},prepare:prepareAutoBatched()},setTooltipSettingsState(j,$){j.settings=$.payload},setActiveMouseOverItemIndex(j,$){j.syncInteraction.active=!1,j.keyboardInteraction.active=!1,j.itemInteraction.hover.active=!0,j.itemInteraction.hover.index=$.payload.activeIndex,j.itemInteraction.hover.dataKey=$.payload.activeDataKey,j.itemInteraction.hover.graphicalItemId=$.payload.activeGraphicalItemId,j.itemInteraction.hover.coordinate=$.payload.activeCoordinate},mouseLeaveChart(j){j.itemInteraction.hover.active=!1,j.axisInteraction.hover.active=!1},mouseLeaveItem(j){j.itemInteraction.hover.active=!1},setActiveClickItemIndex(j,$){j.syncInteraction.active=!1,j.itemInteraction.click.active=!0,j.keyboardInteraction.active=!1,j.itemInteraction.click.index=$.payload.activeIndex,j.itemInteraction.click.dataKey=$.payload.activeDataKey,j.itemInteraction.click.graphicalItemId=$.payload.activeGraphicalItemId,j.itemInteraction.click.coordinate=$.payload.activeCoordinate},setMouseOverAxisIndex(j,$){j.syncInteraction.active=!1,j.axisInteraction.hover.active=!0,j.keyboardInteraction.active=!1,j.axisInteraction.hover.index=$.payload.activeIndex,j.axisInteraction.hover.dataKey=$.payload.activeDataKey,j.axisInteraction.hover.coordinate=$.payload.activeCoordinate},setMouseClickAxisIndex(j,$){j.syncInteraction.active=!1,j.keyboardInteraction.active=!1,j.axisInteraction.click.active=!0,j.axisInteraction.click.index=$.payload.activeIndex,j.axisInteraction.click.dataKey=$.payload.activeDataKey,j.axisInteraction.click.coordinate=$.payload.activeCoordinate},setSyncInteraction(j,$){j.syncInteraction=$.payload},setKeyboardInteraction(j,$){j.keyboardInteraction.active=$.payload.active,j.keyboardInteraction.index=$.payload.activeIndex,j.keyboardInteraction.coordinate=$.payload.activeCoordinate,j.keyboardInteraction.dataKey=$.payload.activeDataKey}}}),{addTooltipEntrySettings,replaceTooltipEntrySettings,removeTooltipEntrySettings,setTooltipSettingsState,setActiveMouseOverItemIndex,mouseLeaveItem,mouseLeaveChart,setActiveClickItemIndex,setMouseOverAxisIndex,setMouseClickAxisIndex,setSyncInteraction,setKeyboardInteraction}=tooltipSlice.actions,tooltipReducer=tooltipSlice.reducer;function ownKeys$l(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$l(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$l(Object(_e),!0).forEach(function(et){_defineProperty$n(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$l(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$n(j,$,_e){return($=_toPropertyKey$n($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$n(j){var $=_toPrimitive$n(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$n(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function chooseAppropriateMouseInteraction(j,$,_e){return $==="axis"?_e==="click"?j.axisInteraction.click:j.axisInteraction.hover:_e==="click"?j.itemInteraction.click:j.itemInteraction.hover}function hasBeenActivePreviously(j){return j.index!=null}var combineTooltipInteractionState=(j,$,_e,et)=>{if($==null)return noInteraction;var tt=chooseAppropriateMouseInteraction(j,$,_e);if(tt==null)return noInteraction;if(tt.active)return tt;if(j.keyboardInteraction.active)return j.keyboardInteraction;if(j.syncInteraction.active&&j.syncInteraction.index!=null)return j.syncInteraction;var nt=j.settings.active===!0;if(hasBeenActivePreviously(tt)){if(nt)return _objectSpread$l(_objectSpread$l({},tt),{},{active:!0})}else if(et!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:et,graphicalItemId:void 0};return _objectSpread$l(_objectSpread$l({},noInteraction),{},{coordinate:tt.coordinate})};function toFiniteNumber(j){if(typeof j=="number")return Number.isFinite(j)?j:void 0;if(j instanceof Date){var $=j.valueOf();return Number.isFinite($)?$:void 0}var _e=Number(j);return Number.isFinite(_e)?_e:void 0}function isValueWithinNumberDomain(j,$){var _e=toFiniteNumber(j),et=$[0],tt=$[1];if(_e===void 0)return!1;var nt=Math.min(et,tt),rt=Math.max(et,tt);return _e>=nt&&_e<=rt}function isValueWithinDomain(j,$,_e){if(_e==null||$==null)return!0;var et=getValueByDataKey(j,$);return et==null||!isWellFormedNumberDomain(_e)?!0:isValueWithinNumberDomain(et,_e)}var combineActiveTooltipIndex=(j,$,_e,et)=>{var tt=j==null?void 0:j.index;if(tt==null)return null;var nt=Number(tt);if(!isWellBehavedNumber(nt))return tt;var rt=0,it=1/0;$.length>0&&(it=$.length-1);var st=Math.max(rt,Math.min(nt,it)),at=$[st];return at==null||isValueWithinDomain(at,_e,et)?String(st):null},combineCoordinateForDefaultIndex=(j,$,_e,et,tt,nt,rt,it)=>{if(!(nt==null||it==null)){var st=rt[0],at=st==null?void 0:it(st.positions,nt);if(at!=null)return at;var ot=tt==null?void 0:tt[Number(nt)];if(ot)switch(_e){case"horizontal":return{x:ot.coordinate,y:(et.top+$)/2};default:return{x:(et.left+j)/2,y:ot.coordinate}}}},combineTooltipPayloadConfigurations=(j,$,_e,et)=>{if($==="axis")return j.tooltipItemPayloads;if(j.tooltipItemPayloads.length===0)return[];var tt;return _e==="hover"?tt=j.itemInteraction.hover.dataKey:tt=j.itemInteraction.click.dataKey,tt==null&&et!=null?[j.tooltipItemPayloads[0]]:j.tooltipItemPayloads.filter(nt=>{var rt;return((rt=nt.settings)===null||rt===void 0?void 0:rt.dataKey)===tt})},selectTooltipPayloadSearcher=j=>j.options.tooltipPayloadSearcher,selectTooltipState=j=>j.tooltip;function ownKeys$k(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$k(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$k(Object(_e),!0).forEach(function(et){_defineProperty$m(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$k(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$m(j,$,_e){return($=_toPropertyKey$m($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$m(j){var $=_toPrimitive$m(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$m(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function selectFinalData(j,$){return j??$}var combineTooltipPayload=(j,$,_e,et,tt,nt,rt)=>{if(!($==null||nt==null)){var{chartData:it,computedData:st,dataStartIndex:at,dataEndIndex:ot}=_e,ct=[];return j.reduce((lt,ut)=>{var pt,{dataDefinedOnItem:dt,settings:ht}=ut,ft=selectFinalData(dt,it),mt=Array.isArray(ft)?getSliced(ft,at,ot):ft,gt=(pt=ht==null?void 0:ht.dataKey)!==null&&pt!==void 0?pt:et,yt=ht==null?void 0:ht.nameKey,vt;if(et&&Array.isArray(mt)&&!Array.isArray(mt[0])&&rt==="axis"?vt=findEntryInArray(mt,et,tt):vt=nt(mt,$,st,yt),Array.isArray(vt))vt.forEach(St=>{var Et=_objectSpread$k(_objectSpread$k({},ht),{},{name:St.name,unit:St.unit,color:void 0,fill:void 0});lt.push(getTooltipEntry({tooltipEntrySettings:Et,dataKey:St.dataKey,payload:St.payload,value:getValueByDataKey(St.payload,St.dataKey),name:St.name}))});else{var xt;lt.push(getTooltipEntry({tooltipEntrySettings:ht,dataKey:gt,payload:vt,value:getValueByDataKey(vt,gt),name:(xt=getValueByDataKey(vt,yt))!==null&&xt!==void 0?xt:ht==null?void 0:ht.name}))}return lt},ct)}},selectTooltipAxisRealScaleType=createSelector([selectTooltipAxis,selectChartLayout,selectHasBar,selectChartName,selectTooltipAxisType],combineRealScaleType),selectAllUnfilteredGraphicalItems=createSelector([j=>j.graphicalItems.cartesianItems,j=>j.graphicalItems.polarItems],(j,$)=>[...j,...$]),selectTooltipAxisPredicate=createSelector([selectTooltipAxisType,selectTooltipAxisId],itemAxisPredicate),selectAllGraphicalItemsSettings=createSelector([selectAllUnfilteredGraphicalItems,selectTooltipAxis,selectTooltipAxisPredicate],combineGraphicalItemsSettings,{memoizeOptions:{resultEqualityCheck:emptyArraysAreEqualCheck}}),selectAllStackedGraphicalItemsSettings=createSelector([selectAllGraphicalItemsSettings],j=>j.filter(isStacked)),selectTooltipGraphicalItemsData=createSelector([selectAllGraphicalItemsSettings],combineGraphicalItemsData,{memoizeOptions:{resultEqualityCheck:emptyArraysAreEqualCheck}}),selectTooltipDisplayedData=createSelector([selectTooltipGraphicalItemsData,selectChartDataWithIndexes],combineDisplayedData),selectTooltipStackedData=createSelector([selectAllStackedGraphicalItemsSettings,selectChartDataWithIndexes,selectTooltipAxis],combineDisplayedStackedData),selectAllTooltipAppliedValues=createSelector([selectTooltipDisplayedData,selectTooltipAxis,selectAllGraphicalItemsSettings],combineAppliedValues),selectTooltipAxisDomainDefinition=createSelector([selectTooltipAxis],getDomainDefinition),selectTooltipDataOverflow=createSelector([selectTooltipAxis],j=>j.allowDataOverflow),selectTooltipDomainFromUserPreferences=createSelector([selectTooltipAxisDomainDefinition,selectTooltipDataOverflow],numericalDomainSpecifiedWithoutRequiringData),selectAllStackedGraphicalItems=createSelector([selectAllGraphicalItemsSettings],j=>j.filter(isStacked)),selectTooltipStackGroups=createSelector([selectTooltipStackedData,selectAllStackedGraphicalItems,selectStackOffsetType,selectReverseStackOrder],combineStackGroups),selectTooltipDomainOfStackGroups=createSelector([selectTooltipStackGroups,selectChartDataWithIndexes,selectTooltipAxisType,selectTooltipDomainFromUserPreferences],combineDomainOfStackGroups),selectTooltipItemsSettingsExceptStacked=createSelector([selectAllGraphicalItemsSettings],filterGraphicalNotStackedItems),selectDomainOfAllAppliedNumericalValuesIncludingErrorValues=createSelector([selectTooltipDisplayedData,selectTooltipAxis,selectTooltipItemsSettingsExceptStacked,selectAllErrorBarSettings,selectTooltipAxisType],combineDomainOfAllAppliedNumericalValuesIncludingErrorValues,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),selectReferenceDotsByTooltipAxis=createSelector([selectReferenceDots,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceDotsDomain=createSelector([selectReferenceDotsByTooltipAxis,selectTooltipAxisType],combineDotsDomain),selectReferenceAreasByTooltipAxis=createSelector([selectReferenceAreas,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceAreasDomain=createSelector([selectReferenceAreasByTooltipAxis,selectTooltipAxisType],combineAreasDomain),selectReferenceLinesByTooltipAxis=createSelector([selectReferenceLines,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceLinesDomain=createSelector([selectReferenceLinesByTooltipAxis,selectTooltipAxisType],combineLinesDomain),selectTooltipReferenceElementsDomain=createSelector([selectTooltipReferenceDotsDomain,selectTooltipReferenceLinesDomain,selectTooltipReferenceAreasDomain],mergeDomains),selectTooltipNumericalDomain=createSelector([selectTooltipAxis,selectTooltipAxisDomainDefinition,selectTooltipDomainFromUserPreferences,selectTooltipDomainOfStackGroups,selectDomainOfAllAppliedNumericalValuesIncludingErrorValues,selectTooltipReferenceElementsDomain,selectChartLayout,selectTooltipAxisType],combineNumericalDomain),selectTooltipAxisDomain=createSelector([selectTooltipAxis,selectChartLayout,selectTooltipDisplayedData,selectAllTooltipAppliedValues,selectStackOffsetType,selectTooltipAxisType,selectTooltipNumericalDomain],combineAxisDomain),selectTooltipNiceTicks=createSelector([selectTooltipAxisDomain,selectTooltipAxis,selectTooltipAxisRealScaleType],combineNiceTicks),selectTooltipAxisDomainIncludingNiceTicks=createSelector([selectTooltipAxis,selectTooltipAxisDomain,selectTooltipNiceTicks,selectTooltipAxisType],combineAxisDomainWithNiceTicks),selectTooltipAxisRange=j=>{var $=selectTooltipAxisType(j),_e=selectTooltipAxisId(j),et=!1;return selectAxisRange(j,$,_e,et)},selectTooltipAxisRangeWithReverse=createSelector([selectTooltipAxis,selectTooltipAxisRange],combineAxisRangeWithReverse),selectTooltipAxisScale=createSelector([selectTooltipAxis,selectTooltipAxisRealScaleType,selectTooltipAxisDomainIncludingNiceTicks,selectTooltipAxisRangeWithReverse],combineScaleFunction),selectTooltipDuplicateDomain=createSelector([selectChartLayout,selectAllTooltipAppliedValues,selectTooltipAxis,selectTooltipAxisType],combineDuplicateDomain),selectTooltipCategoricalDomain=createSelector([selectChartLayout,selectAllTooltipAppliedValues,selectTooltipAxis,selectTooltipAxisType],combineCategoricalDomain),combineTicksOfTooltipAxis=(j,$,_e,et,tt,nt,rt,it)=>{if($){var{type:st}=$,at=isCategoricalAxis(j,it);if(et){var ot=_e==="scaleBand"&&et.bandwidth?et.bandwidth()/2:2,ct=st==="category"&&et.bandwidth?et.bandwidth()/ot:0;return ct=it==="angleAxis"&&tt!=null&&(tt==null?void 0:tt.length)>=2?mathSign(tt[0]-tt[1])*2*ct:ct,at&&rt?rt.map((lt,ut)=>({coordinate:et(lt)+ct,value:lt,index:ut,offset:ct})):et.domain().map((lt,ut)=>({coordinate:et(lt)+ct,value:nt?nt[lt]:lt,index:ut,offset:ct}))}}},selectTooltipAxisTicks=createSelector([selectChartLayout,selectTooltipAxis,selectTooltipAxisRealScaleType,selectTooltipAxisScale,selectTooltipAxisRange,selectTooltipDuplicateDomain,selectTooltipCategoricalDomain,selectTooltipAxisType],combineTicksOfTooltipAxis),selectTooltipEventType=createSelector([selectDefaultTooltipEventType,selectValidateTooltipEventTypes,selectTooltipSettings],(j,$,_e)=>combineTooltipEventType(_e.shared,j,$)),selectTooltipTrigger=j=>j.tooltip.settings.trigger,selectDefaultIndex=j=>j.tooltip.settings.defaultIndex,selectTooltipInteractionState$1=createSelector([selectTooltipState,selectTooltipEventType,selectTooltipTrigger,selectDefaultIndex],combineTooltipInteractionState),selectActiveTooltipIndex=createSelector([selectTooltipInteractionState$1,selectTooltipDisplayedData,selectTooltipAxisDataKey,selectTooltipAxisDomain],combineActiveTooltipIndex),selectActiveLabel$1=createSelector([selectTooltipAxisTicks,selectActiveTooltipIndex],combineActiveLabel),selectActiveTooltipDataKey=createSelector([selectTooltipInteractionState$1],j=>{if(j)return j.dataKey}),selectActiveTooltipGraphicalItemId=createSelector([selectTooltipInteractionState$1],j=>{if(j)return j.graphicalItemId}),selectTooltipPayloadConfigurations$1=createSelector([selectTooltipState,selectTooltipEventType,selectTooltipTrigger,selectDefaultIndex],combineTooltipPayloadConfigurations),selectTooltipCoordinateForDefaultIndex=createSelector([selectChartWidth,selectChartHeight,selectChartLayout,selectChartOffsetInternal,selectTooltipAxisTicks,selectDefaultIndex,selectTooltipPayloadConfigurations$1,selectTooltipPayloadSearcher],combineCoordinateForDefaultIndex),selectActiveTooltipCoordinate=createSelector([selectTooltipInteractionState$1,selectTooltipCoordinateForDefaultIndex],(j,$)=>j!=null&&j.coordinate?j.coordinate:$),selectIsTooltipActive$1=createSelector([selectTooltipInteractionState$1],j=>j.active),selectActiveTooltipPayload=createSelector([selectTooltipPayloadConfigurations$1,selectActiveTooltipIndex,selectChartDataWithIndexes,selectTooltipAxisDataKey,selectActiveLabel$1,selectTooltipPayloadSearcher,selectTooltipEventType],combineTooltipPayload),selectActiveTooltipDataPoints=createSelector([selectActiveTooltipPayload],j=>{if(j!=null){var $=j.map(_e=>_e.payload).filter(_e=>_e!=null);return Array.from(new Set($))}});function ownKeys$j(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$j(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$j(Object(_e),!0).forEach(function(et){_defineProperty$l(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$j(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$l(j,$,_e){return($=_toPropertyKey$l($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$l(j){var $=_toPrimitive$l(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$l(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var useTooltipAxis=()=>useAppSelector(selectTooltipAxis),useTooltipAxisBandSize=()=>{var j=useTooltipAxis(),$=useAppSelector(selectTooltipAxisTicks),_e=useAppSelector(selectTooltipAxisScale);return getBandSizeOfAxis(!j||!_e?void 0:_objectSpread$j(_objectSpread$j({},j),{},{scale:_e}),$)};function ownKeys$i(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$i(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$i(Object(_e),!0).forEach(function(et){_defineProperty$k(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$i(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$k(j,$,_e){return($=_toPropertyKey$k($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$k(j){var $=_toPrimitive$k(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$k(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var getActiveCartesianCoordinate=(j,$,_e,et)=>{var tt=$.find(nt=>nt&&nt.index===_e);if(tt){if(j==="horizontal")return{x:tt.coordinate,y:et.chartY};if(j==="vertical")return{x:et.chartX,y:tt.coordinate}}return{x:0,y:0}},getActivePolarCoordinate=(j,$,_e,et)=>{var tt=$.find(at=>at&&at.index===_e);if(tt){if(j==="centric"){var nt=tt.coordinate,{radius:rt}=et;return _objectSpread$i(_objectSpread$i(_objectSpread$i({},et),polarToCartesian(et.cx,et.cy,rt,nt)),{},{angle:nt,radius:rt})}var it=tt.coordinate,{angle:st}=et;return _objectSpread$i(_objectSpread$i(_objectSpread$i({},et),polarToCartesian(et.cx,et.cy,it,st)),{},{angle:st,radius:it})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function isInCartesianRange(j,$){var{chartX:_e,chartY:et}=j;return _e>=$.left&&_e<=$.left+$.width&&et>=$.top&&et<=$.top+$.height}var calculateActiveTickIndex=(j,$,_e,et,tt)=>{var nt,rt=-1,it=(nt=$==null?void 0:$.length)!==null&&nt!==void 0?nt:0;if(it<=1||j==null)return 0;if(et==="angleAxis"&&tt!=null&&Math.abs(Math.abs(tt[1]-tt[0])-360)<=1e-6)for(var st=0;st<it;st++){var at=st>0?_e[st-1].coordinate:_e[it-1].coordinate,ot=_e[st].coordinate,ct=st>=it-1?_e[0].coordinate:_e[st+1].coordinate,lt=void 0;if(mathSign(ot-at)!==mathSign(ct-ot)){var ut=[];if(mathSign(ct-ot)===mathSign(tt[1]-tt[0])){lt=ct;var pt=ot+tt[1]-tt[0];ut[0]=Math.min(pt,(pt+at)/2),ut[1]=Math.max(pt,(pt+at)/2)}else{lt=at;var dt=ct+tt[1]-tt[0];ut[0]=Math.min(ot,(dt+ot)/2),ut[1]=Math.max(ot,(dt+ot)/2)}var ht=[Math.min(ot,(lt+ot)/2),Math.max(ot,(lt+ot)/2)];if(j>ht[0]&&j<=ht[1]||j>=ut[0]&&j<=ut[1]){({index:rt}=_e[st]);break}}else{var ft=Math.min(at,ct),mt=Math.max(at,ct);if(j>(ft+ot)/2&&j<=(mt+ot)/2){({index:rt}=_e[st]);break}}}else if($){for(var gt=0;gt<it;gt++)if(gt===0&&j<=($[gt].coordinate+$[gt+1].coordinate)/2||gt>0&&gt<it-1&&j>($[gt].coordinate+$[gt-1].coordinate)/2&&j<=($[gt].coordinate+$[gt+1].coordinate)/2||gt===it-1&&j>($[gt].coordinate+$[gt-1].coordinate)/2){({index:rt}=$[gt]);break}}return rt},useChartName=()=>useAppSelector(selectChartName),pickTooltipEventType=(j,$)=>$,pickTrigger=(j,$,_e)=>_e,pickDefaultIndex=(j,$,_e,et)=>et,selectOrderedTooltipTicks=createSelector(selectTooltipAxisTicks,j=>sortBy$1(j,$=>$.coordinate)),selectTooltipInteractionState=createSelector([selectTooltipState,pickTooltipEventType,pickTrigger,pickDefaultIndex],combineTooltipInteractionState),selectActiveIndex=createSelector([selectTooltipInteractionState,selectTooltipDisplayedData,selectTooltipAxisDataKey,selectTooltipAxisDomain],combineActiveTooltipIndex),selectTooltipDataKey=(j,$,_e)=>{if($!=null){var et=selectTooltipState(j);return $==="axis"?_e==="hover"?et.axisInteraction.hover.dataKey:et.axisInteraction.click.dataKey:_e==="hover"?et.itemInteraction.hover.dataKey:et.itemInteraction.click.dataKey}},selectTooltipPayloadConfigurations=createSelector([selectTooltipState,pickTooltipEventType,pickTrigger,pickDefaultIndex],combineTooltipPayloadConfigurations),selectCoordinateForDefaultIndex=createSelector([selectChartWidth,selectChartHeight,selectChartLayout,selectChartOffsetInternal,selectTooltipAxisTicks,pickDefaultIndex,selectTooltipPayloadConfigurations,selectTooltipPayloadSearcher],combineCoordinateForDefaultIndex),selectActiveCoordinate=createSelector([selectTooltipInteractionState,selectCoordinateForDefaultIndex],(j,$)=>{var _e;return(_e=j.coordinate)!==null&&_e!==void 0?_e:$}),selectActiveLabel=createSelector([selectTooltipAxisTicks,selectActiveIndex],combineActiveLabel),selectTooltipPayload=createSelector([selectTooltipPayloadConfigurations,selectActiveIndex,selectChartDataWithIndexes,selectTooltipAxisDataKey,selectActiveLabel,selectTooltipPayloadSearcher,pickTooltipEventType],combineTooltipPayload),selectIsTooltipActive=createSelector([selectTooltipInteractionState,selectActiveIndex],(j,$)=>({isActive:j.active&&$!=null,activeIndex:$})),combineActiveCartesianProps=(j,$,_e,et,tt,nt,rt)=>{if(!(!j||!_e||!et||!tt)&&isInCartesianRange(j,rt)){var it=calculateCartesianTooltipPos(j,$),st=calculateActiveTickIndex(it,nt,tt,_e,et),at=getActiveCartesianCoordinate($,tt,st,j);return{activeIndex:String(st),activeCoordinate:at}}},combineActivePolarProps=(j,$,_e,et,tt,nt,rt)=>{if(!(!j||!et||!tt||!nt||!_e)){var it=inRangeOfSector(j,_e);if(it){var st=calculatePolarTooltipPos(it,$),at=calculateActiveTickIndex(st,rt,nt,et,tt),ot=getActivePolarCoordinate($,nt,at,it);return{activeIndex:String(at),activeCoordinate:ot}}}},combineActiveProps=(j,$,_e,et,tt,nt,rt,it)=>{if(!(!j||!$||!et||!tt||!nt))return $==="horizontal"||$==="vertical"?combineActiveCartesianProps(j,$,et,tt,nt,rt,it):combineActivePolarProps(j,$,_e,et,tt,nt,rt)},selectZIndexPortalId=createSelector(j=>j.zIndex.zIndexMap,(j,$)=>$,(j,$,_e)=>_e,(j,$,_e)=>{if($!=null){var et=j[$];if(et!=null)return _e?et.panoramaElementId:et.elementId}}),selectAllRegisteredZIndexes=createSelector(j=>j.zIndex.zIndexMap,j=>{var $=Object.keys(j).map(et=>parseInt(et,10)).concat(Object.values(DefaultZIndexes)),_e=Array.from(new Set($));return _e.sort((et,tt)=>et-tt)},{memoizeOptions:{resultEqualityCheck:arrayContentsAreEqualCheck}});function ownKeys$h(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$h(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$h(Object(_e),!0).forEach(function(et){_defineProperty$j(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$h(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$j(j,$,_e){return($=_toPropertyKey$j($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$j(j){var $=_toPrimitive$j(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$j(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var seed={},initialState$8={zIndexMap:Object.values(DefaultZIndexes).reduce((j,$)=>_objectSpread$h(_objectSpread$h({},j),{},{[$]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),seed)},defaultZIndexSet=new Set(Object.values(DefaultZIndexes));function isDefaultZIndex(j){return defaultZIndexSet.has(j)}var zIndexSlice=createSlice({name:"zIndex",initialState:initialState$8,reducers:{registerZIndexPortal:{reducer:(j,$)=>{var{zIndex:_e}=$.payload;j.zIndexMap[_e]?j.zIndexMap[_e].consumers+=1:j.zIndexMap[_e]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:prepareAutoBatched()},unregisterZIndexPortal:{reducer:(j,$)=>{var{zIndex:_e}=$.payload;j.zIndexMap[_e]&&(j.zIndexMap[_e].consumers-=1,j.zIndexMap[_e].consumers<=0&&!isDefaultZIndex(_e)&&delete j.zIndexMap[_e])},prepare:prepareAutoBatched()},registerZIndexPortalId:{reducer:(j,$)=>{var{zIndex:_e,elementId:et,isPanorama:tt}=$.payload;j.zIndexMap[_e]?tt?j.zIndexMap[_e].panoramaElementId=et:j.zIndexMap[_e].elementId=et:j.zIndexMap[_e]={consumers:0,elementId:tt?void 0:et,panoramaElementId:tt?et:void 0}},prepare:prepareAutoBatched()},unregisterZIndexPortalId:{reducer:(j,$)=>{var{zIndex:_e}=$.payload;j.zIndexMap[_e]&&($.payload.isPanorama?j.zIndexMap[_e].panoramaElementId=void 0:j.zIndexMap[_e].elementId=void 0)},prepare:prepareAutoBatched()}}}),{registerZIndexPortal,unregisterZIndexPortal,registerZIndexPortalId,unregisterZIndexPortalId}=zIndexSlice.actions,zIndexReducer=zIndexSlice.reducer;function ZIndexLayer(j){var{zIndex:$,children:_e}=j,et=useIsInChartContext(),tt=et&&$!==void 0&&$!==0,nt=useIsPanorama(),rt=useAppDispatch();reactExports.useLayoutEffect(()=>tt?(rt(registerZIndexPortal({zIndex:$})),()=>{rt(unregisterZIndexPortal({zIndex:$}))}):noop$2,[rt,$,tt]);var it=useAppSelector(at=>selectZIndexPortalId(at,$,nt));if(!tt)return _e;if(!it)return null;var st=document.getElementById(it);return st?reactDomExports.createPortal(_e,st):null}function _extends$f(){return _extends$f=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$f.apply(null,arguments)}function ownKeys$g(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$g(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$g(Object(_e),!0).forEach(function(et){_defineProperty$i(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$g(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$i(j,$,_e){return($=_toPropertyKey$i($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$i(j){var $=_toPrimitive$i(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$i(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function RenderCursor(j){var{cursor:$,cursorComp:_e,cursorProps:et}=j;return reactExports.isValidElement($)?reactExports.cloneElement($,et):reactExports.createElement(_e,et)}function CursorInternal(j){var $,{coordinate:_e,payload:et,index:tt,offset:nt,tooltipAxisBandSize:rt,layout:it,cursor:st,tooltipEventType:at,chartName:ot}=j,ct=_e,lt=et,ut=tt;if(!st||!ct||ot!=="ScatterChart"&&at!=="axis")return null;var pt,dt,ht;if(ot==="ScatterChart")pt=ct,dt=Cross,ht=DefaultZIndexes.cursorLine;else if(ot==="BarChart")pt=getCursorRectangle(it,ct,nt,rt),dt=Rectangle,ht=DefaultZIndexes.cursorRectangle;else if(it==="radial"&&isPolarCoordinate(ct)){var{cx:ft,cy:mt,radius:gt,startAngle:yt,endAngle:vt}=getRadialCursorPoints(ct);pt={cx:ft,cy:mt,startAngle:yt,endAngle:vt,innerRadius:gt,outerRadius:gt},dt=Sector,ht=DefaultZIndexes.cursorLine}else pt={points:getCursorPoints(it,ct,nt)},dt=Curve,ht=DefaultZIndexes.cursorLine;var xt=typeof st=="object"&&"className"in st?st.className:void 0,St=_objectSpread$g(_objectSpread$g(_objectSpread$g(_objectSpread$g({stroke:"#ccc",pointerEvents:"none"},nt),pt),svgPropertiesNoEventsFromUnknown(st)),{},{payload:lt,payloadIndex:ut,className:clsx("recharts-tooltip-cursor",xt)});return reactExports.createElement(ZIndexLayer,{zIndex:($=j.zIndex)!==null&&$!==void 0?$:ht},reactExports.createElement(RenderCursor,{cursor:st,cursorComp:dt,cursorProps:St}))}function Cursor(j){var $=useTooltipAxisBandSize(),_e=useOffsetInternal(),et=useChartLayout(),tt=useChartName();return $==null||_e==null||et==null||tt==null?null:reactExports.createElement(CursorInternal,_extends$f({},j,{offset:_e,layout:et,tooltipAxisBandSize:$,chartName:tt}))}var TooltipPortalContext=reactExports.createContext(null),useTooltipPortal=()=>reactExports.useContext(TooltipPortalContext),eventemitter3={exports:{}};(function(j){var $=Object.prototype.hasOwnProperty,_e="~";function et(){}Object.create&&(et.prototype=Object.create(null),new et().__proto__||(_e=!1));function tt(st,at,ot){this.fn=st,this.context=at,this.once=ot||!1}function nt(st,at,ot,ct,lt){if(typeof ot!="function")throw new TypeError("The listener must be a function");var ut=new tt(ot,ct||st,lt),pt=_e?_e+at:at;return st._events[pt]?st._events[pt].fn?st._events[pt]=[st._events[pt],ut]:st._events[pt].push(ut):(st._events[pt]=ut,st._eventsCount++),st}function rt(st,at){--st._eventsCount===0?st._events=new et:delete st._events[at]}function it(){this._events=new et,this._eventsCount=0}it.prototype.eventNames=function(){var at=[],ot,ct;if(this._eventsCount===0)return at;for(ct in ot=this._events)$.call(ot,ct)&&at.push(_e?ct.slice(1):ct);return Object.getOwnPropertySymbols?at.concat(Object.getOwnPropertySymbols(ot)):at},it.prototype.listeners=function(at){var ot=_e?_e+at:at,ct=this._events[ot];if(!ct)return[];if(ct.fn)return[ct.fn];for(var lt=0,ut=ct.length,pt=new Array(ut);lt<ut;lt++)pt[lt]=ct[lt].fn;return pt},it.prototype.listenerCount=function(at){var ot=_e?_e+at:at,ct=this._events[ot];return ct?ct.fn?1:ct.length:0},it.prototype.emit=function(at,ot,ct,lt,ut,pt){var dt=_e?_e+at:at;if(!this._events[dt])return!1;var ht=this._events[dt],ft=arguments.length,mt,gt;if(ht.fn){switch(ht.once&&this.removeListener(at,ht.fn,void 0,!0),ft){case 1:return ht.fn.call(ht.context),!0;case 2:return ht.fn.call(ht.context,ot),!0;case 3:return ht.fn.call(ht.context,ot,ct),!0;case 4:return ht.fn.call(ht.context,ot,ct,lt),!0;case 5:return ht.fn.call(ht.context,ot,ct,lt,ut),!0;case 6:return ht.fn.call(ht.context,ot,ct,lt,ut,pt),!0}for(gt=1,mt=new Array(ft-1);gt<ft;gt++)mt[gt-1]=arguments[gt];ht.fn.apply(ht.context,mt)}else{var yt=ht.length,vt;for(gt=0;gt<yt;gt++)switch(ht[gt].once&&this.removeListener(at,ht[gt].fn,void 0,!0),ft){case 1:ht[gt].fn.call(ht[gt].context);break;case 2:ht[gt].fn.call(ht[gt].context,ot);break;case 3:ht[gt].fn.call(ht[gt].context,ot,ct);break;case 4:ht[gt].fn.call(ht[gt].context,ot,ct,lt);break;default:if(!mt)for(vt=1,mt=new Array(ft-1);vt<ft;vt++)mt[vt-1]=arguments[vt];ht[gt].fn.apply(ht[gt].context,mt)}}return!0},it.prototype.on=function(at,ot,ct){return nt(this,at,ot,ct,!1)},it.prototype.once=function(at,ot,ct){return nt(this,at,ot,ct,!0)},it.prototype.removeListener=function(at,ot,ct,lt){var ut=_e?_e+at:at;if(!this._events[ut])return this;if(!ot)return rt(this,ut),this;var pt=this._events[ut];if(pt.fn)pt.fn===ot&&(!lt||pt.once)&&(!ct||pt.context===ct)&&rt(this,ut);else{for(var dt=0,ht=[],ft=pt.length;dt<ft;dt++)(pt[dt].fn!==ot||lt&&!pt[dt].once||ct&&pt[dt].context!==ct)&&ht.push(pt[dt]);ht.length?this._events[ut]=ht.length===1?ht[0]:ht:rt(this,ut)}return this},it.prototype.removeAllListeners=function(at){var ot;return at?(ot=_e?_e+at:at,this._events[ot]&&rt(this,ot)):(this._events=new et,this._eventsCount=0),this},it.prototype.off=it.prototype.removeListener,it.prototype.addListener=it.prototype.on,it.prefixed=_e,it.EventEmitter=it,j.exports=it})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter=getDefaultExportFromCjs$1(eventemitter3Exports);var eventCenter=new EventEmitter,TOOLTIP_SYNC_EVENT="recharts.syncEvent.tooltip",BRUSH_SYNC_EVENT="recharts.syncEvent.brush";function arrayTooltipSearcher(j,$){if($){var _e=Number.parseInt($,10);if(!isNan(_e))return j==null?void 0:j[_e]}}var initialState$7={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},optionsSlice=createSlice({name:"options",initialState:initialState$7,reducers:{createEventEmitter:j=>{j.eventEmitter==null&&(j.eventEmitter=Symbol("rechartsEventEmitter"))}}}),optionsReducer=optionsSlice.reducer,{createEventEmitter}=optionsSlice.actions;function selectSynchronisedTooltipState(j){return j.tooltip.syncInteraction}var initialChartDataState={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},chartDataSlice=createSlice({name:"chartData",initialState:initialChartDataState,reducers:{setChartData(j,$){if(j.chartData=$.payload,$.payload==null){j.dataStartIndex=0,j.dataEndIndex=0;return}$.payload.length>0&&j.dataEndIndex!==$.payload.length-1&&(j.dataEndIndex=$.payload.length-1)},setComputedData(j,$){j.computedData=$.payload},setDataStartEndIndexes(j,$){var{startIndex:_e,endIndex:et}=$.payload;_e!=null&&(j.dataStartIndex=_e),et!=null&&(j.dataEndIndex=et)}}}),{setChartData,setDataStartEndIndexes,setComputedData}=chartDataSlice.actions,chartDataReducer=chartDataSlice.reducer,_excluded$f=["x","y"];function ownKeys$f(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$f(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$f(Object(_e),!0).forEach(function(et){_defineProperty$h(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$f(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$h(j,$,_e){return($=_toPropertyKey$h($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$h(j){var $=_toPrimitive$h(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$h(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _objectWithoutProperties$f(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$f(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$f(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function useTooltipSyncEventsListener(){var j=useAppSelector(selectSyncId),$=useAppSelector(selectEventEmitter),_e=useAppDispatch(),et=useAppSelector(selectSyncMethod),tt=useAppSelector(selectTooltipAxisTicks),nt=useChartLayout(),rt=useViewBox(),it=useAppSelector(st=>st.rootProps.className);reactExports.useEffect(()=>{if(j==null)return noop$2;var st=(at,ot,ct)=>{if($!==ct&&j===at){if(et==="index"){var lt;if(rt&&ot!==null&&ot!==void 0&&(lt=ot.payload)!==null&&lt!==void 0&&lt.coordinate&&ot.payload.sourceViewBox){var ut=ot.payload.coordinate,{x:pt,y:dt}=ut,ht=_objectWithoutProperties$f(ut,_excluded$f),{x:ft,y:mt,width:gt,height:yt}=ot.payload.sourceViewBox,vt=_objectSpread$f(_objectSpread$f({},ht),{},{x:rt.x+(gt?(pt-ft)/gt:0)*rt.width,y:rt.y+(yt?(dt-mt)/yt:0)*rt.height});_e(_objectSpread$f(_objectSpread$f({},ot),{},{payload:_objectSpread$f(_objectSpread$f({},ot.payload),{},{coordinate:vt})}))}else _e(ot);return}if(tt!=null){var xt;if(typeof et=="function"){var St={activeTooltipIndex:ot.payload.index==null?void 0:Number(ot.payload.index),isTooltipActive:ot.payload.active,activeIndex:ot.payload.index==null?void 0:Number(ot.payload.index),activeLabel:ot.payload.label,activeDataKey:ot.payload.dataKey,activeCoordinate:ot.payload.coordinate},Et=et(tt,St);xt=tt[Et]}else et==="value"&&(xt=tt.find(Kt=>String(Kt.value)===ot.payload.label));var{coordinate:wt}=ot.payload;if(xt==null||ot.payload.active===!1||wt==null||rt==null){_e(setSyncInteraction({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:Tt,y:Ct}=wt,Rt=Math.min(Tt,rt.x+rt.width),jt=Math.min(Ct,rt.y+rt.height),Ot={x:nt==="horizontal"?xt.coordinate:Rt,y:nt==="horizontal"?jt:xt.coordinate},$t=setSyncInteraction({active:ot.payload.active,coordinate:Ot,dataKey:ot.payload.dataKey,index:String(xt.index),label:ot.payload.label,sourceViewBox:ot.payload.sourceViewBox,graphicalItemId:ot.payload.graphicalItemId});_e($t)}}};return eventCenter.on(TOOLTIP_SYNC_EVENT,st),()=>{eventCenter.off(TOOLTIP_SYNC_EVENT,st)}},[it,_e,$,j,et,tt,nt,rt])}function useBrushSyncEventsListener(){var j=useAppSelector(selectSyncId),$=useAppSelector(selectEventEmitter),_e=useAppDispatch();reactExports.useEffect(()=>{if(j==null)return noop$2;var et=(tt,nt,rt)=>{$!==rt&&j===tt&&_e(setDataStartEndIndexes(nt))};return eventCenter.on(BRUSH_SYNC_EVENT,et),()=>{eventCenter.off(BRUSH_SYNC_EVENT,et)}},[_e,$,j])}function useSynchronisedEventsFromOtherCharts(){var j=useAppDispatch();reactExports.useEffect(()=>{j(createEventEmitter())},[j]),useTooltipSyncEventsListener(),useBrushSyncEventsListener()}function useTooltipChartSynchronisation(j,$,_e,et,tt,nt){var rt=useAppSelector(ut=>selectTooltipDataKey(ut,j,$)),it=useAppSelector(selectEventEmitter),st=useAppSelector(selectSyncId),at=useAppSelector(selectSyncMethod),ot=useAppSelector(selectSynchronisedTooltipState),ct=ot==null?void 0:ot.active,lt=useViewBox();reactExports.useEffect(()=>{if(!ct&&st!=null&&it!=null){var ut=setSyncInteraction({active:nt,coordinate:_e,dataKey:rt,index:tt,label:typeof et=="number"?String(et):et,sourceViewBox:lt,graphicalItemId:void 0});eventCenter.emit(TOOLTIP_SYNC_EVENT,st,ut,it)}},[ct,_e,rt,tt,et,it,st,at,nt,lt])}function ownKeys$e(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$e(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$e(Object(_e),!0).forEach(function(et){_defineProperty$g(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$e(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$g(j,$,_e){return($=_toPropertyKey$g($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$g(j){var $=_toPrimitive$g(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$g(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function defaultUniqBy(j){return j.dataKey}function renderContent(j,$){return reactExports.isValidElement(j)?reactExports.cloneElement(j,$):typeof j=="function"?reactExports.createElement(j,$):reactExports.createElement(DefaultTooltipContent,$)}var emptyPayload=[],defaultTooltipProps={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Tooltip(j){var $,_e,et=resolveDefaultProps(j,defaultTooltipProps),{active:tt,allowEscapeViewBox:nt,animationDuration:rt,animationEasing:it,content:st,filterNull:at,isAnimationActive:ot,offset:ct,payloadUniqBy:lt,position:ut,reverseDirection:pt,useTranslate3d:dt,wrapperStyle:ht,cursor:ft,shared:mt,trigger:gt,defaultIndex:yt,portal:vt,axisId:xt}=et,St=useAppDispatch(),Et=typeof yt=="number"?String(yt):yt;reactExports.useEffect(()=>{St(setTooltipSettingsState({shared:mt,trigger:gt,axisId:xt,active:tt,defaultIndex:Et}))},[St,mt,gt,xt,tt,Et]);var wt=useViewBox(),Tt=useAccessibilityLayer(),Ct=useTooltipEventType(mt),{activeIndex:Rt,isActive:jt}=($=useAppSelector(It=>selectIsTooltipActive(It,Ct,gt,Et)))!==null&&$!==void 0?$:{},Ot=useAppSelector(It=>selectTooltipPayload(It,Ct,gt,Et)),$t=useAppSelector(It=>selectActiveLabel(It,Ct,gt,Et)),Kt=useAppSelector(It=>selectActiveCoordinate(It,Ct,gt,Et)),Lt=Ot,Nt=useTooltipPortal(),Bt=(_e=tt??jt)!==null&&_e!==void 0?_e:!1,[kt,rn]=useElementOffset([Lt,Bt]),Gt=Ct==="axis"?$t:void 0;useTooltipChartSynchronisation(Ct,gt,Kt,Gt,Rt,Bt);var _t=vt??Nt;if(_t==null||wt==null||Ct==null)return null;var sn=Lt??emptyPayload;Bt||(sn=emptyPayload),at&&sn.length&&(sn=getUniqPayload(sn.filter(It=>It.value!=null&&(It.hide!==!0||et.includeHidden)),lt,defaultUniqBy));var tn=sn.length>0,on=reactExports.createElement(TooltipBoundingBox,{allowEscapeViewBox:nt,animationDuration:rt,animationEasing:it,isAnimationActive:ot,active:Bt,coordinate:Kt,hasPayload:tn,offset:ct,position:ut,reverseDirection:pt,useTranslate3d:dt,viewBox:wt,wrapperStyle:ht,lastBoundingBox:kt,innerRef:rn,hasPortalFromProps:!!vt},renderContent(st,_objectSpread$e(_objectSpread$e({},et),{},{payload:sn,label:Gt,active:Bt,activeIndex:Rt,coordinate:Kt,accessibilityLayer:Tt})));return reactExports.createElement(reactExports.Fragment,null,reactDomExports.createPortal(on,_t),Bt&&reactExports.createElement(Cursor,{cursor:ft,tooltipEventType:Ct,coordinate:Kt,payload:sn,index:Rt}))}var Cell=j=>null;Cell.displayName="Cell";function _defineProperty$f(j,$,_e){return($=_toPropertyKey$f($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$f(j){var $=_toPrimitive$f(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$f(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}class LRUCache{constructor($){_defineProperty$f(this,"cache",new Map),this.maxSize=$}get($){var _e=this.cache.get($);return _e!==void 0&&(this.cache.delete($),this.cache.set($,_e)),_e}set($,_e){if(this.cache.has($))this.cache.delete($);else if(this.cache.size>=this.maxSize){var et=this.cache.keys().next().value;et!=null&&this.cache.delete(et)}this.cache.set($,_e)}clear(){this.cache.clear()}size(){return this.cache.size}}function ownKeys$d(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$d(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$d(Object(_e),!0).forEach(function(et){_defineProperty$e(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$d(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$e(j,$,_e){return($=_toPropertyKey$e($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$e(j){var $=_toPrimitive$e(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$e(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var defaultConfig={cacheSize:2e3,enableCache:!0},currentConfig=_objectSpread$d({},defaultConfig),stringCache=new LRUCache(currentConfig.cacheSize),SPAN_STYLE={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MEASUREMENT_SPAN_ID="recharts_measurement_span";function createCacheKey(j,$){var _e=$.fontSize||"",et=$.fontFamily||"",tt=$.fontWeight||"",nt=$.fontStyle||"",rt=$.letterSpacing||"",it=$.textTransform||"";return"".concat(j,"|").concat(_e,"|").concat(et,"|").concat(tt,"|").concat(nt,"|").concat(rt,"|").concat(it)}var measureTextWithDOM=(j,$)=>{try{var _e=document.getElementById(MEASUREMENT_SPAN_ID);_e||(_e=document.createElement("span"),_e.setAttribute("id",MEASUREMENT_SPAN_ID),_e.setAttribute("aria-hidden","true"),document.body.appendChild(_e)),Object.assign(_e.style,SPAN_STYLE,$),_e.textContent="".concat(j);var et=_e.getBoundingClientRect();return{width:et.width,height:et.height}}catch{return{width:0,height:0}}},getStringSize=function j($){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if($==null||Global.isSsr)return{width:0,height:0};if(!currentConfig.enableCache)return measureTextWithDOM($,_e);var et=createCacheKey($,_e),tt=stringCache.get(et);if(tt)return tt;var nt=measureTextWithDOM($,_e);return stringCache.set(et,nt),nt},MULTIPLY_OR_DIVIDE_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ADD_OR_SUBTRACT_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CSS_LENGTH_UNIT_REGEX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,NUM_SPLIT_REGEX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CONVERSION_RATES={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FIXED_CSS_LENGTH_UNITS=Object.keys(CONVERSION_RATES),STR_NAN="NaN";function convertToPx(j,$){return j*CONVERSION_RATES[$]}class DecimalCSS{static parse($){var _e,[,et,tt]=(_e=NUM_SPLIT_REGEX.exec($))!==null&&_e!==void 0?_e:[];return new DecimalCSS(parseFloat(et),tt??"")}constructor($,_e){this.num=$,this.unit=_e,this.num=$,this.unit=_e,isNan($)&&(this.unit=""),_e!==""&&!CSS_LENGTH_UNIT_REGEX.test(_e)&&(this.num=NaN,this.unit=""),FIXED_CSS_LENGTH_UNITS.includes(_e)&&(this.num=convertToPx($,_e),this.unit="px")}add($){return this.unit!==$.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num+$.num,this.unit)}subtract($){return this.unit!==$.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num-$.num,this.unit)}multiply($){return this.unit!==""&&$.unit!==""&&this.unit!==$.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num*$.num,this.unit||$.unit)}divide($){return this.unit!==""&&$.unit!==""&&this.unit!==$.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num/$.num,this.unit||$.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return isNan(this.num)}}function calculateArithmetic(j){if(j.includes(STR_NAN))return STR_NAN;for(var $=j;$.includes("*")||$.includes("/");){var _e,[,et,tt,nt]=(_e=MULTIPLY_OR_DIVIDE_REGEX.exec($))!==null&&_e!==void 0?_e:[],rt=DecimalCSS.parse(et??""),it=DecimalCSS.parse(nt??""),st=tt==="*"?rt.multiply(it):rt.divide(it);if(st.isNaN())return STR_NAN;$=$.replace(MULTIPLY_OR_DIVIDE_REGEX,st.toString())}for(;$.includes("+")||/.-\d+(?:\.\d+)?/.test($);){var at,[,ot,ct,lt]=(at=ADD_OR_SUBTRACT_REGEX.exec($))!==null&&at!==void 0?at:[],ut=DecimalCSS.parse(ot??""),pt=DecimalCSS.parse(lt??""),dt=ct==="+"?ut.add(pt):ut.subtract(pt);if(dt.isNaN())return STR_NAN;$=$.replace(ADD_OR_SUBTRACT_REGEX,dt.toString())}return $}var PARENTHESES_REGEX=/\(([^()]*)\)/;function calculateParentheses(j){for(var $=j,_e;(_e=PARENTHESES_REGEX.exec($))!=null;){var[,et]=_e;$=$.replace(PARENTHESES_REGEX,calculateArithmetic(et))}return $}function evaluateExpression(j){var $=j.replace(/\s+/g,"");return $=calculateParentheses($),$=calculateArithmetic($),$}function safeEvaluateExpression(j){try{return evaluateExpression(j)}catch{return STR_NAN}}function reduceCSSCalc(j){var $=safeEvaluateExpression(j.slice(5,-1));return $===STR_NAN?"":$}var _excluded$e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],_excluded2$6=["dx","dy","angle","className","breakAll"];function _extends$e(){return _extends$e=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$e.apply(null,arguments)}function _objectWithoutProperties$e(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$e(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$e(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var BREAKING_SPACES=/[ \f\n\r\t\v\u2028\u2029]+/,calculateWordWidths=j=>{var{children:$,breakAll:_e,style:et}=j;try{var tt=[];isNullish($)||(_e?tt=$.toString().split(""):tt=$.toString().split(BREAKING_SPACES));var nt=tt.map(it=>({word:it,width:getStringSize(it,et).width})),rt=_e?0:getStringSize("",et).width;return{wordsWithComputedWidth:nt,spaceWidth:rt}}catch{return null}};function isValidTextAnchor(j){return j==="start"||j==="middle"||j==="end"||j==="inherit"}var calculate=(j,$,_e,et)=>j.reduce((tt,nt)=>{var{word:rt,width:it}=nt,st=tt[tt.length-1];if(st&&it!=null&&($==null||et||st.width+it+_e<Number($)))st.words.push(rt),st.width+=it+_e;else{var at={words:[rt],width:it};tt.push(at)}return tt},[]),findLongestLine=j=>j.reduce(($,_e)=>$.width>_e.width?$:_e),suffix="",checkOverflow=(j,$,_e,et,tt,nt,rt,it)=>{var st=j.slice(0,$),at=calculateWordWidths({breakAll:_e,style:et,children:st+suffix});if(!at)return[!1,[]];var ot=calculate(at.wordsWithComputedWidth,nt,rt,it),ct=ot.length>tt||findLongestLine(ot).width>Number(nt);return[ct,ot]},calculateWordsByLines=(j,$,_e,et,tt)=>{var{maxLines:nt,children:rt,style:it,breakAll:st}=j,at=isNumber(nt),ot=String(rt),ct=calculate($,et,_e,tt);if(!at||tt)return ct;var lt=ct.length>nt||findLongestLine(ct).width>Number(et);if(!lt)return ct;for(var ut=0,pt=ot.length-1,dt=0,ht;ut<=pt&&dt<=ot.length-1;){var ft=Math.floor((ut+pt)/2),mt=ft-1,[gt,yt]=checkOverflow(ot,mt,st,it,nt,et,_e,tt),[vt]=checkOverflow(ot,ft,st,it,nt,et,_e,tt);if(!gt&&!vt&&(ut=ft+1),gt&&vt&&(pt=ft-1),!gt&&vt){ht=yt;break}dt++}return ht||ct},getWordsWithoutCalculate=j=>{var $=isNullish(j)?[]:j.toString().split(BREAKING_SPACES);return[{words:$,width:void 0}]},getWordsByLines=j=>{var{width:$,scaleToFit:_e,children:et,style:tt,breakAll:nt,maxLines:rt}=j;if(($||_e)&&!Global.isSsr){var it,st,at=calculateWordWidths({breakAll:nt,children:et,style:tt});if(at){var{wordsWithComputedWidth:ot,spaceWidth:ct}=at;it=ot,st=ct}else return getWordsWithoutCalculate(et);return calculateWordsByLines({breakAll:nt,children:et,maxLines:rt,style:tt},it,st,$,!!_e)}return getWordsWithoutCalculate(et)},DEFAULT_FILL="#808080",textDefaultProps={angle:0,breakAll:!1,capHeight:"0.71em",fill:DEFAULT_FILL,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Text=reactExports.forwardRef((j,$)=>{var _e=resolveDefaultProps(j,textDefaultProps),{x:et,y:tt,lineHeight:nt,capHeight:rt,fill:it,scaleToFit:st,textAnchor:at,verticalAnchor:ot}=_e,ct=_objectWithoutProperties$e(_e,_excluded$e),lt=reactExports.useMemo(()=>getWordsByLines({breakAll:ct.breakAll,children:ct.children,maxLines:ct.maxLines,scaleToFit:st,style:ct.style,width:ct.width}),[ct.breakAll,ct.children,ct.maxLines,st,ct.style,ct.width]),{dx:ut,dy:pt,angle:dt,className:ht,breakAll:ft}=ct,mt=_objectWithoutProperties$e(ct,_excluded2$6);if(!isNumOrStr(et)||!isNumOrStr(tt)||lt.length===0)return null;var gt=Number(et)+(isNumber(ut)?ut:0),yt=Number(tt)+(isNumber(pt)?pt:0);if(!isWellBehavedNumber(gt)||!isWellBehavedNumber(yt))return null;var vt;switch(ot){case"start":vt=reduceCSSCalc("calc(".concat(rt,")"));break;case"middle":vt=reduceCSSCalc("calc(".concat((lt.length-1)/2," * -").concat(nt," + (").concat(rt," / 2))"));break;default:vt=reduceCSSCalc("calc(".concat(lt.length-1," * -").concat(nt,")"));break}var xt=[];if(st){var St=lt[0].width,{width:Et}=ct;xt.push("scale(".concat(isNumber(Et)&&isNumber(St)?Et/St:1,")"))}return dt&&xt.push("rotate(".concat(dt,", ").concat(gt,", ").concat(yt,")")),xt.length&&(mt.transform=xt.join(" ")),reactExports.createElement("text",_extends$e({},svgPropertiesAndEvents(mt),{ref:$,x:gt,y:yt,className:clsx("recharts-text",ht),textAnchor:at,fill:it.includes("url")?DEFAULT_FILL:it}),lt.map((wt,Tt)=>{var Ct=wt.words.join(ft?"":" ");return reactExports.createElement("tspan",{x:gt,dy:Tt===0?vt:nt,key:"".concat(Ct,"-").concat(Tt)},Ct)}))});Text.displayName="Text";var _excluded$d=["labelRef"];function _objectWithoutProperties$d(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$d(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$d(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function ownKeys$c(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$c(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$c(Object(_e),!0).forEach(function(et){_defineProperty$d(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$c(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$d(j,$,_e){return($=_toPropertyKey$d($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$d(j){var $=_toPrimitive$d(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$d(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$d(){return _extends$d=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$d.apply(null,arguments)}var CartesianLabelContext=reactExports.createContext(null),CartesianLabelContextProvider=j=>{var{x:$,y:_e,upperWidth:et,lowerWidth:tt,width:nt,height:rt,children:it}=j,st=reactExports.useMemo(()=>({x:$,y:_e,upperWidth:et,lowerWidth:tt,width:nt,height:rt}),[$,_e,et,tt,nt,rt]);return reactExports.createElement(CartesianLabelContext.Provider,{value:st},it)},useCartesianLabelContext=()=>{var j=reactExports.useContext(CartesianLabelContext),$=useViewBox();return j||cartesianViewBoxToTrapezoid($)},PolarLabelContext=reactExports.createContext(null),usePolarLabelContext=()=>{var j=reactExports.useContext(PolarLabelContext),$=useAppSelector(selectPolarViewBox);return j||$},getLabel=j=>{var{value:$,formatter:_e}=j,et=isNullish(j.children)?$:j.children;return typeof _e=="function"?_e(et):et},isLabelContentAFunction=j=>j!=null&&typeof j=="function",getDeltaAngle=(j,$)=>{var _e=mathSign($-j),et=Math.min(Math.abs($-j),360);return _e*et},renderRadialLabel=(j,$,_e,et,tt)=>{var{offset:nt,className:rt}=j,{cx:it,cy:st,innerRadius:at,outerRadius:ot,startAngle:ct,endAngle:lt,clockWise:ut}=tt,pt=(at+ot)/2,dt=getDeltaAngle(ct,lt),ht=dt>=0?1:-1,ft,mt;switch($){case"insideStart":ft=ct+ht*nt,mt=ut;break;case"insideEnd":ft=lt-ht*nt,mt=!ut;break;case"end":ft=lt+ht*nt,mt=ut;break;default:throw new Error("Unsupported position ".concat($))}mt=dt<=0?mt:!mt;var gt=polarToCartesian(it,st,pt,ft),yt=polarToCartesian(it,st,pt,ft+(mt?1:-1)*359),vt="M".concat(gt.x,",").concat(gt.y,`
    A`).concat(pt,",").concat(pt,",0,1,").concat(mt?0:1,`,
    `).concat(yt.x,",").concat(yt.y),xt=isNullish(j.id)?uniqueId("recharts-radial-line-"):j.id;return reactExports.createElement("text",_extends$d({},et,{dominantBaseline:"central",className:clsx("recharts-radial-bar-label",rt)}),reactExports.createElement("defs",null,reactExports.createElement("path",{id:xt,d:vt})),reactExports.createElement("textPath",{xlinkHref:"#".concat(xt)},_e))},getAttrsOfPolarLabel=(j,$,_e)=>{var{cx:et,cy:tt,innerRadius:nt,outerRadius:rt,startAngle:it,endAngle:st}=j,at=(it+st)/2;if(_e==="outside"){var{x:ot,y:ct}=polarToCartesian(et,tt,rt+$,at);return{x:ot,y:ct,textAnchor:ot>=et?"start":"end",verticalAnchor:"middle"}}if(_e==="center")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"middle"};if(_e==="centerTop")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"start"};if(_e==="centerBottom")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"end"};var lt=(nt+rt)/2,{x:ut,y:pt}=polarToCartesian(et,tt,lt,at);return{x:ut,y:pt,textAnchor:"middle",verticalAnchor:"middle"}},isPolar=j=>"cx"in j&&isNumber(j.cx),getAttrsOfCartesianLabel=(j,$)=>{var{parentViewBox:_e,offset:et,position:tt}=j,nt;_e!=null&&!isPolar(_e)&&(nt=_e);var{x:rt,y:it,upperWidth:st,lowerWidth:at,height:ot}=$,ct=rt,lt=rt+(st-at)/2,ut=(ct+lt)/2,pt=(st+at)/2,dt=ct+st/2,ht=ot>=0?1:-1,ft=ht*et,mt=ht>0?"end":"start",gt=ht>0?"start":"end",yt=st>=0?1:-1,vt=yt*et,xt=yt>0?"end":"start",St=yt>0?"start":"end";if(tt==="top"){var Et={x:ct+st/2,y:it-ft,textAnchor:"middle",verticalAnchor:mt};return _objectSpread$c(_objectSpread$c({},Et),nt?{height:Math.max(it-nt.y,0),width:st}:{})}if(tt==="bottom"){var wt={x:lt+at/2,y:it+ot+ft,textAnchor:"middle",verticalAnchor:gt};return _objectSpread$c(_objectSpread$c({},wt),nt?{height:Math.max(nt.y+nt.height-(it+ot),0),width:at}:{})}if(tt==="left"){var Tt={x:ut-vt,y:it+ot/2,textAnchor:xt,verticalAnchor:"middle"};return _objectSpread$c(_objectSpread$c({},Tt),nt?{width:Math.max(Tt.x-nt.x,0),height:ot}:{})}if(tt==="right"){var Ct={x:ut+pt+vt,y:it+ot/2,textAnchor:St,verticalAnchor:"middle"};return _objectSpread$c(_objectSpread$c({},Ct),nt?{width:Math.max(nt.x+nt.width-Ct.x,0),height:ot}:{})}var Rt=nt?{width:pt,height:ot}:{};return tt==="insideLeft"?_objectSpread$c({x:ut+vt,y:it+ot/2,textAnchor:St,verticalAnchor:"middle"},Rt):tt==="insideRight"?_objectSpread$c({x:ut+pt-vt,y:it+ot/2,textAnchor:xt,verticalAnchor:"middle"},Rt):tt==="insideTop"?_objectSpread$c({x:ct+st/2,y:it+ft,textAnchor:"middle",verticalAnchor:gt},Rt):tt==="insideBottom"?_objectSpread$c({x:lt+at/2,y:it+ot-ft,textAnchor:"middle",verticalAnchor:mt},Rt):tt==="insideTopLeft"?_objectSpread$c({x:ct+vt,y:it+ft,textAnchor:St,verticalAnchor:gt},Rt):tt==="insideTopRight"?_objectSpread$c({x:ct+st-vt,y:it+ft,textAnchor:xt,verticalAnchor:gt},Rt):tt==="insideBottomLeft"?_objectSpread$c({x:lt+vt,y:it+ot-ft,textAnchor:St,verticalAnchor:mt},Rt):tt==="insideBottomRight"?_objectSpread$c({x:lt+at-vt,y:it+ot-ft,textAnchor:xt,verticalAnchor:mt},Rt):tt&&typeof tt=="object"&&(isNumber(tt.x)||isPercent(tt.x))&&(isNumber(tt.y)||isPercent(tt.y))?_objectSpread$c({x:rt+getPercentValue(tt.x,pt),y:it+getPercentValue(tt.y,ot),textAnchor:"end",verticalAnchor:"end"},Rt):_objectSpread$c({x:dt,y:it+ot/2,textAnchor:"middle",verticalAnchor:"middle"},Rt)},defaultLabelProps={angle:0,offset:5,zIndex:DefaultZIndexes.label,position:"middle",textBreakAll:!1};function Label(j){var $=resolveDefaultProps(j,defaultLabelProps),{viewBox:_e,position:et,value:tt,children:nt,content:rt,className:it="",textBreakAll:st,labelRef:at}=$,ot=usePolarLabelContext(),ct=useCartesianLabelContext(),lt=et==="center"?ct:ot??ct,ut,pt,dt;if(_e==null?ut=lt:isPolar(_e)?ut=_e:ut=cartesianViewBoxToTrapezoid(_e),!ut||isNullish(tt)&&isNullish(nt)&&!reactExports.isValidElement(rt)&&typeof rt!="function")return null;var ht=_objectSpread$c(_objectSpread$c({},$),{},{viewBox:ut});if(reactExports.isValidElement(rt)){var{labelRef:ft}=ht,mt=_objectWithoutProperties$d(ht,_excluded$d);return reactExports.cloneElement(rt,mt)}if(typeof rt=="function"){if(pt=reactExports.createElement(rt,ht),reactExports.isValidElement(pt))return pt}else pt=getLabel($);var gt=svgPropertiesAndEvents($);if(isPolar(ut)){if(et==="insideStart"||et==="insideEnd"||et==="end")return renderRadialLabel($,et,pt,gt,ut);dt=getAttrsOfPolarLabel(ut,$.offset,$.position)}else dt=getAttrsOfCartesianLabel($,ut);return reactExports.createElement(ZIndexLayer,{zIndex:$.zIndex},reactExports.createElement(Text,_extends$d({ref:at,className:clsx("recharts-label",it)},gt,dt,{textAnchor:isValidTextAnchor(gt.textAnchor)?gt.textAnchor:dt.textAnchor,breakAll:st}),pt))}Label.displayName="Label";var parseLabel=(j,$,_e)=>{if(!j)return null;var et={viewBox:$,labelRef:_e};return j===!0?reactExports.createElement(Label,_extends$d({key:"label-implicit"},et)):isNumOrStr(j)?reactExports.createElement(Label,_extends$d({key:"label-implicit",value:j},et)):reactExports.isValidElement(j)?j.type===Label?reactExports.cloneElement(j,_objectSpread$c({key:"label-implicit"},et)):reactExports.createElement(Label,_extends$d({key:"label-implicit",content:j},et)):isLabelContentAFunction(j)?reactExports.createElement(Label,_extends$d({key:"label-implicit",content:j},et)):j&&typeof j=="object"?reactExports.createElement(Label,_extends$d({},j,{key:"label-implicit"},et)):null};function CartesianLabelFromLabelProp(j){var{label:$,labelRef:_e}=j,et=useCartesianLabelContext();return parseLabel($,et,_e)||null}var last$3={},last$2={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return _e[_e.length-1]}j.last=$})(last$2);var toArray$1={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){return Array.isArray(_e)?_e:Array.from(_e)}j.toArray=$})(toArray$1);(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});const $=last$2,_e=toArray$1,et=isArrayLike;function tt(nt){if(et.isArrayLike(nt))return $.last(_e.toArray(nt))}j.last=tt})(last$3);var last=last$3.last;const last$1=getDefaultExportFromCjs$1(last);var _excluded$c=["valueAccessor"],_excluded2$5=["dataKey","clockWise","id","textBreakAll","zIndex"];function _extends$c(){return _extends$c=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$c.apply(null,arguments)}function _objectWithoutProperties$c(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$c(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$c(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var defaultAccessor=j=>Array.isArray(j.value)?last$1(j.value):j.value,CartesianLabelListContext=reactExports.createContext(void 0),CartesianLabelListContextProvider=CartesianLabelListContext.Provider,PolarLabelListContext=reactExports.createContext(void 0),PolarLabelListContextProvider=PolarLabelListContext.Provider;function useCartesianLabelListContext(){return reactExports.useContext(CartesianLabelListContext)}function usePolarLabelListContext(){return reactExports.useContext(PolarLabelListContext)}function LabelList(j){var{valueAccessor:$=defaultAccessor}=j,_e=_objectWithoutProperties$c(j,_excluded$c),{dataKey:et,clockWise:tt,id:nt,textBreakAll:rt,zIndex:it}=_e,st=_objectWithoutProperties$c(_e,_excluded2$5),at=useCartesianLabelListContext(),ot=usePolarLabelListContext(),ct=at||ot;return!ct||!ct.length?null:reactExports.createElement(ZIndexLayer,{zIndex:it??DefaultZIndexes.label},reactExports.createElement(Layer,{className:"recharts-label-list"},ct.map((lt,ut)=>{var pt,dt=isNullish(et)?$(lt,ut):getValueByDataKey(lt&&lt.payload,et),ht=isNullish(nt)?{}:{id:"".concat(nt,"-").concat(ut)};return reactExports.createElement(Label,_extends$c({key:"label-".concat(ut)},svgPropertiesAndEvents(lt),st,ht,{fill:(pt=_e.fill)!==null&&pt!==void 0?pt:lt.fill,parentViewBox:lt.parentViewBox,value:dt,textBreakAll:rt,viewBox:lt.viewBox,index:ut,zIndex:0}))})))}LabelList.displayName="LabelList";function LabelListFromLabelProp(j){var{label:$}=j;return $?$===!0?reactExports.createElement(LabelList,{key:"labelList-implicit"}):reactExports.isValidElement($)||isLabelContentAFunction($)?reactExports.createElement(LabelList,{key:"labelList-implicit",content:$}):typeof $=="object"?reactExports.createElement(LabelList,_extends$c({key:"labelList-implicit"},$,{type:String($.type)})):null:null}function _extends$b(){return _extends$b=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$b.apply(null,arguments)}var Dot=j=>{var{cx:$,cy:_e,r:et,className:tt}=j,nt=clsx("recharts-dot",tt);return isNumber($)&&isNumber(_e)&&isNumber(et)?reactExports.createElement("circle",_extends$b({},svgPropertiesNoEvents(j),adaptEventHandlers(j),{className:nt,cx:$,cy:_e,r:et})):null},selectUnfilteredPolarItems=j=>j.graphicalItems.polarItems,selectAxisPredicate=createSelector([pickAxisType,pickAxisId],itemAxisPredicate),selectPolarItemsSettings=createSelector([selectUnfilteredPolarItems,selectBaseAxis,selectAxisPredicate],combineGraphicalItemsSettings),selectPolarGraphicalItemsData=createSelector([selectPolarItemsSettings],combineGraphicalItemsData),selectPolarDisplayedData=createSelector([selectPolarGraphicalItemsData,selectChartDataAndAlwaysIgnoreIndexes],combineDisplayedData),selectPolarAppliedValues=createSelector([selectPolarDisplayedData,selectBaseAxis,selectPolarItemsSettings],combineAppliedValues);createSelector([selectPolarDisplayedData,selectBaseAxis,selectPolarItemsSettings],(j,$,_e)=>_e.length>0?j.flatMap(et=>_e.flatMap(tt=>{var nt,rt=getValueByDataKey(et,(nt=$.dataKey)!==null&&nt!==void 0?nt:tt.dataKey);return{value:rt,errorDomain:[]}})).filter(Boolean):($==null?void 0:$.dataKey)!=null?j.map(et=>({value:getValueByDataKey(et,$.dataKey),errorDomain:[]})):j.map(et=>({value:et,errorDomain:[]})));var unsupportedInPolarChart=()=>{},selectDomainOfAllPolarAppliedNumericalValues=createSelector([selectPolarDisplayedData,selectBaseAxis,selectPolarItemsSettings,selectAllErrorBarSettings,pickAxisType],combineDomainOfAllAppliedNumericalValuesIncludingErrorValues),selectPolarNumericalDomain=createSelector([selectBaseAxis,selectDomainDefinition,selectDomainFromUserPreference,unsupportedInPolarChart,selectDomainOfAllPolarAppliedNumericalValues,unsupportedInPolarChart,selectChartLayout,pickAxisType],combineNumericalDomain),selectPolarAxisDomain=createSelector([selectBaseAxis,selectChartLayout,selectPolarDisplayedData,selectPolarAppliedValues,selectStackOffsetType,pickAxisType,selectPolarNumericalDomain],combineAxisDomain),selectPolarNiceTicks=createSelector([selectPolarAxisDomain,selectBaseAxis,selectRealScaleType],combineNiceTicks);createSelector([selectBaseAxis,selectPolarAxisDomain,selectPolarNiceTicks,pickAxisType],combineAxisDomainWithNiceTicks);var initialState$6={radiusAxis:{},angleAxis:{}},polarAxisSlice=createSlice({name:"polarAxis",initialState:initialState$6,reducers:{addRadiusAxis(j,$){j.radiusAxis[$.payload.id]=$.payload},removeRadiusAxis(j,$){delete j.radiusAxis[$.payload.id]},addAngleAxis(j,$){j.angleAxis[$.payload.id]=$.payload},removeAngleAxis(j,$){delete j.angleAxis[$.payload.id]}}}),{addRadiusAxis,removeRadiusAxis,addAngleAxis,removeAngleAxis}=polarAxisSlice.actions,polarAxisReducer=polarAxisSlice.reducer;function ownKeys$b(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$b(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$b(Object(_e),!0).forEach(function(et){_defineProperty$c(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$b(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$c(j,$,_e){return($=_toPropertyKey$c($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$c(j){var $=_toPrimitive$c(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$c(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var pickId=(j,$)=>$,selectSynchronisedPieSettings=createSelector([selectUnfilteredPolarItems,pickId],(j,$)=>j.filter(_e=>_e.type==="pie").find(_e=>_e.id===$)),emptyArray=[],pickCells=(j,$,_e)=>(_e==null?void 0:_e.length)===0?emptyArray:_e,selectDisplayedData=createSelector([selectChartDataAndAlwaysIgnoreIndexes,selectSynchronisedPieSettings,pickCells],(j,$,_e)=>{var{chartData:et}=j;if($!=null){var tt;if(($==null?void 0:$.data)!=null&&$.data.length>0?tt=$.data:tt=et,(!tt||!tt.length)&&_e!=null&&(tt=_e.map(nt=>_objectSpread$b(_objectSpread$b({},$.presentationProps),nt.props))),tt!=null)return tt}}),selectPieLegend=createSelector([selectDisplayedData,selectSynchronisedPieSettings,pickCells],(j,$,_e)=>{if(!(j==null||$==null))return j.map((et,tt)=>{var nt,rt=getValueByDataKey(et,$.nameKey,$.name),it;return _e!=null&&(nt=_e[tt])!==null&&nt!==void 0&&(nt=nt.props)!==null&&nt!==void 0&&nt.fill?it=_e[tt].props.fill:typeof et=="object"&&et!=null&&"fill"in et?it=et.fill:it=$.fill,{value:getTooltipNameProp(rt,$.dataKey),color:it,payload:et,type:$.legendType}})}),selectPieSectors=createSelector([selectDisplayedData,selectSynchronisedPieSettings,pickCells,selectChartOffsetInternal],(j,$,_e,et)=>{if(!($==null||j==null))return computePieSectors({offset:et,pieSettings:$,displayedData:j,cells:_e})}),reactIs={exports:{}},reactIs_production={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var REACT_ELEMENT_TYPE=Symbol.for("react.transitional.element"),REACT_PORTAL_TYPE=Symbol.for("react.portal"),REACT_FRAGMENT_TYPE=Symbol.for("react.fragment"),REACT_STRICT_MODE_TYPE=Symbol.for("react.strict_mode"),REACT_PROFILER_TYPE=Symbol.for("react.profiler"),REACT_CONSUMER_TYPE=Symbol.for("react.consumer"),REACT_CONTEXT_TYPE=Symbol.for("react.context"),REACT_FORWARD_REF_TYPE=Symbol.for("react.forward_ref"),REACT_SUSPENSE_TYPE=Symbol.for("react.suspense"),REACT_SUSPENSE_LIST_TYPE=Symbol.for("react.suspense_list"),REACT_MEMO_TYPE=Symbol.for("react.memo"),REACT_LAZY_TYPE=Symbol.for("react.lazy"),REACT_VIEW_TRANSITION_TYPE=Symbol.for("react.view_transition"),REACT_CLIENT_REFERENCE=Symbol.for("react.client.reference");function typeOf(j){if(typeof j=="object"&&j!==null){var $=j.$$typeof;switch($){case REACT_ELEMENT_TYPE:switch(j=j.type,j){case REACT_FRAGMENT_TYPE:case REACT_PROFILER_TYPE:case REACT_STRICT_MODE_TYPE:case REACT_SUSPENSE_TYPE:case REACT_SUSPENSE_LIST_TYPE:case REACT_VIEW_TRANSITION_TYPE:return j;default:switch(j=j&&j.$$typeof,j){case REACT_CONTEXT_TYPE:case REACT_FORWARD_REF_TYPE:case REACT_LAZY_TYPE:case REACT_MEMO_TYPE:return j;case REACT_CONSUMER_TYPE:return j;default:return $}}case REACT_PORTAL_TYPE:return $}}}reactIs_production.ContextConsumer=REACT_CONSUMER_TYPE;reactIs_production.ContextProvider=REACT_CONTEXT_TYPE;reactIs_production.Element=REACT_ELEMENT_TYPE;reactIs_production.ForwardRef=REACT_FORWARD_REF_TYPE;reactIs_production.Fragment=REACT_FRAGMENT_TYPE;reactIs_production.Lazy=REACT_LAZY_TYPE;reactIs_production.Memo=REACT_MEMO_TYPE;reactIs_production.Portal=REACT_PORTAL_TYPE;reactIs_production.Profiler=REACT_PROFILER_TYPE;reactIs_production.StrictMode=REACT_STRICT_MODE_TYPE;reactIs_production.Suspense=REACT_SUSPENSE_TYPE;reactIs_production.SuspenseList=REACT_SUSPENSE_LIST_TYPE;reactIs_production.isContextConsumer=function(j){return typeOf(j)===REACT_CONSUMER_TYPE};reactIs_production.isContextProvider=function(j){return typeOf(j)===REACT_CONTEXT_TYPE};reactIs_production.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===REACT_ELEMENT_TYPE};reactIs_production.isForwardRef=function(j){return typeOf(j)===REACT_FORWARD_REF_TYPE};reactIs_production.isFragment=function(j){return typeOf(j)===REACT_FRAGMENT_TYPE};reactIs_production.isLazy=function(j){return typeOf(j)===REACT_LAZY_TYPE};reactIs_production.isMemo=function(j){return typeOf(j)===REACT_MEMO_TYPE};reactIs_production.isPortal=function(j){return typeOf(j)===REACT_PORTAL_TYPE};reactIs_production.isProfiler=function(j){return typeOf(j)===REACT_PROFILER_TYPE};reactIs_production.isStrictMode=function(j){return typeOf(j)===REACT_STRICT_MODE_TYPE};reactIs_production.isSuspense=function(j){return typeOf(j)===REACT_SUSPENSE_TYPE};reactIs_production.isSuspenseList=function(j){return typeOf(j)===REACT_SUSPENSE_LIST_TYPE};reactIs_production.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===REACT_FRAGMENT_TYPE||j===REACT_PROFILER_TYPE||j===REACT_STRICT_MODE_TYPE||j===REACT_SUSPENSE_TYPE||j===REACT_SUSPENSE_LIST_TYPE||typeof j=="object"&&j!==null&&(j.$$typeof===REACT_LAZY_TYPE||j.$$typeof===REACT_MEMO_TYPE||j.$$typeof===REACT_CONTEXT_TYPE||j.$$typeof===REACT_CONSUMER_TYPE||j.$$typeof===REACT_FORWARD_REF_TYPE||j.$$typeof===REACT_CLIENT_REFERENCE||j.getModuleId!==void 0)};reactIs_production.typeOf=typeOf;reactIs.exports=reactIs_production;var reactIsExports=reactIs.exports,getDisplayName=j=>typeof j=="string"?j:j?j.displayName||j.name||"Component":"",lastChildren=null,lastResult=null,toArray=j=>{if(j===lastChildren&&Array.isArray(lastResult))return lastResult;var $=[];return reactExports.Children.forEach(j,_e=>{isNullish(_e)||(reactIsExports.isFragment(_e)?$=$.concat(toArray(_e.props.children)):$.push(_e))}),lastResult=$,lastChildren=j,$};function findAllByType(j,$){var _e=[],et=[];return Array.isArray($)?et=$.map(tt=>getDisplayName(tt)):et=[getDisplayName($)],toArray(j).forEach(tt=>{var nt=get$2(tt,"type.displayName")||get$2(tt,"type.name");nt&&et.indexOf(nt)!==-1&&_e.push(tt)}),_e}var isClipDot=j=>j&&typeof j=="object"&&"clipDot"in j?!!j.clipDot:!0,isPlainObject$2={};(function(j){Object.defineProperty(j,Symbol.toStringTag,{value:"Module"});function $(_e){var tt;if(typeof _e!="object"||_e==null)return!1;if(Object.getPrototypeOf(_e)===null)return!0;if(Object.prototype.toString.call(_e)!=="[object Object]"){const nt=_e[Symbol.toStringTag];return nt==null||!((tt=Object.getOwnPropertyDescriptor(_e,Symbol.toStringTag))!=null&&tt.writable)?!1:_e.toString()===`[object ${nt}]`}let et=_e;for(;Object.getPrototypeOf(et)!==null;)et=Object.getPrototypeOf(et);return Object.getPrototypeOf(_e)===et}j.isPlainObject=$})(isPlainObject$2);var isPlainObject=isPlainObject$2.isPlainObject;const isPlainObject$1=getDefaultExportFromCjs$1(isPlainObject);function ownKeys$a(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$a(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$a(Object(_e),!0).forEach(function(et){_defineProperty$b(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$a(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$b(j,$,_e){return($=_toPropertyKey$b($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$b(j){var $=_toPrimitive$b(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$b(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$a(){return _extends$a=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$a.apply(null,arguments)}var getTrapezoidPath=(j,$,_e,et,tt)=>{var nt=_e-et,rt;return rt="M ".concat(j,",").concat($),rt+="L ".concat(j+_e,",").concat($),rt+="L ".concat(j+_e-nt/2,",").concat($+tt),rt+="L ".concat(j+_e-nt/2-et,",").concat($+tt),rt+="L ".concat(j,",").concat($," Z"),rt},defaultTrapezoidProps={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Trapezoid=j=>{var $=resolveDefaultProps(j,defaultTrapezoidProps),{x:_e,y:et,upperWidth:tt,lowerWidth:nt,height:rt,className:it}=$,{animationEasing:st,animationDuration:at,animationBegin:ot,isUpdateAnimationActive:ct}=$,lt=reactExports.useRef(null),[ut,pt]=reactExports.useState(-1),dt=reactExports.useRef(tt),ht=reactExports.useRef(nt),ft=reactExports.useRef(rt),mt=reactExports.useRef(_e),gt=reactExports.useRef(et),yt=useAnimationId(j,"trapezoid-");if(reactExports.useEffect(()=>{if(lt.current&&lt.current.getTotalLength)try{var Ot=lt.current.getTotalLength();Ot&&pt(Ot)}catch{}},[]),_e!==+_e||et!==+et||tt!==+tt||nt!==+nt||rt!==+rt||tt===0&&nt===0||rt===0)return null;var vt=clsx("recharts-trapezoid",it);if(!ct)return reactExports.createElement("g",null,reactExports.createElement("path",_extends$a({},svgPropertiesAndEvents($),{className:vt,d:getTrapezoidPath(_e,et,tt,nt,rt)})));var xt=dt.current,St=ht.current,Et=ft.current,wt=mt.current,Tt=gt.current,Ct="0px ".concat(ut===-1?1:ut,"px"),Rt="".concat(ut,"px 0px"),jt=getTransitionVal(["strokeDasharray"],at,st);return reactExports.createElement(JavascriptAnimate,{animationId:yt,key:yt,canBegin:ut>0,duration:at,easing:st,isActive:ct,begin:ot},Ot=>{var $t=interpolate$1(xt,tt,Ot),Kt=interpolate$1(St,nt,Ot),Lt=interpolate$1(Et,rt,Ot),Nt=interpolate$1(wt,_e,Ot),Bt=interpolate$1(Tt,et,Ot);lt.current&&(dt.current=$t,ht.current=Kt,ft.current=Lt,mt.current=Nt,gt.current=Bt);var kt=Ot>0?{transition:jt,strokeDasharray:Rt}:{strokeDasharray:Ct};return reactExports.createElement("path",_extends$a({},svgPropertiesAndEvents($),{className:vt,d:getTrapezoidPath(Nt,Bt,$t,Kt,Lt),ref:lt,style:_objectSpread$a(_objectSpread$a({},kt),$.style)}))})},_excluded$b=["option","shapeType","propTransformer","activeClassName"];function _objectWithoutProperties$b(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$b(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$b(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function ownKeys$9(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$9(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$9(Object(_e),!0).forEach(function(et){_defineProperty$a(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$9(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$a(j,$,_e){return($=_toPropertyKey$a($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$a(j){var $=_toPrimitive$a(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$a(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function defaultPropTransformer(j,$){return _objectSpread$9(_objectSpread$9({},$),j)}function isSymbolsProps(j,$){return j==="symbols"}function ShapeSelector(j){var{shapeType:$,elementProps:_e}=j;switch($){case"rectangle":return reactExports.createElement(Rectangle,_e);case"trapezoid":return reactExports.createElement(Trapezoid,_e);case"sector":return reactExports.createElement(Sector,_e);case"symbols":if(isSymbolsProps($))return reactExports.createElement(Symbols,_e);break;case"curve":return reactExports.createElement(Curve,_e);default:return null}}function getPropsFromShapeOption(j){return reactExports.isValidElement(j)?j.props:j}function Shape(j){var{option:$,shapeType:_e,propTransformer:et=defaultPropTransformer,activeClassName:tt="recharts-active-shape"}=j,nt=_objectWithoutProperties$b(j,_excluded$b),rt;if(reactExports.isValidElement($))rt=reactExports.cloneElement($,_objectSpread$9(_objectSpread$9({},nt),getPropsFromShapeOption($)));else if(typeof $=="function")rt=$(nt,nt.index);else if(isPlainObject$1($)&&typeof $!="boolean"){var it=et($,nt);rt=reactExports.createElement(ShapeSelector,{shapeType:_e,elementProps:it})}else{var st=nt;rt=reactExports.createElement(ShapeSelector,{shapeType:_e,elementProps:st})}return nt.isActive?reactExports.createElement(Layer,{className:tt},rt):rt}var useMouseEnterItemDispatch=(j,$,_e)=>{var et=useAppDispatch();return(tt,nt)=>rt=>{j==null||j(tt,nt,rt),et(setActiveMouseOverItemIndex({activeIndex:String(nt),activeDataKey:$,activeCoordinate:tt.tooltipPosition,activeGraphicalItemId:_e}))}},useMouseLeaveItemDispatch=j=>{var $=useAppDispatch();return(_e,et)=>tt=>{j==null||j(_e,et,tt),$(mouseLeaveItem())}},useMouseClickItemDispatch=(j,$,_e)=>{var et=useAppDispatch();return(tt,nt)=>rt=>{j==null||j(tt,nt,rt),et(setActiveClickItemIndex({activeIndex:String(nt),activeDataKey:$,activeCoordinate:tt.tooltipPosition,activeGraphicalItemId:_e}))}};function SetTooltipEntrySettings(j){var{tooltipEntrySettings:$}=j,_e=useAppDispatch(),et=useIsPanorama(),tt=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{et||(tt.current===null?_e(addTooltipEntrySettings($)):tt.current!==$&&_e(replaceTooltipEntrySettings({prev:tt.current,next:$})),tt.current=$)},[$,_e,et]),reactExports.useLayoutEffect(()=>()=>{tt.current&&(_e(removeTooltipEntrySettings(tt.current)),tt.current=null)},[_e]),null}function SetLegendPayload(j){var{legendPayload:$}=j,_e=useAppDispatch(),et=useIsPanorama(),tt=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{et||(tt.current===null?_e(addLegendPayload($)):tt.current!==$&&_e(replaceLegendPayload({prev:tt.current,next:$})),tt.current=$)},[_e,et,$]),reactExports.useLayoutEffect(()=>()=>{tt.current&&(_e(removeLegendPayload(tt.current)),tt.current=null)},[_e]),null}function SetPolarLegendPayload(j){var{legendPayload:$}=j,_e=useAppDispatch(),et=useAppSelector(selectChartLayout),tt=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{et!=="centric"&&et!=="radial"||(tt.current===null?_e(addLegendPayload($)):tt.current!==$&&_e(replaceLegendPayload({prev:tt.current,next:$})),tt.current=$)},[_e,et,$]),reactExports.useLayoutEffect(()=>()=>{tt.current&&(_e(removeLegendPayload(tt.current)),tt.current=null)},[_e]),null}var _ref,useIdFallback=()=>{var[j]=reactExports.useState(()=>uniqueId("uid-"));return j},useId$1=(_ref=React$5.useId)!==null&&_ref!==void 0?_ref:useIdFallback;function useUniqueId(j,$){var _e=useId$1();return $||(j?"".concat(j,"-").concat(_e):_e)}var GraphicalItemIdContext=reactExports.createContext(void 0),RegisterGraphicalItemId=j=>{var{id:$,type:_e,children:et}=j,tt=useUniqueId("recharts-".concat(_e),$);return reactExports.createElement(GraphicalItemIdContext.Provider,{value:tt},et(tt))},initialState$5={cartesianItems:[],polarItems:[]},graphicalItemsSlice=createSlice({name:"graphicalItems",initialState:initialState$5,reducers:{addCartesianGraphicalItem:{reducer(j,$){j.cartesianItems.push($.payload)},prepare:prepareAutoBatched()},replaceCartesianGraphicalItem:{reducer(j,$){var{prev:_e,next:et}=$.payload,tt=current$1(j).cartesianItems.indexOf(_e);tt>-1&&(j.cartesianItems[tt]=et)},prepare:prepareAutoBatched()},removeCartesianGraphicalItem:{reducer(j,$){var _e=current$1(j).cartesianItems.indexOf($.payload);_e>-1&&j.cartesianItems.splice(_e,1)},prepare:prepareAutoBatched()},addPolarGraphicalItem:{reducer(j,$){j.polarItems.push($.payload)},prepare:prepareAutoBatched()},removePolarGraphicalItem:{reducer(j,$){var _e=current$1(j).polarItems.indexOf($.payload);_e>-1&&j.polarItems.splice(_e,1)},prepare:prepareAutoBatched()}}}),{addCartesianGraphicalItem,replaceCartesianGraphicalItem,removeCartesianGraphicalItem,addPolarGraphicalItem,removePolarGraphicalItem}=graphicalItemsSlice.actions,graphicalItemsReducer=graphicalItemsSlice.reducer,SetCartesianGraphicalItemImpl=j=>{var $=useAppDispatch(),_e=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{_e.current===null?$(addCartesianGraphicalItem(j)):_e.current!==j&&$(replaceCartesianGraphicalItem({prev:_e.current,next:j})),_e.current=j},[$,j]),reactExports.useLayoutEffect(()=>()=>{_e.current&&($(removeCartesianGraphicalItem(_e.current)),_e.current=null)},[$]),null},SetCartesianGraphicalItem=reactExports.memo(SetCartesianGraphicalItemImpl);function SetPolarGraphicalItem(j){var $=useAppDispatch();return reactExports.useLayoutEffect(()=>($(addPolarGraphicalItem(j)),()=>{$(removePolarGraphicalItem(j))}),[$,j]),null}var _excluded$a=["key"],_excluded2$4=["onMouseEnter","onClick","onMouseLeave"],_excluded3$1=["id"],_excluded4=["id"];function ownKeys$8(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$8(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$8(Object(_e),!0).forEach(function(et){_defineProperty$9(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$8(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$9(j,$,_e){return($=_toPropertyKey$9($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$9(j){var $=_toPrimitive$9(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$9(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$9(){return _extends$9=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$9.apply(null,arguments)}function _objectWithoutProperties$a(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$a(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$a(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function SetPiePayloadLegend(j){var $=reactExports.useMemo(()=>findAllByType(j.children,Cell),[j.children]),_e=useAppSelector(et=>selectPieLegend(et,j.id,$));return _e==null?null:reactExports.createElement(SetPolarLegendPayload,{legendPayload:_e})}var SetPieTooltipEntrySettings=reactExports.memo(j=>{var{dataKey:$,nameKey:_e,sectors:et,stroke:tt,strokeWidth:nt,fill:rt,name:it,hide:st,tooltipType:at}=j,ot={dataDefinedOnItem:et.map(ct=>ct.tooltipPayload),positions:et.map(ct=>ct.tooltipPosition),settings:{stroke:tt,strokeWidth:nt,fill:rt,dataKey:$,nameKey:_e,name:getTooltipNameProp(it,$),hide:st,type:at,color:rt,unit:""}};return reactExports.createElement(SetTooltipEntrySettings,{tooltipEntrySettings:ot})}),getTextAnchor=(j,$)=>j>$?"start":j<$?"end":"middle",getOuterRadius=(j,$,_e)=>getPercentValue(typeof $=="function"?$(j):$,_e,_e*.8),parseCoordinateOfPie=(j,$,_e)=>{var{top:et,left:tt,width:nt,height:rt}=$,it=getMaxRadius(nt,rt),st=tt+getPercentValue(j.cx,nt,nt/2),at=et+getPercentValue(j.cy,rt,rt/2),ot=getPercentValue(j.innerRadius,it,0),ct=getOuterRadius(_e,j.outerRadius,it),lt=j.maxRadius||Math.sqrt(nt*nt+rt*rt)/2;return{cx:st,cy:at,innerRadius:ot,outerRadius:ct,maxRadius:lt}},parseDeltaAngle=(j,$)=>{var _e=mathSign($-j),et=Math.min(Math.abs($-j),360);return _e*et};function getClassNamePropertyIfExists(j){return j&&typeof j=="object"&&"className"in j&&typeof j.className=="string"?j.className:""}var renderLabelLineItem=(j,$)=>{if(reactExports.isValidElement(j))return reactExports.cloneElement(j,$);if(typeof j=="function")return j($);var _e=clsx("recharts-pie-label-line",typeof j!="boolean"?j.className:""),{key:et}=$,tt=_objectWithoutProperties$a($,_excluded$a);return reactExports.createElement(Curve,_extends$9({},tt,{type:"linear",className:_e}))},renderLabelItem=(j,$,_e)=>{if(reactExports.isValidElement(j))return reactExports.cloneElement(j,$);var et=_e;if(typeof j=="function"&&(et=j($),reactExports.isValidElement(et)))return et;var tt=clsx("recharts-pie-label-text",getClassNamePropertyIfExists(j));return reactExports.createElement(Text,_extends$9({},$,{alignmentBaseline:"middle",className:tt}),et)};function PieLabels(j){var{sectors:$,props:_e,showLabels:et}=j,{label:tt,labelLine:nt,dataKey:rt}=_e;if(!et||!tt||!$)return null;var it=svgPropertiesNoEvents(_e),st=svgPropertiesNoEventsFromUnknown(tt),at=svgPropertiesNoEventsFromUnknown(nt),ot=typeof tt=="object"&&"offsetRadius"in tt&&typeof tt.offsetRadius=="number"&&tt.offsetRadius||20,ct=$.map((lt,ut)=>{var pt=(lt.startAngle+lt.endAngle)/2,dt=polarToCartesian(lt.cx,lt.cy,lt.outerRadius+ot,pt),ht=_objectSpread$8(_objectSpread$8(_objectSpread$8(_objectSpread$8({},it),lt),{},{stroke:"none"},st),{},{index:ut,textAnchor:getTextAnchor(dt.x,lt.cx)},dt),ft=_objectSpread$8(_objectSpread$8(_objectSpread$8(_objectSpread$8({},it),lt),{},{fill:"none",stroke:lt.fill},at),{},{index:ut,points:[polarToCartesian(lt.cx,lt.cy,lt.outerRadius,pt),dt],key:"line"});return reactExports.createElement(ZIndexLayer,{zIndex:DefaultZIndexes.label,key:"label-".concat(lt.startAngle,"-").concat(lt.endAngle,"-").concat(lt.midAngle,"-").concat(ut)},reactExports.createElement(Layer,null,nt&&renderLabelLineItem(nt,ft),renderLabelItem(tt,ht,getValueByDataKey(lt,rt))))});return reactExports.createElement(Layer,{className:"recharts-pie-labels"},ct)}function PieLabelList(j){var{sectors:$,props:_e,showLabels:et}=j,{label:tt}=_e;return typeof tt=="object"&&tt!=null&&"position"in tt?reactExports.createElement(LabelListFromLabelProp,{label:tt}):reactExports.createElement(PieLabels,{sectors:$,props:_e,showLabels:et})}function PieSectors(j){var{sectors:$,activeShape:_e,inactiveShape:et,allOtherPieProps:tt,shape:nt,id:rt}=j,it=useAppSelector(selectActiveTooltipIndex),st=useAppSelector(selectActiveTooltipDataKey),at=useAppSelector(selectActiveTooltipGraphicalItemId),{onMouseEnter:ot,onClick:ct,onMouseLeave:lt}=tt,ut=_objectWithoutProperties$a(tt,_excluded2$4),pt=useMouseEnterItemDispatch(ot,tt.dataKey,rt),dt=useMouseLeaveItemDispatch(lt),ht=useMouseClickItemDispatch(ct,tt.dataKey,rt);return $==null||$.length===0?null:reactExports.createElement(reactExports.Fragment,null,$.map((ft,mt)=>{if((ft==null?void 0:ft.startAngle)===0&&(ft==null?void 0:ft.endAngle)===0&&$.length!==1)return null;var gt=at==null||at===rt,yt=String(mt)===it&&(st==null||tt.dataKey===st)&&gt,vt=it?et:null,xt=_e&&yt?_e:vt,St=_objectSpread$8(_objectSpread$8({},ft),{},{stroke:ft.stroke,tabIndex:-1,[DATA_ITEM_INDEX_ATTRIBUTE_NAME]:mt,[DATA_ITEM_DATAKEY_ATTRIBUTE_NAME]:tt.dataKey});return reactExports.createElement(Layer,_extends$9({key:"sector-".concat(ft==null?void 0:ft.startAngle,"-").concat(ft==null?void 0:ft.endAngle,"-").concat(ft.midAngle,"-").concat(mt),tabIndex:-1,className:"recharts-pie-sector"},adaptEventsOfChild(ut,ft,mt),{onMouseEnter:pt(ft,mt),onMouseLeave:dt(ft,mt),onClick:ht(ft,mt)}),reactExports.createElement(Shape,_extends$9({option:nt??xt,index:mt,shapeType:"sector",isActive:yt},St)))}))}function computePieSectors(j){var $,{pieSettings:_e,displayedData:et,cells:tt,offset:nt}=j,{cornerRadius:rt,startAngle:it,endAngle:st,dataKey:at,nameKey:ot,tooltipType:ct}=_e,lt=Math.abs(_e.minAngle),ut=parseDeltaAngle(it,st),pt=Math.abs(ut),dt=et.length<=1?0:($=_e.paddingAngle)!==null&&$!==void 0?$:0,ht=et.filter(xt=>getValueByDataKey(xt,at,0)!==0).length,ft=(pt>=360?ht:ht-1)*dt,mt=pt-ht*lt-ft,gt=et.reduce((xt,St)=>{var Et=getValueByDataKey(St,at,0);return xt+(isNumber(Et)?Et:0)},0),yt;if(gt>0){var vt;yt=et.map((xt,St)=>{var Et=getValueByDataKey(xt,at,0),wt=getValueByDataKey(xt,ot,St),Tt=parseCoordinateOfPie(_e,nt,xt),Ct=(isNumber(Et)?Et:0)/gt,Rt,jt=_objectSpread$8(_objectSpread$8({},xt),tt&&tt[St]&&tt[St].props);St?Rt=vt.endAngle+mathSign(ut)*dt*(Et!==0?1:0):Rt=it;var Ot=Rt+mathSign(ut)*((Et!==0?lt:0)+Ct*mt),$t=(Rt+Ot)/2,Kt=(Tt.innerRadius+Tt.outerRadius)/2,Lt=[{name:wt,value:Et,payload:jt,dataKey:at,type:ct}],Nt=polarToCartesian(Tt.cx,Tt.cy,Kt,$t);return vt=_objectSpread$8(_objectSpread$8(_objectSpread$8(_objectSpread$8({},_e.presentationProps),{},{percent:Ct,cornerRadius:typeof rt=="string"?parseFloat(rt):rt,name:wt,tooltipPayload:Lt,midAngle:$t,middleRadius:Kt,tooltipPosition:Nt},jt),Tt),{},{value:Et,dataKey:at,startAngle:Rt,endAngle:Ot,payload:jt,paddingAngle:mathSign(ut)*dt}),vt})}return yt}function PieLabelListProvider(j){var{showLabels:$,sectors:_e,children:et}=j,tt=reactExports.useMemo(()=>!$||!_e?[]:_e.map(nt=>({value:nt.value,payload:nt.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:nt.cx,cy:nt.cy,innerRadius:nt.innerRadius,outerRadius:nt.outerRadius,startAngle:nt.startAngle,endAngle:nt.endAngle,clockWise:!1},fill:nt.fill})),[_e,$]);return reactExports.createElement(PolarLabelListContextProvider,{value:$?tt:void 0},et)}function SectorsWithAnimation(j){var{props:$,previousSectorsRef:_e,id:et}=j,{sectors:tt,isAnimationActive:nt,animationBegin:rt,animationDuration:it,animationEasing:st,activeShape:at,inactiveShape:ot,onAnimationStart:ct,onAnimationEnd:lt}=$,ut=useAnimationId($,"recharts-pie-"),pt=_e.current,[dt,ht]=reactExports.useState(!1),ft=reactExports.useCallback(()=>{typeof lt=="function"&&lt(),ht(!1)},[lt]),mt=reactExports.useCallback(()=>{typeof ct=="function"&&ct(),ht(!0)},[ct]);return reactExports.createElement(PieLabelListProvider,{showLabels:!dt,sectors:tt},reactExports.createElement(JavascriptAnimate,{animationId:ut,begin:rt,duration:it,isActive:nt,easing:st,onAnimationStart:mt,onAnimationEnd:ft,key:ut},gt=>{var yt=[],vt=tt&&tt[0],xt=vt==null?void 0:vt.startAngle;return tt==null||tt.forEach((St,Et)=>{var wt=pt&&pt[Et],Tt=Et>0?get$2(St,"paddingAngle",0):0;if(wt){var Ct=interpolate$1(wt.endAngle-wt.startAngle,St.endAngle-St.startAngle,gt),Rt=_objectSpread$8(_objectSpread$8({},St),{},{startAngle:xt+Tt,endAngle:xt+Ct+Tt});yt.push(Rt),xt=Rt.endAngle}else{var{endAngle:jt,startAngle:Ot}=St,$t=interpolate$1(0,jt-Ot,gt),Kt=_objectSpread$8(_objectSpread$8({},St),{},{startAngle:xt+Tt,endAngle:xt+$t+Tt});yt.push(Kt),xt=Kt.endAngle}}),_e.current=yt,reactExports.createElement(Layer,null,reactExports.createElement(PieSectors,{sectors:yt,activeShape:at,inactiveShape:ot,allOtherPieProps:$,shape:$.shape,id:et}))}),reactExports.createElement(PieLabelList,{showLabels:!dt,sectors:tt,props:$}),$.children)}var defaultPieProps={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:DefaultZIndexes.area};function PieImpl(j){var{id:$}=j,_e=_objectWithoutProperties$a(j,_excluded3$1),{hide:et,className:tt,rootTabIndex:nt}=j,rt=reactExports.useMemo(()=>findAllByType(j.children,Cell),[j.children]),it=useAppSelector(ot=>selectPieSectors(ot,$,rt)),st=reactExports.useRef(null),at=clsx("recharts-pie",tt);return et||it==null?(st.current=null,reactExports.createElement(Layer,{tabIndex:nt,className:at})):reactExports.createElement(ZIndexLayer,{zIndex:j.zIndex},reactExports.createElement(SetPieTooltipEntrySettings,{dataKey:j.dataKey,nameKey:j.nameKey,sectors:it,stroke:j.stroke,strokeWidth:j.strokeWidth,fill:j.fill,name:j.name,hide:j.hide,tooltipType:j.tooltipType}),reactExports.createElement(Layer,{tabIndex:nt,className:at},reactExports.createElement(SectorsWithAnimation,{props:_objectSpread$8(_objectSpread$8({},_e),{},{sectors:it}),previousSectorsRef:st,id:$})))}function Pie(j){var $=resolveDefaultProps(j,defaultPieProps),{id:_e}=$,et=_objectWithoutProperties$a($,_excluded4),tt=svgPropertiesNoEvents(et);return reactExports.createElement(RegisterGraphicalItemId,{id:_e,type:"pie"},nt=>reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetPolarGraphicalItem,{type:"pie",id:nt,data:et.data,dataKey:et.dataKey,hide:et.hide,angleAxisId:0,radiusAxisId:0,name:et.name,nameKey:et.nameKey,tooltipType:et.tooltipType,legendType:et.legendType,fill:et.fill,cx:et.cx,cy:et.cy,startAngle:et.startAngle,endAngle:et.endAngle,paddingAngle:et.paddingAngle,minAngle:et.minAngle,innerRadius:et.innerRadius,outerRadius:et.outerRadius,cornerRadius:et.cornerRadius,presentationProps:tt,maxRadius:$.maxRadius}),reactExports.createElement(SetPiePayloadLegend,_extends$9({},et,{id:nt})),reactExports.createElement(PieImpl,_extends$9({},et,{id:nt}))))}Pie.displayName="Pie";var _excluded$9=["points"];function ownKeys$7(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$7(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$7(Object(_e),!0).forEach(function(et){_defineProperty$8(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$7(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$8(j,$,_e){return($=_toPropertyKey$8($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$8(j){var $=_toPrimitive$8(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$8(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$8(){return _extends$8=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$8.apply(null,arguments)}function _objectWithoutProperties$9(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$9(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$9(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function DotItem(j){var{option:$,dotProps:_e,className:et}=j;if(reactExports.isValidElement($))return reactExports.cloneElement($,_e);if(typeof $=="function")return $(_e);var tt=clsx(et,typeof $!="boolean"?$.className:""),nt=_e??{},{points:rt}=nt,it=_objectWithoutProperties$9(nt,_excluded$9);return reactExports.createElement(Dot,_extends$8({},it,{className:tt}))}function shouldRenderDots(j,$){return j==null?!1:$?!0:j.length===1}function Dots(j){var{points:$,dot:_e,className:et,dotClassName:tt,dataKey:nt,baseProps:rt,needClip:it,clipPathId:st,zIndex:at=DefaultZIndexes.scatter}=j;if(!shouldRenderDots($,_e))return null;var ot=isClipDot(_e),ct=svgPropertiesAndEventsFromUnknown(_e),lt=$.map((pt,dt)=>{var ht,ft,mt=_objectSpread$7(_objectSpread$7(_objectSpread$7({r:3},rt),ct),{},{index:dt,cx:(ht=pt.x)!==null&&ht!==void 0?ht:void 0,cy:(ft=pt.y)!==null&&ft!==void 0?ft:void 0,dataKey:nt,value:pt.value,payload:pt.payload,points:$});return reactExports.createElement(DotItem,{key:"dot-".concat(dt),option:_e,dotProps:mt,className:tt})}),ut={};return it&&st!=null&&(ut.clipPath="url(#clipPath-".concat(ot?"":"dots-").concat(st,")")),reactExports.createElement(ZIndexLayer,{zIndex:at},reactExports.createElement(Layer,_extends$8({className:et},ut),lt))}function ownKeys$6(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$6(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$6(Object(_e),!0).forEach(function(et){_defineProperty$7(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$6(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$7(j,$,_e){return($=_toPropertyKey$7($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$7(j){var $=_toPrimitive$7(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$7(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var initialState$4={xAxis:{},yAxis:{},zAxis:{}},cartesianAxisSlice=createSlice({name:"cartesianAxis",initialState:initialState$4,reducers:{addXAxis:{reducer(j,$){j.xAxis[$.payload.id]=$.payload},prepare:prepareAutoBatched()},replaceXAxis:{reducer(j,$){var{prev:_e,next:et}=$.payload;j.xAxis[_e.id]!==void 0&&(_e.id!==et.id&&delete j.xAxis[_e.id],j.xAxis[et.id]=et)},prepare:prepareAutoBatched()},removeXAxis:{reducer(j,$){delete j.xAxis[$.payload.id]},prepare:prepareAutoBatched()},addYAxis:{reducer(j,$){j.yAxis[$.payload.id]=$.payload},prepare:prepareAutoBatched()},replaceYAxis:{reducer(j,$){var{prev:_e,next:et}=$.payload;j.yAxis[_e.id]!==void 0&&(_e.id!==et.id&&delete j.yAxis[_e.id],j.yAxis[et.id]=et)},prepare:prepareAutoBatched()},removeYAxis:{reducer(j,$){delete j.yAxis[$.payload.id]},prepare:prepareAutoBatched()},addZAxis:{reducer(j,$){j.zAxis[$.payload.id]=$.payload},prepare:prepareAutoBatched()},replaceZAxis:{reducer(j,$){var{prev:_e,next:et}=$.payload;j.zAxis[_e.id]!==void 0&&(_e.id!==et.id&&delete j.zAxis[_e.id],j.zAxis[et.id]=et)},prepare:prepareAutoBatched()},removeZAxis:{reducer(j,$){delete j.zAxis[$.payload.id]},prepare:prepareAutoBatched()},updateYAxisWidth(j,$){var{id:_e,width:et}=$.payload,tt=j.yAxis[_e];if(tt){var nt=tt.widthHistory||[];if(nt.length===3&&nt[0]===nt[2]&&et===nt[1]&&et!==tt.width&&Math.abs(et-nt[0])<=1)return;var rt=[...nt,et].slice(-3);j.yAxis[_e]=_objectSpread$6(_objectSpread$6({},j.yAxis[_e]),{},{width:et,widthHistory:rt})}}}}),{addXAxis,replaceXAxis,removeXAxis,addYAxis,replaceYAxis,removeYAxis,addZAxis,replaceZAxis,removeZAxis,updateYAxisWidth}=cartesianAxisSlice.actions,cartesianAxisReducer=cartesianAxisSlice.reducer,selectChartOffset=createSelector([selectChartOffsetInternal],j=>({top:j.top,bottom:j.bottom,left:j.left,right:j.right})),selectPlotArea=createSelector([selectChartOffset,selectChartWidth,selectChartHeight],(j,$,_e)=>{if(!(!j||$==null||_e==null))return{x:j.left,y:j.top,width:Math.max(0,$-j.left-j.right),height:Math.max(0,_e-j.top-j.bottom)}}),usePlotArea=()=>useAppSelector(selectPlotArea),useActiveTooltipDataPoints=()=>useAppSelector(selectActiveTooltipDataPoints);function ownKeys$5(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$5(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$5(Object(_e),!0).forEach(function(et){_defineProperty$6(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$5(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$6(j,$,_e){return($=_toPropertyKey$6($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$6(j){var $=_toPrimitive$6(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$6(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var ActivePoint=j=>{var{point:$,childIndex:_e,mainColor:et,activeDot:tt,dataKey:nt,clipPath:rt}=j;if(tt===!1||$.x==null||$.y==null)return null;var it={index:_e,dataKey:nt,cx:$.x,cy:$.y,r:4,fill:et??"none",strokeWidth:2,stroke:"#fff",payload:$.payload,value:$.value},st=_objectSpread$5(_objectSpread$5(_objectSpread$5({},it),svgPropertiesNoEventsFromUnknown(tt)),adaptEventHandlers(tt)),at;return reactExports.isValidElement(tt)?at=reactExports.cloneElement(tt,st):typeof tt=="function"?at=tt(st):at=reactExports.createElement(Dot,st),reactExports.createElement(Layer,{className:"recharts-active-dot",clipPath:rt},at)};function ActivePoints(j){var{points:$,mainColor:_e,activeDot:et,itemDataKey:tt,clipPath:nt,zIndex:rt=DefaultZIndexes.activeDot}=j,it=useAppSelector(selectActiveTooltipIndex),st=useActiveTooltipDataPoints();if($==null||st==null)return null;var at=$.find(ot=>st.includes(ot.payload));return isNullish(at)?null:reactExports.createElement(ZIndexLayer,{zIndex:rt},reactExports.createElement(ActivePoint,{point:at,childIndex:Number(it),mainColor:_e,dataKey:tt,activeDot:et,clipPath:nt}))}var initialState$3={},errorBarSlice=createSlice({name:"errorBars",initialState:initialState$3,reducers:{addErrorBar:(j,$)=>{var{itemId:_e,errorBar:et}=$.payload;j[_e]||(j[_e]=[]),j[_e].push(et)},replaceErrorBar:(j,$)=>{var{itemId:_e,prev:et,next:tt}=$.payload;j[_e]&&(j[_e]=j[_e].map(nt=>nt.dataKey===et.dataKey&&nt.direction===et.direction?tt:nt))},removeErrorBar:(j,$)=>{var{itemId:_e,errorBar:et}=$.payload;j[_e]&&(j[_e]=j[_e].filter(tt=>tt.dataKey!==et.dataKey||tt.direction!==et.direction))}}}),{addErrorBar,replaceErrorBar,removeErrorBar}=errorBarSlice.actions,errorBarReducer=errorBarSlice.reducer,_excluded$8=["children"];function _objectWithoutProperties$8(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$8(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$8(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var initialContextState={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},ErrorBarContext=reactExports.createContext(initialContextState);function SetErrorBarContext(j){var{children:$}=j,_e=_objectWithoutProperties$8(j,_excluded$8);return reactExports.createElement(ErrorBarContext.Provider,{value:_e},$)}function useNeedsClip(j,$){var _e,et,tt=useAppSelector(at=>selectXAxisSettings(at,j)),nt=useAppSelector(at=>selectYAxisSettings(at,$)),rt=(_e=tt==null?void 0:tt.allowDataOverflow)!==null&&_e!==void 0?_e:implicitXAxis.allowDataOverflow,it=(et=nt==null?void 0:nt.allowDataOverflow)!==null&&et!==void 0?et:implicitYAxis.allowDataOverflow,st=rt||it;return{needClip:st,needClipX:rt,needClipY:it}}function GraphicalItemClipPath(j){var{xAxisId:$,yAxisId:_e,clipPathId:et}=j,tt=usePlotArea(),{needClipX:nt,needClipY:rt,needClip:it}=useNeedsClip($,_e);if(!it||!tt)return null;var{x:st,y:at,width:ot,height:ct}=tt;return reactExports.createElement("clipPath",{id:"clipPath-".concat(et)},reactExports.createElement("rect",{x:nt?st:st-ot/2,y:rt?at:at-ct/2,width:nt?ot:ot*2,height:rt?ct:ct*2}))}var useSyncExternalStoreWithSelector_production={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports;function is$1(j,$){return j===$&&(j!==0||1/j===1/$)||j!==j&&$!==$}var objectIs=typeof Object.is=="function"?Object.is:is$1,useSyncExternalStore=React.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue=React.useDebugValue;useSyncExternalStoreWithSelector_production.useSyncExternalStoreWithSelector=function(j,$,_e,et,tt){var nt=useRef(null);if(nt.current===null){var rt={hasValue:!1,value:null};nt.current=rt}else rt=nt.current;nt=useMemo(function(){function st(ut){if(!at){if(at=!0,ot=ut,ut=et(ut),tt!==void 0&&rt.hasValue){var pt=rt.value;if(tt(pt,ut))return ct=pt}return ct=ut}if(pt=ct,objectIs(ot,ut))return pt;var dt=et(ut);return tt!==void 0&&tt(pt,dt)?(ot=ut,pt):(ot=ut,ct=dt)}var at=!1,ot,ct,lt=_e===void 0?null:_e;return[function(){return st($())},lt===null?void 0:function(){return st(lt())}]},[$,_e,et,tt]);var it=useSyncExternalStore(j,nt[0],nt[1]);return useEffect(function(){rt.hasValue=!0,rt.value=it},[it]),useDebugValue(it),it};function defaultNoopBatch(j){j()}function createListenerCollection(){let j=null,$=null;return{clear(){j=null,$=null},notify(){defaultNoopBatch(()=>{let _e=j;for(;_e;)_e.callback(),_e=_e.next})},get(){const _e=[];let et=j;for(;et;)_e.push(et),et=et.next;return _e},subscribe(_e){let et=!0;const tt=$={callback:_e,next:null,prev:$};return tt.prev?tt.prev.next=tt:j=tt,function(){!et||j===null||(et=!1,tt.next?tt.next.prev=tt.prev:$=tt.prev,tt.prev?tt.prev.next=tt.next:j=tt.next)}}}}var nullListeners={notify(){},get:()=>[]};function createSubscription(j,$){let _e,et=nullListeners,tt=0,nt=!1;function rt(dt){ot();const ht=et.subscribe(dt);let ft=!1;return()=>{ft||(ft=!0,ht(),ct())}}function it(){et.notify()}function st(){pt.onStateChange&&pt.onStateChange()}function at(){return nt}function ot(){tt++,_e||(_e=j.subscribe(st),et=createListenerCollection())}function ct(){tt--,_e&&tt===0&&(_e(),_e=void 0,et.clear(),et=nullListeners)}function lt(){nt||(nt=!0,ot())}function ut(){nt&&(nt=!1,ct())}const pt={addNestedSub:rt,notifyNestedSubs:it,handleChangeWrapper:st,isSubscribed:at,trySubscribe:lt,tryUnsubscribe:ut,getListeners:()=>et};return pt}var canUseDOM=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isDOM=canUseDOM(),isRunningInReactNative=()=>typeof navigator<"u"&&navigator.product==="ReactNative",isReactNative=isRunningInReactNative(),getUseIsomorphicLayoutEffect=()=>isDOM||isReactNative?reactExports.useLayoutEffect:reactExports.useEffect,useIsomorphicLayoutEffect=getUseIsomorphicLayoutEffect();function is(j,$){return j===$?j!==0||$!==0||1/j===1/$:j!==j&&$!==$}function shallowEqual(j,$){if(is(j,$))return!0;if(typeof j!="object"||j===null||typeof $!="object"||$===null)return!1;const _e=Object.keys(j),et=Object.keys($);if(_e.length!==et.length)return!1;for(let tt=0;tt<_e.length;tt++)if(!Object.prototype.hasOwnProperty.call($,_e[tt])||!is(j[_e[tt]],$[_e[tt]]))return!1;return!0}var ContextKey=Symbol.for("react-redux-context"),gT=typeof globalThis<"u"?globalThis:{};function getContext(){if(!reactExports.createContext)return{};const j=gT[ContextKey]??(gT[ContextKey]=new Map);let $=j.get(reactExports.createContext);return $||($=reactExports.createContext(null),j.set(reactExports.createContext,$)),$}var ReactReduxContext=getContext();function Provider(j){const{children:$,context:_e,serverState:et,store:tt}=j,nt=reactExports.useMemo(()=>{const st=createSubscription(tt);return{store:tt,subscription:st,getServerState:et?()=>et:void 0}},[tt,et]),rt=reactExports.useMemo(()=>tt.getState(),[tt]);useIsomorphicLayoutEffect(()=>{const{subscription:st}=nt;return st.onStateChange=st.notifyNestedSubs,st.trySubscribe(),rt!==tt.getState()&&st.notifyNestedSubs(),()=>{st.tryUnsubscribe(),st.onStateChange=void 0}},[nt,rt]);const it=_e||ReactReduxContext;return reactExports.createElement(it.Provider,{value:nt},$)}var Provider_default=Provider,propsToShallowCompare=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle"]);function sameValueZero(j,$){return j==null&&$==null?!0:typeof j=="number"&&typeof $=="number"?j===$||j!==j&&$!==$:j===$}function propsAreEqual(j,$){var _e=new Set([...Object.keys(j),...Object.keys($)]);for(var et of _e)if(propsToShallowCompare.has(et)){if(j[et]==null&&$[et]==null)continue;if(!shallowEqual(j[et],$[et]))return!1}else if(!sameValueZero(j[et],$[et]))return!1;return!0}var ChartDataContextProvider=j=>{var{chartData:$}=j,_e=useAppDispatch(),et=useIsPanorama();return reactExports.useEffect(()=>et?()=>{}:(_e(setChartData($)),()=>{_e(setChartData(void 0))}),[$,_e,et]),null},initialState$2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},brushSlice=createSlice({name:"brush",initialState:initialState$2,reducers:{setBrushSettings(j,$){return $.payload==null?initialState$2:$.payload}}}),{setBrushSettings}=brushSlice.actions,brushReducer=brushSlice.reducer;function _defineProperty$5(j,$,_e){return($=_toPropertyKey$5($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$5(j){var $=_toPrimitive$5(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$5(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}class ScaleHelper{static create($){return new ScaleHelper($)}constructor($){this.scale=$}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply($){var{bandAware:_e,position:et}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if($!==void 0){if(et)switch(et){case"start":return this.scale($);case"middle":{var tt=this.bandwidth?this.bandwidth()/2:0;return this.scale($)+tt}case"end":{var nt=this.bandwidth?this.bandwidth():0;return this.scale($)+nt}default:return this.scale($)}if(_e){var rt=this.bandwidth?this.bandwidth()/2:0;return this.scale($)+rt}return this.scale($)}}isInRange($){var _e=this.range(),et=_e[0],tt=_e[_e.length-1];return et<=tt?$>=et&&$<=tt:$>=tt&&$<=et}}_defineProperty$5(ScaleHelper,"EPS",1e-4);function normalizeAngle(j){return(j%180+180)%180}var getAngledRectangleWidth=function j($){var{width:_e,height:et}=$,tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,nt=normalizeAngle(tt),rt=nt*Math.PI/180,it=Math.atan(et/_e),st=rt>it&&rt<Math.PI-it?et/Math.sin(rt):_e/Math.cos(rt);return Math.abs(st)},initialState$1={dots:[],areas:[],lines:[]},referenceElementsSlice=createSlice({name:"referenceElements",initialState:initialState$1,reducers:{addDot:(j,$)=>{j.dots.push($.payload)},removeDot:(j,$)=>{var _e=current$1(j).dots.findIndex(et=>et===$.payload);_e!==-1&&j.dots.splice(_e,1)},addArea:(j,$)=>{j.areas.push($.payload)},removeArea:(j,$)=>{var _e=current$1(j).areas.findIndex(et=>et===$.payload);_e!==-1&&j.areas.splice(_e,1)},addLine:(j,$)=>{j.lines.push($.payload)},removeLine:(j,$)=>{var _e=current$1(j).lines.findIndex(et=>et===$.payload);_e!==-1&&j.lines.splice(_e,1)}}}),{addDot,removeDot,addArea,removeArea,addLine,removeLine}=referenceElementsSlice.actions,referenceElementsReducer=referenceElementsSlice.reducer,ClipPathIdContext=reactExports.createContext(void 0),ClipPathProvider=j=>{var{children:$}=j,[_e]=reactExports.useState("".concat(uniqueId("recharts"),"-clip")),et=usePlotArea();if(et==null)return null;var{x:tt,y:nt,width:rt,height:it}=et;return reactExports.createElement(ClipPathIdContext.Provider,{value:_e},reactExports.createElement("defs",null,reactExports.createElement("clipPath",{id:_e},reactExports.createElement("rect",{x:tt,y:nt,height:it,width:rt}))),$)};function getEveryNthWithCondition(j,$){if($<1)return[];if($===1)return j;for(var _e=[],et=0;et<j.length;et+=$)_e.push(j[et]);return _e}function getAngledTickWidth(j,$,_e){var et={width:j.width+$.width,height:j.height+$.height};return getAngledRectangleWidth(et,_e)}function getTickBoundaries(j,$,_e){var et=_e==="width",{x:tt,y:nt,width:rt,height:it}=j;return $===1?{start:et?tt:nt,end:et?tt+rt:nt+it}:{start:et?tt+rt:nt+it,end:et?tt:nt}}function isVisible(j,$,_e,et,tt){if(j*$<j*et||j*$>j*tt)return!1;var nt=_e();return j*($-j*nt/2-et)>=0&&j*($+j*nt/2-tt)<=0}function getNumberIntervalTicks(j,$){return getEveryNthWithCondition(j,$+1)}function getEquidistantTicks(j,$,_e,et,tt){for(var nt=(et||[]).slice(),{start:rt,end:it}=$,st=0,at=1,ot=rt,ct=function(){var pt=et==null?void 0:et[st];if(pt===void 0)return{v:getEveryNthWithCondition(et,at)};var dt=st,ht,ft=()=>(ht===void 0&&(ht=_e(pt,dt)),ht),mt=pt.coordinate,gt=st===0||isVisible(j,mt,ft,ot,it);gt||(st=0,ot=rt,at+=1),gt&&(ot=mt+j*(ft()/2+tt),st+=at)},lt;at<=nt.length;)if(lt=ct(),lt)return lt.v;return[]}function ownKeys$4(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$4(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$4(Object(_e),!0).forEach(function(et){_defineProperty$4(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$4(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$4(j,$,_e){return($=_toPropertyKey$4($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$4(j){var $=_toPrimitive$4(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$4(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function getTicksEnd(j,$,_e,et,tt){for(var nt=(et||[]).slice(),rt=nt.length,{start:it}=$,{end:st}=$,at=function(lt){var ut=nt[lt],pt,dt=()=>(pt===void 0&&(pt=_e(ut,lt)),pt);if(lt===rt-1){var ht=j*(ut.coordinate+j*dt()/2-st);nt[lt]=ut=_objectSpread$4(_objectSpread$4({},ut),{},{tickCoord:ht>0?ut.coordinate-ht*j:ut.coordinate})}else nt[lt]=ut=_objectSpread$4(_objectSpread$4({},ut),{},{tickCoord:ut.coordinate});if(ut.tickCoord!=null){var ft=isVisible(j,ut.tickCoord,dt,it,st);ft&&(st=ut.tickCoord-j*(dt()/2+tt),nt[lt]=_objectSpread$4(_objectSpread$4({},ut),{},{isShow:!0}))}},ot=rt-1;ot>=0;ot--)at(ot);return nt}function getTicksStart(j,$,_e,et,tt,nt){var rt=(et||[]).slice(),it=rt.length,{start:st,end:at}=$;if(nt){var ot=et[it-1],ct=_e(ot,it-1),lt=j*(ot.coordinate+j*ct/2-at);if(rt[it-1]=ot=_objectSpread$4(_objectSpread$4({},ot),{},{tickCoord:lt>0?ot.coordinate-lt*j:ot.coordinate}),ot.tickCoord!=null){var ut=isVisible(j,ot.tickCoord,()=>ct,st,at);ut&&(at=ot.tickCoord-j*(ct/2+tt),rt[it-1]=_objectSpread$4(_objectSpread$4({},ot),{},{isShow:!0}))}}for(var pt=nt?it-1:it,dt=function(mt){var gt=rt[mt],yt,vt=()=>(yt===void 0&&(yt=_e(gt,mt)),yt);if(mt===0){var xt=j*(gt.coordinate-j*vt()/2-st);rt[mt]=gt=_objectSpread$4(_objectSpread$4({},gt),{},{tickCoord:xt<0?gt.coordinate-xt*j:gt.coordinate})}else rt[mt]=gt=_objectSpread$4(_objectSpread$4({},gt),{},{tickCoord:gt.coordinate});if(gt.tickCoord!=null){var St=isVisible(j,gt.tickCoord,vt,st,at);St&&(st=gt.tickCoord+j*(vt()/2+tt),rt[mt]=_objectSpread$4(_objectSpread$4({},gt),{},{isShow:!0}))}},ht=0;ht<pt;ht++)dt(ht);return rt}function getTicks(j,$,_e){var{tick:et,ticks:tt,viewBox:nt,minTickGap:rt,orientation:it,interval:st,tickFormatter:at,unit:ot,angle:ct}=j;if(!tt||!tt.length||!et)return[];if(isNumber(st)||Global.isSsr){var lt;return(lt=getNumberIntervalTicks(tt,isNumber(st)?st:0))!==null&&lt!==void 0?lt:[]}var ut=[],pt=it==="top"||it==="bottom"?"width":"height",dt=ot&&pt==="width"?getStringSize(ot,{fontSize:$,letterSpacing:_e}):{width:0,height:0},ht=(gt,yt)=>{var vt=typeof at=="function"?at(gt.value,yt):gt.value;return pt==="width"?getAngledTickWidth(getStringSize(vt,{fontSize:$,letterSpacing:_e}),dt,ct):getStringSize(vt,{fontSize:$,letterSpacing:_e})[pt]},ft=tt.length>=2?mathSign(tt[1].coordinate-tt[0].coordinate):1,mt=getTickBoundaries(nt,ft,pt);return st==="equidistantPreserveStart"?getEquidistantTicks(ft,mt,ht,tt,rt):(st==="preserveStart"||st==="preserveStartEnd"?ut=getTicksStart(ft,mt,ht,tt,rt,st==="preserveStartEnd"):ut=getTicksEnd(ft,mt,ht,tt,rt),ut.filter(gt=>gt.isShow))}var getCalculatedYAxisWidth=j=>{var{ticks:$,label:_e,labelGapWithTick:et=5,tickSize:tt=0,tickMargin:nt=0}=j,rt=0;if($){Array.from($).forEach(ot=>{if(ot){var ct=ot.getBoundingClientRect();ct.width>rt&&(rt=ct.width)}});var it=_e?_e.getBoundingClientRect().width:0,st=tt+nt,at=rt+st+it+(_e?et:0);return Math.round(at)}return 0},_excluded$7=["axisLine","width","height","className","hide","ticks","axisType"];function _objectWithoutProperties$7(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$7(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$7(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function _extends$7(){return _extends$7=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$7.apply(null,arguments)}function ownKeys$3(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$3(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$3(Object(_e),!0).forEach(function(et){_defineProperty$3(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$3(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$3(j,$,_e){return($=_toPropertyKey$3($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$3(j){var $=_toPrimitive$3(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$3(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var defaultCartesianAxisProps={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:DefaultZIndexes.axis};function AxisLine(j){var{x:$,y:_e,width:et,height:tt,orientation:nt,mirror:rt,axisLine:it,otherSvgProps:st}=j;if(!it)return null;var at=_objectSpread$3(_objectSpread$3(_objectSpread$3({},st),svgPropertiesNoEvents(it)),{},{fill:"none"});if(nt==="top"||nt==="bottom"){var ot=+(nt==="top"&&!rt||nt==="bottom"&&rt);at=_objectSpread$3(_objectSpread$3({},at),{},{x1:$,y1:_e+ot*tt,x2:$+et,y2:_e+ot*tt})}else{var ct=+(nt==="left"&&!rt||nt==="right"&&rt);at=_objectSpread$3(_objectSpread$3({},at),{},{x1:$+ct*et,y1:_e,x2:$+ct*et,y2:_e+tt})}return reactExports.createElement("line",_extends$7({},at,{className:clsx("recharts-cartesian-axis-line",get$2(it,"className"))}))}function getTickLineCoord(j,$,_e,et,tt,nt,rt,it,st){var at,ot,ct,lt,ut,pt,dt=it?-1:1,ht=j.tickSize||rt,ft=isNumber(j.tickCoord)?j.tickCoord:j.coordinate;switch(nt){case"top":at=ot=j.coordinate,lt=_e+ +!it*tt,ct=lt-dt*ht,pt=ct-dt*st,ut=ft;break;case"left":ct=lt=j.coordinate,ot=$+ +!it*et,at=ot-dt*ht,ut=at-dt*st,pt=ft;break;case"right":ct=lt=j.coordinate,ot=$+ +it*et,at=ot+dt*ht,ut=at+dt*st,pt=ft;break;default:at=ot=j.coordinate,lt=_e+ +it*tt,ct=lt+dt*ht,pt=ct+dt*st,ut=ft;break}return{line:{x1:at,y1:ct,x2:ot,y2:lt},tick:{x:ut,y:pt}}}function getTickTextAnchor(j,$){switch(j){case"left":return $?"start":"end";case"right":return $?"end":"start";default:return"middle"}}function getTickVerticalAnchor(j,$){switch(j){case"left":case"right":return"middle";case"top":return $?"start":"end";default:return $?"end":"start"}}function TickItem(j){var{option:$,tickProps:_e,value:et}=j,tt,nt=clsx(_e.className,"recharts-cartesian-axis-tick-value");if(reactExports.isValidElement($))tt=reactExports.cloneElement($,_objectSpread$3(_objectSpread$3({},_e),{},{className:nt}));else if(typeof $=="function")tt=$(_objectSpread$3(_objectSpread$3({},_e),{},{className:nt}));else{var rt="recharts-cartesian-axis-tick-value";typeof $!="boolean"&&(rt=clsx(rt,$==null?void 0:$.className)),tt=reactExports.createElement(Text,_extends$7({},_e,{className:rt}),et)}return tt}var Ticks=reactExports.forwardRef((j,$)=>{var{ticks:_e=[],tick:et,tickLine:tt,stroke:nt,tickFormatter:rt,unit:it,padding:st,tickTextProps:at,orientation:ot,mirror:ct,x:lt,y:ut,width:pt,height:dt,tickSize:ht,tickMargin:ft,fontSize:mt,letterSpacing:gt,getTicksConfig:yt,events:vt,axisType:xt}=j,St=getTicks(_objectSpread$3(_objectSpread$3({},yt),{},{ticks:_e}),mt,gt),Et=getTickTextAnchor(ot,ct),wt=getTickVerticalAnchor(ot,ct),Tt=svgPropertiesNoEvents(yt),Ct=svgPropertiesNoEventsFromUnknown(et),Rt={};typeof tt=="object"&&(Rt=tt);var jt=_objectSpread$3(_objectSpread$3({},Tt),{},{fill:"none"},Rt),Ot=St.map(Lt=>_objectSpread$3({entry:Lt},getTickLineCoord(Lt,lt,ut,pt,dt,ot,ht,ct,ft))),$t=Ot.map(Lt=>{var{entry:Nt,line:Bt}=Lt;return reactExports.createElement(Layer,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Nt.value,"-").concat(Nt.coordinate,"-").concat(Nt.tickCoord)},tt&&reactExports.createElement("line",_extends$7({},jt,Bt,{className:clsx("recharts-cartesian-axis-tick-line",get$2(tt,"className"))})))}),Kt=Ot.map((Lt,Nt)=>{var{entry:Bt,tick:kt}=Lt,rn=_objectSpread$3(_objectSpread$3(_objectSpread$3(_objectSpread$3({textAnchor:Et,verticalAnchor:wt},Tt),{},{stroke:"none",fill:nt},Ct),kt),{},{index:Nt,payload:Bt,visibleTicksCount:St.length,tickFormatter:rt,padding:st},at);return reactExports.createElement(Layer,_extends$7({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(Bt.value,"-").concat(Bt.coordinate,"-").concat(Bt.tickCoord)},adaptEventsOfChild(vt,Bt,Nt)),et&&reactExports.createElement(TickItem,{option:et,tickProps:rn,value:"".concat(typeof rt=="function"?rt(Bt.value,Nt):Bt.value).concat(it||"")}))});return reactExports.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(xt,"-ticks")},Kt.length>0&&reactExports.createElement(ZIndexLayer,{zIndex:DefaultZIndexes.label},reactExports.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(xt,"-tick-labels"),ref:$},Kt)),$t.length>0&&reactExports.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(xt,"-tick-lines")},$t))}),CartesianAxisComponent=reactExports.forwardRef((j,$)=>{var{axisLine:_e,width:et,height:tt,className:nt,hide:rt,ticks:it,axisType:st}=j,at=_objectWithoutProperties$7(j,_excluded$7),[ot,ct]=reactExports.useState(""),[lt,ut]=reactExports.useState(""),pt=reactExports.useRef(null);reactExports.useImperativeHandle($,()=>({getCalculatedWidth:()=>{var ht;return getCalculatedYAxisWidth({ticks:pt.current,label:(ht=j.labelRef)===null||ht===void 0?void 0:ht.current,labelGapWithTick:5,tickSize:j.tickSize,tickMargin:j.tickMargin})}}));var dt=reactExports.useCallback(ht=>{if(ht){var ft=ht.getElementsByClassName("recharts-cartesian-axis-tick-value");pt.current=ft;var mt=ft[0];if(mt){var gt=window.getComputedStyle(mt),yt=gt.fontSize,vt=gt.letterSpacing;(yt!==ot||vt!==lt)&&(ct(yt),ut(vt))}}},[ot,lt]);return rt||et!=null&&et<=0||tt!=null&&tt<=0?null:reactExports.createElement(ZIndexLayer,{zIndex:j.zIndex},reactExports.createElement(Layer,{className:clsx("recharts-cartesian-axis",nt)},reactExports.createElement(AxisLine,{x:j.x,y:j.y,width:et,height:tt,orientation:j.orientation,mirror:j.mirror,axisLine:_e,otherSvgProps:svgPropertiesNoEvents(j)}),reactExports.createElement(Ticks,{ref:dt,axisType:st,events:at,fontSize:ot,getTicksConfig:j,height:j.height,letterSpacing:lt,mirror:j.mirror,orientation:j.orientation,padding:j.padding,stroke:j.stroke,tick:j.tick,tickFormatter:j.tickFormatter,tickLine:j.tickLine,tickMargin:j.tickMargin,tickSize:j.tickSize,tickTextProps:j.tickTextProps,ticks:it,unit:j.unit,width:j.width,x:j.x,y:j.y}),reactExports.createElement(CartesianLabelContextProvider,{x:j.x,y:j.y,width:j.width,height:j.height,lowerWidth:j.width,upperWidth:j.width},reactExports.createElement(CartesianLabelFromLabelProp,{label:j.label,labelRef:j.labelRef}),j.children)))}),CartesianAxis=reactExports.forwardRef((j,$)=>{var _e=resolveDefaultProps(j,defaultCartesianAxisProps);return reactExports.createElement(CartesianAxisComponent,_extends$7({},_e,{ref:$}))});CartesianAxis.displayName="CartesianAxis";var selectXAxisWithScale=(j,$,_e,et)=>selectAxisWithScale(j,"xAxis",$,et),selectXAxisTicks=(j,$,_e,et)=>selectTicksOfGraphicalItem(j,"xAxis",$,et),selectYAxisWithScale=(j,$,_e,et)=>selectAxisWithScale(j,"yAxis",_e,et),selectYAxisTicks=(j,$,_e,et)=>selectTicksOfGraphicalItem(j,"yAxis",_e,et),selectBandSize=createSelector([selectChartLayout,selectXAxisWithScale,selectYAxisWithScale,selectXAxisTicks,selectYAxisTicks],(j,$,_e,et,tt)=>isCategoricalAxis(j,"xAxis")?getBandSizeOfAxis($,et,!1):getBandSizeOfAxis(_e,tt,!1)),pickLineId=(j,$,_e,et,tt)=>tt;function isLineSettings(j){return j.type==="line"}var selectSynchronisedLineSettings=createSelector([selectUnfilteredCartesianItems,pickLineId],(j,$)=>j.filter(isLineSettings).find(_e=>_e.id===$)),selectLinePoints=createSelector([selectChartLayout,selectXAxisWithScale,selectYAxisWithScale,selectXAxisTicks,selectYAxisTicks,selectSynchronisedLineSettings,selectBandSize,selectChartDataWithIndexesIfNotInPanorama],(j,$,_e,et,tt,nt,rt,it)=>{var{chartData:st,dataStartIndex:at,dataEndIndex:ot}=it;if(!(nt==null||$==null||_e==null||et==null||tt==null||et.length===0||tt.length===0||rt==null||j!=="horizontal"&&j!=="vertical")){var{dataKey:ct,data:lt}=nt,ut;if(lt!=null&&lt.length>0?ut=lt:ut=st==null?void 0:st.slice(at,ot+1),ut!=null)return computeLinePoints({layout:j,xAxis:$,yAxis:_e,xAxisTicks:et,yAxisTicks:tt,dataKey:ct,bandSize:rt,displayedData:ut})}});function getRadiusAndStrokeWidthFromDot(j){var $=svgPropertiesNoEventsFromUnknown(j),_e=3,et=2;if($!=null){var{r:tt,strokeWidth:nt}=$,rt=Number(tt),it=Number(nt);return(Number.isNaN(rt)||rt<0)&&(rt=_e),(Number.isNaN(it)||it<0)&&(it=et),{r:rt,strokeWidth:it}}return{r:_e,strokeWidth:et}}var _excluded$6=["id"],_excluded2$3=["type","layout","connectNulls","needClip","shape"],_excluded3=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function _extends$6(){return _extends$6=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$6.apply(null,arguments)}function ownKeys$2(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$2(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$2(Object(_e),!0).forEach(function(et){_defineProperty$2(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$2(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$2(j,$,_e){return($=_toPropertyKey$2($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$2(j){var $=_toPrimitive$2(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$2(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _objectWithoutProperties$6(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$6(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$6(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var computeLegendPayloadFromAreaData=j=>{var{dataKey:$,name:_e,stroke:et,legendType:tt,hide:nt}=j;return[{inactive:nt,dataKey:$,type:tt,color:et,value:getTooltipNameProp(_e,$),payload:j}]},SetLineTooltipEntrySettings=reactExports.memo(j=>{var{dataKey:$,data:_e,stroke:et,strokeWidth:tt,fill:nt,name:rt,hide:it,unit:st,tooltipType:at}=j,ot={dataDefinedOnItem:_e,positions:void 0,settings:{stroke:et,strokeWidth:tt,fill:nt,dataKey:$,nameKey:void 0,name:getTooltipNameProp(rt,$),hide:it,type:at,color:et,unit:st}};return reactExports.createElement(SetTooltipEntrySettings,{tooltipEntrySettings:ot})}),generateSimpleStrokeDasharray=(j,$)=>"".concat($,"px ").concat(j-$,"px");function repeat(j,$){for(var _e=j.length%2!==0?[...j,0]:j,et=[],tt=0;tt<$;++tt)et=[...et,..._e];return et}var getStrokeDasharray=(j,$,_e)=>{var et=_e.reduce((ct,lt)=>ct+lt);if(!et)return generateSimpleStrokeDasharray($,j);for(var tt=Math.floor(j/et),nt=j%et,rt=$-j,it=[],st=0,at=0;st<_e.length;at+=_e[st],++st)if(at+_e[st]>nt){it=[..._e.slice(0,st),nt-at];break}var ot=it.length%2===0?[0,rt]:[rt];return[...repeat(_e,tt),...it,...ot].map(ct=>"".concat(ct,"px")).join(", ")};function LineDotsWrapper(j){var{clipPathId:$,points:_e,props:et}=j,{dot:tt,dataKey:nt,needClip:rt}=et,{id:it}=et,st=_objectWithoutProperties$6(et,_excluded$6),at=svgPropertiesNoEvents(st);return reactExports.createElement(Dots,{points:_e,dot:tt,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:nt,baseProps:at,needClip:rt,clipPathId:$})}function LineLabelListProvider(j){var{showLabels:$,children:_e,points:et}=j,tt=reactExports.useMemo(()=>et==null?void 0:et.map(nt=>{var rt,it,st={x:(rt=nt.x)!==null&&rt!==void 0?rt:0,y:(it=nt.y)!==null&&it!==void 0?it:0,width:0,lowerWidth:0,upperWidth:0,height:0};return _objectSpread$2(_objectSpread$2({},st),{},{value:nt.value,payload:nt.payload,viewBox:st,parentViewBox:void 0,fill:void 0})}),[et]);return reactExports.createElement(CartesianLabelListContextProvider,{value:$?tt:void 0},_e)}function StaticCurve(j){var{clipPathId:$,pathRef:_e,points:et,strokeDasharray:tt,props:nt}=j,{type:rt,layout:it,connectNulls:st,needClip:at,shape:ot}=nt,ct=_objectWithoutProperties$6(nt,_excluded2$3),lt=_objectSpread$2(_objectSpread$2({},svgPropertiesAndEvents(ct)),{},{fill:"none",className:"recharts-line-curve",clipPath:at?"url(#clipPath-".concat($,")"):void 0,points:et,type:rt,layout:it,connectNulls:st,strokeDasharray:tt??nt.strokeDasharray});return reactExports.createElement(reactExports.Fragment,null,(et==null?void 0:et.length)>1&&reactExports.createElement(Shape,_extends$6({shapeType:"curve",option:ot},lt,{pathRef:_e})),reactExports.createElement(LineDotsWrapper,{points:et,clipPathId:$,props:nt}))}function getTotalLength(j){try{return j&&j.getTotalLength&&j.getTotalLength()||0}catch{return 0}}function CurveWithAnimation(j){var{clipPathId:$,props:_e,pathRef:et,previousPointsRef:tt,longestAnimatedLengthRef:nt}=j,{points:rt,strokeDasharray:it,isAnimationActive:st,animationBegin:at,animationDuration:ot,animationEasing:ct,animateNewValues:lt,width:ut,height:pt,onAnimationEnd:dt,onAnimationStart:ht}=_e,ft=tt.current,mt=useAnimationId(rt,"recharts-line-"),gt=reactExports.useRef(mt),[yt,vt]=reactExports.useState(!1),xt=!yt,St=reactExports.useCallback(()=>{typeof dt=="function"&&dt(),vt(!1)},[dt]),Et=reactExports.useCallback(()=>{typeof ht=="function"&&ht(),vt(!0)},[ht]),wt=getTotalLength(et.current),Tt=reactExports.useRef(0);gt.current!==mt&&(Tt.current=nt.current,gt.current=mt);var Ct=Tt.current;return reactExports.createElement(LineLabelListProvider,{points:rt,showLabels:xt},_e.children,reactExports.createElement(JavascriptAnimate,{animationId:mt,begin:at,duration:ot,isActive:st,easing:ct,onAnimationEnd:St,onAnimationStart:Et,key:mt},Rt=>{var jt=interpolate$1(Ct,wt+Ct,Rt),Ot=Math.min(jt,wt),$t;if(st)if(it){var Kt="".concat(it).split(/[,\s]+/gim).map(Bt=>parseFloat(Bt));$t=getStrokeDasharray(Ot,wt,Kt)}else $t=generateSimpleStrokeDasharray(wt,Ot);else $t=it==null?void 0:String(it);if(Rt>0&&wt>0&&(tt.current=rt,nt.current=Math.max(nt.current,Ot)),ft){var Lt=ft.length/rt.length,Nt=Rt===1?rt:rt.map((Bt,kt)=>{var rn=Math.floor(kt*Lt);if(ft[rn]){var Gt=ft[rn];return _objectSpread$2(_objectSpread$2({},Bt),{},{x:interpolate$1(Gt.x,Bt.x,Rt),y:interpolate$1(Gt.y,Bt.y,Rt)})}return lt?_objectSpread$2(_objectSpread$2({},Bt),{},{x:interpolate$1(ut*2,Bt.x,Rt),y:interpolate$1(pt/2,Bt.y,Rt)}):_objectSpread$2(_objectSpread$2({},Bt),{},{x:Bt.x,y:Bt.y})});return tt.current=Nt,reactExports.createElement(StaticCurve,{props:_e,points:Nt,clipPathId:$,pathRef:et,strokeDasharray:$t})}return reactExports.createElement(StaticCurve,{props:_e,points:rt,clipPathId:$,pathRef:et,strokeDasharray:$t})}),reactExports.createElement(LabelListFromLabelProp,{label:_e.label}))}function RenderCurve(j){var{clipPathId:$,props:_e}=j,et=reactExports.useRef(null),tt=reactExports.useRef(0),nt=reactExports.useRef(null);return reactExports.createElement(CurveWithAnimation,{props:_e,clipPathId:$,previousPointsRef:et,longestAnimatedLengthRef:tt,pathRef:nt})}var errorBarDataPointFormatter=(j,$)=>{var _e,et;return{x:(_e=j.x)!==null&&_e!==void 0?_e:void 0,y:(et=j.y)!==null&&et!==void 0?et:void 0,value:j.value,errorVal:getValueByDataKey(j.payload,$)}};class LineWithState extends reactExports.Component{render(){var{hide:$,dot:_e,points:et,className:tt,xAxisId:nt,yAxisId:rt,top:it,left:st,width:at,height:ot,id:ct,needClip:lt,zIndex:ut}=this.props;if($)return null;var pt=clsx("recharts-line",tt),dt=ct,{r:ht,strokeWidth:ft}=getRadiusAndStrokeWidthFromDot(_e),mt=isClipDot(_e),gt=ht*2+ft,yt=lt?"url(#clipPath-".concat(mt?"":"dots-").concat(dt,")"):void 0;return reactExports.createElement(ZIndexLayer,{zIndex:ut},reactExports.createElement(Layer,{className:pt},lt&&reactExports.createElement("defs",null,reactExports.createElement(GraphicalItemClipPath,{clipPathId:dt,xAxisId:nt,yAxisId:rt}),!mt&&reactExports.createElement("clipPath",{id:"clipPath-dots-".concat(dt)},reactExports.createElement("rect",{x:st-gt/2,y:it-gt/2,width:at+gt,height:ot+gt}))),reactExports.createElement(SetErrorBarContext,{xAxisId:nt,yAxisId:rt,data:et,dataPointFormatter:errorBarDataPointFormatter,errorBarOffset:0},reactExports.createElement(RenderCurve,{props:this.props,clipPathId:dt}))),reactExports.createElement(ActivePoints,{activeDot:this.props.activeDot,points:et,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:yt}))}}var defaultLineProps={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:DefaultZIndexes.line,type:"linear"};function LineImpl(j){var $=resolveDefaultProps(j,defaultLineProps),{activeDot:_e,animateNewValues:et,animationBegin:tt,animationDuration:nt,animationEasing:rt,connectNulls:it,dot:st,hide:at,isAnimationActive:ot,label:ct,legendType:lt,xAxisId:ut,yAxisId:pt,id:dt}=$,ht=_objectWithoutProperties$6($,_excluded3),{needClip:ft}=useNeedsClip(ut,pt),mt=usePlotArea(),gt=useChartLayout(),yt=useIsPanorama(),vt=useAppSelector(Tt=>selectLinePoints(Tt,ut,pt,yt,dt));if(gt!=="horizontal"&&gt!=="vertical"||vt==null||mt==null)return null;var{height:xt,width:St,x:Et,y:wt}=mt;return reactExports.createElement(LineWithState,_extends$6({},ht,{id:dt,connectNulls:it,dot:st,activeDot:_e,animateNewValues:et,animationBegin:tt,animationDuration:nt,animationEasing:rt,isAnimationActive:ot,hide:at,label:ct,legendType:lt,xAxisId:ut,yAxisId:pt,points:vt,layout:gt,height:xt,width:St,left:Et,top:wt,needClip:ft}))}function computeLinePoints(j){var{layout:$,xAxis:_e,yAxis:et,xAxisTicks:tt,yAxisTicks:nt,dataKey:rt,bandSize:it,displayedData:st}=j;return st.map((at,ot)=>{var ct=getValueByDataKey(at,rt);if($==="horizontal"){var lt=getCateCoordinateOfLine({axis:_e,ticks:tt,bandSize:it,entry:at,index:ot}),ut=isNullish(ct)?null:et.scale(ct);return{x:lt,y:ut,value:ct,payload:at}}var pt=isNullish(ct)?null:_e.scale(ct),dt=getCateCoordinateOfLine({axis:et,ticks:nt,bandSize:it,entry:at,index:ot});return pt==null||dt==null?null:{x:pt,y:dt,value:ct,payload:at}}).filter(Boolean)}function LineFn(j){var $=resolveDefaultProps(j,defaultLineProps),_e=useIsPanorama();return reactExports.createElement(RegisterGraphicalItemId,{id:$.id,type:"line"},et=>reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetLegendPayload,{legendPayload:computeLegendPayloadFromAreaData($)}),reactExports.createElement(SetLineTooltipEntrySettings,{dataKey:$.dataKey,data:$.data,stroke:$.stroke,strokeWidth:$.strokeWidth,fill:$.fill,name:$.name,hide:$.hide,unit:$.unit,tooltipType:$.tooltipType}),reactExports.createElement(SetCartesianGraphicalItem,{type:"line",id:et,data:$.data,xAxisId:$.xAxisId,yAxisId:$.yAxisId,zAxisId:0,dataKey:$.dataKey,hide:$.hide,isPanorama:_e}),reactExports.createElement(LineImpl,_extends$6({},$,{id:et}))))}var Line=reactExports.memo(LineFn,propsAreEqual);Line.displayName="Line";var _excluded$5=["domain","range"],_excluded2$2=["domain","range"];function _objectWithoutProperties$5(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$5(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$5(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function shortArraysAreEqual(j,$){return j===$?!0:Array.isArray(j)&&j.length===2&&Array.isArray($)&&$.length===2?j[0]===$[0]&&j[1]===$[1]:!1}function axisPropsAreEqual(j,$){if(j===$)return!0;var{domain:_e,range:et}=j,tt=_objectWithoutProperties$5(j,_excluded$5),{domain:nt,range:rt}=$,it=_objectWithoutProperties$5($,_excluded2$2);return!shortArraysAreEqual(_e,nt)||!shortArraysAreEqual(et,rt)?!1:propsAreEqual(tt,it)}var _excluded$4=["dangerouslySetInnerHTML","ticks"],_excluded2$1=["id"];function _extends$5(){return _extends$5=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$5.apply(null,arguments)}function _objectWithoutProperties$4(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$4(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$4(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function SetXAxisSettings(j){var $=useAppDispatch(),_e=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{_e.current===null?$(addXAxis(j)):_e.current!==j&&$(replaceXAxis({prev:_e.current,next:j})),_e.current=j},[j,$]),reactExports.useLayoutEffect(()=>()=>{_e.current&&($(removeXAxis(_e.current)),_e.current=null)},[$]),null}var XAxisImpl=j=>{var{xAxisId:$,className:_e}=j,et=useAppSelector(selectAxisViewBox),tt=useIsPanorama(),nt="xAxis",rt=useAppSelector(ht=>selectAxisScale(ht,nt,$,tt)),it=useAppSelector(ht=>selectTicksOfAxis(ht,nt,$,tt)),st=useAppSelector(ht=>selectXAxisSize(ht,$)),at=useAppSelector(ht=>selectXAxisPosition(ht,$)),ot=useAppSelector(ht=>selectXAxisSettingsNoDefaults(ht,$));if(st==null||at==null||ot==null)return null;var{dangerouslySetInnerHTML:ct,ticks:lt}=j,ut=_objectWithoutProperties$4(j,_excluded$4),{id:pt}=ot,dt=_objectWithoutProperties$4(ot,_excluded2$1);return reactExports.createElement(CartesianAxis,_extends$5({},ut,dt,{scale:rt,x:at.x,y:at.y,width:st.width,height:st.height,className:clsx("recharts-".concat(nt," ").concat(nt),_e),viewBox:et,ticks:it,axisType:nt}))},xAxisDefaultProps={allowDataOverflow:implicitXAxis.allowDataOverflow,allowDecimals:implicitXAxis.allowDecimals,allowDuplicatedCategory:implicitXAxis.allowDuplicatedCategory,angle:implicitXAxis.angle,axisLine:defaultCartesianAxisProps.axisLine,height:implicitXAxis.height,hide:!1,includeHidden:implicitXAxis.includeHidden,interval:implicitXAxis.interval,minTickGap:implicitXAxis.minTickGap,mirror:implicitXAxis.mirror,orientation:implicitXAxis.orientation,padding:implicitXAxis.padding,reversed:implicitXAxis.reversed,scale:implicitXAxis.scale,tick:implicitXAxis.tick,tickCount:implicitXAxis.tickCount,tickLine:defaultCartesianAxisProps.tickLine,tickSize:defaultCartesianAxisProps.tickSize,type:implicitXAxis.type,xAxisId:0},XAxisSettingsDispatcher=j=>{var $=resolveDefaultProps(j,xAxisDefaultProps);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetXAxisSettings,{allowDataOverflow:$.allowDataOverflow,allowDecimals:$.allowDecimals,allowDuplicatedCategory:$.allowDuplicatedCategory,angle:$.angle,dataKey:$.dataKey,domain:$.domain,height:$.height,hide:$.hide,id:$.xAxisId,includeHidden:$.includeHidden,interval:$.interval,minTickGap:$.minTickGap,mirror:$.mirror,name:$.name,orientation:$.orientation,padding:$.padding,reversed:$.reversed,scale:$.scale,tick:$.tick,tickCount:$.tickCount,tickFormatter:$.tickFormatter,ticks:$.ticks,type:$.type,unit:$.unit}),reactExports.createElement(XAxisImpl,$))},XAxis=reactExports.memo(XAxisSettingsDispatcher,axisPropsAreEqual);XAxis.displayName="XAxis";var _excluded$3=["dangerouslySetInnerHTML","ticks"],_excluded2=["id"];function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$4.apply(null,arguments)}function _objectWithoutProperties$3(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$3(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$3(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function SetYAxisSettings(j){var $=useAppDispatch(),_e=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{_e.current===null?$(addYAxis(j)):_e.current!==j&&$(replaceYAxis({prev:_e.current,next:j})),_e.current=j},[j,$]),reactExports.useLayoutEffect(()=>()=>{_e.current&&($(removeYAxis(_e.current)),_e.current=null)},[$]),null}var YAxisImpl=j=>{var{yAxisId:$,className:_e,width:et,label:tt}=j,nt=reactExports.useRef(null),rt=reactExports.useRef(null),it=useAppSelector(selectAxisViewBox),st=useIsPanorama(),at=useAppDispatch(),ot="yAxis",ct=useAppSelector(vt=>selectAxisScale(vt,ot,$,st)),lt=useAppSelector(vt=>selectYAxisSize(vt,$)),ut=useAppSelector(vt=>selectYAxisPosition(vt,$)),pt=useAppSelector(vt=>selectTicksOfAxis(vt,ot,$,st)),dt=useAppSelector(vt=>selectYAxisSettingsNoDefaults(vt,$));if(reactExports.useLayoutEffect(()=>{if(!(et!=="auto"||!lt||isLabelContentAFunction(tt)||reactExports.isValidElement(tt)||dt==null)){var vt=nt.current;if(vt){var xt=vt.getCalculatedWidth();Math.round(lt.width)!==Math.round(xt)&&at(updateYAxisWidth({id:$,width:xt}))}}},[pt,lt,at,tt,$,et,dt]),lt==null||ut==null||dt==null)return null;var{dangerouslySetInnerHTML:ht,ticks:ft}=j,mt=_objectWithoutProperties$3(j,_excluded$3),{id:gt}=dt,yt=_objectWithoutProperties$3(dt,_excluded2);return reactExports.createElement(CartesianAxis,_extends$4({},mt,yt,{ref:nt,labelRef:rt,scale:ct,x:ut.x,y:ut.y,tickTextProps:et==="auto"?{width:void 0}:{width:et},width:lt.width,height:lt.height,className:clsx("recharts-".concat(ot," ").concat(ot),_e),viewBox:it,ticks:pt,axisType:ot}))},yAxisDefaultProps={allowDataOverflow:implicitYAxis.allowDataOverflow,allowDecimals:implicitYAxis.allowDecimals,allowDuplicatedCategory:implicitYAxis.allowDuplicatedCategory,angle:implicitYAxis.angle,axisLine:defaultCartesianAxisProps.axisLine,hide:!1,includeHidden:implicitYAxis.includeHidden,interval:implicitYAxis.interval,minTickGap:implicitYAxis.minTickGap,mirror:implicitYAxis.mirror,orientation:implicitYAxis.orientation,padding:implicitYAxis.padding,reversed:implicitYAxis.reversed,scale:implicitYAxis.scale,tick:implicitYAxis.tick,tickCount:implicitYAxis.tickCount,tickLine:defaultCartesianAxisProps.tickLine,tickSize:defaultCartesianAxisProps.tickSize,type:implicitYAxis.type,width:implicitYAxis.width,yAxisId:0},YAxisSettingsDispatcher=j=>{var $=resolveDefaultProps(j,yAxisDefaultProps);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetYAxisSettings,{interval:$.interval,id:$.yAxisId,scale:$.scale,type:$.type,domain:$.domain,allowDataOverflow:$.allowDataOverflow,dataKey:$.dataKey,allowDuplicatedCategory:$.allowDuplicatedCategory,allowDecimals:$.allowDecimals,tickCount:$.tickCount,padding:$.padding,includeHidden:$.includeHidden,reversed:$.reversed,ticks:$.ticks,width:$.width,orientation:$.orientation,mirror:$.mirror,hide:$.hide,unit:$.unit,name:$.name,angle:$.angle,minTickGap:$.minTickGap,tick:$.tick,tickFormatter:$.tickFormatter}),reactExports.createElement(YAxisImpl,$))},YAxis=reactExports.memo(YAxisSettingsDispatcher,axisPropsAreEqual);YAxis.displayName="YAxis";var pickChartPointer=(j,$)=>$,selectActivePropsFromChartPointer=createSelector([pickChartPointer,selectChartLayout,selectPolarViewBox,selectTooltipAxisType,selectTooltipAxisRangeWithReverse,selectTooltipAxisTicks,selectOrderedTooltipTicks,selectChartOffsetInternal],combineActiveProps),getChartPointer=j=>{var $=j.currentTarget.getBoundingClientRect(),_e=$.width/j.currentTarget.offsetWidth,et=$.height/j.currentTarget.offsetHeight;return{chartX:Math.round((j.clientX-$.left)/_e),chartY:Math.round((j.clientY-$.top)/et)}},mouseClickAction=createAction("mouseClick"),mouseClickMiddleware=createListenerMiddleware();mouseClickMiddleware.startListening({actionCreator:mouseClickAction,effect:(j,$)=>{var _e=j.payload,et=selectActivePropsFromChartPointer($.getState(),getChartPointer(_e));(et==null?void 0:et.activeIndex)!=null&&$.dispatch(setMouseClickAxisIndex({activeIndex:et.activeIndex,activeDataKey:void 0,activeCoordinate:et.activeCoordinate}))}});var mouseMoveAction=createAction("mouseMove"),mouseMoveMiddleware=createListenerMiddleware(),rafId=null;mouseMoveMiddleware.startListening({actionCreator:mouseMoveAction,effect:(j,$)=>{var _e=j.payload;rafId!==null&&cancelAnimationFrame(rafId);var et=getChartPointer(_e);rafId=requestAnimationFrame(()=>{var tt=$.getState(),nt=selectTooltipEventType$1(tt,tt.tooltip.settings.shared);if(nt==="axis"){var rt=selectActivePropsFromChartPointer(tt,et);(rt==null?void 0:rt.activeIndex)!=null?$.dispatch(setMouseOverAxisIndex({activeIndex:rt.activeIndex,activeDataKey:void 0,activeCoordinate:rt.activeCoordinate})):$.dispatch(mouseLeaveChart())}rafId=null})}});var initialState={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},rootPropsSlice=createSlice({name:"rootProps",initialState,reducers:{updateOptions:(j,$)=>{var _e;j.accessibilityLayer=$.payload.accessibilityLayer,j.barCategoryGap=$.payload.barCategoryGap,j.barGap=(_e=$.payload.barGap)!==null&&_e!==void 0?_e:initialState.barGap,j.barSize=$.payload.barSize,j.maxBarSize=$.payload.maxBarSize,j.stackOffset=$.payload.stackOffset,j.syncId=$.payload.syncId,j.syncMethod=$.payload.syncMethod,j.className=$.payload.className,j.baseValue=$.payload.baseValue,j.reverseStackOrder=$.payload.reverseStackOrder}}}),rootPropsReducer=rootPropsSlice.reducer,{updateOptions}=rootPropsSlice.actions,polarOptionsSlice=createSlice({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(j,$)=>$.payload}}),{updatePolarOptions}=polarOptionsSlice.actions,polarOptionsReducer=polarOptionsSlice.reducer,keyDownAction=createAction("keyDown"),focusAction=createAction("focus"),keyboardEventsMiddleware=createListenerMiddleware();keyboardEventsMiddleware.startListening({actionCreator:keyDownAction,effect:(j,$)=>{var _e=$.getState(),et=_e.rootProps.accessibilityLayer!==!1;if(et){var{keyboardInteraction:tt}=_e.tooltip,nt=j.payload;if(!(nt!=="ArrowRight"&&nt!=="ArrowLeft"&&nt!=="Enter")){var rt=combineActiveTooltipIndex(tt,selectTooltipDisplayedData(_e),selectTooltipAxisDataKey(_e),selectTooltipAxisDomain(_e)),it=rt==null?-1:Number(rt);if(!(!Number.isFinite(it)||it<0)){var st=selectTooltipAxisTicks(_e);if(nt==="Enter"){var at=selectCoordinateForDefaultIndex(_e,"axis","hover",String(tt.index));$.dispatch(setKeyboardInteraction({active:!tt.active,activeIndex:tt.index,activeDataKey:tt.dataKey,activeCoordinate:at}));return}var ot=selectChartDirection(_e),ct=ot==="left-to-right"?1:-1,lt=nt==="ArrowRight"?1:-1,ut=it+lt*ct;if(!(st==null||ut>=st.length||ut<0)){var pt=selectCoordinateForDefaultIndex(_e,"axis","hover",String(ut));$.dispatch(setKeyboardInteraction({active:!0,activeIndex:ut.toString(),activeDataKey:void 0,activeCoordinate:pt}))}}}}}});keyboardEventsMiddleware.startListening({actionCreator:focusAction,effect:(j,$)=>{var _e=$.getState(),et=_e.rootProps.accessibilityLayer!==!1;if(et){var{keyboardInteraction:tt}=_e.tooltip;if(!tt.active&&tt.index==null){var nt="0",rt=selectCoordinateForDefaultIndex(_e,"axis","hover",String(nt));$.dispatch(setKeyboardInteraction({activeDataKey:void 0,active:!0,activeIndex:nt,activeCoordinate:rt}))}}}});var externalEventAction=createAction("externalEvent"),externalEventsMiddleware=createListenerMiddleware(),rafIdMap=new Map;externalEventsMiddleware.startListening({actionCreator:externalEventAction,effect:(j,$)=>{var{handler:_e,reactEvent:et}=j.payload;if(_e!=null){et.persist();var tt=et.type,nt=rafIdMap.get(tt);nt!==void 0&&cancelAnimationFrame(nt);var rt=requestAnimationFrame(()=>{try{var it=$.getState(),st={activeCoordinate:selectActiveTooltipCoordinate(it),activeDataKey:selectActiveTooltipDataKey(it),activeIndex:selectActiveTooltipIndex(it),activeLabel:selectActiveLabel$1(it),activeTooltipIndex:selectActiveTooltipIndex(it),isTooltipActive:selectIsTooltipActive$1(it)};_e(st,et)}finally{rafIdMap.delete(tt)}});rafIdMap.set(tt,rt)}}});var selectAllTooltipPayloadConfiguration=createSelector([selectTooltipState],j=>j.tooltipItemPayloads),selectTooltipCoordinate=createSelector([selectAllTooltipPayloadConfiguration,selectTooltipPayloadSearcher,(j,$,_e)=>$,(j,$,_e)=>_e],(j,$,_e,et)=>{var tt=j.find(it=>it.settings.dataKey===et);if(tt!=null){var{positions:nt}=tt;if(nt!=null){var rt=$(nt,_e);return rt}}}),touchEventAction=createAction("touchMove"),touchEventMiddleware=createListenerMiddleware();touchEventMiddleware.startListening({actionCreator:touchEventAction,effect:(j,$)=>{var _e=j.payload;if(!(_e.touches==null||_e.touches.length===0)){var et=$.getState(),tt=selectTooltipEventType$1(et,et.tooltip.settings.shared);if(tt==="axis"){var nt=selectActivePropsFromChartPointer(et,getChartPointer({clientX:_e.touches[0].clientX,clientY:_e.touches[0].clientY,currentTarget:_e.currentTarget}));(nt==null?void 0:nt.activeIndex)!=null&&$.dispatch(setMouseOverAxisIndex({activeIndex:nt.activeIndex,activeDataKey:void 0,activeCoordinate:nt.activeCoordinate}))}else if(tt==="item"){var rt,it=_e.touches[0];if(document.elementFromPoint==null)return;var st=document.elementFromPoint(it.clientX,it.clientY);if(!st||!st.getAttribute)return;var at=st.getAttribute(DATA_ITEM_INDEX_ATTRIBUTE_NAME),ot=(rt=st.getAttribute(DATA_ITEM_DATAKEY_ATTRIBUTE_NAME))!==null&&rt!==void 0?rt:void 0,ct=selectTooltipCoordinate($.getState(),at,ot);$.dispatch(setActiveMouseOverItemIndex({activeDataKey:ot,activeIndex:at,activeCoordinate:ct}))}}}});var rootReducer=combineReducers({brush:brushReducer,cartesianAxis:cartesianAxisReducer,chartData:chartDataReducer,errorBars:errorBarReducer,graphicalItems:graphicalItemsReducer,layout:chartLayoutReducer,legend:legendReducer,options:optionsReducer,polarAxis:polarAxisReducer,polarOptions:polarOptionsReducer,referenceElements:referenceElementsReducer,rootProps:rootPropsReducer,tooltip:tooltipReducer,zIndex:zIndexReducer}),createRechartsStore=function j($){return configureStore({reducer:rootReducer,preloadedState:$,middleware:_e=>{var et;return _e({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((et="es6")!==null&&et!==void 0?et:"")}).concat([mouseClickMiddleware.middleware,mouseMoveMiddleware.middleware,keyboardEventsMiddleware.middleware,externalEventsMiddleware.middleware,touchEventMiddleware.middleware])},enhancers:_e=>{var et=_e;return typeof _e=="function"&&(et=_e()),et.concat(autoBatchEnhancer({type:"raf"}))},devTools:Global.devToolsEnabled})};function RechartsStoreProvider(j){var{preloadedState:$,children:_e,reduxStoreName:et}=j,tt=useIsPanorama(),nt=reactExports.useRef(null);if(tt)return _e;nt.current==null&&(nt.current=createRechartsStore($));var rt=RechartsReduxContext;return reactExports.createElement(Provider_default,{context:rt,store:nt.current},_e)}function ReportMainChartPropsImpl(j){var{layout:$,margin:_e}=j,et=useAppDispatch(),tt=useIsPanorama();return reactExports.useEffect(()=>{tt||(et(setLayout($)),et(setMargin(_e)))},[et,tt,$,_e]),null}var ReportMainChartProps=reactExports.memo(ReportMainChartPropsImpl,propsAreEqual);function ReportChartProps(j){var $=useAppDispatch();return reactExports.useEffect(()=>{$(updateOptions(j))},[$,j]),null}function ZIndexSvgPortal(j){var{zIndex:$,isPanorama:_e}=j,et=_e?"recharts-zindex-panorama-":"recharts-zindex-",tt=useUniqueId("".concat(et).concat($)),nt=useAppDispatch();return reactExports.useLayoutEffect(()=>(nt(registerZIndexPortalId({zIndex:$,elementId:tt,isPanorama:_e})),()=>{nt(unregisterZIndexPortalId({zIndex:$,isPanorama:_e}))}),[nt,$,tt,_e]),reactExports.createElement("g",{tabIndex:-1,id:tt})}function AllZIndexPortals(j){var{children:$,isPanorama:_e}=j,et=useAppSelector(selectAllRegisteredZIndexes);if(!et||et.length===0)return $;var tt=et.filter(rt=>rt<0),nt=et.filter(rt=>rt>0);return reactExports.createElement(reactExports.Fragment,null,tt.map(rt=>reactExports.createElement(ZIndexSvgPortal,{key:rt,zIndex:rt,isPanorama:_e})),$,nt.map(rt=>reactExports.createElement(ZIndexSvgPortal,{key:rt,zIndex:rt,isPanorama:_e})))}var _excluded$2=["children"];function _objectWithoutProperties$2(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$2(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$2(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$3.apply(null,arguments)}var FULL_WIDTH_AND_HEIGHT={width:"100%",height:"100%",display:"block"},MainChartSurface=reactExports.forwardRef((j,$)=>{var _e=useChartWidth(),et=useChartHeight(),tt=useAccessibilityLayer();if(!isPositiveNumber(_e)||!isPositiveNumber(et))return null;var{children:nt,otherAttributes:rt,title:it,desc:st}=j,at,ot;return rt!=null&&(typeof rt.tabIndex=="number"?at=rt.tabIndex:at=tt?0:void 0,typeof rt.role=="string"?ot=rt.role:ot=tt?"application":void 0),reactExports.createElement(Surface,_extends$3({},rt,{title:it,desc:st,role:ot,tabIndex:at,width:_e,height:et,style:FULL_WIDTH_AND_HEIGHT,ref:$}),nt)}),BrushPanoramaSurface=j=>{var{children:$}=j,_e=useAppSelector(selectBrushDimensions);if(!_e)return null;var{width:et,height:tt,y:nt,x:rt}=_e;return reactExports.createElement(Surface,{width:et,height:tt,x:rt,y:nt},$)},RootSurface=reactExports.forwardRef((j,$)=>{var{children:_e}=j,et=_objectWithoutProperties$2(j,_excluded$2),tt=useIsPanorama();return tt?reactExports.createElement(BrushPanoramaSurface,null,reactExports.createElement(AllZIndexPortals,{isPanorama:!0},_e)):reactExports.createElement(MainChartSurface,_extends$3({ref:$},et),reactExports.createElement(AllZIndexPortals,{isPanorama:!1},_e))});function useReportScale(){var j=useAppDispatch(),[$,_e]=reactExports.useState(null),et=useAppSelector(selectContainerScale);return reactExports.useEffect(()=>{if($!=null){var tt=$.getBoundingClientRect(),nt=tt.width/$.offsetWidth;isWellBehavedNumber(nt)&&nt!==et&&j(setScale(nt))}},[$,j,et]),_e}function ownKeys$1(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread$1(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys$1(Object(_e),!0).forEach(function(et){_defineProperty$1(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys$1(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty$1(j,$,_e){return($=_toPropertyKey$1($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey$1(j){var $=_toPrimitive$1(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive$1(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$2.apply(null,arguments)}var EventSynchronizer=()=>(useSynchronisedEventsFromOtherCharts(),null);function getNumberOrZero(j){if(typeof j=="number")return j;if(typeof j=="string"){var $=parseFloat(j);if(!Number.isNaN($))return $}return 0}var ResponsiveDiv=reactExports.forwardRef((j,$)=>{var _e,et,tt=reactExports.useRef(null),[nt,rt]=reactExports.useState({containerWidth:getNumberOrZero((_e=j.style)===null||_e===void 0?void 0:_e.width),containerHeight:getNumberOrZero((et=j.style)===null||et===void 0?void 0:et.height)}),it=reactExports.useCallback((at,ot)=>{rt(ct=>{var lt=Math.round(at),ut=Math.round(ot);return ct.containerWidth===lt&&ct.containerHeight===ut?ct:{containerWidth:lt,containerHeight:ut}})},[]),st=reactExports.useCallback(at=>{if(typeof $=="function"&&$(at),at!=null&&typeof ResizeObserver<"u"){var{width:ot,height:ct}=at.getBoundingClientRect();it(ot,ct);var lt=pt=>{var{width:dt,height:ht}=pt[0].contentRect;it(dt,ht)},ut=new ResizeObserver(lt);ut.observe(at),tt.current=ut}},[$,it]);return reactExports.useEffect(()=>()=>{var at=tt.current;at!=null&&at.disconnect()},[it]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:nt.containerWidth,height:nt.containerHeight}),reactExports.createElement("div",_extends$2({ref:st},j)))}),ReadSizeOnceDiv=reactExports.forwardRef((j,$)=>{var{width:_e,height:et}=j,[tt,nt]=reactExports.useState({containerWidth:getNumberOrZero(_e),containerHeight:getNumberOrZero(et)}),rt=reactExports.useCallback((st,at)=>{nt(ot=>{var ct=Math.round(st),lt=Math.round(at);return ot.containerWidth===ct&&ot.containerHeight===lt?ot:{containerWidth:ct,containerHeight:lt}})},[]),it=reactExports.useCallback(st=>{if(typeof $=="function"&&$(st),st!=null){var{width:at,height:ot}=st.getBoundingClientRect();rt(at,ot)}},[$,rt]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:tt.containerWidth,height:tt.containerHeight}),reactExports.createElement("div",_extends$2({ref:it},j)))}),StaticDiv=reactExports.forwardRef((j,$)=>{var{width:_e,height:et}=j;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:_e,height:et}),reactExports.createElement("div",_extends$2({ref:$},j)))}),NonResponsiveDiv=reactExports.forwardRef((j,$)=>{var{width:_e,height:et}=j;return isPercent(_e)||isPercent(et)?reactExports.createElement(ReadSizeOnceDiv,_extends$2({},j,{ref:$})):reactExports.createElement(StaticDiv,_extends$2({},j,{ref:$}))});function getWrapperDivComponent(j){return j===!0?ResponsiveDiv:NonResponsiveDiv}var RechartsWrapper=reactExports.forwardRef((j,$)=>{var{children:_e,className:et,height:tt,onClick:nt,onContextMenu:rt,onDoubleClick:it,onMouseDown:st,onMouseEnter:at,onMouseLeave:ot,onMouseMove:ct,onMouseUp:lt,onTouchEnd:ut,onTouchMove:pt,onTouchStart:dt,style:ht,width:ft,responsive:mt,dispatchTouchEvents:gt=!0}=j,yt=reactExports.useRef(null),vt=useAppDispatch(),[xt,St]=reactExports.useState(null),[Et,wt]=reactExports.useState(null),Tt=useReportScale(),Ct=useResponsiveContainerContext(),Rt=(Ct==null?void 0:Ct.width)>0?Ct.width:ft,jt=(Ct==null?void 0:Ct.height)>0?Ct.height:tt,Ot=reactExports.useCallback(Ut=>{Tt(Ut),typeof $=="function"&&$(Ut),St(Ut),wt(Ut),Ut!=null&&(yt.current=Ut)},[Tt,$,St,wt]),$t=reactExports.useCallback(Ut=>{vt(mouseClickAction(Ut)),vt(externalEventAction({handler:nt,reactEvent:Ut}))},[vt,nt]),Kt=reactExports.useCallback(Ut=>{vt(mouseMoveAction(Ut)),vt(externalEventAction({handler:at,reactEvent:Ut}))},[vt,at]),Lt=reactExports.useCallback(Ut=>{vt(mouseLeaveChart()),vt(externalEventAction({handler:ot,reactEvent:Ut}))},[vt,ot]),Nt=reactExports.useCallback(Ut=>{vt(mouseMoveAction(Ut)),vt(externalEventAction({handler:ct,reactEvent:Ut}))},[vt,ct]),Bt=reactExports.useCallback(()=>{vt(focusAction())},[vt]),kt=reactExports.useCallback(Ut=>{vt(keyDownAction(Ut.key))},[vt]),rn=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:rt,reactEvent:Ut}))},[vt,rt]),Gt=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:it,reactEvent:Ut}))},[vt,it]),_t=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:st,reactEvent:Ut}))},[vt,st]),sn=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:lt,reactEvent:Ut}))},[vt,lt]),tn=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:dt,reactEvent:Ut}))},[vt,dt]),on=reactExports.useCallback(Ut=>{gt&&vt(touchEventAction(Ut)),vt(externalEventAction({handler:pt,reactEvent:Ut}))},[vt,gt,pt]),It=reactExports.useCallback(Ut=>{vt(externalEventAction({handler:ut,reactEvent:Ut}))},[vt,ut]),Zt=getWrapperDivComponent(mt);return reactExports.createElement(TooltipPortalContext.Provider,{value:xt},reactExports.createElement(LegendPortalContext.Provider,{value:Et},reactExports.createElement(Zt,{width:Rt??(ht==null?void 0:ht.width),height:jt??(ht==null?void 0:ht.height),className:clsx("recharts-wrapper",et),style:_objectSpread$1({position:"relative",cursor:"default",width:Rt,height:jt},ht),onClick:$t,onContextMenu:rn,onDoubleClick:Gt,onFocus:Bt,onKeyDown:kt,onMouseDown:_t,onMouseEnter:Kt,onMouseLeave:Lt,onMouseMove:Nt,onMouseUp:sn,onTouchEnd:It,onTouchMove:on,onTouchStart:tn,ref:Ot},reactExports.createElement(EventSynchronizer,null),_e)))}),_excluded$1=["width","height","responsive","children","className","style","compact","title","desc"];function _objectWithoutProperties$1(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose$1(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose$1(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var CategoricalChart=reactExports.forwardRef((j,$)=>{var{width:_e,height:et,responsive:tt,children:nt,className:rt,style:it,compact:st,title:at,desc:ot}=j,ct=_objectWithoutProperties$1(j,_excluded$1),lt=svgPropertiesNoEvents(ct);return st?reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:_e,height:et}),reactExports.createElement(RootSurface,{otherAttributes:lt,title:at,desc:ot},nt)):reactExports.createElement(RechartsWrapper,{className:rt,style:it,width:_e,height:et,responsive:tt??!1,onClick:j.onClick,onMouseLeave:j.onMouseLeave,onMouseEnter:j.onMouseEnter,onMouseMove:j.onMouseMove,onMouseDown:j.onMouseDown,onMouseUp:j.onMouseUp,onContextMenu:j.onContextMenu,onDoubleClick:j.onDoubleClick,onTouchStart:j.onTouchStart,onTouchMove:j.onTouchMove,onTouchEnd:j.onTouchEnd},reactExports.createElement(RootSurface,{otherAttributes:lt,title:at,desc:ot,ref:$},reactExports.createElement(ClipPathProvider,null,nt)))});function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends$1.apply(null,arguments)}var defaultMargin$1={top:5,right:5,bottom:5,left:5},defaultCartesianChartProps={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:defaultMargin$1,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},CartesianChart=reactExports.forwardRef(function j($,_e){var et,tt=resolveDefaultProps($.categoricalChartProps,defaultCartesianChartProps),{chartName:nt,defaultTooltipEventType:rt,validateTooltipEventTypes:it,tooltipPayloadSearcher:st,categoricalChartProps:at}=$,ot={chartName:nt,defaultTooltipEventType:rt,validateTooltipEventTypes:it,tooltipPayloadSearcher:st,eventEmitter:void 0};return reactExports.createElement(RechartsStoreProvider,{preloadedState:{options:ot},reduxStoreName:(et=at.id)!==null&&et!==void 0?et:nt},reactExports.createElement(ChartDataContextProvider,{chartData:at.data}),reactExports.createElement(ReportMainChartProps,{layout:tt.layout,margin:tt.margin}),reactExports.createElement(ReportChartProps,{baseValue:tt.baseValue,accessibilityLayer:tt.accessibilityLayer,barCategoryGap:tt.barCategoryGap,maxBarSize:tt.maxBarSize,stackOffset:tt.stackOffset,barGap:tt.barGap,barSize:tt.barSize,syncId:tt.syncId,syncMethod:tt.syncMethod,className:tt.className,reverseStackOrder:tt.reverseStackOrder}),reactExports.createElement(CategoricalChart,_extends$1({},tt,{ref:_e})))}),allowedTooltipTypes$1=["axis"],LineChart=reactExports.forwardRef((j,$)=>reactExports.createElement(CartesianChart,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:allowedTooltipTypes$1,tooltipPayloadSearcher:arrayTooltipSearcher,categoricalChartProps:j,ref:$}));function ReportPolarOptions(j){var $=useAppDispatch();return reactExports.useEffect(()=>{$(updatePolarOptions(j))},[$,j]),null}var _excluded=["layout"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$];for(var et in _e)({}).hasOwnProperty.call(_e,et)&&(j[et]=_e[et])}return j},_extends.apply(null,arguments)}function _objectWithoutProperties(j,$){if(j==null)return{};var _e,et,tt=_objectWithoutPropertiesLoose(j,$);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(j);for(et=0;et<nt.length;et++)_e=nt[et],$.indexOf(_e)===-1&&{}.propertyIsEnumerable.call(j,_e)&&(tt[_e]=j[_e])}return tt}function _objectWithoutPropertiesLoose(j,$){if(j==null)return{};var _e={};for(var et in j)if({}.hasOwnProperty.call(j,et)){if($.indexOf(et)!==-1)continue;_e[et]=j[et]}return _e}var defaultMargin={top:5,right:5,bottom:5,left:5},defaultPolarChartProps={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:defaultMargin,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},PolarChart=reactExports.forwardRef(function j($,_e){var et,tt=resolveDefaultProps($.categoricalChartProps,defaultPolarChartProps),{layout:nt}=tt,rt=_objectWithoutProperties(tt,_excluded),{chartName:it,defaultTooltipEventType:st,validateTooltipEventTypes:at,tooltipPayloadSearcher:ot}=$,ct={chartName:it,defaultTooltipEventType:st,validateTooltipEventTypes:at,tooltipPayloadSearcher:ot,eventEmitter:void 0};return reactExports.createElement(RechartsStoreProvider,{preloadedState:{options:ct},reduxStoreName:(et=tt.id)!==null&&et!==void 0?et:it},reactExports.createElement(ChartDataContextProvider,{chartData:tt.data}),reactExports.createElement(ReportMainChartProps,{layout:nt,margin:tt.margin}),reactExports.createElement(ReportChartProps,{baseValue:void 0,accessibilityLayer:tt.accessibilityLayer,barCategoryGap:tt.barCategoryGap,maxBarSize:tt.maxBarSize,stackOffset:tt.stackOffset,barGap:tt.barGap,barSize:tt.barSize,syncId:tt.syncId,syncMethod:tt.syncMethod,className:tt.className,reverseStackOrder:tt.reverseStackOrder}),reactExports.createElement(ReportPolarOptions,{cx:tt.cx,cy:tt.cy,startAngle:tt.startAngle,endAngle:tt.endAngle,innerRadius:tt.innerRadius,outerRadius:tt.outerRadius}),reactExports.createElement(CategoricalChart,_extends({},rt,{ref:_e})))});function ownKeys(j,$){var _e=Object.keys(j);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(j);$&&(et=et.filter(function(tt){return Object.getOwnPropertyDescriptor(j,tt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread(j){for(var $=1;$<arguments.length;$++){var _e=arguments[$]!=null?arguments[$]:{};$%2?ownKeys(Object(_e),!0).forEach(function(et){_defineProperty(j,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(_e)):ownKeys(Object(_e)).forEach(function(et){Object.defineProperty(j,et,Object.getOwnPropertyDescriptor(_e,et))})}return j}function _defineProperty(j,$,_e){return($=_toPropertyKey($))in j?Object.defineProperty(j,$,{value:_e,enumerable:!0,configurable:!0,writable:!0}):j[$]=_e,j}function _toPropertyKey(j){var $=_toPrimitive(j,"string");return typeof $=="symbol"?$:$+""}function _toPrimitive(j,$){if(typeof j!="object"||!j)return j;var _e=j[Symbol.toPrimitive];if(_e!==void 0){var et=_e.call(j,$);if(typeof et!="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(j)}var allowedTooltipTypes=["item"],defaultPieChartProps=_objectSpread(_objectSpread({},defaultPolarChartProps),{},{layout:"centric",startAngle:0,endAngle:360}),PieChart=reactExports.forwardRef((j,$)=>{var _e=resolveDefaultProps(j,defaultPieChartProps);return reactExports.createElement(PolarChart,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:allowedTooltipTypes,tooltipPayloadSearcher:arrayTooltipSearcher,categoricalChartProps:_e,ref:$})});function createContextScope(j,$=[]){let _e=[];function et(nt,rt){const it=reactExports.createContext(rt),st=_e.length;_e=[..._e,rt];const at=ct=>{var ft;const{scope:lt,children:ut,...pt}=ct,dt=((ft=lt==null?void 0:lt[j])==null?void 0:ft[st])||it,ht=reactExports.useMemo(()=>pt,Object.values(pt));return jsxRuntimeExports.jsx(dt.Provider,{value:ht,children:ut})};at.displayName=nt+"Provider";function ot(ct,lt){var dt;const ut=((dt=lt==null?void 0:lt[j])==null?void 0:dt[st])||it,pt=reactExports.useContext(ut);if(pt)return pt;if(rt!==void 0)return rt;throw new Error(`\`${ct}\` must be used within \`${nt}\``)}return[at,ot]}const tt=()=>{const nt=_e.map(rt=>reactExports.createContext(rt));return function(it){const st=(it==null?void 0:it[j])||nt;return reactExports.useMemo(()=>({[`__scope${j}`]:{...it,[j]:st}}),[it,st])}};return tt.scopeName=j,[et,composeContextScopes(tt,...$)]}function composeContextScopes(...j){const $=j[0];if(j.length===1)return $;const _e=()=>{const et=j.map(tt=>({useScope:tt(),scopeName:tt.scopeName}));return function(nt){const rt=et.reduce((it,{useScope:st,scopeName:at})=>{const ct=st(nt)[`__scope${at}`];return{...it,...ct}},{});return reactExports.useMemo(()=>({[`__scope${$.scopeName}`]:rt}),[rt])}};return _e.scopeName=$.scopeName,_e}function setRef(j,$){if(typeof j=="function")return j($);j!=null&&(j.current=$)}function composeRefs(...j){return $=>{let _e=!1;const et=j.map(tt=>{const nt=setRef(tt,$);return!_e&&typeof nt=="function"&&(_e=!0),nt});if(_e)return()=>{for(let tt=0;tt<et.length;tt++){const nt=et[tt];typeof nt=="function"?nt():setRef(j[tt],null)}}}}function useComposedRefs(...j){return reactExports.useCallback(composeRefs(...j),j)}function createSlot$2(j){const $=createSlotClone$2(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable$2);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone$2(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$3(tt),it=mergeProps$2(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER$2=Symbol("radix.slottable");function isSlottable$2(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER$2}function mergeProps$2(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$3(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}function createCollection(j){const $=j+"CollectionProvider",[_e,et]=createContextScope($),[tt,nt]=_e($,{collectionRef:{current:null},itemMap:new Map}),rt=dt=>{const{scope:ht,children:ft}=dt,mt=React$4.useRef(null),gt=React$4.useRef(new Map).current;return jsxRuntimeExports.jsx(tt,{scope:ht,itemMap:gt,collectionRef:mt,children:ft})};rt.displayName=$;const it=j+"CollectionSlot",st=createSlot$2(it),at=React$4.forwardRef((dt,ht)=>{const{scope:ft,children:mt}=dt,gt=nt(it,ft),yt=useComposedRefs(ht,gt.collectionRef);return jsxRuntimeExports.jsx(st,{ref:yt,children:mt})});at.displayName=it;const ot=j+"CollectionItemSlot",ct="data-radix-collection-item",lt=createSlot$2(ot),ut=React$4.forwardRef((dt,ht)=>{const{scope:ft,children:mt,...gt}=dt,yt=React$4.useRef(null),vt=useComposedRefs(ht,yt),xt=nt(ot,ft);return React$4.useEffect(()=>(xt.itemMap.set(yt,{ref:yt,...gt}),()=>void xt.itemMap.delete(yt))),jsxRuntimeExports.jsx(lt,{[ct]:"",ref:vt,children:mt})});ut.displayName=ot;function pt(dt){const ht=nt(j+"CollectionConsumer",dt);return React$4.useCallback(()=>{const mt=ht.collectionRef.current;if(!mt)return[];const gt=Array.from(mt.querySelectorAll(`[${ct}]`));return Array.from(ht.itemMap.values()).sort((xt,St)=>gt.indexOf(xt.ref.current)-gt.indexOf(St.ref.current))},[ht.collectionRef,ht.itemMap])}return[{Provider:rt,Slot:at,ItemSlot:ut},pt,et]}function composeEventHandlers(j,$,{checkForDefaultPrevented:_e=!0}={}){return function(tt){if(j==null||j(tt),_e===!1||!tt.defaultPrevented)return $==null?void 0:$(tt)}}var useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},useInsertionEffect=React$5[" useInsertionEffect ".trim().toString()]||useLayoutEffect2;function useControllableState({prop:j,defaultProp:$,onChange:_e=()=>{},caller:et}){const[tt,nt,rt]=useUncontrolledState({defaultProp:$,onChange:_e}),it=j!==void 0,st=it?j:tt;{const ot=reactExports.useRef(j!==void 0);reactExports.useEffect(()=>{const ct=ot.current;ct!==it&&console.warn(`${et} is changing from ${ct?"controlled":"uncontrolled"} to ${it?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),ot.current=it},[it,et])}const at=reactExports.useCallback(ot=>{var ct;if(it){const lt=isFunction(ot)?ot(j):ot;lt!==j&&((ct=rt.current)==null||ct.call(rt,lt))}else nt(ot)},[it,j,nt,rt]);return[st,at]}function useUncontrolledState({defaultProp:j,onChange:$}){const[_e,et]=reactExports.useState(j),tt=reactExports.useRef(_e),nt=reactExports.useRef($);return useInsertionEffect(()=>{nt.current=$},[$]),reactExports.useEffect(()=>{var rt;tt.current!==_e&&((rt=nt.current)==null||rt.call(nt,_e),tt.current=_e)},[_e,tt]),[_e,et,nt]}function isFunction(j){return typeof j=="function"}function createSlot$1(j){const $=createSlotClone$1(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable$1);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone$1(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$2(tt),it=mergeProps$1(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER$1=Symbol("radix.slottable");function isSlottable$1(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER$1}function mergeProps$1(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$2(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}var NODES$1=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive$1=NODES$1.reduce((j,$)=>{const _e=createSlot$1(`Primitive.${$}`),et=reactExports.forwardRef((tt,nt)=>{const{asChild:rt,...it}=tt,st=rt?_e:$;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(st,{...it,ref:nt})});return et.displayName=`Primitive.${$}`,{...j,[$]:et}},{});function createSlot(j){const $=createSlotClone(j),_e=reactExports.forwardRef((et,tt)=>{const{children:nt,...rt}=et,it=reactExports.Children.toArray(nt),st=it.find(isSlottable);if(st){const at=st.props.children,ot=it.map(ct=>ct===st?reactExports.Children.count(at)>1?reactExports.Children.only(null):reactExports.isValidElement(at)?at.props.children:null:ct);return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:reactExports.isValidElement(at)?reactExports.cloneElement(at,void 0,ot):null})}return jsxRuntimeExports.jsx($,{...rt,ref:tt,children:nt})});return _e.displayName=`${j}.Slot`,_e}function createSlotClone(j){const $=reactExports.forwardRef((_e,et)=>{const{children:tt,...nt}=_e;if(reactExports.isValidElement(tt)){const rt=getElementRef$1(tt),it=mergeProps(nt,tt.props);return tt.type!==reactExports.Fragment&&(it.ref=et?composeRefs(et,rt):rt),reactExports.cloneElement(tt,it)}return reactExports.Children.count(tt)>1?reactExports.Children.only(null):null});return $.displayName=`${j}.SlotClone`,$}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function isSlottable(j){return reactExports.isValidElement(j)&&typeof j.type=="function"&&"__radixId"in j.type&&j.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(j,$){const _e={...$};for(const et in $){const tt=j[et],nt=$[et];/^on[A-Z]/.test(et)?tt&&nt?_e[et]=(...it)=>{const st=nt(...it);return tt(...it),st}:tt&&(_e[et]=tt):et==="style"?_e[et]={...tt,...nt}:et==="className"&&(_e[et]=[tt,nt].filter(Boolean).join(" "))}return{...j,..._e}}function getElementRef$1(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive=NODES.reduce((j,$)=>{const _e=createSlot(`Primitive.${$}`),et=reactExports.forwardRef((tt,nt)=>{const{asChild:rt,...it}=tt,st=rt?_e:$;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(st,{...it,ref:nt})});return et.displayName=`Primitive.${$}`,{...j,[$]:et}},{});function useStateMachine(j,$){return reactExports.useReducer((_e,et)=>$[_e][et]??_e,j)}var Presence=j=>{const{present:$,children:_e}=j,et=usePresence($),tt=typeof _e=="function"?_e({present:et.isPresent}):reactExports.Children.only(_e),nt=useComposedRefs(et.ref,getElementRef(tt));return typeof _e=="function"||et.isPresent?reactExports.cloneElement(tt,{ref:nt}):null};Presence.displayName="Presence";function usePresence(j){const[$,_e]=reactExports.useState(),et=reactExports.useRef(null),tt=reactExports.useRef(j),nt=reactExports.useRef("none"),rt=j?"mounted":"unmounted",[it,st]=useStateMachine(rt,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const at=getAnimationName(et.current);nt.current=it==="mounted"?at:"none"},[it]),useLayoutEffect2(()=>{const at=et.current,ot=tt.current;if(ot!==j){const lt=nt.current,ut=getAnimationName(at);j?st("MOUNT"):ut==="none"||(at==null?void 0:at.display)==="none"?st("UNMOUNT"):st(ot&&lt!==ut?"ANIMATION_OUT":"UNMOUNT"),tt.current=j}},[j,st]),useLayoutEffect2(()=>{if($){let at;const ot=$.ownerDocument.defaultView??window,ct=ut=>{const dt=getAnimationName(et.current).includes(CSS.escape(ut.animationName));if(ut.target===$&&dt&&(st("ANIMATION_END"),!tt.current)){const ht=$.style.animationFillMode;$.style.animationFillMode="forwards",at=ot.setTimeout(()=>{$.style.animationFillMode==="forwards"&&($.style.animationFillMode=ht)})}},lt=ut=>{ut.target===$&&(nt.current=getAnimationName(et.current))};return $.addEventListener("animationstart",lt),$.addEventListener("animationcancel",ct),$.addEventListener("animationend",ct),()=>{ot.clearTimeout(at),$.removeEventListener("animationstart",lt),$.removeEventListener("animationcancel",ct),$.removeEventListener("animationend",ct)}}else st("ANIMATION_END")},[$,st]),{isPresent:["mounted","unmountSuspended"].includes(it),ref:reactExports.useCallback(at=>{et.current=at?getComputedStyle(at):null,_e(at)},[])}}function getAnimationName(j){return(j==null?void 0:j.animationName)||"none"}function getElementRef(j){var et,tt;let $=(et=Object.getOwnPropertyDescriptor(j.props,"ref"))==null?void 0:et.get,_e=$&&"isReactWarning"in $&&$.isReactWarning;return _e?j.ref:($=(tt=Object.getOwnPropertyDescriptor(j,"ref"))==null?void 0:tt.get,_e=$&&"isReactWarning"in $&&$.isReactWarning,_e?j.props.ref:j.props.ref||j.ref)}var useReactId=React$5[" useId ".trim().toString()]||(()=>{}),count=0;function useId(j){const[$,_e]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{_e(et=>et??String(count++))},[j]),$?`radix-${$}`:""}var COLLAPSIBLE_NAME="Collapsible",[createCollapsibleContext,createCollapsibleScope]=createContextScope(COLLAPSIBLE_NAME),[CollapsibleProvider,useCollapsibleContext]=createCollapsibleContext(COLLAPSIBLE_NAME),Collapsible=reactExports.forwardRef((j,$)=>{const{__scopeCollapsible:_e,open:et,defaultOpen:tt,disabled:nt,onOpenChange:rt,...it}=j,[st,at]=useControllableState({prop:et,defaultProp:tt??!1,onChange:rt,caller:COLLAPSIBLE_NAME});return jsxRuntimeExports.jsx(CollapsibleProvider,{scope:_e,disabled:nt,contentId:useId(),open:st,onOpenToggle:reactExports.useCallback(()=>at(ot=>!ot),[at]),children:jsxRuntimeExports.jsx(Primitive.div,{"data-state":getState$1(st),"data-disabled":nt?"":void 0,...it,ref:$})})});Collapsible.displayName=COLLAPSIBLE_NAME;var TRIGGER_NAME$1="CollapsibleTrigger",CollapsibleTrigger=reactExports.forwardRef((j,$)=>{const{__scopeCollapsible:_e,...et}=j,tt=useCollapsibleContext(TRIGGER_NAME$1,_e);return jsxRuntimeExports.jsx(Primitive.button,{type:"button","aria-controls":tt.contentId,"aria-expanded":tt.open||!1,"data-state":getState$1(tt.open),"data-disabled":tt.disabled?"":void 0,disabled:tt.disabled,...et,ref:$,onClick:composeEventHandlers(j.onClick,tt.onOpenToggle)})});CollapsibleTrigger.displayName=TRIGGER_NAME$1;var CONTENT_NAME$1="CollapsibleContent",CollapsibleContent=reactExports.forwardRef((j,$)=>{const{forceMount:_e,...et}=j,tt=useCollapsibleContext(CONTENT_NAME$1,j.__scopeCollapsible);return jsxRuntimeExports.jsx(Presence,{present:_e||tt.open,children:({present:nt})=>jsxRuntimeExports.jsx(CollapsibleContentImpl,{...et,ref:$,present:nt})})});CollapsibleContent.displayName=CONTENT_NAME$1;var CollapsibleContentImpl=reactExports.forwardRef((j,$)=>{const{__scopeCollapsible:_e,present:et,children:tt,...nt}=j,rt=useCollapsibleContext(CONTENT_NAME$1,_e),[it,st]=reactExports.useState(et),at=reactExports.useRef(null),ot=useComposedRefs($,at),ct=reactExports.useRef(0),lt=ct.current,ut=reactExports.useRef(0),pt=ut.current,dt=rt.open||it,ht=reactExports.useRef(dt),ft=reactExports.useRef(void 0);return reactExports.useEffect(()=>{const mt=requestAnimationFrame(()=>ht.current=!1);return()=>cancelAnimationFrame(mt)},[]),useLayoutEffect2(()=>{const mt=at.current;if(mt){ft.current=ft.current||{transitionDuration:mt.style.transitionDuration,animationName:mt.style.animationName},mt.style.transitionDuration="0s",mt.style.animationName="none";const gt=mt.getBoundingClientRect();ct.current=gt.height,ut.current=gt.width,ht.current||(mt.style.transitionDuration=ft.current.transitionDuration,mt.style.animationName=ft.current.animationName),st(et)}},[rt.open,et]),jsxRuntimeExports.jsx(Primitive.div,{"data-state":getState$1(rt.open),"data-disabled":rt.disabled?"":void 0,id:rt.contentId,hidden:!dt,...nt,ref:ot,style:{"--radix-collapsible-content-height":lt?`${lt}px`:void 0,"--radix-collapsible-content-width":pt?`${pt}px`:void 0,...j.style},children:dt&&tt})});function getState$1(j){return j?"open":"closed"}var Root=Collapsible,Trigger=CollapsibleTrigger,Content=CollapsibleContent,DirectionContext=reactExports.createContext(void 0);function useDirection(j){const $=reactExports.useContext(DirectionContext);return j||$||"ltr"}var ACCORDION_NAME="Accordion",ACCORDION_KEYS=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Collection,useCollection,createCollectionScope]=createCollection(ACCORDION_NAME),[createAccordionContext]=createContextScope(ACCORDION_NAME,[createCollectionScope,createCollapsibleScope]),useCollapsibleScope=createCollapsibleScope(),Accordion$1=React$4.forwardRef((j,$)=>{const{type:_e,...et}=j,tt=et,nt=et;return jsxRuntimeExports.jsx(Collection.Provider,{scope:j.__scopeAccordion,children:_e==="multiple"?jsxRuntimeExports.jsx(AccordionImplMultiple,{...nt,ref:$}):jsxRuntimeExports.jsx(AccordionImplSingle,{...tt,ref:$})})});Accordion$1.displayName=ACCORDION_NAME;var[AccordionValueProvider,useAccordionValueContext]=createAccordionContext(ACCORDION_NAME),[AccordionCollapsibleProvider,useAccordionCollapsibleContext]=createAccordionContext(ACCORDION_NAME,{collapsible:!1}),AccordionImplSingle=React$4.forwardRef((j,$)=>{const{value:_e,defaultValue:et,onValueChange:tt=()=>{},collapsible:nt=!1,...rt}=j,[it,st]=useControllableState({prop:_e,defaultProp:et??"",onChange:tt,caller:ACCORDION_NAME});return jsxRuntimeExports.jsx(AccordionValueProvider,{scope:j.__scopeAccordion,value:React$4.useMemo(()=>it?[it]:[],[it]),onItemOpen:st,onItemClose:React$4.useCallback(()=>nt&&st(""),[nt,st]),children:jsxRuntimeExports.jsx(AccordionCollapsibleProvider,{scope:j.__scopeAccordion,collapsible:nt,children:jsxRuntimeExports.jsx(AccordionImpl,{...rt,ref:$})})})}),AccordionImplMultiple=React$4.forwardRef((j,$)=>{const{value:_e,defaultValue:et,onValueChange:tt=()=>{},...nt}=j,[rt,it]=useControllableState({prop:_e,defaultProp:et??[],onChange:tt,caller:ACCORDION_NAME}),st=React$4.useCallback(ot=>it((ct=[])=>[...ct,ot]),[it]),at=React$4.useCallback(ot=>it((ct=[])=>ct.filter(lt=>lt!==ot)),[it]);return jsxRuntimeExports.jsx(AccordionValueProvider,{scope:j.__scopeAccordion,value:rt,onItemOpen:st,onItemClose:at,children:jsxRuntimeExports.jsx(AccordionCollapsibleProvider,{scope:j.__scopeAccordion,collapsible:!0,children:jsxRuntimeExports.jsx(AccordionImpl,{...nt,ref:$})})})}),[AccordionImplProvider,useAccordionContext]=createAccordionContext(ACCORDION_NAME),AccordionImpl=React$4.forwardRef((j,$)=>{const{__scopeAccordion:_e,disabled:et,dir:tt,orientation:nt="vertical",...rt}=j,it=React$4.useRef(null),st=useComposedRefs(it,$),at=useCollection(_e),ct=useDirection(tt)==="ltr",lt=composeEventHandlers(j.onKeyDown,ut=>{var Et;if(!ACCORDION_KEYS.includes(ut.key))return;const pt=ut.target,dt=at().filter(wt=>{var Tt;return!((Tt=wt.ref.current)!=null&&Tt.disabled)}),ht=dt.findIndex(wt=>wt.ref.current===pt),ft=dt.length;if(ht===-1)return;ut.preventDefault();let mt=ht;const gt=0,yt=ft-1,vt=()=>{mt=ht+1,mt>yt&&(mt=gt)},xt=()=>{mt=ht-1,mt<gt&&(mt=yt)};switch(ut.key){case"Home":mt=gt;break;case"End":mt=yt;break;case"ArrowRight":nt==="horizontal"&&(ct?vt():xt());break;case"ArrowDown":nt==="vertical"&&vt();break;case"ArrowLeft":nt==="horizontal"&&(ct?xt():vt());break;case"ArrowUp":nt==="vertical"&&xt();break}const St=mt%ft;(Et=dt[St].ref.current)==null||Et.focus()});return jsxRuntimeExports.jsx(AccordionImplProvider,{scope:_e,disabled:et,direction:tt,orientation:nt,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:_e,children:jsxRuntimeExports.jsx(Primitive$1.div,{...rt,"data-orientation":nt,ref:st,onKeyDown:et?void 0:lt})})})}),ITEM_NAME="AccordionItem",[AccordionItemProvider,useAccordionItemContext]=createAccordionContext(ITEM_NAME),AccordionItem$1=React$4.forwardRef((j,$)=>{const{__scopeAccordion:_e,value:et,...tt}=j,nt=useAccordionContext(ITEM_NAME,_e),rt=useAccordionValueContext(ITEM_NAME,_e),it=useCollapsibleScope(_e),st=useId(),at=et&&rt.value.includes(et)||!1,ot=nt.disabled||j.disabled;return jsxRuntimeExports.jsx(AccordionItemProvider,{scope:_e,open:at,disabled:ot,triggerId:st,children:jsxRuntimeExports.jsx(Root,{"data-orientation":nt.orientation,"data-state":getState(at),...it,...tt,ref:$,disabled:ot,open:at,onOpenChange:ct=>{ct?rt.onItemOpen(et):rt.onItemClose(et)}})})});AccordionItem$1.displayName=ITEM_NAME;var HEADER_NAME="AccordionHeader",AccordionHeader=React$4.forwardRef((j,$)=>{const{__scopeAccordion:_e,...et}=j,tt=useAccordionContext(ACCORDION_NAME,_e),nt=useAccordionItemContext(HEADER_NAME,_e);return jsxRuntimeExports.jsx(Primitive$1.h3,{"data-orientation":tt.orientation,"data-state":getState(nt.open),"data-disabled":nt.disabled?"":void 0,...et,ref:$})});AccordionHeader.displayName=HEADER_NAME;var TRIGGER_NAME="AccordionTrigger",AccordionTrigger$1=React$4.forwardRef((j,$)=>{const{__scopeAccordion:_e,...et}=j,tt=useAccordionContext(ACCORDION_NAME,_e),nt=useAccordionItemContext(TRIGGER_NAME,_e),rt=useAccordionCollapsibleContext(TRIGGER_NAME,_e),it=useCollapsibleScope(_e);return jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:_e,children:jsxRuntimeExports.jsx(Trigger,{"aria-disabled":nt.open&&!rt.collapsible||void 0,"data-orientation":tt.orientation,id:nt.triggerId,...it,...et,ref:$})})});AccordionTrigger$1.displayName=TRIGGER_NAME;var CONTENT_NAME="AccordionContent",AccordionContent$1=React$4.forwardRef((j,$)=>{const{__scopeAccordion:_e,...et}=j,tt=useAccordionContext(ACCORDION_NAME,_e),nt=useAccordionItemContext(CONTENT_NAME,_e),rt=useCollapsibleScope(_e);return jsxRuntimeExports.jsx(Content,{role:"region","aria-labelledby":nt.triggerId,"data-orientation":tt.orientation,...rt,...et,ref:$,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...j.style}})});AccordionContent$1.displayName=CONTENT_NAME;function getState(j){return j?"open":"closed"}var Root2=Accordion$1,Item=AccordionItem$1,Header=AccordionHeader,Trigger2=AccordionTrigger$1,Content2=AccordionContent$1;const Accordion=Root2,AccordionItem=reactExports.forwardRef(({className:j,...$},_e)=>jsxRuntimeExports.jsx(Item,{ref:_e,className:cn("border-b",j),...$}));AccordionItem.displayName="AccordionItem";const AccordionTrigger=reactExports.forwardRef(({className:j,children:$,..._e},et)=>jsxRuntimeExports.jsx(Header,{className:"flex",children:jsxRuntimeExports.jsxs(Trigger2,{ref:et,className:cn("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",j),..._e,children:[$,jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));AccordionTrigger.displayName=Trigger2.displayName;const AccordionContent=reactExports.forwardRef(({className:j,children:$,..._e},et)=>jsxRuntimeExports.jsx(Content2,{ref:et,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",..._e,children:jsxRuntimeExports.jsx("div",{className:cn("pb-4 pt-0",j),children:$})}));AccordionContent.displayName=Content2.displayName;function SkillAssessmentDisplay({summary:j,dimensions:$}){if(!j||j.length===0)return null;const _e=(rt,it=5)=>{const st=rt/it*100;return st>=80?"text-green-600":st>=60?"text-yellow-600":"text-red-600"},et=(rt,it=5)=>{const st=rt/it*100;return st>=80?"bg-green-100":st>=60?"bg-yellow-100":"bg-red-100"},tt=(rt,it=5)=>{const st=rt/it*100;return st>=80?"bg-green-500":st>=60?"bg-yellow-500":"bg-red-500"},nt=rt=>$.filter(it=>it.skill_id===rt);return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Target,{className:"w-5 h-5"}),"Skill Framework Assessment"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Assessment based on established professional frameworks"})]}),jsxRuntimeExports.jsx(CardContent,{className:"space-y-6",children:jsxRuntimeExports.jsx(Accordion,{type:"multiple",className:"w-full",children:j.map(rt=>{const it=nt(rt.skill_id),st=Array.isArray(rt.strength_dimensions)?rt.strength_dimensions:JSON.parse(rt.strength_dimensions||"[]"),at=Array.isArray(rt.improvement_dimensions)?rt.improvement_dimensions:JSON.parse(rt.improvement_dimensions||"[]");return jsxRuntimeExports.jsxs(AccordionItem,{value:`skill-${rt.skill_id}`,children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"hover:no-underline",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between w-full pr-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full ${et(rt.overall_skill_score)}`,children:jsxRuntimeExports.jsx("span",{className:`text-lg font-bold ${_e(rt.overall_skill_score)}`,children:rt.overall_skill_score.toFixed(1)})}),jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:rt.skill_name}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[jsxRuntimeExports.jsx(BookOpen,{className:"w-3 h-3"}),rt.framework_used||rt.framework_mapping]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[st.length>0&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-green-600 border-green-200 bg-green-50",children:[jsxRuntimeExports.jsx(TrendingUp,{className:"w-3 h-3 mr-1"}),st.length," Strengths"]}),at.length>0&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-amber-600 border-amber-200 bg-amber-50",children:[jsxRuntimeExports.jsx(TrendingDown,{className:"w-3 h-3 mr-1"}),at.length," Areas to Develop"]})]})]})}),jsxRuntimeExports.jsx(AccordionContent,{children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 pt-2",children:[rt.assessment_notes&&jsxRuntimeExports.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-sm",children:[jsxRuntimeExports.jsx("strong",{children:"Assessment Notes:"})," ",rt.assessment_notes]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx(Target,{className:"w-4 h-4"}),"Dimension Scores"]}),it.map((ot,ct)=>jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[ot.score>=4?jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4 text-green-500"}):ot.score<=2?jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 text-amber-500"}):jsxRuntimeExports.jsx("div",{className:"w-4 h-4"}),ot.dimension_name]}),jsxRuntimeExports.jsxs("span",{className:`font-medium ${_e(ot.score,ot.max_score)}`,children:[ot.score.toFixed(1)," / ",ot.max_score]})]}),jsxRuntimeExports.jsx("div",{className:"relative h-2 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`absolute left-0 top-0 h-full rounded-full transition-all ${tt(ot.score,ot.max_score)}`,style:{width:`${ot.score/ot.max_score*100}%`}})}),ot.evidence&&jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground pl-6 mt-1",children:ot.evidence})]},ct))]}),st.length>0&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-green-600",children:[jsxRuntimeExports.jsx(TrendingUp,{className:"w-4 h-4"}),"Strength Areas"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:st.map((ot,ct)=>jsxRuntimeExports.jsx(Badge,{className:"bg-green-100 text-green-700 hover:bg-green-200",children:ot},ct))})]}),at.length>0&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-amber-600",children:[jsxRuntimeExports.jsx(TrendingDown,{className:"w-4 h-4"}),"Development Opportunities"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:at.map((ot,ct)=>jsxRuntimeExports.jsx(Badge,{className:"bg-amber-100 text-amber-700 hover:bg-amber-200",children:ot},ct))})]})]})})]},rt.skill_id)})})})]})}function AnalyticsDashboard({analysis:j,transcript:$,transcriptMessages:_e,sessionData:et,skillAssessments:tt}){var Bt,kt,rn,Gt,_t,sn,tn,on,It,Zt,Ut,Xt,Ht,Pt,Mt,Vt,qt,en,fn,Cn,En,Pn,Rn,Gn;const nt=j||(et==null?void 0:et.analytics)||et,rt=tt||(et==null?void 0:et.skillAssessments)||(nt==null?void 0:nt.skillAssessments),it=(_e==null?void 0:_e.messages)||(et==null?void 0:et.transcript)||($==null?void 0:$.messages)||[];if(!nt)return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Session Analysis"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Loading analysis..."})})]});const st=nt.overallScore||0,at=nt.userTalkPercentage||((Bt=nt.talkTime)==null?void 0:Bt.userPercentage)||0,ot=nt.userTalkTime||((kt=nt.talkTime)==null?void 0:kt.userTime)||0,ct=nt.otherTalkTime||((rn=nt.talkTime)==null?void 0:rn.otherTime)||0,lt=nt.questionsAsked||((Gt=nt.listening)==null?void 0:Gt.questionsAsked)||0,ut=nt.engagementLevel||((_t=nt.listening)==null?void 0:_t.engagementLevel)||0,pt=nt.activeListening||((sn=nt.listening)==null?void 0:sn.activeListening)||!1,dt=nt.acknowledgments||((tn=nt.listening)==null?void 0:tn.acknowledgments)||0,ht=nt.interruptions||((on=nt.listening)==null?void 0:on.interruptions)||0,ft=nt.averagePacing||((It=nt.delivery)==null?void 0:It.averagePacing)||0,mt=nt.tone||((Zt=nt.delivery)==null?void 0:Zt.tone)||[],gt=nt.pauseCount||((Ut=nt.delivery)==null?void 0:Ut.pauseCount)||0,yt=nt.averagePauseLength||((Xt=nt.delivery)==null?void 0:Xt.averagePauseLength)||0,vt=nt.fillerWords||((Ht=nt.wordChoice)==null?void 0:Ht.fillerWords)||[],xt=nt.weakWords||((Pt=nt.wordChoice)==null?void 0:Pt.weakWords)||[],St=nt.sentenceOpeners||((Mt=nt.wordChoice)==null?void 0:Mt.sentenceOpeners)||[],Et=nt.strengths||((Vt=nt.feedback)==null?void 0:Vt.strengths)||[],wt=nt.growthAreas||((qt=nt.feedback)==null?void 0:qt.growthAreas)||[],Tt=nt.followUpQuestions||((en=nt.feedback)==null?void 0:en.followUpQuestions)||[],Ct=nt.summary||((fn=nt.feedback)==null?void 0:fn.summary)||"",Rt=nt.pronunciationIssues||((En=(Cn=nt.feedback)==null?void 0:Cn.pronunciation)==null?void 0:En.issues)||[],jt=nt.pronunciationSuggestions||((Rn=(Pn=nt.feedback)==null?void 0:Pn.pronunciation)==null?void 0:Rn.suggestions)||[],Ot=nt.pacingVariation||((Gn=nt.delivery)==null?void 0:Gn.pacingVariation)||[],$t=[{name:"You",value:ot,fill:"#3b82f6"},{name:"Avatar",value:ct,fill:"#e5e7eb"}],Kt=xn=>xn>=8?"text-green-600":xn>=6?"text-yellow-600":"text-red-600",Lt=xn=>xn>=8?"bg-green-100 border-green-200":xn>=6?"bg-yellow-100 border-yellow-200":"bg-red-100 border-red-200",Nt=xn=>xn>=8?"ring-green-500":xn>=6?"ring-yellow-500":"ring-red-500";return jsxRuntimeExports.jsxs("div",{className:"space-y-6 max-w-6xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx(Card,{className:`${Lt(st)} border-2`,children:jsxRuntimeExports.jsx(CardContent,{className:"pt-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center ring-4 ${Nt(st)} bg-white`,children:jsxRuntimeExports.jsx("span",{className:`text-3xl font-bold ${Kt(st)}`,children:st})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg",children:"Overall Score"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Based on your conversation performance"})]})]})})}),jsxRuntimeExports.jsxs(Card,{className:"lg:col-span-2",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-base flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lightbulb,{className:"w-4 h-4 text-blue-500"}),"Session Summary"]})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:Ct||"No summary available."})})]})]}),rt&&rt.summary&&rt.summary.length>0&&jsxRuntimeExports.jsx(SkillAssessmentDisplay,{summary:rt.summary,dimensions:rt.dimensions||[]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[jsxRuntimeExports.jsx(Card,{className:"bg-blue-50 border-blue-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(at),"%"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Talk Time"})]})}),jsxRuntimeExports.jsx(Card,{className:"bg-purple-50 border-purple-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-purple-600",children:lt}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Questions"})]})}),jsxRuntimeExports.jsx(Card,{className:"bg-emerald-50 border-emerald-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:[ut,"/10"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Engagement"})]})}),jsxRuntimeExports.jsx(Card,{className:"bg-cyan-50 border-cyan-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-cyan-600",children:ft}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"WPM"})]})}),jsxRuntimeExports.jsx(Card,{className:"bg-amber-50 border-amber-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-amber-600",children:dt}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Acks"})]})}),jsxRuntimeExports.jsx(Card,{className:ht>0?"bg-red-50 border-red-100":"bg-green-50 border-green-100",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:`text-2xl font-bold ${ht>0?"text-red-600":"text-green-600"}`,children:ht}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Interrupts"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[Et.length>0&&jsxRuntimeExports.jsxs(Card,{className:"border-green-200 bg-green-50/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-sm flex items-center gap-2 text-green-700",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4"}),"Strengths"]})}),jsxRuntimeExports.jsx(CardContent,{className:"pt-0",children:jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:Et.map((xn,_n)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{children:xn})]},_n))})})]}),wt.length>0&&jsxRuntimeExports.jsxs(Card,{className:"border-amber-200 bg-amber-50/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-sm flex items-center gap-2 text-amber-700",children:[jsxRuntimeExports.jsx(TrendingUp,{className:"w-4 h-4"}),"Areas for Growth"]})}),jsxRuntimeExports.jsx(CardContent,{className:"pt-0",children:jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:wt.map((xn,_n)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4 text-amber-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{children:xn})]},_n))})})]})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-base",children:"Detailed Analysis"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs(Accordion,{type:"multiple",className:"w-full",children:[jsxRuntimeExports.jsxs(AccordionItem,{value:"talk-time",children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"text-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Clock,{className:"w-4 h-4"}),"Talk Time & Listening"]})}),jsxRuntimeExports.jsx(AccordionContent,{children:jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pt-2",children:[jsxRuntimeExports.jsx("div",{className:"h-40",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(PieChart,{children:[jsxRuntimeExports.jsx(Pie,{data:$t,innerRadius:35,outerRadius:55,paddingAngle:4,dataKey:"value",label:({name:xn,value:_n})=>`${xn}: ${_n}s`,children:$t.map((xn,_n)=>jsxRuntimeExports.jsx(Cell,{fill:xn.fill},`cell-${_n}`))}),jsxRuntimeExports.jsx(Tooltip,{formatter:xn=>`${xn} seconds`})]})})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted rounded text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Active Listening"}),jsxRuntimeExports.jsx(Badge,{variant:pt?"default":"secondary",className:"text-xs",children:pt?"Yes":"No"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted rounded text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Questions Asked"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:lt})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted rounded text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Acknowledgments"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:dt})]})]})]})})]}),jsxRuntimeExports.jsxs(AccordionItem,{value:"delivery",children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"text-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Mic,{className:"w-4 h-4"}),"Delivery & Pacing"]})}),jsxRuntimeExports.jsxs(AccordionContent,{children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3 pt-2",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-muted rounded",children:[jsxRuntimeExports.jsx("div",{className:"text-xl font-bold",children:ft}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg WPM"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-muted rounded",children:[jsxRuntimeExports.jsx("div",{className:"text-xl font-bold",children:gt}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Pauses"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-muted rounded",children:[jsxRuntimeExports.jsxs("div",{className:"text-xl font-bold",children:[yt.toFixed(1),"s"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg Pause"})]})]}),Array.isArray(mt)&&mt.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Tone:"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:mt.map((xn,_n)=>jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs",children:xn},_n))})]}),Array.isArray(Ot)&&Ot.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Pacing Trend"}),jsxRuntimeExports.jsx("div",{className:"h-32",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(LineChart,{data:Ot,children:[jsxRuntimeExports.jsx(XAxis,{dataKey:"segment",tick:{fontSize:10}}),jsxRuntimeExports.jsx(YAxis,{tick:{fontSize:10},domain:["auto","auto"]}),jsxRuntimeExports.jsx(Tooltip,{formatter:xn=>`${xn} WPM`}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"wpm",stroke:"#3b82f6",strokeWidth:2,dot:{r:3}})]})})})]})]})]}),jsxRuntimeExports.jsxs(AccordionItem,{value:"word-choice",children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"text-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4"}),"Word Choice",(vt.length>0||xt.length>0)&&jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"ml-2 text-xs",children:[vt.length+xt.length," items"]})]})}),jsxRuntimeExports.jsxs(AccordionContent,{children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pt-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Filler Words"}),vt.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-1",children:vt.map((xn,_n)=>jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-red-700",children:['"',xn.word,'"']}),jsxRuntimeExports.jsxs(Badge,{variant:"destructive",className:"text-xs",children:[xn.count,"x"]})]},_n))}):jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600",children:"No filler words detected"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Weak Words"}),xt.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-1",children:xt.map((xn,_n)=>jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 bg-yellow-50 rounded text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-yellow-700",children:['"',xn.word,'"']}),jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-xs",children:[xn.count,"x"]})]},_n))}):jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600",children:"Great word choice"})]})]}),St.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-3",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Common Sentence Openers"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:St.slice(0,5).map((xn,_n)=>{var Zn;return jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"text-xs",children:[(Zn=xn.opener)==null?void 0:Zn.substring(0,20),"... (",xn.count,"x)"]},_n)})})]})]})]}),(Tt.length>0||Rt.length>0||jt.length>0)&&jsxRuntimeExports.jsxs(AccordionItem,{value:"suggestions",children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"text-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lightbulb,{className:"w-4 h-4"}),"Suggestions & Feedback"]})}),jsxRuntimeExports.jsx(AccordionContent,{children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 pt-2",children:[Tt.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Suggested Follow-up Questions"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:Tt.map((xn,_n)=>jsxRuntimeExports.jsx("li",{className:"p-2 bg-blue-50 rounded text-sm text-blue-800",children:xn},_n))})]}),(Rt.length>0||jt.length>0)&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium mb-2",children:"Pronunciation Feedback"}),Rt.length>0&&Rt[0]!=="None"&&jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-red-600 mb-1",children:"Issues:"}),jsxRuntimeExports.jsx("ul",{className:"list-disc pl-4 space-y-1 text-sm",children:Rt.map((xn,_n)=>jsxRuntimeExports.jsx("li",{children:xn},_n))})]}),jt.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Suggestions:"}),jsxRuntimeExports.jsx("ul",{className:"list-disc pl-4 space-y-1 text-sm",children:jt.map((xn,_n)=>jsxRuntimeExports.jsx("li",{children:xn},_n))})]})]})]})})]}),it.length>0&&jsxRuntimeExports.jsxs(AccordionItem,{value:"transcript",children:[jsxRuntimeExports.jsx(AccordionTrigger,{className:"text-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(MessageSquare,{className:"w-4 h-4"}),"Session Transcript",jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"ml-2 text-xs",children:[it.length," messages"]})]})}),jsxRuntimeExports.jsx(AccordionContent,{children:jsxRuntimeExports.jsx("div",{className:"max-h-80 overflow-y-auto space-y-3 pt-2",children:it.map((xn,_n)=>{var Ft,At;const Zn=((Ft=xn.speaker)==null?void 0:Ft.toLowerCase())==="user"||((At=xn.speaker)==null?void 0:At.toLowerCase())==="you";return jsxRuntimeExports.jsx("div",{className:`flex ${Zn?"justify-end":"justify-start"}`,children:jsxRuntimeExports.jsx("div",{className:`max-w-[80%] rounded-xl px-3 py-2 text-sm ${Zn?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:jsxRuntimeExports.jsx("p",{children:xn.text})})},_n)})})})]})]})})]})]})}function SessionAnalysisPage(){var kt,rn,Gt,_t,sn,tn,on;const[j]=useSearchParams(),$=j.get("type"),_e=j.get("sid"),et=j.get("tid")||null,tt=j.get("skill"),nt=j.get("scenario"),rt=j.get("blueprint"),it=useNavigate(),[st,at]=reactExports.useState(null),[ot,ct]=reactExports.useState(!1),lt=(()=>{if(!rt)return null;try{return JSON.parse(decodeURIComponent(rt))}catch(It){return console.error("Failed to parse blueprint:",It),null}})(),{data:ut,isLoading:pt,error:dt}=useQuery({queryKey:["/api/avatar/session-analysis",et],queryFn:async()=>{const It=await fetch("/api/avatar/session-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcriptId:et,sessionId:_e,sessionType:$})}),Zt=await It.json();if(!It.ok)throw new Error((Zt==null?void 0:Zt.error)||(Zt==null?void 0:Zt.message));return Zt},enabled:!!et}),ht=()=>{it(tt?`/avatar/practice?skill=${tt}`:"/avatar/start")},ft=()=>{it(tt?`/avatar/practice?skill=${tt}`:"/avatar/start")},mt=()=>{if(lt){const It=COUNTER_PERSONA_ARCHETYPES.filter(Ht=>Ht.id!==lt.counterPersona.archetype),Zt=It[Math.floor(Math.random()*It.length)],Ut={...lt,counterPersona:{archetype:Zt.id,caresAbout:Zt.caresAbout,pressureResponse:Zt.pressureResponse,trigger:Zt.trigger}},Xt=encodeURIComponent(JSON.stringify(Ut));it(`/avatar/practice/pre-session?blueprint=${Xt}&source=retry`)}else it("/avatar/start")},gt=()=>{if(lt){const It=encodeURIComponent(JSON.stringify(lt));it(`/avatar/practice/pre-session?blueprint=${It}&source=retry`)}else it(nt&&tt?`/avatar/practice/pre-session?scenario=${nt}&skill=${tt}`:"/avatar/start")},yt=It=>{var Ut,Xt,Ht;if(!It||It.length===0)return[];const Zt=[];for(let Pt=0;Pt<It.length;Pt++){const Mt=It[Pt],Vt=((Ut=Mt.speaker)==null?void 0:Ut.toLowerCase())==="user"||((Xt=Mt.speaker)==null?void 0:Xt.toLowerCase())==="you",qt=((Ht=Mt.text)==null?void 0:Ht.toLowerCase())||"";Vt?(qt.includes("?")&&(qt.includes("what")||qt.includes("how")||qt.includes("why"))&&Zt.push({type:"good_question",message:Mt,reason:"Asked a probing question"}),(qt.includes("i understand")||qt.includes("i hear you")||qt.includes("that makes sense"))&&Zt.push({type:"acknowledgment",message:Mt,reason:"Showed active listening"}),(qt.includes("i think")||qt.includes("my view is")||qt.includes("i believe"))&&Zt.push({type:"assertion",message:Mt,reason:"Made a clear assertion"})):(qt.includes("but")||qt.includes("however")||qt.includes("i disagree"))&&Zt.push({type:"pushback",message:Mt,reason:"Avatar pushed back - tension point"})}return Zt.slice(0,3)},vt=(It,Zt)=>{const Ut=[{condition:()=>(It==null?void 0:It.questionsAsked)<2,text:"Ask more open-ended questions to understand the other person's perspective before presenting your view."},{condition:()=>(It==null?void 0:It.interruptions)>0,text:"Practice letting the other person finish their thought completely before responding."},{condition:()=>{var Xt;return((Xt=It==null?void 0:It.fillerWords)==null?void 0:Xt.length)>2},text:"Pause and collect your thoughts instead of using filler words - silence is powerful."},{condition:()=>(It==null?void 0:It.userTalkPercentage)>70,text:"Try to balance the conversation more - aim for 50/50 talk time to ensure you're listening."},{condition:()=>(It==null?void 0:It.userTalkPercentage)<30,text:"Share more of your perspective - the other person wants to hear your thoughts too."},{condition:()=>(Zt==null?void 0:Zt.userObjective)==="set_boundaries",text:"Be more direct about your limits - use 'I statements' to clearly define what you can and cannot do."},{condition:()=>(Zt==null?void 0:Zt.userObjective)==="influence",text:"Lead with questions that help the other person discover the answer themselves."},{condition:()=>!0,text:"Try summarizing the other person's points before presenting your own - it builds trust and shows you've listened."}];for(const Xt of Ut)if(Xt.condition())return Xt.text;return Ut[Ut.length-1].text},xt=It=>It>=8?"text-green-600":It>=6?"text-amber-600":"text-red-600",St=It=>It>=8?"bg-green-100 border-green-200":It>=6?"bg-amber-100 border-amber-200":"bg-red-100 border-red-200",Et=It=>It>=8?"Excellent":It>=6?"Good Progress":It>=4?"Keep Practicing":"Needs Work";if(pt)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Analyzing your session..."})]})})});if(dt)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-red-500 mb-4",children:"Error loading your session analysis"}),jsxRuntimeExports.jsxs(Button,{onClick:ht,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Practice"]})]})})});if(!ut||!ut.analysis)return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsxs(CardContent,{className:"p-12 text-center",children:[jsxRuntimeExports.jsx(Trophy,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Analysis Available"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-6",children:"Start a new practice session to see your analysis."}),jsxRuntimeExports.jsxs(Button,{onClick:ft,children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"Start New Session"]})]})})})});const wt=ut.analysis,Tt=((kt=ut.transcriptMessage)==null?void 0:kt.messages)||((rn=ut.transcript)==null?void 0:rn.messages)||[],Ct=yt(Tt),Rt=vt(wt,lt),jt=ut.skillAssessments,Ot=lt!=null&&lt.userObjective?getObjectiveById(lt.userObjective):null,$t=(Gt=lt==null?void 0:lt.skillLens)!=null&&Gt.primary?getSkillLensById(lt.skillLens.primary):null,Kt=(_t=lt==null?void 0:lt.counterPersona)!=null&&_t.archetype?getCounterPersonaById(lt.counterPersona.archetype):null,Lt=wt.overallScore||0,Nt=wt.strengths||((sn=wt.feedback)==null?void 0:sn.strengths)||[],Bt=wt.growthAreas||((tn=wt.feedback)==null?void 0:tn.growthAreas)||[];return jsxRuntimeExports.jsx(ModernDashboardLayout,{children:jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20",children:[jsxRuntimeExports.jsx("div",{className:"border-b bg-card sticky top-0 z-10",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto px-4 sm:px-6 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:ht,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-1"}),"Back"]}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:"Session Review"}),((on=lt==null?void 0:lt.scenarioSummary)==null?void 0:on.title)&&jsxRuntimeExports.jsx(Badge,{variant:"secondary",className:"hidden sm:inline-flex",children:lt.scenarioSummary.title})]})})}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-6 max-w-4xl",children:[jsxRuntimeExports.jsx(Card,{className:`${St(Lt)} border-2 mb-6`,children:jsxRuntimeExports.jsx(CardContent,{className:"pt-6 pb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 rounded-full bg-white flex items-center justify-center shadow-md",children:jsxRuntimeExports.jsx("span",{className:`text-4xl font-bold ${xt(Lt)}`,children:Lt})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:Et(Lt)}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Overall Performance"})]})]}),(Kt||$t||Ot)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 border-l pl-6 hidden sm:block",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Practice Session"}),jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[Kt&&jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:"With:"})," ",Kt.label]}),Ot&&jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:"Goal:"})," ",Ot.label]}),$t&&jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:"Skill:"})," ",$t.label]})]})]}),jsxRuntimeExports.jsx("div",{className:"w-full border-t pt-4 mt-2 sm:hidden",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[Kt&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-xs",children:["With: ",Kt.label]}),Ot&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-xs",children:["Goal: ",Ot.label]}),$t&&jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"text-xs",children:["Skill: ",$t.label]})]})})]})]})})}),jsxRuntimeExports.jsxs(Card,{className:"mb-6",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Conversation Snapshot"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(wt.userTalkPercentage||0),"%"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:"Your Talk Time"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(wt.userTalkPercentage||0)>60?"You led the conversation":(wt.userTalkPercentage||0)<40?"Good listening balance":"Balanced discussion"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-purple-600",children:wt.questionsAsked||0}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:"Questions Asked"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(wt.questionsAsked||0)>=3?"Great curiosity shown":(wt.questionsAsked||0)===0?"Try asking more":"Keep exploring"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-emerald-50 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:[wt.engagementLevel||0,"/10"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:"Engagement Level"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(wt.engagementLevel||0)>=8?"Highly engaged":(wt.engagementLevel||0)>=6?"Good participation":"Room to grow"})]}),jsxRuntimeExports.jsxs("div",{className:`text-center p-3 rounded-lg ${(wt.interruptions||0)>0?"bg-red-50":"bg-green-50"}`,children:[jsxRuntimeExports.jsx("div",{className:`text-2xl font-bold ${(wt.interruptions||0)>0?"text-red-600":"text-green-600"}`,children:wt.interruptions||0}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:"Interruptions"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(wt.interruptions||0)===0?"Great patience!":"Let them finish"})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-3",children:"Your Feedback"}),jsxRuntimeExports.jsx(Card,{className:"border-2 border-blue-200 bg-blue-50/50 mb-4",children:jsxRuntimeExports.jsx(CardContent,{className:"pt-5 pb-5",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx(Lightbulb,{className:"w-5 h-5 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"One Thing to Try Next Time"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-800 leading-relaxed",children:Rt})]})]})})}),jsxRuntimeExports.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[Nt.length>0&&jsxRuntimeExports.jsxs(Card,{className:"border-green-200 bg-green-50/30",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2 text-sm font-semibold text-green-800",children:[jsxRuntimeExports.jsx(CheckCircle2,{className:"w-4 h-4"}),"What You Did Well"]})}),jsxRuntimeExports.jsx(CardContent,{className:"pt-0",children:jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:Nt.slice(0,3).map((It,Zt)=>jsxRuntimeExports.jsxs("li",{className:"text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-green-500 mt-0.5",children:""}),jsxRuntimeExports.jsx("span",{className:"text-green-900",children:It})]},Zt))})})]}),Bt.length>0&&jsxRuntimeExports.jsxs(Card,{className:"border-amber-200 bg-amber-50/30",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2 text-sm font-semibold text-amber-800",children:[jsxRuntimeExports.jsx(TrendingUp,{className:"w-4 h-4"}),"Areas to Improve"]})}),jsxRuntimeExports.jsx(CardContent,{className:"pt-0",children:jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:Bt.slice(0,3).map((It,Zt)=>jsxRuntimeExports.jsxs("li",{className:"text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 mt-0.5",children:""}),jsxRuntimeExports.jsx("span",{className:"text-amber-900",children:It})]},Zt))})})]})]})]}),Ct.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-3",children:"Key Moments from Your Conversation"}),jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsx(CardContent,{className:"pt-4",children:jsxRuntimeExports.jsx("div",{className:"space-y-3",children:Ct.map((It,Zt)=>{var Xt,Ht;const Ut=((Xt=It.message.speaker)==null?void 0:Xt.toLowerCase())==="user"||((Ht=It.message.speaker)==null?void 0:Ht.toLowerCase())==="you";return jsxRuntimeExports.jsxs("div",{className:`p-4 rounded-lg ${Ut?"bg-blue-50 border border-blue-200":"bg-amber-50 border border-amber-200"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(Badge,{variant:Ut?"default":"secondary",className:"text-xs",children:Ut?"You":"Avatar"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:It.reason})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm italic",children:['"',It.message.text,'"']})]},Zt)})})})})]}),jt&&jt.summary&&jt.summary.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-3",children:"Skill Framework Assessment"}),jsxRuntimeExports.jsx(SkillAssessmentDisplay,{summary:jt.summary,dimensions:jt.dimensions||[]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>ct(!ot),className:"w-full flex items-center justify-center gap-2 p-4 bg-muted/50 rounded-lg hover:bg-muted transition-colors",children:[jsxRuntimeExports.jsx(BarChart3,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:ot?"Hide Detailed Analytics":"View Detailed Analytics"})]}),jsxRuntimeExports.jsx("div",{className:ot?"mt-4":"hidden",children:jsxRuntimeExports.jsx(AnalyticsDashboard,{analysis:wt,transcript:ut.transcript,transcriptMessages:ut.transcriptMessage,skillAssessments:jt})})]}),jsxRuntimeExports.jsx(Card,{className:"bg-muted/30 border-dashed",children:jsxRuntimeExports.jsxs(CardContent,{className:"pt-6 pb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-center font-medium mb-4",children:"Ready to Practice Again?"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[jsxRuntimeExports.jsxs(Button,{onClick:gt,size:"lg",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2"}),"Try Again"]}),lt&&jsxRuntimeExports.jsxs(Button,{onClick:mt,variant:"outline",size:"lg",children:[jsxRuntimeExports.jsx(Zap,{className:"w-4 h-4 mr-2"}),"Tougher Persona"]}),jsxRuntimeExports.jsxs(Button,{onClick:ft,variant:"ghost",size:"lg",children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 mr-2"}),"New Scenario"]})]})]})}),lt&&Ot&&jsxRuntimeExports.jsx(Card,{className:"mt-6 border-primary/20 bg-primary/5",children:jsxRuntimeExports.jsx(CardContent,{className:"pt-5 pb-5",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx(Target,{className:"w-6 h-6 text-primary flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium mb-1",children:"Did you achieve your objective?"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[Ot.label,": ",Ot.description]}),st===null?jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{size:"sm",variant:"outline",className:"hover:bg-green-50 hover:border-green-500 hover:text-green-700",onClick:()=>at(!0),children:[jsxRuntimeExports.jsx(ThumbsUp,{className:"w-4 h-4 mr-1"}),"Yes, I did"]}),jsxRuntimeExports.jsxs(Button,{size:"sm",variant:"outline",className:"hover:bg-amber-50 hover:border-amber-500 hover:text-amber-700",onClick:()=>at(!1),children:[jsxRuntimeExports.jsx(ThumbsDown,{className:"w-4 h-4 mr-1"}),"Not yet"]})]}):jsxRuntimeExports.jsx(Badge,{variant:st?"default":"secondary",children:st?"Objective achieved!":"Keep practicing - you'll get there!"})]})]})})})]})]})})}function MicroAssessmentSessionAnalysisPage(){const[j]=useSearchParams(),$=j.get("type"),_e=j.get("sid"),et=j.get("tid")||null,tt=useNavigate(),{data:nt,isLoading:rt,error:it}=useQuery({queryKey:["/api/avatar/session-analysis",et],queryFn:async()=>{const at=await fetch("/api/avatar/session-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcriptId:et,sessionId:_e,sessionType:$})}),ot=await at.json();if(!at.ok)throw new Error((ot==null?void 0:ot.error)||(ot==null?void 0:ot.message));return ot},enabled:!!et}),st=()=>{const at=j.get("assignmentId"),ot=j.get("skill");if(at){tt(`/micro-assessment-assignment/${at}?show=report`);return}tt(ot?`/avatar/practice?skill=${ot}`:"/avatar/practice")};return rt?jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessment",children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Loading your session analysis..."})]})})}):it?jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessment",children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-red-500 mb-4",children:"Error loading your session analysis"}),jsxRuntimeExports.jsxs(Button,{onClick:st,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})}):!nt||!nt.analysis?jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessment",children:jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsxs(CardContent,{className:"p-12 text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(BarChart3,{className:"w-8 h-8 text-muted-foreground"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Analysis Available"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-6",children:"Complete an assessment session to see your analysis."}),jsxRuntimeExports.jsxs(Button,{onClick:st,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})}):jsxRuntimeExports.jsx(ModernDashboardLayout,{initialActiveSection:"assessments",activeItem:"micro-assessment",children:jsxRuntimeExports.jsxs("div",{className:"",children:[jsxRuntimeExports.jsx("div",{className:"border-b bg-card",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto px-6 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsxs(Button,{variant:"ghost",onClick:st,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-semibold",children:"Session Analysis"})]}),j.get("assignmentId")&&jsxRuntimeExports.jsx(Button,{onClick:st,className:"flex items-center space-x-2",children:jsxRuntimeExports.jsx("span",{children:"Back to Assessment Details"})})]})})}),jsxRuntimeExports.jsx("div",{className:"container mx-auto px-6 py-6",children:jsxRuntimeExports.jsx(AnalyticsDashboard,{analysis:nt.analysis,transcript:nt.transcript,transcriptMessages:nt.transcriptMessage,skillAssessments:nt.skillAssessments})})]})})}function App(){return jsxRuntimeExports.jsx(AvatarSessionProvider,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/register",element:jsxRuntimeExports.jsx(RegisterPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/dashboard",element:jsxRuntimeExports.jsx(AvatarSimulatorDashboard,{})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/start",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(IntentEntryPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(PracticePage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/custom-scenario",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(CustomScenarioPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/explore",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(ExplorePage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/avatar-select",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(AvatarSelectPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/pre-session",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(PreSessionPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/scenario-details",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(ScenarioDetailsPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/practice/session",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(SessionPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/results",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(ResultsPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/assessment-session/roleplay",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(AssessmentRoleplaySessionPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/avatar/session-analysis",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(SessionAnalysisPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"/micro-assessment-session-analysis",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(MicroAssessmentSessionAnalysisPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/",replace:!0})})]})})}const queryClient=new QueryClient({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$4.StrictMode,{children:jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})})}));
